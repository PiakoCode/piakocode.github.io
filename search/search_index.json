{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"Read%20List/","title":"Read List","text":"<p>GitHub - AISystem</p> <p>\u5206\u5e03\u5f0f\u7cfb\u7edf | jackyfkc.github.io</p> <p>\u6559\u6750\u7b80\u4ecb \u00b7 \u5206\u5e03\u5f0f\u8ba1\u7b97\u7cfb\u7edf</p> <p>ML system \u5165\u5751\u6307\u5357 | \u6478\u9ed1\u5e72\u6d3b</p> <p>A Reading List for MLSys</p>"},{"location":"%E5%AD%A6%E4%B9%A0%E7%BB%8F%E9%AA%8C/","title":"\u5b66\u4e60\u7ecf\u9a8c","text":""},{"location":"%E5%AD%A6%E4%B9%A0%E7%BB%8F%E9%AA%8C/#_2","title":"\u672a\u6765\u65b9\u5411","text":"<ol> <li> <p>\u5c31\u4e1a</p> <ul> <li>\u9879\u76ee</li> <li>\u5b9e\u4e60</li> </ul> </li> <li> <p>\u8003\u7814</p> </li> </ol> <p>\u6253\u7b97</p>"},{"location":"%E5%AD%A6%E4%B9%A0%E7%BB%8F%E9%AA%8C/#_3","title":"\u9879\u76ee","text":"<p>\u53ef\u4ee5\u5148\u5199\u70b9\u5c0f\u9879\u76ee\u7ec3\u7ec3\u624b</p> <p>\u4e3b\u8981\u8fd8\u662f\u9760\u81ea\u5b66</p> <p>\u591a\u901b\u901bgithub</p> <p>GitHub</p> <p>\u89c6\u9891\u770bB\u7ad9\u9ed1\u9a6c\u7a0b\u5e8f\u5458\uff0c\u5c1a\u7845\u8c37</p> <p>\u5b98\u65b9\u6587\u6863\uff1a</p> <p>MDN Web Docs</p> <p>Spring</p>"},{"location":"%E5%AD%A6%E4%B9%A0%E7%BB%8F%E9%AA%8C/#_4","title":"\u7b97\u6cd5\u7ade\u8d5b","text":"<p>\u5982\u679c\u60f3\u6253\u7b97\u6cd5\uff0c\u6211\u63a8\u8350\u770bAcWing\u7684\u7b97\u6cd5\u57fa\u7840\u8bfe\uff0c\u548c\u7b97\u6cd5\u63d0\u9ad8\u8bfe\u3002</p> <p>\u4f46\u662f\u7b97\u6cd5\u8fdb\u9636\u4e0d\u63a8\u8350\u770bAcwing\u7684\uff0c\u8fd8\u662fOI-wiki\u6bd4\u8f83\u597d</p> <p>\u5bd2\u5047\u53ef\u4ee5\u4e0acodeforce\u5199\u5199\u9898\u76ee</p> <p>Codeforces</p> <p>\u6d1b\u8c37</p>"},{"location":"%E5%AD%A6%E4%B9%A0%E7%BB%8F%E9%AA%8C/#_5","title":"\u4eba\u5de5\u667a\u80fd","text":"<p>\u591a\u5b9e\u8df5\uff0c\u591a\u5199\u70b9\u4ee3\u7801\uff0c\u4ece\u6a21\u4eff\u5f00\u59cb\uff0c\u7136\u540e\u518d\u81ea\u5df1\u72ec\u7acb\u5b9e\u73b0</p> <p>Kaggle</p> <p>Datawhale</p> <p>\u8ddf\u674e\u6c90\u5b66AI</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/","title":"\u6bd5\u4e1a\u8bbe\u8ba1","text":"<p>\u5173\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7684\u6bd5\u4e1a\u8bbe\u8ba1</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#_1","title":"\u6bd5\u4e1a\u8bbe\u8ba1\u9898\u76ee\uff1a\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7cfb\u7edf","text":""},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#1","title":"1. \u7814\u7a76\u80cc\u666f\u4e0e\u610f\u4e49","text":"<p>\u968f\u7740\u5168\u7403\u751f\u6001\u73af\u5883\u7684\u6076\u5316\u548c\u91ce\u751f\u52a8\u7269\u79cd\u7fa4\u7684\u51cf\u5c11\uff0c\u4fdd\u62a4\u91ce\u751f\u52a8\u7269\u5df2\u6210\u4e3a\u5168\u7403\u5173\u6ce8\u7684\u7126\u70b9\u3002\u4f20\u7edf\u7684\u91ce\u751f\u52a8\u7269\u76d1\u6d4b\u65b9\u6cd5\u4f9d\u8d56\u4e8e\u4eba\u5de5\u89c2\u5bdf\u548c\u624b\u52a8\u8bb0\u5f55\uff0c\u6548\u7387\u4f4e\u4e0b\u4e14\u5bb9\u6613\u51fa\u9519\u3002\u8fd1\u5e74\u6765\uff0c\u6df1\u5ea6\u5b66\u4e60\u6280\u672f\u5728\u56fe\u50cf\u8bc6\u522b\u9886\u57df\u53d6\u5f97\u4e86\u663e\u8457\u8fdb\u5c55\uff0c\u4e3a\u81ea\u52a8\u5316\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u63d0\u4f9b\u4e86\u65b0\u7684\u89e3\u51b3\u65b9\u6848\u3002\u901a\u8fc7\u6784\u5efa\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u91ce\u751f\u52a8\u7269\u7684\u9ad8\u6548\u3001\u51c6\u786e\u76d1\u6d4b\uff0c\u4e3a\u751f\u6001\u4fdd\u62a4\u548c\u751f\u7269\u591a\u6837\u6027\u7814\u7a76\u63d0\u4f9b\u6709\u529b\u652f\u6301\u3002</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#2","title":"2. \u7814\u7a76\u76ee\u6807","text":"<ul> <li>\u76ee\u68071\uff1a\u6784\u5efa\u4e00\u4e2a\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u56fe\u50cf\u8bc6\u522b\u6a21\u578b\uff0c\u80fd\u591f\u81ea\u52a8\u8bc6\u522b\u4e0d\u540c\u79cd\u7c7b\u7684\u91ce\u751f\u52a8\u7269\u3002</li> <li>\u76ee\u68072\uff1a\u4f18\u5316\u6a21\u578b\u6027\u80fd\uff0c\u63d0\u9ad8\u8bc6\u522b\u7684\u51c6\u786e\u7387\u548c\u9c81\u68d2\u6027\u3002</li> <li>\u76ee\u68073\uff1a\u5f00\u53d1\u4e00\u4e2a\u7528\u6237\u53cb\u597d\u7684\u754c\u9762\uff0c\u65b9\u4fbf\u7814\u7a76\u4eba\u5458\u548c\u73af\u4fdd\u5de5\u4f5c\u8005\u4f7f\u7528\u8be5\u7cfb\u7edf\u8fdb\u884c\u91ce\u751f\u52a8\u7269\u76d1\u6d4b\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#3","title":"3. \u7814\u7a76\u65b9\u6cd5","text":""},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#31","title":"3.1 \u6570\u636e\u96c6\u6536\u96c6\u4e0e\u9884\u5904\u7406","text":"<ul> <li>\u6570\u636e\u96c6\u6765\u6e90\uff1a\u4ece\u516c\u5f00\u7684\u91ce\u751f\u52a8\u7269\u56fe\u50cf\u6570\u636e\u5e93\uff08\u5982iNaturalist\u3001Wildlife Image Dataset\uff09\u4e2d\u83b7\u53d6\u6570\u636e\uff0c\u6216\u901a\u8fc7\u91ce\u5916\u6444\u50cf\u5934\u91c7\u96c6\u56fe\u50cf\u3002</li> <li>\u6570\u636e\u9884\u5904\u7406\uff1a\u5bf9\u56fe\u50cf\u8fdb\u884c\u6807\u6ce8\u3001\u88c1\u526a\u3001\u5f52\u4e00\u5316\u7b49\u64cd\u4f5c\uff0c\u786e\u4fdd\u6570\u636e\u8d28\u91cf\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#32","title":"3.2 \u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u9009\u62e9","text":"<ul> <li>\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\uff08CNN\uff09\uff1a\u4f5c\u4e3a\u56fe\u50cf\u8bc6\u522b\u7684\u6838\u5fc3\u6a21\u578b\uff0c\u53ef\u4ee5\u9009\u62e9\u7ecf\u5178\u7684CNN\u67b6\u6784\uff08\u5982ResNet\u3001VGG\u3001Inception\u7b49\uff09\u6216\u81ea\u5b9a\u4e49\u7f51\u7edc\u7ed3\u6784\u3002</li> <li>\u8fc1\u79fb\u5b66\u4e60\uff1a\u5229\u7528\u9884\u8bad\u7ec3\u6a21\u578b\uff08\u5982ImageNet\u4e0a\u7684\u9884\u8bad\u7ec3\u6743\u91cd\uff09\u8fdb\u884c\u5fae\u8c03\uff0c\u4ee5\u52a0\u901f\u8bad\u7ec3\u8fc7\u7a0b\u5e76\u63d0\u9ad8\u6a21\u578b\u6027\u80fd\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#33","title":"3.3 \u6a21\u578b\u8bad\u7ec3\u4e0e\u4f18\u5316","text":"<ul> <li>\u635f\u5931\u51fd\u6570\uff1a\u4f7f\u7528\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570\u8fdb\u884c\u5206\u7c7b\u4efb\u52a1\u3002</li> <li>\u4f18\u5316\u7b97\u6cd5\uff1a\u91c7\u7528Adam\u6216SGD\u7b49\u4f18\u5316\u7b97\u6cd5\u8fdb\u884c\u6a21\u578b\u8bad\u7ec3\u3002</li> <li>\u6570\u636e\u589e\u5f3a\uff1a\u901a\u8fc7\u65cb\u8f6c\u3001\u7f29\u653e\u3001\u7ffb\u8f6c\u7b49\u6570\u636e\u589e\u5f3a\u6280\u672f\u589e\u52a0\u6570\u636e\u7684\u591a\u6837\u6027\uff0c\u9632\u6b62\u8fc7\u62df\u5408\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#34","title":"3.4 \u6a21\u578b\u8bc4\u4f30","text":"<ul> <li>\u8bc4\u4f30\u6307\u6807\uff1a\u4f7f\u7528\u51c6\u786e\u7387\uff08Accuracy\uff09\u3001\u7cbe\u786e\u7387\uff08Precision\uff09\u3001\u53ec\u56de\u7387\uff08Recall\uff09\u548cF1\u5206\u6570\u7b49\u6307\u6807\u8bc4\u4f30\u6a21\u578b\u6027\u80fd\u3002</li> <li>\u6df7\u6dc6\u77e9\u9635\uff1a\u5206\u6790\u6a21\u578b\u7684\u5206\u7c7b\u9519\u8bef\u60c5\u51b5\uff0c\u627e\u51fa\u8bc6\u522b\u6548\u679c\u8f83\u5dee\u7684\u7c7b\u522b\u5e76\u8fdb\u884c\u9488\u5bf9\u6027\u4f18\u5316\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#4","title":"4. \u7cfb\u7edf\u8bbe\u8ba1\u4e0e\u5b9e\u73b0","text":""},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#41","title":"4.1 \u7cfb\u7edf\u67b6\u6784","text":"<ul> <li>\u5ba2\u6237\u7aef\uff1a</li> </ul> <p>#### 4.1 \u7cfb\u7edf\u67b6\u6784 - \u5ba2\u6237\u7aef\uff1aqt</p> <p>### \u6bd5\u4e1a\u8bbe\u8ba1\uff1a\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7cfb\u7edf</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#1_1","title":"1. \u7814\u7a76\u80cc\u666f\u4e0e\u610f\u4e49","text":"<p>\u968f\u7740\u5168\u7403\u751f\u6001\u73af\u5883\u7684\u6076\u5316\u548c\u91ce\u751f\u52a8\u7269\u79cd\u7fa4\u7684\u51cf\u5c11\uff0c\u4fdd\u62a4\u91ce\u751f\u52a8\u7269\u5df2\u6210\u4e3a\u5168\u7403\u5173\u6ce8\u7684\u7126\u70b9\u3002\u4f20\u7edf\u7684\u91ce\u751f\u52a8\u7269\u76d1\u6d4b\u65b9\u6cd5\u4f9d\u8d56\u4e8e\u4eba\u5de5\u89c2\u5bdf\u548c\u624b\u52a8\u8bb0\u5f55\uff0c\u6548\u7387\u4f4e\u4e0b\u4e14\u5bb9\u6613\u51fa\u9519\u3002\u8fd1\u5e74\u6765\uff0c\u6df1\u5ea6\u5b66\u4e60\u6280\u672f\u5728\u56fe\u50cf\u8bc6\u522b\u9886\u57df\u53d6\u5f97\u4e86\u663e\u8457\u8fdb\u5c55\uff0c\u4e3a\u81ea\u52a8\u5316\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u63d0\u4f9b\u4e86\u65b0\u7684\u89e3\u51b3\u65b9\u6848\u3002\u901a\u8fc7\u6784\u5efa\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u91ce\u751f\u52a8\u7269\u7684\u9ad8\u6548\u3001\u51c6\u786e\u76d1\u6d4b\uff0c\u4e3a\u751f\u6001\u4fdd\u62a4\u548c\u751f\u7269\u591a\u6837\u6027\u7814\u7a76\u63d0\u4f9b\u6709\u529b\u652f\u6301\u3002</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#2_1","title":"2. \u7814\u7a76\u76ee\u6807","text":"<ul> <li>\u76ee\u68071\uff1a\u6784\u5efa\u4e00\u4e2a\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u56fe\u50cf\u8bc6\u522b\u6a21\u578b\uff0c\u80fd\u591f\u81ea\u52a8\u8bc6\u522b\u4e0d\u540c\u79cd\u7c7b\u7684\u91ce\u751f\u52a8\u7269\u3002</li> <li>\u76ee\u68072\uff1a\u4f18\u5316\u6a21\u578b\u6027\u80fd\uff0c\u63d0\u9ad8\u8bc6\u522b\u7684\u51c6\u786e\u7387\u548c\u9c81\u68d2\u6027\u3002</li> <li>\u76ee\u68073\uff1a\u5f00\u53d1\u4e00\u4e2a\u7528\u6237\u53cb\u597d\u7684\u754c\u9762\uff0c\u65b9\u4fbf\u7814\u7a76\u4eba\u5458\u548c\u73af\u4fdd\u5de5\u4f5c\u8005\u4f7f\u7528\u8be5\u7cfb\u7edf\u8fdb\u884c\u91ce\u751f\u52a8\u7269\u76d1\u6d4b\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#3_1","title":"3. \u7814\u7a76\u65b9\u6cd5","text":""},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#31_1","title":"3.1 \u6570\u636e\u96c6\u6536\u96c6\u4e0e\u9884\u5904\u7406","text":"<ul> <li>\u6570\u636e\u96c6\u6765\u6e90\uff1a\u4ece\u516c\u5f00\u7684\u91ce\u751f\u52a8\u7269\u56fe\u50cf\u6570\u636e\u5e93\uff08\u5982iNaturalist\u3001Wildlife Image Dataset\uff09\u4e2d\u83b7\u53d6\u6570\u636e\uff0c\u6216\u901a\u8fc7\u91ce\u5916\u6444\u50cf\u5934\u91c7\u96c6\u56fe\u50cf\u3002</li> <li>\u6570\u636e\u9884\u5904\u7406\uff1a\u5bf9\u56fe\u50cf\u8fdb\u884c\u6807\u6ce8\u3001\u88c1\u526a\u3001\u5f52\u4e00\u5316\u7b49\u64cd\u4f5c\uff0c\u786e\u4fdd\u6570\u636e\u8d28\u91cf\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#32_1","title":"3.2 \u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u9009\u62e9","text":"<ul> <li>\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\uff08CNN\uff09\uff1a\u4f5c\u4e3a\u56fe\u50cf\u8bc6\u522b\u7684\u6838\u5fc3\u6a21\u578b\uff0c\u53ef\u4ee5\u9009\u62e9\u7ecf\u5178\u7684CNN\u67b6\u6784\uff08\u5982ResNet\u3001VGG\u3001Inception\u7b49\uff09\u6216\u81ea\u5b9a\u4e49\u7f51\u7edc\u7ed3\u6784\u3002</li> <li>\u8fc1\u79fb\u5b66\u4e60\uff1a\u5229\u7528\u9884\u8bad\u7ec3\u6a21\u578b\uff08\u5982ImageNet\u4e0a\u7684\u9884\u8bad\u7ec3\u6743\u91cd\uff09\u8fdb\u884c\u5fae\u8c03\uff0c\u4ee5\u52a0\u901f\u8bad\u7ec3\u8fc7\u7a0b\u5e76\u63d0\u9ad8\u6a21\u578b\u6027\u80fd\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#33_1","title":"3.3 \u6a21\u578b\u8bad\u7ec3\u4e0e\u4f18\u5316","text":"<ul> <li>\u635f\u5931\u51fd\u6570\uff1a\u4f7f\u7528\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570\u8fdb\u884c\u5206\u7c7b\u4efb\u52a1\u3002</li> <li>\u4f18\u5316\u7b97\u6cd5\uff1a\u91c7\u7528Adam\u6216SGD\u7b49\u4f18\u5316\u7b97\u6cd5\u8fdb\u884c\u6a21\u578b\u8bad\u7ec3\u3002</li> <li>\u6570\u636e\u589e\u5f3a\uff1a\u901a\u8fc7\u65cb\u8f6c\u3001\u7f29\u653e\u3001\u7ffb\u8f6c\u7b49\u6570\u636e\u589e\u5f3a\u6280\u672f\u589e\u52a0\u6570\u636e\u7684\u591a\u6837\u6027\uff0c\u9632\u6b62\u8fc7\u62df\u5408\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#34_1","title":"3.4 \u6a21\u578b\u8bc4\u4f30","text":"<ul> <li>\u8bc4\u4f30\u6307\u6807\uff1a\u4f7f\u7528\u51c6\u786e\u7387\uff08Accuracy\uff09\u3001\u7cbe\u786e\u7387\uff08Precision\uff09\u3001\u53ec\u56de\u7387\uff08Recall\uff09\u548cF1\u5206\u6570\u7b49\u6307\u6807\u8bc4\u4f30\u6a21\u578b\u6027\u80fd\u3002</li> <li>\u6df7\u6dc6\u77e9\u9635\uff1a\u5206\u6790\u6a21\u578b\u7684\u5206\u7c7b\u9519\u8bef\u60c5\u51b5\uff0c\u627e\u51fa\u8bc6\u522b\u6548\u679c\u8f83\u5dee\u7684\u7c7b\u522b\u5e76\u8fdb\u884c\u9488\u5bf9\u6027\u4f18\u5316\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#4_1","title":"4. \u7cfb\u7edf\u8bbe\u8ba1\u4e0e\u5b9e\u73b0","text":""},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#41_1","title":"4.1 \u7cfb\u7edf\u67b6\u6784","text":"<ul> <li>\u5ba2\u6237\u7aef\uff1a<ul> <li>\u524d\u7aef\u6846\u67b6: Qt\u6846\u67b6\u7528\u4e8e\u5f00\u53d1\u684c\u9762\u5e94\u7528\u7a0b\u5e8f\u7684\u7528\u6237\u754c\u9762\u3002Qt\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684UI\u7ec4\u4ef6\u548c\u8de8\u5e73\u53f0\u652f\u6301,\u9002\u5408\u5f00\u53d1\u9ad8\u6027\u80fd\u7684\u672c\u5730\u5e94\u7528. -\u529f\u80fd\u6a21\u5757:\u5305\u62ec\u56fe\u50cf\u4e0a\u4f20,\u5b9e\u65f6\u89c6\u9891\u6d41\u5904\u7406,\u7ed3\u679c\u663e\u793a\u7b49\u529f\u80fd. -\u7528\u6237\u4f53\u9a8c:\u786e\u4fdd\u754c\u9762\u7b80\u6d01\u76f4\u89c2,\u64cd\u4f5c\u6d41\u7545.</li> </ul> </li> </ul> <p>-\u540e\u7aef\u670d\u52a1:      -\u6846\u67b6\u9009\u62e9:Flask\u6216Django\u4f5c\u4e3a\u540e\u7aef\u6846\u67b6,\u63d0\u4f9bRESTful API\u63a5\u53e3.     -\u6570\u636e\u5904\u7406:\u63a5\u6536\u5ba2\u6237\u7aef\u4e0a\u4f20\u7684\u56fe\u50cf\u6216\u89c6\u9891\u6d41,\u8c03\u7528\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u8fdb\u884c\u63a8\u7406.     -\u7ed3\u679c\u8fd4\u56de**:\u5c06\u8bc6\u522b\u7ed3\u679c\u4ee5JSON\u683c\u5f0f\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef.</p> <p>-\u6570\u636e\u5e93:      -\u7c7b\u578b\u9009\u62e9:SQLite\u6216MySQL\u7528\u4e8e\u5b58\u50a8\u7528\u6237\u6570\u636e\u548c\u8bc6\u522b\u8bb0\u5f55.     -\u6570\u636e\u7ed3\u6784\u8bbe\u8ba1:\u8bbe\u8ba1\u5408\u7406\u7684\u8868\u7ed3\u6784,\u652f\u6301\u9ad8\u6548\u7684\u6570\u636e\u67e5\u8be2\u548c\u7ba1\u7406.</p> <p>-\u6df1\u5ea6\u5b66\u4e60\u6a21\u5757:      -\u6a21\u578b\u90e8\u7f72:\u5c06\u8bad\u7ec3\u597d\u7684\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u96c6\u6210\u5230\u7cfb\u7edf\u4e2d,\u652f\u6301\u6279\u91cf\u63a8\u7406\u548c\u5b9e\u65f6\u63a8\u7406.     -\u6027\u80fd\u4f18\u5316:\u901a\u8fc7\u91cf\u5316,\u526a\u679d\u7b49\u6280\u672f\u4f18\u5316\u6a21\u578b\u7684\u63a8\u7406\u901f\u5ea6\u548c\u8d44\u6e90\u5360\u7528.</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#5","title":"5.\u9884\u671f\u6210\u679c","text":"<p>1.\u7cfb\u7edf\u539f\u578b:\u4e00\u4e2a\u529f\u80fd\u5b8c\u5584\u7684\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7cfb\u7edf\u539f\u578b. 2.\u9ad8\u7cbe\u5ea6\u6a21\u578b:\u5728\u6d4b\u8bd5\u96c6\u4e0a\u8fbe\u523085%\u4ee5\u4e0a\u7684\u5206\u7c7b\u51c6\u786e\u7387. 3.\u6587\u6863\u8d44\u6599:\u5305\u62ec\u8bbe\u8ba1\u6587\u6863,\u4f7f\u7528\u624b\u518c\u548c\u5b9e\u9a8c\u62a5\u544a.</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#6","title":"6.\u521b\u65b0\u70b9","text":"<p>1.\u591a\u6a21\u6001\u878d\u5408:\u7ed3\u5408\u7ea2\u5916\u6444\u50cf\u5934\u548c\u53ef\u89c1\u5149\u6444\u50cf\u5934\u7684\u591a\u6a21\u6001\u6570\u636e,\u63d0\u5347\u591c\u95f4\u6216\u590d\u6742\u73af\u5883\u4e0b\u7684\u8bc6\u522b\u6548\u679c. 2.\u5b9e\u65f6\u76d1\u6d4b\u529f\u80fd:\u5728\u7cfb\u7edf\u4e2d\u52a0\u5165\u5b9e\u65f6\u89c6\u9891\u6d41\u5904\u7406\u529f\u80fd,\u5b9e\u73b0\u5bf9\u91ce\u5916\u73af\u5883\u7684\u5b9e\u65f6\u76d1\u63a7\u548c\u52a8\u7269\u884c\u4e3a\u5206\u6790. 3.\u8f7b\u91cf\u5316\u90e8\u7f72:\u5c06\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u90e8\u7f72\u5230\u8fb9\u7f18\u8bbe\u5907(\u5982\u65e0\u4eba\u673a,\u667a\u80fd\u6444\u50cf\u5934),\u5b9e\u73b0\u4f4e\u5ef6\u8fdf,\u9ad8\u6548\u7387\u7684\u73b0\u573a\u5e94\u7528.</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#7","title":"7.\u65f6\u95f4\u8ba1\u5212","text":"\u9636\u6bb5 \u65f6\u95f4 \u4efb\u52a1 \u7b2c\u4e00\u9636\u6bb5 \u7b2c1\u5468\u81f3\u7b2c4\u5468 \u6587\u732e\u8c03\u7814,\u786e\u5b9a\u7814\u7a76\u65b9\u5411\u548c\u6280\u672f\u8def\u7ebf \u7b2c\u4e8c\u9636\u6bb5 \u7b2c5\u5468\u81f3\u7b2c8\u5468 \u6570\u636e\u96c6\u6536\u96c6\u4e0e\u9884\u5904\u7406 \u7b2c\u4e09\u9636\u6bb5 \u7b2c9\u5468\u81f3\u7b2c12\u5468 \u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u7684\u642d\u5efa\u4e0e\u8bad\u7ec3 \u7b2c\u56db\u9636\u6bb5 \u7b2c\u5341\u4e09\u5468\u5230\u7b2c\u5341\u516d\u5468 \u7cfb\u7edf\u8bbe\u8ba1\u4e0e\u5b9e\u73b0 \u7b2c\u4e94\u9636\u6bb5 \u7b2c\u5341\u4e03\u5468\u5230\u7b2c\u4e8c\u5341\u5468 \u6d4b\u8bd5\u4e0e\u4f18\u5316 \u7b2c\u516d\u9636\u6bb5 \u7b2c\u4e8c\u5341\u4e00\u5468\u5230\u7b2c\u4e8c\u5341\u56db\u5468 \u64b0\u5199\u8bba\u6587\u5e76\u51c6\u5907\u7b54\u8fa9 <p>8 .\u53c2\u8003\u6587\u732e</p> <p>[\u6b64\u5904\u5217\u51fa\u76f8\u5173\u53c2\u8003\u6587\u732e]</p> <p>\u8fd9\u4e2a\u6bd5\u4e1a\u8bbe\u8ba1\u9898\u76ee\u7ed3\u5408\u4e86\u5f53\u524d\u70ed\u95e8\u7684\u6df1\u5ea6\u5b66\u4e60\u6280\u672f\u548c\u751f\u6001\u4fdd\u62a4\u7684\u5b9e\u9645\u9700\u6c42 ,\u5177\u6709\u8f83\u9ad8\u7684\u7814\u7a76\u4ef7\u503c\u548c\u5e94\u7528\u524d\u666f .\u901a\u8fc7\u8be5\u9879\u76ee\u7684\u5b9e\u65bd ,\u4e0d\u4ec5\u53ef\u4ee5\u63d0\u5347\u4f60\u5728\u4eba\u5de5\u667a\u80fd\u9886\u57df\u7684\u5b9e\u8df5\u80fd\u529b ,\u8fd8\u80fd\u4e3a\u91ce\u751f\u52a8\u7269\u7684\u4fdd\u62a4\u5de5\u4f5c\u505a\u51fa\u8d21\u732e .</p> <p>\u4e09 \u3001\u672c\u8bfe\u9898\u8bbe\u8ba1\u548c\u5b9e\u73b0\u7684\u5177\u4f53\u8981\u6c42 \uff08\u652f\u6491\u8bfe\u7a0b\u76ee\u68073 \uff09</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#1_2","title":"1 .\u6280\u672f\u9009\u578b\u4e0e\u5de5\u5177\u4f7f\u7528","text":"<p>-\u6df1\u5ea6\u5b66\u4e60\u6846\u67b6 :\u9009\u62e9\u4e3b\u6d41\u7684\u6df1\u5ea6\u5b66\u4e60\u6846\u67b6 \uff08\u5982TensorFlow \u3001PyTorch\u6216Keras \uff09\u8fdb\u884c\u6a21\u578b\u7684\u642d\u5efa\u548c\u8bad\u7ec3 . -\u7f16\u7a0b\u8bed\u8a00 :\u4f7f\u7528Python\u4f5c\u4e3a\u4e3b\u8981\u7f16\u7a0b\u8bed\u8a00 ,\u7ed3\u5408\u5fc5\u8981\u7684\u5e93 \uff08\u5982NumPy \u3001Pandas \u3001OpenCV\u7b49 \uff09\u8fdb\u884c\u6570\u636e\u5904\u7406\u548c\u56fe\u50cf\u5904\u7406 . -\u524d\u7aef\u5f00\u53d1 :Qt\u6846\u67b6\u7528\u4e8e\u5f00\u53d1\u684c\u9762\u5e94\u7528\u7a0b\u5e8f\u7684\u7528\u6237\u754c\u9762 . -\u540e\u7aef\u5f00\u53d1 :\u9009\u62e9Flask\u6216Django\u4f5c\u4e3a\u540e\u7aef\u6846\u67b6 ,\u642d\u5efaRESTful API\u4ee5\u652f\u6301\u524d\u540e\u7aef\u4ea4\u4e92 . -**\u6570\u636e\u5e93 :\u4f7f\u7528SQLite\u6216MySQL\u7b49\u8f7b\u91cf\u7ea7\u6570\u636e\u5e93\u5b58\u50a8\u7528\u6237\u6570\u636e\u548c\u8bc6\u522b\u7ed3\u679c .</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#2_2","title":"2 .\u6570\u636e\u96c6\u8981\u6c42","text":"<p>-\u6570\u636e\u89c4\u6a21 :\u6536\u96c6\u81f3\u5c115000\u5f20\u91ce\u751f\u52a8\u7269\u56fe\u50cf ,\u6db5\u76d6\u81f3\u5c1120\u79cd\u4e0d\u540c\u7684\u91ce\u751f\u52a8\u7269\u7c7b\u522b . -\u6570\u636e\u8d28\u91cf :\u786e\u4fdd\u56fe\u50cf\u6e05\u6670\u5ea6\u9ad8 \u3001\u80cc\u666f\u590d\u6742\u5ea6\u9002\u4e2d ,\u907f\u514d\u6a21\u7cca\u6216\u8fc7\u5ea6\u906e\u6321\u7684\u56fe\u50cf . -**\u6570\u636e\u6807\u6ce8 :\u5bf9\u6bcf\u5f20\u56fe\u50cf\u8fdb\u884c\u51c6\u786e\u7684\u7c7b\u522b\u6807\u6ce8 ,\u786e\u4fdd\u6570\u636e\u96c6\u7684\u8d28\u91cf\u548c\u53ef\u7528\u6027 .</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#3_2","title":"3 .\u6a21\u578b\u8bbe\u8ba1\u4e0e\u4f18\u5316","text":"<p>-\u6a21\u578b\u67b6\u6784 :\u9009\u62e9\u7ecf\u5178\u7684\u5377\u79ef\u795e\u7ecf\u7f51\u7edc \uff08CNN \uff09\u67b6\u6784 \uff08\u5982ResNet \u3001VGG\u6216Inception \uff09 ,\u5e76\u6839\u636e\u4efb\u52a1\u9700\u6c42\u8fdb\u884c\u9002\u5f53\u7684\u8c03\u6574 . -\u8fc1\u79fb\u5b66\u4e60 :\u5229\u7528\u9884\u8bad\u7ec3\u6a21\u578b \uff08\u5982ImageNet\u4e0a\u7684\u9884\u8bad\u7ec3\u6743\u91cd \uff09\u8fdb\u884c\u5fae\u8c03 ,\u4ee5\u63d0\u9ad8\u6a21\u578b\u7684\u6cdb\u5316\u80fd\u529b\u548c\u8bad\u7ec3\u6548\u7387 . -\u8d85\u53c2\u6570\u8c03\u4f18 :\u901a\u8fc7\u5b9e\u9a8c\u786e\u5b9a\u6700\u4f73\u7684\u5b66\u4e60\u7387 \u3001\u6279\u91cf\u5927\u5c0f \u3001\u4f18\u5316\u7b97\u6cd5\u7b49\u8d85\u53c2\u6570 . -\u6570\u636e\u589e\u5f3a :\u91c7\u7528\u65cb\u8f6c \u3001\u7f29\u653e \u3001\u7ffb\u8f6c\u7b49\u6570\u636e\u589e\u5f3a\u6280\u672f ,\u589e\u52a0\u6570\u636e\u7684\u591a\u6837\u6027 ,\u9632\u6b62\u6a21\u578b\u8fc7\u62df\u5408 .</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#4_2","title":"4 .\u7cfb\u7edf\u529f\u80fd\u4e0e\u6027\u80fd\u8981\u6c42","text":"<p>-**\u56fe\u50cf\u4e0a\u4f20\u4e0e\u8bc6\u522b\u529f\u80fd :\u7cfb\u7edf\u5e94\u652f\u6301\u7528\u6237\u4e0a\u4f20\u91ce\u751f\u52a8\u7269\u56fe\u50cf \uff0c\u5e76\u80fd\u591f\u5feb\u901f\u8fd4\u56de\u8bc6\u522b\u7ed3\u679c \u3002 \u2014\u5b9e\u65f6\u76d1\u6d4b\u529f\u80fd \uff08\u53ef\u9009 \uff09:\u5982\u679c\u65f6\u95f4\u548c\u6280\u672f\u5141\u8bb8 \uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5b9e\u73b0\u5b9e\u65f6\u89c6\u9891\u6d41\u5904\u7406\u529f\u80fd \uff0c\u652f\u6301\u5bf9\u91ce\u5916\u73af\u5883\u7684\u5b9e\u65f6\u76d1\u63a7 \u3002 \u2014\u8bc6\u522b\u51c6\u786e\u7387 \uff1a\u6a21\u578b\u7684\u5206\u7c7b\u51c6\u786e\u7387\u5e94\u8fbe\u523085 %\u4ee5\u4e0a \uff0c\u5bf9\u4e8e\u5e38\u89c1\u91ce\u751f\u52a8\u7269\u7684\u8bc6\u522b\u51c6\u786e\u7387\u5e94\u8fbe\u523090 %\u4ee5\u4e0a \u3002 \u2014\u54cd\u5e94\u65f6\u95f4 \uff1a\u7cfb\u7edf\u7684\u54cd\u5e94\u65f6\u95f4\u5e94\u63a7\u5236\u57285\u79d2\u4ee5\u5185 \uff0c\u786e\u4fdd\u7528\u6237\u4f53\u9a8c\u6d41\u7545 \u3002</p> <p>5 \uff0e\u7cfb\u7edf\u6d4b\u8bd5\u4e0e\u8bc4\u4f30</p> <p>\u2014\u5355\u5143\u6d4b\u8bd5 \uff1a\u5bf9\u7cfb\u7edf\u7684\u5404\u4e2a\u6a21\u5757\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5 \uff0c\u786e\u4fdd\u6bcf\u4e2a\u6a21\u5757\u7684\u529f\u80fd\u6b63\u5e38 \u3002 \u2014\u96c6\u6210\u6d4b\u8bd5 \uff1a\u5bf9\u6574\u4e2a\u7cfb\u7edf\u8fdb\u884c\u96c6\u6210\u6d4b\u8bd5 \uff0c\u9a8c\u8bc1\u524d\u540e\u7aef\u7684\u4ea4\u4e92\u662f\u5426\u987a\u7545 \u3002 \u2014\u6027\u80fd\u6d4b\u8bd5 \uff1a\u8bc4\u4f30\u7cfb\u7edf\u5728\u9ad8\u5e76\u53d1\u60c5\u51b5\u4e0b\u7684\u8868\u73b0 \uff0c\u786e\u4fdd\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u548c\u53ef\u9760\u6027 \u3002 \u2014\u7528\u6237\u6d4b\u8bd5 \uff1a\u9080\u8bf7\u6f5c\u5728\u7528\u6237 \uff08\u5982\u7814\u7a76\u4eba\u5458 \uff0c\u73af\u4fdd\u5de5\u4f5c\u8005 \uff09\u8fdb\u884c\u8bd5\u7528 \uff0c\u6536\u96c6\u53cd\u9988\u5e76\u8fdb\u884c\u6539\u8fdb \u3002</p> <p>6 \uff0e\u6587\u6863\u7f16\u5199</p> <p>\u2014\u8bbe\u8ba1\u6587\u6863 \uff1a\u8be6\u7ec6\u8bb0\u5f55\u7cfb\u7edf\u7684\u8bbe\u8ba1\u601d\u8def \uff0c\u6280\u672f\u9009\u578b \uff0c\u6a21\u5757\u5212\u5206\u7b49\u5185\u5bb9 \u3002 \u2014\u4f7f\u7528\u624b\u518c \uff1a\u7f16\u5199\u7cfb\u7edf\u7684\u4f7f\u7528\u8bf4\u660e \uff0c\u6307\u5bfc\u7528\u6237\u5982\u4f55\u4e0a\u4f20\u56fe\u50cf \uff0c\u67e5\u770b\u8bc6\u522b\u7ed3\u679c\u7b49 \u3002 \u2014\u5b9e\u9a8c\u62a5\u544a \uff1a\u8bb0\u5f55\u6a21\u578b\u7684\u8bad\u7ec3\u8fc7\u7a0b \uff0c\u4f18\u5316\u65b9\u6cd5\u4ee5\u53ca\u6700\u7ec8\u7684\u8bc4\u4f30\u7ed3\u679c \u3002</p> <p>7 \uff0e\u521b\u65b0\u6027\u4e0e\u6269\u5c55\u6027</p> <p>\u2014\u521b\u65b0\u70b9 \uff1a\u5728\u7cfb\u7edf\u4e2d\u5f15\u5165\u591a\u6a21\u6001\u878d\u5408 \uff08\u5982\u7ea2\u5916\u6444\u50cf\u5934\u6570\u636e \uff09\u6216\u8f7b\u91cf\u5316\u90e8\u7f72 \uff08\u8fb9\u7f18\u8bbe\u5907 \uff09\u7b49\u521b\u65b0\u70b9 \uff0c\u63d0\u5347\u7cfb\u7edf\u7684\u5b9e\u7528\u6027\u548c\u5148\u8fdb\u6027 \u3002 \u2014\u6269\u5c55\u6027 \uff1a\u8bbe\u8ba1\u65f6\u5e94\u8003\u8651\u7cfb\u7edf\u7684\u53ef\u6269\u5c55\u6027 \uff0c\u4fbf\u4e8e\u672a\u6765\u589e\u52a0\u65b0\u7684\u52a8\u7269\u7c7b\u522b\u6216\u529f\u80fd\u6a21\u5757 \u3002</p> <p>8 \uff0e\u65f6\u95f4\u7ba1\u7406\u4e0e\u8fdb\u5ea6\u63a7\u5236</p> <p>\u2014\u9636\u6bb5\u6027\u76ee\u6807 \uff1a\u6309\u7167\u65f6\u95f4\u8ba1\u5212\u8868\u5b8c\u6210\u6bcf\u4e2a\u9636\u6bb5\u7684\u4efb\u52a1</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#42","title":"4.2 \u529f\u80fd\u6a21\u5757","text":"<ul> <li>\u56fe\u50cf\u4e0a\u4f20\u6a21\u5757\uff1a  </li> <li>\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\uff1a\u652f\u6301\u5e38\u89c1\u7684\u56fe\u50cf\u683c\u5f0f\uff08\u5982JPG\u3001PNG\uff09\uff0c\u5e76\u5bf9\u6587\u4ef6\u5927\u5c0f\u8fdb\u884c\u9650\u5236\uff08\u5982\u4e0d\u8d85\u8fc710MB\uff09\u3002  </li> <li> <p>\u5b9e\u65f6\u62cd\u6444\u529f\u80fd\uff08\u53ef\u9009\uff09\uff1a\u901a\u8fc7\u8c03\u7528\u8bbe\u5907\u7684\u6444\u50cf\u5934API\uff0c\u5141\u8bb8\u7528\u6237\u76f4\u63a5\u62cd\u6444\u91ce\u751f\u52a8\u7269\u56fe\u50cf\u5e76\u4e0a\u4f20\u3002  </p> </li> <li> <p>\u56fe\u50cf\u5904\u7406\u6a21\u5757\uff1a  </p> </li> <li>\u9884\u5904\u7406\u529f\u80fd\uff1a\u5bf9\u4e0a\u4f20\u7684\u56fe\u50cf\u8fdb\u884c\u7f29\u653e\u3001\u5f52\u4e00\u5316\u7b49\u64cd\u4f5c\uff0c\u786e\u4fdd\u8f93\u5165\u6a21\u578b\u7684\u56fe\u50cf\u5c3a\u5bf8\u548c\u683c\u5f0f\u4e00\u81f4\u3002  </li> <li> <p>\u538b\u7f29\u4e0e\u4f18\u5316\uff1a\u5bf9\u56fe\u50cf\u8fdb\u884c\u538b\u7f29\u4ee5\u51cf\u5c11\u4f20\u8f93\u65f6\u95f4\uff0c\u540c\u65f6\u4fdd\u8bc1\u56fe\u50cf\u8d28\u91cf\u4e0d\u5f71\u54cd\u8bc6\u522b\u6548\u679c\u3002  </p> </li> <li> <p>\u6a21\u578b\u9884\u6d4b\u6a21\u5757\uff1a  </p> </li> <li>API\u8c03\u7528\uff1a\u901a\u8fc7RESTful API\u4e0e\u540e\u7aef\u670d\u52a1\u5668\u901a\u4fe1\uff0c\u5c06\u9884\u5904\u7406\u540e\u7684\u56fe\u50cf\u53d1\u9001\u81f3\u670d\u52a1\u5668\u8fdb\u884c\u8bc6\u522b\u3002  </li> <li> <p>\u7ed3\u679c\u89e3\u6790\uff1a\u63a5\u6536\u670d\u52a1\u5668\u8fd4\u56de\u7684JSON\u683c\u5f0f\u7684\u8bc6\u522b\u7ed3\u679c\uff0c\u5e76\u89e3\u6790\u51fa\u52a8\u7269\u7c7b\u522b\u548c\u7f6e\u4fe1\u5ea6\u7b49\u4fe1\u606f\u3002  </p> </li> <li> <p>\u7ed3\u679c\u5c55\u793a\u6a21\u5757\uff1a  </p> </li> <li>\u53ef\u89c6\u5316\u5c55\u793a\uff1a\u4ee5\u5361\u7247\u6216\u8868\u683c\u7684\u5f62\u5f0f\u5c55\u793a\u8bc6\u522b\u7ed3\u679c\uff0c\u5305\u62ec\u52a8\u7269\u540d\u79f0\u3001\u56fe\u7247\u3001\u7f6e\u4fe1\u5ea6\u548c\u76f8\u5173\u751f\u6001\u4fe1\u606f\u3002  </li> <li>\u4ea4\u4e92\u529f\u80fd\uff1a\u5141\u8bb8\u7528\u6237\u70b9\u51fb\u7ed3\u679c\u67e5\u770b\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff08\u5982\u8be5\u52a8\u7269\u7684\u5206\u5e03\u5730\u56fe\u3001\u4fdd\u62a4\u7b49\u7ea7\u7b49\uff09\u3002  </li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#43","title":"4.3 \u7cfb\u7edf\u96c6\u6210","text":"<ul> <li>\u524d\u540e\u7aef\u901a\u4fe1\u673a\u5236\uff1a</li> <li>\u4f7f\u7528HTTP/HTTPS\u534f\u8bae\u8fdb\u884c\u524d\u540e\u7aef\u901a\u4fe1\uff0c\u786e\u4fdd\u6570\u636e\u4f20\u8f93\u7684\u5b89\u5168\u6027\u3002</li> <li>\u91c7\u7528JSON\u683c\u5f0f\u4f5c\u4e3a\u6570\u636e\u4ea4\u6362\u7684\u6807\u51c6\u683c\u5f0f\u3002</li> <li>\u5f02\u6b65\u5904\u7406\u673a\u5236:\u5bf9\u4e8e\u5927\u6587\u4ef6\u4e0a\u4f20\u6216\u590d\u6742\u8ba1\u7b97\u4efb\u52a1,\u91c7\u7528\u5f02\u6b65\u5904\u7406\u673a\u5236,\u907f\u514d\u963b\u585e\u4e3b\u7ebf\u7a0b,\u63d0\u5347\u7528\u6237\u4f53\u9a8c.</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#4-4","title":"4 .4\u5b89\u5168\u6027\u8003\u8651","text":"<p>-\u6570\u636e\u52a0\u5bc6:\u5bf9\u654f\u611f\u6570\u636e(\u5982\u7528\u6237\u4fe1\u606f)\u8fdb\u884c\u52a0\u5bc6\u5b58\u50a8\u548c\u4f20\u8f93. -\u6743\u9650\u63a7\u5236:\u5b9e\u73b0\u7528\u6237\u767b\u5f55\u548c\u6743\u9650\u7ba1\u7406,\u786e\u4fdd\u53ea\u6709\u6388\u6743\u7528\u6237\u53ef\u4ee5\u8bbf\u95ee\u7cfb\u7edf\u7684\u6838\u5fc3\u529f\u80fd. -\u9632\u6b62\u6076\u610f\u653b\u51fb:\u91c7\u53d6\u5fc5\u8981\u7684\u63aa\u65bd(\u5982\u8f93\u5165\u9a8c\u8bc1,\u9632\u6b62SQL\u6ce8\u5165)\u6765\u4fdd\u62a4\u7cfb\u7edf\u514d\u53d7\u7f51\u7edc\u653b\u51fb.</p> <p>\u901a\u8fc7\u4ee5\u4e0a\u8bbe\u8ba1\u548c\u5b9e\u73b0,\u5ba2\u6237\u7aef\u5c06\u6210\u4e3a\u4e00\u4e2a\u9ad8\u6548,\u6613\u7528\u4e14\u5b89\u5168\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7cfb\u7edf\u5165\u53e3,\u4e3a\u7528\u6237\u63d0\u4f9b\u4fbf\u6377\u7684\u64cd\u4f5c\u4f53\u9a8c\u548c\u51c6\u786e\u7684\u8bc6\u522b\u7ed3\u679c.</p> <p>\u53c2\u8003\u6587\u732e</p> <p>[\u6b64\u5904\u5217\u51fa\u76f8\u5173\u53c2\u8003\u6587\u732e]</p> <p>\u4ee5\u4e0a\u5185\u5bb9\u8fdb\u4e00\u6b65\u5b8c\u5584\u4e86\u7cfb\u7edf\u7684\u5ba2\u6237\u7aef\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u90e8\u5206,\u786e\u4fdd\u4e86\u7cfb\u7edf\u7684\u53ef\u7528\u6027,\u5b89\u5168\u6027\u548c\u7528\u6237\u4f53\u9a8c.\u63a5\u4e0b\u6765\u53ef\u4ee5\u7ee7\u7eed\u5b8c\u5584\u5176\u4ed6\u90e8\u5206\u7684\u5185\u5bb9(\u5982\u540e\u7aef\u8bbe\u8ba1,\u6570\u636e\u5e93\u8bbe\u8ba1\u7b49),\u4ee5\u5f62\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u6bd5\u4e1a\u8bbe\u8ba1\u65b9\u6848.</p> <p>\u5982\u679c\u9700\u8981\u8fdb\u4e00\u6b65\u8865\u5145\u6216\u4fee\u6539\u5176\u4ed6\u90e8\u5206\u7684\u5185\u5bb9,\u8bf7\u968f\u65f6\u544a\u77e5!</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#42_1","title":"4.2 \u529f\u80fd\u6a21\u5757","text":"<ul> <li>\u56fe\u50cf\u4e0a\u4f20\u6a21\u5757\uff1a\u5141\u8bb8\u7528\u6237\u4e0a\u4f20\u5f85\u8bc6\u522b\u7684\u91ce\u751f\u52a8\u7269\u56fe\u50cf\u3002</li> <li>\u56fe\u50cf\u5904\u7406\u6a21\u5757\uff1a\u5bf9\u4e0a\u4f20\u7684\u56fe\u50cf\u8fdb\u884c\u9884\u5904\u7406\uff08\u5982\u7f29\u653e\u3001\u5f52\u4e00\u5316\uff09\u3002</li> <li>\u6a21\u578b\u9884\u6d4b\u6a21\u5757\uff1a\u8c03\u7528\u8bad\u7ec3\u597d\u7684\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u8fdb\u884c\u56fe\u50cf\u5206\u7c7b\u3002</li> <li>\u7ed3\u679c\u5c55\u793a\u6a21\u5757\uff1a\u5c06\u8bc6\u522b\u7ed3\u679c\u4ee5\u53ef\u89c6\u5316\u5f62\u5f0f\u5c55\u793a\u7ed9\u7528\u6237\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#5_1","title":"5. \u9884\u671f\u6210\u679c","text":"<ol> <li>\u4e00\u4e2a\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7cfb\u7edf\u539f\u578b\u3002</li> <li>\u9ad8\u51c6\u786e\u7387\u7684\u91ce\u751f\u52a8\u7269\u5206\u7c7b\u6a21\u578b\u3002</li> <li>\u7cfb\u7edf\u7684\u8be6\u7ec6\u8bbe\u8ba1\u6587\u6863\u548c\u4f7f\u7528\u624b\u518c\u3002</li> </ol>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#6_1","title":"6. \u521b\u65b0\u70b9","text":"<ol> <li>\u591a\u6a21\u6001\u878d\u5408\uff1a\u7ed3\u5408\u7ea2\u5916\u6444\u50cf\u5934\u548c\u53ef\u89c1\u5149\u6444\u50cf\u5934\u7684\u591a\u6a21\u6001\u6570\u636e\uff0c\u63d0\u5347\u591c\u95f4\u6216\u590d\u6742\u73af\u5883\u4e0b\u7684\u8bc6\u522b\u6548\u679c\u3002 2.\u5b9e\u65f6\u76d1\u6d4b\u529f\u80fd:\u5728\u7cfb\u7edf\u4e2d\u52a0\u5165\u5b9e\u65f6\u89c6\u9891\u6d41\u5904\u7406\u529f\u80fd,\u5b9e\u73b0\u5bf9\u91ce\u5916\u73af\u5883\u7684\u5b9e\u65f6\u76d1\u63a7\u548c\u52a8\u7269\u884c\u4e3a\u5206\u6790. 3.\u8f7b\u91cf\u5316\u90e8\u7f72**:\u5c06\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u90e8\u7f72\u5230\u8fb9\u7f18\u8bbe\u5907(\u5982\u65e0\u4eba\u673a,\u667a\u80fd\u6444\u50cf\u5934),\u5b9e\u73b0\u4f4e\u5ef6\u8fdf,\u9ad8\u6548\u7387\u7684\u73b0\u573a\u5e94\u7528.</li> </ol>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#7_1","title":"7.\u65f6\u95f4\u8ba1\u5212","text":"\u9636\u6bb5 \u65f6\u95f4 \u4efb\u52a1 \u7b2c\u4e00\u9636\u6bb5 \u7b2c1\u5468\u81f3\u7b2c4\u5468 \u6587\u732e\u8c03\u7814,\u786e\u5b9a\u7814\u7a76\u65b9\u5411\u548c\u6280\u672f\u8def\u7ebf \u7b2c\u4e8c\u9636\u6bb5 \u7b2c5\u5468\u81f3\u7b2c8\u5468 \u6570\u636e\u96c6\u6536\u96c6\u4e0e\u9884\u5904\u7406 \u7b2c\u4e09\u9636\u6bb5 \u7b2c9\u5468\u81f3\u7b2c12\u5468 \u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u7684\u642d\u5efa\u4e0e\u8bad\u7ec3 \u7b2c\u56db\u9636\u6bb5 \u7b2c\u5341\u4e09\u5468\u5230\u7b2c\u5341\u516d\u5468 \u7cfb\u7edf\u8bbe\u8ba1\u4e0e\u5b9e\u73b0 \u7b2c\u4e94\u9636\u6bb5 \u7b2c\u5341\u4e03\u5468\u5230\u7b2c\u4e8c\u5341\u5468 \u6d4b\u8bd5\u4e0e\u4f18\u5316 \u7b2c\u516d\u9636\u6bb5 \u7b2c\u4e8c\u5341\u4e00\u5468\u5230\u7b2c\u4e8c\u5341\u56db\u5468 \u64b0\u5199\u8bba\u6587\u5e76\u51c6\u5907\u7b54\u8fa9 <p>8 .\u53c2\u8003\u6587\u732e</p> <p>[\u6b64\u5904\u5217\u51fa\u76f8\u5173\u53c2\u8003\u6587\u732e]</p> <p>\u8fd9\u4e2a\u6bd5\u4e1a\u8bbe\u8ba1\u9898\u76ee\u7ed3\u5408\u4e86\u5f53\u524d\u70ed\u95e8\u7684\u6df1\u5ea6\u5b66\u4e60\u6280\u672f\u548c\u751f\u6001\u4fdd\u62a4\u7684\u5b9e\u9645\u9700\u6c42,\u5177\u6709\u8f83\u9ad8\u7684\u7814\u7a76\u4ef7\u503c\u548c\u5e94\u7528\u524d\u666f\u3002\u901a\u8fc7\u8be5\u9879\u76ee\u7684\u5b9e\u65bd,\u4e0d\u4ec5\u53ef\u4ee5\u63d0\u5347\u4f60\u5728\u4eba\u5de5\u667a\u80fd\u9886\u57df\u7684\u5b9e\u8df5\u80fd\u529b,\u8fd8\u80fd\u4e3a\u91ce\u751f\u52a8\u7269\u7684\u4fdd\u62a4\u5de5\u4f5c\u505a\u51fa\u8d21\u732e\u3002</p> <p>\u4e09\u3001\u672c\u8bfe\u9898\u8bbe\u8ba1\u548c\u5b9e\u73b0\u7684\u5177\u4f53\u8981\u6c42\uff08\u652f\u6491\u8bfe\u7a0b\u76ee\u68073\uff09</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#3_3","title":"\u4e09\u3001\u672c\u8bfe\u9898\u8bbe\u8ba1\u548c\u5b9e\u73b0\u7684\u5177\u4f53\u8981\u6c42\uff08\u652f\u6491\u8bfe\u7a0b\u76ee\u68073\uff09","text":"<p>\u4e3a\u4e86\u786e\u4fdd\u672c\u6bd5\u4e1a\u8bbe\u8ba1\u7684\u987a\u5229\u5b8c\u6210\u5e76\u8fbe\u5230\u9884\u671f\u76ee\u6807\uff0c\u4ee5\u4e0b\u662f\u5177\u4f53\u7684\u8bbe\u8ba1\u548c\u5b9e\u73b0\u8981\u6c42\uff0c\u8fd9\u4e9b\u8981\u6c42\u5c06\u652f\u6491\u8bfe\u7a0b\u76ee\u68073\uff08\u5373\u57f9\u517b\u5b66\u751f\u7684\u5b9e\u8df5\u80fd\u529b\u3001\u521b\u65b0\u80fd\u529b\u548c\u89e3\u51b3\u590d\u6742\u5de5\u7a0b\u95ee\u9898\u7684\u80fd\u529b\uff09\uff1a</p>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#1_3","title":"1. \u6280\u672f\u9009\u578b\u4e0e\u5de5\u5177\u4f7f\u7528","text":"<ul> <li>\u6df1\u5ea6\u5b66\u4e60\u6846\u67b6\uff1a\u9009\u62e9\u4e3b\u6d41\u7684\u6df1\u5ea6\u5b66\u4e60\u6846\u67b6\uff08\u5982TensorFlow\u3001PyTorch\u6216Keras\uff09\u8fdb\u884c\u6a21\u578b\u7684\u642d\u5efa\u548c\u8bad\u7ec3\u3002</li> <li>\u7f16\u7a0b\u8bed\u8a00\uff1a\u4f7f\u7528Python\u4f5c\u4e3a\u4e3b\u8981\u7f16\u7a0b\u8bed\u8a00\uff0c\u7ed3\u5408\u5fc5\u8981\u7684\u5e93\uff08\u5982NumPy\u3001Pandas\u3001OpenCV\u7b49\uff09\u8fdb\u884c\u6570\u636e\u5904\u7406\u548c\u56fe\u50cf\u5904\u7406\u3002</li> <li>\u524d\u7aef\u5f00\u53d1\uff1a\u4f7f\u7528HTML\u3001CSS\u548cJavaScript\u5f00\u53d1\u7528\u6237\u754c\u9762\uff0c\u786e\u4fdd\u754c\u9762\u7b80\u6d01\u6613\u7528\u3002</li> <li>\u540e\u7aef\u5f00\u53d1\uff1a\u9009\u62e9Flask\u6216Django\u4f5c\u4e3a\u540e\u7aef\u6846\u67b6\uff0c\u642d\u5efaRESTful API\u4ee5\u652f\u6301\u524d\u540e\u7aef\u4ea4\u4e92\u3002</li> <li>\u6570\u636e\u5e93\uff1a\u4f7f\u7528SQLite\u6216MySQL\u7b49\u8f7b\u91cf\u7ea7\u6570\u636e\u5e93\u5b58\u50a8\u7528\u6237\u6570\u636e\u548c\u8bc6\u522b\u7ed3\u679c\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#2_3","title":"2. \u6570\u636e\u96c6\u8981\u6c42","text":"<ul> <li>\u6570\u636e\u89c4\u6a21\uff1a\u6536\u96c6\u81f3\u5c115000\u5f20\u91ce\u751f\u52a8\u7269\u56fe\u50cf\uff0c\u6db5\u76d6\u81f3\u5c1120\u79cd\u4e0d\u540c\u7684\u91ce\u751f\u52a8\u7269\u7c7b\u522b\u3002</li> <li>\u6570\u636e\u8d28\u91cf\uff1a\u786e\u4fdd\u56fe\u50cf\u6e05\u6670\u5ea6\u9ad8\u3001\u80cc\u666f\u590d\u6742\u5ea6\u9002\u4e2d\uff0c\u907f\u514d\u6a21\u7cca\u6216\u8fc7\u5ea6\u906e\u6321\u7684\u56fe\u50cf\u3002</li> <li>\u6570\u636e\u6807\u6ce8\uff1a\u5bf9\u6bcf\u5f20\u56fe\u50cf\u8fdb\u884c\u51c6\u786e\u7684\u7c7b\u522b\u6807\u6ce8\uff0c\u786e\u4fdd\u6570\u636e\u96c6\u7684\u8d28\u91cf\u548c\u53ef\u7528\u6027\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#3_4","title":"3. \u6a21\u578b\u8bbe\u8ba1\u4e0e\u4f18\u5316","text":"<ul> <li>\u6a21\u578b\u67b6\u6784\uff1a\u9009\u62e9\u7ecf\u5178\u7684\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\uff08CNN\uff09\u67b6\u6784\uff08\u5982ResNet\u3001VGG\u6216Inception\uff09\uff0c\u5e76\u6839\u636e\u4efb\u52a1\u9700\u6c42\u8fdb\u884c\u9002\u5f53\u7684\u8c03\u6574\u3002</li> <li>\u8fc1\u79fb\u5b66\u4e60\uff1a\u5229\u7528\u9884\u8bad\u7ec3\u6a21\u578b\uff08\u5982ImageNet\u4e0a\u7684\u9884\u8bad\u7ec3\u6743\u91cd\uff09\u8fdb\u884c\u5fae\u8c03\uff0c\u4ee5\u63d0\u9ad8\u6a21\u578b\u7684\u6cdb\u5316\u80fd\u529b\u548c\u8bad\u7ec3\u6548\u7387\u3002</li> <li>\u8d85\u53c2\u6570\u8c03\u4f18\uff1a\u901a\u8fc7\u5b9e\u9a8c\u786e\u5b9a\u6700\u4f73\u7684\u5b66\u4e60\u7387\u3001\u6279\u91cf\u5927\u5c0f\u3001\u4f18\u5316\u7b97\u6cd5\u7b49\u8d85\u53c2\u6570\u3002</li> <li>\u6570\u636e\u589e\u5f3a\uff1a\u91c7\u7528\u65cb\u8f6c\u3001\u7f29\u653e\u3001\u7ffb\u8f6c\u7b49\u6570\u636e\u589e\u5f3a\u6280\u672f\uff0c\u589e\u52a0\u6570\u636e\u7684\u591a\u6837\u6027\uff0c\u9632\u6b62\u6a21\u578b\u8fc7\u62df\u5408\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#4_3","title":"4. \u7cfb\u7edf\u529f\u80fd\u4e0e\u6027\u80fd\u8981\u6c42","text":"<ul> <li>\u56fe\u50cf\u4e0a\u4f20\u4e0e\u8bc6\u522b\u529f\u80fd\uff1a\u7cfb\u7edf\u5e94\u652f\u6301\u7528\u6237\u4e0a\u4f20\u91ce\u751f\u52a8\u7269\u56fe\u50cf\uff0c\u5e76\u80fd\u591f\u5feb\u901f\u8fd4\u56de\u8bc6\u522b\u7ed3\u679c\u3002</li> <li>\u5b9e\u65f6\u76d1\u6d4b\u529f\u80fd\uff08\u53ef\u9009\uff09\uff1a\u5982\u679c\u65f6\u95f4\u548c\u6280\u672f\u5141\u8bb8\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u5b9e\u73b0\u5b9e\u65f6\u89c6\u9891\u6d41\u5904\u7406\u529f\u80fd\uff0c\u652f\u6301\u5bf9\u91ce\u5916\u73af\u5883\u7684\u5b9e\u65f6\u76d1\u63a7\u3002</li> <li>\u8bc6\u522b\u51c6\u786e\u7387\uff1a\u6a21\u578b\u7684\u5206\u7c7b\u51c6\u786e\u7387\u5e94\u8fbe\u523085%\u4ee5\u4e0a\uff0c\u5bf9\u4e8e\u5e38\u89c1\u91ce\u751f\u52a8\u7269\u7684\u8bc6\u522b\u51c6\u786e\u7387\u5e94\u8fbe\u523090%\u4ee5\u4e0a\u3002</li> <li>\u54cd\u5e94\u65f6\u95f4\uff1a\u7cfb\u7edf\u7684\u54cd\u5e94\u65f6\u95f4\u5e94\u63a7\u5236\u57285\u79d2\u4ee5\u5185\uff0c\u786e\u4fdd\u7528\u6237\u4f53\u9a8c\u6d41\u7545\u3002</li> </ul>"},{"location":"%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/#5_2","title":"5. \u7cfb\u7edf\u6d4b\u8bd5\u4e0e\u8bc4\u4f30","text":"<ul> <li>\u5355\u5143\u6d4b\u8bd5\uff1a\u5bf9\u7cfb\u7edf\u7684\u5404\u4e2a\u6a21\u5757\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\uff0c\u786e\u4fdd\u6bcf\u4e2a\u6a21\u5757\u7684\u529f\u80fd\u6b63\u5e38\u3002</li> <li>\u96c6\u6210\u6d4b\u8bd5\uff1a\u5bf9\u6574\u4e2a\u7cfb\u7edf\u8fdb\u884c\u96c6\u6210\u6d4b\u8bd5\uff0c\u9a8c\u8bc1\u524d\u540e\u7aef\u7684\u4ea4\u4e92\u662f\u5426\u987a\u7545\u3002 -\u6027\u80fd\u6d4b\u8bd5:\u8bc4\u4f30\u7cfb\u7edf\u5728\u9ad8\u5e76\u53d1\u60c5\u51b5\u4e0b\u7684\u8868\u73b0,\u786e\u4fdd\u7cfb\u7edf\u7684\u7a33\u5b9a\u6027\u548c\u53ef\u9760\u6027. -\u7528\u6237\u6d4b\u8bd5**:\u9080\u8bf7\u6f5c\u5728\u7528\u6237(\u5982\u7814\u7a76\u4eba\u5458,\u73af\u4fdd\u5de5\u4f5c\u8005)\u8fdb\u884c\u8bd5\u7528,\u6536\u96c6\u53cd\u9988\u5e76\u8fdb\u884c\u6539\u8fdb.</li> </ul> <p>6 .\u6587\u6863\u7f16\u5199</p> <p>-\u8bbe\u8ba1\u6587\u6863:\u8be6\u7ec6\u8bb0\u5f55\u7cfb\u7edf\u7684\u8bbe\u8ba1\u601d\u8def,\u6280\u672f\u9009\u578b,\u6a21\u5757\u5212\u5206\u7b49\u5185\u5bb9. -\u4f7f\u7528\u624b\u518c:\u7f16\u5199\u7cfb\u7edf\u7684\u4f7f\u7528\u8bf4\u660e,\u6307\u5bfc\u7528\u6237\u5982\u4f55\u4e0a\u4f20\u56fe\u50cf,\u67e5\u770b\u8bc6\u522b\u7ed3\u679c\u7b49. -\u5b9e\u9a8c\u62a5\u544a:\u8bb0\u5f55\u6a21\u578b\u7684\u8bad\u7ec3\u8fc7\u7a0b,\u4f18\u5316\u65b9\u6cd5\u4ee5\u53ca\u6700\u7ec8\u7684\u8bc4\u4f30\u7ed3\u679c.</p> <p>7 .\u521b\u65b0\u6027\u4e0e\u6269\u5c55\u6027</p> <p>-\u521b\u65b0\u70b9:\u5728\u7cfb\u7edf\u4e2d\u5f15\u5165\u591a\u6a21\u6001\u878d\u5408(\u5982\u7ea2\u5916\u6444\u50cf\u5934\u6570\u636e)\u6216\u8f7b\u91cf\u5316\u90e8\u7f72(\u8fb9\u7f18\u8bbe\u5907)\u7b49\u521b\u65b0\u70b9,\u63d0\u5347\u7cfb\u7edf\u7684\u5b9e\u7528\u6027\u548c\u5148\u8fdb\u6027. -\u6269\u5c55\u6027:\u8bbe\u8ba1\u65f6\u5e94\u8003\u8651\u7cfb\u7edf\u7684\u53ef\u6269\u5c55\u6027,\u4fbf\u4e8e\u672a\u6765\u589e\u52a0\u65b0\u7684\u52a8\u7269\u7c7b\u522b\u6216\u529f\u80fd\u6a21\u5757.</p> <p>8 .\u65f6\u95f4\u7ba1\u7406\u4e0e\u8fdb\u5ea6\u63a7\u5236</p> <p>-\u9636\u6bb5\u6027\u76ee\u6807:\u6309\u7167\u65f6\u95f4\u8ba1\u5212\u8868\u5b8c\u6210\u6bcf\u4e2a\u9636\u6bb5\u7684\u4efb\u52a1,\u5b9a\u671f\u5411\u5bfc\u5e08\u6c47\u62a5\u8fdb\u5c55. -\u98ce\u9669\u7ba1\u7406:\u63d0\u524d\u8bc6\u522b\u53ef\u80fd\u7684\u98ce\u9669(\u5982\u6570\u636e\u96c6\u4e0d\u8db3,\u6a21\u578b\u6027\u80fd\u4e0d\u8fbe\u6807),\u5e76\u5236\u5b9a\u5e94\u5bf9\u63aa\u65bd.</p> <p>\u901a\u8fc7\u4ee5\u4e0a\u5177\u4f53\u8981\u6c42\u7684\u5b9e\u65bd,\u672c\u8bfe\u9898\u5c06\u4e0d\u4ec5\u80fd\u591f\u5b8c\u6210\u4e00\u4e2a\u529f\u80fd\u5b8c\u5584\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7cfb\u7edf\u539f\u578b,\u8fd8\u80fd\u5728\u6df1\u5ea6\u5b66\u4e60\u6280\u672f\u7684\u5e94\u7528\u548c\u5b9e\u8df5\u80fd\u529b\u65b9\u9762\u5f97\u5230\u663e\u8457\u63d0\u5347.\u540c\u65f6,\u8be5\u9879\u76ee\u7684\u6210\u679c\u5c06\u4e3a\u751f\u6001\u4fdd\u62a4\u548c\u751f\u7269\u591a\u6837\u6027\u7814\u7a76\u63d0\u4f9b\u6709\u529b\u7684\u6280\u672f\u652f\u6301.</p> <p>\u53c2\u8003\u6587\u732e</p> <p>### \u53c2\u8003\u6587\u732e</p> <p>\u4ee5\u4e0b\u662f\u4e0e\u672c\u6bd5\u4e1a\u8bbe\u8ba1\u76f8\u5173\u7684\u53c2\u8003\u6587\u732e\uff0c\u6db5\u76d6\u4e86\u6df1\u5ea6\u5b66\u4e60\u3001\u56fe\u50cf\u8bc6\u522b\u3001\u91ce\u751f\u52a8\u7269\u76d1\u6d4b\u4ee5\u53ca\u7cfb\u7edf\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u7b49\u65b9\u9762\u7684\u5185\u5bb9\uff1a</p> <ol> <li>\u6df1\u5ea6\u5b66\u4e60\u4e0e\u56fe\u50cf\u8bc6\u522b</li> <li>Goodfellow, I., Bengio, Y., &amp; Courville, A. (2016). Deep Learning. MIT Press.</li> <li>LeCun, Y., Bengio, Y., &amp; Hinton, G. (2015). Deep learning. Nature, 521(7553), 436-444.</li> <li> <p>Krizhevsky, A., Sutskever, I., &amp; Hinton, G. E. (2012). ImageNet classification with deep convolutional neural networks. Advances in Neural Information Processing Systems, 25, 1097-1105.</p> </li> <li> <p>\u91ce\u751f\u52a8\u7269\u76d1\u6d4b\u4e0e\u4fdd\u62a4</p> </li> <li>Norouzzadeh, M. S., Nguyen, A., Kosmala, M., Swanson, A., Palmer, M. S., Packer, C., &amp; Clune, J. (2018). Automatically identifying wild animals in camera trap images with deep learning. Proceedings of the National Academy of Sciences, 115(25), E5716-E5725.</li> <li> <p>Swanson, A., Kosmala, M., Lintott, C., Simpson, R., Smith, A., &amp; Packer, C. (2015). Snapshot Serengeti: High-frequency annotated camera trap images of 40 mammalian species in an African savanna. Scientific Data, 2(1), 1-14.</p> </li> <li> <p>\u6570\u636e\u96c6\u4e0e\u6570\u636e\u9884\u5904\u7406</p> </li> <li>iNaturalist Dataset: https://www.inaturalist.org/</li> <li>Wildlife Image Dataset: https://lila.science/datasets</li> <li> <p>Deng, J., Dong, W., Socher, R., Li, L.-J., Li, K., &amp; Fei-Fei, L. (2009). ImageNet: A large-scale hierarchical image database. IEEE Conference on Computer Vision and Pattern Recognition.</p> </li> <li> <p>\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u4e0e\u8fc1\u79fb\u5b66\u4e60</p> </li> <li>He Kaiming et al . \"Deep residual learning for image recognition.\" Proceedings of the IEEE conference on computer vision and pattern recognition .2016 .      Simonyan Karen et al . \"Very deep convolutional networks for large-scale image recognition.\" arXiv preprint arXiv :1409 .1556 (2014 ).      Szegedy Christian et al . \"Going deeper with convolutions.\" Proceedings of the IEEE conference on computer vision and pattern recognition .2015 .</li> </ol> <p>5.\u7cfb\u7edf\u8bbe\u8ba1\u4e0e\u5b9e\u73b0</p> <pre><code>Flask Documentation : https ://flask.palletsprojects.com/en/2.x/\nDjango Documentation : https ://docs.djangoproject.com/en/4.x/\nHTML/CSS/JavaScript Tutorials : https ://www.w3schools.com/\n</code></pre> <p>6.\u6027\u80fd\u4f18\u5316\u4e0e\u6d4b\u8bd5</p> <pre><code>Kingma Diederik P et al . \"Adam : A method for stochastic optimization.\" arXiv preprint arXiv :1412 .6980 (2014 ).\nBottou L\u00e9on . \"Large-scale machine learning with stochastic gradient descent.\" Proceedings of COMPSTAT'2010 Springer Physica-Verlag HD pp177\u2013186 .\n</code></pre> <p>7.\u521b\u65b0\u6027\u4e0e\u6269\u5c55\u6027</p> <pre><code>Redmon Joseph et al . \"You only look once : Unified real-time object detection.\" Proceedings of the IEEE conference on computer vision and pattern recognition pp779\u2013788 June 2016 .\nHoward Andrew G et al..\"MobileNets:Efficient Convolutional Neural Networks for Mobile Vision Applications\"arXiv preprint arXiv:1704..04861v1 April17th ,20l7\n</code></pre> <p>8.\u65f6\u95f4\u7ba1\u7406\u4e0e\u8fdb\u5ea6\u63a7\u5236</p> <pre><code>Kerzner Harold R..Project Management:A Systems Approach to Planning Scheduling And Controlling John Wiley&amp;Sons Inc.New York NY USA Tenth Edition January20l3\n</code></pre> <p>\u8fd9\u4e9b\u53c2\u8003\u6587\u732e\u5c06\u4e3a\u4f60\u7684\u6bd5\u4e1a\u8bbe\u8ba1\u63d0\u4f9b\u7406\u8bba\u652f\u6301\u548c\u6280\u672f\u6307\u5bfc\uff0c\u5e2e\u52a9\u4f60\u66f4\u597d\u5730\u5b8c\u6210\u57fa\u4e8e\u6df1\u5ea6\u5b66\u4e60\u7684\u91ce\u751f\u52a8\u7269\u8bc6\u522b\u7cfb\u7edf\u7684\u8bbe\u8ba1\u4e0e\u5b9e\u73b0\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/","title":"\u673a\u5668\u5b66\u4e60","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#_1","title":"\u56de\u5f52","text":"<p>\u6700\u5c0f\u4e8c\u4e58\u6cd5</p> <p>\u5747\u65b9\u8bef\u5dee</p> \\[ f(x) = w \\times x+b \\] \\[ error =\\frac{1}{2m} \\sum\\limits_{i=1}^{m}(f(x) - y)^2 \\] <p>\u68af\u5ea6\u4e0b\u964d</p> \\[ w = w - \\alpha \\frac{\\partial}{\\partial w}J(w,b)  \\] \\[ b = b - \\alpha \\frac{\\partial}{\\partial b}J(w,b) \\] <p>$$</p> <p>\\begin{align}</p> <p>\\frac{\\partial J(w,b)}{\\partial w} &amp;= \\frac{1}{m} \\sum\\limits_{i = 0}^{m-1} (f_{w,b}(x^{(i)}) - y<sup>{(i)})x</sup> \\</p> <p>\\frac{\\partial J(w,b)}{\\partial b} &amp;= \\frac{1}{m} \\sum\\limits_{i = 0}^{m-1} (f_{w,b}(x^{(i)}) - y^{(i)}) </p> <p>\\end{align}</p> <p>$$</p> <p>\u903b\u8f91\u56de\u5f52\u6a21\u578b</p> <p>$$ \\begin{align}</p> <p>z = w \\cdot x + b \\</p> <p>g(z) = \\frac{1}{1+e^{-z}} \\end{align} $$</p> <p>\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570(Cross-Entropy Loss)</p> <ol> <li>\u4e8c\u5206\u7c7b</li> </ol> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u7c7b\u522b\u6211\u4eec\u9884\u6d4b\u5f97\u5230\u7684\u6982\u7387\u4e3a \\(p\\) \u548c \\(1-p\\)  $$ L = \\frac{1}{N}\\sum\\limits<sup>{N}_{i}L_i=-\\frac{1}{N}\\sum\\limits</sup>[y_i \\cdot log(p_i)+(1-y_i)\\cdot log(1-p_i)] $$}_{i</p> <ul> <li>\\(y_i\\) \u2014\u2014 \u8868\u793a\u6837\u672c \\(i\\) \u7684label\uff0c\u6b63\u7c7b\u4e3a\\(1\\)\uff0c\u8d1f\u7c7b\u4e3a\\(0\\)</li> <li> <p>\\(p_i\\) \u2014\u2014 \u8868\u793a\u6837\u672c \\(i\\) \u9884\u6d4b\u4e3a\u6b63\u7c7b\u7684\u6982\u7387</p> </li> <li> <p>\u591a\u5206\u7c7b</p> </li> </ul> \\[ L = \\frac{1}{N}\\sum\\limits_{i}L_i = -\\frac{1}{N}\\sum\\limits_{i}\\sum\\limits_{c=1}^{M}y_{ic}log(p_{ic}) \\] <ul> <li>\\(M\\) \u2014\u2014 \u7c7b\u522b\u7684\u6570\u91cf</li> <li>\\(y_{ic}\\) \u2014\u2014 \u7b26\u53f7\u51fd\u6570\uff080 \u6216 1\uff09</li> <li>\\(p_{ic}\\) \u2014\u2014 \u89c2\u6d4b\u6837\u672c \\(i\\) \u5c5e\u4e8e\u7c7b\u522b \\(c\\) \u7684\u9884\u6d4b\u6982\u7387</li> </ul> <p>\u6b63\u5219\u5316</p> <p>\u6b63\u5219\u5316\u7528\u4e8e\u9632\u6b62\u6a21\u578b\u8fc7\u62df\u5408\u8bad\u7ec3\u6570\u636e\u3002 \u5728\u6b63\u5219\u5316\u8fc7\u7a0b\u4e2d\uff0c\u901a\u5e38\u4f1a\u6dfb\u52a0\u4e00\u4e2a \u6b63\u5219\u5316\u9879 \u5230\u6a21\u578b\u7684\u635f\u5931\u51fd\u6570\u4e2d\u3002</p> <p>L1\u6b63\u5219\u5316\uff08Lasso\u6b63\u5219\u5316\uff09:</p> <p>L1\u6b63\u5219\u5316\u901a\u8fc7\u5728\u635f\u5931\u51fd\u6570\u4e2d\u589e\u52a0\u53c2\u6570\u7684\u7edd\u5bf9\u503c\u4e4b\u548c\u6765\u5b9e\u73b0\u60e9\u7f5a\u3002\u5b83\u7684\u6548\u679c\u662f\u4f7f\u5f97\u90e8\u5206\u53c2\u6570\u53d8\u4e3a0\uff0c\u4ece\u800c\u5b9e\u73b0\u7279\u5f81\u9009\u62e9\uff08\u5373\u81ea\u52a8\u7b5b\u9009\u51fa\u5bf9\u76ee\u6807\u53d8\u91cf\u6700\u91cd\u8981\u7684\u7279\u5f81\uff09\u3002</p> \\[ \\text{\u6b63\u5219\u5316\u9879} = \\lambda \\sum_{i=1}^n |w_i| \\] <p>L2\u6b63\u5219\u5316\uff08Ridge\u6b63\u5219\u5316\uff09:</p> <p>L2\u6b63\u5219\u5316\u901a\u8fc7\u5728\u635f\u5931\u51fd\u6570\u4e2d\u589e\u52a0\u53c2\u6570\u7684\u5e73\u65b9\u548c\u6765\u5b9e\u73b0\u60e9\u7f5a\u3002\u5b83\u7684\u6548\u679c\u662f\u4f7f\u5f97\u53c2\u6570\u7684\u53d6\u503c\u5c3d\u91cf\u5c0f\uff0c\u907f\u514d\u51fa\u73b0\u8fc7\u5927\u7684\u53c2\u6570\u503c\u3002</p> \\[ \\text{\u6b63\u5219\u5316\u9879} = \\lambda \\sum_{i=1}^n w_i^2 \\] <p>\u5176\u4e2d \\(w_i\\) \u662f\u6a21\u578b\u7684\u6743\u91cd\u53c2\u6570\uff0c\\(\\lambda\\) \u662f\u6b63\u5219\u5316\u5f3a\u5ea6\uff08\u6b63\u5219\u5316\u7cfb\u6570\uff09\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#_2","title":"\u795e\u7ecf\u7f51\u7edc","text":"<p>\u8f93\u5165\u5c42</p> <p>\u8f93\u51fa\u5c42</p> <p>\u9690\u85cf\u5c42</p> <p>\u5bf9\u4e8e\u8f93\u51fa\u5c42\u7684\u6fc0\u6d3b\u51fd\u6570</p> <p>\u4e8c\u5206\u7c7b \u63a8\u8350\u4f7f\u7528sigmoid</p> <p>\u7ebf\u6027\u56de\u5f52\u95ee\u9898 \u63a8\u8350\u4e0d\u4f7f\u7528\u6fc0\u6d3b\u51fd\u6570</p> <p>\u4e0d\u80fd\u51fa\u73b0\u8d1f\u503c \u63a8\u8350\u4f7f\u7528ReLU</p> <p>[!info]  \u7ebf\u6027\u51fd\u6570\u7684\u7ebf\u6027\u51fd\u6570\u672c\u8eab\u5c31\u662f\u7ebf\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u9700\u8981\u6fc0\u6d3b\u51fd\u6570\u5f15\u5165\u975e\u7ebf\u6027 \u5982\u679c\u6ca1\u6709\u6fc0\u6d3b\u51fd\u6570\uff0c\u90a3\u4e48\u795e\u7ecf\u7f51\u7edc \u7b49\u4ef7\u4e8e \u7ebf\u6027\u56de\u5f52</p> <p>Softmax\u51fd\u6570</p> \\[ a_x = \\frac{e^{z_x}}{e^{z_1} + e^{z_2} + \\dots + e^{z_x} + \\dots +e^{z_n} } \\] <p>Softmax\u56de\u5f52</p> <p></p> <p>Adam Algorithm  \u81ea\u52a8\u8c03\u6574\u4e0b\u964d\u901f\u7387</p> <p>\u5377\u79ef\u5c42</p> <p>\u4e0d\u80fd\u51fa\u73b0</p> <p>\u8bad\u7ec3\u96c6\uff08training set\uff09</p> <p>\u4ea4\u53c9\u9a8c\u8bc1\u96c6\uff08cross validation set | validation set\uff09</p> <p>\u6d4b\u8bd5\u96c6\uff08test set\uff09</p> <p>\u4ea4\u53c9\u9a8c\u8bc1\u96c6\u5728\u6a21\u578b\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u4f7f\u7528\uff0c\u7528\u4e8e\u8bc4\u4f30\u6a21\u578b\u7684\u6027\u80fd\u548c\u9009\u62e9\u5408\u9002\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u5e2e\u52a9\u6539\u5584\u6a21\u578b\u7684\u8d28\u91cf\u3002</p> <p>\u6d4b\u8bd5\u96c6\u5728\u6a21\u578b\u8bad\u7ec3\u5b8c\u6210\u540e\u4f7f\u7528\uff0c\u7528\u4e8e\u6700\u7ec8\u8bc4\u4f30\u6a21\u578b\u5728\u672a\u77e5\u6570\u636e\u4e0a\u7684\u8868\u73b0\uff0c\u4ee5\u9a8c\u8bc1\u6a21\u578b\u7684\u6cdb\u5316\u80fd\u529b\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#_3","title":"\u51b3\u7b56\u6811","text":"<p>\u71b5\u51fd\u6570\u8ba1\u7b97</p> \\[ p_0 = 1 - p_1 $$ $$ H(p_1) = - p_1log_2(p_1) - p_0log_2(p_0) \\] <p>\u8bbe\u7f6e\"0log(0)\" = 0</p> <p></p> <p>\u8ba1\u7b97\u71b5\u7684\u51cf\u5c11(\u4fe1\u606f\u7684\u589e\u76ca)</p> <p>Information gain $$  = H(p_1^{root}) - (w<sup>{left}H(p_1</sup>) + w<sup>{right}H(p_1</sup>))  $$</p> <p>\u72ec\u70ed\u7f16\u7801 one-hot</p> <p>\u56de\u5f52\u6811</p> <p>\u8ba1\u7b97\u65b9\u5dee\u7684\u51cf\u5c11\uff08\u9009\u62e9\u5206\u7c7b\u7684\u9009\u9879\uff0c\u8ba1\u7b97\u56de\u5f52\uff09</p> <p></p> <p>\u4f7f\u7528\u591a\u4e2a\u51b3\u7b56\u6811\uff0c\u4f7f\u7b97\u6cd5\u66f4\u52a0\u5065\u58ee\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#_4","title":"\u968f\u673a\u68ee\u6797","text":"<ol> <li> <p>\u4e00\u4e2a\u6837\u672c\u5bb9\u91cf\u4e3aN\u7684\u6837\u672c\uff0c\u6709\u653e\u56de\u7684\u62bd\u53d6 N\u6b21\uff0c\u6bcf\u6b21\u62bd\u53d61\u4e2a\uff0c\u6700\u7ec8\u5f62\u6210\u4e86N\u4e2a\u6837\u672c\u3002\u7528\u8fd9\u4e9b\u9009\u62e9\u597d\u7684N\u4e2a\u6837\u672c\u7528\u6765\u8bad\u7ec3\u4e00\u4e2a\u51b3\u7b56\u6811\uff0c\u4f5c\u4e3a\u51b3\u7b56\u6811\u6839\u8282\u70b9\u5904\u7684\u6837\u672c\u3002</p> </li> <li> <p>\u5f53\u6bcf\u4e2a\u6837\u672c\u6709M\u4e2a\u5c5e\u6027\u65f6\uff0c\u5728\u51b3\u7b56\u6811\u7684\u6bcf\u4e2a\u8282\u70b9\u9700\u8981\u5206\u88c2\u65f6\uff0c\u968f\u673a\u4ece\u8fd9M\u4e2a\u5c5e\u6027\u4e2d\u9009\u53d6\u51fam\u4e2a\u5c5e\u6027\uff0c\u6ee1\u8db3\u6761\u4ef6m &lt;&lt; M\u3002\u7136\u540e\u4ece\u8fd9m\u4e2a\u5c5e\u6027\u4e2d\u91c7\u7528\u67d0\u79cd\u7b56\u7565\uff08\u6bd4\u5982\u8bf4\u4fe1\u606f\u589e\u76ca\uff09\u6765\u9009\u62e91\u4e2a\u5c5e\u6027\u4f5c\u4e3a\u8be5\u8282\u70b9\u7684\u5206\u88c2\u5c5e\u6027\u3002</p> </li> <li> <p>\u51b3\u7b56\u6811\u5f62\u6210\u8fc7\u7a0b\u4e2d\u6bcf\u4e2a\u8282\u70b9\u90fd\u8981\u6309\u7167\u6b65\u9aa42\u6765\u5206\u88c2\uff08\u5f88\u5bb9\u6613\u7406\u89e3\uff0c\u5982\u679c\u4e0b\u4e00\u6b21\u8be5\u8282\u70b9\u9009\u51fa\u6765\u7684\u90a3\u4e00\u4e2a\u5c5e\u6027\u662f\u521a\u521a\u5176\u7236\u8282\u70b9\u5206\u88c2\u65f6\u7528\u8fc7\u7684\u5c5e\u6027\uff0c\u5219\u8be5\u8282\u70b9\u5df2\u7ecf\u8fbe\u5230\u4e86\u53f6\u5b50\u8282\u70b9\uff0c\u65e0\u987b\u7ee7\u7eed\u5206\u88c2\u4e86\uff09\u3002\u4e00\u76f4\u5230\u4e0d\u80fd\u591f\u518d\u5206\u88c2\u4e3a\u6b62\u3002\u6ce8\u610f\u6574\u4e2a\u51b3\u7b56\u6811\u5f62\u6210\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u8fdb\u884c\u526a\u679d\u3002</p> </li> <li> <p>\u6309\u7167\u6b65\u9aa41~3\u5efa\u7acb\u5927\u91cf\u7684\u51b3\u7b56\u6811\uff0c\u8fd9\u6837\u5c31\u6784\u6210\u4e86\u968f\u673a\u68ee\u6797\u4e86\u3002</p> </li> </ol> <p>\u968f\u673a\u68ee\u6797\u6a21\u578b\u6709\u56db\u4e2a\u4e3b\u8981\u4f18\u70b9\uff1a</p> <ol> <li>\u975e\u5e38\u9002\u5408\u56de\u5f52\u548c\u5206\u7c7b\u95ee\u9898\u3002\u56de\u5f52\u4e2d\u7684\u8f93\u51fa\u53d8\u91cf\u662f\u4e00\u4e2a\u6570\u5b57\u5e8f\u5217\uff0c\u4f8b\u5982\u67d0\u4e2a\u8857\u533a\u7684\u623f\u4ef7\u3002\u5206\u7c7b\u95ee\u9898\u7684\u8f93\u51fa\u53d8\u91cf\u901a\u5e38\u662f\u4e00\u4e2a\u5355\u4e00\u7b54\u6848\uff0c\u4f8b\u5982\u623f\u5c4b\u7684\u552e\u4ef7\u662f\u5426\u9ad8\u4e8e\u6216\u4f4e\u4e8e\u8981\u4ef7\u3002</li> <li>\u53ef\u4ee5\u5904\u7406\u7f3a\u5931\u503c\u5e76\u4fdd\u6301\u9ad8\u51c6\u786e\u6027\uff0c\u5373\u4f7f\u7531\u4e8e bagging \u548c\u6709\u653e\u56de\u62bd\u6837\u800c\u7f3a\u5931\u5927\u91cf\u6570\u636e\u65f6\u4e5f\u662f\u5982\u6b64\u3002</li> <li>\u7b97\u6cd5\u7531\u4e8e\u8f93\u51fa\u7684\u662f\u201c\u591a\u6570\u89c4\u5219\u201d\uff0c\u4f7f\u5f97\u6a21\u578b\u51e0\u4e4e\u4e0d\u53ef\u80fd\u8fc7\u62df\u5408\u3002</li> <li>\u8be5\u6a21\u578b\u53ef\u4ee5\u5904\u7406\u5305\u542b\u6570\u5343\u4e2a\u8f93\u5165\u53d8\u91cf\u7684\u5e9e\u5927\u6570\u636e\u96c6\uff0c\u56e0\u6b64\u6210\u4e3a\u964d\u7ef4\u7684\u4e0d\u9519\u5de5\u5177\u3002</li> <li>\u5176\u7b97\u6cd5\u53ef\u7528\u4e8e\u4ece\u8bad\u7ec3\u6570\u636e\u96c6\u4e2d\u8bc6\u522b\u975e\u5e38\u91cd\u8981\u7684\u7279\u5f81\u3002</li> </ol> <p>\u5176\u4e5f\u6709\u4e00\u4e9b\u7f3a\u70b9\uff1a</p> <ol> <li>\u968f\u673a\u68ee\u6797\u4f18\u4e8e\u51b3\u7b56\u6811\uff0c\u4f46\u5176\u51c6\u786e\u6027\u4f4e\u4e8e XGBoost \u7b49\u68af\u5ea6\u63d0\u5347\u6811\u96c6\u6210\u3002</li> <li>\u968f\u673a\u68ee\u6797\u5305\u542b\u5927\u91cf\u6811\uff0c\u56e0\u6b64\u901f\u5ea6\u6bd4 XGBoost \u6162\u3002</li> </ol> <p>\u8ba9\u6211\u4eec\u4ee5\u4e00\u4e2a\u627e\u5de5\u4f5c\u7684\u6bd4\u55bb\u6765\u89e3\u91ca\u968f\u673a\u68ee\u6797\u7684\u539f\u7406\u3002</p> <p>\u5047\u8bbe\u4f60\u6b63\u5728\u5bfb\u627e\u4e00\u4efd\u65b0\u7684\u5de5\u4f5c\uff0c\u4f60\u51b3\u5b9a\u5411\u591a\u4e2a\u670b\u53cb\u5bfb\u6c42\u5efa\u8bae\u3002\u6bcf\u4e2a\u670b\u53cb\u90fd\u662f\u4e00\u4f4d\u4e13\u5bb6\uff0c\u4ed6\u4eec\u6709\u81ea\u5df1\u72ec\u7279\u7684\u7ecf\u9a8c\u548c\u89c2\u70b9\u3002\u4f60\u51b3\u5b9a\u6839\u636e\u4ed6\u4eec\u7684\u5efa\u8bae\u6765\u505a\u51fa\u6700\u7ec8\u7684\u51b3\u5b9a\u3002</p> <p>\u5728\u968f\u673a\u68ee\u6797\u4e2d\uff0c\u6bcf\u4e2a\u51b3\u7b56\u6811\u5c31\u50cf\u662f\u4e00\u4e2a\u670b\u53cb\uff0c\u5b83\u4eec\u57fa\u4e8e\u4e0d\u540c\u7684\u7279\u5f81\u548c\u89c4\u5219\u6765\u505a\u51fa\u9884\u6d4b\u3002\u6bcf\u4e2a\u51b3\u7b56\u6811\u90fd\u662f\u72ec\u7acb\u6784\u5efa\u7684\uff0c\u5b83\u4eec\u4e4b\u95f4\u6ca1\u6709\u5173\u8054\u3002\u8fd9\u79cd\u968f\u673a\u6027\u4f7f\u5f97\u6bcf\u4e2a\u51b3\u7b56\u6811\u90fd\u6709\u81ea\u5df1\u7684\u89c2\u70b9\u548c\u9884\u6d4b\u7ed3\u679c\u3002</p> <p>\u5047\u8bbe\u4f60\u7684\u670b\u53cb\u4eec\u4e3a\u4f60\u63d0\u4f9b\u4e86\u5404\u81ea\u7684\u5efa\u8bae\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u4ed6\u4eec\u7684\u5efa\u8bae\u505a\u51fa\u6700\u7ec8\u7684\u51b3\u7b56\u3002\u5728\u968f\u673a\u68ee\u6797\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u6295\u7968\u6216\u5e73\u5747\u7684\u65b9\u5f0f\u6765\u6c47\u603b\u6bcf\u4e2a\u51b3\u7b56\u6811\u7684\u9884\u6d4b\u7ed3\u679c\uff0c\u4ece\u800c\u5f97\u5230\u96c6\u6210\u5206\u7c7b\u5668\u7684\u6700\u7ec8\u9884\u6d4b\u7ed3\u679c\u3002</p> <p>\u8fd9\u79cd\u96c6\u6210\u7684\u65b9\u5f0f\u53ef\u4ee5\u63d0\u9ad8\u6a21\u578b\u7684\u51c6\u786e\u6027\u548c\u9c81\u68d2\u6027\u3002\u5c31\u50cf\u5728\u627e\u5de5\u4f5c\u65f6\uff0c\u5982\u679c\u4f60\u5f97\u5230\u4e86\u591a\u4e2a\u4e13\u5bb6\u7684\u5efa\u8bae\uff0c\u4f60\u4f1a\u66f4\u6709\u4fe1\u5fc3\u505a\u51fa\u6b63\u786e\u7684\u51b3\u7b56\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#xgboots","title":"XGBoots","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#_5","title":"\u805a\u7c7b","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#k-means","title":"K-means","text":"<p>\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u9009\u62e9 K\uff1a\u786e\u5b9a\u8981\u5206\u6210\u7684\u7c07\u7684\u6570\u91cf K\u3002\u8fd9\u53ef\u4ee5\u662f\u9884\u5148\u8bbe\u5b9a\u7684\u503c\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e9b\u8bc4\u4f30\u6307\u6807\u6216\u8c03\u53c2\u65b9\u6cd5\u6765\u786e\u5b9a\u3002</p> </li> <li> <p>\u968f\u673a\u521d\u59cb\u5316\u805a\u7c7b\u4e2d\u5fc3\uff1a\u4ece\u6570\u636e\u96c6\u4e2d\u968f\u673a\u9009\u62e9 K \u4e2a\u6570\u636e\u70b9\u4f5c\u4e3a\u521d\u59cb\u7684\u805a\u7c7b\u4e2d\u5fc3\u3002</p> </li> <li> <p>\u5206\u914d\u6570\u636e\u70b9\u5230\u6700\u8fd1\u7684\u805a\u7c7b\u4e2d\u5fc3\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u6570\u636e\u70b9\uff0c\u8ba1\u7b97\u5176\u4e0e\u6bcf\u4e2a\u805a\u7c7b\u4e2d\u5fc3\u7684\u8ddd\u79bb\uff0c\u5e76\u5c06\u5176\u5206\u914d\u7ed9\u8ddd\u79bb\u6700\u8fd1\u7684\u805a\u7c7b\u4e2d\u5fc3\u3002</p> </li> <li> <p>\u66f4\u65b0\u805a\u7c7b\u4e2d\u5fc3\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u7c07\uff0c\u8ba1\u7b97\u7c07\u5185\u6240\u6709\u6570\u636e\u70b9\u7684\u5e73\u5747\u503c\uff08\u6216\u4e2d\u5fc3\u70b9\uff09\uff0c\u5e76\u5c06\u8fd9\u4e2a\u5e73\u5747\u503c\u4f5c\u4e3a\u65b0\u7684\u805a\u7c7b\u4e2d\u5fc3\u3002</p> </li> <li> <p>\u91cd\u590d\u6b65\u9aa4 3 \u548c 4\uff1a\u91cd\u590d\u6267\u884c\u6b65\u9aa4 3 \u548c 4\uff0c\u76f4\u5230\u805a\u7c7b\u4e2d\u5fc3\u4e0d\u518d\u53d1\u751f\u660e\u663e\u7684\u53d8\u5316\uff0c\u6216\u8005\u8fbe\u5230\u9884\u5b9a\u7684\u8fed\u4ee3\u6b21\u6570\u3002</p> </li> </ol> <p>\u4ee3\u7801</p> <pre><code>import numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.datasets import make_blobs\nfrom sklearn.cluster import KMeans\n\n# \u751f\u6210\u793a\u4f8b\u6570\u636e\nX, y = make_blobs(n_samples=1000, centers=3, random_state=42, cluster_std=1.0)\n\n# \u53ef\u89c6\u5316\u6570\u636e\u70b9\nplt.scatter(X[:, 0], X[:, 1], s=10)\nplt.xlabel(\"Feature 1\")\nplt.ylabel(\"Feature 2\")\nplt.title(\"Data points\")\nplt.show()\n\n\n# \u4f7f\u7528K-means\u7b97\u6cd5\u8fdb\u884c\u805a\u7c7b\nkmeans = KMeans(n_clusters=3, random_state=42)\nkmeans.fit(X)\n\n# \u83b7\u53d6\u805a\u7c7b\u4e2d\u5fc3\u548c\u805a\u7c7b\u6807\u7b7e\ncenters = kmeans.cluster_centers_\nlabels = kmeans.labels_\n\n# \u53ef\u89c6\u5316\u805a\u7c7b\u7ed3\u679c\nplt.scatter(X[:, 0], X[:, 1], c=labels, s=10, cmap='viridis')\nplt.scatter(centers[:, 0], centers[:, 1], c='red', s=100, marker='X', label='Centroids')\nplt.xlabel(\"Feature 1\")\nplt.ylabel(\"Feature 2\")\nplt.title(\"K-means Clustering\")\nplt.legend()\nplt.show()\n</code></pre> <p></p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#k-means_1","title":"K-means \u805a\u7c7b","text":"<p>K-means \u662f\u4e00\u79cd\u7ecf\u5178\u7684\u5212\u5206\u5f0f\u805a\u7c7b\u65b9\u6cd5\uff0c\u5b83\u7684\u76ee\u6807\u662f\u5c06\u6570\u636e\u96c6\u5206\u6210 <code>K</code> \u4e2a\u7c07\uff08clusters\uff09\uff0c\u5176\u4e2d <code>K</code> \u662f\u7528\u6237\u63d0\u524d\u8bbe\u5b9a\u7684\u7c07\u7684\u6570\u91cf\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#_6","title":"\u5de5\u4f5c\u539f\u7406","text":"<ol> <li>\u521d\u59cb\u5316\uff1a\u9996\u5148\u968f\u673a\u9009\u62e9\u00a0<code>K</code>\u00a0\u4e2a\u6570\u636e\u70b9\u4f5c\u4e3a\u7c07\u4e2d\u5fc3\uff08centroids\uff09\u3002</li> <li>\u5206\u914d\uff1a\u5bf9\u4e8e\u6570\u636e\u96c6\u4e2d\u7684\u6bcf\u4e2a\u70b9\uff0c\u5c06\u5176\u5206\u914d\u7ed9\u6700\u8fd1\u7684\u7c07\u4e2d\u5fc3\u3002</li> <li>\u66f4\u65b0\uff1a\u6839\u636e\u6240\u5206\u914d\u7684\u6570\u636e\u70b9\uff0c\u91cd\u65b0\u8ba1\u7b97\u6bcf\u4e2a\u7c07\u7684\u4e2d\u5fc3\uff08\u901a\u5e38\u662f\u7c07\u5185\u6240\u6709\u70b9\u7684\u5747\u503c\uff09\u3002</li> <li>\u8fed\u4ee3\uff1a\u91cd\u590d\u5206\u914d\u548c\u66f4\u65b0\u6b65\u9aa4\uff0c\u76f4\u5230\u6ee1\u8db3\u67d0\u4e2a\u7ec8\u6b62\u6761\u4ef6\uff08\u5982\u7c07\u4e2d\u5fc3\u4e0d\u518d\u53d8\u5316\uff0c\u6216\u8005\u8fbe\u5230\u9884\u5b9a\u7684\u8fed\u4ee3\u6b21\u6570\uff09\u3002</li> </ol>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#_7","title":"\u4e3b\u8981\u7279\u70b9","text":"<ul> <li>\u901f\u5ea6\u5feb\uff1a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u76f8\u5bf9\u8f83\u4f4e\uff0c\u9002\u5408\u4e8e\u5927\u89c4\u6a21\u6570\u636e\u96c6\u3002</li> <li>\u6613\u4e8e\u5b9e\u73b0\uff1a\u7b97\u6cd5\u6b65\u9aa4\u7b80\u5355\uff0c\u5b9e\u73b0\u8d77\u6765\u5bb9\u6613\u3002</li> <li>\u89c4\u6a21\u7ea6\u675f\uff1a\u6700\u9002\u5408\u53d1\u73b0\u7403\u5f62\u7c07\u7684\u6570\u636e\uff0c\u5982\u679c\u7c07\u7684\u5f62\u72b6\u8f83\u590d\u6742\u6216\u8005\u5927\u5c0f\u548c\u5bc6\u5ea6\u5dee\u5f02\u5f88\u5927\uff0c\u5219\u8868\u73b0\u4e0d\u4f73\u3002</li> <li>\u9700\u8981\u9884\u8bbe\u7c07\u6570\uff1a\u4e8b\u5148\u9700\u8981\u77e5\u9053\u8981\u5206\u6210\u7684\u7c07\u7684\u6570\u91cf\u3002</li> <li>\u5bf9\u5f02\u5e38\u503c\u654f\u611f\uff1a\u566a\u58f0\u548c\u79bb\u7fa4\u503c\u53ef\u4ee5\u5bf9\u7c07\u4e2d\u5fc3\u7684\u8ba1\u7b97\u4ea7\u751f\u8f83\u5927\u5f71\u54cd\uff0c\u5f71\u54cd\u805a\u7c7b\u7ed3\u679c\u3002</li> </ul>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#dbscan","title":"\u5bc6\u5ea6\u805a\u7c7b\uff08\u4ee5 DBSCAN \u4e3a\u4f8b\uff09","text":"<p>DBSCAN\uff08Density-Based Spatial Clustering of Applications with Noise\uff09\u662f\u4e00\u79cd\u57fa\u4e8e\u5bc6\u5ea6\u7684\u805a\u7c7b\u7b97\u6cd5\uff0c\u4e0d\u9700\u8981\u63d0\u524d\u6307\u5b9a\u7c07\u7684\u6570\u91cf\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#_8","title":"\u5de5\u4f5c\u539f\u7406","text":"<ol> <li>\u6838\u5fc3\u70b9\uff1a\u5982\u679c\u4e00\u4e2a\u70b9\u7684\u00a0<code>\u03b5</code>\u00a0\u90bb\u57df\u5185\u6709\u8d85\u8fc7\u00a0<code>MinPts</code>\u00a0\u4e2a\u70b9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u70b9\u88ab\u6807\u8bb0\u4e3a\u6838\u5fc3\u70b9\u3002</li> <li>\u8fb9\u754c\u70b9\u548c\u566a\u58f0\uff1a\u5982\u679c\u4e00\u4e2a\u70b9\u4e0d\u662f\u6838\u5fc3\u70b9\uff0c\u4f46\u4f4d\u4e8e\u6838\u5fc3\u70b9\u7684\u00a0<code>\u03b5</code>\u00a0\u90bb\u57df\u5185\uff0c\u5219\u79f0\u4e3a\u8fb9\u754c\u70b9\uff1b\u65e2\u4e0d\u662f\u6838\u5fc3\u70b9\u4e5f\u4e0d\u662f\u8fb9\u754c\u70b9\u7684\u70b9\uff0c\u79f0\u4e3a\u566a\u58f0\u3002</li> <li>\u5f62\u6210\u7c07\uff1a\u4ece\u4e00\u4e2a\u6838\u5fc3\u70b9\u5f00\u59cb\uff0c\u5c06\u5176\u00a0<code>\u03b5</code>\u00a0\u90bb\u57df\u5185\u7684\u6240\u6709\u70b9\u5305\u62ec\u5728\u4e00\u4e2a\u7c07\u5185\u3002\u7136\u540e\u9012\u5f52\u5730\u5bf9\u6240\u6709\u5c1a\u672a\u8bbf\u95ee\u7684\u6838\u5fc3\u70b9\u8fdb\u884c\u76f8\u540c\u7684\u8fc7\u7a0b\uff0c\u76f4\u5230\u6240\u6709\u7684\u6838\u5fc3\u70b9\u90fd\u88ab\u8bbf\u95ee\u3002</li> <li>\u5408\u5e76\u7c07\uff1a\u5982\u679c\u4e24\u4e2a\u6838\u5fc3\u70b9\u7684\u00a0<code>\u03b5</code>\u00a0\u90bb\u57df\u5185\u6709\u4ea4\u96c6\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u6838\u5fc3\u70b9\u6240\u5728\u7684\u7c07\u5c06\u88ab\u5408\u5e76\u3002</li> </ol>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#_9","title":"\u4e3b\u8981\u7279\u70b9","text":"<ul> <li>\u4e0d\u9700\u8981\u9884\u8bbe\u7c07\u6570\uff1a\u7b97\u6cd5\u81ea\u52a8\u786e\u5b9a\u7c07\u7684\u6570\u91cf\u3002</li> <li>\u7075\u6d3b\u6027\uff1a\u80fd\u591f\u8bc6\u522b\u4efb\u610f\u5f62\u72b6\u7684\u7c07\u3002</li> <li>\u5bf9\u566a\u58f0\u4e0d\u654f\u611f\uff1a\u80fd\u591f\u8bc6\u522b\u5e76\u5904\u7406\u566a\u58f0\u6570\u636e\u3002</li> <li>\u8fb9\u754c\u70b9\u53ef\u80fd\u5c5e\u4e8e\u591a\u4e2a\u7c07\uff1a\u8fb9\u754c\u70b9\u53ef\u80fd\u5728\u4e24\u4e2a\u6838\u5fc3\u70b9\u7684\u00a0<code>\u03b5</code>\u00a0\u90bb\u57df\u5185\uff0c\u56e0\u800c\u53ef\u80fd\u88ab\u5206\u914d\u5230\u591a\u4e2a\u7c07\u4e2d\u3002</li> <li>\u4e24\u4e2a\u4e3b\u8981\u53c2\u6570\uff1a<code>\u03b5</code>\uff08\u90bb\u57df\u7684\u5927\u5c0f\uff09\u548c\u00a0<code>MinPts</code>\uff08\u5f62\u6210\u5bc6\u96c6\u533a\u57df\u6240\u9700\u7684\u6700\u5c0f\u70b9\u6570\uff09\u9700\u8981\u901a\u8fc7\u7ecf\u9a8c\u6216\u5176\u4ed6\u6280\u672f\uff08\u5982\u57fa\u4e8e\u819d\u70b9\u6cd5\u5219\u7684\u542f\u53d1\u5f0f\u7b97\u6cd5\uff09\u9009\u62e9\u3002</li> </ul>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/#rewrite","title":"Rewrite","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98/","title":"\u673a\u5668\u5b66\u4e60\u5b9e\u6218","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98/#_2","title":"\u51b3\u7b56\u6811","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98/#_3","title":"\u57fa\u7840","text":"<p>\u9e22\u5c3e\u82b1\u6570\u636e\u96c6</p> <pre><code>from sklearn.datasets import load_iris\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import accuracy_score\n\n# \u52a0\u8f7d\u6570\u636e\niris = load_iris()\nX = iris.data\ny = iris.target\n\n# \u6570\u636e\u62c6\u5206\u6210\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1)\n\n# \u521b\u5efa\u51b3\u7b56\u6811\u5206\u7c7b\u5668\u5b9e\u4f8b\nclassifier = DecisionTreeClassifier()\n\n# \u7528\u8bad\u7ec3\u96c6\u8bad\u7ec3\u6a21\u578b\nclassifier.fit(X_train, y_train)\n\n# \u5229\u7528\u8bad\u7ec3\u597d\u7684\u6a21\u578b\u9884\u6d4b\u6d4b\u8bd5\u96c6\u7684\u7ed3\u679c\ny_pred = classifier.predict(X_test)\n\n# \u8ba1\u7b97\u9884\u6d4b\u7684\u51c6\u786e\u7387\nprint('Accuracy: ', accuracy_score(y_test, y_pred))\n</code></pre> <p>output <pre><code>Accuracy:  0.9555555555555556\n</code></pre></p> <p>\u9996\u5148\u52a0\u8f7d\u4e86\u9e22\u5c3e\u82b1\u6570\u636e\u96c6\uff0c\u7136\u540e\u6570\u636e\u96c6\u88ab\u5212\u5206\u4e3a70%\u7684\u8bad\u7ec3\u96c6\u548c30%\u7684\u6d4b\u8bd5\u96c6\u3002\u7136\u540e\u521b\u5efa\u4e86\u4e00\u4e2a\u51b3\u7b56\u6811\u5206\u7c7b\u5668\uff0c\u5e76\u7528\u8bad\u7ec3\u96c6\u6570\u636e\u548c\u5bf9\u5e94\u7684\u6807\u7b7e\u8fdb\u884c\u8bad\u7ec3\u3002\u8bad\u7ec3\u5b8c\u6a21\u578b\u540e\uff0c\u6211\u4eec\u4f7f\u7528\u8be5\u6a21\u578b\u5bf9\u6d4b\u8bd5\u96c6\u8fdb\u884c\u9884\u6d4b\uff0c\u5e76\u8ba1\u7b97\u9884\u6d4b\u7684\u51c6\u786e\u7387\u3002</p> <p>\u8fd9\u662f\u4e00\u4e2a\u5f88\u57fa\u7840\u7684\u4f7f\u7528\u51b3\u7b56\u6811\u6a21\u578b\u7684\u793a\u4f8b\uff0c\u5bf9\u4e8e\u5b9e\u9645\u9879\u76ee\uff0c\u53ef\u80fd\u8fd8\u9700\u8981\u8003\u8651\u4e00\u4e9b\u5176\u4ed6\u56e0\u7d20\uff0c\u6bd4\u5982\u6570\u636e\u9884\u5904\u7406\uff0c\u7279\u5f81\u9009\u62e9\uff0c\u6a21\u578b\u53c2\u6570\u7684\u8c03\u6574\u7b49\u7b49\u3002</p> <p>\u4e73\u817a\u764c\u6570\u636e\u96c6</p> <pre><code>from sklearn.datasets import load_breast_cancer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.preprocessing import StandardScaler\n\n# \u8bfb\u53d6\u6570\u636e\ndata = load_breast_cancer()\nX = data.data\ny = data.target\n\n# \u6570\u636e\u9884\u5904\u7406\nscaler = StandardScaler()\nX = scaler.fit_transform(X) # \u6807\u51c6\u5316\n\n# \u6570\u636e\u5212\u5206\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n\n# \u521b\u5efa\u6a21\u578b\nclf = DecisionTreeClassifier(random_state=42)\n\n# \u8bad\u7ec3\u6a21\u578b\nclf.fit(X_train, y_train)\n\n# \u5bf9\u6d4b\u8bd5\u96c6\u8fdb\u884c\u9884\u6d4b\ny_pred = clf.predict(X_test)\n\n# \u5bf9\u6a21\u578b\u8fdb\u884c\u8bc4\u4f30\nprint('Accuracy: ', accuracy_score(y_test, y_pred))\n\n# \u5982\u679c\u51c6\u786e\u7387\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u53ef\u4ee5\u8c03\u6574\u6a21\u578b\u7684\u53c2\u6570\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u9650\u5236\u6811\u7684\u6700\u5927\u6df1\u5ea6\uff1a\nclf = DecisionTreeClassifier(max_depth=3, random_state=42)\nclf.fit(X_train, y_train)\ny_pred = clf.predict(X_test)\nprint('Accuracy with max_depth=3: ', accuracy_score(y_test, y_pred))\n</code></pre> <p>output <pre><code>Accuracy:  0.9473684210526315\nAccuracy with max_depth=3:  0.9473684210526315\n</code></pre></p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89/","title":"\u673a\u5668\u5b66\u4e60\uff08\u4e8c\uff09","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89/#knn","title":"knn\u7b97\u6cd5\u7684\u4f7f\u7528","text":"<p>K\u8fd1\u90bb\u7b97\u6cd5\uff08K-Nearest Neighbor\uff0cKNN\uff09\u662f\u4e00\u79cd\u57fa\u672c\u7684\u5206\u7c7b\u548c\u56de\u5f52\u7b97\u6cd5\u3002</p> <p>\u5176\u57fa\u672c\u601d\u60f3\u662f\u5728\u6837\u672c\u7a7a\u95f4\u4e2d\u901a\u8fc7\u8ba1\u7b97\u4e0d\u540c\u6837\u672c\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u4ee5\u6700\u90bb\u8fd1\u6837\u672c\u70b9\u7684\u6807\u7b7e\u6765\u51b3\u5b9a\u8be5\u6837\u672c\u70b9\u7684\u7c7b\u522b\u3002KNN\u7b97\u6cd5\u5b9e\u73b0\u7b80\u5355\uff0c\u4e0d\u9700\u8981\u6c42\u89e3\u590d\u6742\u7684\u6570\u5b66\u6a21\u578b\uff0c\u5177\u6709\u8f83\u9ad8\u7684\u53ef\u89e3\u91ca\u6027\u548c\u51c6\u786e\u6027\uff0c\u5e7f\u6cdb\u5e94\u7528\u4e8e\u6a21\u5f0f\u8bc6\u522b\u3001\u56fe\u50cf\u5904\u7406\u3001\u6570\u636e\u6316\u6398\u7b49\u9886\u57df\u3002 </p> <p>KNN\u7b97\u6cd5\u7684\u6838\u5fc3\u601d\u8def\u662f\uff1a\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u4e00\u4e2a\u672a\u6807\u8bb0\u7684\u6837\u672c\uff0c\u5c06\u5176\u4e0e\u5df2\u6807\u8bb0\u7684\u6837\u672c\u6bd4\u8f83\uff0c\u627e\u5230\u8ddd\u79bb\u8be5\u6837\u672c\u6700\u8fd1\u7684K\u4e2a\u5df2\u6807\u8bb0\u6837\u672c\uff0c\u7136\u540e\u6839\u636e\u8fd9K\u4e2a\u6837\u672c\u7684\u6807\u8bb0\u6765\u9884\u6d4b\u8be5\u6837\u672c\u7684\u6807\u8bb0\u3002\u5176\u4e2dK\u662f\u4e00\u4e2a\u9884\u5148\u8bbe\u5b9a\u7684\u5e38\u6570\uff0c\u4e00\u822c\u901a\u8fc7\u4ea4\u53c9\u9a8c\u8bc1\u6765\u786e\u5b9a\u3002 </p> <p>KNN\u7b97\u6cd5\u7684\u4f18\u70b9\u5728\u4e8e\u5b83\u53ef\u4ee5\u975e\u5e38\u81ea\u7136\u5730\u5904\u7406\u591a\u5206\u7c7b\u95ee\u9898\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u591a\u6570\u8868\u51b3\u786e\u5b9a\u6837\u672c\u7684\u7c7b\u522b\uff09\uff0c\u5e76\u4e14\u5bf9\u4e8e\u8bad\u7ec3\u6837\u672c\u96c6\u4e2d\u7684\u566a\u97f3\u548c\u5f02\u5e38\u70b9\u5177\u6709\u8f83\u9ad8\u7684\u9c81\u68d2\u6027\u3002\u4f46\u662f\uff0cKNN\u7b97\u6cd5\u7684\u8ba1\u7b97\u6210\u672c\u8f83\u9ad8\uff0c\u5c24\u5176\u662f\u5728\u5904\u7406\u5927\u89c4\u6a21\u6570\u636e\u96c6\u65f6\uff0c\u56e0\u4e3a\u8981\u8ba1\u7b97\u6bcf\u4e2a\u672a\u6807\u8bb0\u6837\u672c\u548c\u6240\u6709\u5df2\u6807\u8bb0\u6837\u672c\u4e4b\u95f4\u7684\u8ddd\u79bb\u3002\u6b64\u5916\uff0c\u5728KNN\u7b97\u6cd5\u4e2d\uff0c\u8ddd\u79bb\u5ea6\u91cf\u7684\u9009\u62e9\u5bf9\u7b97\u6cd5\u7684\u6027\u80fd\u5f71\u54cd\u5f88\u5927\uff0c\u9700\u8981\u6839\u636e\u5177\u4f53\u95ee\u9898\u8fdb\u884c\u9009\u62e9\u3002</p> <pre><code>from sklearn.neighbors import KNeighborsClassifier\n\n# \u6784\u9020\u6570\u636e\u96c6\n\nx = [0], [1], [2], [3]\ny = [0,0,1,1]\n\n# \u5b9e\u4f8b\u5316\u5bf9\u8c61\nestimator = KNeighborsClassifier(n_neighbors=2)\n\n# \u4f7f\u7528fit\u65b9\u6cd5\u8fdb\u884c\u8bad\u7ec3\nestimator.fit(x,y)\n\n\n# \u6570\u636e\u9884\u6d4b\nret = estimator.predict([[0]])\n\nprint(ret)\n\nret1 = estimator.predict([[1]])\n\nprint(ret1)\n</code></pre> <p>k\u503c\u8fc7\u5c0f\uff1a     \u6613\u53d7\u5f02\u5e38\u70b9\u5f71\u54cd k\u503c\u8fc7\u5927\uff1a     \u53d7\u5230\u6837\u672c\u5747\u8861\u95ee\u9898</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%8C%EF%BC%89/#kd","title":"kd\u6811","text":"<p>KD\u6811\uff08K-Dimensional Tree\uff09\u662f\u4e00\u79cd\u57fa\u4e8e\u4e8c\u53c9\u6811\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u53ef\u4ee5\u9ad8\u6548\u5730\u5904\u7406k\u7ef4\u7a7a\u95f4\u4e2d\u7684\u6570\u636e\u3002KD\u6811\u7684\u6784\u5efa\u8fc7\u7a0b\u4e2d\uff0c\u6bcf\u6b21\u4ee5\u67d0\u4e00\u7ef4\u5ea6\u4e3a\u5206\u5272\u8f74\uff0c\u5c06\u6570\u636e\u96c6\u5212\u5206\u6210\u4e24\u4e2a\u5b50\u96c6\uff0c\u5e76\u9012\u5f52\u5730\u5728\u5b50\u96c6\u4e2d\u6784\u5efaKD\u6811\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0cKD\u6811\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u9ad8\u7ef4\u7a7a\u95f4\u4e2d\u6570\u636e\u7684\u5feb\u901f\u641c\u7d22\u548c\u6700\u8fd1\u90bb\u67e5\u8be2\u7b49\u64cd\u4f5c\u3002</p> <p>KNN\uff08K-Nearest Neighbor\uff09\u662f\u4e00\u79cd\u57fa\u4e8e\u5b9e\u4f8b\u7684\u5b66\u4e60\u65b9\u6cd5\uff0c\u5b83\u7684\u57fa\u672c\u601d\u60f3\u662f\u5229\u7528\u5df2\u77e5\u7c7b\u522b\u7684\u6837\u672c\u4e2d\u7684K\u4e2a\u6700\u90bb\u8fd1\u7684\u6837\u672c\uff0c\u6765\u786e\u5b9a\u672a\u77e5\u6837\u672c\u7684\u7c7b\u522b\u3002KNN\u7b97\u6cd5\u7684\u5b9e\u73b0\u8fc7\u7a0b\u4e2d\uff0c\u9700\u8981\u5bf9\u6bcf\u4e2a\u672a\u77e5\u6837\u672c\u8fdb\u884c\u4e00\u6b21\u6700\u8fd1\u90bb\u67e5\u8be2\uff0c\u4ee5\u83b7\u53d6\u6700\u90bb\u8fd1\u7684K\u4e2a\u6837\u672c\u3002\u800cKD\u6811\u6b63\u662fKNN\u7b97\u6cd5\u4e2d\u5b9e\u73b0\u6700\u8fd1\u90bb\u67e5\u8be2\u7684\u4e00\u79cd\u5e38\u7528\u6570\u636e\u7ed3\u6784\u3002</p> <p>\u5728KNN\u7b97\u6cd5\u4e2d\uff0c\u4f7f\u7528KD\u6811\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u67e5\u8be2\u7684\u901f\u5ea6\uff0c\u56e0\u4e3aKD\u6811\u80fd\u591f\u6709\u6548\u5730\u51cf\u5c11\u9700\u8981\u5bf9\u6bcf\u4e2a\u6837\u672c\u8fdb\u884c\u8ddd\u79bb\u8ba1\u7b97\u7684\u6b21\u6570\u3002\u540c\u65f6\uff0c\u901a\u8fc7KD\u6811\u7684\u4f18\u5316\uff0c\u53ef\u4ee5\u5bf9KNN\u7b97\u6cd5\u4e2d\u7684\u5185\u5b58\u5360\u7528\u548c\u67e5\u8be2\u65f6\u95f4\u7b49\u6307\u6807\u8fdb\u884c\u4f18\u5316\uff0c\u63d0\u5347\u6574\u4e2a\u7b97\u6cd5\u7684\u6027\u80fd\u3002</p> <p>\u6784\u5efa\u8fc7\u7a0b\uff1a</p> <p>\u5728\u6784\u5efakd\u6811\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u9009\u5b9a\u4e00\u4e2a\u5212\u5206\u7ef4\u5ea6\uff0c\u7136\u540e\u6839\u636e\u8be5\u7ef4\u5ea6\u5c06\u6570\u636e\u5206\u4e3a\u5de6\u53f3\u4e24\u4e2a\u5b50\u96c6\uff0c\u5de6\u5b50\u96c6\u5305\u542b\u6240\u6709\u5c0f\u4e8e\u8be5\u7ef4\u5ea6\u503c\u7684\u6570\u636e\u70b9\uff0c\u53f3\u5b50\u96c6\u5305\u542b\u6240\u6709\u5927\u4e8e\u8be5\u7ef4\u5ea6\u503c\u7684\u6570\u636e\u70b9\u3002\u63a5\u7740\uff0c\u6211\u4eec\u53ef\u4ee5\u9012\u5f52\u5730\u5728\u5b50\u96c6\u4e2d\u7ee7\u7eed\u8fdb\u884c\u5212\u5206\uff0c\u76f4\u5230\u6240\u6709\u6570\u636e\u70b9\u90fd\u88ab\u5212\u5206\u5230\u4e00\u4e2a\u53f6\u5b50\u8282\u70b9\u4e2d\u3002</p> <p>\u5728\u8fdb\u884c\u67e5\u8be2\u64cd\u4f5c\u65f6\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u786e\u5b9a\u67e5\u8be2\u70b9\u6240\u5904\u7684\u53f6\u5b50\u8282\u70b9\uff0c\u7136\u540e\u8ba1\u7b97\u8be5\u53f6\u5b50\u8282\u70b9\u4e2d\u6240\u6709\u6570\u636e\u70b9\u4e0e\u67e5\u8be2\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u5e76\u627e\u51fa\u8ddd\u79bb\u6700\u8fd1\u7684\u6570\u636e\u70b9\u3002\u5982\u679c\u8be5\u8282\u70b9\u7684\u7236\u8282\u70b9\u4e2d\u8fd8\u5b58\u5728\u66f4\u8fd1\u7684\u6570\u636e\u70b9\uff0c\u5219\u7ee7\u7eed\u5411\u4e0a\u56de\u6eaf\uff0c\u76f4\u5230\u627e\u5230\u8ddd\u79bb\u6700\u8fd1\u7684\u6570\u636e\u70b9\u4e3a\u6b62\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0ckd\u6811\u7684\u6784\u5efa\u548c\u67e5\u8be2\u8fc7\u7a0b\u4e2d\uff0c\u5212\u5206\u7ef4\u5ea6\u7684\u9009\u62e9\u548c\u6570\u636e\u70b9\u7684\u63d2\u5165\u987a\u5e8f\u90fd\u4f1a\u5f71\u54cd\u6811\u7684\u7ed3\u6784\u548c\u67e5\u8be2\u6548\u7387\u3002\u56e0\u6b64\uff0c\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u6839\u636e\u5177\u4f53\u60c5\u51b5\u6765\u9009\u62e9\u6700\u4f18\u7684\u5212\u5206\u7b56\u7565\u548c\u6570\u636e\u63d2\u5165\u987a\u5e8f\uff0c\u4ee5\u83b7\u5f97\u6700\u4f73\u7684\u6027\u80fd\u548c\u6548\u679c\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/Keras/","title":"Keras","text":"<p>Keras \u4e2d\u6587\u6587\u6863</p> <p>API reference</p> <p>Keras \u662f\u4e00\u4e2a\u7528 Python \u7f16\u5199\u7684\u9ad8\u7ea7\u795e\u7ecf\u7f51\u7edc API</p> <p>\u5feb\u901f\u5f00\u59cb</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/numpy/","title":"numpy","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/numpy/#python","title":"python","text":"<p>linespace()</p> <p>\u5728 NumPy \u4e2d\uff0c<code>linspace</code> \u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u7528\u4e8e\u5728\u6307\u5b9a\u7684\u95f4\u9694\u5185\u8fd4\u56de\u5747\u5300\u95f4\u9694\u7684\u6570\u5b57\u5e8f\u5217\u3002\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>numpy.linspace(start, stop, num=50, endpoint=True, retstep=False, dtype=None)\n````\n\n\u53c2\u6570\u8bf4\u660e\uff1a\n\n- `start`\uff1a\u5e8f\u5217\u7684\u8d77\u59cb\u503c\u3002\n- `stop`\uff1a\u5e8f\u5217\u7684\u7ed3\u675f\u503c\u3002\n- `num`\uff1a\u8981\u751f\u6210\u7684\u7b49\u95f4\u8ddd\u6837\u672c\u6570\u91cf\uff0c\u9ed8\u8ba4\u4e3a 50\u3002\n- `endpoint`\uff1a\u5e03\u5c14\u503c\uff0c\u8868\u793a\u5e8f\u5217\u662f\u5426\u5305\u62ec\u00a0`stop`\u00a0\u503c\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a\u00a0`True`\uff0c\u5219\u5e8f\u5217\u5305\u62ec\u00a0`stop`\u00a0\u503c\uff1b\u5982\u679c\u8bbe\u7f6e\u4e3a\u00a0`False`\uff0c\u5219\u5e8f\u5217\u4e0d\u5305\u62ec\u00a0`stop`\u00a0\u503c\u3002\u9ed8\u8ba4\u4e3a\u00a0`True`\u3002\n- `retstep`\uff1a\u5e03\u5c14\u503c\uff0c\u8868\u793a\u662f\u5426\u8fd4\u56de\u95f4\u8ddd\uff08\u6b65\u957f\uff09\u3002\u5982\u679c\u8bbe\u7f6e\u4e3a\u00a0`True`\uff0c\u5219\u9664\u4e86\u8fd4\u56de\u7b49\u95f4\u8ddd\u7684\u5e8f\u5217\u4e4b\u5916\uff0c\u8fd8\u4f1a\u8fd4\u56de\u6bcf\u4e2a\u76f8\u90bb\u6837\u672c\u4e4b\u95f4\u7684\u95f4\u8ddd\u3002\u9ed8\u8ba4\u4e3a\u00a0`False`\u3002\n- `dtype`\uff1a\u8fd4\u56de\u6570\u7ec4\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5982\u679c\u672a\u63d0\u4f9b\uff0c\u5219\u6839\u636e\u8f93\u5165\u53c2\u6570\u81ea\u52a8\u786e\u5b9a\u3002\n\n\u4e0b\u9762\u662f\u51e0\u4e2a\u793a\u4f8b\uff1a\n\n```python\nimport numpy as np\n\n# \u8fd4\u56de\u4ece 0 \u5230 10 \u7684\u7b49\u95f4\u8ddd\u5e8f\u5217\uff0c\u5171\u6709 5 \u4e2a\u6837\u672c\u70b9\uff08\u5305\u62ec 0 \u548c 10\uff09\narr1 = np.linspace(0, 10, 5)\nprint(arr1)\n# \u8f93\u51fa\uff1a[ 0.   2.5  5.   7.5 10. ]\n\n# \u8fd4\u56de\u4ece 0 \u5230 100 \u7684\u7b49\u95f4\u8ddd\u5e8f\u5217\uff0c\u5171\u6709 11 \u4e2a\u6837\u672c\u70b9\uff08\u5305\u62ec 0 \u548c 100\uff09\narr2 = np.linspace(0, 100, 11)\nprint(arr2)\n# \u8f93\u51fa\uff1a[  0.  10.  20.  30.  40.  50.  60.  70.  80.  90. 100.]\n\n# \u8fd4\u56de\u4ece -1 \u5230 1 \u7684\u7b49\u95f4\u8ddd\u5e8f\u5217\uff0c\u5171\u6709 7 \u4e2a\u6837\u672c\u70b9\uff08\u5305\u62ec -1 \u548c 1\uff09\uff0c\u5e76\u8fd4\u56de\u95f4\u8ddd\narr3, step = np.linspace(-1, 1, 7, retstep=True)\nprint(arr3)\nprint(step)\n# \u8f93\u51fa\uff1a\n# [-1.  -0.6 -0.2  0.2  0.6  1. ]\n# 0.4\n</code></pre> <p>\u901a\u8fc7\u4f7f\u7528 <code>linspace</code> \u51fd\u6570\uff0c\u4f60\u53ef\u4ee5\u8f7b\u677e\u5730\u751f\u6210\u6307\u5b9a\u95f4\u9694\u7684\u7b49\u95f4\u8ddd\u5e8f\u5217\uff0c\u8fd9\u5728\u6570\u503c\u8ba1\u7b97\u548c\u7ed8\u56fe\u7b49\u9886\u57df\u975e\u5e38\u6709\u7528\u3002</p> <p>c_</p> <p><code>numpy</code> \u7684 <code>c_</code> \u662f\u4e00\u4e2a\u7528\u4e8e\u6309\u5217\u8fde\u63a5\uff08concatenate\uff09\u7684\u7279\u6b8a\u5bf9\u8c61\uff0c\u5b83\u53ef\u4ee5\u5c06\u4e24\u4e2a\u6216\u591a\u4e2a <code>numpy</code> \u6570\u7ec4\u6309\u5217\u5806\u53e0\u8d77\u6765\u3002\u5b83\u7684\u4f5c\u7528\u7c7b\u4f3c\u4e8e <code>numpy</code> \u4e2d\u7684 <code>hstack</code> \u51fd\u6570\uff0c\u4f46\u662f <code>c_</code> \u63d0\u4f9b\u4e86\u66f4\u7b80\u6d01\u7684\u8bed\u6cd5\u3002</p> <p>\u4f7f\u7528 <code>c_</code> \u5bf9\u8c61\u53ef\u4ee5\u901a\u8fc7\u5c06\u6570\u7ec4\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u5b83\u6765\u5b9e\u73b0\u6309\u5217\u8fde\u63a5\u3002\u4e0b\u9762\u662f\u51e0\u4e2a\u793a\u4f8b\uff1a</p> <pre><code>import numpy as np\n\n# \u793a\u4f8b 1\narr1 = np.array([1, 2, 3])\narr2 = np.array([4, 5, 6])\nresult1 = np.c_[arr1, arr2]\nprint(result1)\n# \u8f93\u51fa\uff1a\n# [[1 4]\n#  [2 5]\n#  [3 6]]\n\n# \u793a\u4f8b 2\narr3 = np.array([[1, 2], [3, 4]])\narr4 = np.array([[5, 6]])\nresult2 = np.c_[arr3, arr4]\nprint(result2)\n# \u8f93\u51fa\uff1a\n# [[1 2 5]\n#  [3 4 6]]\n\n# \u793a\u4f8b 3\narr5 = np.array([[1, 2], [3, 4]])\narr6 = np.array([[5], [6]])\nresult3 = np.c_[arr5, arr6]\nprint(result3)\n# \u8f93\u51fa\uff1a\n# [[1 2 5]\n#  [3 4 6]]\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/","title":"opencv","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#python","title":"python #\u8ba1\u7b97\u673a\u89c6\u89c9","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_1","title":"\u56fe\u50cf\u53d8\u6362","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_2","title":"\u900f\u89c6\u53d8\u6362","text":"<pre><code># \u900f\u89c6\u53d8\u6362\n\n# 1.\u5b9a\u4e49\u53d8\u6362\u77e9\u9635M\uff0c \u9700\u8981\u6709\u8f93\u5165\u6e90\u56fe\u50cf\u4e0a\u7684\u56db\u4e2a\u70b9\u548c\u76ee\u6807\u56fe\u50cf\u4e0a\u7684\u5bf9\u5e94\u56db\u4e2a\u70b9\u3002\n# \u8f93\u5165\u6e90\uff1aapprox_contours[0] shape:(4, 1, 2)\nsrc_points = approx_contours[0]\n\nsrc_points = src_points.reshape(4,2)\nprint(src_points)\n\ndef get_dst_points(src_points):\n    points = np.zeros((4,2),dtype='float32')\n\n    s = src_points.sum(axis=1) # \u884c\u7684\u548c x+y\n    # \u5de6\u4e0a\u89d2\u7684\u70b9\n    points[0] = src_points[np.argmin(s)]\n    # \u53f3\u4e0b\u89d2\u7684\u70b9\n    points[2] = src_points[np.argmax(s)]\n\n    d = np.diff(src_points,axis=1) # \u884c\u7684\u5dee x-y\n    # \u53f3\u4e0a\u89d2\u7684\u70b9 \n    points[1] = src_points[np.argmin(d)]\n    # \u5de6\u4e0b\u89d2\u7684\u70b9\n    points[3] = src_points[np.argmax(d)]\n\n    # \u5fc5\u987b\u6309\u8fd9\u4e2a\u7d22\u5f15\u987a\u5e8f\n\n    w1 = np.sqrt((points[0][0] -points[1][0])**2 + (points[0][1]-points[1][1])**2)\n    w2 = np.sqrt((points[2][0] -points[3][0])**2 + (points[2][1]-points[3][1])**2) \n    h1 = np.sqrt((points[0][0] -points[3][0])**2 + (points[0][1]-points[3][1])**2)\n    h2 = np.sqrt((points[1][0] -points[2][0])**2 + (points[1][1]-points[2][1])**2)\n\n    width = max(int(w1),int(w2))\n    print(width)\n    height = max(int(h1),int(h2))\n    print(height)\n\n    # -1 \u53ea\u662f\u4e3a\u4e86\u9632\u6b62\u8bef\u5dee\n\n    dst = np.array(\n        [[0,0],[width-1,0],[width-1,height-1],[0,height-1]],\n        dtype='float32'\n    )\n    return points,dst,width,height\n\nsrc,dst,width,height =  get_dst_points(src_points)\n\nM = cv.getPerspectiveTransform(src,dst)\n\nwarped = cv.warpPerspective(image,M,(width,height))\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_3","title":"\u9608\u503c\u5316","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_4","title":"\u7b80\u5355\u9608\u503c\u5316","text":"<pre><code>ret, threshold = cv2.threshold(src, thresh, maxval, type)\n</code></pre> <ul> <li><code>src</code>\uff1a\u8f93\u5165\u56fe\u50cf\uff0c\u5e94\u4e3a\u7070\u5ea6\u56fe\u50cf\u3002</li> <li><code>thresh</code>\uff1a\u9608\u503c\uff0c\u5927\u4e8e\u9608\u503c\u7684\u50cf\u7d20\u88ab\u5206\u914d\u4e3a <code>maxval</code>\uff0c\u5c0f\u4e8e\u7b49\u4e8e\u9608\u503c\u7684\u50cf\u7d20\u88ab\u5206\u914d\u4e3a0\u3002</li> <li><code>maxval</code>\uff1a\u5206\u914d\u7ed9\u5927\u4e8e\u9608\u503c\u7684\u50cf\u7d20\u7684\u503c\u3002</li> <li><code>type</code>\uff1a\u9608\u503c\u5316\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f\u4ee5\u4e0b\u503c\u4e4b\u4e00\uff1a<ul> <li><code>cv2.THRESH_BINARY</code>\uff1a\u4e8c\u503c\u9608\u503c\u5316\u3002</li> <li><code>cv2.THRESH_BINARY_INV</code>\uff1a\u53cd\u5411\u4e8c\u503c\u9608\u503c\u5316\u3002</li> <li><code>cv2.THRESH_TRUNC</code>\uff1a\u622a\u65ad\u9608\u503c\u5316\uff0c\u5927\u4e8e\u9608\u503c\u7684\u50cf\u7d20\u503c\u8bbe\u4e3a\u9608\u503c\uff0c\u5c0f\u4e8e\u7b49\u4e8e\u9608\u503c\u7684\u50cf\u7d20\u503c\u4fdd\u6301\u4e0d\u53d8\u3002</li> <li><code>cv2.THRESH_TOZERO</code>\uff1a\u8d85\u8fc7\u9608\u503c\u7684\u50cf\u7d20\u503c\u4fdd\u6301\u4e0d\u53d8\uff0c\u5c0f\u4e8e\u7b49\u4e8e\u9608\u503c\u7684\u50cf\u7d20\u503c\u8bbe\u4e3a0\u3002</li> <li><code>cv2.THRESH_TOZERO_INV</code>\uff1a\u4f4e\u4e8e\u9608\u503c\u7684\u50cf\u7d20\u503c\u4fdd\u6301\u4e0d\u53d8\uff0c\u5927\u4e8e\u9608\u503c\u7684\u50cf\u7d20\u503c\u8bbe\u4e3a0\u3002</li> </ul> </li> <li><code>ret</code>\uff1a\u8ba1\u7b97\u5f97\u5230\u7684\u9608\u503c\u3002</li> </ul>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_5","title":"\u81ea\u9002\u5e94\u9608\u503c\u5316","text":"<pre><code>threshold = cv2.adaptiveThreshold(src, maxval, cv2.ADAPTIVE_THRESH_MEAN_C, cv2.THRESH_BINARY, blockSize, C)\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#inrange","title":"inRange()","text":"<p><code>cv2.inRange()</code></p> <p>\u591a\u901a\u9053\u7248\u7684threshold</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_6","title":"\u8f6e\u5ed3","text":"<pre><code>contours, _ = cv2.findContours(threshold, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)\n</code></pre> <p>\u4e00\u822c\u6b65\u9aa4\uff1a 1. \u8f6c\u6362\u4e3a\u7070\u5ea6\u56fe\u50cf 2. \u6a21\u7cca\u5904\u7406 3. \u9608\u503c\u5316\u5904\u7406 4. \u67e5\u627e\u8f6e\u5ed3 5. \u5904\u7406\u8f6e\u5ed3</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_7","title":"\u8f6e\u5ed3\u68c0\u7d22\u6a21\u5f0f","text":"<ol> <li> <p>cv.RETR_EXTERNAL\uff1a\u4ec5\u68c0\u6d4b\u5916\u90e8\u8f6e\u5ed3\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u53ea\u8fd4\u56de\u56fe\u50cf\u4e2d\u7684\u6700\u5916\u5c42\u8f6e\u5ed3\uff0c\u4e0d\u5173\u5fc3\u5185\u90e8\u7684\u8f6e\u5ed3\u3002</p> </li> <li> <p>cv.RETR_LIST\uff1a\u68c0\u6d4b\u6240\u6709\u7684\u8f6e\u5ed3\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u5217\u8868\u4e2d\uff0c\u4e0d\u8fdb\u884c\u4efb\u4f55\u5c42\u7ea7\u5173\u7cfb\u7684\u5efa\u7acb\u3002</p> </li> <li> <p>cv.RETR_CCOMP\uff1a\u68c0\u6d4b\u6240\u6709\u7684\u8f6e\u5ed3\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u4e24\u5c42\u7684\u5c42\u7ea7\u7ed3\u6784\u4e2d\u3002\u9876\u5c42\u5c42\u7ea7\u5305\u542b\u56fe\u50cf\u4e2d\u7684\u6574\u4f53\u8f6e\u5ed3\uff0c\u800c\u6b21\u5c42\u5c42\u7ea7\u5305\u542b\u5185\u90e8\u7684\u5b54\u6d1e\u8f6e\u5ed3\u3002\u5982\u679c\u4e00\u4e2a\u8f6e\u5ed3\u4f4d\u4e8e\u53e6\u4e00\u4e2a\u8f6e\u5ed3\u7684\u5185\u90e8\uff0c\u5219\u5c06\u5176\u89c6\u4e3a\u6b21\u5c42\u8f6e\u5ed3\u3002</p> </li> <li> <p>cv.RETR_TREE\uff1a\u68c0\u6d4b\u6240\u6709\u7684\u8f6e\u5ed3\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u6811\u5f62\u7ed3\u6784\u4e2d\u3002\u8be5\u6a21\u5f0f\u53ef\u4ee5\u68c0\u6d4b\u8f6e\u5ed3\u4e4b\u95f4\u7684\u5b8c\u6574\u5c42\u7ea7\u5173\u7cfb\uff0c\u5305\u62ec\u7236\u5b50\u5173\u7cfb\u548c\u5144\u5f1f\u5173\u7cfb\u3002</p> </li> </ol>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_8","title":"\u8f6e\u5ed3\u7684\u76f8\u5173\u65b9\u6cd5","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_9","title":"\u8ba1\u7b97\u8f6e\u5ed3\u9762\u79ef","text":"<p>\u8ba1\u7b97\u8f6e\u5ed3\u9762\u79ef\u5e76\u6392\u5e8f</p> <pre><code>import cv2\n\n# \u8bfb\u53d6\u56fe\u50cf\u5e76\u8f6c\u6362\u4e3a\u7070\u5ea6\u56fe\u50cf\nimage = cv2.imread('image.jpg')\ngray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)\n\n# \u8fdb\u884c\u8fb9\u7f18\u68c0\u6d4b\nedges = cv2.Canny(gray, 100, 200)\n\n# \u67e5\u627e\u8f6e\u5ed3\ncontours, _ = cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)\n\n# \u6309\u7167\u8f6e\u5ed3\u9762\u79ef\u8fdb\u884c\u6392\u5e8f\ncontours = sorted(contours, key=cv2.contourArea, reverse=True)\n\n# \u7ed8\u5236\u8f6e\u5ed3\noutput = image.copy()\nfor i, contour in enumerate(contours):\n    # -1 \u8868\u793a\u5217\u8868\u4e2d\u7684\u6240\u6709\u503c\n    cv2.drawContours(output, [contour], -1, (0, 255, 0), 2)\n    cv2.putText(output, str(i + 1), tuple(contour[0][0]), cv2.FONT_HERSHEY_SIMPLEX, 1, (0, 0, 255), 2)\n\n# \u663e\u793a\u7ed3\u679c\ncv2.imshow('Contours', output)\ncv2.waitKey(0)\ncv2.destroyAllWindows()\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_10","title":"\u8f6e\u5ed3\u8fd1\u4f3c\u5904\u7406","text":"<pre><code># \u5bf9\u6bcf\u4e2a\u8f6e\u5ed3\u6267\u884c\u8fd1\u4f3c\napprox_contours = []\nfor contour in contours:\n    # \u8fd1\u4f3c\u8f6e\u5ed3\n    epsilon = 0.02 * cv2.arcLength(contour, True)\n    approx = cv2.approxPolyDP(contour, epsilon, True)\n\n    # \u5982\u679c\u8fd1\u4f3c\u540e\u7684\u8f6e\u5ed3\u67094\u4e2a\u70b9\uff0c\u5219\u5c06\u5176\u6dfb\u52a0\u5230\u7ed3\u679c\u5217\u8868\u4e2d\n    if len(approx) == 4:\n        approx_contours.append(approx)\n\n# \u5728\u539f\u59cb\u56fe\u50cf\u4e0a\u7ed8\u5236\u7b5b\u9009\u540e\u7684\u8f6e\u5ed3 \ncv2.drawContours(image, approx_contours, -1, (0, 255, 0), 3)\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_11","title":"\u8f6e\u5ed3\u6700\u5c0f\u77e9\u5f62\u8fb9\u754c\u6846","text":"<p><code>cv2.boundingRect()</code> \u7528\u4e8e\u8ba1\u7b97\u7ed9\u5b9a\u8f6e\u5ed3\u7684\u6700\u5c0f\u77e9\u5f62\u8fb9\u754c\u6846\u3002\u5b83\u63a5\u53d7\u4e00\u4e2a\u8f6e\u5ed3\u4f5c\u4e3a\u8f93\u5165\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u77e9\u5f62\u5750\u6807 <code>(x, y, width, height)</code>\uff0c\u8be5\u77e9\u5f62\u662f\u80fd\u591f\u5b8c\u5168\u5305\u56f4\u8be5\u8f6e\u5ed3\u7684\u6700\u5c0f\u77e9\u5f62\u3002</p> <pre><code>x, y, width, height = cv2.boundingRect(contour)\n</code></pre> <p>\u5176\u4e2d\uff1a</p> <ul> <li><code>contour</code> \u662f\u4e00\u4e2a\u8868\u793a\u8f6e\u5ed3\u7684 NumPy \u6570\u7ec4\u6216\u5217\u8868\u3002</li> <li><code>(x, y)</code> \u662f\u77e9\u5f62\u5de6\u4e0a\u89d2\u7684\u5750\u6807\u3002</li> <li><code>width</code> \u662f\u77e9\u5f62\u7684\u5bbd\u5ea6\u3002</li> <li><code>height</code> \u662f\u77e9\u5f62\u7684\u9ad8\u5ea6\u3002</li> </ul>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_12","title":"\u5f62\u6001\u5b66\u8fd0\u7b97","text":"<p><code>cv2.morphologyEx()</code></p> <p>\u57fa\u672c\u8bed\u6cd5 <pre><code>dst = cv2.morphologyEx(src, op, kernel)\n</code></pre></p> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li><code>src</code>\uff1a\u8f93\u5165\u56fe\u50cf\uff0c\u53ef\u4ee5\u662f\u7070\u5ea6\u56fe\u50cf\u6216\u5f69\u8272\u56fe\u50cf\u3002</li> <li><code>op</code>\uff1a\u6307\u5b9a\u5f62\u6001\u5b66\u8fd0\u7b97\u7684\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f<code>cv2.MORPH_ERODE</code>\uff08\u8150\u8680\uff09\u3001<code>cv2.MORPH_DILATE</code>\uff08\u81a8\u80c0\uff09\u3001<code>cv2.MORPH_OPEN</code>\uff08\u5f00\u8fd0\u7b97\uff09\u3001<code>cv2.MORPH_CLOSE</code>\uff08\u95ed\u8fd0\u7b97\uff09\u7b49\u3002</li> <li><code>kernel</code>\uff1a\u5f62\u6001\u5b66\u64cd\u4f5c\u7684\u5185\u6838\uff08\u7ed3\u6784\u5143\u7d20\uff09\uff0c\u7528\u4e8e\u5b9a\u4e49\u8fd0\u7b97\u7684\u5f62\u72b6\u548c\u5927\u5c0f\u3002</li> </ul>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#hat","title":"HAT","text":"<p>HAT\u64cd\u4f5c\u53ef\u4ee5\u5206\u4e3a\u4e24\u79cd\u7c7b\u578b\uff1a\u9876\u5e3d\uff08Top Hat\uff09\u548c\u9ed1\u5e3d\uff08Black Hat\uff09\u3002</p> <ul> <li> <p>\u9876\u5e3d\uff08Top Hat\uff09: \u9876\u5e3d\u64cd\u4f5c\u5b9e\u8d28\u4e0a\u662f\u539f\u59cb\u56fe\u50cf\u4e0e\u7ecf\u8fc7\u5f00\u8fd0\u7b97\u7684\u56fe\u50cf\u7684\u5dee\u5f02\u3002\u5f00\u8fd0\u7b97\u662f\u5148\u5bf9\u56fe\u50cf\u8fdb\u884c\u8150\u8680\u64cd\u4f5c\uff0c\u518d\u8fdb\u884c\u81a8\u80c0\u64cd\u4f5c\u3002\u9876\u5e3d\u64cd\u4f5c\u53ef\u4ee5\u7528\u4e8e\u68c0\u6d4b\u56fe\u50cf\u4e2d\u7684\u5c0f\u5c3a\u5bf8\u4eae\u533a\u57df\uff08\u4f8b\u5982\u566a\u70b9\uff09\u6216\u8005\u7a81\u51fa\u663e\u793a\u6697\u80cc\u666f\u4e2d\u7684\u4eae\u7ec6\u8282\u3002</p> </li> <li> <p>\u9ed1\u5e3d\uff08Black Hat\uff09: \u9ed1\u5e3d\u64cd\u4f5c\u662f\u539f\u59cb\u56fe\u50cf\u4e0e\u7ecf\u8fc7\u95ed\u8fd0\u7b97\u7684\u56fe\u50cf\u7684\u5dee\u5f02\u3002\u95ed\u8fd0\u7b97\u662f\u5148\u5bf9\u56fe\u50cf\u8fdb\u884c\u81a8\u80c0\u64cd\u4f5c\uff0c\u518d\u8fdb\u884c\u8150\u8680\u64cd\u4f5c\u3002\u9ed1\u5e3d\u64cd\u4f5c\u53ef\u4ee5\u7528\u4e8e\u68c0\u6d4b\u56fe\u50cf\u4e2d\u7684\u5c0f\u5c3a\u5bf8\u6697\u533a\u57df\u6216\u8005\u7a81\u51fa\u663e\u793a\u4eae\u80cc\u666f\u4e2d\u7684\u6697\u7ec6\u8282\u3002</p> </li> </ul> <p>TOP HAT</p> <pre><code>image = cv2.imread(\"input_image.jpg\", 0)\n\ntophat = cv2.morphologyEx(image, cv2.MORPH_TOPHAT, kernel)\n</code></pre> <p>BLACK HAT</p> <pre><code>tophat = cv2.morphologyEx(image, cv2.MORPH_TOPHAT, kernel)\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_13","title":"\u970d\u592b\u53d8\u6362\u68c0\u6d4b\u76f4\u7ebf","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#todo","title":"TODO","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_14","title":"\u89d2\u70b9\u68c0\u6d4b","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#harris","title":"Harris\u89d2\u70b9\u68c0\u6d4b","text":"<pre><code>corner_image = cv2.cornerHarris(gray, blockSize, ksize, k)\n</code></pre> <p>\u5176\u4e2d\uff0c<code>blockSize</code>\u662f\u6307\u89d2\u70b9\u68c0\u6d4b\u4e2d\u8003\u8651\u90bb\u57df\u5927\u5c0f\u7684\u53c2\u6570\uff0c<code>ksize</code>\u662f\u6307Sobel\u6c42\u5bfc\u4e2d\u4f7f\u7528\u7684\u7a97\u53e3\u5927\u5c0f\uff0c<code>k</code>\u662fHarris\u89d2\u70b9\u68c0\u6d4b\u65b9\u7a0b\u4e2d\u7684\u81ea\u7531\u53c2\u6570\u3002</p> <p>\u5bf9\u89d2\u70b9\u8fdb\u884c\u7b5b\u9009\u548c\u6807\u8bb0</p> <pre><code>threshold = 0.01 # \u9608\u503c\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8fdb\u884c\u8c03\u6574\ncorner_image = cv2.dilate(corner_image, None) # \u81a8\u80c0\u64cd\u4f5c\uff0c\u589e\u5f3a\u89d2\u70b9\nimage[corner_image &gt; threshold * corner_image.max()] = [0, 0, 255] # # \u901a\u8fc7\u9608\u503c\u7b5b\u9009\u89d2\u70b9\uff0c\u5e76\u5c06\u89d2\u70b9\u6807\u8bb0\u4e3a\u7ea2\u8272\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_15","title":"\u5149\u6d41\u4f30\u8ba1","text":"<p><code>calcOpticalFlowPyrLK</code> \u51fd\u6570\u7684\u8f93\u5165\u53c2\u6570\u548c\u8fd4\u56de\u503c\uff1a</p> <p>\u8f93\u5165\u53c2\u6570\uff1a 1. <code>prevImg</code>\uff1a\u5148\u524d\u5e27\u7684\u7070\u5ea6\u56fe\u50cf\u6216\u5f69\u8272\u56fe\u50cf\u3002 2. <code>nextImg</code>\uff1a\u540e\u7eed\u5e27\u7684\u7070\u5ea6\u56fe\u50cf\u6216\u5f69\u8272\u56fe\u50cf\u3002 3. <code>prevPts</code>\uff1a\u5148\u524d\u5e27\u4e2d\u7684\u7279\u5f81\u70b9\u4f4d\u7f6e\u96c6\u5408\uff082D\u70b9\u5411\u91cf\uff09\u3002 4. <code>nextPts</code>\uff1a\u8f93\u51fa\u53c2\u6570\uff0c\u4f30\u8ba1\u51fa\u7684\u540e\u7eed\u5e27\u4e2d\u7684\u7279\u5f81\u70b9\u4f4d\u7f6e\u96c6\u5408\u3002 5. <code>status</code>\uff1a\u8f93\u51fa\u53c2\u6570\uff0c\u72b6\u6001\u5411\u91cf\uff0c\u6307\u793a\u6bcf\u4e2a\u7279\u5f81\u70b9\u662f\u5426\u6210\u529f\u8ddf\u8e2a\u3002 6. <code>err</code>\uff1a\u8f93\u51fa\u53c2\u6570\uff0c\u8bef\u5dee\u5411\u91cf\uff0c\u6307\u793a\u6bcf\u4e2a\u7279\u5f81\u70b9\u7684\u8ddf\u8e2a\u8bef\u5dee\u3002</p> <p>\u5176\u4ed6\u53ef\u9009\u53c2\u6570\uff1a</p> <ol> <li><code>winSize</code>\uff1a\u7a97\u53e3\u5927\u5c0f\uff0c\u8868\u793a\u641c\u7d22\u5149\u6d41\u7684\u533a\u57df\u5927\u5c0f\u3002</li> <li><code>maxLevel</code>\uff1a\u91d1\u5b57\u5854\u5c42\u6570\u7684\u6700\u5927\u503c\uff0c\u7528\u4e8e\u591a\u5c3a\u5ea6\u5904\u7406\u3002</li> <li><code>criteria</code>\uff1a\u8fed\u4ee3\u505c\u6b62\u51c6\u5219\uff0c\u7528\u4e8e\u786e\u5b9a\u5149\u6d41\u4f30\u8ba1\u7684\u7cbe\u5ea6\u548c\u8fed\u4ee3\u6b21\u6570\u3002</li> </ol> <p>\u8fd4\u56de\u503c\uff1a</p> <ol> <li><code>nextPts</code> \u5411\u91cf\u5c06\u5305\u542b\u4f30\u8ba1\u7684\u540e\u7eed\u5e27\u4e2d\u7684\u7279\u5f81\u70b9\u4f4d\u7f6e\u3002</li> <li><code>status</code> \u5411\u91cf\u6307\u793a\u6bcf\u4e2a\u7279\u5f81\u70b9\u7684\u8ddf\u8e2a\u72b6\u6001\uff081 \u8868\u793a\u6210\u529f\u8ddf\u8e2a\uff0c0 \u8868\u793a\u5931\u8d25\uff09\u3002</li> <li><code>err</code> \u5411\u91cf\u5305\u542b\u6bcf\u4e2a\u7279\u5f81\u70b9\u7684\u8ddf\u8e2a\u8bef\u5dee\u3002</li> </ol> <p>\u4ee3\u7801\u793a\u4f8b\uff1a</p> <pre><code># \u5149\u6d41\u4f30\u8ba1\n\nimport numpy as np\nimport cv2 as cv\n\ncap = cv.VideoCapture(\"videos/720p_Road_traffic_video_for_object_detection_and_tracking.mp4\")\n\n# \u5b9a\u4e49Lucas-Kanade\u7b97\u6cd5\u6240\u9700\u8981\u7684\u53c2\u6570\nlk_params = dict(winSize = (15,15),\n                 maxLevel = 2)\nprint(good_new.shape)\n# \u5b9a\u4e49\u968f\u673a\u989c\u8272\u6761\ncolor = np.random.randint(0,255,(100,3))\n\n\n# \u62ff\u5230\u7b2c\u4e00\u5e27\u56fe\u50cf\u5e76\u4f5c\u7070\u5ea6\u5904\u7406\nret, first_frame = cap.read()\nold_gray = cv.cvtColor(first_frame,cv.COLOR_BGR2GRAY)\n\n# \u89d2\u70b9\u68c0\u6d4b (Shi-Tomasi\u89d2\u70b9\u68c0\u6d4b)\n# mask\uff1a\u63a9\u7801\n# maxCorners\uff1a\u89d2\u70b9\u6700\u5927\u6570\u91cf\n# qualityLevel\uff1a\u54c1\u8d28\u56e0\u5b50\uff0c\u7279\u5f81\u503c\u8d8a\u5927\u7684\u8d8a\u597d\uff0c\u7528\u6765\u7b5b\u9009\uff0c\u54c1\u8d28\u56e0\u5b50\u8d8a\u5927\uff0c\u5f97\u5230\u7684\u89d2\u70b9\u8d8a\u5c11\n# minDistance\uff1a\u6700\u5c0f\u8ddd\u79bb\uff0c\u76f8\u5f53\u4e8e\u5728\u8fd9\u4e2a\u8ddd\u79bb\u4e2d\u6709\u5176\u4ed6\u89d2\u70b9\u6bd4\u8fd9\u4e2a\u89d2\u70b9\u66f4\u9002\u5408\uff0c\u5c31\u820d\u5f03\u8fd9\u4e2a\u5f31\u7684\u89d2\u70b9\np0 = cv.goodFeaturesToTrack(old_gray, mask = None, maxCorners=100,qualityLevel=0.3,minDistance=7)\n\n\nmask = np.zeros_like(first_frame)\nwhile(True):\n    ret,frame = cap.read()\n    frame_gray = cv.cvtColor(frame,cv.COLOR_BGR2GRAY)\n    print(frame_gray.shape)\n\n    # \u9700\u8981\u4f20\u5165\u524d\u4e00\u5e27\u548c\u5f53\u524d\u56fe\u50cf\u4ee5\u53ca\u524d\u4e00\u5e27\u68c0\u6d4b\u5230\u7684\u89d2\u70b9\n    p1, st, err = cv.calcOpticalFlowPyrLK(old_gray, frame_gray, p0,None, **lk_params)\n\n    # st = 1 \u8868\u793a\n    good_new = p1[st==1]\n    good_old = p0[st==1]\n\n    # \u7ed8\u5236\u8f68\u8ff9\n    for i,(new,old) in enumerate(zip(good_new,good_old)):\n        a,b = new.ravel()\n\n        c,d = old.ravel()\n        a,b,c,d = int(a),int(b),int(c),int(d)\n        mask = cv.line(mask,(a,b),(c,d),color[i].tolist(),2)\n        frame = cv.circle(frame,(a,b),5,color[i].tolist(),-1)\n    img = cv.add(frame,mask)\n\n    cv.imshow('frame',img)\n    if cv.waitKey(33) &amp; 0xFF==ord('d'):\n        break \n\n    # \u66f4\u65b0\n    old_gray = frame_gray.copy()\n    p0 = good_new.reshape(-1,1,2)\n\ncap.release()    \ncv.destroyAllWindows()\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_16","title":"\u591a\u76ee\u6807\u8ffd\u8e2a","text":"<pre><code># \u591a\u76ee\u6807\u8ffd\u8e2a\u5668\n\nimport cv2 as cv\nimport numpy as np\n\ncap = cv.VideoCapture(\n    \"videos/Road traffic video for object recognition [wqctLW0Hb_0].mp4\"\n)\n\n# \u5b9e\u4f8b\u5316opencv \u4e2d\u7684\u591a\u76ee\u6807\u8ffd\u8e2a\u5668\n# trackers = cv.MultiTracker_create() opencv4 \u6ca1\u6709\u8be5\u65b9\u6cd5\n# \u76f8\u5173\u5185\u5bb9\u90fd\u8981\u52a0\u4e0a legacy.\n# \u53c2\u89c1 https://github.com/opencv/opencv-python/issues/441\ntrackers = cv.legacy.MultiTracker_create()\n\n# \u5c06opencv\u5df2\u7ecf\u5b9e\u73b0\u4e86\u7684\u8ffd\u8e2a\u7b97\u6cd5\u5199\u5165\u5b57\u5178\u65b9\u4fbf\u8c03\u7528\nOPENCV_OBJECT_TRACKERS = {\n    \"csrt\": cv.legacy.TrackerCSRT_create,\n    \"kcf\": cv.legacy.TrackerKCF_create,\n    \"boosting\": cv.legacy.TrackerBoosting_create,\n    \"mil\": cv.legacy.TrackerMIL_create,\n    \"tld\": cv.legacy.TrackerTLD_create,\n    \"medianflow\": cv.legacy.TrackerMedianFlow_create,\n    \"mosse\": cv.legacy.TrackerMOSSE_create,\n}\n\nwhile True:\n    # \u53d6\u5f53\u524d\u5e27\n    ret, frame = cap.read()\n\n    if not ret:\n        break\n\n    # print(frame.shape)\n    # resize\n    h, w, c = frame.shape\n    width = 1200\n    r = width / float(w)\n    dim = (width, int(h * r))\n    frame = cv.resize(frame, dim, interpolation=cv.INTER_AREA)\n\n    # \u8ffd\u8e2a\u7ed3\u679c\n    success, boxes = trackers.update(frame)\n\n    # \u7ed8\u5236\u77e9\u5f62\n    for box in boxes:\n        x, y, w, h = [int(v) for v in box]\n        cv.rectangle(frame, (x, y), (x + w, y + h), (0, 255, 0), 2)\n\n    # \u663e\u793a\n    cv.imshow(\"Frame\", frame)\n\n    key = cv.waitKey(100) &amp; 0xFF\n\n    if key == ord('s'):\n        # \u9009\u62e9\u533a\u57df\n        box = cv.selectROI(\"Frame\", frame, fromCenter=False, showCrosshair=True)\n\n        # \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8ffd\u8e2a\u5668\n        tracker = OPENCV_OBJECT_TRACKERS['kcf']()\n        trackers.add(tracker, frame, box)\n    elif key == ord('q'):\n        break\n\n\ncap.release()\ncv.destroyAllWindows()\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#_17","title":"\u5176\u4ed6","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/opencv/#getstructelement","title":"getStructElement()","text":"<p><code>cv2.getStructuringElement()</code> \u7528\u4e8e\u521b\u5efa\u56fe\u50cf\u5904\u7406\u4e2d\u5e38\u7528\u7684\u7ed3\u6784\u5143\u7d20</p> <p><code>cv2.getStructuringElement(shape, ksize, anchor)</code> \u51fd\u6570\u63a5\u53d7\u4ee5\u4e0b\u53c2\u6570\uff1a</p> <ul> <li><code>shape</code>\uff1a\u7ed3\u6784\u5143\u7d20\u7684\u5f62\u72b6\uff0c\u53ef\u4ee5\u662f\u00a0<code>cv2.MORPH_RECT</code>\uff08\u77e9\u5f62\uff09\u3001<code>cv2.MORPH_ELLIPSE</code>\uff08\u692d\u5706\u5f62\uff09\u6216\u00a0<code>cv2.MORPH_CROSS</code>\uff08\u5341\u5b57\u5f62\uff09\u3002</li> <li><code>ksize</code>\uff1a\u7ed3\u6784\u5143\u7d20\u7684\u5927\u5c0f\uff0c\u6307\u5b9a\u4e3a\u4e00\u4e2a\u4e8c\u5143\u7ec4\u00a0<code>(width, height)</code>\u00a0\u6216\u6574\u6570\u3002\u5982\u679c\u662f\u4e8c\u5143\u7ec4\uff0c\u5219\u5206\u522b\u8868\u793a\u7ed3\u6784\u5143\u7d20\u7684\u5bbd\u5ea6\u548c\u9ad8\u5ea6\uff1b\u5982\u679c\u662f\u6574\u6570\uff0c\u5219\u8868\u793a\u7ed3\u6784\u5143\u7d20\u662f\u4e00\u4e2a\u6b63\u65b9\u5f62\uff0c\u8fb9\u957f\u4e3a\u8be5\u6574\u6570\u3002</li> <li><code>anchor</code>\uff08\u53ef\u9009\uff09\uff1a\u951a\u70b9\u7684\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u4e3a\u7ed3\u6784\u5143\u7d20\u7684\u4e2d\u5fc3\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u00a0<code>(x, y)</code>\u00a0\u7684\u4e8c\u5143\u7ec4\u6765\u6539\u53d8\u951a\u70b9\u7684\u4f4d\u7f6e\u3002</li> </ul> <pre><code>kernel = cv2.getStructuringElement(cv2.MORPH_RECT, (5, 5))\n</code></pre> <p>tips: \u5728\u4f7f\u7528matplotlib\u6253\u5f00opencv\u7684\u56fe\u50cf\u65f6\uff0c\u8981\u5c06BGR\u8f6c\u6362\u4e3aRGB\uff08\u73b0\u5728\u7684\u4f3c\u4e4e\u4f1a\u81ea\u52a8\u8f6c\u6362\uff09</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/","title":"pandas \u57fa\u7840","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#pandas-python","title":"pandas #python #\u57fa\u7840","text":"<p>\u76f8\u5173\u5185\u5bb9\uff1amatplotlib, numpy, sklearn \u5165\u95e8, \u673a\u5668\u5b66\u4e60</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#pandas_1","title":"pandas \u57fa\u672c\u6570\u636e\u7c7b\u578b","text":"<ul> <li>Series\uff1a\u4e00\u7ef4\u6570\u7ec4\uff0c\u7c7b\u4f3c\u4e8e\u5e26\u6709\u6807\u7b7e\u7684\u4e00\u7ef4\u6570\u7ec4\uff0c\u53ef\u4ee5\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e\u3002</li> <li>DataFrame\uff1a\u4e8c\u7ef4\u8868\u683c\uff0c\u7c7b\u4f3c\u4e8eExcel\u8868\u683c\u6216SQL\u8868\uff0c\u662f\u6700\u5e38\u7528\u7684pandas\u6570\u636e\u7ed3\u6784\uff0c\u53ef\u4ee5\u5b58\u50a8\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u3002</li> <li>Index\uff1a\u7d22\u5f15\uff0c\u7c7b\u4f3c\u4e8e\u6570\u636e\u5e93\u8868\u4e2d\u7684\u4e3b\u952e\uff0c\u7528\u4e8e\u6807\u8bc6\u6570\u636e\u3002</li> <li>DateTime\uff1a\u65e5\u671f\u548c\u65f6\u95f4\u7c7b\u578b\uff0c\u7528\u4e8e\u5904\u7406\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u3002</li> <li>Timedelta\uff1a\u65f6\u95f4\u5dee\u7c7b\u578b\uff0c\u7528\u4e8e\u8ba1\u7b97\u65f6\u95f4\u95f4\u9694\u3002</li> <li>Categorical\uff1a\u5206\u7c7b\u7c7b\u578b\uff0c\u7528\u4e8e\u5b58\u50a8\u5206\u7c7b\u6570\u636e\uff0c\u53ef\u4ee5\u63d0\u9ad8\u8ba1\u7b97\u6548\u7387\u3002</li> <li>Sparse\uff1a\u7a00\u758f\u7c7b\u578b\uff0c\u7528\u4e8e\u5b58\u50a8\u7a00\u758f\u6570\u636e\uff0c\u53ef\u4ee5\u8282\u7701\u5185\u5b58\u7a7a\u95f4\u3002</li> </ul>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#series","title":"Series","text":"<pre><code>import pandas as pd\n\ndata = [1, 2, 3, 4, 5]\ns = pd.Series(data = None, index = None, dtype = None)\ns = pd.Series(data\uff0cindex= [2,3,4,5,1])\n</code></pre> <pre><code># \u8fd0\u884c\u7ed3\u679c\n2    1\n3    2\n4    3\n5    4\n1    5\ndtype: int64\n</code></pre> <ul> <li>\u901a\u8fc7\u5b57\u5178\u6570\u636e\u8fdb\u884c\u521b\u5efa</li> </ul> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2a\u5b57\u5178\ndata = {'a': 10, 'b': 20, 'c': 30}\n\n# \u901a\u8fc7\u5b57\u5178\u521b\u5efaSeries\nseries = pd.Series(data)\n\nprint(series)\n</code></pre> <p>\u8f93\u51fa\uff1a</p> <pre><code>a    10\nb    20\nc    30\ndtype: int64\n</code></pre> <p>Series\u5bf9\u8c61\u5177\u6709\u4ee5\u4e0b\u5c5e\u6027\uff1a</p> <ol> <li><code>index</code>\uff1aSeries\u5bf9\u8c61\u7684\u7d22\u5f15\uff0c\u7528\u4e8e\u6807\u8bc6\u6bcf\u4e2a\u6570\u636e\u70b9\u3002</li> <li><code>values</code>\uff1aSeries\u5bf9\u8c61\u7684\u5b9e\u9645\u6570\u636e\u503c\uff0c\u4ee5NumPy\u6570\u7ec4\u7684\u5f62\u5f0f\u5b58\u50a8\u3002</li> <li><code>name</code>\uff1aSeries\u5bf9\u8c61\u7684\u540d\u79f0\u3002</li> <li><code>dtype</code>\uff1aSeries\u5bf9\u8c61\u4e2d\u6570\u636e\u7684\u6570\u636e\u7c7b\u578b\u3002</li> <li><code>size</code>\uff1aSeries\u5bf9\u8c61\u4e2d\u6570\u636e\u7684\u6570\u91cf\u3002</li> <li><code>shape</code>\uff1aSeries\u5bf9\u8c61\u7684\u7ef4\u5ea6\uff0c\u4ee5\u5143\u7ec4\u5f62\u5f0f\u8868\u793a\u3002</li> <li><code>ndim</code>\uff1aSeries\u5bf9\u8c61\u7684\u7ef4\u6570\uff0c\u5373\u7ef4\u5ea6\u7684\u6570\u91cf\u3002</li> <li><code>empty</code>\uff1a\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u8868\u793aSeries\u5bf9\u8c61\u662f\u5426\u4e3a\u7a7a\u3002</li> <li><code>axes</code>\uff1aSeries\u5bf9\u8c61\u7684\u8f74\u6807\u7b7e\u5217\u8868\u3002</li> <li><code>iat</code>\uff1a\u7528\u4e8e\u83b7\u53d6\u7279\u5b9a\u4f4d\u7f6e\u7684\u6570\u636e\u7684\u5feb\u901f\u8bbf\u95ee\u5668\u3002</li> <li><code>iloc</code>\uff1a\u7528\u4e8e\u6309\u4f4d\u7f6e\u9009\u62e9\u6570\u636e\u7684\u5feb\u901f\u8bbf\u95ee\u5668\u3002</li> <li><code>loc</code>\uff1a\u7528\u4e8e\u6309\u6807\u7b7e\u9009\u62e9\u6570\u636e\u7684\u5feb\u901f\u8bbf\u95ee\u5668\u3002</li> </ol>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#dataframe","title":"DataFrame","text":"<pre><code>import pandas as pd\n\ndf = pd.DataFrame(data=None, index=None, colums=None,dtype=None)\n</code></pre> <p>axis\uff08\u8f74\uff09\u662f\u6307\u6570\u636e\u7684\u65b9\u5411\u3002pandas\u7684axis\u53c2\u6570\u6709\u4e24\u4e2a\u9009\u9879\uff1a - axis=0\uff1a\u8868\u793a\u6cbf\u7740\u884c\u7684\u65b9\u5411\u8fdb\u884c\u64cd\u4f5c\uff0c\u5373\u5bf9\u6bcf\u4e00\u5217\u8fdb\u884c\u64cd\u4f5c\u3002 - axis=1\uff1a\u8868\u793a\u6cbf\u7740\u5217\u7684\u65b9\u5411\u8fdb\u884c\u64cd\u4f5c\uff0c\u5373\u5bf9\u6bcf\u4e00\u884c\u8fdb\u884c\u64cd\u4f5c\u3002</p> <ol> <li>\u4ece\u5217\u8868\u6216\u6570\u7ec4\u521b\u5efaDataFrame\uff1a</li> </ol> <pre><code>import pandas as pd\n\ndata = [['Alice', 25], ['Bob', 30], ['Charlie', 35]]\ndf = pd.DataFrame(data, columns=['Name', 'Age'])\ndf\n</code></pre> <p>\u7ed3\u679c\uff1a <pre><code>    Name    Age\n0   Alice   25\n1   Bob     30\n2   Charlie 35\n</code></pre></p> <ol> <li>\u4ece\u5b57\u5178\u521b\u5efaDataFrame\uff1a</li> </ol> <pre><code>import pandas as pd\n\ndata = {'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35]}\ndf = pd.DataFrame(data)\n</code></pre> <ol> <li>\u4eceCSV\u6587\u4ef6\u521b\u5efaDataFrame\uff1a</li> </ol> <pre><code>import pandas as pd\n\ndf = pd.read_csv('data.csv')\n</code></pre> <ol> <li>\u4eceSQL\u6570\u636e\u5e93\u521b\u5efaDataFrame\uff1a</li> </ol> <pre><code>import pandas as pd\nimport sqlite3\n\nconn = sqlite3.connect('database.db')\nquery = 'SELECT * FROM table_name'\ndf = pd.read_sql(query, conn)\n</code></pre> <p>DataFrame\u7684\u4e00\u4e9b\u5e38\u7528\u5c5e\u6027\u5305\u62ec\uff1a</p> <ol> <li>shape\uff1a\u8fd4\u56deDataFrame\u7684\u5f62\u72b6\uff0c\u5373\u884c\u6570\u548c\u5217\u6570\u3002</li> <li>columns\uff1a\u8fd4\u56deDataFrame\u7684\u5217\u6807\u7b7e\u3002</li> <li>index\uff1a\u8fd4\u56deDataFrame\u7684\u884c\u6807\u7b7e\u3002</li> <li>dtypes\uff1a\u8fd4\u56deDataFrame\u5404\u5217\u7684\u6570\u636e\u7c7b\u578b\u3002</li> <li>values\uff1a\u8fd4\u56deDataFrame\u7684\u6570\u636e\u5185\u5bb9\uff0c\u4ee5\u4e8c\u7ef4\u6570\u7ec4\u5f62\u5f0f\u8868\u793a\u3002</li> <li>size\uff1a\u8fd4\u56deDataFrame\u7684\u5143\u7d20\u4e2a\u6570\uff0c\u5373\u884c\u6570\u4e58\u4ee5\u5217\u6570\u3002</li> <li>empty\uff1a\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u8868\u793aDataFrame\u662f\u5426\u4e3a\u7a7a\u3002</li> <li>T\uff1a\u8fd4\u56deDataFrame\u7684\u8f6c\u7f6e\uff0c\u5373\u884c\u5217\u4e92\u6362\u3002</li> <li>axes\uff1a\u8fd4\u56deDataFrame\u7684\u884c\u3001\u5217\u8f74\u6807\u7b7e\u3002</li> <li>ndim\uff1a\u8fd4\u56deDataFrame\u7684\u7ef4\u5ea6\u6570\uff0c\u53732\u3002</li> <li>nbytes\uff1a\u8fd4\u56deDataFrame\u7684\u5185\u5b58\u5927\u5c0f\uff08\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\uff09\u3002</li> <li>itemsize\uff1a\u8fd4\u56deDataFrame\u6bcf\u4e2a\u5143\u7d20\u7684\u5b57\u8282\u5927\u5c0f\u3002</li> <li>memory_usage()\uff1a\u8fd4\u56deDataFrame\u5404\u5217\u7684\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\u3002</li> <li>describe()\uff1a\u8fd4\u56deDataFrame\u5404\u5217\u7684\u7edf\u8ba1\u63cf\u8ff0\u4fe1\u606f\uff08\u5982\u5747\u503c\u3001\u6807\u51c6\u5dee\u7b49\uff09\u3002</li> <li>info()\uff1a\u6253\u5370\u51faDataFrame\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u5305\u62ec\u5217\u6570\u3001\u884c\u6570\u3001\u5404\u5217\u7684\u975e\u7a7a\u503c\u6570\u91cf\u548c\u6570\u636e\u7c7b\u578b\u7b49\u3002</li> </ol> <pre><code>df.head(n) # \u83b7\u53d6df\u524dn\u884c\uff0c\u9ed8\u8ba45\u884c\ndf.tail(n) # \u83b7\u53d6df\u540en\u884c\uff0c\u9ed8\u8ba45\u884c\n</code></pre> <p>\u4fee\u6539\u884c\u5217\u7d22\u5f15\u503c</p> <pre><code>new_index = [5,4,3,2,1]\n\n# \u5fc5\u987b\u6574\u4f53\u4fee\u6539\ndf.index = new_index\n\n# \u9519\u8bef\u65b9\u5f0f\ndf.index[2] = 12\n</code></pre> <p>\u91cd\u8bbe\u7d22\u5f15</p> <p><code>reset_index()</code>\u65b9\u6cd5\u4f1a\u5c06\u65e7\u7d22\u5f15\u6dfb\u52a0\u4e3a\u4e00\u4e2a\u65b0\u7684\u5217\uff0c\u7136\u540e\u521b\u5efa\u4e00\u4e2a\u4ece0\u5f00\u59cb\u7684\u65b0\u7d22\u5f15\u3002</p> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2a\u793a\u4f8bDataFrame\ndata = {'Name': ['John', 'Emily', 'Michael'],\n        'Age': [25, 30, 35],\n        'City': ['New York', 'London', 'Paris']}\n\ndf = pd.DataFrame(data)\n\n# \u8f93\u51fa\u539f\u59cbDataFrame\nprint(df)\n\n# \u91cd\u8bbe\u7d22\u5f15\ndf = df.reset_index() # \u9ed8\u8ba4drop\u4e3aFalse\uff0c\u4e0d\u5220\u9664\u539f\u6765\u7684\u7d22\u5f15\n\n# \u8f93\u51fa\u91cd\u8bbe\u7d22\u5f15\u540e\u7684DataFrame\nprint(df)\n</code></pre> <p>\u8f93\u51fa\uff1a <pre><code>\u539f\u59cbDataFrame:\n      Name  Age      City\n\u4e00     John   25  New York\n\u4e8c    Emily   30    London\n\u4e09  Michael   35     Paris\n\u91cd\u8bbe\u7d22\u5f15\u540e\u7684DataFrame:\n  index     Name  Age      City\n0     \u4e00     John   25  New York\n1     \u4e8c    Emily   30    London\n2     \u4e09  Michael   35     Paris\n\ndrop = True:\n      Name  Age      City\n0     John   25  New York\n1    Emily   30    London\n2  Michael   35     Paris\n</code></pre></p> <p>\u8bbe\u7f6e\u7d22\u5f15</p> <p>set_index\u65b9\u6cd5\u6709\u51e0\u79cd\u5e38\u89c1\u7684\u7528\u6cd5\uff1a 1. \u4f20\u5165\u4e00\u4e2a\u5217\u540d\u6216\u5217\u540d\u7684\u5217\u8868\u4f5c\u4e3a\u53c2\u6570\uff0c\u5c06\u8fd9\u4e9b\u5217\u4f5c\u4e3a\u7d22\u5f15\u5217\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684DataFrame\uff0c\u539fDataFrame\u7684\u7d22\u5f15\u5c06\u88ab\u66ff\u6362\u6389\u3002\u4f8b\u5982\uff1a</p> <pre><code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\ndf.set_index('A', inplace=True)\n</code></pre> <pre><code># \u8f93\u51fa\n    B\nA   \n1   4\n2   5\n3   6\n</code></pre> <ol> <li>\u4f20\u5165\u4e00\u4e2aSeries\u4f5c\u4e3a\u53c2\u6570\uff0c\u5c06\u8be5Series\u4f5c\u4e3a\u7d22\u5f15\u5217\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684DataFrame\uff0c\u539fDataFrame\u7684\u7d22\u5f15\u5c06\u88ab\u66ff\u6362\u6389\u3002\u4f8b\u5982\uff1a</li> </ol> <pre><code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\ns = pd.Series(['a', 'b', 'c'])\ndf.set_index(s, inplace=True)\n</code></pre> <ol> <li>\u4f20\u5165\u4e00\u4e2a\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\uff0c\u8be5\u51fd\u6570\u4f1a\u88ab\u5e94\u7528\u4e8eDataFrame\u7684\u6bcf\u4e00\u884c\u6216\u6bcf\u4e00\u5217\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684DataFrame\uff0c\u539fDataFrame\u7684\u7d22\u5f15\u5c06\u88ab\u66ff\u6362\u6389\u3002\u4f8b\u5982\uff1a</li> </ol> <pre><code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\ndf.set_index(lambda x: x['A'] + x['B'], inplace=True)\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#multiindex","title":"MultiIndex","text":"<p>MultiIndex\u662f\u4e00\u79cd\u591a\u5c42\u6b21\u7d22\u5f15\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u4f7f\u5f97\u5728\u4e00\u4e2a\u8f74\u4e0a\u53ef\u4ee5\u6709\u591a\u4e2a\u7d22\u5f15\u7ea7\u522b\u3002MultiIndex\u53ef\u4ee5\u7528\u4e8e\u5904\u7406\u9ad8\u7ef4\u6570\u636e\uff0c\u5e76\u63d0\u4f9b\u4e86\u4e00\u4e9b\u4fbf\u6377\u7684\u65b9\u6cd5\u6765\u5bf9\u6570\u636e\u8fdb\u884c\u64cd\u4f5c\u3002</p> <p>\u5728Pandas\u4e2d\u521b\u5efaMultiIndex\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\uff0c\u5305\u62ec\u4ecePython\u7684\u5217\u8868\u3001\u6570\u7ec4\u6216\u5143\u7ec4\u521b\u5efa\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u4f7f\u7528\u5143\u7ec4\u521b\u5efaMultiIndex\u7684\u7b80\u5355\u793a\u4f8b\uff1a</p> <pre><code>import pandas as pd\n\nindex = pd.MultiIndex.from_tuples([('A', 1), ('A', 2), ('B', 1), ('B', 2)])\ndata = pd.DataFrame({'values': [1, 2, 3, 4]}, index=index)\n\nprint(data)\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>     values\nA 1       1\n  2       2\nB 1       3\n  2       4\n</code></pre> <p>\u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u5143\u7ec4\u521b\u5efa\u4e86\u4e00\u4e2a\u5305\u542b\u4e24\u4e2a\u7ea7\u522b\u7684MultiIndex\u3002\u7b2c\u4e00\u4e2a\u7ea7\u522b\u662f\u5b57\u6bcd'A'\u548c'B'\uff0c\u7b2c\u4e8c\u4e2a\u7ea7\u522b\u662f\u6570\u5b571\u548c2\u3002\u7136\u540e\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u5e26\u6709values\u5217\u7684DataFrame\uff0c\u5e76\u4f7f\u7528\u521b\u5efa\u7684MultiIndex\u4f5c\u4e3a\u7d22\u5f15\u3002</p> <p>\u4f7f\u7528MultiIndex\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7d22\u5f15\u7684\u591a\u4e2a\u7ea7\u522b\u6765\u9009\u62e9\u6570\u636e\u3002\u4f8b\u5982\uff0c\u8981\u9009\u62e9A\u7ea7\u522b\u4e3a1\u7684\u6240\u6709\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\uff1a</p> <pre><code>print(data.loc['A', 1])\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>values    1\nName: (A, 1), dtype: int64\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_1","title":"\u7d22\u5f15\u64cd\u4f5c","text":"<p>\u5728pandas\u4e2d\uff0c\u7d22\u5f15\u64cd\u4f5c\u975e\u5e38\u91cd\u8981\uff0c\u5b83\u7528\u4e8e\u9009\u62e9\u3001\u8fc7\u6ee4\u548c\u4fee\u6539\u6570\u636e\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u7528\u7684\u7d22\u5f15\u64cd\u4f5c\uff1a</p> <p>\u76f4\u63a5\u7d22\u5f15\uff1a\u53ea\u80fd\u5148\u5217\u540e\u884c<code>df[column_name][row_name]</code></p> <ol> <li> <p>\u4f7f\u7528\u6807\u7b7e\u7d22\u5f15\uff1a\u53ef\u4ee5\u4f7f\u7528 <code>.loc</code> \u5c5e\u6027\u6765\u901a\u8fc7\u884c\u6807\u7b7e\u548c\u5217\u6807\u7b7e\u8fdb\u884c\u7d22\u5f15\u64cd\u4f5c\u3002\u4f8b\u5982\uff1a<code>df.loc[row_label, column_label]</code>\u3002</p> </li> <li> <p>\u4f7f\u7528\u4f4d\u7f6e\u7d22\u5f15\uff1a\u53ef\u4ee5\u4f7f\u7528 <code>.iloc</code> \u5c5e\u6027\u6765\u901a\u8fc7\u884c\u7d22\u5f15\u548c\u5217\u7d22\u5f15\u8fdb\u884c\u7d22\u5f15\u64cd\u4f5c\u3002\u4f8b\u5982\uff1a<code>df.iloc[row_index, column_index]</code>\u3002</p> </li> <li> <p>\u4f7f\u7528\u5e03\u5c14\u7d22\u5f15\uff1a\u53ef\u4ee5\u4f7f\u7528\u5e03\u5c14\u6761\u4ef6\u6765\u9009\u62e9\u6ee1\u8db3\u6761\u4ef6\u7684\u884c\u6216\u5217\u3002\u4f8b\u5982\uff1a<code>df[condition]</code>\uff0c\u5176\u4e2d <code>condition</code> \u662f\u4e00\u4e2a\u5e03\u5c14\u6761\u4ef6\u3002</p> </li> <li> <p>\u4f7f\u7528\u5207\u7247\u7d22\u5f15\uff1a\u53ef\u4ee5\u4f7f\u7528\u5207\u7247\u64cd\u4f5c\u6765\u9009\u62e9\u4e00\u5b9a\u8303\u56f4\u5185\u7684\u884c\u6216\u5217\u3002\u4f8b\u5982\uff1a<code>df[start:end]</code>\u3002</p> </li> <li> <p>\u4f7f\u7528\u5217\u7d22\u5f15\uff1a\u53ef\u4ee5\u4f7f\u7528\u5217\u540d\u6765\u9009\u62e9\u6307\u5b9a\u7684\u5217\u3002\u4f8b\u5982\uff1a<code>df[column_name]</code>\u3002</p> </li> <li> <p>\u4f7f\u7528\u884c\u7d22\u5f15\uff1a\u53ef\u4ee5\u4f7f\u7528 <code>.loc</code> \u5c5e\u6027\u6765\u9009\u62e9\u6307\u5b9a\u7684\u884c\u3002\u4f8b\u5982\uff1a<code>df.loc[row_label]</code></p> </li> <li> <p>\u4f7f\u7528\u591a\u91cd\u7d22\u5f15\uff1a\u53ef\u4ee5\u4f7f\u7528\u591a\u4e2a\u6807\u7b7e\u6216\u4f4d\u7f6e\u7d22\u5f15\u6765\u9009\u62e9\u591a\u5c42\u6b21\u7684\u6570\u636e\u3002\u4f8b\u5982\uff1a<code>df.loc[(label1, label2), (column1, column2)]</code>\u3002</p> </li> </ol>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_2","title":"\u8d4b\u503c\u64cd\u4f5c","text":"<p>\u5728pandas\u4e2d\uff0c\u6709\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u8fdb\u884c\u8d4b\u503c\u64cd\u4f5c\u3002\u4ee5\u4e0b\u662f\u5e38\u89c1\u7684\u51e0\u79cd\u65b9\u5f0f\uff1a</p> <ol> <li>\u4f7f\u7528\u8d4b\u503c\u8fd0\u7b97\u7b26\uff08=\uff09\uff1a\u53ef\u4ee5\u4f7f\u7528\u8d4b\u503c\u8fd0\u7b97\u7b26\u5c06\u4e00\u4e2a\u503c\u8d4b\u7ed9\u4e00\u4e2a\u53d8\u91cf\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u5c06\u4e00\u4e2a\u6807\u91cf\u503c\u8d4b\u7ed9\u4e00\u4e2aDataFrame\u4e2d\u7684\u67d0\u4e00\u5217\uff0c\u6216\u8005\u5c06\u4e00\u4e2aSeries\u8d4b\u7ed9\u4e00\u4e2a\u65b0\u7684\u5217\u3002</li> </ol> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2a\u7a7a\u7684DataFrame\ndf = pd.DataFrame()\n\n# \u6dfb\u52a0\u4e00\u5217\uff0c\u5e76\u8d4b\u503c\u4e3a\u6807\u91cf\u503c\ndf['column_name'] = 10\n\n# \u6dfb\u52a0\u4e00\u5217\uff0c\u5e76\u8d4b\u503c\u4e3aSeries\nseries = pd.Series([1, 2, 3])\ndf['new_column_name'] = series\n</code></pre> <ol> <li>\u4f7f\u7528<code>.loc</code>\u548c<code>.iloc</code>\u7d22\u5f15\u5668\uff1a\u53ef\u4ee5\u4f7f\u7528<code>.loc</code>\u548c<code>.iloc</code>\u6765\u9009\u62e9\u6307\u5b9a\u7684\u884c\u548c\u5217\uff0c\u5e76\u5c06\u5176\u8d4b\u7ed9\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\u3002</li> </ol> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2aDataFrame\ndf = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\n\n# \u4f7f\u7528.loc\u9009\u62e9\u6307\u5b9a\u7684\u884c\u548c\u5217\uff0c\u5e76\u8d4b\u7ed9\u65b0\u7684\u53d8\u91cf\nnew_df = df.loc[:, 'A']\n</code></pre> <ol> <li>\u4f7f\u7528<code>.at</code>\u548c<code>.iat</code>\u7d22\u5f15\u5668\uff1a\u53ef\u4ee5\u4f7f\u7528<code>.at</code>\u548c<code>.iat</code>\u6765\u9009\u62e9\u6307\u5b9a\u4f4d\u7f6e\u7684\u503c\uff0c\u5e76\u5c06\u5176\u8d4b\u7ed9\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\u3002</li> </ol> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2aDataFrame\ndf = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\n\n# \u4f7f\u7528.at\u9009\u62e9\u6307\u5b9a\u4f4d\u7f6e\u7684\u503c\uff0c\u5e76\u8d4b\u7ed9\u65b0\u7684\u53d8\u91cf\nnew_value = df.at[0, 'A']\n</code></pre> <ol> <li>\u4f7f\u7528<code>[]</code>\u64cd\u4f5c\u7b26\uff1a\u53ef\u4ee5\u4f7f\u7528<code>[]</code>\u64cd\u4f5c\u7b26\u6765\u9009\u62e9\u6307\u5b9a\u7684\u884c\u548c\u5217\uff0c\u5e76\u5c06\u5176\u8d4b\u7ed9\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\u3002</li> </ol> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2aDataFrame\ndf = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\n\n# \u4f7f\u7528[]\u9009\u62e9\u6307\u5b9a\u7684\u884c\u548c\u5217\uff0c\u5e76\u8d4b\u7ed9\u65b0\u7684\u53d8\u91cf\nnew_df = df[['A', 'B']]\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_3","title":"\u6392\u5e8f\u64cd\u4f5c","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#dataframe_1","title":"DataFrame\u6392\u5e8f","text":"<p>\u5728Pandas\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528<code>sort_values()</code>\u51fd\u6570\u5bf9\u6570\u636e\u8fdb\u884c\u6392\u5e8f\u64cd\u4f5c\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u6392\u5e8f\u64cd\u4f5c\u793a\u4f8b\uff1a</p> <p>\u6309\u7167\u67d0\u4e00\u5217\u5347\u5e8f\u6392\u5e8f\uff1a</p> <pre><code>df.sort_values('column_name')\n</code></pre> <p>\u6309\u7167\u67d0\u4e00\u5217\u964d\u5e8f\u6392\u5e8f\uff1a</p> <pre><code>df.sort_values('column_name', ascending=False)\n</code></pre> <p>\u6309\u7167\u591a\u5217\u8fdb\u884c\u6392\u5e8f\uff1a</p> <pre><code>df.sort_values(['column_name1', 'column_name2'])\n</code></pre> <p>\u5982\u679c\u9700\u8981\u5bf9DataFrame\u7684\u7d22\u5f15\u8fdb\u884c\u6392\u5e8f\uff0c\u53ef\u4ee5\u4f7f\u7528<code>sort_index()</code>\u51fd\u6570\uff1a</p> <pre><code>df.sort_index()\n</code></pre> <p>\u53e6\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528<code>nlargest()</code>\u548c<code>nsmallest()</code>\u51fd\u6570\u83b7\u53d6\u6700\u5927\u6216\u6700\u5c0f\u7684\u51e0\u4e2a\u503c\uff1a</p> <pre><code>df.nlargest(n, 'column_name')  # \u83b7\u53d6\u67d0\u4e00\u5217\u4e2d\u6700\u5927\u7684n\u4e2a\u503c\ndf.nsmallest(n, 'column_name')  # \u83b7\u53d6\u67d0\u4e00\u5217\u4e2d\u6700\u5c0f\u7684n\u4e2a\u503c\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#series_1","title":"series\u6392\u5e8f","text":"<p>pandas\u7684Series\u5bf9\u8c61\u53ef\u4ee5\u4f7f\u7528sort_values()\u65b9\u6cd5\u8fdb\u884c\u6392\u5e8f\u64cd\u4f5c\u3002\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684Series\u5bf9\u8c61\uff0c\u5176\u4e2d\u7684\u5143\u7d20\u6309\u7167\u6307\u5b9a\u7684\u6392\u5e8f\u987a\u5e8f\u6392\u5217\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u793a\u4f8b\uff1a</p> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2aSeries\u5bf9\u8c61\ndata = {'a': 5, 'b': 3, 'c': 8, 'd': 2}\nseries = pd.Series(data)\n\n# \u6309\u7167\u7d22\u5f15\u503c\u8fdb\u884c\u5347\u5e8f\u6392\u5e8f\nsorted_series = series.sort_values()\nprint(sorted_series)\n\n# \u6309\u7167\u503c\u8fdb\u884c\u964d\u5e8f\u6392\u5e8f\nsorted_series_desc = series.sort_values(ascending=False)\nprint(sorted_series_desc)\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>d    2\nb    3\na    5\nc    8\ndtype: int64\n\nc    8\na    5\nb    3\nd    2\ndtype: int64\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_4","title":"\u8fd0\u7b97","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_5","title":"\u57fa\u7840\u8fd0\u7b97","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_6","title":"\u7b97\u6570\u8fd0\u7b97","text":"<p>\u4e0b\u9762\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u7b97\u6570\u8fd0\u7b97\u64cd\u4f5c\uff1a</p> <ol> <li> <p>\u52a0\u6cd5\uff1a\u4f7f\u7528 \"+\" \u64cd\u4f5c\u7b26\u8fdb\u884c\u4e24\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u52a0\u6cd5\u8fd0\u7b97\u3002\u793a\u4f8b\uff1adf1 + df2</p> </li> <li> <p>\u51cf\u6cd5\uff1a\u4f7f\u7528 \"-\" \u64cd\u4f5c\u7b26\u8fdb\u884c\u4e24\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u51cf\u6cd5\u8fd0\u7b97\u3002\u793a\u4f8b\uff1adf1 - df2</p> </li> <li> <p>\u4e58\u6cd5\uff1a\u4f7f\u7528 \"*\" \u64cd\u4f5c\u7b26\u8fdb\u884c\u4e24\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u4e58\u6cd5\u8fd0\u7b97\u3002\u793a\u4f8b\uff1adf1 * df2</p> </li> <li> <p>\u9664\u6cd5\uff1a\u4f7f\u7528 \"/\" \u64cd\u4f5c\u7b26\u8fdb\u884c\u4e24\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u9664\u6cd5\u8fd0\u7b97\u3002\u793a\u4f8b\uff1adf1 / df2</p> </li> <li> <p>\u5e42\u8fd0\u7b97\uff1a\u4f7f\u7528 \"**\" \u64cd\u4f5c\u7b26\u8fdb\u884c\u6570\u636e\u7ed3\u6784\u7684\u5e42\u8fd0\u7b97\u3002\u793a\u4f8b\uff1adf1 ** 2</p> </li> </ol> <p>\u6b64\u5916\uff0cPandas\u8fd8\u63d0\u4f9b\u4e86\u5176\u4ed6\u4e00\u4e9b\u5e38\u7528\u7684\u7b97\u6570\u8fd0\u7b97\u51fd\u6570\uff0c\u4f8b\u5982\uff1a</p> <ul> <li> <p>\u52a0\u6cd5\u8fd0\u7b97\uff1a\u4f7f\u7528 add() \u51fd\u6570\u8fdb\u884c\u4e24\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u52a0\u6cd5\u8fd0\u7b97\u3002\u793a\u4f8b\uff1adf1.add(df2)</p> </li> <li> <p>\u51cf\u6cd5\u8fd0\u7b97\uff1a\u4f7f\u7528 sub() \u51fd\u6570\u8fdb\u884c\u4e24\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u51cf\u6cd5\u8fd0\u7b97\u3002\u793a\u4f8b\uff1adf1.sub(df2)</p> </li> <li> <p>\u4e58\u6cd5\u8fd0\u7b97\uff1a\u4f7f\u7528 mul() \u51fd\u6570\u8fdb\u884c\u4e24\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u4e58\u6cd5\u8fd0\u7b97\u3002\u793a\u4f8b\uff1adf1.mul(df2)</p> </li> <li> <p>\u9664\u6cd5\u8fd0\u7b97\uff1a\u4f7f\u7528 div() \u51fd\u6570\u8fdb\u884c\u4e24\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u9664\u6cd5\u8fd0\u7b97\u3002\u793a\u4f8b\uff1adf1.div(df2)</p> </li> </ul> <p>\u8fd9\u4e9b\u51fd\u6570\u8fd8\u53ef\u4ee5\u63a5\u53d7\u5176\u4ed6\u53c2\u6570\uff0c\u4f8b\u5982 fill_value \u53c2\u6570\u53ef\u4ee5\u6307\u5b9a\u5728\u8fd0\u7b97\u8fc7\u7a0b\u4e2d\u7f3a\u5931\u503c\u7684\u586b\u5145\u65b9\u5f0f\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_7","title":"\u903b\u8f91\u8fd0\u7b97","text":"<ol> <li>\u903b\u8f91\u64cd\u4f5c\u7b26\uff1a</li> <li><code>&amp;</code>\uff1a\u4e0e\u64cd\u4f5c\u7b26\uff0c\u7528\u4e8e\u9010\u5143\u7d20\u7684\u903b\u8f91\u4e0e\u8fd0\u7b97\u3002</li> <li><code>|</code>\uff1a\u6216\u64cd\u4f5c\u7b26\uff0c\u7528\u4e8e\u9010\u5143\u7d20\u7684\u903b\u8f91\u6216\u8fd0\u7b97\u3002</li> <li> <p><code>~</code>\uff1a\u975e\u64cd\u4f5c\u7b26\uff0c\u7528\u4e8e\u9010\u5143\u7d20\u7684\u903b\u8f91\u975e\u8fd0\u7b97\u3002</p> </li> <li> <p>\u903b\u8f91\u51fd\u6570\uff1a</p> </li> <li><code>all()</code>\uff1a\u5224\u65ad\u662f\u5426\u6240\u6709\u5143\u7d20\u90fd\u4e3aTrue\u3002</li> <li><code>any()</code>\uff1a\u5224\u65ad\u662f\u5426\u81f3\u5c11\u6709\u4e00\u4e2a\u5143\u7d20\u4e3aTrue\u3002</li> <li><code>isin()</code>\uff1a\u5224\u65ad\u5143\u7d20\u662f\u5426\u5728\u7ed9\u5b9a\u7684\u503c\u5217\u8868\u4e2d\u3002</li> <li><code>where()</code>\uff1a\u6839\u636e\u6761\u4ef6\u8fdb\u884c\u5143\u7d20\u7684\u9009\u62e9\uff0c\u6761\u4ef6\u4e3aTrue\u7684\u5143\u7d20\u4fdd\u7559\uff0c\u5426\u5219\u7528\u6307\u5b9a\u503c\u66ff\u6362\u3002</li> <li> <p><code>query()</code>\uff1a\u4f7f\u7528\u8868\u8fbe\u5f0f\u67e5\u8be2\u6570\u636e\u3002</p> </li> <li> <p>\u5927\u5c0f\u6bd4\u8f83\uff1a</p> <ul> <li><code>&gt;</code></li> <li><code>&lt;</code></li> <li><code>&lt;=</code></li> <li><code>&gt;=</code></li> <li>==</li> </ul> </li> </ol> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u793a\u4f8b\uff1a</p> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u793a\u4f8bDataFrame\ndf = pd.DataFrame({'A': [True, True, False, False],\n                   'B': [True, False, True, False],\n                   'C': [False, True, False, True]})\n\n# \u903b\u8f91\u4e0e\u8fd0\u7b97\nresult_and = df['A'] &amp; df['B']\nprint(result_and)\n# \u8f93\u51fa\uff1a0     True\n#      1    False\n#      2    False\n#      3    False\n#      dtype: bool\n\n# \u903b\u8f91\u6216\u8fd0\u7b97\nresult_or = df['A'] | df['B']\nprint(result_or)\n# \u8f93\u51fa\uff1a0    True\n#      1    True\n#      2    True\n#      3    False\n#      dtype: bool\n\n# \u903b\u8f91\u975e\u8fd0\u7b97\nresult_not = ~df['A']\nprint(result_not)\n# \u8f93\u51fa\uff1a0    False\n#      1    False\n#      2     True\n#      3     True\n#      Name: A, dtype: bool\n\n# \u5224\u65ad\u662f\u5426\u6240\u6709\u5143\u7d20\u90fd\u4e3aTrue\nall_true = df.all()\nprint(all_true)\n# \u8f93\u51fa\uff1aA    False\n#      B    False\n#      C    False\n#      dtype: bool\n\n# \u5224\u65ad\u662f\u5426\u81f3\u5c11\u6709\u4e00\u4e2a\u5143\u7d20\u4e3aTrue\nany_true = df.any()\nprint(any_true)\n# \u8f93\u51fa\uff1aA     True\n#      B     True\n#      C     True\n#      dtype: bool\n\n# \u5224\u65ad\u5143\u7d20\u662f\u5426\u5728\u7ed9\u5b9a\u7684\u503c\u5217\u8868\u4e2d\nisin_result = df['A'].isin([True, False])\nprint(isin_result)\n# \u8f93\u51fa\uff1a0     True\n#      1     True\n#      2    False\n#      3    False\n#      Name: A, dtype: bool\n\n# \u6839\u636e\u6761\u4ef6\u8fdb\u884c\u5143\u7d20\u7684\u9009\u62e9\nwhere_result = df['A'].where(df['B'], False)\nprint(where_result)\n# \u8f93\u51fa\uff1a0     True\n#      1    False\n#      2    False\n#      3    False\n#      Name: A, dtype: bool\n\n# \u4f7f\u7528\u8868\u8fbe\u5f0f\u67e5\u8be2\u6570\u636e\nquery_result = df.query('A &amp; B')\nprint(query_result)\n# \u8f93\u51fa\uff1a      A      B      C\n#      0  True   True  False\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_8","title":"\u7edf\u8ba1","text":"<p>\u5e38\u7528\u7684\u7edf\u8ba1\u8fd0\u7b97\u548c\u51fd\u6570\u7684\u793a\u4f8b\uff1a</p> <ol> <li> <p>\u63cf\u8ff0\u7edf\u8ba1     \u5e38\u7528\u7684Pandas\u7edf\u8ba1\u51fd\u6570\uff1a</p> <ul> <li>describe()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u57fa\u672c\u7edf\u8ba1\u4fe1\u606f\uff0c\u5305\u62ec\u8ba1\u6570\u3001\u5747\u503c\u3001\u6807\u51c6\u5dee\u3001\u6700\u5c0f\u503c\u300125%\u5206\u4f4d\u6570\u3001\u4e2d\u4f4d\u6570\u300175%\u5206\u4f4d\u6570\u548c\u6700\u5927\u503c\u3002</li> <li>mean()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u5e73\u5747\u503c\u3002</li> <li>median()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u4e2d\u4f4d\u6570\u3002</li> <li>mode()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u4f17\u6570\u3002</li> <li>min()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u6700\u5c0f\u503c\u3002</li> <li>max()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u6700\u5927\u503c\u3002</li> <li>var()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u65b9\u5dee\u3002</li> <li>std()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u6807\u51c6\u5dee\u3002</li> <li>sum()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u548c\u3002</li> <li>count()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u975e\u7f3a\u5931\u503c\u7684\u6570\u91cf\u3002</li> <li>unique()\uff1a\u8fd4\u56de\u6570\u636e\u4e2d\u7684\u552f\u4e00\u503c\u3002</li> <li>nunique()\uff1a\u8fd4\u56de\u6570\u636e\u4e2d\u552f\u4e00\u503c\u7684\u6570\u91cf\u3002</li> <li>quantile()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u5206\u4f4d\u6570\u3002</li> <li>corr()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u76f8\u5173\u7cfb\u6570\u77e9\u9635\u3002</li> <li>cov()\uff1a\u8ba1\u7b97\u6570\u636e\u7684\u534f\u65b9\u5dee\u77e9\u9635\u3002</li> <li>idxmax()\uff1a\u6700\u5927\u503c\u7684\u4f4d\u7f6e</li> <li>idxmin()\uff1a\u6700\u5c0f\u503c\u7684\u4f4d\u7f6e</li> </ul> </li> <li> <p>\u5206\u7ec4\u7edf\u8ba1 Pandas\u7684groupby\u51fd\u6570\u53ef\u4ee5\u5b9e\u73b0\u6309\u7167\u67d0\u4e2a\u5217\u7684\u503c\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u5bf9\u6bcf\u4e2a\u5206\u7ec4\u8fdb\u884c\u7edf\u8ba1\u8ba1\u7b97\u3002\u5e38\u7528\u7684\u7edf\u8ba1\u65b9\u6cd5\u5305\u62eccount\uff08\u8ba1\u6570\uff09\u3001sum\uff08\u6c42\u548c\uff09\u3001mean\uff08\u5e73\u5747\u503c\uff09\u3001median\uff08\u4e2d\u4f4d\u6570\uff09\u7b49\u3002</p> </li> </ol> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2aDataFrame\u5bf9\u8c61\ndata = pd.DataFrame({\n    'Name': ['Alice', 'Bob', 'Charlie', 'David', 'Alice'],\n    'Age': [25, 30, 22, 35, 27],\n    'Salary': [5000, 6000, 4500, 7000, 5500]\n})\n\n# \u6309\u7167Name\u5217\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u8ba1\u7b97\u6bcf\u4e2a\u5206\u7ec4\u7684\u5e73\u5747\u5e74\u9f84\u548c\u5de5\u8d44\ngrouped_data = data.groupby('Name')\ngrouped_mean = grouped_data.mean()\nprint(grouped_mean)\n</code></pre> <ol> <li>\u76f4\u65b9\u56fe Pandas\u7684hist\u51fd\u6570\u53ef\u4ee5\u7ed8\u5236\u6570\u636e\u7684\u76f4\u65b9\u56fe\u3002\u76f4\u65b9\u56fe\u662f\u4e00\u79cd\u53ef\u89c6\u5316\u5de5\u5177\uff0c\u7528\u4e8e\u5c55\u793a\u6570\u636e\u7684\u5206\u5e03\u60c5\u51b5\u3002</li> </ol> <pre><code>import pandas as pd\nimport matplotlib.pyplot as plt\n\n# \u521b\u5efa\u4e00\u4e2aSeries\u5bf9\u8c61\ndata = pd.Series([1, 2, 3, 4, 5, 5, 6, 7, 8, 9, 10])\n\n# \u7ed8\u5236\u76f4\u65b9\u56fe\ndata.hist() # pandas \u5185\u90e8\u5c01\u88c5\u7684\u753b\u56fe\nplt.show()\n</code></pre> <ol> <li> <p>\u7d2f\u8ba1\u7edf\u8ba1\u51fd\u6570     \u5e38\u7528\u7684\u7d2f\u8ba1\u7edf\u8ba1\u51fd\u6570\uff1a</p> </li> <li> <p>cumsum()\uff1a\u8ba1\u7b97\u7d2f\u8ba1\u548c\u3002 <pre><code>df['column'].cumsum()\n</code></pre></p> </li> <li> <p>cumprod()\uff1a\u8ba1\u7b97\u7d2f\u8ba1\u4e58\u79ef\u3002 <pre><code>df['column'].cumprod()\n</code></pre></p> </li> <li> <p>cummax()\uff1a\u8ba1\u7b97\u7d2f\u8ba1\u6700\u5927\u503c\u3002 <pre><code>df['column'].cummax()\n</code></pre></p> </li> <li> <p>cummin()\uff1a\u8ba1\u7b97\u7d2f\u8ba1\u6700\u5c0f\u503c\u3002 <pre><code>df['column'].cummin()\n</code></pre></p> </li> <li> <p>cumcount()\uff1a\u8ba1\u7b97\u7d2f\u8ba1\u975e\u7a7a\u503c\u7684\u4e2a\u6570\u3002 <pre><code>df['column'].cumcount()\n</code></pre></p> </li> </ol> <p>\u8fd9\u4e9b\u51fd\u6570\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2a\u4e0e\u8f93\u5165\u6570\u636e\u76f8\u540c\u957f\u5ea6\u7684Series\uff0c\u5176\u4e2d\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u7d2f\u8ba1\u7edf\u8ba1\u7684\u7ed3\u679c\u3002</p> <p>[!info] \u7d2f\u8ba1\u7edf\u8ba1\u662f\u6307\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u4e0d\u65ad\u7d2f\u52a0\u67d0\u4e00\u6307\u6807\u6216\u6570\u636e\u7684\u8fc7\u7a0b\u3002\u5b83\u53ef\u4ee5\u7528\u6765\u8ddf\u8e2a\u548c\u5206\u6790\u6570\u636e\u7684\u603b\u91cf\u6216\u8d8b\u52bf\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5047\u8bbe\u67d0\u4e2a\u4f01\u4e1a\u6bcf\u6708\u9500\u552e\u989d\u5982\u4e0b\uff1a</p> <ul> <li>1\u6708\uff1a10000\u5143</li> <li>2\u6708\uff1a15000\u5143</li> <li>3\u6708\uff1a20000\u5143</li> </ul> <p>\u901a\u8fc7\u7d2f\u8ba1\u7edf\u8ba1\uff0c\u53ef\u4ee5\u8ba1\u7b97\u5f97\u5230\u6bcf\u6708\u9500\u552e\u989d\u7684\u7d2f\u8ba1\u503c\uff1a</p> <ul> <li>1\u6708\u7d2f\u8ba1\u9500\u552e\u989d\uff1a10000\u5143</li> <li>2\u6708\u7d2f\u8ba1\u9500\u552e\u989d\uff1a10000\u5143 + 15000\u5143 = 25000\u5143</li> <li>3\u6708\u7d2f\u8ba1\u9500\u552e\u989d\uff1a25000\u5143 + 20000\u5143 = 45000\u5143</li> </ul>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_9","title":"\u81ea\u5b9a\u4e49\u8fd0\u7b97","text":"<p>\u5982\u4f55\u4f7f\u7528\u81ea\u5b9a\u4e49\u51fd\u6570\u8fdb\u884c\u8fd0\u7b97\uff1a</p> <p>\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u6570\u636e\u7684DataFrame\uff1a <pre><code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\n</code></pre></p> <p>\u5b9a\u4e49\u4e00\u4e2a\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u7528\u4e8e\u5bf9\u6bcf\u4e2a\u5143\u7d20\u8fdb\u884c\u8fd0\u7b97\uff1a <pre><code>def custom_function(x):\n    return x * 2\n</code></pre></p> <p>\u4f7f\u7528<code>apply()</code>\u65b9\u6cd5\u5c06\u81ea\u5b9a\u4e49\u51fd\u6570\u5e94\u7528\u5230DataFrame\u7684\u6bcf\u4e2a\u5143\u7d20\u4e0a\uff1a <pre><code>df.apply(custom_function)\n</code></pre></p> <p>\u8fd9\u5c06\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684DataFrame\uff0c\u5176\u4e2d\u6bcf\u4e2a\u5143\u7d20\u90fd\u88ab\u81ea\u5b9a\u4e49\u51fd\u6570\u5904\u7406\u8fc7\u3002</p> <p>\u8fd8\u53ef\u4ee5\u5728<code>apply()</code>\u65b9\u6cd5\u4e2d\u6307\u5b9a\u8f74\u53c2\u6570\uff0c\u4ee5\u4fbf\u5bf9\u884c\u6216\u5217\u8fdb\u884c\u8fd0\u7b97\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8981\u5bf9\u6bcf\u4e00\u5217\u5e94\u7528\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528<code>axis=0</code>\u53c2\u6570\uff1a <pre><code>df.apply(custom_function, axis=0)\n</code></pre></p> <p>\u5982\u679c\u8981\u5bf9\u6bcf\u4e00\u884c\u5e94\u7528\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528<code>axis=1</code>\u53c2\u6570\uff1a <pre><code>df.apply(custom_function, axis=1)\n</code></pre></p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_10","title":"\u7ed8\u56fe","text":"<p>matplotlib</p> <pre><code># \u521b\u5efa\u4e00\u4e2aDataFrame\u5bf9\u8c61\ndata = {'Year': [2010, 2011, 2012, 2013, 2014, 2015],\n        'Sales': [100, 200, 300, 400, 500, 600]}\n\ndf = pd.DataFrame(data)\n\n# \u7ed8\u5236\u6298\u7ebf\u56fe\ndf.plot(x='Year', y='Sales', kind='line')\n\n# \u663e\u793a\u56fe\u5f62\nplt.show()\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_11","title":"\u6587\u4ef6\u8bfb\u53d6\u548c\u5b58\u50a8","text":"<p>\u5e38\u89c1\u7684\u6587\u4ef6\u8bfb\u53d6\u548c\u5b58\u50a8\u65b9\u6cd5\uff1a</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_12","title":"\u6587\u4ef6\u8bfb\u53d6","text":"<ol> <li>\u8bfb\u53d6CSV\u6587\u4ef6\uff1a\u4f7f\u7528<code>pandas.read_csv()</code>\u65b9\u6cd5\u6765\u8bfb\u53d6CSV\u6587\u4ef6\u3002\u4f8b\u5982\uff1a    <pre><code>import pandas as pd\ndata = pd.read_csv('data.csv')\n</code></pre></li> </ol> <p>\u5e38\u7528\u7684read_csv\u51fd\u6570\u7684\u53c2\u6570\uff1a - <code>filepath_or_buffer</code>: \u5fc5\u9700\u53c2\u6570\uff0c\u6307\u5b9a\u8981\u8bfb\u53d6\u7684\u6587\u4ef6\u7684\u8def\u5f84\u6216URL\u3002 - <code>sep</code>: \u6307\u5b9a\u5b57\u6bb5\u4e4b\u95f4\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u9017\u53f7\u3002 - <code>delimiter</code>: \u540c<code>sep</code>\uff0c\u6307\u5b9a\u5b57\u6bb5\u4e4b\u95f4\u7684\u5206\u9694\u7b26\uff0c\u4e0e<code>sep</code>\u53c2\u6570\u76f8\u540c\u3002 - <code>header</code>: \u6307\u5b9a\u54ea\u4e00\u884c\u4f5c\u4e3a\u5217\u540d\uff0c\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u793a\u7b2c\u4e00\u884c\u4f5c\u4e3a\u5217\u540d\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3aNone\uff0c\u5219\u8868\u793a\u6ca1\u6709\u5217\u540d\u3002 - <code>index_col</code>: \u6307\u5b9a\u67d0\u4e00\u5217\u4f5c\u4e3a\u7d22\u5f15\u5217\uff0c\u9ed8\u8ba4\u4e3aNone\uff0c\u8868\u793a\u4e0d\u4f7f\u7528\u4efb\u4f55\u5217\u4f5c\u4e3a\u7d22\u5f15\u3002 - <code>usecols</code>: \u6307\u5b9a\u8981\u8bfb\u53d6\u7684\u5217\u7684\u5217\u8868\uff0c\u9ed8\u8ba4\u4e3aNone\uff0c\u8868\u793a\u8bfb\u53d6\u6240\u6709\u5217\u3002 - <code>dtype</code>: \u6307\u5b9a\u6bcf\u4e00\u5217\u7684\u6570\u636e\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f\u5b57\u5178\u6216\u8005\u51fd\u6570\uff0c\u9ed8\u8ba4\u4e3aNone\uff0c\u8868\u793a\u81ea\u52a8\u63a8\u65ad\u6570\u636e\u7c7b\u578b\u3002 - <code>parse_dates</code>: \u6307\u5b9a\u8981\u89e3\u6790\u6210\u65e5\u671f\u7684\u5217\u7684\u5217\u8868\uff0c\u9ed8\u8ba4\u4e3aFalse\uff0c\u8868\u793a\u4e0d\u89e3\u6790\u65e5\u671f\u3002 - <code>na_values</code>: \u6307\u5b9a\u8981\u8bc6\u522b\u4e3a\u7f3a\u5931\u503c\u7684\u503c\u7684\u5217\u8868\uff0c\u9ed8\u8ba4\u4e3aNone\uff0c\u8868\u793a\u6839\u636epandas\u7684\u9ed8\u8ba4\u89c4\u5219\u6765\u8bc6\u522b\u3002 - <code>skiprows</code>: \u6307\u5b9a\u8981\u8df3\u8fc7\u7684\u884c\u6570\uff0c\u9ed8\u8ba4\u4e3aNone\uff0c\u8868\u793a\u4e0d\u8df3\u8fc7\u4efb\u4f55\u884c\u3002</p> <ol> <li>\u8bfb\u53d6Excel\u6587\u4ef6\uff1a\u4f7f\u7528<code>pandas.read_excel()</code>\u65b9\u6cd5\u6765\u8bfb\u53d6Excel\u6587\u4ef6\u3002\u9700\u8981\u5b89\u88c5<code>xlrd</code>\u5e93\u6765\u652f\u6301Excel\u6587\u4ef6\u8bfb\u53d6\u3002\u4f8b\u5982\uff1a    <pre><code>import pandas as pd\ndata = pd.read_excel('data.xlsx')\n</code></pre></li> </ol> <p>\u5e38\u7528\u7684\u53c2\u6570\u5305\u62ec\uff1a - <code>io</code>\uff1a\u6307\u5b9a\u8981\u8bfb\u53d6\u7684Excel\u6587\u4ef6\u7684\u8def\u5f84\u3001URL\u3001\u6587\u4ef6\u7c7b\u578b\u5bf9\u8c61\u6216\u8005\u539f\u59cb\u6587\u4ef6\u5185\u5bb9\u3002 - <code>sheet_name</code>\uff1a\u6307\u5b9a\u8981\u8bfb\u53d6\u7684\u5de5\u4f5c\u8868\u540d\u79f0\u6216\u7d22\u5f15\uff0c\u9ed8\u8ba4\u4e3a\u7b2c\u4e00\u4e2a\u5de5\u4f5c\u8868\u3002 - <code>header</code>\uff1a\u6307\u5b9a\u8868\u5934\u6240\u5728\u7684\u884c\uff0c\u9ed8\u8ba4\u4e3a0\uff0c\u8868\u793a\u7b2c\u4e00\u884c\u3002 - <code>names</code>\uff1a\u6307\u5b9a\u5217\u540d\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u5217\u8868\u3002 - <code>index_col</code>\uff1a\u6307\u5b9a\u4f5c\u4e3a\u7d22\u5f15\u7684\u5217\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u5217\u540d\u6216\u8005\u5217\u7684\u4f4d\u7f6e\u3002 - <code>usecols</code>\uff1a\u6307\u5b9a\u8981\u8bfb\u53d6\u7684\u5217\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u5217\u8868\u3002</p> <ol> <li> <p>\u8bfb\u53d6\u6587\u672c\u6587\u4ef6\uff1a\u4f7f\u7528<code>pandas.read_table()</code>\u65b9\u6cd5\u6765\u8bfb\u53d6\u6587\u672c\u6587\u4ef6\uff0c\u53ef\u4ee5\u6307\u5b9a\u5206\u9694\u7b26\u7b49\u53c2\u6570\u3002\u4f8b\u5982\uff1a    <pre><code>import pandas as pd\ndata = pd.read_table('data.txt', delimiter=',')\n</code></pre></p> </li> <li> <p>\u8bfb\u53d6json\u6587\u4ef6\uff1a\u4f7f\u7528<code>read_json()</code>\u51fd\u6570\u6765\u8bfb\u53d6JSON\u6587\u4ef6\u3002 <pre><code># \u8bfb\u53d6JSON\u6587\u4ef6\ndf = pd.read_json('file.json')\n\n# \u663e\u793aDataFrame\nprint(df)\n</code></pre></p> </li> </ol> <p>read_json\u51fd\u6570\u7684\u5e38\u7528\u53c2\u6570\u5982\u4e0b\uff1a - <code>path</code>\uff1a\u8981\u8bfb\u53d6\u7684 JSON \u6587\u4ef6\u7684\u8def\u5f84\uff0c\u53ef\u4ee5\u662f\u672c\u5730\u8def\u5f84\u6216\u8fdc\u7a0b URL\u3002 - <code>orient</code>\uff1a\u6307\u5b9a JSON \u6570\u636e\u7684\u7ed3\u6784\uff0c\u53ef\u9009\u503c\u5305\u62ec <code>'columns'</code>\u3001<code>'index'</code>\u3001<code>'values'</code>\u548c<code>'split'</code>\u3002\u9ed8\u8ba4\u4e3a <code>'columns'</code>\uff0c\u8868\u793a JSON \u6570\u636e\u7684\u6bcf\u4e2a\u9876\u7ea7\u5c5e\u6027\u5c06\u4f5c\u4e3a <code>DataFrame</code> \u7684\u5217\u3002 - <code>typ</code>\uff1a\u6307\u5b9a\u8bfb\u53d6\u7684 JSON \u6570\u636e\u7684\u6570\u636e\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u4e3a <code>None</code>\u3001<code>'series'</code> \u6216 <code>'frame'</code>\u3002\u9ed8\u8ba4\u4e3a <code>None</code>\uff0c\u8868\u793a\u6839\u636e\u6570\u636e\u7ed3\u6784\u81ea\u52a8\u63a8\u65ad\u6570\u636e\u7c7b\u578b\u3002 - <code>dtype</code>\uff1a\u6307\u5b9a\u5217\u7684\u6570\u636e\u7c7b\u578b\uff0c\u53ef\u4ee5\u662f\u5b57\u5178\u3001<code>Series</code> \u6216 <code>DataFrame</code>\u3002 - <code>convert_axes</code>\uff1a\u6307\u5b9a\u662f\u5426\u5c06\u884c\u7d22\u5f15\u8f6c\u6362\u4e3a\u5217\u540d\uff0c\u9ed8\u8ba4\u4e3a <code>True</code>\uff0c\u8868\u793a\u5c06\u884c\u7d22\u5f15\u8f6c\u6362\u4e3a\u5217\u540d\u3002 - <code>convert_dates</code>\uff1a\u6307\u5b9a\u662f\u5426\u5c06\u65e5\u671f\u5b57\u7b26\u4e32\u81ea\u52a8\u8f6c\u6362\u4e3a\u65e5\u671f\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3a <code>True</code>\u3002 - <code>keep_default_dates</code>\uff1a\u6307\u5b9a\u5728\u8f6c\u6362\u65e5\u671f\u5b57\u7b26\u4e32\u65f6\u662f\u5426\u4fdd\u7559\u7f3a\u7701\u65e5\u671f\uff0c\u9ed8\u8ba4\u4e3a <code>True</code>\u3002 - <code>numpy</code>\uff1a\u6307\u5b9a\u662f\u5426\u4f7f\u7528 NumPy \u8fdb\u884c\u6570\u636e\u7c7b\u578b\u63a8\u65ad\uff0c\u9ed8\u8ba4\u4e3a <code>False</code>\u3002 - <code>precise_float</code>\uff1a\u6307\u5b9a\u662f\u5426\u4f7f\u7528\u7cbe\u786e\u7684\u6d6e\u70b9\u6570\u8868\u793a\uff0c\u9ed8\u8ba4\u4e3a <code>False</code>\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_13","title":"\u6587\u4ef6\u5b58\u50a8","text":"<ol> <li> <p>\u5b58\u50a8\u4e3aCSV\u6587\u4ef6\uff1a\u4f7f\u7528<code>DataFrame.to_csv()</code>\u65b9\u6cd5\u6765\u5c06\u6570\u636e\u5b58\u50a8\u4e3aCSV\u6587\u4ef6\u3002\u4f8b\u5982\uff1a    <pre><code>import pandas as pd\ndata.to_csv('data.csv', index=False)\n</code></pre></p> </li> <li> <p>\u5b58\u50a8\u4e3aExcel\u6587\u4ef6\uff1a\u4f7f\u7528<code>DataFrame.to_excel()</code>\u65b9\u6cd5\u6765\u5c06\u6570\u636e\u5b58\u50a8\u4e3aExcel\u6587\u4ef6\u3002\u9700\u8981\u5b89\u88c5<code>openpyxl</code>\u5e93\u6765\u652f\u6301Excel\u6587\u4ef6\u5199\u5165\u3002\u4f8b\u5982\uff1a    <pre><code>import pandas as pd\ndata.to_excel('data.xlsx', index=False)\n</code></pre></p> </li> <li> <p>\u5b58\u50a8\u4e3a\u6587\u672c\u6587\u4ef6\uff1a\u4f7f\u7528<code>DataFrame.to_csv()</code>\u65b9\u6cd5\u6765\u5c06\u6570\u636e\u5b58\u50a8\u4e3a\u6587\u672c\u6587\u4ef6\uff0c\u53ef\u4ee5\u6307\u5b9a\u5206\u9694\u7b26\u7b49\u53c2\u6570\u3002\u4f8b\u5982\uff1a    <pre><code>import pandas as pd\ndata.to_csv('data.txt', sep='\\t', index=False)\n</code></pre></p> </li> <li> <p>\u5b58\u50a8\u4e3ajson\u6587\u4ef6\uff1a<code>to_json()</code>\u65b9\u6cd5\u7528\u4e8e\u5c06DataFrame\u6216Series\u5bf9\u8c61\u8f6c\u6362\u4e3aJSON\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\u6216\u6587\u4ef6\u3002</p> </li> </ol> <pre><code>data = {'name': ['Alice', 'Bob', 'Charlie'],\n        'age': [25, 30, 35],\n        'city': ['New York', 'San Francisco', 'Los Angeles']}\n\ndf = pd.DataFrame(data)\n\n# \u5c06DataFrame\u8f6c\u6362\u4e3aJSON\u5b57\u7b26\u4e32\njson_string = df.to_json(orient='records')\nprint(json_string)\n\n# \u5c06DataFrame\u4fdd\u5b58\u4e3aJSON\u6587\u4ef6\ndf.to_json('data.json', orient='records')\n</code></pre> <p>\u5728\u4e0a\u8ff0\u793a\u4f8b\u4e2d\uff0c<code>df.to_json(orient='records')</code>\u5c06DataFrame\u5bf9\u8c61\u8f6c\u6362\u4e3aJSON\u5b57\u7b26\u4e32\uff0c\u5e76\u5c06\u7ed3\u679c\u6253\u5370\u8f93\u51fa\u3002<code>df.to_json('data.json', orient='records')</code>\u5c06DataFrame\u4fdd\u5b58\u4e3a\u540d\u4e3a<code>data.json</code>\u7684\u6587\u4ef6\uff0cJSON\u683c\u5f0f\u4e3a\u6bcf\u884c\u4f5c\u4e3a\u4e00\u4e2aJSON\u5bf9\u8c61\u3002</p> <p>\u5e38\u7528\u7684\u53c2\u6570\uff1a</p> <ul> <li><code>path_or_buf</code>\uff1a\u6307\u5b9a\u751f\u6210\u7684JSON\u6587\u4ef6\u7684\u8def\u5f84\u6216\u6587\u4ef6\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u4e3aNone\u3002\u5982\u679c\u4e0d\u6307\u5b9a\u8be5\u53c2\u6570\uff0c\u5219<code>to_json()</code>\u65b9\u6cd5\u4f1a\u8fd4\u56de\u751f\u6210\u7684JSON\u5b57\u7b26\u4e32\u800c\u4e0d\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\u3002</li> <li><code>orient</code>\uff1a\u6307\u5b9a\u751f\u6210\u7684JSON\u683c\u5f0f\u3002\u53ef\u9009\u503c\u5305\u62ec<code>'split'</code>\uff08\u6bcf\u4e2a\u5bf9\u8c61\u7684\u6bcf\u4e2a\u503c\u90fd\u4f5c\u4e3a\u4e00\u4e2a\u72ec\u7acb\u7684JSON\u5bf9\u8c61\uff09\uff0c<code>'records'</code>\uff08\u6bcf\u884c\u4f5c\u4e3a\u4e00\u4e2aJSON\u5bf9\u8c61\uff09\uff0c<code>'index'</code>\uff08\u884c\u7d22\u5f15\u4f5c\u4e3aJSON\u5bf9\u8c61\u7684\u952e\uff09\uff0c<code>'columns'</code>\uff08\u5217\u540d\u4f5c\u4e3aJSON\u5bf9\u8c61\u7684\u952e\uff09\uff0c<code>'values'</code>\uff08\u53ea\u5305\u542b\u6570\u636e\u503c\uff09\u7b49\uff0c\u9ed8\u8ba4\u4e3a<code>'columns'</code>\u3002</li> <li><code>date_format</code>\uff1a\u6307\u5b9a\u65e5\u671f\u7c7b\u578b\u7684\u5e8f\u5217\u5316\u683c\u5f0f\uff0c\u9ed8\u8ba4\u4e3a<code>'iso'</code>\uff08ISO8601\u683c\u5f0f\uff09\u3002\u53ef\u4ee5\u4f7f\u7528<code>'epoch'</code>\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u7684\u65f6\u95f4\u6233\uff09\u6216\u81ea\u5b9a\u4e49\u65e5\u671f\u683c\u5f0f\u5b57\u7b26\u4e32\u3002</li> <li><code>double_precision</code>\uff1a\u6307\u5b9a\u6d6e\u70b9\u6570\u7684\u7cbe\u5ea6\uff0c\u9ed8\u8ba4\u4e3a10\u3002</li> <li><code>force_ascii</code>\uff1a\u6307\u5b9a\u662f\u5426\u5c06\u975eASCII\u5b57\u7b26\u8f6c\u4e49\u4e3a\u5176\u8f6c\u4e49\u7f16\u7801\uff0c\u9ed8\u8ba4\u4e3aTrue\u3002</li> </ul>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_14","title":"\u9ad8\u7ea7\u5904\u7406","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_15","title":"\u5904\u7406\u7f3a\u5931\u503c","text":"<p>\u5e38\u7528\u7684\u65b9\u6cd5\uff1a</p> <ol> <li> <p>\u5220\u9664\u7f3a\u5931\u503c\uff1a\u4f7f\u7528<code>dropna()</code>\u51fd\u6570\u53ef\u4ee5\u5220\u9664\u5305\u542b\u7f3a\u5931\u503c\u7684\u884c\u6216\u5217\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e<code>axis</code>\u53c2\u6570\u6765\u6307\u5b9a\u5220\u9664\u884c\u8fd8\u662f\u5217\uff0c\u9ed8\u8ba4\u662f\u5220\u9664\u884c\u3002\u53ef\u4ee5\u4f7f\u7528<code>thresh</code>\u53c2\u6570\u6765\u6307\u5b9a\u6bcf\u884c/\u5217\u81f3\u5c11\u8981\u6709\u591a\u5c11\u4e2a\u975e\u7f3a\u5931\u503c\u624d\u4fdd\u7559\u3002</p> </li> <li> <p>\u586b\u5145\u7f3a\u5931\u503c\uff1a\u4f7f\u7528<code>fillna()</code>\u51fd\u6570\u53ef\u4ee5\u586b\u5145\u7f3a\u5931\u503c\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e<code>value</code>\u53c2\u6570\u6765\u6307\u5b9a\u586b\u5145\u7684\u503c\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u5177\u4f53\u7684\u6570\u503c\u6216\u4e00\u4e2a\u5b57\u5178\u3002\u53ef\u4ee5\u4f7f\u7528<code>method</code>\u53c2\u6570\u6765\u6307\u5b9a\u586b\u5145\u7684\u65b9\u6cd5\uff0c\u5982\u4f7f\u7528\u524d\u4e00\u4e2a\u975e\u7f3a\u5931\u503c\u586b\u5145\uff08<code>ffill</code>\uff09\u6216\u4f7f\u7528\u540e\u4e00\u4e2a\u975e\u7f3a\u5931\u503c\u586b\u5145\uff08<code>bfill</code>\uff09\u3002</p> </li> <li> <p>\u63d2\u503c\u586b\u5145\u7f3a\u5931\u503c\uff1a\u4f7f\u7528<code>interpolate()</code>\u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u63d2\u503c\u65b9\u6cd5\u6765\u586b\u5145\u7f3a\u5931\u503c\u3002\u53ef\u4ee5\u4f7f\u7528<code>method</code>\u53c2\u6570\u6765\u6307\u5b9a\u63d2\u503c\u65b9\u6cd5\uff0c\u5982\u7ebf\u6027\u63d2\u503c\uff08<code>linear</code>\uff09\u6216\u591a\u9879\u5f0f\u63d2\u503c\uff08<code>polynomial</code>\uff09\u3002</p> </li> <li> <p>\u5224\u65ad\u7f3a\u5931\u503c\uff1a\u4f7f\u7528<code>isnull()</code> \u6216 <code>isna()</code> \u51fd\u6570\u53ef\u4ee5\u5224\u65ad\u6bcf\u4e2a\u5143\u7d20\u662f\u5426\u4e3a\u7f3a\u5931\u503c\uff0c\u8fd4\u56de\u4e00\u4e2a\u5e03\u5c14\u503c\u7684DataFrame\u6216Series\u3002</p> </li> <li> <p>\u66ff\u6362\u7f3a\u5931\u503c\uff1a\u4f7f\u7528<code>replace()</code>\u51fd\u6570\u53ef\u4ee5\u5c06\u7f3a\u5931\u503c\u66ff\u6362\u4e3a\u7279\u5b9a\u7684\u503c\u3002\u4f8b\u5982\uff1a<code>df.replace(np.nan, 0)</code>\u5c06NaN\u66ff\u6362\u4e3a0\u3002</p> </li> </ol> <p><code>isna()</code> <code>notna()</code> <code>isnull()</code> <code>notnull()</code> \u8fd9\u91ccisna\u662fisnull\u7684\u522b\u540d</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u5904\u7406\u7f3a\u5931\u503c\u4e4b\u524d\uff0c\u901a\u5e38\u8981\u5148\u4f7f\u7528<code>astype()</code>\u51fd\u6570\u5c06\u6570\u636e\u7c7b\u578b\u8f6c\u6362\u4e3a\u9002\u5f53\u7684\u7c7b\u578b\uff0c\u4ee5\u786e\u4fdd\u7f3a\u5931\u503c\u88ab\u6b63\u786e\u5904\u7406\u3002</p> <pre><code>df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\npd.isna(df)\n</code></pre> <pre><code># \u8f93\u51fa\n\n    A       B\n0   False   False\n1   False   False\n2   False   False\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_16","title":"\u79bb\u6563\u5316","text":"<p>pandas\u79bb\u6563\u5316\u7684\u5b9e\u9645\u4f5c\u7528\u662f\u5c06\u8fde\u7eed\u578b\u7684\u6570\u636e\u5212\u5206\u4e3a\u79bb\u6563\u7684\u6570\u636e\u533a\u95f4\uff0c\u4fbf\u4e8e\u5206\u6790\u548c\u5904\u7406\u3002\u79bb\u6563\u5316\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u66f4\u597d\u5730\u7406\u89e3\u548c\u89e3\u91ca\u6570\u636e\u7684\u5206\u5e03\u60c5\u51b5\uff0c\u5e76\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u6570\u636e\u5206\u6790\u548c\u6316\u6398\u3002</p> <p>\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4efd\u6c7d\u8f66\u9500\u552e\u6570\u636e\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u6c7d\u8f66\u7684\u4ef7\u683c\u4fe1\u606f\u3002\u5982\u679c\u6211\u4eec\u60f3\u8981\u5bf9\u8fd9\u4e9b\u6c7d\u8f66\u7684\u4ef7\u683c\u8fdb\u884c\u5206\u6790\uff0c\u4f46\u662f\u4ef7\u683c\u662f\u4e00\u4e2a\u8fde\u7eed\u7684\u53d8\u91cf\uff0c\u96be\u4ee5\u76f4\u63a5\u8fdb\u884c\u5206\u6790\u3002</p> <p>\u8fd9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u79bb\u6563\u5316\u6280\u672f\u5c06\u4ef7\u683c\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u4ef7\u683c\u533a\u95f4\uff0c\u4f8b\u59820-10\u4e07\u300110-20\u4e07\u300120-30\u4e07\u7b49\uff0c\u7136\u540e\u7edf\u8ba1\u6bcf\u4e2a\u533a\u95f4\u4e2d\u7684\u6c7d\u8f66\u6570\u91cf\uff0c\u8fdb\u4e00\u6b65\u5206\u6790\u4e0d\u540c\u4ef7\u683c\u533a\u95f4\u4e2d\u6c7d\u8f66\u7684\u9500\u552e\u60c5\u51b5\uff0c\u6bd4\u8f83\u4e0d\u540c\u4ef7\u683c\u533a\u95f4\u7684\u9500\u552e\u91cf\u548c\u9500\u552e\u989d\uff0c\u627e\u51fa\u9500\u552e\u70ed\u70b9\u548c\u5e02\u573a\u9700\u6c42\u3002 \u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u597d\u5730\u7406\u89e3\u548c\u89e3\u91ca\u6c7d\u8f66\u9500\u552e\u6570\u636e\uff0c\u4e3a\u5236\u5b9a\u9500\u552e\u7b56\u7565\u548c\u51b3\u7b56\u63d0\u4f9b\u652f\u6301\u3002</p> <p>\u5e38\u7528\u7684\u79bb\u6563\u5316\u65b9\u6cd5\uff1a</p> <ol> <li>\u7b49\u5bbd\u79bb\u6563\u5316\uff08binning\uff09\uff1a\u5c06\u6570\u636e\u6839\u636e\u6570\u503c\u8303\u56f4\u8fdb\u884c\u7b49\u5bbd\u5212\u5206\u3002\u53ef\u4ee5\u4f7f\u7528 pandas \u7684 <code>cut()</code> \u51fd\u6570\u5b9e\u73b0\u3002\u4f8b\u5982\uff1a</li> </ol> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2a\u793a\u4f8b\u6570\u636e\u96c6\ndata = pd.DataFrame({'score': [80, 90, 70, 85, 95, 65, 75, 100]})\n\n# \u5c06 score \u5217\u6309\u7167 3 \u4e2a\u7b49\u5bbd\u533a\u95f4\u8fdb\u884c\u79bb\u6563\u5316\ndata['score_bin'] = pd.cut(data['score'], bins=3)\n\nprint(data)\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\uff1a</p> <pre><code>   score       score_bin\n0     80  (64.933, 80.0]\n1     90   (80.0, 95.0]\n2     70  (64.933, 80.0]\n3     85   (80.0, 95.0]\n4     95   (80.0, 95.0]\n5     65  (64.933, 80.0]\n6     75  (64.933, 80.0]\n7    100  (95.0, 109.067]\n</code></pre> <p><code>pd.cut()</code>\u51fd\u6570\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u4e00\u4e2aCategorical\u5bf9\u8c61\uff0c\u53ef\u4ee5\u901a\u8fc7<code>result.codes</code>\u83b7\u53d6\u6bcf\u4e2a\u6570\u636e\u6240\u5c5e\u7684\u533a\u95f4\u7684\u7f16\u53f7\uff0c\u901a\u8fc7<code>result.categories</code>\u83b7\u53d6\u6240\u6709\u6807\u7b7e\u3002</p> <ol> <li>\u7b49\u9891\u79bb\u6563\u5316\uff08quantile\uff09\uff1a\u5c06\u6570\u636e\u5206\u6210\u76f8\u540c\u6570\u91cf\u7684\u533a\u95f4\uff0c\u6bcf\u4e2a\u533a\u95f4\u5305\u542b\u8fd1\u4f3c\u76f8\u540c\u6570\u91cf\u7684\u6570\u636e\u3002\u53ef\u4ee5\u4f7f\u7528 pandas \u7684 <code>qcut()</code> \u51fd\u6570\u5b9e\u73b0\u3002\u4f8b\u5982\uff1a</li> </ol> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2a\u793a\u4f8b\u6570\u636e\u96c6\ndata = pd.DataFrame({'score': [80, 90, 70, 85, 95, 65, 75, 100]})\n\n# \u5c06 score \u5217\u6309\u7167 3 \u4e2a\u7b49\u9891\u533a\u95f4\u8fdb\u884c\u79bb\u6563\u5316\ndata['score_bin'] = pd.qcut(data['score'], q=3)\n\nprint(data)\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\uff1a</p> <pre><code>   score       score_bin\n0     80  (64.999, 75.0]\n1     90   (87.5, 100.0]\n2     70  (64.999, 75.0]\n3     85   (75.0, 87.5]\n4     95   (87.5, 100.0]\n5     65  (64.999, 75.0]\n6     75  (64.999, 75.0]\n7    100   (87.5, 100.0]\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_17","title":"\u5408\u5e76","text":"<ol> <li><code>pd.concat()</code></li> </ol> <p>\u8fde\u63a5\u53ef\u4ee5\u6309\u884c\uff08\u5782\u76f4\u65b9\u5411\uff09\u6216\u6309\u5217\uff08\u6c34\u5e73\u65b9\u5411\uff09\u8fdb\u884c\u3002</p> <p>\u4f7f\u7528concat\u51fd\u6570\u7684\u793a\u4f8b\uff1a</p> <pre><code># \u521b\u5efa\u4e24\u4e2a\u6570\u636e\u6846\ndf1 = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\ndf2 = pd.DataFrame({'A': [7, 8, 9], 'B': [10, 11, 12]})\n\n# \u6309\u884c\u8fde\u63a5\u4e24\u4e2a\u6570\u636e\u6846\nresult = pd.concat([df1, df2], axis=0)\nprint(result)\n\n# \u6309\u5217\u8fde\u63a5\u4e24\u4e2a\u6570\u636e\u6846\nresult = pd.concat([df1, df2], axis=1)\nprint(result)\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u4e3a\uff1a <pre><code>   A   B\n0  1   4\n1  2   5\n2  3   6\n0  7  10\n1  8  11\n2  9  12\n\n   A  B  A   B\n0  1  4  7  10\n1  2  5  8  11\n2  3  6  9  12\n</code></pre></p> <ol> <li><code>pd.merge()</code></li> </ol> <p>\u5141\u8bb8\u5c06\u4e24\u4e2a\u6216\u591a\u4e2a\u6570\u636e\u6846\uff08DataFrame\uff09\u6309\u7167\u4e00\u4e2a\u6216\u591a\u4e2a\u952e\uff08key\uff09\u8fdb\u884c\u8fde\u63a5\u3002</p> <p>Pandas\u7684merge\u51fd\u6570\u6709\u4ee5\u4e0b\u5e38\u7528\u53c2\u6570\uff1a</p> <ul> <li>left\uff1a\u5de6\u4fa7\u7684\u6570\u636e\u6846\u3002</li> <li>right\uff1a\u53f3\u4fa7\u7684\u6570\u636e\u6846\u3002</li> <li>on\uff1a\u6307\u5b9a\u8981\u5408\u5e76\u7684\u952e\uff08key\uff09\u7684\u5217\u540d\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u5217\u540d\u6216\u591a\u4e2a\u5217\u540d\u3002\u5982\u679c\u4e24\u4e2a\u6570\u636e\u6846\u4e2d\u7684\u5217\u540d\u4e0d\u540c\uff0c\u53ef\u4ee5\u4f7f\u7528left_on\u548cright_on\u53c2\u6570\u8fdb\u884c\u6307\u5b9a\u3002</li> <li>how\uff1a\u6307\u5b9a\u5408\u5e76\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u4e3a\"inner\"\uff0c\u8868\u793a\u5185\u8fde\u63a5\u3002\u5176\u4ed6\u5e38\u7528\u7684\u5408\u5e76\u65b9\u5f0f\u5305\u62ec\"outer\"\uff08\u5916\u8fde\u63a5\uff09\u3001\"left\"\uff08\u5de6\u8fde\u63a5\uff09\u548c\"right\"\uff08\u53f3\u8fde\u63a5\uff09\u3002</li> <li>suffixes\uff1a\u6307\u5b9a\u5728\u5408\u5e76\u65f6\uff0c\u5982\u679c\u4e24\u4e2a\u6570\u636e\u6846\u4e2d\u5b58\u5728\u76f8\u540c\u5217\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u5bf9\u5217\u540d\u8fdb\u884c\u91cd\u547d\u540d\u7684\u540e\u7f00\u3002\u4e00\u822c\u5de6\u4fa7\u6570\u636e\u6846\u7684\u5217\u540d\u6dfb\u52a0\"_x\"\u540e\u7f00\uff0c\u53f3\u4fa7\u6570\u636e\u6846\u7684\u5217\u540d\u6dfb\u52a0\"_y\"\u540e\u7f00\u3002</li> </ul> <p>merge\u7684\u529f\u80fd\u76f8\u8f83\u66f4\u591a</p> <pre><code># \u521b\u5efa\u7b2c\u4e00\u4e2aDataFrame\u5bf9\u8c61\ndata1 = {'Name': ['John', 'Emma', 'Tom'],\n         'Age': [25, 28, 30],\n         'City': ['New York', 'London', 'Paris']}\ndf1 = pd.DataFrame(data1)\n\n# \u521b\u5efa\u7b2c\u4e8c\u4e2aDataFrame\u5bf9\u8c61\ndata2 = {'Name': ['John', 'Emma', 'Lily'],\n         'Salary': [5000, 6000, 7000],\n         'City': ['New York', 'London', 'Tokyo']}\ndf2 = pd.DataFrame(data2)\n\n# \u4f7f\u7528merge\u51fd\u6570\u5408\u5e76\u4e24\u4e2aDataFrame\u5bf9\u8c61\nmerged_df = pd.merge(df1, df2, on='Name')\n\nprint(merged_df)\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\uff1a</p> <pre><code>   Name  Age       City_x  Salary     City_y\n0  John   25     New York    5000   New York\n1  Emma   28       London    6000     London\n</code></pre> <p>[!info] \u5185\u8fde\u63a5\uff08Inner Join\uff09\uff1a\u5185\u8fde\u63a5\u662f\u4e00\u79cd\u901a\u8fc7\u4e24\u4e2a\u8868\u4e2d\u7684\u5171\u540c\u5217\u8fdb\u884c\u5339\u914d\uff0c\u5e76\u8fd4\u56de\u5339\u914d\u7ed3\u679c\u7684\u8fde\u63a5\u65b9\u5f0f\u3002\u53ea\u6709\u5728\u4e24\u4e2a\u8868\u4e2d\u90fd\u5b58\u5728\u5339\u914d\u7684\u884c\u65f6\uff0c\u624d\u4f1a\u8fd4\u56de\u7ed3\u679c\u3002</p> <p>\u5916\u8fde\u63a5\uff08Outer Join\uff09\uff1a\u5916\u8fde\u63a5\u662f\u4e00\u79cd\u8fde\u63a5\u65b9\u5f0f\uff0c\u5b83\u53ef\u4ee5\u8fd4\u56de\u5339\u914d\u7684\u884c\u4ee5\u53ca\u5de6\u8868\u6216\u53f3\u8868\u4e2d\u6ca1\u6709\u5339\u914d\u7684\u884c\u3002\u5916\u8fde\u63a5\u53ef\u4ee5\u5206\u4e3a\u5de6\u5916\u8fde\u63a5\u548c\u53f3\u5916\u8fde\u63a5\u3002</p> <p>\u5de6\u8fde\u63a5\uff08Left Join\uff09\uff1a\u5de6\u8fde\u63a5\u662f\u4e00\u79cd\u5916\u8fde\u63a5\uff0c\u5b83\u8fd4\u56de\u5de6\u8868\u4e2d\u6240\u6709\u7684\u884c\u4ee5\u53ca\u4e0e\u53f3\u8868\u4e2d\u5339\u914d\u7684\u884c\u3002\u5982\u679c\u53f3\u8868\u4e2d\u6ca1\u6709\u5339\u914d\u7684\u884c\uff0c\u90a3\u4e48\u8fd4\u56de\u7684\u7ed3\u679c\u4e2d\u5bf9\u5e94\u7684\u5217\u503c\u4e3aNULL\u3002</p> <p>\u53f3\u8fde\u63a5\uff08Right Join\uff09\uff1a\u53f3\u8fde\u63a5\u662f\u4e00\u79cd\u5916\u8fde\u63a5\uff0c\u5b83\u8fd4\u56de\u53f3\u8868\u4e2d\u6240\u6709\u7684\u884c\u4ee5\u53ca\u4e0e\u5de6\u8868\u4e2d\u5339\u914d\u7684\u884c\u3002\u5982\u679c\u5de6\u8868\u4e2d\u6ca1\u6709\u5339\u914d\u7684\u884c\uff0c\u90a3\u4e48\u8fd4\u56de\u7684\u7ed3\u679c\u4e2d\u5bf9\u5e94\u7684\u5217\u503c\u4e3aNULL\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_18","title":"\u4ea4\u53c9\u8868\u3001\u900f\u89c6\u8868","text":"<p>\u4ea4\u53c9\u8868\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u5feb\u901f\u4e86\u89e3\u4e24\u4e2a\u53d8\u91cf\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u4ee5\u53ca\u5b83\u4eec\u5728\u4e0d\u540c\u7ec4\u522b\u6216\u7c7b\u522b\u4e0a\u7684\u5206\u5e03\u60c5\u51b5\u3002\u4ea4\u53c9\u8868\u53ef\u4ee5\u7528\u4e8e\u5b9a\u6027\u6570\u636e\uff08\u5982\u7c7b\u522b\u3001\u6807\u7b7e\u7b49\uff09\u548c\u5b9a\u91cf\u6570\u636e\uff08\u5982\u6570\u503c\u578b\u6570\u636e\uff09\u3002</p> <p><code>pd.crosstab()</code></p> <p>pandas\u7684\u4ea4\u53c9\u8868\u529f\u80fd\uff1a</p> <pre><code># \u521b\u5efa\u4e00\u4e2a\u793a\u4f8b\u6570\u636e\u96c6\ndata = {\n    'Gender': ['Male', 'Male', 'Female', 'Female', 'Male', 'Female'],\n    'Age': [25, 30, 20, 35, 40, 25],\n    'Smoker': ['Yes', 'No', 'Yes', 'No', 'No', 'Yes']\n}\n\ndf = pd.DataFrame(data)\n\n# \u4f7f\u7528\u4ea4\u53c9\u8868\u8ba1\u7b97\u4e24\u4e2a\u53d8\u91cf\u4e4b\u95f4\u7684\u4ea4\u53c9\u9891\u6570\ncross_tab = pd.crosstab(df['Gender'], df['Smoker'])\n\nprint(cross_tab)\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>Smoker  No  Yes\nGender         \nFemale   1    2\nMale     2    1\n</code></pre> <p>\u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u5305\u542b\u6027\u522b\u3001\u5e74\u9f84\u548c\u5438\u70df\u60c5\u51b5\u7684\u6570\u636e\u96c6\u3002\u901a\u8fc7\u8c03\u7528<code>pd.crosstab()</code>\u51fd\u6570\uff0c\u5e76\u4f20\u5165\u9700\u8981\u7edf\u8ba1\u7684\u4e24\u4e2a\u53d8\u91cf\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4ea4\u53c9\u8868\uff0c\u663e\u793a\u4e86\u5404\u4e2a\u7c7b\u522b\u5728\u4ea4\u53c9\u70b9\u4e0a\u7684\u9891\u6570\u3002</p> <p>\u5728\u7ed3\u679c\u4e2d\uff0c\u6bcf\u4e00\u884c\u4ee3\u8868\u4e00\u4e2a\u6027\u522b\u7c7b\u522b\uff08Female\u548cMale\uff09\uff0c\u6bcf\u4e00\u5217\u4ee3\u8868\u4e00\u4e2a\u5438\u70df\u60c5\u51b5\u7c7b\u522b\uff08No\u548cYes\uff09\u3002\u4ea4\u53c9\u70b9\u4e0a\u7684\u6570\u5b57\u8868\u793a\u4e86\u5bf9\u5e94\u6027\u522b\u548c\u5438\u70df\u60c5\u51b5\u7684\u9891\u6570\u3002</p> <p>\u900f\u89c6\u8868\u662f\u4e00\u79cd\u6570\u636e\u6c47\u603b\u548c\u91cd\u5851\u7684\u64cd\u4f5c\uff0c\u5b83\u53ef\u4ee5\u901a\u8fc7\u805a\u5408\u548c\u5206\u7ec4\u6765\u521b\u5efa\u65b0\u7684\u6570\u636e\u8868\u683c\u3002\u900f\u89c6\u8868\u53ef\u4ee5\u6309\u7167\u6307\u5b9a\u7684\u884c\u548c\u5217\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u6839\u636e\u7279\u5b9a\u7684\u805a\u5408\u51fd\u6570\u8ba1\u7b97\u6c47\u603b\u503c\u3002</p> <p>\u5728Pandas\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528<code>pd.pivot_table()</code>\u51fd\u6570\u521b\u5efa\u900f\u89c6\u8868\u3002</p> <ul> <li>values\uff1a\u9700\u8981\u805a\u5408\u7684\u5217\u6216\u5217\u7684\u5217\u8868\u3002\u9ed8\u8ba4\u4e3a\u6240\u6709\u6570\u503c\u5217\u3002</li> <li>index\uff1a\u7528\u4e8e\u5206\u7ec4\u7684\u5217\u6216\u5217\u7684\u5217\u8868\u3002\u9ed8\u8ba4\u4e3a\u6240\u6709\u975e\u6570\u503c\u5217\u3002</li> <li>columns\uff1a\u7528\u4e8e\u5206\u7ec4\u7684\u5217\u6216\u5217\u7684\u5217\u8868\u3002\u9ed8\u8ba4\u4e3a\u6240\u6709\u975e\u6570\u503c\u5217\u3002</li> <li>aggfunc\uff1a\u7528\u4e8e\u805a\u5408\u7684\u51fd\u6570\u6216\u51fd\u6570\u7684\u5217\u8868\u3002\u9ed8\u8ba4\u4e3anp.mean\uff0c\u5373\u8ba1\u7b97\u5e73\u5747\u503c\u3002</li> <li>fill_value\uff1a\u7528\u4e8e\u586b\u5145\u7f3a\u5931\u503c\u7684\u503c\u3002</li> <li>margins\uff1a\u662f\u5426\u8ba1\u7b97\u6240\u6709\u884c/\u5217\u7684\u603b\u8ba1\uff0c\u9ed8\u8ba4\u4e3aFalse\u3002</li> <li>dropna\uff1a\u662f\u5426\u5220\u9664\u5305\u542b\u7f3a\u5931\u503c\u7684\u884c/\u5217\uff0c\u9ed8\u8ba4\u4e3aTrue\u3002</li> <li>observed\uff1a\u53ea\u9002\u7528\u4e8e\u5206\u7c7b\u53d8\u91cf\uff0c\u6307\u5b9a\u662f\u5426\u5305\u542b\u6240\u6709\u53ef\u80fd\u7684\u7ec4\u5408\u503c\uff0c\u9ed8\u8ba4\u4e3aFalse\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\u4ee3\u7801\uff0c\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u900f\u89c6\u8868\u5bf9\u9500\u552e\u6570\u636e\u8fdb\u884c\u6c47\u603b\uff1a</p> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2a\u5305\u542b\u9500\u552e\u6570\u636e\u7684DataFrame\ndata = {\n    '\u57ce\u5e02': ['\u5317\u4eac', '\u4e0a\u6d77', '\u5317\u4eac', '\u4e0a\u6d77', '\u5317\u4eac', '\u4e0a\u6d77'],\n    '\u4ea7\u54c1': ['A', 'A', 'B', 'B', 'C', 'C'],\n    '\u9500\u552e\u989d': [100, 200, 150, 300, 120, 250]\n}\ndf = pd.DataFrame(data)\n\n# \u4f7f\u7528\u900f\u89c6\u8868\u5bf9\u9500\u552e\u6570\u636e\u8fdb\u884c\u6c47\u603b\npivot_table = pd.pivot_table(df, values='\u9500\u552e\u989d', index='\u57ce\u5e02', columns='\u4ea7\u54c1', aggfunc=np.sum)\n\nprint(pivot_table)\n</code></pre> <p>\u8fd0\u884c\u4ee5\u4e0a\u4ee3\u7801\uff0c\u5c06\u4f1a\u5f97\u5230\u5982\u4e0b\u7684\u900f\u89c6\u8868\uff1a</p> <pre><code>\u4ea7\u54c1    A    B    C\n\u57ce\u5e02                \n\u4e0a\u6d77  200  300  250\n\u5317\u4eac  100  150  120\n</code></pre> <p>\u900f\u89c6\u8868\u4e2d\u7684\u6bcf\u4e00\u884c\u8868\u793a\u4e00\u4e2a\u57ce\u5e02\uff0c\u6bcf\u4e00\u5217\u8868\u793a\u4e00\u4e2a\u4ea7\u54c1\u7c7b\u578b\uff0c\u5355\u5143\u683c\u4e2d\u7684\u6570\u503c\u8868\u793a\u8be5\u57ce\u5e02\u4e2d\u5bf9\u5e94\u4ea7\u54c1\u7c7b\u578b\u7684\u9500\u552e\u989d\u7684\u6c47\u603b\u503c\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_19","title":"\u5206\u7ec4\u3001\u805a\u5408","text":"<p>Pandas\u4e2d\uff0c\u5206\u7ec4\u6307\u7684\u662f\u5c06\u6570\u636e\u6309\u7167\u67d0\u4e2a\u6761\u4ef6\u8fdb\u884c\u5206\u7ec4\uff0c\u800c\u805a\u5408\u5219\u662f\u5bf9\u6bcf\u4e2a\u5206\u7ec4\u8ba1\u7b97\u4e00\u4e2a\u7edf\u8ba1\u6307\u6807\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u7528\u7684Pandas\u5206\u7ec4\u4e0e\u805a\u5408\u64cd\u4f5c\uff1a</p> <ol> <li> <p>groupby(): \u4f7f\u7528groupby\u51fd\u6570\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u7ec4\u3002\u53ef\u4ee5\u6309\u7167\u4e00\u5217\u6216\u591a\u5217\u7684\u503c\u8fdb\u884c\u5206\u7ec4\u3002</p> </li> <li> <p>\u805a\u5408\u51fd\u6570\uff1a\u53ef\u4ee5\u4f7f\u7528\u5404\u79cd\u7edf\u8ba1\u51fd\u6570\u5bf9\u5206\u7ec4\u540e\u7684\u6570\u636e\u8fdb\u884c\u805a\u5408\u64cd\u4f5c\uff0c\u5982sum\u3001mean\u3001max\u3001min\u3001count\u7b49\u3002</p> </li> <li> <p>agg(): \u4f7f\u7528agg\u51fd\u6570\u5bf9\u5206\u7ec4\u540e\u7684\u6570\u636e\u8fdb\u884c\u591a\u4e2a\u805a\u5408\u64cd\u4f5c\u3002\u53ef\u4ee5\u4e00\u6b21\u6027\u5bf9\u591a\u4e2a\u5217\u5e94\u7528\u4e0d\u540c\u7684\u805a\u5408\u51fd\u6570\u3002</p> </li> <li> <p>transform(): \u4f7f\u7528transform\u51fd\u6570\u5c06\u805a\u5408\u7ed3\u679c\u8fd4\u56de\u5230\u539f\u59cb\u6570\u636e\u7684\u6bcf\u4e00\u884c\u3002</p> </li> <li> <p>apply(): \u4f7f\u7528apply\u51fd\u6570\u5bf9\u5206\u7ec4\u540e\u7684\u6570\u636e\u8fdb\u884c\u81ea\u5b9a\u4e49\u7684\u805a\u5408\u64cd\u4f5c\u3002</p> </li> </ol> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528Pandas\u8fdb\u884c\u5206\u7ec4\u4e0e\u805a\u5408\u64cd\u4f5c\uff1a</p> <pre><code>import pandas as pd\n\n# \u521b\u5efa\u4e00\u4e2a\u793a\u4f8b\u6570\u636e\u96c6\ndata = {'Name': ['Alice', 'Bob', 'Charlie', 'Alice', 'Bob', 'Charlie'],\n        'Age': [25, 30, 35, 40, 45, 50],\n        'Salary': [5000, 6000, 7000, 8000, 9000, 10000]}\n\ndf = pd.DataFrame(data)\n\n# \u6309\u7167\u59d3\u540d\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u8ba1\u7b97\u5e73\u5747\u5e74\u9f84\u548c\u603b\u85aa\u8d44\ngrouped = df.groupby('Name').agg({'Age': 'mean', 'Salary': 'sum'})\n\nprint(grouped)\n</code></pre> <p>\u8f93\u51fa\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>         Age  Salary\nName                \nAlice   32.5   13000\nBob     37.5   15000\nCharlie 42.5   17000\n</code></pre> <p>\u8fd9\u4e2a\u793a\u4f8b\u4ee3\u7801\u4e2d\uff0c\u9996\u5148\u521b\u5efa\u4e86\u4e00\u4e2a\u5305\u542b\u59d3\u540d\u3001\u5e74\u9f84\u548c\u85aa\u8d44\u7684\u6570\u636e\u96c6\u3002\u7136\u540e\uff0c\u4f7f\u7528groupby\u51fd\u6570\u6309\u7167\u59d3\u540d\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u4f7f\u7528agg\u51fd\u6570\u8ba1\u7b97\u6bcf\u4e2a\u5206\u7ec4\u7684\u5e73\u5747\u5e74\u9f84\u548c\u603b\u85aa\u8d44\u3002\u6700\u540e\uff0c\u5c06\u805a\u5408\u7ed3\u679c\u6253\u5370\u51fa\u6765\u3002</p> <p>groupby\u65b9\u6cd5\u7684\u53c2\u6570\u5305\u62ec\uff1a</p> <ol> <li> <p>by\uff1a\u8868\u793a\u6839\u636e\u54ea\u4e9b\u5217\u8fdb\u884c\u5206\u7ec4\uff0c\u53ef\u4ee5\u662f\u5217\u540d\uff08\u5355\u4e2a\u5217\u540d\u6216\u591a\u4e2a\u5217\u540d\u7ec4\u6210\u7684\u5217\u8868\uff09\uff0c\u4e5f\u53ef\u4ee5\u662f\u51fd\u6570\u3001\u5b57\u5178\u3001Series\u7b49\u3002\u9ed8\u8ba4\u4e3aNone\u3002</p> </li> <li> <p>axis\uff1a\u8868\u793a\u5206\u7ec4\u7684\u8f74\uff0c\u53ef\u4ee5\u662f0\u8868\u793a\u6309\u884c\u5206\u7ec4\uff0c1\u8868\u793a\u6309\u5217\u5206\u7ec4\u3002\u9ed8\u8ba4\u4e3a0\u3002</p> </li> <li> <p>level\uff1a\u8868\u793a\u5bf9\u4e8e\u591a\u7ea7\u7d22\u5f15\u6570\u636e\uff0c\u6307\u5b9a\u5728\u54ea\u4e2a\u7ea7\u522b\u4e0a\u8fdb\u884c\u5206\u7ec4\u3002\u9ed8\u8ba4\u4e3aNone\u3002</p> </li> <li> <p>as_index\uff1a\u8868\u793a\u662f\u5426\u5c06\u5206\u7ec4\u7684\u5217\u4f5c\u4e3a\u7d22\u5f15\uff0c\u9ed8\u8ba4\u4e3aTrue\u3002</p> </li> <li> <p>sort\uff1a\u8868\u793a\u662f\u5426\u5bf9\u5206\u7ec4\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\uff0c\u9ed8\u8ba4\u4e3aTrue\u3002</p> </li> <li> <p>group_keys\uff1a\u8868\u793a\u662f\u5426\u5728\u7ed3\u679c\u4e2d\u5305\u542b\u5206\u7ec4\u952e\uff0c\u9ed8\u8ba4\u4e3aTrue\u3002</p> </li> <li> <p>squeeze\uff1a\u8868\u793a\u662f\u5426\u5bf9\u7ed3\u679c\u8fdb\u884c\u538b\u7f29\uff0c\u9ed8\u8ba4\u4e3aFalse\u3002\u5982\u679c\u5206\u7ec4\u53ea\u6709\u4e00\u4e2a\u7ec4\uff0c\u4e14as_index\u4e3aTrue\uff0c\u5219\u7ed3\u679c\u4f1a\u4ee5Series\u7684\u5f62\u5f0f\u8fd4\u56de\u3002</p> </li> <li> <p>observed\uff1a\u8868\u793a\u5728\u5206\u7ec4\u8fc7\u7a0b\u4e2d\u662f\u5426\u5305\u542b\u6240\u6709\u7684\u89c2\u6d4b\u503c\uff0c\u9ed8\u8ba4\u4e3aFalse\u3002\u5982\u679c\u4e3aTrue\uff0c\u5219\u4f1a\u5305\u542b\u6240\u6709\u89c2\u6d4b\u503c\uff0c\u5373\u4f7f\u5b83\u4eec\u6ca1\u6709\u51fa\u73b0\u5728\u5206\u7ec4\u7684\u5217\u4e2d\u3002</p> </li> <li> <p>dropna\uff1a\u8868\u793a\u5728\u5206\u7ec4\u8fc7\u7a0b\u4e2d\u662f\u5426\u5ffd\u7565\u7f3a\u5931\u503c\uff0c\u9ed8\u8ba4\u4e3aTrue\u3002</p> </li> <li> <p>as_index\uff1a\u8868\u793a\u662f\u5426\u5c06\u5206\u7ec4\u7684\u5217\u4f5c\u4e3a\u7d22\u5f15\uff0c\u9ed8\u8ba4\u4e3aTrue\u3002</p> </li> <li> <p>level\uff1a\u8868\u793a\u5bf9\u4e8e\u591a\u7ea7\u7d22\u5f15\u6570\u636e\uff0c\u6307\u5b9a\u5728\u54ea\u4e2a\u7ea7\u522b\u4e0a\u8fdb\u884c\u5206\u7ec4\u3002\u9ed8\u8ba4\u4e3aNone\u3002</p> </li> </ol>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/pandas%E5%9F%BA%E7%A1%80/#_20","title":"\u5176\u4ed6","text":"<p>\u53ef\u4ee5\u4f7f\u7528<code>get_dummies()</code>\u51fd\u6570\u6765\u5c06\u5206\u7c7b\u53d8\u91cf\u8f6c\u6362\u6210one-hot\u7f16\u7801</p> <pre><code>import pandas as pd\n\n# \u5047\u8bbe\u4f60\u6709\u4e00\u4e2aDataFrame df\uff0c\u5305\u542b\u4e86\u4e00\u4e2a\u5206\u7c7b\u53d8\u91cfcategory_column\n# \u4f8b\u5982\uff1adf = pd.DataFrame({'category_column': ['A', 'B', 'A', 'C', 'B', 'C']})\n\n# \u4f7f\u7528get_dummies\u51fd\u6570\u5c06\u5206\u7c7b\u53d8\u91cf\u8f6c\u6362\u4e3aone-hot\u7f16\u7801\none_hot_df = pd.get_dummies(df['category_column'])\n\n# \u5c06one-hot\u7f16\u7801\u7684\u7ed3\u679c\u4e0e\u539f\u59cbDataFrame\u5408\u5e76\ndf = pd.concat([df, one_hot_df], axis=1)\n\n# \u5220\u9664\u539f\u59cb\u7684\u5206\u7c7b\u53d8\u91cf\u5217\ndf.drop(['category_column'], axis=1, inplace=True)\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/matplotlib/matplotlib/","title":"matplotlib","text":"<p>\u7b2c\u4e00\u5f20\u56fe\u7247</p> <pre><code>import matplotlib.pyplot as plt\n\n# \u5b9a\u4e49 x \u548c y \u5750\u6807\u6570\u636e\nx = [1, 2, 3, 4, 5]\ny = [1, 4, 9, 16, 25]\n\n# \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u56fe\u5f62\u7a97\u53e3\uff0c\u5e76\u8bbe\u7f6e\u5927\u5c0f\nplt.figure(figsize=(8, 5))\n\n# \u7ed8\u5236\u7ebf\u56fe\nplt.plot(x, y)\nplt.plot([1,2,43,32])\n# \u591a\u6b21\u4f7f\u7528plot\u4fbf\u53ef\u4ee5\u7ed8\u5236\u591a\u6761\u6298\u7ebf\n\n\n# \u8bbe\u7f6e x \u548c y \u8f74\u6807\u7b7e\nplt.xlabel('X')\nplt.ylabel('Y')\n\n# \u8bbe\u7f6e\u56fe\u5f62\u6807\u9898\nplt.title('My First Plot')\n\n# \u663e\u793a\u56fe\u5f62\nplt.show()\n</code></pre> <p></p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/matplotlib/matplotlib/#_1","title":"\u7ebf\u6761","text":""},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/matplotlib/matplotlib/#color","title":"\u989c\u8272(color)","text":"<p>matplotlib\u63d0\u4f9b\u4e86\u591a\u79cd\u7ebf\u6761\u989c\u8272\u7684\u9009\u62e9\uff0c\u5305\u62ec\u4ee5\u4e0b\u51e0\u79cd\u79cd\u7c7b\uff1a</p> <ol> <li> <p>\u5355\u5b57\u7b26\u8868\u793a\u989c\u8272\uff1a'b'\u4ee3\u8868\u84dd\u8272\uff0c'g'\u4ee3\u8868\u7eff\u8272\uff0c'r'\u4ee3\u8868\u7ea2\u8272\uff0c'c'\u4ee3\u8868\u9752\u8272\uff0c'm'\u4ee3\u8868\u6d0b\u7ea2\u8272\uff0c'y'\u4ee3\u8868\u9ec4\u8272\uff0c'k'\u4ee3\u8868\u9ed1\u8272\uff0c'w'\u4ee3\u8868\u767d\u8272\u3002</p> </li> <li> <p>HTML\u989c\u8272\u4ee3\u7801\u8868\u793a\u989c\u8272\uff1a\u53ef\u4ee5\u4f7f\u7528HTML\u989c\u8272\u4ee3\u7801\u6765\u6307\u5b9a\u7ebf\u6761\u7684\u989c\u8272\uff0c\u6bd4\u5982'#FF0000'\u4ee3\u8868\u7ea2\u8272\u3002</p> </li> <li> <p>RGB\u5143\u7ec4\u8868\u793a\u989c\u8272\uff1a\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u5305\u542b\u4e09\u4e2a\u5143\u7d20\u7684\u5143\u7ec4\u6765\u6307\u5b9a\u7ebf\u6761\u7684\u989c\u8272\uff0c\u6bcf\u4e2a\u5143\u7d20\u7684\u53d6\u503c\u8303\u56f4\u662f0\u52301\uff0c\u5206\u522b\u4ee3\u8868\u7ea2\u3001\u7eff\u3001\u84dd\u4e09\u4e2a\u901a\u9053\u7684\u4eae\u5ea6\u3002\u4f8b\u5982(1, 0, 0)\u8868\u793a\u7ea2\u8272\u3002</p> </li> <li> <p>\u989c\u8272\u7f29\u5199\uff1a\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5e38\u7528\u7684\u7f29\u5199\u6765\u8868\u793a\u989c\u8272\uff0c\u6bd4\u5982'blue'\u4ee3\u8868\u84dd\u8272\uff0c'green'\u4ee3\u8868\u7eff\u8272\uff0c'red'\u4ee3\u8868\u7ea2\u8272\uff0c'cyan'\u4ee3\u8868\u9752\u8272\uff0c'magenta'\u4ee3\u8868\u6d0b\u7ea2\u8272\uff0c'yellow'\u4ee3\u8868\u9ec4\u8272\uff0c'black'\u4ee3\u8868\u9ed1\u8272\uff0c'white'\u4ee3\u8868\u767d\u8272\u3002</p> </li> </ol> <p>\u53e6\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528alpha\u53c2\u6570\u6765\u6307\u5b9a\u7ebf\u6761\u7684\u900f\u660e\u5ea6\uff0c\u53d6\u503c\u8303\u56f4\u662f0\u52301\uff0c\u5176\u4e2d0\u8868\u793a\u5b8c\u5168\u900f\u660e\uff0c1\u8868\u793a\u5b8c\u5168\u4e0d\u900f\u660e\u3002</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/matplotlib/matplotlib/#linestyle","title":"\u7ebf\u6761\u79cd\u7c7b(linestyle)","text":"\u7ebf\u578b \u63cf\u8ff0 : ------ : : -------------- : '-' \u5b9e\u7ebf '--' \u865a\u7ebf '-.' \u70b9\u5212\u7ebf ':' \u70b9\u7ebf 'None' \u65e0\u7ebf ' ' \u65e0\u7ebf '' \u65e0\u7ebf '.' \u70b9\u6807\u8bb0 ',' \u50cf\u7d20\u6807\u8bb0 'o' \u5706\u5f62\u6807\u8bb0 'v' \u671d\u4e0b\u4e09\u89d2\u5f62\u6807\u8bb0 '^' \u671d\u4e0a\u4e09\u89d2\u5f62\u6807\u8bb0 '&lt;' \u671d\u5de6\u4e09\u89d2\u5f62\u6807\u8bb0 '&gt;' \u671d\u53f3\u4e09\u89d2\u5f62\u6807\u8bb0 '1' \u5012\u4e09\u89d2\u5f62\u6807\u8bb0 '2' \u6b63\u4e09\u89d2\u5f62\u6807\u8bb0 '3' \u5de6\u4e09\u89d2\u5f62\u6807\u8bb0 '4' \u53f3\u4e09\u89d2\u5f62\u6807\u8bb0 's' \u6b63\u65b9\u5f62\u6807\u8bb0 'p' \u4e94\u8fb9\u5f62\u6807\u8bb0 '*' \u661f\u5f62\u6807\u8bb0 'h' \u516d\u8fb9\u5f621\u6807\u8bb0 'H' \u516d\u8fb9\u5f622\u6807\u8bb0 '+' \u52a0\u53f7\u6807\u8bb0 'x' X\u5f62\u6807\u8bb0 'D' \u83f1\u5f62\u6807\u8bb0 'd' \u7ec6\u83f1\u5f62\u6807\u8bb0 '|' \u5782\u76f4\u7ebf\u6807\u8bb0 '_' \u6c34\u5e73\u7ebf\u6807\u8bb0"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/matplotlib/matplotlib/#_2","title":"\u7ebf\u6761\u4f4d\u7f6e","text":"<p>\u5728matplotlib\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u7ebf\u6761\u7684\u4f4d\u7f6e\u6765\u63a7\u5236\u7ebf\u6761\u5728\u56fe\u4e2d\u7684\u4f4d\u7f6e\u3002</p> <p>\u5177\u4f53\u7684\u65b9\u6cd5\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ol> <li> <p>\u4f7f\u7528<code>axhline()</code>\u548c<code>axvline()</code>\u51fd\u6570\u7ed8\u5236\u6c34\u5e73\u7ebf\u548c\u5782\u76f4\u7ebf\u3002\u8fd9\u4e9b\u51fd\u6570\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570<code>y</code>\u6216<code>x</code>\uff0c\u7528\u4e8e\u6307\u5b9a\u7ebf\u6761\u7684\u4f4d\u7f6e\u3002\u4f8b\u5982\uff0c<code>axhline(y=0.5)</code>\u8868\u793a\u7ed8\u5236\u4e00\u6761\u4f4d\u4e8ey\u8f740.5\u4f4d\u7f6e\u7684\u6c34\u5e73\u7ebf\u3002</p> </li> <li> <p>\u4f7f\u7528<code>ax.axline()</code>\u51fd\u6570\u7ed8\u5236\u76f4\u7ebf\u3002\u8be5\u51fd\u6570\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570<code>slope</code>\u548c<code>intercept</code>\uff0c\u7528\u4e8e\u6307\u5b9a\u76f4\u7ebf\u7684\u659c\u7387\u548c\u622a\u8ddd\u3002\u4f8b\u5982\uff0c<code>ax.axline(slope=0.5, intercept=0.2)</code>\u8868\u793a\u7ed8\u5236\u4e00\u6761\u659c\u7387\u4e3a0.5\uff0c\u622a\u8ddd\u4e3a0.2\u7684\u76f4\u7ebf\u3002</p> </li> <li> <p>\u4f7f\u7528<code>ax.plot()</code>\u51fd\u6570\u7ed8\u5236\u66f2\u7ebf\u3002\u5728\u7ed8\u5236\u66f2\u7ebf\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u8c03\u6574\u66f2\u7ebf\u6570\u636e\u7684\u4f4d\u7f6e\u6765\u63a7\u5236\u7ebf\u6761\u7684\u4f4d\u7f6e\u3002\u4f8b\u5982\uff0c\u901a\u8fc7\u5c06y\u8f74\u7684\u6570\u636e\u5411\u4e0a\u6216\u5411\u4e0b\u5e73\u79fb\uff0c\u53ef\u4ee5\u6539\u53d8\u66f2\u7ebf\u5728\u56fe\u4e2d\u7684\u4f4d\u7f6e\u3002</p> </li> </ol> <p>\u591a\u4e2a\u5750\u6807\u7cfb-\u591a\u4e2a\u56fe</p> <pre><code># \u521b\u5efa\u7b2c\u4e00\u4e2a\u5750\u6807\u7cfb\uff0c\u5e76\u7ed8\u5236\u56fe\u5f62\nplt.subplot(2, 2, 1)  # \u521b\u5efa2\u884c2\u5217\u7684\u5750\u6807\u7cfb\uff0c\u9009\u62e9\u7b2c1\u4e2a\u5750\u6807\u7cfb\nplt.plot([1, 2, 3, 4], [1, 4, 9, 16])  # \u7ed8\u5236\u56fe\u5f62\n\n# \u521b\u5efa\u7b2c\u4e8c\u4e2a\u5750\u6807\u7cfb\uff0c\u5e76\u7ed8\u5236\u56fe\u5f62\nplt.subplot(2, 2, 2)  # \u521b\u5efa2\u884c2\u5217\u7684\u5750\u6807\u7cfb\uff0c\u9009\u62e9\u7b2c2\u4e2a\u5750\u6807\u7cfb\nplt.plot([1, 2, 3, 4], [1, 8, 27, 64])  # \u7ed8\u5236\u56fe\u5f62\n\n# \u521b\u5efa\u7b2c\u4e09\u4e2a\u5750\u6807\u7cfb\uff0c\u5e76\u7ed8\u5236\u56fe\u5f62\nplt.subplot(2, 2, 3)  # \u521b\u5efa2\u884c2\u5217\u7684\u5750\u6807\u7cfb\uff0c\u9009\u62e9\u7b2c3\u4e2a\u5750\u6807\u7cfb\nplt.plot([1, 2, 3, 4], [1, 10, 100, 1000])  # \u7ed8\u5236\u56fe\u5f62\n\n# \u521b\u5efa\u7b2c\u56db\u4e2a\u5750\u6807\u7cfb\uff0c\u5e76\u7ed8\u5236\u56fe\u5f62\nplt.subplot(2, 2, 4)  # \u521b\u5efa2\u884c2\u5217\u7684\u5750\u6807\u7cfb\uff0c\u9009\u62e9\u7b2c4\u4e2a\u5750\u6807\u7cfb\nplt.plot([1, 2, 3, 4], [1, 2, 3, 4])  # \u7ed8\u5236\u56fe\u5f62\n\n# \u663e\u793a\u56fe\u5f62\nplt.show()\n</code></pre> <p></p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/matplotlib/matplotlib/#_3","title":"\u7ed8\u5236\u4e0d\u540c\u7c7b\u578b\u7684\u56fe\u50cf","text":"<ol> <li>plot(): \u7ed8\u5236==\u7ebf\u578b==\u56fe\uff0c\u53ef\u4ee5\u7528\u6765\u7ed8\u5236\u6298\u7ebf\u56fe\u3001\u66f2\u7ebf\u56fe\u7b49\u3002</li> <li>scatter(): \u7ed8\u5236==\u6563\u70b9==\u56fe\uff0c\u53ef\u4ee5\u7528\u6765\u5c55\u793a\u4e24\u4e2a\u53d8\u91cf\u4e4b\u95f4\u7684\u5173\u7cfb\u3002</li> <li>bar(): \u7ed8\u5236\u6761\u5f62\u56fe\uff0c\u53ef\u4ee5\u7528\u6765\u6bd4\u8f83\u4e0d\u540c\u7c7b\u522b\u6216\u4e0d\u540c\u65f6\u95f4\u70b9\u7684\u6570\u636e\u3002</li> <li>hist(): \u7ed8\u5236\u76f4\u65b9\u56fe\uff0c\u53ef\u4ee5\u7528\u6765\u5c55\u793a\u6570\u636e\u7684\u5206\u5e03\u60c5\u51b5\u3002</li> <li>boxplot(): \u7ed8\u5236\u7bb1\u7ebf\u56fe\uff0c\u53ef\u4ee5\u7528\u6765\u5c55\u793a\u6570\u636e\u7684\u4e2d\u4f4d\u6570\u3001\u56db\u5206\u4f4d\u6570\u7b49\u7edf\u8ba1\u4fe1\u606f\u3002</li> <li>pie(): \u7ed8\u5236\u997c\u56fe\uff0c\u53ef\u4ee5\u7528\u6765\u5c55\u793a\u6570\u636e\u7684\u5360\u6bd4\u60c5\u51b5\u3002</li> <li>heatmap(): \u7ed8\u5236\u70ed\u529b\u56fe\uff0c\u53ef\u4ee5\u7528\u6765\u5c55\u793a\u6570\u636e\u7684\u76f8\u5173\u6027\u6216\u5bc6\u5ea6\u5206\u5e03\u60c5\u51b5\u3002</li> <li>contour(): \u7ed8\u5236\u7b49\u9ad8\u7ebf\u56fe\uff0c\u53ef\u4ee5\u7528\u6765\u5c55\u793a\u4e8c\u7ef4\u6570\u636e\u7684\u7b49\u503c\u7ebf\u3002</li> <li>imshow(): \u7ed8\u5236\u56fe\u50cf\uff0c\u53ef\u4ee5\u7528\u6765\u5c55\u793a\u4e8c\u7ef4\u6570\u636e\u7684\u56fe\u50cf\u3002</li> <li>subplot(): \u7ed8\u5236\u591a\u4e2a\u5b50\u56fe\uff0c\u53ef\u4ee5\u5728\u4e00\u4e2a\u56fe\u4e2d\u540c\u65f6\u5c55\u793a\u591a\u4e2a\u56fe\u5f62\u3002</li> </ol>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/matplotlib/matplotlib/#_4","title":"\u5b9e\u65f6\u66f4\u65b0\u7684\u56fe\u50cf","text":"<p>Todo:</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/seaborn/seaborn/","title":"seaborn","text":"<p>\u5bfc\u5165 <pre><code>import seaborn as sns\n</code></pre></p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/seaborn/seaborn/#_1","title":"\u5355\u53d8\u91cf\u5206\u5e03","text":"<p>Seaborn\u7ed8\u5236\u5355\u53d8\u91cf\u5206\u5e03\u56fe\u7684\u4e00\u822c\u6b65\u9aa4\uff1a</p> <ol> <li>\u5bfc\u5165\u9700\u8981\u7684\u5e93\u548c\u6570\u636e\u3002\u9996\u5148\uff0c\u786e\u4fdd\u5df2\u7ecf\u5b89\u88c5\u4e86Seaborn\u548c\u5176\u4ed6\u5fc5\u8981\u7684\u5e93\uff0c\u5982numpy\u548cpandas\u3002\u7136\u540e\uff0c\u5bfc\u5165\u9700\u8981\u53ef\u89c6\u5316\u7684\u6570\u636e\u3002</li> </ol> <pre><code>import seaborn as sns\nimport numpy as np\nimport pandas as pd\n\n# \u5bfc\u5165\u6570\u636e\ndata = pd.read_csv('data.csv')\n</code></pre> <ol> <li> <p>\u9009\u62e9\u5408\u9002\u7684\u5355\u53d8\u91cf\u5206\u5e03\u56fe\u3002Seaborn\u63d0\u4f9b\u4e86\u591a\u79cd\u5355\u53d8\u91cf\u5206\u5e03\u56fe\u7684\u65b9\u6cd5\uff0c\u5305\u62ec\u76f4\u65b9\u56fe\uff08distplot\uff09\u3001\u6838\u5bc6\u5ea6\u4f30\u8ba1\u56fe\uff08kdeplot\uff09\u3001\u7bb1\u7ebf\u56fe\uff08boxplot\uff09\u7b49\u3002\u6839\u636e\u6570\u636e\u7c7b\u578b\u548c\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u56fe\u8868\u3002</p> </li> <li> <p>\u7ed8\u5236\u56fe\u8868\u3002\u4f7f\u7528\u9009\u62e9\u7684\u56fe\u8868\u65b9\u6cd5\uff0c\u4f20\u5165\u9700\u8981\u53ef\u89c6\u5316\u7684\u6570\u636e\u5373\u53ef\u7ed8\u5236\u5355\u53d8\u91cf\u5206\u5e03\u56fe\u3002</p> </li> </ol> <pre><code># \u7ed8\u5236\u76f4\u65b9\u56fe\nsns.distplot(data['column_name'])\n\n# \u7ed8\u5236\u6838\u5bc6\u5ea6\u4f30\u8ba1\u56fe\nsns.kdeplot(data['column_name'])\n\n# \u7ed8\u5236\u7bb1\u7ebf\u56fe\nsns.boxplot(data['column_name'])\n</code></pre> <p></p> <ol> <li>\u6dfb\u52a0\u5176\u4ed6\u53c2\u6570\u3002\u6839\u636e\u9700\u8981\uff0c\u53ef\u4ee5\u6dfb\u52a0\u5176\u4ed6\u53c2\u6570\u6765\u8c03\u6574\u56fe\u8868\u7684\u6837\u5f0f\u548c\u663e\u793a\u6548\u679c\uff0c\u5982\u8bbe\u7f6e\u6807\u9898\u3001\u8c03\u6574\u56fe\u8868\u5927\u5c0f\u3001\u4fee\u6539\u989c\u8272\u7b49\u3002</li> </ol> <pre><code># \u8bbe\u7f6e\u6807\u9898\nplt.title('Title')\n\n# \u8c03\u6574\u56fe\u8868\u5927\u5c0f\nplt.figure(figsize=(8, 6))\n\n# \u4fee\u6539\u989c\u8272\nsns.distplot(data['column_name'], color='red')\n</code></pre>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/seaborn/seaborn/#_2","title":"\u53cc\u53d8\u91cf\u5206\u5e03","text":"<p>seaborn\u7ed8\u5236\u53cc\u53d8\u91cf\u5206\u5e03\uff0c\u53ef\u4ee5\u4f7f\u7528<code>jointplot</code>\u51fd\u6570\u3002<code>jointplot</code>\u51fd\u6570\u53ef\u4ee5\u7ed8\u5236\u53cc\u53d8\u91cf\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u5e76\u4e14\u53ef\u4ee5\u540c\u65f6\u663e\u793a\u4e24\u4e2a\u53d8\u91cf\u7684\u5355\u53d8\u91cf\u5206\u5e03\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7ed8\u5236\u53cc\u53d8\u91cf\u5206\u5e03\u7684\u793a\u4f8b\u4ee3\u7801\uff1a</p> <pre><code>import seaborn as sns\nimport matplotlib.pyplot as plt\n\n# \u52a0\u8f7d\u6570\u636e\ntips = sns.load_dataset(\"tips\")\n\n# \u7ed8\u5236\u53cc\u53d8\u91cf\u5206\u5e03\nsns.jointplot(x=\"total_bill\", y=\"tip\", data=tips)\n\n# \u663e\u793a\u56fe\u5f62\nplt.show()\n</code></pre> <p></p> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e86seaborn\u5185\u7f6e\u7684\u4e00\u4e2a\u540d\u4e3a\"tips\"\u7684\u6570\u636e\u96c6\uff0c\u8be5\u6570\u636e\u96c6\u5305\u542b\u4e86\u9910\u5385\u987e\u5ba2\u7684\u6d88\u8d39\u603b\u91d1\u989d\u548c\u7ed9\u4e88\u7684\u5c0f\u8d39\u91d1\u989d\u3002\u6211\u4eec\u4f7f\u7528<code>jointplot</code>\u51fd\u6570\u6765\u7ed8\u5236<code>total_bill</code>\u548c<code>tip</code>\u8fd9\u4e24\u4e2a\u53d8\u91cf\u4e4b\u95f4\u7684\u5173\u7cfb\u3002</p> <p>\u4f60\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e<code>kind</code>\u53c2\u6570\u6765\u9009\u62e9\u4e0d\u540c\u7684\u7ed8\u56fe\u7c7b\u578b\uff0c\u4f8b\u5982\u8bbe\u7f6e<code>kind=\"hex\"</code>\u53ef\u4ee5\u7ed8\u5236\u516d\u8fb9\u5f62\u70ed\u529b\u56fe\u3002\u4f8b\u5982\uff1a</p> <pre><code>sns.jointplot(x=\"total_bill\", y=\"tip\", data=tips, kind=\"hex\")\n</code></pre> <p></p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/sklearn/sklearn%20%E5%85%A5%E9%97%A8/","title":"Sklearn \u5165\u95e8","text":"<ol> <li>\u5bfc\u5165\u5fc5\u8981\u7684\u5e93\u548c\u6a21\u5757\uff1a</li> </ol> <pre><code>import numpy as np\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error\n</code></pre> <ol> <li> <p>\u83b7\u53d6\u548c\u51c6\u5907\u6570\u636e\uff1a    \u5728\u5f00\u59cb\u5efa\u6a21\u4e4b\u524d\uff0c\u9700\u8981\u6709\u4e00\u4e2a\u6570\u636e\u96c6\u3002scikit-learn\u652f\u6301\u591a\u79cd\u6570\u636e\u683c\u5f0f\uff0c\u5305\u62ecNumPy\u6570\u7ec4\u3001Pandas\u6570\u636e\u6846\u3001CSV\u6587\u4ef6\u7b49\u3002\u786e\u4fdd\u6570\u636e\u5df2\u7ecf\u51c6\u5907\u597d\u5e76\u52a0\u8f7d\u5230\u9002\u5f53\u7684\u6570\u636e\u7ed3\u6784\u4e2d\u3002</p> </li> <li> <p>\u5212\u5206\u6570\u636e\u96c6\uff1a    \u901a\u5e38\uff0c\u4f60\u9700\u8981\u5c06\u6570\u636e\u96c6\u5212\u5206\u4e3a\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6\uff0c\u4ee5\u4fbf\u5728\u6a21\u578b\u8bad\u7ec3\u548c\u8bc4\u4f30\u4e2d\u4f7f\u7528\u4e0d\u540c\u7684\u6570\u636e\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528<code>train_test_split</code>\u51fd\u6570\u6765\u5b9e\u73b0\u8fd9\u4e00\u70b9\u3002</p> </li> </ol> <pre><code>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n</code></pre> <p>\u8fd9\u5c06\u6570\u636e\u5212\u5206\u4e3a80%\u7684\u8bad\u7ec3\u6570\u636e\u548c20%\u7684\u6d4b\u8bd5\u6570\u636e\u3002</p> <ol> <li>\u9009\u62e9\u6a21\u578b\uff1a    \u9009\u62e9\u9002\u5f53\u7684\u6a21\u578b\u6765\u89e3\u51b3\u4f60\u7684\u95ee\u9898\u3002\u5728scikit-learn\u4e2d\uff0c\u6709\u5404\u79cd\u5404\u6837\u7684\u6a21\u578b\uff0c\u5305\u62ec\u7ebf\u6027\u56de\u5f52\u3001\u51b3\u7b56\u6811\u3001\u968f\u673a\u68ee\u6797\u3001\u652f\u6301\u5411\u91cf\u673a\u7b49\u3002</li> </ol> <p>\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u8981\u89e3\u51b3\u4e00\u4e2a\u56de\u5f52\u95ee\u9898\uff0c\u53ef\u4ee5\u9009\u62e9\u7ebf\u6027\u56de\u5f52\u6a21\u578b\uff1a</p> <pre><code>model = LinearRegression()\n</code></pre> <ol> <li>\u8bad\u7ec3\u6a21\u578b\uff1a    \u4f7f\u7528\u8bad\u7ec3\u6570\u636e\u6765\u8bad\u7ec3\u4f60\u7684\u6a21\u578b\u3002</li> </ol> <pre><code>model.fit(X_train, y_train)\n</code></pre> <ol> <li>\u8fdb\u884c\u9884\u6d4b\uff1a    \u4f7f\u7528\u8bad\u7ec3\u597d\u7684\u6a21\u578b\u5bf9\u6d4b\u8bd5\u6570\u636e\u8fdb\u884c\u9884\u6d4b\u3002</li> </ol> <pre><code>y_pred = model.predict(X_test)\n</code></pre> <ol> <li>\u8bc4\u4f30\u6a21\u578b\uff1a    \u4f7f\u7528\u5408\u9002\u7684\u8bc4\u4f30\u6307\u6807\u6765\u8bc4\u4f30\u6a21\u578b\u7684\u6027\u80fd\u3002\u4f8b\u5982\uff0c\u5728\u56de\u5f52\u95ee\u9898\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u5747\u65b9\u8bef\u5dee\uff08Mean Squared Error\uff09\u6765\u8861\u91cf\u6a21\u578b\u7684\u6027\u80fd\u3002</li> </ol> <pre><code>mse = mean_squared_error(y_test, y_pred)\nprint(\"Mean Squared Error:\", mse)\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e9bsklearn\u7684\u57fa\u672c\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <ol> <li> <p>\u5b89\u88c5sklearn\u5e93\uff1a\u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528<code>pip install scikit-learn</code>\u547d\u4ee4\u8fdb\u884c\u5b89\u88c5\u3002</p> </li> <li> <p>\u5bfc\u5165sklearn\u6a21\u5757\uff1a\u901a\u5e38\uff0c\u6211\u4eec\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u5bfc\u5165sklearn\u7684\u76f8\u5173\u6a21\u5757\uff1a</p> </li> </ol> <pre><code>import sklearn\nfrom sklearn import \u6a21\u5757\u540d\n</code></pre> <ol> <li>\u52a0\u8f7d\u6570\u636e\u96c6\uff1asklearn\u63d0\u4f9b\u4e86\u5f88\u591a\u5e38\u7528\u7684\u6570\u636e\u96c6\uff0c\u53ef\u4ee5\u4f7f\u7528<code>datasets</code>\u6a21\u5757\u6765\u52a0\u8f7d\u6570\u636e\u96c6\u3002\u4f8b\u5982\uff0c\u52a0\u8f7dIris\u6570\u636e\u96c6\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</li> </ol> <p><code>python from sklearn import datasets iris = datasets.load_iris()</code></p> <ol> <li>\u5212\u5206\u6570\u636e\u96c6\uff1a\u901a\u5e38\uff0c\u6211\u4eec\u9700\u8981\u5c06\u6570\u636e\u96c6\u5212\u5206\u4e3a\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6\uff0c\u4ee5\u4fbf\u8bc4\u4f30\u6a21\u578b\u7684\u6027\u80fd\u3002\u53ef\u4ee5\u4f7f\u7528<code>model_selection</code>\u6a21\u5757\u7684<code>train_test_split</code>\u51fd\u6570\u6765\u5b9e\u73b0\u3002\u4f8b\u5982\uff0c\u5c06\u6570\u636e\u96c6\u5212\u5206\u4e3a\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</li> </ol> <p><code>python from sklearn.model_selection import train_test_split X_train, X_test, y_train, y_test = train_test_split(iris.data, iris.target, test_size=0.2, random_state=42)</code></p> <ol> <li>\u521b\u5efa\u6a21\u578b\uff1a\u6839\u636e\u4efb\u52a1\u7684\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u673a\u5668\u5b66\u4e60\u6a21\u578b\uff0c\u5e76\u521b\u5efa\u6a21\u578b\u5bf9\u8c61\u3002\u4f8b\u5982\uff0c\u521b\u5efa\u4e00\u4e2a\u652f\u6301\u5411\u91cf\u673a\uff08SVM\uff09\u5206\u7c7b\u6a21\u578b\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</li> </ol> <p><code>python from sklearn import svm clf = svm.SVC()</code></p> <ol> <li>\u8bad\u7ec3\u6a21\u578b\uff1a\u4f7f\u7528\u8bad\u7ec3\u6570\u636e\u96c6\u8bad\u7ec3\u6a21\u578b\u3002\u53ef\u4ee5\u4f7f\u7528\u6a21\u578b\u5bf9\u8c61\u7684<code>fit</code>\u65b9\u6cd5\u6765\u5b9e\u73b0\u3002\u4f8b\u5982\uff0c\u8bad\u7ec3SVM\u6a21\u578b\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</li> </ol> <p><code>python clf.fit(X_train, y_train)</code></p> <ol> <li>\u9884\u6d4b\uff1a\u4f7f\u7528\u8bad\u7ec3\u597d\u7684\u6a21\u578b\u5bf9\u65b0\u6837\u672c\u8fdb\u884c\u9884\u6d4b\u3002\u53ef\u4ee5\u4f7f\u7528\u6a21\u578b\u5bf9\u8c61\u7684<code>predict</code>\u65b9\u6cd5\u6765\u5b9e\u73b0\u3002\u4f8b\u5982\uff0c\u5bf9\u6d4b\u8bd5\u96c6\u8fdb\u884c\u9884\u6d4b\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</li> </ol> <p><code>python y_pred = clf.predict(X_test)</code></p> <ol> <li>\u8bc4\u4f30\u6a21\u578b\uff1a\u4f7f\u7528\u8bc4\u4f30\u6307\u6807\u6765\u8bc4\u4f30\u6a21\u578b\u7684\u6027\u80fd\u3002sklearn\u63d0\u4f9b\u4e86\u5f88\u591a\u8bc4\u4f30\u6307\u6807\uff0c\u4f8b\u5982\u51c6\u786e\u7387\u3001\u7cbe\u786e\u7387\u3001\u53ec\u56de\u7387\u7b49\u3002\u4f8b\u5982\uff0c\u8ba1\u7b97\u6a21\u578b\u51c6\u786e\u7387\u7684\u4ee3\u7801\u5982\u4e0b\uff1a</li> </ol> <p><code>python from sklearn import metrics accuracy = metrics.accuracy_score(y_test, y_pred)</code></p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/sklearn/sklearn%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81/","title":"SKlearn \u5e38\u7528\u4ee3\u7801","text":"<p>Examples \u2014 scikit-learn</p> <p>User guide: contents \u2014 scikit-learn documentation</p>"},{"location":"AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E5%B8%B8%E7%94%A8%E5%BA%93/sklearn/sklearn%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%A0%81/#_1","title":"\u7ebf\u6027\u6a21\u578b","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Code-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/","title":"Code-\u4eba\u5de5\u667a\u80fd","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Code-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/#python","title":"\u4eba\u5de5\u667a\u80fd #\u6df1\u5ea6\u5b66\u4e60 #\u673a\u5668\u5b66\u4e60 #python","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Code-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/#_1","title":"\u6df1\u5ea6\u5b66\u4e60","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Code-%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/#pytorch","title":"Pytorch\u57fa\u7840\u8bad\u7ec3","text":"<p>\u7ebf\u6027\u56de\u5f52</p> <pre><code>import torch\nimport torch.nn as nn\n\n# \u5b9a\u4e49\u4e00\u4e2a\u7b80\u5355\u7684\u795e\u7ecf\u7f51\u7edc\u6a21\u578b\nclass NeuralNetwork(nn.Module):\n    def __init__(self):\n        super(NeuralNetwork, self).__init__()\n        self.linear = nn.Linear(2, 1)  # \u8f93\u5165\u7ef4\u5ea6\u4e3a2\uff0c\u8f93\u51fa\u7ef4\u5ea6\u4e3a1\n\n    def forward(self, x):\n        return self.linear(x)  # \u7ebf\u6027\u6620\u5c04\n\n# \u521b\u5efa\u4e00\u4e2a\u8f93\u5165\u5f20\u91cf\nx = torch.tensor([[1.0, 2.0], [3.0, 4.0]])\n\n# \u521b\u5efa\u795e\u7ecf\u7f51\u7edc\u6a21\u578b\u5b9e\u4f8b\nmodel = NeuralNetwork()\n\n# \u521b\u5efa\u4e00\u4e2a\u76ee\u6807\u5f20\u91cf\ntarget = torch.tensor([[0.0], [1.0]])\n\n# \u5b9a\u4e49\u635f\u5931\u51fd\u6570\nloss_fn = nn.MSELoss() # \u5747\u65b9\u8bef\u5dee\n\n# \u5b9a\u4e49\u4f18\u5316\u5668\noptimizer = torch.optim.SGD(model.parameters(), lr=0.01)\n\n# \u8fdb\u884c\u8bad\u7ec3\nfor epoch in range(100):\n    # \u6e05\u96f6\u6a21\u578b\u7684\u68af\u5ea6\n    optimizer.zero_grad()\n\n    # \u8fdb\u884c\u524d\u5411\u4f20\u64ad\n    output = model(x)\n\n    # \u8ba1\u7b97\u635f\u5931\n    loss = loss_fn(output, target)\n\n    # \u8fdb\u884c\u53cd\u5411\u4f20\u64ad\n    loss.backward()\n\n    # \u66f4\u65b0\u6a21\u578b\u53c2\u6570\n    optimizer.step()\n\n    # \u6bcf\u969410\u4e2aepoch\u6253\u5370\u4e00\u6b21\u8bad\u7ec3\u4fe1\u606f\n    if (epoch+1) % 10 == 0:\n        print('Epoch [{}/{}], Loss: {:.4f}'.format(epoch+1, 100, loss.item()))\n</code></pre> <p>\u8fd9\u6bb5\u8bad\u7ec3\u4ee3\u7801\u4f1a\u8fdb\u884c100\u4e2aepoch\u7684\u8bad\u7ec3\uff0c\u5e76\u6253\u5370\u6bcf\u4e2aepoch\u7684\u635f\u5931\u503c\u3002\u5728\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff0c\u9996\u5148\u6e05\u96f6\u6a21\u578b\u7684\u68af\u5ea6\uff0c\u7136\u540e\u8fdb\u884c\u524d\u5411\u4f20\u64ad\u548c\u635f\u5931\u8ba1\u7b97\uff0c\u63a5\u7740\u8fdb\u884c\u53cd\u5411\u4f20\u64ad\u548c\u53c2\u6570\u66f4\u65b0\uff0c\u6700\u540e\u6253\u5370\u8bad\u7ec3\u4fe1\u606f\u3002</p> <pre><code># \u4f7f\u7528\u8bad\u7ec3\u597d\u7684\u6a21\u578b\u8fdb\u884c\u9884\u6d4b\npredicted = model(x).detach()\n\n# \u6253\u5370\u9884\u6d4b\u503c\nprint(f'predicted: \\n{predicted}')\nprint(f'target: \\n{target}')\n</code></pre> <p>\u4e3a\u8fd9\u4e2a\u7ed3\u679c\u7ed8\u56fe</p> <pre><code>import matplotlib.pyplot as plt\nimport numpy as np\n\n# \u8f6c\u4e3anumpy\u683c\u5f0f\npredicted = predicted.numpy()\ntarget = target.numpy()\n\n# \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u56fe\u5f62\nplt.figure()\n\n# \u7ed8\u5236\u9884\u6d4b\u503c\u548c\u76ee\u6807\u503c\u7684\u56fe\u8868\nplt.plot(predicted,label = 'line predicted')\nplt.plot(target,label = 'line target')\nplt.legend(loc = 'upper left')\nplt.show()\n</code></pre> <p></p> <p>\u5982\u4f55\u4f7f\u7528matplotlib\uff0c\u53c2\u89c1Python-matplotlib\u753b\u56fe</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/","title":"Pytorch \u4f7f\u7528","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#tensor","title":"Tensor \u57fa\u7840\u64cd\u4f5c","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_1","title":"\u4eba\u5de5\u667a\u80fd","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_2","title":"\u58f0\u660e\u548c\u5b9a\u4e49","text":"<p>\u9996\u5148\u662f\u5bf9 Tensors \u7684\u58f0\u660e\u548c\u5b9a\u4e49\u65b9\u6cd5\uff0c\u5206\u522b\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li> <p><code>torch.empty()</code>: \u58f0\u660e\u4e00\u4e2a\u672a\u521d\u59cb\u5316\u7684\u77e9\u9635\u3002 <pre><code>import torch\n# \u521b\u5efa\u4e00\u4e2a 5*3 \u7684\u77e9\u9635\nx = torch.empty(5, 3)\nprint(x)\n\n\ntensor([[2.0535e-19, 4.5080e+21, 1.8389e+25],\n        [3.4589e-12, 1.7743e+28, 2.0535e-19],\n        [1.4609e-19, 1.8888e+31, 9.8830e+17],\n        [4.4653e+30, 3.4593e-12, 7.4086e+28],\n        [2.6762e+20, 1.7104e+25, 1.8179e+31]])\n</code></pre></p> </li> <li> <p><code>torch.rand()</code>\uff1a\u968f\u673a\u521d\u59cb\u5316\u4e00\u4e2a\u77e9\u9635</p> </li> </ul> <pre><code># \u521b\u5efa\u4e00\u4e2a\u968f\u673a\u521d\u59cb\u5316\u7684 5*3 \u77e9\u9635\nrand_x = torch.rand(5, 3)\nprint(rand_x)\n\ntensor([[0.1919, 0.9713, 0.4248],\n        [0.5571, 0.5543, 0.6414],\n        [0.4645, 0.4026, 0.3857],\n        [0.1988, 0.2936, 0.1322],\n        [0.8525, 0.1780, 0.2909]])\n</code></pre> <ul> <li><code>torch.zeros()</code>\uff1a\u521b\u5efa\u6570\u503c\u7686\u4e3a 0 \u7684\u77e9\u9635\uff0c\u7c7b\u4f3c\u7684\u4e5f\u53ef\u4ee5\u521b\u5efa\u6570\u503c\u90fd\u662f 1 \u7684\u77e9\u9635\uff0c\u8c03\u7528\u00a0<code>torch.one</code> <pre><code># \u521b\u5efa\u4e00\u4e2a\u6570\u503c\u7686\u662f 0\uff0c\u7c7b\u578b\u4e3a long \u7684\u77e9\u9635\nzero_x = torch.zeros(5, 3, dtype=torch.long)\nprint(zero_x)\n</code></pre></li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_3","title":"\u7f51\u7edc\u5c42","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_4","title":"\u7ebf\u6027\u56de\u5f52","text":"<p>\u7ebf\u6027\u56de\u5f52</p> <p>Pytorch\u57fa\u7840\u8bad\u7ec3</p> <pre><code># \u8f93\u5165\u7279\u5f81x\u548c\u76ee\u6807\u503cy\nx = torch.tensor([[1.0], [2.0], [3.0], [4.0]])\ny = torch.tensor([[2.0], [4.0], [6.0], [8.0]])\n</code></pre> <p>\u5b9a\u4e49\u6a21\u578b\uff1a</p> <pre><code>class LinearRegression(nn.Module):\n    def __init__(self, input_dim, output_dim):\n        super(LinearRegression, self).__init__()\n        self.linear = nn.Linear(input_dim, output_dim)\n\n    def forward(self, x):\n        return self.linear(x)\n\n# \u6a21\u578b\u5b9e\u4f8b\u5316\nmodel = LinearRegression(1, 1)\n</code></pre>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#softmax","title":"softmax","text":"<p>softmax</p> <p>\u5728PyTorch\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528torch.nn.functional.softmax\u51fd\u6570\u6765\u8fdb\u884csoftmax\u64cd\u4f5c\u3002softmax\u51fd\u6570\u5c06\u4e00\u4e2a\u5411\u91cf\u6620\u5c04\u6210\u4e00\u4e2a\u6982\u7387\u5206\u5e03\uff0c\u4f7f\u5f97\u5411\u91cf\u4e2d\u7684\u5143\u7d20\u90fd\u5904\u4e8e0\u548c1\u4e4b\u95f4\uff0c\u5e76\u4e14\u6240\u6709\u5143\u7d20\u7684\u548c\u7b49\u4e8e1\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u4f7f\u7528PyTorch\u7684softmax\u51fd\u6570\u7684\u793a\u4f8b\u4ee3\u7801\uff1a</p> <pre><code>import torch\nimport torch.nn.functional as F\n\n# \u8f93\u5165\u5411\u91cf\nx = torch.tensor([1.0, 2.0, 3.0])\n\n# \u4f7f\u7528softmax\u51fd\u6570\noutput = F.softmax(x, dim=0)\n\nprint(output)\n</code></pre> <p>\u5728\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u521b\u5efa\u4e86\u4e00\u4e2a\u8f93\u5165\u5411\u91cfx\u3002\u7136\u540e\u901a\u8fc7\u8c03\u7528F.softmax\u51fd\u6570\u6765\u5bf9\u8f93\u5165\u5411\u91cf\u8fdb\u884csoftmax\u64cd\u4f5c\u3002dim\u53c2\u6570\u6307\u5b9a\u4e86\u5728\u54ea\u4e2a\u7ef4\u5ea6\u4e0a\u8fdb\u884csoftmax\u64cd\u4f5c\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u5176\u8bbe\u7f6e\u4e3a0\uff0c\u8868\u793a\u5bf9\u5411\u91cf\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u8fdb\u884csoftmax\u64cd\u4f5c\u3002</p> <p>\u8fd0\u884c\u4e0a\u8ff0\u4ee3\u7801\uff0c\u5c06\u4f1a\u8f93\u51fasoftmax\u64cd\u4f5c\u540e\u7684\u7ed3\u679c\u3002\u7ed3\u679c\u662f\u4e00\u4e2a\u5305\u542b\u4e09\u4e2a\u5143\u7d20\u7684\u5411\u91cf\uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u4e00\u4e2a\u6982\u7387\u503c\uff0c\u4e14\u6240\u6709\u5143\u7d20\u7684\u548c\u7b49\u4e8e1\u3002</p> <p>\u6ce8\u610f\uff1a\u5728PyTorch\u4e2d\uff0ctorch.nn.functional.softmax\u51fd\u6570\u4f1a\u76f4\u63a5\u5bf9\u8f93\u5165\u8fdb\u884csoftmax\u64cd\u4f5c\uff0c\u5e76\u8fd4\u56desoftmax\u540e\u7684\u7ed3\u679c\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0ctorch.nn.Softmax\u6a21\u5757\u4f1a\u8fd4\u56de\u4e00\u4e2aSoftmax\u51fd\u6570\u7684\u5b9e\u4f8b\uff0c\u9700\u8981\u901a\u8fc7\u8c03\u7528\u8be5\u5b9e\u4f8b\u7684forward\u65b9\u6cd5\u6765\u8fdb\u884csoftmax\u64cd\u4f5c\u3002\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4f7f\u7528torch.nn.functional.softmax\u51fd\u6570\u5373\u53ef\u3002</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_5","title":"\u64cd\u4f5c","text":"<pre><code>\"\"\"\n\u51e0\u79cd\u52a0\u6cd5\u64cd\u4f5c\uff1a\n\"\"\"\ntensor3 = torch.ones(5, 3)\ntensor4 = torch.ones(5, 3)\n\nprint(tensor3 + tensor4)\n\nprint(torch.add(tensor3, tensor4))\n\n# \u65b0\u58f0\u660e\u4e00\u4e2a tensor \u53d8\u91cf\u4fdd\u5b58\u52a0\u6cd5\u64cd\u4f5c\u7684\u7ed3\u679c\nresult = torch.empty(5, 3)\n\ntorch.add(tensor3, tensor4, out=result)\nprint(tensor3)\n# \u76f4\u63a5\u4fee\u6539\u53d8\u91cf\ntensor3.add_(tensor4)\nprint(tensor3)\n</code></pre> <pre><code>tensor([[2., 2., 2.],\n        [2., 2., 2.],\n        [2., 2., 2.],\n        [2., 2., 2.],\n        [2., 2., 2.]])\ntensor([[2., 2., 2.],\n        [2., 2., 2.],\n        [2., 2., 2.],\n        [2., 2., 2.],\n        [2., 2., 2.]])\ntensor([[1., 1., 1.],\n        [1., 1., 1.],\n        [1., 1., 1.],\n        [1., 1., 1.],\n        [1., 1., 1.]])\ntensor([[2., 2., 2.],\n        [2., 2., 2.],\n        [2., 2., 2.],\n        [2., 2., 2.],\n        [2., 2., 2.]])\n</code></pre> <pre><code>\"\"\"\n\u4fee\u6539\u5c3a\u5bf8\n\"\"\"\nx = torch.randn(4, 4)\ny = x.view(16)\n# -1 \u8868\u793a\u9664\u7ed9\u5b9a\u7ef4\u5ea6\u5916\u7684\u5176\u4f59\u7ef4\u5ea6\u7684\u4e58\u79ef\nz = x.view(-1, 8)\nprint(x.size(), y.size(), z.size())\nprint(x)\nprint(y)\nprint(z)\n</code></pre> <pre><code>torch.Size([4, 4]) torch.Size([16]) torch.Size([2, 8])\ntensor([[-1.9878, -1.0786,  1.5617, -1.9625],\n        [ 1.1109, -1.3799, -0.0208, -0.1064],\n        [-1.5209, -0.4669, -0.5131, -0.9680],\n        [ 1.2179, -0.4595,  0.0947,  0.5684]])\ntensor([-1.9878, -1.0786,  1.5617, -1.9625,  1.1109, -1.3799, -0.0208, -0.1064,\n        -1.5209, -0.4669, -0.5131, -0.9680,  1.2179, -0.4595,  0.0947,  0.5684])\ntensor([[-1.9878, -1.0786,  1.5617, -1.9625,  1.1109, -1.3799, -0.0208, -0.1064],\n        [-1.5209, -0.4669, -0.5131, -0.9680,  1.2179, -0.4595,  0.0947,  0.5684]])\n</code></pre> <pre><code>\"\"\"\n\u548c Numpy \u6570\u7ec4\u7684\u8f6c\u6362\n\"\"\"\nimport numpy as np\n# Tensor \u8f6c\u6362\u4e3a Numpy \u6570\u7ec4\na = torch.ones(5)\n# \u5171\u4eab\u5185\u5b58\nb = a.numpy()\n# \u65b0\u5efa\u53d8\u91cf\nc = np.array(a)\nprint(type(b))\nprint(type(c))\n#  Numpy \u6570\u7ec4\u8f6c\u6362\u4e3a Tensor\n\na = np.ones(5)\nb = torch.from_numpy(a)\nprint(type(a))\nprint(type(b))\n</code></pre> <pre><code>&lt;class 'numpy.ndarray'&gt;\n&lt;class 'numpy.ndarray'&gt;\n&lt;class 'numpy.ndarray'&gt;\n&lt;class 'torch.Tensor'&gt;\n</code></pre>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_6","title":"\u8ba1\u7b97","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_7","title":"\u968f\u673a\u51fd\u6570","text":"<p>\u968f\u673a\u51fd\u6570\u7684\u793a\u4f8b\uff1a</p> <ol> <li> <p>\u751f\u6210\u968f\u673a\u6574\u6570\uff1a <pre><code>import torch\nrandom_int = torch.randint(low=0, high=10, size=(5,))\nprint(random_int)\n</code></pre> \u8f93\u51fa\u793a\u4f8b\uff1atensor([7, 5, 1, 9, 7])</p> </li> <li> <p>\u751f\u6210\u968f\u673a\u6d6e\u70b9\u6570\uff1a <pre><code>import torch\nrandom_float = torch.rand(size=(3, 2))\nprint(random_float)\n</code></pre> \u8f93\u51fa\u793a\u4f8b\uff1atensor([[0.3551, 0.5042],         [0.3932, 0.6807],         [0.2734, 0.1050]])</p> </li> <li> <p>\u751f\u6210\u670d\u4ece\u6b63\u6001\u5206\u5e03\u7684\u968f\u673a\u6570\uff1a <pre><code>import torch\nrandom_normal = torch.randn(size=(2, 3))\nprint(random_normal)\n</code></pre> \u8f93\u51fa\u793a\u4f8b\uff1atensor([[ 0.2323, -0.2769, -0.1031],         [ 1.2114,  1.2016,  0.1766]])</p> </li> </ol>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#autograd","title":"autograd \u81ea\u52a8\u6c42\u5bfc","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_8","title":"\u524d\u5411\u4f20\u64ad\u548c\u53cd\u5411\u4f20\u64ad","text":"<p>\u4f7f\u7528Torch\u8fdb\u884c\u524d\u5411\u4f20\u64ad\u548c\u53cd\u5411\u4f20\u64ad\u7684\u793a\u4f8b\u4ee3\u7801\uff1a</p> <pre><code>import torch\nimport torch.nn as nn\n\n# \u5b9a\u4e49\u4e00\u4e2a\u7b80\u5355\u7684\u795e\u7ecf\u7f51\u7edc\u6a21\u578b\nclass NeuralNetwork(nn.Module):\n    def __init__(self):\n        super(NeuralNetwork, self).__init__()\n        self.linear = nn.Linear(2, 1)  # \u8f93\u5165\u7ef4\u5ea6\u4e3a2\uff0c\u8f93\u51fa\u7ef4\u5ea6\u4e3a1\n\n    def forward(self, x):\n        return self.linear(x)  # \u7ebf\u6027\u6620\u5c04\n\n# \u521b\u5efa\u4e00\u4e2a\u8f93\u5165\u5f20\u91cf\nx = torch.tensor([[1.0, 2.0], [3.0, 4.0]])\n\n# \u521b\u5efa\u795e\u7ecf\u7f51\u7edc\u6a21\u578b\u5b9e\u4f8b\nmodel = NeuralNetwork()\n\n# \u8fdb\u884c\u524d\u5411\u4f20\u64ad\noutput = model(x)\n\n# \u6253\u5370\u524d\u5411\u4f20\u64ad\u7684\u7ed3\u679c\nprint(output)\n\n# \u521b\u5efa\u4e00\u4e2a\u76ee\u6807\u5f20\u91cf\ntarget = torch.tensor([[0.0], [1.0]])\n\n# \u5b9a\u4e49\u635f\u5931\u51fd\u6570\nloss_fn = nn.MSELoss()\n\n# \u8ba1\u7b97\u635f\u5931\nloss = loss_fn(output, target)\n\n# \u6253\u5370\u635f\u5931\u503c\nprint(loss)\n\n# \u6e05\u96f6\u6a21\u578b\u7684\u68af\u5ea6\nmodel.zero_grad()\n\n# \u8fdb\u884c\u53cd\u5411\u4f20\u64ad\nloss.backward()\n\n# \u6253\u5370\u8f93\u5165\u5c42\u5230\u8f93\u51fa\u5c42\u7684\u6743\u91cd\u68af\u5ea6\nprint(model.linear.weight.grad)\n</code></pre> <p>\u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u795e\u7ecf\u7f51\u7edc\u6a21\u578b\uff0c\u7136\u540e\u521b\u5efa\u4e86\u4e00\u4e2a\u8f93\u5165\u5f20\u91cfx\u3002\u63a5\u7740\u6211\u4eec\u4f7f\u7528\u6a21\u578b\u8fdb\u884c\u524d\u5411\u4f20\u64ad\uff0c\u5f97\u5230\u8f93\u51fa\u5f20\u91cfoutput\u3002\u7136\u540e\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u76ee\u6807\u5f20\u91cftarget\uff0c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5747\u65b9\u8bef\u5dee\u635f\u5931\u51fd\u6570\uff0c\u8ba1\u7b97\u51fa\u635f\u5931loss\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c06\u6a21\u578b\u7684\u68af\u5ea6\u6e05\u96f6\uff0c\u7136\u540e\u8fdb\u884c\u53cd\u5411\u4f20\u64ad\uff0c\u5229\u7528\u635f\u5931\u51fd\u6570\u8ba1\u7b97\u51fa\u6a21\u578b\u4e2d\u5404\u4e2a\u53c2\u6570\u7684\u68af\u5ea6\u3002\u6700\u540e\uff0c\u6211\u4eec\u6253\u5370\u51fa\u8f93\u5165\u5c42\u5230\u8f93\u51fa\u5c42\u7684\u6743\u91cd\u68af\u5ea6\u3002</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_9","title":"\u591a\u5c42\u611f\u77e5\u5668","text":"<pre><code>class MLP(nn.Module):\n    def __init__(self, input_dim, hidden_dim, output_dim):\n        super(MLP, self).__init__()\n        self.fc1 = nn.Linear(input_dim, hidden_dim)\n        self.relu = nn.ReLU()\n        self.fc2 = nn.Linear(hidden_dim, output_dim)\n\n    def forward(self, x):\n        out = self.fc1(x)\n        out = self.relu(out)\n        out = self.fc2(out)\n        return out\n</code></pre> <p>\u5728<code>__init__</code>\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86MLP\u7684\u5404\u4e2a\u5c42\uff0c\u5305\u62ec\u4e00\u4e2a\u8f93\u5165\u5c42\u3001\u4e00\u4e2a\u9690\u85cf\u5c42\u548c\u4e00\u4e2a\u8f93\u51fa\u5c42\u3002\u5728<code>forward</code>\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u5c06\u8f93\u5165\u901a\u8fc7\u5404\u4e2a\u5c42\u4f20\u9012\uff0c\u5e76\u8fd4\u56de\u8f93\u51fa\u3002</p> <p>\u63a5\u4e0b\u6765\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aMLP\u6a21\u578b\u7684\u5b9e\u4f8b\uff1a</p> <pre><code>input_dim = 10\nhidden_dim = 20\noutput_dim = 2\n\nmodel = MLP(input_dim, hidden_dim, output_dim)\n</code></pre>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_10","title":"\u6570\u636e\u5904\u7406","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_11","title":"\u4e0b\u8f7d\u6570\u636e\u96c6","text":"<p>\u4ee5MNIST\u4e3a\u4f8b</p> <pre><code>import torch\nfrom torchvision import datasets, transforms\n\n# \u5b9a\u4e49\u6570\u636e\u8f6c\u6362\ntransform = transforms.Compose([\n    transforms.ToTensor(),                  # \u5c06\u56fe\u50cf\u8f6c\u6362\u4e3aTensor\n    transforms.Normalize((0.1307,), (0.3081,))  # \u5bf9\u56fe\u50cf\u8fdb\u884c\u6807\u51c6\u5316\n])\n\n# \u4e0b\u8f7dMNIST\u8bad\u7ec3\u96c6\ntrain_dataset = datasets.MNIST(root='./data', train=True, transform=transform, download=True)\n\n# \u4e0b\u8f7dMNIST\u6d4b\u8bd5\u96c6\ntest_dataset = datasets.MNIST(root='./data', train=False, transform=transform, download=True)\n</code></pre>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_12","title":"\u6570\u636e\u52a0\u8f7d","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_13","title":"\u6570\u636e\u9884\u5904\u7406","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#_14","title":"\u67e5\u770b\u6bcf\u4e00\u5c42\u7684\u7ed3\u6784","text":"<p>1. <pre><code>X = torch.rand(size = (1,1,28,28),dtype=torch.float32)\n\nfor layer in net:\n    X = layer(X)\n    print(layer.__class__.__name__, 'output shape: \\t',X.shape)\n</code></pre></p> <pre><code>Reshape output shape:    torch.Size([1, 1, 28, 28])\nConv2d output shape:     torch.Size([1, 6, 28, 28])\nSigmoid output shape:    torch.Size([1, 6, 28, 28])\nAvgPool2d output shape:      torch.Size([1, 6, 14, 14])\nConv2d output shape:     torch.Size([1, 16, 10, 10])\nSigmoid output shape:    torch.Size([1, 16, 10, 10])\nAvgPool2d output shape:      torch.Size([1, 16, 5, 5])\nFlatten output shape:    torch.Size([1, 400])\nLinear output shape:     torch.Size([1, 120])\nSigmoid output shape:    torch.Size([1, 120])\nLinear output shape:     torch.Size([1, 84])\nSigmoid output shape:    torch.Size([1, 84])\nLinear output shape:     torch.Size([1, 10])\n</code></pre> <p>2.</p> <pre><code>class net(nn.Module):\n    def __init__(self):\n        super(net,self).__init__()\n        self.model = nn.Sequential(\n            nn. Conv2d(1,2,3,1,2)\n        )\n    def forward(self, x):\n        x = self.model(x)\n        return x\n\n\ntest =  net().to(torch.device('cuda'))\nsummary(test,(1,28,28),batch_size=64)\n</code></pre> <pre><code>----------------------------------------------------------------\n        Layer (type)               Output Shape         Param #\n================================================================\n            Conv2d-1            [64, 2, 30, 30]              20\n================================================================\nTotal params: 20\nTrainable params: 20\nNon-trainable params: 0\n----------------------------------------------------------------\nInput size (MB): 0.19\nForward/backward pass size (MB): 0.88\nParams size (MB): 0.00\nEstimated Total Size (MB): 1.07\n----------------------------------------------------------------\n</code></pre> <p>[!note]  Conv2d\u7ed3\u6784\u4e3a (batch_size, channels, height,width)</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/Pytorch%E4%BD%BF%E7%94%A8/#pytorch-gpu","title":"pytorch GPU\u8bad\u7ec3","text":"<pre><code>import torch\nimport torchvision\nfrom torch.utils.tensorboard import SummaryWriter\n\n# from model import *\n# \u51c6\u5907\u6570\u636e\u96c6\nfrom torch import nn\nfrom torch.utils.data import DataLoader\n\n# \u5b9a\u4e49\u8bad\u7ec3\u7684\u8bbe\u5907\ndevice =torch.device('cuda')if torch.cuda.is_available() else torch.device('cpu')\n\ntrain_data = torchvision.datasets.CIFAR10(root=\"../data\", train=True, transform=torchvision.transforms.ToTensor(),\n                                          download=True)\ntest_data = torchvision.datasets.CIFAR10(root=\"../data\", train=False, transform=torchvision.transforms.ToTensor(),\n                                         download=True)\n\n# length \u957f\u5ea6\ntrain_data_size = len(train_data)\ntest_data_size = len(test_data)\n# \u5982\u679ctrain_data_size=10, \u8bad\u7ec3\u6570\u636e\u96c6\u7684\u957f\u5ea6\u4e3a\uff1a10\nprint(\"\u8bad\u7ec3\u6570\u636e\u96c6\u7684\u957f\u5ea6\u4e3a\uff1a{}\".format(train_data_size))\nprint(\"\u6d4b\u8bd5\u6570\u636e\u96c6\u7684\u957f\u5ea6\u4e3a\uff1a{}\".format(test_data_size))\n\n\n# \u5229\u7528 DataLoader \u6765\u52a0\u8f7d\u6570\u636e\u96c6\ntrain_dataloader = DataLoader(train_data, batch_size=64)\ntest_dataloader = DataLoader(test_data, batch_size=64)\n\n# \u521b\u5efa\u7f51\u7edc\u6a21\u578b\nclass Tudui(nn.Module):\n    def __init__(self):\n        super(Tudui, self).__init__()\n        self.model = nn.Sequential(\n            nn.Conv2d(3, 32, 5, 1, 2),\n            nn.MaxPool2d(2),\n            nn.Conv2d(32, 32, 5, 1, 2),\n            nn.MaxPool2d(2),\n            nn.Conv2d(32, 64, 5, 1, 2),\n            nn.MaxPool2d(2),\n            nn.Flatten(),\n            nn.Linear(64*4*4, 64),\n            nn.Linear(64, 10)\n        )\n\n    def forward(self, x):\n        x = self.model(x)\n        return x\ntudui = Tudui()\ntudui = tudui.to(device)\n\n# \u635f\u5931\u51fd\u6570\nloss_fn = nn.CrossEntropyLoss()\nloss_fn = loss_fn.to(device)\n# \u4f18\u5316\u5668\n# learning_rate = 0.01\n# 1e-2=1 x (10)^(-2) = 1 /100 = 0.01\nlearning_rate = 1e-2\noptimizer = torch.optim.SGD(tudui.parameters(), lr=learning_rate)\n\n# \u8bbe\u7f6e\u8bad\u7ec3\u7f51\u7edc\u7684\u4e00\u4e9b\u53c2\u6570\n# \u8bb0\u5f55\u8bad\u7ec3\u7684\u6b21\u6570\ntotal_train_step = 0\n# \u8bb0\u5f55\u6d4b\u8bd5\u7684\u6b21\u6570\ntotal_test_step = 0\n# \u8bad\u7ec3\u7684\u8f6e\u6570\nepoch = 10\n\n# \u6dfb\u52a0tensorboard\nwriter = SummaryWriter(\"../logs_train\")\n\nfor i in range(epoch):\n    print(\"-------\u7b2c {} \u8f6e\u8bad\u7ec3\u5f00\u59cb-------\".format(i+1))\n\n    # \u8bad\u7ec3\u6b65\u9aa4\u5f00\u59cb\n    tudui.train()\n    for data in train_dataloader:\n        imgs, targets = data\n        imgs = imgs.to(device)\n        print(imgs.shape)\n        targets = targets.to(device)\n        outputs = tudui(imgs)\n        loss = loss_fn(outputs, targets)\n\n        # \u4f18\u5316\u5668\u4f18\u5316\u6a21\u578b\n        optimizer.zero_grad()\n        loss.backward()\n        optimizer.step()\n\n        total_train_step = total_train_step + 1\n        if total_train_step % 100 == 0:\n            print(\"\u8bad\u7ec3\u6b21\u6570\uff1a{}, Loss: {}\".format(total_train_step, loss.item()))\n            writer.add_scalar(\"train_loss\", loss.item(), total_train_step)\n\n    # \u6d4b\u8bd5\u6b65\u9aa4\u5f00\u59cb\n    tudui.eval()\n    total_test_loss = 0\n    total_accuracy = 0\n    with torch.no_grad():\n        for data in test_dataloader:\n            imgs, targets = data\n            imgs = imgs.to(device)\n            targets = targets.to(device)\n            outputs = tudui(imgs)\n            loss = loss_fn(outputs, targets)\n            total_test_loss = total_test_loss + loss.item()\n            accuracy = (outputs.argmax(1) == targets).sum()\n            total_accuracy = total_accuracy + accuracy\n\n    print(\"\u6574\u4f53\u6d4b\u8bd5\u96c6\u4e0a\u7684Loss: {}\".format(total_test_loss))\n    print(\"\u6574\u4f53\u6d4b\u8bd5\u96c6\u4e0a\u7684\u6b63\u786e\u7387: {}\".format(total_accuracy/test_data_size))\n    writer.add_scalar(\"test_loss\", total_test_loss, total_test_step)\n    writer.add_scalar(\"test_accuracy\", total_accuracy/test_data_size, total_test_step)\n    total_test_step = total_test_step + 1\n\n    torch.save(tudui, \"tudui_{}.pth\".format(i))\n    print(\"\u6a21\u578b\u5df2\u4fdd\u5b58\")\n\nwriter.close()\n</code></pre>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/","title":"\u6df1\u5ea6\u5b66\u4e60","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_2","title":"\u4eba\u5de5\u667a\u80fd #\u6df1\u5ea6\u5b66\u4e60","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_3","title":"\u7ebf\u6027\u795e\u7ecf\u7f51\u7edc","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_4","title":"\u7ebf\u6027\u56de\u5f52","text":"<p>\u7ebf\u6027\u56de\u5f52\u662f\u4e00\u79cd\u57fa\u672c\u7684\u56de\u5f52\u6a21\u578b\uff0c\u7528\u4e8e\u5efa\u7acb\u8f93\u5165\u53d8\u91cf\u548c\u8f93\u51fa\u53d8\u91cf\u4e4b\u95f4\u7684\u7ebf\u6027\u5173\u7cfb\u3002\u5b83\u662f\u4e00\u79cd\u6700\u7b80\u5355\u7684\u795e\u7ecf\u7f51\u7edc\u6a21\u578b\uff0c\u53ea\u5305\u542b\u4e00\u4e2a\u8f93\u5165\u5c42\u548c\u4e00\u4e2a\u8f93\u51fa\u5c42\uff0c\u5176\u4e2d\u8f93\u5165\u5c42\u7684\u6bcf\u4e2a\u795e\u7ecf\u5143\u5bf9\u5e94\u4e00\u4e2a\u8f93\u5165\u53d8\u91cf\uff0c\u8f93\u51fa\u5c42\u7684\u4e00\u4e2a\u795e\u7ecf\u5143\u5bf9\u5e94\u4e00\u4e2a\u8f93\u51fa\u53d8\u91cf\u3002</p> <p>\u7ebf\u6027\u56de\u5f52\u6a21\u578b\u7684\u8f93\u51fa\u662f\u8f93\u5165\u53d8\u91cf\u7684\u7ebf\u6027\u7ec4\u5408\uff0c\u901a\u8fc7\u4e58\u4ee5\u76f8\u5e94\u7684\u6743\u91cd\u5e76\u52a0\u4e0a\u504f\u7f6e\u9879\u6765\u5b9e\u73b0\u3002\u8fd9\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a</p> <p>y = w1*x1 + w2*x2 + ... + wn*xn + b</p> <p>\u5176\u4e2d\uff0cy\u662f\u8f93\u51fa\u53d8\u91cf\uff0cx1, x2, ..., xn\u662f\u8f93\u5165\u53d8\u91cf\uff0cw1, w2, ..., wn\u662f\u5bf9\u5e94\u7684\u6743\u91cd\uff0cb\u662f\u504f\u7f6e\u9879\u3002</p> <p>\u5728\u795e\u7ecf\u7f51\u7edc\u4e2d\uff0c\u7ebf\u6027\u56de\u5f52\u901a\u5e38\u4f5c\u4e3a\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u4e00\u5c42\uff0c\u5176\u4e2d\u7684\u6743\u91cd\u548c\u504f\u7f6e\u9879\u662f\u9700\u8981\u901a\u8fc7\u8bad\u7ec3\u6765\u5b66\u4e60\u5f97\u5230\u7684\u3002\u901a\u8fc7\u53cd\u5411\u4f20\u64ad\u7b97\u6cd5\u548c\u4f18\u5316\u7b97\u6cd5\uff08\u5982\u68af\u5ea6\u4e0b\u964d\uff09\uff0c\u53ef\u4ee5\u6839\u636e\u7ed9\u5b9a\u7684\u8bad\u7ec3\u6570\u636e\u6765\u8c03\u6574\u6743\u91cd\u548c\u504f\u7f6e\u9879\uff0c\u4f7f\u5f97\u6a21\u578b\u80fd\u591f\u66f4\u597d\u5730\u62df\u5408\u8f93\u5165\u548c\u8f93\u51fa\u4e4b\u95f4\u7684\u7ebf\u6027\u5173\u7cfb\u3002</p> <p>\u7ebf\u6027\u56de\u5f52\u5728\u795e\u7ecf\u7f51\u7edc\u4e2d\u5e38\u7528\u4e8e\u89e3\u51b3\u56de\u5f52\u95ee\u9898\uff0c\u5982\u9884\u6d4b\u623f\u4ef7\u3001\u9500\u552e\u989d\u7b49\u8fde\u7eed\u53d8\u91cf\u7684\u95ee\u9898\u3002\u5b83\u7684\u4f18\u70b9\u662f\u8ba1\u7b97\u7b80\u5355\u3001\u6613\u4e8e\u7406\u89e3\uff0c\u4f46\u5bf9\u4e8e\u975e\u7ebf\u6027\u5173\u7cfb\u7684\u5efa\u6a21\u80fd\u529b\u6709\u9650\u3002\u5728\u5904\u7406\u975e\u7ebf\u6027\u95ee\u9898\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u9690\u85cf\u5c42\u548c\u6fc0\u6d3b\u51fd\u6570\u6765\u6784\u5efa\u66f4\u590d\u6742\u7684\u795e\u7ecf\u7f51\u7edc\u6a21\u578b\u3002</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#softmax","title":"softmax","text":"<p>Softmax\u51fd\u6570\u662f\u4e00\u79cd\u5e38\u7528\u7684\u6fc0\u6d3b\u51fd\u6570\uff0c\u5b83\u5c06\u4e00\u7ec4\u5b9e\u6570\u8f6c\u5316\u4e3a\u6982\u7387\u5206\u5e03\u3002\u5728\u673a\u5668\u5b66\u4e60\u4e2d\uff0c\u5b83\u901a\u5e38\u7528\u4e8e\u591a\u5206\u7c7b\u95ee\u9898\u4e2d\uff0c\u5c06\u539f\u59cb\u7684\u5b9e\u6570\u8f93\u51fa\u8f6c\u5316\u4e3a\u6bcf\u4e2a\u7c7b\u522b\u7684\u6982\u7387\u3002</p> <p>Softmax\u51fd\u6570\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a $$ \\text{softmax}(z_i) = \\frac{e<sup>{z_i}}{\\sum_{j=1}</sup> $$ \u5176\u4e2d\uff0c} e^{z_j}\\(z_i\\)\u662f\u8f93\u5165\u5411\u91cf\u4e2d\u7684\u7b2c\\(i\\)\u4e2a\u5143\u7d20\uff0c\\(K\\)\u662f\u7c7b\u522b\u7684\u603b\u6570\u3002</p> <p>Softmax\u51fd\u6570\u7684\u7279\u70b9\u662f\u5b83\u5bf9\u8f93\u5165\u8fdb\u884c\u5f52\u4e00\u5316\uff0c\u4f7f\u5f97\u6240\u6709\u8f93\u51fa\u7684\u6982\u7387\u4e4b\u548c\u4e3a1\u3002\u5b83\u5c06\u539f\u59cb\u7684\u5b9e\u6570\u8f6c\u5316\u4e3a\u6982\u7387\uff0c\u8f83\u5927\u7684\u8f93\u5165\u4f1a\u5f97\u5230\u8f83\u5927\u7684\u8f93\u51fa\u6982\u7387\uff0c\u800c\u8f83\u5c0f\u7684\u8f93\u5165\u4f1a\u5f97\u5230\u8f83\u5c0f\u7684\u8f93\u51fa\u6982\u7387\u3002</p> <p>\u5728\u6df1\u5ea6\u5b66\u4e60\u4e2d\uff0cSoftmax\u51fd\u6570\u901a\u5e38\u4e0e\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570\u7ed3\u5408\u4f7f\u7528\uff0c\u7528\u4e8e\u8ba1\u7b97\u6a21\u578b\u7684\u9884\u6d4b\u548c\u771f\u5b9e\u6807\u7b7e\u4e4b\u95f4\u7684\u5dee\u8ddd\u3002</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_5","title":"\u591a\u5c42\u611f\u77e5\u673a","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_6","title":"\u53cd\u5411\u4f20\u64ad","text":"<pre><code>graph LR\nA[\u524d\u5411\u4f20\u64ad] --&gt; B[\u8ba1\u7b97\u635f\u5931\u51fd\u6570]\nB --&gt; C[\u53cd\u5411\u4f20\u64ad\u8bef\u5dee]\nC --&gt; D[\u8ba1\u7b97\u68af\u5ea6]\nD --&gt; E[\u53c2\u6570\u66f4\u65b0]\nE --&gt; F[\u91cd\u590d\u6267\u884c]\n\nF --&gt; A\n</code></pre> <p>\u5229\u7528\u53cd\u5411\u4f20\u64ad\u8ba1\u7b97\u7ebf\u6027\u56de\u5f52</p> <pre><code>import numpy as np\n\n# \u51c6\u5907\u6570\u636e\nX = np.array([[1], [2], [3], [4], [5]])  # \u81ea\u53d8\u91cf\ny = np.array([2, 4, 6, 8, 10])  # \u56e0\u53d8\u91cf\n\n# \u521d\u59cb\u5316\u6743\u91cd\u548c\u504f\u7f6e\nw = np.random.randn(1)\nb = np.random.randn(1)\n\n# \u8bbe\u7f6e\u5b66\u4e60\u7387\u548c\u8fed\u4ee3\u6b21\u6570\nlearning_rate = 0.01\nnum_iterations = 1000\n\n# \u53cd\u5411\u4f20\u64ad\u7b97\u6cd5\nfor i in range(num_iterations):\n    # \u524d\u5411\u4f20\u64ad\n    y_pred = X * w + b\n\n    # \u8ba1\u7b97\u635f\u5931\n    loss = np.mean((y_pred - y) ** 2) # \u5747\u65b9\u8bef\u5dee\n\n    # \u8ba1\u7b97\u68af\u5ea6\n    dw = np.mean(2 * (y_pred - y) * X) # \u5c06\u5dee\u5f02\u4e58\u4ee5 2 \u662f\u4e3a\u4e86\u7b80\u5316\u8ba1\u7b97\u5bfc\u6570\u7684\u8fc7\u7a0b\n    db = np.mean(2 * (y_pred - y))\n\n    # \u66f4\u65b0\u6743\u91cd\u548c\u504f\u7f6e\n    w -= learning_rate * dw\n    b -= learning_rate * db\n\n# \u8fdb\u884c\u9884\u6d4b\nprint(w)\nprint(b)\nprint(\"\u9884\u6d4b\u7ed3\u679c:\", y_pred)\n</code></pre>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_7","title":"\u5377\u79ef\u795e\u7ecf\u7f51\u7edc","text":"<ul> <li> <p>\u56fe\u50cf\u7684\u5e73\u79fb\u4e0d\u53d8\u6027\u4f7f\u6211\u4eec\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u5904\u7406\u5c40\u90e8\u56fe\u50cf\uff0c\u800c\u4e0d\u5728\u4e4e\u5b83\u7684\u4f4d\u7f6e\u3002</p> </li> <li> <p>\u5c40\u90e8\u6027\u610f\u5473\u7740\u8ba1\u7b97\u76f8\u5e94\u7684\u9690\u85cf\u8868\u793a\u53ea\u9700\u4e00\u5c0f\u90e8\u5206\u5c40\u90e8\u56fe\u50cf\u50cf\u7d20\u3002</p> </li> <li> <p>\u5728\u56fe\u50cf\u5904\u7406\u4e2d\uff0c\u5377\u79ef\u5c42\u901a\u5e38\u6bd4\u5168\u8fde\u63a5\u5c42\u9700\u8981\u66f4\u5c11\u7684\u53c2\u6570\uff0c\u4f46\u4f9d\u65e7\u83b7\u5f97\u9ad8\u6548\u7528\u7684\u6a21\u578b\u3002</p> </li> <li> <p>\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\uff08CNN\uff09\u662f\u4e00\u7c7b\u7279\u6b8a\u7684\u795e\u7ecf\u7f51\u7edc\uff0c\u5b83\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u5377\u79ef\u5c42\u3002</p> </li> <li> <p>\u591a\u4e2a\u8f93\u5165\u548c\u8f93\u51fa\u901a\u9053\u4f7f\u6a21\u578b\u5728\u6bcf\u4e2a\u7a7a\u95f4\u4f4d\u7f6e\u53ef\u4ee5\u83b7\u53d6\u56fe\u50cf\u7684\u591a\u65b9\u9762\u7279\u5f81\u3002</p> </li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_8","title":"\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\u57fa\u672c\u7ed3\u6784","text":"<ol> <li> <p>\u8f93\u5165\u5c42\uff08Input Layer\uff09\uff1a\u63a5\u53d7\u539f\u59cb\u56fe\u50cf\u6216\u5176\u4ed6\u7c7b\u578b\u7684\u8f93\u5165\u6570\u636e\u3002</p> </li> <li> <p>\u5377\u79ef\u5c42\uff08Convolutional Layer\uff09\uff1a\u901a\u8fc7\u5e94\u7528\u5377\u79ef\u64cd\u4f5c\u6765\u63d0\u53d6\u8f93\u5165\u56fe\u50cf\u7684\u7279\u5f81\u3002\u6bcf\u4e2a\u5377\u79ef\u5c42\u90fd\u5305\u542b\u591a\u4e2a\u5377\u79ef\u6838\uff08\u4e5f\u79f0\u4e3a\u6ee4\u6ce2\u5668\uff09\uff0c\u6bcf\u4e2a\u5377\u79ef\u6838\u5728\u56fe\u50cf\u4e0a\u6ed1\u52a8\uff0c\u6267\u884c\u5377\u79ef\u8fd0\u7b97\u4ee5\u751f\u6210\u7279\u5f81\u56fe\u3002</p> </li> <li> <p>\u6fc0\u6d3b\u5c42\uff08Activation Layer\uff09\uff1a\u5bf9\u5377\u79ef\u5c42\u7684\u8f93\u51fa\u5e94\u7528\u975e\u7ebf\u6027\u6fc0\u6d3b\u51fd\u6570\uff08\u4f8b\u5982ReLU\uff09\uff0c\u4ee5\u5f15\u5165\u975e\u7ebf\u6027\u7279\u5f81\u5e76\u589e\u5f3a\u7f51\u7edc\u7684\u8868\u8fbe\u80fd\u529b\u3002</p> </li> <li> <p>\u6c60\u5316\u5c42\uff08Pooling Layer\uff09\uff1a\u901a\u8fc7\u51cf\u5c11\u7279\u5f81\u56fe\u7684\u7a7a\u95f4\u7ef4\u5ea6\u6765\u964d\u4f4e\u8ba1\u7b97\u91cf\uff0c\u540c\u65f6\u4fdd\u7559\u91cd\u8981\u7684\u7279\u5f81\u3002\u5e38\u89c1\u7684\u6c60\u5316\u64cd\u4f5c\u5305\u62ec\u6700\u5927\u6c60\u5316\u548c\u5e73\u5747\u6c60\u5316\u3002</p> </li> <li> <p>\u5168\u8fde\u63a5\u5c42\uff08Fully Connected Layer\uff09\uff1a\u5c06\u524d\u9762\u7684\u5c42\u7684\u8f93\u51fa\u5c55\u5e73\u5e76\u8fde\u63a5\u5230\u4e00\u4e2a\u5168\u8fde\u63a5\u5c42\uff0c\u6bcf\u4e2a\u795e\u7ecf\u5143\u4e0e\u4e0a\u4e00\u5c42\u7684\u6240\u6709\u795e\u7ecf\u5143\u76f8\u8fde\u3002\u5168\u8fde\u63a5\u5c42\u7528\u4e8e\u5b66\u4e60\u8f93\u5165\u7279\u5f81\u4e4b\u95f4\u7684\u590d\u6742\u5173\u7cfb\uff0c\u5e76\u751f\u6210\u6700\u7ec8\u7684\u5206\u7c7b\u7ed3\u679c\u3002</p> </li> <li> <p>\u8f93\u51fa\u5c42\uff08Output Layer\uff09\uff1a\u6839\u636e\u4efb\u52a1\u7684\u9700\u6c42\u9009\u62e9\u9002\u5f53\u7684\u6fc0\u6d3b\u51fd\u6570\uff08\u5982softmax\uff09\u6765\u751f\u6210\u7f51\u7edc\u7684\u8f93\u51fa\uff0c\u5982\u5206\u7c7b\u7ed3\u679c\u6216\u56de\u5f52\u9884\u6d4b\u3002</p> </li> </ol> <pre><code>graph LR\n    A[\u8f93\u5165\u5c42] --&gt; B[\u5377\u79ef\u5c42]\n    B --&gt; C[\u6fc0\u6d3b\u5c42]\n    C --&gt; D[\u6c60\u5316\u5c42]\n    D --&gt; E[\u5168\u8fde\u63a5\u5c42]\n    E --&gt; F[\u8f93\u51fa\u5c42]\n</code></pre>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_9","title":"\u5e38\u89c1\u7684\u795e\u7ecf\u7f51\u7edc\u5c42","text":"<ol> <li> <p>\u8f93\u5165\u5c42\uff1a\u8f93\u5165\u5c42\u662f\u7f51\u7edc\u7684\u7b2c\u4e00\u5c42\uff0c\u7528\u4e8e\u63a5\u6536\u539f\u59cb\u6570\u636e\u3002</p> </li> <li> <p>\u5377\u79ef\u5c42\uff1a\u5377\u79ef\u5c42\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u5c42\uff0c\u7528\u4e8e\u63d0\u53d6\u56fe\u50cf\u7684\u7279\u5f81\u3002</p> </li> <li> <p>\u6c60\u5316\u5c42\uff1a\u6c60\u5316\u5c42\u7528\u4e8e\u51cf\u5c11\u6570\u636e\u7684\u7ef4\u5ea6\uff0c\u538b\u7f29\u6570\u636e\u5e76\u4fdd\u6301\u7a7a\u95f4\u4e0d\u53d8\u6027\u3002</p> </li> <li> <p>\u5168\u8fde\u63a5\u5c42\uff1a\u5168\u8fde\u63a5\u5c42\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u5c42\uff0c\u7528\u4e8e\u5c06\u7279\u5f81\u5c42\u8f6c\u6362\u4e3a\u9884\u6d4b\u7684\u8f93\u51fa\u3002</p> </li> <li> <p>\u9012\u5f52\u5c42\uff1a\u9012\u5f52\u5c42\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u5c42\uff0c\u7528\u4e8e\u5904\u7406\u5e8f\u5217\u6570\u636e\u3002</p> </li> <li> <p>\u89e3\u7801\u5c42\uff1a\u89e3\u7801\u5c42\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u5c42\uff0c\u7528\u4e8e\u5c06\u7f16\u7801\u7684\u7279\u5f81\u8fd8\u539f\u4e3a\u539f\u59cb\u6570\u636e\u3002</p> </li> <li> <p>\u8f93\u51fa\u5c42\uff1a\u8f93\u51fa\u5c42\u662f\u7f51\u7edc\u7684\u6700\u540e\u4e00\u5c42\uff0c\u7528\u4e8e\u751f\u6210\u9884\u6d4b\u7ed3\u679c\u3002</p> </li> </ol> <p>\u8fd9\u4e9b\u5c42\u4ec5\u662f\u795e\u7ecf\u7f51\u7edc\u4e2d\u4e00\u4e9b\u5e38\u89c1\u7684\u5c42\uff0c\u5e76\u4e0d\u662f\u5168\u90e8\u5c42\u3002\u5bf9\u4e8e\u4e0d\u540c\u7684\u95ee\u9898\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u7279\u6b8a\u7684\u5c42\uff0c\u5982\u6ce8\u610f\u529b\u5c42\uff0c\u6279\u6807\u51c6\u5316\u5c42\u7b49\u3002</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_10","title":"\u5168\u8fde\u63a5\u5c42","text":"<ul> <li>\u5168\u8fde\u63a5\u5c42\uff08Fully Connected Layer\uff09</li> <li> <p>\u7279\u70b9\uff1a\u5168\u8fde\u63a5\u5c42\u662f\u4e00\u79cd\u7ebf\u6027\u7684\u5c42\uff0c\u5176\u4e2d\u6bcf\u4e2a\u795e\u7ecf\u5143\u4e0e\u4e0a\u4e00\u5c42\u7684\u6240\u6709\u795e\u7ecf\u5143\u90fd\u6709\u8fde\u63a5\u3002\u56e0\u6b64\uff0c\u5168\u8fde\u63a5\u5c42\u7684\u6bcf\u4e00\u5c42\u90fd\u662f\u4e00\u4e2a\u77e9\u9635\uff0c\u5176\u4e2d\u7684\u6bcf\u4e00\u884c\u4ee3\u8868\u4e00\u4e2a\u795e\u7ecf\u5143\u3002</p> </li> <li> <p>\u4f5c\u7528\uff1a\u5168\u8fde\u63a5\u5c42\u4e3b\u8981\u7528\u4e8e\u7ebf\u6027\u6620\u5c04\uff0c\u5c06\u8f93\u5165\u6570\u636e\u4ece\u4f4e\u7ef4\u7a7a\u95f4\u6620\u5c04\u5230\u9ad8\u7ef4\u7a7a\u95f4\u3002\u5b83\u4e5f\u53ef\u4ee5\u901a\u8fc7\u52a0\u5165\u975e\u7ebf\u6027\u6fc0\u6d3b\u51fd\u6570\u6765\u5b9e\u73b0\u975e\u7ebf\u6027\u6620\u5c04\u3002</p> </li> <li> <p>\u5e94\u7528\uff1a\u5168\u8fde\u63a5\u5c42\u901a\u5e38\u7528\u4e8e\u5904\u7406\u56de\u5f52\u548c\u5206\u7c7b\u95ee\u9898\uff0c\u4f5c\u4e3a\u6700\u540e\u4e00\u5c42\u6216\u63a5\u8fd1\u6700\u540e\u4e00\u5c42\uff0c\u7528\u4e8e\u9884\u6d4b\u7ed3\u679c\u3002\u5904\u7406\u591a\u5206\u7c7b\u95ee\u9898\uff0c\u4f8b\u5982\u56fe\u50cf\u5206\u7c7b\u3001\u6587\u672c\u5206\u7c7b\u7b49\u3002\u5b83\u8fd8\u53ef\u4ee5\u7528\u4e8e\u5904\u7406\u56de\u5f52\u95ee\u9898\uff0c\u4f8b\u5982\u9884\u6d4b\u80a1\u7968\u4ef7\u683c\u7b49\u3002</p> </li> <li> <p>\u590d\u6742\u5ea6\uff1a\u5168\u8fde\u63a5\u5c42\u7684\u590d\u6742\u5ea6\u5f88\u9ad8\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u795e\u7ecf\u5143\u4e0e\u4e0a\u4e00\u5c42\u7684\u6240\u6709\u795e\u7ecf\u5143\u90fd\u6709\u8fde\u63a5\u3002\u56e0\u6b64\uff0c\u5f53\u7f51\u7edc\u89c4\u6a21\u53d8\u5927\u65f6\uff0c\u5168\u8fde\u63a5\u5c42\u7684\u8ba1\u7b97\u91cf\u4f1a\u5448\u6307\u6570\u589e\u957f\u3002</p> </li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_11","title":"\u4e8c\u7ef4\u5377\u79ef\u5c42","text":"<p>\u4e8c\u7ef4\u5377\u79ef\u5c42\uff082D Convolutional Layer\uff09</p> <ul> <li> <p>\u7279\u5f81\u63d0\u53d6\uff1a\u4e8c\u7ef4\u5377\u79ef\u5c42\u901a\u8fc7\u6ed1\u52a8\u5377\u79ef\u6838\u5bf9\u56fe\u50cf\u8fdb\u884c\u7279\u5f81\u63d0\u53d6\u3002\u5377\u79ef\u6838\u53ef\u4ee5\u6355\u6349\u56fe\u50cf\u4e2d\u7684\u5c40\u90e8\u7279\u5f81\uff0c\u4f8b\u5982\u8fb9\u7f18\u3001\u7eb9\u7406\u7b49\u3002</p> </li> <li> <p>\u964d\u7ef4\uff1a\u4e8c\u7ef4\u5377\u79ef\u5c42\u901a\u8fc7\u6c60\u5316\u64cd\u4f5c\uff08\u5982\u6700\u5927\u6c60\u5316\uff09\u964d\u4f4e\u8f93\u5165\u6570\u636e\u7684\u7ef4\u6570\uff0c\u4ece\u800c\u51cf\u5c11\u8ba1\u7b97\u590d\u6742\u5ea6\u3002</p> </li> <li> <p>\u7a7a\u95f4\u4e0d\u53d8\u6027\uff1a\u4e8c\u7ef4\u5377\u79ef\u5c42\u5177\u6709\u7a7a\u95f4\u4e0d\u53d8\u6027\uff0c\u610f\u5473\u7740\u5b83\u4e0d\u4f1a\u56e0\u4e3a\u8f93\u5165\u6570\u636e\u7684\u5e73\u79fb\u800c\u5bfc\u81f4\u8f93\u51fa\u7684\u53d8\u5316\u3002</p> </li> <li> <p>\u5171\u4eab\u6743\u503c\uff1a\u4e8c\u7ef4\u5377\u79ef\u5c42\u7684\u5377\u79ef\u6838\u5171\u4eab\u6743\u503c\uff0c\u5373\u5377\u79ef\u6838\u5728\u6574\u5f20\u56fe\u50cf\u4e0a\u7684\u4f4d\u7f6e\u53ef\u4ee5\u5171\u4eab\u3002\u8fd9\u6709\u52a9\u4e8e\u51cf\u5c11\u6a21\u578b\u7684\u53c2\u6570\u6570\u91cf\uff0c\u4ece\u800c\u9632\u6b62\u8fc7\u62df\u5408\u3002</p> </li> <li> <p>\u5e94\u7528\uff1a\u4e8c\u7ef4\u5377\u79ef\u5c42\u901a\u5e38\u7528\u4e8e\u5904\u7406\u56fe\u50cf\u5206\u7c7b\u3001\u8bed\u97f3\u8bc6\u522b\u7b49\u95ee\u9898\u3002\u5b83\u53ef\u4ee5\u4ece\u8f93\u5165\u56fe\u50cf\u4e2d\u6355\u6349\u9ad8\u5c42\u62bd\u8c61\u7684\u7279\u5f81\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u540e\u7eed\u5c42\u7684\u8f93\u5165\u3002</p> </li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_12","title":"\u6c60\u5316\u5c42","text":"<p>\u6c60\u5316\u5c42\uff08Pooling Layer\uff09</p> <ul> <li> <p>\u538b\u7f29\u6570\u636e\uff1a\u6c60\u5316\u5c42\u901a\u8fc7\u538b\u7f29\u6570\u636e\u6765\u51cf\u5c0f\u6a21\u578b\u7684\u53c2\u6570\u6570\u91cf\uff0c\u964d\u4f4e\u8ba1\u7b97\u590d\u6742\u5ea6\u3002</p> </li> <li> <p>\u51cf\u5c11\u7279\u5f81\u6570\uff1a\u6c60\u5316\u5c42\u53ef\u4ee5\u51cf\u5c11\u524d\u4e00\u5c42\u7684\u7279\u5f81\u6570\uff0c\u964d\u4f4e\u6a21\u578b\u7684\u590d\u6742\u5ea6\u3002</p> </li> <li> <p>\u7a7a\u95f4\u4e0d\u53d8\u6027\uff1a\u6c60\u5316\u5c42\u4fdd\u7559\u4e86\u56fe\u50cf\u7684\u7a7a\u95f4\u4e0d\u53d8\u6027\uff0c\u5373\u5b83\u4eec\u5177\u6709\u5e73\u79fb\u4e0d\u53d8\u6027\u3002</p> </li> <li> <p>\u63d0\u9ad8\u7279\u5f81\u7684\u901a\u7528\u6027\uff1a\u6c60\u5316\u5c42\u53ef\u4ee5\u901a\u8fc7\u4e0b\u91c7\u6837\u6765\u63d0\u9ad8\u7279\u5f81\u7684\u901a\u7528\u6027\uff0c\u4ece\u800c\u5bf9\u56fe\u50cf\u7684\u5c0f\u53d8\u5316\u5177\u6709\u66f4\u5f3a\u7684\u9c81\u68d2\u6027\u3002</p> </li> <li> <p>\u5e94\u7528\uff1a\u6c60\u5316\u5c42\u901a\u5e38\u4e0e\u5377\u79ef\u5c42\u7ed3\u5408\u4f7f\u7528\uff0c\u7528\u4e8e\u5728\u5377\u79ef\u5c42\u4e4b\u540e\u538b\u7f29\u6570\u636e\u5e76\u4fdd\u6301\u7a7a\u95f4\u4e0d\u53d8\u6027\u3002</p> </li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_13","title":"\u5faa\u73af\u5c42","text":"<p>\u5faa\u73af\u5c42(Recurrent Neural Network, RNN)</p> <ul> <li> <p>\u5904\u7406\u5e8f\u5217\u6570\u636e\uff1a\u5faa\u73af\u5c42\u4e13\u95e8\u7528\u4e8e\u5904\u7406\u5e8f\u5217\u6570\u636e\uff0c\u4f8b\u5982\u6587\u672c\uff0c\u8bed\u97f3\uff0c\u65f6\u95f4\u5e8f\u5217\u7b49\u3002</p> </li> <li> <p>\u5177\u6709\u8bb0\u5fc6\u80fd\u529b\uff1a\u5faa\u73af\u5c42\u901a\u8fc7\u72b6\u6001\u5411\u91cf\u8bb0\u5f55\u4e0a\u4e00\u6b21\u7684\u72b6\u6001\uff0c\u5e76\u5c06\u5176\u4f20\u9012\u5230\u4e0b\u4e00\u6b21\u7684\u5faa\u73af\u4e2d\u3002</p> </li> <li> <p>\u957f\u65f6\u4f9d\u8d56\uff1a\u5faa\u73af\u5c42\u5141\u8bb8\u6a21\u578b\u5728\u957f\u65f6\u95f4\u5185\u8bb0\u4f4f\u4fe1\u606f\uff0c\u8fd9\u5bf9\u4e8e\u5904\u7406\u957f\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u662f\u975e\u5e38\u6709\u7528\u7684\u3002</p> </li> <li> <p>\u652f\u6301\u53d8\u957f\u8f93\u5165\uff1a\u5faa\u73af\u5c42\u80fd\u591f\u5904\u7406\u53d8\u957f\u8f93\u5165\uff0c\u800c\u4e0d\u9700\u8981\u5c06\u5b83\u4eec\u8f6c\u6362\u4e3a\u56fa\u5b9a\u957f\u5ea6\u7684\u5f20\u91cf\u3002</p> </li> <li> <p>\u7075\u6d3b\u6027\uff1a\u5faa\u73af\u5c42\u53ef\u4ee5\u901a\u8fc7\u6539\u53d8\u5faa\u73af\u5355\u5143\u7684\u7ed3\u6784\u6765\u5b9e\u73b0\u4e0d\u540c\u7684\u529f\u80fd\uff0c\u4f8b\u5982\u957f\u77ed\u65f6\u8bb0\u5fc6\u7f51\u7edc\uff08LSTM\uff09\u548c\u95e8\u63a7\u5faa\u73af\u5355\u5143\uff08GRU\uff09\u7b49\u3002</p> </li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_14","title":"\u9012\u5f52\u5c42","text":"<p>\u9012\u5f52\u5c42(Recursive Neural Network, RNN)</p> <ul> <li> <p>\u8f93\u5165\uff1a\u9012\u5f52\u5c42\u7684\u8f93\u5165\u53ef\u4ee5\u662f\u4e00\u4e2a\u5e8f\u5217\uff0c\u4f8b\u5982\u4e00\u6bb5\u6587\u672c\u3001\u4e00\u7ec4\u65f6\u95f4\u5e8f\u5217\u6570\u636e\u7b49\u3002</p> </li> <li> <p>\u5faa\u73af\uff1a\u9012\u5f52\u5c42\u5728\u6bcf\u4e2a\u65f6\u95f4\u6b65\u6267\u884c\u76f8\u540c\u7684\u8ba1\u7b97\u64cd\u4f5c\uff0c\u5e76\u901a\u8fc7\u4e0a\u4e00\u4e2a\u65f6\u95f4\u6b65\u7684\u7ed3\u679c\u5f71\u54cd\u5f53\u524d\u65f6\u95f4\u6b65\u7684\u7ed3\u679c\uff0c\u5b9e\u73b0\u5faa\u73af\u3002</p> </li> <li> <p>\u9690\u85cf\u72b6\u6001\uff1a\u9012\u5f52\u5c42\u7ef4\u62a4\u4e00\u4e2a\u9690\u85cf\u72b6\u6001\uff0c\u4ee5\u5b58\u50a8\u4e0a\u4e00\u4e2a\u65f6\u95f4\u6b65\u7684\u4fe1\u606f\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u5f53\u524d\u65f6\u95f4\u6b65\u7684\u8f93\u5165\u3002</p> </li> <li> <p>\u76f8\u90bb\u65f6\u95f4\u6b65\u7684\u5173\u8054\uff1a\u9012\u5f52\u5c42\u901a\u8fc7\u9690\u85cf\u72b6\u6001\uff0c\u5b9e\u73b0\u4e86\u76f8\u90bb\u65f6\u95f4\u6b65\u4e4b\u95f4\u7684\u5173\u8054\uff0c\u4ece\u800c\u53ef\u4ee5\u6355\u6349\u5e8f\u5217\u6570\u636e\u4e2d\u7684\u957f\u671f\u4f9d\u8d56\u5173\u7cfb\u3002</p> </li> <li> <p>\u9012\u5f52\u5c42\u7684\u7279\u70b9\u4f7f\u5176\u9002\u5408\u5904\u7406\u5e8f\u5217\u6570\u636e\uff0c\u4f8b\u5982\u6587\u672c\u5206\u7c7b\u3001\u8bed\u97f3\u8bc6\u522b\u3001\u65f6\u95f4\u5e8f\u5217\u9884\u6d4b\u7b49\u4efb\u52a1\u3002</p> </li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_15","title":"\u89e3\u7801\u5c42","text":"<p>\u89e3\u7801\u5c42\uff0c\u4e5f\u79f0\u4e3a\u8f93\u51fa\u5c42\uff0c\u662f\u795e\u7ecf\u7f51\u7edc\u7684\u6700\u540e\u4e00\u5c42</p> <ul> <li> <p>\u8f93\u51fa\u7ed3\u679c\uff1a\u89e3\u7801\u5c42\u7528\u4e8e\u8f93\u51fa\u6700\u7ec8\u7684\u6a21\u578b\u7ed3\u679c\u3002</p> </li> <li> <p>\u6d3b\u8dc3\u51fd\u6570\uff1a\u89e3\u7801\u5c42\u5e38\u5e38\u4f7f\u7528\u6fc0\u6d3b\u51fd\u6570\uff0c\u4f8b\u5982softmax\u51fd\u6570\uff0c\u6765\u8fdb\u884c\u5f52\u4e00\u5316\u5904\u7406\uff0c\u4ee5\u4fbf\u8f93\u51fa\u7684\u6bcf\u4e2a\u7ed3\u679c\u7684\u6982\u7387\u90fd\u57280\u548c1\u4e4b\u95f4\u3002</p> </li> <li> <p>\u76ee\u6807\u51fd\u6570\uff1a\u89e3\u7801\u5c42\u7684\u7ed3\u679c\u901a\u5e38\u4f5c\u4e3a\u76ee\u6807\u51fd\u6570\u7684\u8f93\u5165\uff0c\u5e76\u4e0e\u5b9e\u9645\u8f93\u51fa\u8fdb\u884c\u6bd4\u8f83\uff0c\u4ee5\u8bc4\u4f30\u6a21\u578b\u7684\u6027\u80fd\u3002</p> </li> <li> <p>\u591a\u7c7b\u522b\u5206\u7c7b\uff1a\u89e3\u7801\u5c42\u901a\u5e38\u7528\u4e8e\u591a\u7c7b\u522b\u5206\u7c7b\u95ee\u9898\uff0c\u4f8b\u5982\u56fe\u50cf\u5206\u7c7b\uff0c\u6587\u672c\u5206\u7c7b\u7b49\u3002</p> </li> <li> <p>\u89e3\u7801\u6280\u672f\uff1a\u89e3\u7801\u5c42\u7684\u7ed3\u6784\u548c\u6280\u672f\u53ef\u4ee5\u5927\u5927\u5f71\u54cd\u6a21\u578b\u7684\u6027\u80fd\uff0c\u4f8b\u5982\u4f7f\u7528\u4e0d\u540c\u7684\u76ee\u6807\u51fd\u6570\uff0c\u91c7\u7528\u4e0d\u540c\u7684\u89e3\u7801\u7b97\u6cd5\u7b49\u3002</p> </li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_16","title":"\u8f93\u51fa\u5c42","text":"<ul> <li> <p>\u4f5c\u7528\uff1a\u8f93\u51fa\u795e\u7ecf\u7f51\u7edc\u7684\u9884\u6d4b\u7ed3\u679c\u3002</p> </li> <li> <p>\u8f93\u51fa\u7c7b\u578b\uff1a\u8f93\u51fa\u7ed3\u679c\u53ef\u4ee5\u662f\u79bb\u6563\u503c\uff08\u4f8b\u5982\u5206\u7c7b\u95ee\u9898\uff09\u6216\u8fde\u7eed\u503c\uff08\u4f8b\u5982\u56de\u5f52\u95ee\u9898\uff09\u3002</p> </li> <li> <p>\u6fc0\u6d3b\u51fd\u6570\uff1a\u6839\u636e\u95ee\u9898\u7684\u6027\u8d28\uff0c\u8f93\u51fa\u5c42\u53ef\u4ee5\u4f7f\u7528Sigmoid\u3001Softmax\u3001\u7ebf\u6027\u7b49\u6fc0\u6d3b\u51fd\u6570\u3002</p> </li> <li> <p>\u8f93\u51fa\u7ef4\u5ea6\uff1a\u8f93\u51fa\u7ed3\u679c\u7684\u7ef4\u5ea6\u53d6\u51b3\u4e8e\u95ee\u9898\u7684\u6570\u91cf\uff0c\u4f8b\u5982\u5bf9\u4e8e\u5206\u7c7b\u95ee\u9898\uff0c\u8f93\u51fa\u7ed3\u679c\u7684\u7ef4\u5ea6\u662f\u7c7b\u522b\u6570\u91cf\uff0c\u800c\u5bf9\u4e8e\u56de\u5f52\u95ee\u9898\uff0c\u8f93\u51fa\u7ed3\u679c\u7684\u7ef4\u5ea6\u662f\u9884\u6d4b\u7684\u503c\u7684\u6570\u91cf\u3002</p> </li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_17","title":"\u5faa\u73af\u5c42\u548c\u9012\u5f52\u5c42\u7684\u533a\u522b","text":"<ul> <li> <p>\u5faa\u73af\u5c42\uff1a\u5faa\u73af\u5c42\u662f\u6307\u5728\u795e\u7ecf\u7f51\u7edc\u4e2d\u4f7f\u7528\u5faa\u73af\u7ed3\u6784\uff0c\u91cd\u590d\u6267\u884c\u76f8\u540c\u7684\u64cd\u4f5c\uff0c\u9002\u7528\u4e8e\u5904\u7406\u5177\u6709\u5faa\u73af\u6027\u8d28\u7684\u95ee\u9898\u3002</p> </li> <li> <p>\u9012\u5f52\u5c42\uff1a\u9012\u5f52\u5c42\u662f\u6307\u5728\u795e\u7ecf\u7f51\u7edc\u4e2d\u4f7f\u7528\u9012\u5f52\u7ed3\u6784\uff0c\u901a\u8fc7\u9012\u5f52\u8c03\u7528\u81ea\u8eab\u51fd\u6570\uff0c\u9002\u7528\u4e8e\u5904\u7406\u5177\u6709\u9012\u5f52\u6027\u8d28\u7684\u95ee\u9898\u3002</p> </li> <li> <p>\u5904\u7406\u5bf9\u8c61\uff1a\u5faa\u73af\u5c42\u901a\u5e38\u5904\u7406\u7684\u662f\u5e8f\u5217\u6570\u636e\uff0c\u5982\u6587\u672c\uff0c\u65f6\u95f4\u5e8f\u5217\u7b49\uff1b\u9012\u5f52\u5c42\u901a\u5e38\u5904\u7406\u7684\u662f\u6811\u5f62\u7ed3\u6784\uff0c\u5982\u8bed\u6cd5\u6811\uff0c\u51b3\u7b56\u6811\u7b49\u3002</p> </li> <li> <p>\u64cd\u4f5c\u65b9\u5f0f\uff1a\u5faa\u73af\u5c42\u901a\u5e38\u5728\u65f6\u95f4\u4e0a\u5faa\u73af\u5904\u7406\uff1b\u9012\u5f52\u5c42\u901a\u5e38\u5728\u7a7a\u95f4\u4e0a\u9012\u5f52\u5904\u7406\u3002</p> </li> <li> <p>\u5b9e\u73b0\u65b9\u5f0f\uff1a\u5faa\u73af\u5c42\u5e38\u5e38\u4f7f\u7528\u5faa\u73af\u8bed\u53e5\uff0c\u5982for\u5faa\u73af\uff0cwhile\u5faa\u73af\u7b49\uff1b\u9012\u5f52\u5c42\u5e38\u5e38\u4f7f\u7528\u9012\u5f52\u51fd\u6570\uff0c\u5982\u9012\u5f52\u4e0b\u964d\u6cd5\u7b49\u3002</p> </li> </ul> <p>\u795e\u7ecf\u7f51\u7edc\u5404\u5c42\u7684\u7279\u70b9 - \u6398\u91d1</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#1-1","title":"1 * 1 \u5377\u79ef\u5c42\u7684\u4f5c\u7528","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_18","title":"\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\u76f8\u5173\u8ba1\u7b97","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_19","title":"\u5377\u79ef\u5c42","text":"<ul> <li>\u5377\u79ef\u6838\u7684channel\u4e0e\u7279\u5f81\u5377\u79ef\u5c42\u7684channel\u76f8\u540c</li> <li>\u8f93\u51fa\u7684\u7279\u5f81\u77e9\u9635channel\u4e0e\u5377\u79ef\u6838\u4e2a\u6570\u76f8\u540c</li> </ul> <p>\u7ecf\u8fc7\u5377\u79ef\u540e\u7684\u77e9\u9635\u5c3a\u5bf8\u5927\u5c0f\u8ba1\u7b97\u516c\u5f0f\u4e3a\uff1a</p> <p>$$ N = (W-F+2P)/S + 1 $$ 1. \u8f93\u5165\u56fe\u7247\u7684\u5927\u5c0f \\(W \\times W\\) 2. Filter\u5927\u5c0f \\(F \\times F\\) 3. \u6b65\u957f \\(S\\) 4. padding\u7684\u50cf\u7d20\u6570 \\(P\\)</p> <p>\u8f93\u51fa\u5c3a\u5bf8 = (\u8f93\u5165\u5c3a\u5bf8 - \u5377\u79ef\u6838\u5c3a\u5bf8 + 2 * \u586b\u5145\u5927\u5c0f) / \u6b65\u957f + 1</p> <p>sigmoid\u6fc0\u6d3b\u51fd\u6570</p> <p>\u4f5c\u7528\u662f\u5f15\u5165\u975e\u7ebf\u6027\u53d8\u6362\uff0c\u589e\u52a0\u795e\u7ecf\u7f51\u7edc\u7684\u8868\u8fbe\u80fd\u529b\u3002</p> <p>$$ f(x) = \\frac{1}{1+e^{-x}} $$ \u7f51\u7edc\u5c42\u6570\u8f83\u6df1\u65f6\uff0c\u6613\u51fa\u73b0\u68af\u5ea6\u6d88\u5931</p> <p>Relu\u6fc0\u6d3b\u51fd\u6570</p> \\[ f(x) = Max(0,x) \\] <ol> <li> <p>Dying ReLU\u95ee\u9898\uff1a\u5f53\u795e\u7ecf\u5143\u7684\u8f93\u5165\u503c\u4e3a\u8d1f\u6570\u65f6\uff0cReLU \u51fd\u6570\u7684\u8f93\u51fa\u4e3a\u96f6\uff0c\u5bfc\u81f4\u795e\u7ecf\u5143\u5931\u6d3b\u3002\u5728\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679c\u4e00\u65e6\u67d0\u4e2a\u795e\u7ecf\u5143\u7684\u6743\u91cd\u88ab\u66f4\u65b0\u5230\u4f7f\u5176\u8f93\u51fa\u4e3a\u8d1f\u6570\uff0c\u90a3\u4e48\u8be5\u795e\u7ecf\u5143\u5728\u540e\u7eed\u7684\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\u5c06\u4e0d\u518d\u6fc0\u6d3b\uff0c\u5bfc\u81f4\u8be5\u795e\u7ecf\u5143\u6c38\u8fdc\u4e0d\u4f1a\u5b66\u4e60\u3002\u8fd9\u79cd\u60c5\u51b5\u79f0\u4e3a \"Dying ReLU\"\uff0c\u5f71\u54cd\u4e86\u7f51\u7edc\u7684\u8868\u8fbe\u80fd\u529b\u3002</p> </li> <li> <p>\u8f93\u51fa\u4e0d\u662f\u96f6\u4e2d\u5fc3\uff1aReLU \u7684\u8f93\u51fa\u8303\u56f4\u5728\u6b63\u534a\u8f74\uff0c\u5373 [0, +\u221e)\uff0c\u56e0\u6b64\u5176\u5747\u503c\u4e0d\u4e3a\u96f6\u3002\u8fd9\u5bfc\u81f4\u4e86\u4e00\u4e9b\u95ee\u9898\uff0c\u6bd4\u5982\u5728\u7f51\u7edc\u5c42\u53e0\u52a0\u65f6\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u68af\u5ea6\u7206\u70b8\u6216\u6d88\u5931\u3002</p> </li> <li> <p>\u4e0d\u9002\u5408\u5904\u7406\u8d1f\u6570\u8f93\u5165\uff1aReLU \u5728\u8f93\u5165\u4e3a\u8d1f\u6570\u65f6\u8f93\u51fa\u4e3a\u96f6\uff0c\u8fd9\u53ef\u80fd\u4e0d\u9002\u5408\u67d0\u4e9b\u60c5\u51b5\u3002\u6bd4\u5982\u5728\u67d0\u4e9b\u56de\u5f52\u4efb\u52a1\u4e2d\uff0c\u8f93\u51fa\u9700\u8981\u5305\u542b\u8d1f\u6570\u503c\uff0c\u4f46 ReLU \u51fd\u6570\u65e0\u6cd5\u76f4\u63a5\u5904\u7406\u8fd9\u4e9b\u60c5\u51b5\u3002</p> </li> <li> <p>\u5bfc\u81f4\u68af\u5ea6\u6d88\u5931\uff1a\u867d\u7136 ReLU \u53ef\u4ee5\u89e3\u51b3\u68af\u5ea6\u6d88\u5931\u95ee\u9898\uff0c\u4f46\u5b83\u4ecd\u7136\u53ef\u80fd\u5bfc\u81f4\u68af\u5ea6\u6d88\u5931\u3002\u5728\u8bad\u7ec3\u8fc7\u7a0b\u4e2d\uff0c\u67d0\u4e9b\u795e\u7ecf\u5143\u53ef\u80fd\u4f1a\u6c38\u8fdc\u4fdd\u6301\u975e\u6d3b\u8dc3\u72b6\u6001\uff0c\u5bfc\u81f4\u5b83\u4eec\u7684\u6743\u91cd\u59cb\u7ec8\u4e0d\u4f1a\u88ab\u66f4\u65b0\uff0c\u4ece\u800c\u9020\u6210\u68af\u5ea6\u6d88\u5931\u95ee\u9898\u3002</p> </li> <li> <p>\u4e0d\u662f\u5e73\u6ed1\u51fd\u6570\uff1aReLU \u5728\u96f6\u70b9\u5904\u4e0d\u53ef\u5bfc\uff0c\u8fd9\u5728\u67d0\u4e9b\u4f18\u5316\u7b97\u6cd5\u4e2d\u53ef\u80fd\u4f1a\u5bfc\u81f4\u95ee\u9898</p> </li> </ol>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_20","title":"\u4ee5\u4e0a\u7684\u5185\u5bb9\u9700\u8981\u6574\u7406","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#_21","title":"\u5f52\u4e00\u5316","text":"<p>\u5f52\u4e00\u5316\u57fa\u7840\u77e5\u8bc6\u70b9 \u2014 PaddleEdu documentation</p> <p>\u5f52\u4e00\u5316\u7684\u76ee\u7684\u5c31\u662f\u4f7f\u5f97\u9884\u5904\u7406\u7684\u6570\u636e\u88ab\u9650\u5b9a\u5728\u4e00\u5b9a\u7684\u8303\u56f4\u5185\uff0c\u6bd4\u5982[0,1]\u6216\u8005[-1,1]\uff0c\u6d88\u9664\u5947\u5f02\u6837\u672c\u6570\u636e\u5bfc\u81f4\u7684\u4e0d\u826f\u5f71\u54cd</p> <p>\u6bd4\u5982\uff0c\u4e0b\u9762\u7684x6\u5c31\u662f\u5947\u5f02\u6570\u636e</p> x1 x2 x3 x4 x5 x6 1.1 1.6 1.3 1.5 1.2 6.6 <p>\u5982\u679c\u4e0d\u8fdb\u884c\u5f52\u4e00\u5316\uff0c\u90a3\u4e48\u7531\u4e8e\u7279\u5f81\u5411\u91cf\u4e2d\u4e0d\u540c\u7279\u5f81\u7684\u53d6\u503c\u76f8\u5dee\u8f83\u5927\uff0c\u68af\u5ea6\u5bb9\u6613\u504f\u79bb\u6700\u5c0f\u503c\u7684\u65b9\u5411</p> <p>\u5f52\u4e00\u5316\u7684\u597d\u5904\uff1a</p> <ol> <li>\u52a0\u5feb\u68af\u5ea6\u4e0b\u964d\u6c42\u6700\u4f18\u89e3\u7684\u901f\u5ea6\uff08\u52a0\u5feb\u8bad\u7ec3\u7f51\u7edc\u7684\u6536\u655b\u6027\uff09</li> <li>\u5f52\u4e00\u5316\u6709\u53ef\u80fd\u63d0\u9ad8\u7cbe\u5ea6</li> </ol> <p>\u5e38\u7528\u7684\u5f52\u4e00\u5316\u65b9\u6cd5\u5305\u62ec\uff1a</p> <ol> <li> <p>\u6700\u5c0f-\u6700\u5927\u5f52\u4e00\u5316\uff08MinMax normalization\uff09\uff1a\u5c06\u6570\u636e\u7f29\u653e\u5230\u6307\u5b9a\u7684\u6700\u5c0f\u503c\u548c\u6700\u5927\u503c\u4e4b\u95f4\u3002\u516c\u5f0f\u4e3a\uff1a $$ X_{normalized} = (X - X_{min}) / (X_{max} - X_{min}) $$</p> </li> <li> <p>Z-Score\u6807\u51c6\u5316\uff08Z-Score normalization\uff09\uff1a\u5c06\u6570\u636e\u8f6c\u5316\u4e3a\u5747\u503c\u4e3a0\uff0c\u6807\u51c6\u5dee\u4e3a1\u7684\u6b63\u6001\u5206\u5e03\u3002\u516c\u5f0f\u4e3a\uff1a $$ X_{normalized} = (X - X_{mean}) / X_{std} $$</p> </li> <li> <p>\u5c0f\u6570\u5b9a\u6807\u6807\u51c6\u5316\uff08Decimal scaling normalization\uff09\uff1a\u5c06\u6570\u636e\u9664\u4ee5\u67d0\u4e2a\u6570\u7684\u5e42\uff0c\u4f7f\u5176\u843d\u5728[-1,1]\u6216[0,1]\u4e4b\u95f4\u3002\u516c\u5f0f\u4e3a\uff1a $$ X_{normalized} = X / 10^d $$</p> </li> </ol> <p>\u5176\u4e2dd\u4e3a\u4f7f\u5f97\u6700\u5927\u7edd\u5bf9\u503c\u5c0f\u4e8e1\u7684\u6570\u7684\u5e42\u6b21\u6570\u3002</p> <p>\u6279\u91cf\u5f52\u4e00\u5316\u5c42\uff1a</p> <ul> <li>\u53ef\u5b66\u4e60\u7684\u53c2\u6570\u4e3a\\(\\gamma\\)\u548c\\(\\beta\\)</li> <li>\u4f5c\u7528\u5728<ul> <li>\u5168\u8fde\u63a5\u5c42\u548c\u5377\u79ef\u5c42\u8f93\u51fa\u4e0a\uff0c\u6fc0\u6d3b\u51fd\u6570\u524d</li> <li>\u5168\u8fde\u63a5\u5c42\u548c\u5377\u79ef\u5c42\u8f93\u5165\u4e0a</li> </ul> </li> <li>\u5bf9\u5168\u8fde\u63a5\u5c42\uff0c\u4f5c\u7528\u5728\u7279\u5f81\u7ef4</li> <li>\u5bf9\u4e8e\u5377\u79ef\u5c42\uff0c\u4f5c\u7528\u5728\u901a\u9053\u7ef4</li> </ul> <p>\u4f7f\u7528\u8981\u6c42\uff0c\u6570\u636e\u91cf\u8db3\u591f\u5927</p> <p>\u5728\u6279\u91cf\u5f52\u4e00\u5316\uff08Batch Normalization\uff09\u4e2d\uff0c\u7ed9\u5b9a\u4e00\u6279\u6837\u672c\uff1a\\(x^{(1)}, x^{(2)}, ..., x^{(m)}\\)\uff0c\u5f52\u4e00\u5316\u7684\u516c\u5f0f\u5982\u4e0b\uff1a</p> \\[ \\hat{x}^{(i)} = \\frac{x^{(i)} - \\mu}{\\sqrt{\\sigma^2 + \\epsilon}} \\] <p>\u5176\u4e2d\uff0c\\(\\mu\\)\u8868\u793a\u6574\u4e2a\u6279\u6b21\u6837\u672c\u7684\u5747\u503c\uff0c\\(\\sigma^2\\)\u8868\u793a\u6574\u4e2a\u6279\u6b21\u6837\u672c\u7684\u65b9\u5dee\uff0c\\(\\epsilon\\)\u662f\u4e00\u4e2a\u5f88\u5c0f\u7684\u6570\uff0c\u7528\u6765\u907f\u514d\u5206\u6bcd\u4e3a\u96f6\u3002\u5f52\u4e00\u5316\u5b8c\u6210\u4e4b\u540e\uff0c\u518d\u4f7f\u7528\u7f29\u653e\u56e0\u5b50\\(\\gamma\\)\u548c\u504f\u79fb\u91cf\\(\\beta\\)\u5bf9\u5f52\u4e00\u5316\u7684\u7ed3\u679c\u8fdb\u884c\u8fd8\u539f\uff1a</p> \\[ y^{(i)} = \\gamma \\hat{x}^{(i)} + \\beta \\] <p>\u5176\u4e2d\uff0c\\(\\gamma\\)\u548c\\(\\beta\\)\u662f\u53ef\u4ee5\u5b66\u4e60\u7684\u53c2\u6570\u3002</p> <p>\u6ca1\u5fc5\u8981\u548cdropout\u6df7\u5408\u4f7f\u7528</p> <ul> <li>\u6279\u91cf\u5f52\u4e00\u5316\u56fa\u5b9a\u5c0f\u6279\u91cf\u4e2d\u7684\u5747\u503c\u548c\u65b9\u5dee\uff0c\u7136\u540e\u5b66\u4e60\u51fa\u9002\u5408\u7684\u504f\u79fb\u548c\u7f29\u653e</li> <li>\u53ef\u4ee5\u52a0\u901f\u6536\u655b\u901f\u5ea6\uff0c\u4f46\u4e00\u822c\u4e0d\u6539\u53d8\u6a21\u578b\u7cbe\u5ea6</li> </ul>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/#resnet","title":"\u6b8b\u5dee\u795e\u7ecf\u7f51\u7edc ResNet","text":""},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/CV/yolo/yolo%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/","title":"yoloV5\u57fa\u672c\u4ecb\u7ecd","text":"<p>\u6267\u884cyolo v5</p> <pre><code>python detect.py\n</code></pre> <p>\u975e\u6781\u5927\u503c\u6291\u5236 NMS</p> <p>https://zhuanlan.zhihu.com/p/78504109</p> <p>YOLO\u7684\u6784\u6210\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u4e3b\u8981\u90e8\u5206\uff1a\u7279\u5f81\u63d0\u53d6\u7f51\u7edc\u3001\u611f\u5174\u8da3\u533a\u57df\uff08Region of Interest\uff0cROI\uff09\u5212\u5206\u548c\u9884\u6d4b\u3002</p> <ol> <li> <p>\u7279\u5f81\u63d0\u53d6\u7f51\u7edc\uff1a YOLO\u4f7f\u7528\u6df1\u5ea6\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\uff08Convolutional Neural Network\uff0cCNN\uff09\u4f5c\u4e3a\u7279\u5f81\u63d0\u53d6\u7f51\u7edc\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u91c7\u7528\u5df2\u7ecf\u5728\u5927\u89c4\u6a21\u56fe\u50cf\u6570\u636e\u96c6\u4e0a\u9884\u8bad\u7ec3\u597d\u7684CNN\u6a21\u578b\uff0c\u4f8b\u5982VGGNet\u6216DarkNet\u4f5c\u4e3a\u7279\u5f81\u63d0\u53d6\u5668\u3002\u8fd9\u4e9b\u6a21\u578b\u80fd\u591f\u5b66\u4e60\u5230\u56fe\u50cf\u7684\u9ad8\u7ea7\u7279\u5f81\u8868\u793a\u3002</p> </li> <li> <p>\u611f\u5174\u8da3\u533a\u57df\uff08Region of Interest\uff0cROI\uff09\u5212\u5206\uff1a \u5728\u7279\u5f81\u56fe\u4e0a\uff0cYOLO\u5c06\u56fe\u50cf\u5206\u6210\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u7f51\u683c\u5355\u5143\u3002\u6bcf\u4e2a\u7f51\u683c\u5355\u5143\u8d1f\u8d23\u68c0\u6d4b\u8be5\u5355\u5143\u4e2d\u7269\u4f53\u7684\u4f4d\u7f6e\u548c\u7c7b\u522b\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u7f51\u683c\u5355\u5143\uff0cYOLO\u4f1a\u9884\u6d4b\u4e00\u4e2a\u8fb9\u754c\u6846\uff08bounding box\uff09\uff0c\u5373\u5305\u56f4\u7269\u4f53\u7684\u77e9\u5f62\u6846\uff0c\u5e76\u8f93\u51fa\u6846\u5185\u7269\u4f53\u7684\u7c7b\u522b\u6982\u7387\u3002</p> </li> <li> <p>\u9884\u6d4b\uff1a \u5bf9\u4e8e\u6bcf\u4e2a\u7f51\u683c\u5355\u5143\uff0cYOLO\u9884\u6d4b\u8fb9\u754c\u6846\u7684\u5750\u6807\u4ee5\u53ca\u6bcf\u4e2a\u8fb9\u754c\u6846\u4e2d\u5305\u542b\u7684\u7269\u4f53\u7c7b\u522b\u7684\u6982\u7387\u3002\u8fd9\u4e9b\u9884\u6d4b\u503c\u901a\u8fc7\u5377\u79ef\u548c\u5168\u8fde\u63a5\u5c42\u6765\u751f\u6210\u3002YOLO\u4f7f\u7528\u5355\u4e2a\u5377\u79ef\u5c42\u6765\u540c\u65f6\u9884\u6d4b\u8fb9\u754c\u6846\u7684\u4f4d\u7f6e\u548c\u7c7b\u522b\u6982\u7387\uff0c\u5e76\u5728\u6700\u540e\u4e00\u5c42\u4f7f\u7528\u975e\u7ebf\u6027\u6fc0\u6d3b\u51fd\u6570\uff08\u5982sigmoid\uff09\u5c06\u5750\u6807\u9650\u5236\u5728\u56fe\u50cf\u8303\u56f4\u5185\u3002</p> </li> </ol> <p></p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/CV/yolo/yolo%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#_1","title":"\u9884\u6d4b\u9636\u6bb5(\u524d\u5411\u63a8\u65ad)","text":"<ol> <li> <p>\u8f93\u5165\u56fe\u50cf\u88ab\u5206\u5272\u6210\u4e00\u4e2a\u56fa\u5b9a\u5927\u5c0f\u7684\u7f51\u683c\uff08\u4f8b\u5982\uff0c\u5c06\u56fe\u50cf\u5212\u5206\u4e3a S \u00d7 S \u7684\u7f51\u683c\uff0c\u6bcf\u4e2a\u683c\u5b50\u5927\u5c0f\u4e3a W \u00d7 H\uff09\u3002</p> </li> <li> <p>\u5bf9\u6bcf\u4e2a\u683c\u5b50\uff0c\u9884\u6d4b\u591a\u4e2a\u8fb9\u754c\u6846\uff08bounding boxes\uff09\u4ee5\u53ca\u8fd9\u4e9b\u8fb9\u754c\u6846\u4e2d\u5305\u542b\u7684\u76ee\u6807\u7684\u7c7b\u522b\u6982\u7387\u3002\u6bcf\u4e2a\u8fb9\u754c\u6846\u901a\u5e38\u7531 5 \u4e2a\u53c2\u6570\u63cf\u8ff0\uff1ax\u3001y\uff08\u8fb9\u754c\u6846\u7684\u4e2d\u5fc3\u5750\u6807\uff09\u3001w\u3001h\uff08\u8fb9\u754c\u6846\u7684\u5bbd\u5ea6\u548c\u9ad8\u5ea6\uff09\u4ee5\u53ca\u4e00\u4e2a\u7f6e\u4fe1\u5ea6\u5206\u6570\u3002</p> </li> <li> <p>\u5bf9\u6bcf\u4e2a\u683c\u5b50\u4e2d\u7684\u8fb9\u754c\u6846\u8fdb\u884c\u7b5b\u9009\uff0c\u6839\u636e\u7f6e\u4fe1\u5ea6\u5206\u6570\u8fdb\u884c\u9608\u503c\u8fc7\u6ee4\uff0c\u53ea\u4fdd\u7559\u7f6e\u4fe1\u5ea6\u9ad8\u4e8e\u9884\u8bbe\u9608\u503c\u7684\u8fb9\u754c\u6846\u3002</p> </li> <li> <p>\u4f7f\u7528\u975e\u6781\u5927\u503c\u6291\u5236\uff08non-maximum suppression\uff0cNMS\uff09\u8fdb\u4e00\u6b65\u5904\u7406\uff0c\u53bb\u9664\u5197\u4f59\u7684\u8fb9\u754c\u6846\u3002NMS \u4f1a\u8ba1\u7b97\u8fb9\u754c\u6846\u4e4b\u95f4\u7684\u91cd\u53e0\u5ea6\uff0c\u5e76\u4fdd\u7559\u5177\u6709\u6700\u9ad8\u7f6e\u4fe1\u5ea6\u7684\u8fb9\u754c\u6846\uff0c\u540c\u65f6\u5220\u9664\u4e0e\u5176\u9ad8\u91cd\u53e0\u5ea6\u7684\u5176\u4ed6\u8fb9\u754c\u6846\u3002</p> </li> <li> <p>\u6700\u540e\u5f97\u5230\u7684\u8fb9\u754c\u6846\u5373\u4e3a\u6a21\u578b\u9884\u6d4b\u7684\u76ee\u6807\u4f4d\u7f6e\u548c\u7c7b\u522b\u3002</p> </li> </ol> <p>\u6574\u4e2a\u8fc7\u7a0b\u662f\u7aef\u5230\u7aef\u7684\uff0c\u5373\u4e00\u6b21\u524d\u5411\u63a8\u65ad\u5373\u53ef\u5f97\u5230\u76ee\u6807\u68c0\u6d4b\u7ed3\u679c\u3002YOLO \u7684\u4f18\u52bf\u5728\u4e8e\u5176\u5b9e\u65f6\u6027\u548c\u8f83\u9ad8\u7684\u51c6\u786e\u7387\uff0c\u4f46\u4e5f\u7531\u4e8e\u56fa\u5b9a\u7f51\u683c\u7684\u5212\u5206\u65b9\u5f0f\uff0c\u53ef\u80fd\u5bf9\u5c0f\u5c3a\u5bf8\u76ee\u6807\u7684\u68c0\u6d4b\u6548\u679c\u8f83\u5dee\u3002</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/CV/yolo/yolo%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#_2","title":"\u9884\u6d4b\u9636\u6bb5(\u540e\u5904\u7406)","text":"<ol> <li> <p>\u5148\u9a8c\u6846\u89e3\u7801\uff1a\u5728\u8bad\u7ec3\u9636\u6bb5\uff0cYOLOv1\u901a\u8fc7\u5bf9\u8bad\u7ec3\u96c6\u8fdb\u884c\u805a\u7c7b\u5206\u6790\uff0c\u5f97\u5230\u4e00\u7ec4\u5148\u9a8c\u6846\uff08anchor boxes\uff09\uff0c\u8fd9\u4e9b\u5148\u9a8c\u6846\u4ee3\u8868\u4e86\u4e0d\u540c\u5c3a\u5ea6\u548c\u957f\u5bbd\u6bd4\u7684\u76ee\u6807\u3002\u5728\u9884\u6d4b\u9636\u6bb5\uff0c\u5148\u9a8c\u6846\u9700\u8981\u88ab\u89e3\u7801\uff0c\u5c06\u5176\u8f6c\u6362\u4e3a\u5b9e\u9645\u56fe\u50cf\u4e0a\u7684\u8fb9\u754c\u6846\u3002</p> </li> <li> <p>\u7c7b\u522b\u6982\u7387\u8ba1\u7b97\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u5148\u9a8c\u6846\uff0cYOLOv1\u4f1a\u9884\u6d4b\u51fa\u591a\u4e2a\u7c7b\u522b\u7684\u6982\u7387\u3002\u8fd9\u4e9b\u6982\u7387\u9700\u8981\u901a\u8fc7softmax\u51fd\u6570\u8fdb\u884c\u5f52\u4e00\u5316\uff0c\u4ee5\u5f97\u5230\u6bcf\u4e2a\u7c7b\u522b\u7684\u9884\u6d4b\u6982\u7387\u3002</p> </li> <li> <p>\u8fb9\u754c\u6846\u7b5b\u9009\uff1a\u7531\u4e8eYOLOv1\u5728\u56fe\u50cf\u4e0a\u4f7f\u7528\u4e86\u7f51\u683c\u5212\u5206\uff0c\u6bcf\u4e2a\u7f51\u683c\u9884\u6d4b\u51fa\u7684\u8fb9\u754c\u6846\u53ef\u80fd\u4f1a\u6709\u91cd\u53e0\u3002\u4e3a\u4e86\u907f\u514d\u91cd\u590d\u7684\u68c0\u6d4b\u7ed3\u679c\uff0c\u9700\u8981\u8fdb\u884c\u975e\u6700\u5927\u6291\u5236\uff08Non-Maximum Suppression\uff09\u6765\u7b5b\u9009\u8fb9\u754c\u6846\u3002\u975e\u6700\u5927\u6291\u5236\u7684\u76ee\u6807\u662f\u9009\u62e9\u7f6e\u4fe1\u5ea6\u6700\u9ad8\u7684\u8fb9\u754c\u6846\uff0c\u5e76\u4e14\u6392\u9664\u6389\u4e0e\u5176IoU\uff08\u4ea4\u5e76\u6bd4\uff09\u5927\u4e8e\u4e00\u5b9a\u9608\u503c\u7684\u5176\u4ed6\u8fb9\u754c\u6846\u3002</p> </li> <li> <p>\u8fb9\u754c\u6846\u8c03\u6574\uff1a\u5728\u975e\u6700\u5927\u6291\u5236\u4e4b\u540e\uff0c\u6700\u7ec8\u7684\u8fb9\u754c\u6846\u9700\u8981\u8fdb\u884c\u8c03\u6574\uff0c\u4ee5\u9002\u5e94\u539f\u59cb\u56fe\u50cf\u4e0a\u7684\u76ee\u6807\u4f4d\u7f6e\u3002\u8fd9\u4e00\u6b65\u9aa4\u901a\u5e38\u6d89\u53ca\u5230\u5bf9\u8fb9\u754c\u6846\u7684\u5e73\u79fb\u3001\u7f29\u653e\u548c\u88c1\u526a\u7b49\u64cd\u4f5c\u3002</p> </li> </ol> <ol> <li> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u7f51\u683c\u5355\u5143\uff0c\u6839\u636e\u9884\u6d4b\u7684\u8fb9\u754c\u6846\u7684\u7f6e\u4fe1\u5ea6\uff08confidence\uff09\u8fdb\u884c\u9608\u503c\u7b5b\u9009\uff0c\u5254\u9664\u7f6e\u4fe1\u5ea6\u8f83\u4f4e\u7684\u8fb9\u754c\u6846\u3002</p> </li> <li> <p>\u5bf9\u4e8e\u5269\u4f59\u7684\u8fb9\u754c\u6846\uff0c\u4f7f\u7528\u975e\u6781\u5927\u503c\u6291\u5236\uff08Non-maximum Suppression\uff0cNMS\uff09\u7b97\u6cd5\u8fdb\u884c\u91cd\u53e0\u8fb9\u754c\u6846\u7684\u5408\u5e76\u3002NMS\u7b97\u6cd5\u4f1a\u6839\u636e\u91cd\u53e0\u5ea6\uff08IoU\uff09\u5c06\u91cd\u53e0\u8f83\u9ad8\u7684\u8fb9\u754c\u6846\u5408\u5e76\u4e3a\u4e00\u4e2a\uff0c\u5e76\u9009\u62e9\u7f6e\u4fe1\u5ea6\u6700\u9ad8\u7684\u8fb9\u754c\u6846\u4f5c\u4e3a\u6700\u7ec8\u7684\u68c0\u6d4b\u7ed3\u679c\u3002</p> </li> <li> <p>\u6700\u540e\uff0c\u6839\u636e\u7f6e\u4fe1\u5ea6\u7684\u9608\u503c\u518d\u6b21\u7b5b\u9009\u51fa\u7f6e\u4fe1\u5ea6\u9ad8\u4e8e\u9608\u503c\u7684\u8fb9\u754c\u6846\uff0c\u4f5c\u4e3a\u6700\u7ec8\u7684\u68c0\u6d4b\u7ed3\u679c\u3002</p> </li> </ol> <p>yolov1\u4e2d\u7684\u9884\u5904\u7406\u9636\u6bb5,\u4e00\u683c\u4ea7\u751f\u591a\u5c11\u4e2abounding box,\u4e3a\u4ec0\u4e48?</p> <p>\u5728YOLOv1\u4e2d\u7684\u9884\u5904\u7406\u9636\u6bb5\uff0c\u6bcf\u4e2a\u5355\u5143\u683c\uff08grid cell\uff09\u4ea7\u751f\u7684bounding box\u7684\u6570\u91cf\u7531\u4e24\u4e2a\u56e0\u7d20\u51b3\u5b9a\uff1a\u5148\u9a8c\u6846\uff08prior box\uff09\u7684\u6570\u91cf\u548c\u6bcf\u4e2a\u5355\u5143\u683c\u9884\u6d4b\u7684\u7c7b\u522b\u6570\u3002</p> <p>\u9996\u5148\uff0cYOLOv1\u5c06\u8f93\u5165\u56fe\u50cf\u5212\u5206\u4e3aS \u00d7 S\u4e2a\u5355\u5143\u683c\uff0c\u5176\u4e2dS\u662f\u9884\u5b9a\u4e49\u7684\u7f51\u683c\u5927\u5c0f\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u5355\u5143\u683c\uff0c\u6a21\u578b\u5c06\u9884\u6d4bB\u4e2abounding box\uff0c\u5176\u4e2dB\u662f\u5148\u9a8c\u6846\u7684\u6570\u91cf\u3002</p> <p>\u5176\u6b21\uff0c\u6bcf\u4e2abounding box\u9884\u6d4b\u4e00\u4e2a\u8fb9\u754c\u6846\u7684\u4f4d\u7f6e\u548c\u7f6e\u4fe1\u5ea6\u5206\u6570\uff0c\u4ee5\u53caC\u4e2a\u7c7b\u522b\u7684\u6982\u7387\u5206\u5e03\uff0c\u5176\u4e2dC\u662f\u6a21\u578b\u9700\u8981\u5206\u7c7b\u7684\u7c7b\u522b\u6570\u3002\u56e0\u6b64\uff0c\u6bcf\u4e2abounding box\u7684\u9884\u6d4b\u8f93\u51fa\u5305\u62ec4\u4e2a\u8fb9\u754c\u6846\u5750\u6807\u3001\u4e00\u4e2a\u7f6e\u4fe1\u5ea6\u5206\u6570\u548cC\u4e2a\u7c7b\u522b\u7684\u6982\u7387\u5206\u5e03\uff0c\u603b\u5171\u67095 + C\u4e2a\u9884\u6d4b\u503c\u3002</p> <p>\u56e0\u6b64\uff0c\u6bcf\u4e2a\u5355\u5143\u683c\u5c06\u751f\u6210B\u4e2abounding box\uff0c\u6bcf\u4e2abounding box\u90fd\u67095 + C\u4e2a\u9884\u6d4b\u503c\uff0c\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u6bcf\u4e2a\u5355\u5143\u683c\u4f1a\u4ea7\u751f\u591a\u4e2abounding box\u7684\u539f\u56e0\u3002\u8fd9\u6837\u8bbe\u8ba1\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u6355\u6349\u4e0d\u540c\u5c3a\u5ea6\u548c\u4e0d\u540c\u7c7b\u522b\u7684\u76ee\u6807\u7269\u4f53\u3002</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/CV/yolo/yolo%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#nms","title":"NMS \u975e\u6781\u5927\u503c\u6291\u5236","text":"<p>\u5728\u76ee\u6807\u68c0\u6d4b\u4efb\u52a1\u4e2d\uff0c\u4e00\u5f20\u56fe\u50cf\u53ef\u80fd\u4f1a\u751f\u6210\u591a\u4e2a\u91cd\u53e0\u7684\u8fb9\u754c\u6846\uff0c\u6bcf\u4e2a\u8fb9\u754c\u6846\u90fd\u8868\u793a\u4e00\u4e2a\u53ef\u80fd\u7684\u7269\u4f53\u3002\u4e3a\u4e86\u6d88\u9664\u91cd\u53e0\u8fb9\u754c\u6846\u5e76\u9009\u62e9\u6700\u4f73\u7684\u8fb9\u754c\u6846\uff0cNMS\u88ab\u5e94\u7528\u4e8eYoloV1\u7684\u8f93\u51fa\u3002</p> <p>NMS\u7684\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a 1. \u5bf9\u4e8e\u6bcf\u4e2a\u7c7b\u522b\u7684\u8fb9\u754c\u6846\uff0c\u6839\u636e\u7f6e\u4fe1\u5ea6\u6392\u5e8f\u3002 2. \u9009\u62e9\u7f6e\u4fe1\u5ea6\u6700\u9ad8\u7684\u8fb9\u754c\u6846\uff0c\u5c06\u5176\u6dfb\u52a0\u5230\u6700\u7ec8\u8f93\u51fa\u5217\u8868\u4e2d\u3002 3. \u5bf9\u4e8e\u5269\u4f59\u7684\u8fb9\u754c\u6846\uff0c\u8ba1\u7b97\u5b83\u4eec\u4e0e\u5df2\u9009\u62e9\u7684\u8fb9\u754c\u6846\u7684\u91cd\u53e0\u7a0b\u5ea6\uff08\u5982IoU\uff09\u3002 4. \u5982\u679c\u91cd\u53e0\u7a0b\u5ea6\u8d85\u8fc7\u4e86\u4e00\u5b9a\u7684\u9608\u503c\uff0c\u5219\u5c06\u8be5\u8fb9\u754c\u6846\u4e22\u5f03\u3002 5. \u91cd\u590d\u6b65\u9aa42-4\uff0c\u76f4\u5230\u6240\u6709\u8fb9\u754c\u6846\u90fd\u88ab\u5904\u7406\u5b8c\u3002</p> <p>IOU Intersection over Union\uff08\u4ea4\u5e76\u6bd4\uff09\u4e24\u4e2a\u6846\u7684\u4ea4\u96c6\u9762\u79ef/\u5e76\u96c6\u9762\u79ef</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/CV/yolo/yolo%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D/#_3","title":"\u8bad\u7ec3\u9636\u6bb5(\u53cd\u5411\u4f20\u64ad)","text":"<p>\u635f\u5931\u51fd\u6570: </p> \\[ \\mathcal{L}_{\\text{YOLO}} = \\lambda_{\\text{coord}} \\sum_{i=0}^{S^2} \\sum_{j=0}^{B} \\mathbb{1}_{{ij}}^{\\text{obj}} \\left[ (x_i - \\hat{x}_i)^2 + (y_i - \\hat{y}_i)^2 \\right] \\\\ + \\lambda_{\\text{coord}} \\sum_{i=0}^{S^2} \\sum_{j=0}^{B} \\mathbb{1}_{{ij}}^{\\text{obj}} \\left[ (\\sqrt{w_i} - \\sqrt{\\hat{w}_i})^2 + (\\sqrt{h_i} - \\sqrt{\\hat{h}_i})^2 \\right] \\\\ + \\sum_{i=0}^{S^2} \\sum_{j=0}^{B} \\mathbb{1}_{{ij}}^{\\text{obj}} (C_i - \\hat{C}_i)^2 \\\\ + \\lambda_{\\text{noobj}} \\sum_{i=0}^{S^2} \\sum_{j=0}^{B} \\mathbb{1}_{{ij}}^{\\text{noobj}} (C_i - \\hat{C}_i)^2 \\\\ + \\sum_{i=0}^{S^2} \\mathbb{1}_{{i}}^{\\text{obj}} \\sum_{c \\in \\text{classes}} (p_i(c) - \\hat{p}_i(c))^2 \\] <p>\u5176\u4e2d\uff0c\\(S\\)\u8868\u793a\u8f93\u5165\u56fe\u50cf\u88ab\u5212\u5206\u7684\u683c\u5b50\u6570\u91cf\uff0c\\(B\\)\u8868\u793a\u6bcf\u4e2a\u683c\u5b50\u751f\u6210\u7684\u8fb9\u754c\u6846\u6570\u91cf\uff0c\\(\\lambda_{\\text{coord}}\\)\u548c\\(\\lambda_{\\text{noobj}}\\)\u662f\u8c03\u8282\u5750\u6807\u635f\u5931\u548c\u80cc\u666f\u635f\u5931\u7684\u6743\u91cd\u3002\\(\\mathbb{1}_{{ij}}^{\\text{obj}}\\)\u548c\\(\\mathbb{1}_{{ij}}^{\\text{noobj}}\\)\u5206\u522b\u8868\u793a\u7b2c\\(i\\)\u4e2a\u683c\u5b50\u4e2d\u7b2c\\(j\\)\u4e2a\u8fb9\u754c\u6846\u662f\u5426\u542b\u6709\u76ee\u6807\u548c\u662f\u5426\u4e0d\u542b\u6709\u76ee\u6807\u3002\\(x_i, y_i, w_i, h_i\\)\u662f\u7b2c\\(i\\)\u4e2a\u683c\u5b50\u4e2d\u7b2c\\(j\\)\u4e2a\u8fb9\u754c\u6846\u7684\u4e2d\u5fc3\u5750\u6807\u548c\u5bbd\u9ad8\uff0c\\(C_i\\)\u662f\u7b2c\\(i\\)\u4e2a\u683c\u5b50\u4e2d\u7b2c\\(j\\)\u4e2a\u8fb9\u754c\u6846\u662f\u5426\u542b\u6709\u76ee\u6807\u7684\u7f6e\u4fe1\u5ea6\uff0c\\(p_i(c)\\)\u662f\u7b2c\\(i\\)\u4e2a\u683c\u5b50\u4e2d\u7b2c\\(j\\)\u4e2a\u8fb9\u754c\u6846\u5c5e\u4e8e\u7c7b\u522b\\(c\\)\u7684\u6982\u7387\u3002</p> <p>\\(\\hat{x}_i, \\hat{y}_i, \\hat{w}_i, \\hat{h}_i\\)\u662f\u9884\u6d4b\u503c\uff0c\\(\\hat{C}_i\\)\u662f\u76ee\u6807\u503c\uff0c\\(\\hat{p}_i(c)\\)\u662f\u771f\u5b9e\u7c7b\u522b\\(c\\)\u7684\u6982\u7387\u3002</p> <p>\u635f\u5931\u51fd\u6570\u5305\u62ec\u5750\u6807\u635f\u5931\u3001\u7f6e\u4fe1\u5ea6\u635f\u5931\u548c\u7c7b\u522b\u635f\u5931\u3002\u5750\u6807\u635f\u5931\u8861\u91cf\u9884\u6d4b\u7684\u8fb9\u754c\u6846\u4e0e\u771f\u5b9e\u8fb9\u754c\u6846\u7684\u4e2d\u5fc3\u5750\u6807\u548c\u5bbd\u9ad8\u4e4b\u95f4\u7684\u5dee\u5f02\u3002\u7f6e\u4fe1\u5ea6\u635f\u5931\u8861\u91cf\u9884\u6d4b\u7684\u8fb9\u754c\u6846\u662f\u5426\u542b\u6709\u76ee\u6807\u7684\u51c6\u786e\u5ea6\u3002\u7c7b\u522b\u635f\u5931\u8861\u91cf\u9884\u6d4b\u7684\u8fb9\u754c\u6846\u6240\u5c5e\u7c7b\u522b\u7684\u51c6\u786e\u5ea6\u3002</p> <p>\u5176\u635f\u5931\u51fd\u6570\u662f\u7531\u591a\u4e2a\u90e8\u5206\u7ec4\u6210\u7684\u3002\u4e3b\u8981\u5305\u62ec\u4e09\u4e2a\u90e8\u5206\uff1a</p> <ol> <li> <p>\u76ee\u6807\u5b9a\u4f4d\u635f\u5931\uff08Localization Loss\uff09\uff1a\u7528\u4e8e\u8861\u91cf\u9884\u6d4b\u6846\u7684\u4f4d\u7f6e\u51c6\u786e\u7a0b\u5ea6\u3002\u4e00\u822c\u4f7f\u7528\u5e73\u65b9\u5dee\u635f\u5931\uff08\u5982L2\u635f\u5931\uff09\u6216Huber\u635f\u5931\u51fd\u6570\u3002</p> </li> <li> <p>\u76ee\u6807\u7f6e\u4fe1\u5ea6\u635f\u5931\uff08Confidence Loss\uff09\uff1a\u7528\u4e8e\u8861\u91cf\u9884\u6d4b\u6846\u662f\u5426\u5305\u542b\u76ee\u6807\u7269\u4f53\u4ee5\u53ca\u6846\u7684\u7f6e\u4fe1\u5ea6\u51c6\u786e\u7a0b\u5ea6\u3002\u4e00\u822c\u4f7f\u7528\u4e8c\u5206\u7c7b\u635f\u5931\u51fd\u6570\uff0c\u5982\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570\u3002</p> </li> <li> <p>\u65e0\u76ee\u6807\u6846\u635f\u5931\uff08No-Object Loss\uff09\uff1a\u7528\u4e8e\u8861\u91cf\u9884\u6d4b\u6846\u4e2d\u6ca1\u6709\u76ee\u6807\u7684\u90e8\u5206\u7684\u51c6\u786e\u7a0b\u5ea6\u3002\u4e00\u822c\u4f7f\u7528\u4e8c\u5206\u7c7b\u635f\u5931\u51fd\u6570\u3002</p> </li> </ol> <p>\u5177\u4f53\u7684\u635f\u5931\u51fd\u6570\u4e3a\uff1a \u603b\u635f\u5931 = \u76ee\u6807\u5b9a\u4f4d\u635f\u5931 + \u76ee\u6807\u7f6e\u4fe1\u5ea6\u635f\u5931 + \u65e0\u76ee\u6807\u6846\u635f\u5931</p>"},{"location":"AI/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/","title":"\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\u57fa\u7840","text":"<p>\u6df1\u5ea6\u5b66\u4e60</p>"},{"location":"AI/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/%E7%BC%96%E7%A8%8B%E7%BB%86%E8%8A%82%E7%9B%B8%E5%85%B3/","title":"\u7f16\u7a0b\u7ec6\u8282\u76f8\u5173","text":""},{"location":"AI/%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98/%E7%BC%96%E7%A8%8B%E7%BB%86%E8%8A%82%E7%9B%B8%E5%85%B3/#_2","title":"\u4eba\u5de5\u667a\u80fd","text":"<p>\u600e\u6837\u624d\u80fd\u5728tensorboard\u4e2d\u628a\u591a\u4e2aloss\u7684\u66f2\u7ebf\u753b\u5230\u540c\u4e00\u5f20\u56fe\u4e0a\uff0c\u4fbf\u4e8e\u5bf9\u6bd4\uff1f</p> <p>\u7528\u4e24\u4e2a\u8def\u5f84\u4e0d\u540c\u7684wirter\uff0c\u5728\u4e24\u4e2a\u4e0d\u540c\u7684\u6587\u4ef6\u5939\u4e0b\uff0c\u628a\u53c2\u6570\u540d\u79f0\u5199\u6210\u540c\u4e00\u4e2a\u3002</p> <pre><code>writer_g = SummaryWriter(\"runs/exp1/generator/\")\nwriter_d = SummaryWriter(\"runs/exp1/discriminator/\")\nwriter_g.add_scalar('loss', loss_g, iteration)\nwriter_d.add_scalar('loss', loss_d, iteration)\n</code></pre> <p></p>"},{"location":"Algorithm/ICPC%20%E6%A8%A1%E6%9D%BF/","title":"ICPC \u6a21\u677f","text":"<p>\u5feb\u8bfb(read)</p> <pre><code>long long quick_read()\n{\n    int x=0,t=1;\n    char ch=getchar();\n    while(ch&lt;'0'||ch&gt;'9')\n    {\n        if(ch=='-')\n        t=-1;\n        ch=getchar();\n    }\n    while(ch&gt;='0'&amp;&amp;ch&lt;='9')\n    {\n        x=(x&lt;&lt;1)+(x&lt;&lt;3)+(ch^48);\n        ch=getchar();\n    }\n    return x*t;\n}\n</code></pre> <p>KMP</p> <pre><code>#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\nconst int N = 1000010;\nint n, m;\nint ne[N];\nint ne2[N];\nint main()\n{\n    string s1, s2;\n    int a, b;\n    cin &gt;&gt; s1 &gt;&gt; s2;\n    a = s1.length();\n    b = s2.length();\n\n    if (a &gt; b)\n    {\n        swap(s1, s2);\n        swap(a, b);\n    }\n\n    int flag = 0;\n    ne[0] = -1;\n    for (int i = 1, j = -1; i &lt; a; i++)\n    {\n        while (j &gt;= 0 &amp;&amp; s1[j + 1] != s1[i])\n            j = ne[j];\n        if (s1[j + 1] == s1[i])\n            j++;\n        ne[i] = j;\n    }\n\n    for (int i = 0, j = -1; i &lt; b; i++)\n    {\n        while (j != -1 &amp;&amp; s2[i] != s1[j + 1])\n            j = ne[j];\n        if (s2[i] == s1[j + 1])\n            j++;\n        if (j == a - 1)\n        {\n            flag = 1;\n            break;\n        }\n    }\n\n    if (flag == 0)\n        printf(\"NO\\n\");\n    else\n        printf(\"YES\\n\");\n    return 0;\n}\n</code></pre> <p>\u9ad8\u7cbe\u5ea6\u52a0\u6cd5</p> <pre><code>vector&lt;int&gt; add(vector&lt;int&gt; &amp;A, vector&lt;int&gt; &amp;B)\n{\n    if (A.size() &lt; B.size())\n        return add(B, A);\n    vector&lt;int&gt; C;\n    int t = 0;\n    for (int i = 0; i &lt; A.size(); i++)\n    {\n        t += A[i];\n        if (i &lt; B.size())\n            t += B[i];\n        C.push_back(t % 10);\n        t /= 10;\n    }\n    if (t)\n        C.push_back(t);\n    return C;\n}\nint main()\n{\n    string a, b;\n    vector&lt;int&gt; A;\n    vector&lt;int&gt; B;\n    cin &gt;&gt; a &gt;&gt; b;\n    for (int i = a.size() - 1; i &gt;= 0; i--)\n    {\n        A.push_back(a[i] - '0');\n    }\n    for (int i = b.size() - 1; i &gt;= 0; i--)\n    {\n        B.push_back(b[i] - '0');\n    }\n    vector&lt;int&gt; C = add(A, B);\n    for (int i = C.size() - 1; i &gt;= 0; i--)\n    {\n        printf(\"%d\", C[i]);\n    }\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","title":"\u52a8\u6001\u89c4\u5212","text":""},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_2","title":"\u52a8\u6001\u89c4\u5212\u57fa\u7840","text":"<p>\u52a8\u6001\u89c4\u5212\u57fa\u7840 - OI Wiki (oi-wiki.org)</p>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_3","title":"\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217","text":"<pre><code>for (int i = 1; i &lt;= n;i++) {\n    for (int j = 1; j &lt;= m;j++)\n    {\n        if(a[i] == b[j]) {\n            f[i][j] = f[i - 1][j - 1] + 1;\n        } else {\n            f[i][j] = max(f[i - 1][j], f[i][j - 1]);\n        }\n    }\n}\nres = f[n][m];\n</code></pre>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_4","title":"\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217","text":""},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_5","title":"\u7b97\u6cd5\u4e00","text":"<p>\u65f6\u95f4\u590d\u6742\u5ea6\\(O(n^2)\\) <pre><code>int a[MAXN], d[MAXN];\n\nint dp() {\n  d[1] = 1;\n  int ans = 1;\n  for (int i = 2; i &lt;= n; i++) {\n    d[i] = 1;\n    for (int j = 1; j &lt; i; j++)\n      if (a[j] &lt;= a[i]) {\n        d[i] = max(d[i], d[j] + 1);\n        ans = max(ans, d[i]);\n      }\n  }\n  return ans;\n}\n</code></pre></p>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_6","title":"\u7b97\u6cd5\u4e8c","text":"<p>\u65f6\u95f4\u590d\u6742\u5ea6\\(O(nlogn)\\) <pre><code>for (int i = 0; i &lt; n; ++i) scanf(\"%d\", a + i);\nmemset(dp, 0x1f, sizeof dp);\nmx = dp[0];\nfor (int i = 0; i &lt; n; ++i) {\n  *std::upper_bound(dp, dp + n, a[i]) = a[i];\n}\nans = 0;\nwhile (dp[ans] != mx) ++ans;\n</code></pre></p>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_7","title":"\u5b50\u5e8f\u5217\u4e2a\u6570","text":""},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_8","title":"\u80cc\u5305\u95ee\u9898","text":"<p>\u80cc\u5305 DP - OI Wiki (oi-wiki.org)</p> <p>\u72b6\u6001\u8868\u793a\uff1a\\(f(i,j)\\)</p> <p>\u72b6\u6001\u8ba1\u7b97\uff1a\u96c6\u5408\u5212\u5206</p> <p>\u5173\u952e\uff1a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b</p>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#0-1","title":"0-1\u80cc\u5305\u95ee\u9898","text":"\\[f[j] = max(f[j], f[j - v[i]] + w[i])\\] <pre><code>// 0-1\u80cc\u5305\u95ee\u9898\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;cstring&gt;\n\nusing namespace std;\nconst int N = 1010;\n\nint n, m;\nint f[N];\nint v[N], w[N];\nint main()\n{\n\u00a0 \u00a0 cin &gt;&gt; n &gt;&gt; m;\n\u00a0 \u00a0 int i, j;\n\u00a0 \u00a0 for (i = 1; i &lt;= n; i++)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 cin &gt;&gt; v[i] &gt;&gt; w[i];\n\u00a0 \u00a0 }\n\n\u00a0 \u00a0 for (i = 1; i &lt;= n; i++)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 for (j = m; j &gt;= v[i]; j--)\n\u00a0 \u00a0 \u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 f[j] = max(f[j], f[j - v[i]] + w[i]);\n\u00a0 \u00a0 \u00a0 \u00a0 }\n\u00a0 \u00a0 }\n\u00a0 \u00a0 int res = 0;\n\u00a0 \u00a0 for (i = 1; i &lt;= m; i++)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 res = max(res, f[i]);\n\u00a0 \u00a0 }\n\u00a0 \u00a0 cout &lt;&lt; res &lt;&lt; endl;\n\u00a0 \u00a0 return 0;\n}\n</code></pre>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_9","title":"\u5b8c\u5168\u80cc\u5305\u95ee\u9898","text":"<p>\\(\\(f[j] = max(f[j], f[j - v[i]] + w[i])\\)\\) <pre><code>#include&lt;iostream&gt;//\u5b8c\u5168\u80cc\u5305\u95ee\u9898\n#include&lt;algorithm&gt;\nusing namespace std;\n\nconst int N=1010;\nint n,m;\nint v[N],w[N];\nint f[N];\n\nint main()\n{\n    cin&gt;&gt;n&gt;&gt;m;\n    int i,j,k;\n    for(i=1;i&lt;=n;i++)\n    {\n        cin&gt;&gt;v[i]&gt;&gt;w[i];\n    }\n    for (i = 1; i &lt;= n; i++)\n        {\n            for (j = v[i]; j &lt;= m; j++)\n            {\n                f[j] = max(f[j], f[j - v[i]] + w[i]);\n            }\n        }\n    cout&lt;&lt;f[m];\n    return 0;\n}\n</code></pre></p>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_10","title":"\u591a\u91cd\u80cc\u5305\u95ee\u9898","text":"<p>4. \u591a\u91cd\u80cc\u5305\u95ee\u9898 I - AcWing\u9898\u5e93</p> <pre><code>#include &lt;bits/stdc++.h&gt;\nusing namespace std;\n\nconst int N = 1e6 + 10;\n\nint n, m;\nint v[N],w[N],s[N];\nint f[N];\n\nint main()\n{\n    cin &gt;&gt; n &gt;&gt; m;\n    for (int i = 1; i &lt;= n; i++)\n    {\n        cin &gt;&gt; v[i] &gt;&gt; w[i] &gt;&gt; s[i];\n    }\n    for (int i = 1;i&lt;=n;i++)\n    {\n        for (int j = m; j &gt;= 0 &amp;&amp; j &gt;= v[i];j--)\n        {\n            for (int k = 0; k &lt;=s[i]&amp;&amp;k*v[i]&lt;=j;k++)\n            {\n                f[j] = max(f[j], f[j - k * v[i]] + k * w[i]);\n            }\n        }\n    }\n    cout &lt;&lt; f[m] &lt;&lt; endl;\n\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_11","title":"\u4e8c\u8fdb\u5236\u4f18\u5316","text":"<p>\u3002\u3002\u3002</p>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_12","title":"\u6df7\u5408\u80cc\u5305\u95ee\u9898","text":"<pre><code>for (\u5faa\u73af\u7269\u54c1\u79cd\u7c7b) {\n  if (\u662f 0 - 1 \u80cc\u5305)\n    \u5957\u7528 0 - 1 \u80cc\u5305\u4ee3\u7801;\n  else if (\u662f\u5b8c\u5168\u80cc\u5305)\n    \u5957\u7528\u5b8c\u5168\u80cc\u5305\u4ee3\u7801;\n  else if (\u662f\u591a\u91cd\u80cc\u5305)\n    \u5957\u7528\u591a\u91cd\u80cc\u5305\u4ee3\u7801;\n}\n</code></pre> <p>### \u4e8c\u7ef4\u8d39\u7528\u80cc\u5305  P1855 \u69a8\u53d6kkksc03 - \u6d1b\u8c37</p>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#dp","title":"\u533a\u95f4DP","text":"<p>\u533a\u95f4 DP - OI Wiki (oi-wiki.org)</p>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_13","title":"\u77f3\u5b50\u5408\u5e76","text":"<p>\u8bbe\u6709\u00a0N\u00a0\u5806\u77f3\u5b50\u6392\u6210\u4e00\u6392\uff0c\u5176\u7f16\u53f7\u4e3a\u00a01,2,3,\u2026,N\u3002</p> <p>\u6bcf\u5806\u77f3\u5b50\u6709\u4e00\u5b9a\u7684\u8d28\u91cf\uff0c\u53ef\u4ee5\u7528\u4e00\u4e2a\u6574\u6570\u6765\u63cf\u8ff0\uff0c\u73b0\u5728\u8981\u5c06\u8fd9\u00a0N\u00a0\u5806\u77f3\u5b50\u5408\u5e76\u6210\u4e3a\u4e00\u5806\u3002</p> <p>\u6bcf\u6b21\u53ea\u80fd\u5408\u5e76\u76f8\u90bb\u7684\u4e24\u5806\uff0c\u5408\u5e76\u7684\u4ee3\u4ef7\u4e3a\u8fd9\u4e24\u5806\u77f3\u5b50\u7684\u8d28\u91cf\u4e4b\u548c\uff0c\u5408\u5e76\u540e\u4e0e\u8fd9\u4e24\u5806\u77f3\u5b50\u76f8\u90bb\u7684\u77f3\u5b50\u5c06\u548c\u65b0\u5806\u76f8\u90bb\uff0c\u5408\u5e76\u65f6\u7531\u4e8e\u9009\u62e9\u7684\u987a\u5e8f\u4e0d\u540c\uff0c\u5408\u5e76\u7684\u603b\u4ee3\u4ef7\u4e5f\u4e0d\u76f8\u540c\u3002</p> <p>\u4f8b\u5982\u6709\u00a04\u00a0\u5806\u77f3\u5b50\u5206\u522b\u4e3a\u00a0<code>1 3 5 2</code>\uff0c \u6211\u4eec\u53ef\u4ee5\u5148\u5408\u5e76 1\u30012 \u5806\uff0c\u4ee3\u4ef7\u4e3a\u00a04\uff0c\u5f97\u5230\u00a0<code>4 5 2</code>\uff0c \u53c8\u5408\u5e76\u00a01\u30012\u00a0\u5806\uff0c\u4ee3\u4ef7\u4e3a\u00a09\uff0c\u5f97\u5230\u00a0<code>9 2</code>\u00a0\uff0c\u518d\u5408\u5e76\u5f97\u5230\u00a011\uff0c\u603b\u4ee3\u4ef7\u4e3a\u00a04+9+11=24\uff1b</p> <p>\u5982\u679c\u7b2c\u4e8c\u6b65\u662f\u5148\u5408\u5e76\u00a02\u30013\u00a0\u5806\uff0c\u5219\u4ee3\u4ef7\u4e3a\u00a07\uff0c\u5f97\u5230\u00a0<code>4 7</code>\uff0c\u6700\u540e\u4e00\u6b21\u5408\u5e76\u4ee3\u4ef7\u4e3a\u00a011\uff0c\u603b\u4ee3\u4ef7\u4e3a\u00a04+7+11=22\u3002</p> <p>\u95ee\u9898\u662f\uff1a\u627e\u51fa\u4e00\u79cd\u5408\u7406\u7684\u65b9\u6cd5\uff0c\u4f7f\u603b\u7684\u4ee3\u4ef7\u6700\u5c0f\uff0c\u8f93\u51fa\u6700\u5c0f\u4ee3\u4ef7\u3002</p> <p>\u8f93\u5165\u683c\u5f0f</p> <p>\u7b2c\u4e00\u884c\u4e00\u4e2a\u6570\u00a0N\u00a0\u8868\u793a\u77f3\u5b50\u7684\u5806\u6570\u00a0N\u3002</p> <p>\u7b2c\u4e8c\u884c\u00a0N\u00a0\u4e2a\u6570\uff0c\u8868\u793a\u6bcf\u5806\u77f3\u5b50\u7684\u8d28\u91cf(\u5747\u4e0d\u8d85\u8fc7\u00a01000)\u3002</p> <p>\u8f93\u51fa\u683c\u5f0f</p> <p>\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u6700\u5c0f\u4ee3\u4ef7\u3002</p> <p>\u6570\u636e\u8303\u56f4</p> <p>1\u2264N\u2264300</p> <p>\u8f93\u5165\u6837\u4f8b\uff1a</p> <pre><code>4\n1 3 5 2\n</code></pre> <p>\u8f93\u51fa\u6837\u4f8b\uff1a</p> <pre><code>22\n</code></pre> <p>Code</p> <pre><code>read(n);\nfor (int i = 1; i &lt;= n; i++)\n{\n    read(a[i]);\n}\nfor (int i = 1; i &lt;= n; i++)\n{\n    a[i] += a[i - 1];\n}\n// len \u5408\u5e76\u533a\u57df\u7684\u957f\u5ea6\n// i + (len - 1) = j\nfor (int len = 2; len &lt;= n; len++)\n{\n    for (int i = 1; i + len - 1 &lt;= n; i++)\n    {\n        int l = i;\n        int r = i + len - 1;\n        f[l][r] = 1e8;\n        for (int k = l; k &lt; r; k++)\n        {\n            // (f[l][k] + f[k+1][r]) + (a[r] - a[l - 1]) \u5408\u5e76\u7684\u6210\u672c\n            f[l][r] = min(f[l][r], f[l][k] + f[k + 1][r] + a[r] - a[l - 1]);\n        }\n    }\n}\ncout &lt;&lt; f[1][n] &lt;&lt; endl;\nreturn 0;\n</code></pre>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#dp_1","title":"\u6811\u5f62DP","text":""},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_14","title":"\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a","text":"<p>\u9898\u76ee\u63cf\u8ff0</p> <p>\u67d0\u5927\u5b66\u6709 \\(n\\) \u4e2a\u804c\u5458\uff0c\u7f16\u53f7\u4e3a \\(1\\ldots n\\)\u3002</p> <p>\u4ed6\u4eec\u4e4b\u95f4\u6709\u4ece\u5c5e\u5173\u7cfb\uff0c\u4e5f\u5c31\u662f\u8bf4\u4ed6\u4eec\u7684\u5173\u7cfb\u5c31\u50cf\u4e00\u68f5\u4ee5\u6821\u957f\u4e3a\u6839\u7684\u6811\uff0c\u7236\u7ed3\u70b9\u5c31\u662f\u5b50\u7ed3\u70b9\u7684\u76f4\u63a5\u4e0a\u53f8\u3002</p> <p>\u73b0\u5728\u6709\u4e2a\u5468\u5e74\u5e86\u5bb4\u4f1a\uff0c\u5bb4\u4f1a\u6bcf\u9080\u8bf7\u6765\u4e00\u4e2a\u804c\u5458\u90fd\u4f1a\u589e\u52a0\u4e00\u5b9a\u7684\u5feb\u4e50\u6307\u6570 \\(r_i\\)\uff0c\u4f46\u662f\u5462\uff0c\u5982\u679c\u67d0\u4e2a\u804c\u5458\u7684\u76f4\u63a5\u4e0a\u53f8\u6765\u53c2\u52a0\u821e\u4f1a\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u804c\u5458\u5c31\u65e0\u8bba\u5982\u4f55\u4e5f\u4e0d\u80af\u6765\u53c2\u52a0\u821e\u4f1a\u4e86\u3002</p> <p>\u6240\u4ee5\uff0c\u8bf7\u4f60\u7f16\u7a0b\u8ba1\u7b97\uff0c\u9080\u8bf7\u54ea\u4e9b\u804c\u5458\u53ef\u4ee5\u4f7f\u5feb\u4e50\u6307\u6570\u6700\u5927\uff0c\u6c42\u6700\u5927\u7684\u5feb\u4e50\u6307\u6570\u3002</p> <p>\u8f93\u5165\u683c\u5f0f</p> <p>\u8f93\u5165\u7684\u7b2c\u4e00\u884c\u662f\u4e00\u4e2a\u6574\u6570 \\(n\\)\u3002</p> <p>\u7b2c \\(2\\) \u5230\u7b2c \\((n + 1)\\) \u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u7b2c \\((i+1)\\) \u884c\u7684\u6574\u6570\u8868\u793a \\(i\\) \u53f7\u804c\u5458\u7684\u5feb\u4e50\u6307\u6570 \\(r_i\\)\u3002</p> <p>\u7b2c \\((n + 2)\\) \u5230\u7b2c \\(2n\\) \u884c\uff0c\u6bcf\u884c\u8f93\u5165\u4e00\u5bf9\u6574\u6570 \\(l, k\\)\uff0c\u4ee3\u8868 \\(k\\) \u662f \\(l\\) \u7684\u76f4\u63a5\u4e0a\u53f8\u3002</p> <p>\u8f93\u51fa\u683c\u5f0f</p> <p>\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6574\u6570\u4ee3\u8868\u6700\u5927\u7684\u5feb\u4e50\u6307\u6570\u3002</p> <p>\u6837\u4f8b #1</p> <p>\u6837\u4f8b\u8f93\u5165 #1</p> <pre><code>7\n1\n1\n1\n1\n1\n1\n1\n1 3\n2 3\n6 4\n7 4\n4 5\n3 5\n</code></pre> <p>\u6837\u4f8b\u8f93\u51fa #1</p> <pre><code>5\n</code></pre> <p>\u63d0\u793a</p> <p>\u6570\u636e\u89c4\u6a21\u4e0e\u7ea6\u5b9a</p> <p>\u5bf9\u4e8e \\(100\\%\\) \u7684\u6570\u636e\uff0c\u4fdd\u8bc1 \\(1\\leq n \\leq 6 \\times 10^3\\)\uff0c\\(-128 \\leq r_i\\leq 127\\)\uff0c\\(1 \\leq l, k \\leq n\\)\uff0c\u4e14\u7ed9\u51fa\u7684\u5173\u7cfb\u4e00\u5b9a\u662f\u4e00\u68f5\u6811\u3002</p> <ul> <li>\u4e0a\u53f8\u4e0d\u53c2\u52a0\u821e\u4f1a\u65f6\uff0c\u4e0b\u5c5e\u53ef\u4ee5\u53c2\u52a0\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u53c2\u52a0\uff0c\u6b64\u65f6\u6709 \\(f(i,0) = \\sum max{f(x,1),f(x,0)}\\)</li> <li>\u4e0a\u53f8\u53c2\u52a0\u821e\u4f1a\u65f6\uff0c\u4e0b\u5c5e\u90fd\u4e0d\u4f1a\u53c2\u52a0\uff0c\u6b64\u65f6\u6709 \\(f(i,1) = \\sum f(x,0)+a_{i}\\)</li> </ul> <p>\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528dfs\uff0c\u4ece\u6839\u8282\u70b9\u5f00\u59cb\u904d\u5386\u6811\uff0c\u5728\u8fd4\u56de\u4e0a\u4e00\u5c42\u65f6\u66f4\u65b0\u8282\u70b9</p>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#code","title":"Code","text":"<pre><code>int f[N][2];\nint is_h[N];\nint h[N], e[N], ne[N], idx;\nbool st[N];\n\nvoid add(int a, int b)\n{\n    idx++;\n    e[idx] = b;\n    ne[idx] = h[a];\n    h[a] = idx;\n}\n\nvoid dfs(int k)\n{\n    st[k] = 1;\n    for (int i = h[k]; i; i = ne[i]) // \u679a\u4e3e\u8be5\u7ed3\u70b9\u7684\u6bcf\u4e2a\u5b50\u7ed3\u70b9\n    {\n        int j = e[i];\n        if (st[j])\n            continue;\n        solve(j);\n        f[k][1] += f[j][0];\n        f[k][0] += max(f[j][0], f[j][1]); // \u8f6c\u79fb\u65b9\u7a0b\n    }\n    return;\n}\n\nint main()\n{\n    IOS;\n\n    int n;\n    cin &gt;&gt; n;\n    for (int i = 1; i &lt;= n; i++)\n    {\n        cin &gt;&gt; f[i][1];\n    }\n    for (int i = 1; i &lt; n; i++)\n    {\n        int l, k;\n        cin &gt;&gt; l &gt;&gt; k;\n        is_h[l] = 1;\n        add(k, l);\n    }\n    for (int i = 1; i &lt;= n; i++)\n    {\n        if (!is_h[i]) // \u4ece\u6839\u7ed3\u70b9\u5f00\u59cbDFS\n        {\n            dfs(i);\n            printf(\"%d\", max(f[i][1], f[i][0]));\n            return 0;\n        }\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#_15","title":"\u6811\u4e0a\u80cc\u5305","text":""},{"location":"Algorithm/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/#dp_2","title":"\u72b6\u538bDP","text":"<p>\u76f8\u5173\u5185\u5bb9 \u4f4d\u8fd0\u7b97 \u6700\u5c0f\u8868\u793a\u6cd5 - OI Wiki (oi-wiki.org)</p> <p>\u4e92\u4e0d\u4fb5\u72af</p> <p>\u5728\\(N \\times N\\)\u7684\u68cb\u76d8\u91cc\u9762\u653e\\(K\\)\u4e2a\u56fd\u738b(1&lt;=N&lt;=9,1&lt;=K&lt;=N * N)\uff0c\u4f7f\u4ed6\u4eec\u4e92\u4e0d\u653b\u51fb\uff0c\u5171\u6709\u591a\u5c11\u79cd\u6446\u653e\u65b9\u6848\u3002</p> <p>\u56fd\u738b\u80fd\u653b\u51fb\u5230\u5b83\u4e0a\u4e0b\u5de6\u53f3\uff0c\u4ee5\u53ca\u5de6\u4e0a\u5de6\u4e0b\u53f3\u4e0a\u53f3\u4e0b\u516b\u4e2a\u65b9\u5411\u4e0a\u9644\u8fd1\u7684\u5404\u4e00\u4e2a\u683c\u5b50\uff0c\u51718\u4e2a\u683c\u5b50\u3002</p> <p>\u5b9e\u73b0 <pre><code>#include &lt;algorithm&gt;\n#include &lt;iostream&gt;\nusing namespace std;\nlong long sta[2005], sit[2005], f[15][2005][105];\nint n, k, cnt;\n\nvoid dfs(int x, int num, int cur) {\n  if (cur &gt;= n) {  // \u6709\u65b0\u7684\u5408\u6cd5\u72b6\u6001\n    sit[++cnt] = x;\n    sta[cnt] = num;\n    return;\n  }\n  dfs(x, num, cur + 1);  // cur\u4f4d\u7f6e\u4e0d\u653e\u56fd\u738b\n  dfs(x + (1 &lt;&lt; cur), num + 1,\n      cur + 2);  // cur\u4f4d\u7f6e\u653e\u56fd\u738b\uff0c\u4e0e\u5b83\u76f8\u90bb\u7684\u4f4d\u7f6e\u4e0d\u80fd\u518d\u653e\u56fd\u738b\n}\n\nbool compatible(int j, int x) {\n  if (sit[j] &amp; sit[x]) return false;\n  if ((sit[j] &lt;&lt; 1) &amp; sit[x]) return false;\n  if (sit[j] &amp; (sit[x] &lt;&lt; 1)) return false;\n  return true;\n}\n\nint main() {\n  cin &gt;&gt; n &gt;&gt; k;\n  dfs(0, 0, 0);  // \u5148\u9884\u5904\u7406\u4e00\u884c\u7684\u6240\u6709\u5408\u6cd5\u72b6\u6001\n  for (int j = 1; j &lt;= cnt; j++) f[1][j][sta[j]] = 1;\n  for (int i = 2; i &lt;= n; i++)\n    for (int j = 1; j &lt;= cnt; j++)\n      for (int x = 1; x &lt;= cnt; x++) {\n        if (!compatible(j, x)) continue;  // \u6392\u9664\u4e0d\u5408\u6cd5\u8f6c\u79fb\n        for (int l = sta[j]; l &lt;= k; l++) f[i][j][l] += f[i - 1][x][l - sta[j]];\n      }\n  long long ans = 0;\n  for (int i = 1; i &lt;= cnt; i++) ans += f[n][i][k];  // \u7d2f\u52a0\u7b54\u6848\n  cout &lt;&lt; ans &lt;&lt; endl;\n  return 0;\n}\n</code></pre></p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/","title":"Tricks","text":"<ol> <li> <p>1~n,\u968f\u673a\u6253\u4e71,\u6700\u5feb\u4f7f\u8fd9\u4e9b\u6570\u56de\u5230\u5bf9\u5e94i\u7684\u4f4d\u7f6e</p> <p>2\u30013\u30015\u30011\u30014</p> <p>1\u30012\u30013\u30014\u30015</p> </li> </ol> <pre><code>for (int i = 1;i&lt;=n;i++)\n{\n\u00a0 \u00a0 while(a[a[i]]!=a[i])\n\u00a0 \u00a0 \u00a0 \u00a0 swap(a[a[i]], a[i]);\n}\n</code></pre> <ol> <li>\u6570\u5b57\u8f6c\u5b57\u7b26\u4e32</li> </ol> <pre><code>string s;\ns = to_string(int);\ns = to_string(long long);\n</code></pre> <ol> <li>\u5b57\u7b26\u4e32\u8f6c\u6570\u5b57</li> </ol> <pre><code>string s = \"124\"\nint a = stoi(s);\nlong long b = stol(s);\nfloat c = stof(s);\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_1","title":"\u5b57\u7b26\u4e32","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#kmp","title":"KMP","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_2","title":"\u90bb\u63a5\u8868","text":"<pre><code>// head\u5b58\u50a8\u94fe\u8868\u5934\uff0ce[]\u5b58\u50a8\u8282\u70b9\u7684\u503c\uff0cne[]\u5b58\u50a8\u8282\u70b9\u7684next\u6307\u9488\uff0cidx\u8868\u793a\u5f53\u524d\u7528\u5230\u4e86\u54ea\u4e2a\u8282\u70b9\nint head, e[N], ne[N], idx;\n\n// \u521d\u59cb\u5316\nvoid init()\n{\n    head = -1;\n    idx = 0;\n}\n\n// \u5728\u94fe\u8868\u5934\u63d2\u5165\u4e00\u4e2a\u6570a\nvoid insert(int a)\n{\n    e[idx] = a, ne[idx] = head, head = idx ++ ;\n}\n// \u5728\u94fe\u8868\u5934a\u63d2\u5165\u4e00\u4e2a\u6570b\nvoid add(int a,int b)\n{\n    e[idx] = b, ne[idx] = head[a], head[a] = idx ++ ;\n}\n\n// \u5c06\u5934\u7ed3\u70b9\u5220\u9664\uff0c\u9700\u8981\u4fdd\u8bc1\u5934\u7ed3\u70b9\u5b58\u5728\nvoid remove()\n{\n    head = ne[head];\n}\n/*\nhead &lt;- e[0] &lt;- e[1] &lt;- e[2] \nhead == idx == 2\n*/ \n</code></pre> <p>\u904d\u5386\u94fe\u8868a</p> <pre><code>for (int i = h[a]; i != -1; i = ne[i])\n{\n    j = e[i];\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_3","title":"\u5355\u8c03\u961f\u5217","text":"<pre><code>//   https://www.acwing.com/problem/content/description/156/\n\n#include &lt;iostream&gt;\nusing namespace std;\nconst int N = 1e6 + 10;\nint n, k, q[N], a[N]; // q[N]\u5b58\u7684\u662f\u6570\u7ec4\u4e0b\u6807\nint main()\n{\n    int tt = -1, hh = 0; // hh\u961f\u5217\u5934 tt\u961f\u5217\u5c3e\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cin &gt;&gt; n &gt;&gt; k;\n    for (int i = 0; i &lt; n; i++)\n        cin &gt;&gt; a[i];\n    // \u6700\u5927\u503c\n    for (int i = 0; i &lt; n; i++)\n    {\n        // \u7ef4\u6301\u6ed1\u52a8\u7a97\u53e3\u7684\u5927\u5c0f\n        // \u5f53\u961f\u5217\u4e0d\u4e3a\u7a7a(hh &lt;= tt) \u4e14 \u5f53\u524d\u6ed1\u52a8\u7a97\u53e3\u7684\u5927\u5c0f(i - q[hh] + 1) \u5927\u4e8e \u6211\u4eec\u8bbe\u5b9a\u7684\u6ed1\u52a8\u7a97\u53e3\u7684\u5927\u5c0f(k),\n        // \u961f\u5217\u5f39\u51fa\u961f\u5217\u5934\u5143\u7d20\u4ee5\u7ef4\u6301\u6ed1\u52a8\u7a97\u53e3\u7684\u5927\u5c0f\n        if (hh &lt;= tt &amp;&amp; k &lt; i - q[hh] + 1)\n            hh++;\n        // \u6784\u9020\u5355\u8c03\u9012\u589e\u961f\u5217\n        // \u5f53\u961f\u5217\u4e0d\u4e3a\u7a7a(hh &lt;= tt) \u4e14 \u961f\u5217\u961f\u5c3e\u5143\u7d20&gt;=\u5f53\u524d\u5143\u7d20(a[i])\u65f6,\u90a3\u4e48\u961f\u5c3e\u5143\u7d20\u5c31\u4e00\u5b9a\u4e0d\u662f\u5f53\u524d\u7a97\u53e3\u6700\u5c0f\u503c,\n        // \u5220\u53bb\u961f\u5c3e\u5143\u7d20,\u52a0\u5165\u5f53\u524d\u5143\u7d20(q[ ++ tt] = i)\n        while (hh &lt;= tt &amp;&amp; a[q[tt]] &gt;= a[i])\n            tt--;\n        q[++tt] = i;\n        if (i + 1 &gt;= k)\n            cout &lt;&lt; a[q[hh]] &lt;&lt; \" \";\n    }\n    cout &lt;&lt; \"\\n\";\n\n    // \u6700\u5c0f\u503c\n    hh = 0, tt = -1;\n    for (int i = 0; i &lt; n; i++)\n    {\n        if (hh &lt;= tt &amp;&amp; k &lt; i - q[hh] + 1)\n            hh++;\n        while (hh &lt;= tt &amp;&amp; a[q[tt]] &lt;= a[i])\n            tt--;\n        q[++tt] = i;\n        if (i + 1 &gt;= k)\n            cout &lt;&lt; a[q[hh]] &lt;&lt; \" \";\n    }\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_4","title":"\u56fe\u8bba","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_5","title":"\u6c42\u6700\u77ed\u8def\u5f84","text":"<p>\u6700\u77ed\u8def\u7b97\u6cd5\u4e4b\u95f4\u7684\u6bd4\u8f83</p> \u6700\u77ed\u8def\u7b97\u6cd5 Floyd Bellman-Ford Dijkstra Johnson \u6700\u77ed\u8def\u7c7b\u578b \u6bcf\u5bf9\u7ed3\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8def \u5355\u6e90\u6700\u77ed\u8def \u5355\u6e90\u6700\u77ed\u8def \u6bcf\u5bf9\u7ed3\u70b9\u4e4b\u95f4\u7684\u6700\u77ed\u8def \u4f5c\u7528\u4e8e \u4efb\u610f\u56fe \u4efb\u610f\u56fe \u975e\u8d1f\u6743\u56fe \u4efb\u610f\u56fe \u80fd\u5426\u68c0\u6d4b\u8d1f\u73af\uff1f \u80fd \u80fd \u4e0d\u80fd \u80fd \u63a8\u8350\u4f5c\u7528\u56fe\u7684\u5927\u5c0f \u5c0f \u4e2d/\u5c0f \u5927/\u4e2d \u5927/\u4e2d \u65f6\u95f4\u590d\u6742\u5ea6 \\(O(n^3)\\) \\(O(NM)\\) \\(O(MlogM)\\) \\(O(NMlogM)\\)"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#floyd","title":"Floyd","text":"<p>[!todo]</p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#spfa","title":"SPFA","text":"<pre><code>struct edge {\n  int v, w;\n};\n\nvector&lt;edge&gt; e[maxn];\nint dis[maxn], cnt[maxn], vis[maxn];\nqueue&lt;int&gt; q;\n\nbool spfa(int n, int s) {\n  memset(dis, 63, sizeof(dis));\n  dis[s] = 0, vis[s] = 1;\n  q.push(s);\n  while (!q.empty()) {\n    int u = q.front();\n    q.pop(), vis[u] = 0;\n    for (auto ed : e[u]) {\n      int v = ed.v, w = ed.w;\n      if (dis[v] &gt; dis[u] + w) {\n        dis[v] = dis[u] + w;\n        cnt[v] = cnt[u] + 1;  // \u8bb0\u5f55\u6700\u77ed\u8def\u7ecf\u8fc7\u7684\u8fb9\u6570\n        if (cnt[v] &gt;= n) return false;\n        // \u5728\u4e0d\u7ecf\u8fc7\u8d1f\u73af\u7684\u60c5\u51b5\u4e0b\uff0c\u6700\u77ed\u8def\u81f3\u591a\u7ecf\u8fc7 n - 1 \u6761\u8fb9\n        // \u56e0\u6b64\u5982\u679c\u7ecf\u8fc7\u4e86\u591a\u4e8e n \u6761\u8fb9\uff0c\u4e00\u5b9a\u8bf4\u660e\u7ecf\u8fc7\u4e86\u8d1f\u73af\n        if (!vis[v]) q.push(v), vis[v] = 1;\n      }\n    }\n  }\n  return true;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#dijkstra","title":"\u6734\u7d20Dijkstra\u6c42\u6700\u77ed\u8def","text":"<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;cstring&gt;\nusing namespace std;\n\nconst int N = 510;\n\nint n, m;\nint g[N][N]; //\u5b58\u50a8\u6bcf\u6761\u8fb9\nint dist[N]; //\u5b58\u50a81\u53f7\u70b9\u5230\u6bcf\u4e2a\u70b9\u7684\u6700\u77ed\u8ddd\u79bb\nbool st[N];  //\u5b58\u50a8\u6bcf\u4e2a\u70b9\u7684\u6700\u77ed\u8def\u662f\u5426\u5df2\u7ecf\u786e\u5b9a\n\n// \u6c421\u53f7\u70b9\u5230n\u53f7\u70b9\u7684\u6700\u77ed\u8def\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u8fd4\u56de-1\nint dijkstra()\n{\n    memset(dist, 0x3f3f3f3f, sizeof(dist));\n    dist[1] = 0;\n    for (int i = 0; i &lt; n; i++)\n    {\n        int t = -1;\n        //\u5728\u8fd8\u672a\u786e\u5b9a\u6700\u77ed\u8def\u7684\u70b9\u4e2d\uff0c\u5bfb\u627e\u8ddd\u79bb\u6700\u5c0f\u7684\u70b9\n        for (int j = 1; j &lt;= n; j++)\n        {\n            if (!st[j] /*\u4e0d\u5728st\u4e2d\u7684\u70b9*/ &amp;&amp; (t == -1 || dist[t] &gt; dist[j]))\n            {\n                t = j;\n            }\n        }\n        st[t] = true;\n\n        // \u7528t\u66f4\u65b0\u5176\u4ed6\u70b9\u7684\u8ddd\u79bb\n        for (int j = 1; j &lt;= n; j++)\n        {\n            dist[j] = min(dist[j], dist[t] + g[t][j]);\n        }\n    }\n    if (dist[n] == 0x3f3f3f3f)\n        return -1;\n    return dist[n];\n}\n\nint main()\n{\n    scanf(\"%d%d\", &amp;n, &amp;m);\n    memset(g, 0x3f3f3f3f, sizeof(g));\n    while (m--)\n    {\n        int a, b, c;\n        scanf(\"%d%d%d\", &amp;a, &amp;b, &amp;c);\n        g[a][b] = min(g[a][b], c);\n    }\n    int t = dijkstra();\n    printf(\"%d\\n\", t);\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#dijkstra_1","title":"\u5806\u4f18\u5316Dijkstra\u6c42\u6700\u77ed\u8def","text":"<pre><code>// Dijkstra\u5806\u4f18\u5316\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;queue&gt;\nusing namespace std;\ntypedef pair&lt;int, int&gt; PII;\nconst int N = 1e6 + 10;\n\nint n, m;\nint h[N], w[N], e[N], ne[N], idx;\nint dist[N];\nbool st[N];\nvoid add(int a, int b, int c)\n{\n\u00a0 \u00a0 e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx++;\n}\n\nint dijkstra()\n{\n\u00a0 \u00a0 memset(dist, 0x3f3f3f3f, sizeof(dist));\n\u00a0 \u00a0 memset(st, 0, sizeof(st));\n\u00a0 \u00a0 dist[1] = 0;\n\u00a0 \u00a0 priority_queue&lt;PII, vector&lt;PII&gt;, greater&lt;PII&gt;&gt; heap;\n\u00a0 \u00a0 heap.push({0, 1});\n\u00a0 \u00a0 while (heap.size())\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 auto t = heap.top();\n\u00a0 \u00a0 \u00a0 \u00a0 heap.pop();\n\u00a0 \u00a0 \u00a0 \u00a0 int ver = t.second, distance = t.first;\n\n\u00a0 \u00a0 \u00a0 \u00a0 if (st[ver])\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 continue;\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \n\u00a0 \u00a0 \u00a0 \u00a0 st[ver] = true;\n\u00a0 \u00a0 \u00a0 \u00a0 for (int i = h[ver]; i != -1; i = ne[i])\n\u00a0 \u00a0 \u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 int j = e[i];\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if (dist[j] &gt; dist[ver] + w[i])\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 dist[j] = dist[ver] + w[i];\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 heap.push({dist[j], j});\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\n\u00a0 \u00a0 \u00a0 \u00a0 }\n\u00a0 \u00a0 }\n\u00a0 \u00a0 if (dist[n] == 0x3f3f3f3f)\n\u00a0 \u00a0 \u00a0 \u00a0 return -1;\n\u00a0 \u00a0 return dist[n];\n}\n\nint main()\n{\n\u00a0 \u00a0 scanf(\"%d%d\", &amp;n, &amp;m);\n\u00a0 \u00a0 memset(h, -1, sizeof h);\n\u00a0 \u00a0 while (m--)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 int a, b, c;\n\u00a0 \u00a0 \u00a0 \u00a0 scanf(\"%d%d%d\", &amp;a, &amp;b, &amp;c);\n\u00a0 \u00a0 \u00a0 \u00a0 add(a, b, c);\n\u00a0 \u00a0 }\n\u00a0 \u00a0 cout &lt;&lt; dijkstra() &lt;&lt; endl;\n\u00a0 \u00a0 return 0;\n\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_6","title":"\u6700\u5c0f\u751f\u6210\u6811","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#kruskal","title":"Kruskal\u7b97\u6cd5","text":"<pre><code>//Kruskal\u7b97\u6cd5\u6c42\u6700\u5c0f\u751f\u6210\u6811\n#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\n#include&lt;cstring&gt;\nusing namespace std;\n\nconst int N=10010,M=3*N;\n\n\nint n,m;//n\u662f\u70b9\u6570\uff0cm\u662f\u8fb9\u6570\nint p[N];//\u5e76\u67e5\u96c6\u7684\u7236\u8282\u70b9\u6570\u7ec4\n\nstruct edge     //\u50a8\u5b58\u8fb9\n{\n    int a,b,w;\n    bool operator&lt; (const edge &amp;W)const\n    {\n        return w &lt; W.w;\n    }\n}e[M];\n\nint find(int x) //\u5e76\u67e5\u96c6\u64cd\u4f5c\n{\n    if(p[x]!=x)\n    p[x]=find(p[x]);\n    return p[x];\n}\n\nint kur()\n{\n    int r=0;\n    int cnt=0;      //\u8bb0\u5f55\u8fb9\u6570\n    int i;\n    for(i=0;i&lt;m;i++)\n    {\n        int a=e[i].a,b=e[i].b,w=e[i].w;\n        a=find(a);\n        b=find(b);\n        if(a!=b)    //\u5982\u679c\u8fd9\u4e24\u4e2a\u8fde\u901a\u5757\u4e0d\u8054\u901a\uff0c\u5219\u5c06\u8fd9\u4e24\u4e2a\u8054\u901a\u5757\u5408\u5e76\uff0c\u6dfb\u52a0\u8fb9\n        {\n            p[a]=b;\n            r=+w;\n            cnt++;\n        }\n    }\n    if(cnt&lt;n-1)\n    return -1;\n    else\n    return r;\n}\n\nint main()\n{\n    scanf(\"%d%d\",&amp;n,&amp;m);\n    int i,j,k;\n    for(i=1;i&lt;=n;i++)\n    {\n        p[i]=i;\n    }\n\n    for(i=0;i&lt;m;i++)\n    {\n        int a,b,w;\n        scanf(\"%d%d%d\",&amp;a,&amp;b,&amp;w);\n        e[i]={a,b,w};\n    }\n\n    sort(e,e+m);\n\n    printf(\"%d\",kur());\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_7","title":"\u6b21\u5c0f\u751f\u6210\u6811","text":"<pre><code>//Todo:\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#spfa_1","title":"SPFA\u6c42\u8d1f\u73af","text":"<p>SPFA\u6a21\u677f: Algorithm/spfa\u7b97\u6cd5.cpp at main \u00b7 PiakoCode/Algorithm (github.com)</p> <pre><code>//Todo:\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#lca","title":"LCA(\u6700\u8fd1\u516c\u5171\u7956\u5148)","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_8","title":"\u500d\u589e\u6cd5","text":"<p>1172. \u7956\u5b59\u8be2\u95ee - AcWing\u9898\u5e93 <pre><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\nusing namespace std;\n\nconst int N = 40010, M = N * 2;\n\nint n, m;\nint h[N], e[M], ne[M], idx;\nint depth[N], fa[N][16];\nint q[N];\n\nvoid add(int a, int b)\n{\n    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;\n}\n\nvoid bfs(int root)\n{\n    memset(depth, 0x3f, sizeof depth);\n    depth[0] = 0, depth[root] = 1;\n    int hh = 0, tt = 0;\n    q[0] = root;\n    while (hh &lt;= tt)\n    {\n        int t = q[hh ++ ];\n        for (int i = h[t]; ~i; i = ne[i])\n        {\n            int j = e[i];\n            if (depth[j] &gt; depth[t] + 1)\n            {\n                depth[j] = depth[t] + 1;\n                q[ ++ tt] = j;\n                fa[j][0] = t;\n                for (int k = 1; k &lt;= 15; k ++ )\n                    fa[j][k] = fa[fa[j][k - 1]][k - 1];\n            }\n        }\n    }\n}\n\nint lca(int a, int b)\n{\n    if (depth[a] &lt; depth[b]) swap(a, b);\n    for (int k = 15; k &gt;= 0; k -- )\n        if (depth[fa[a][k]] &gt;= depth[b])\n            a = fa[a][k];\n    if (a == b) return a;\n    for (int k = 15; k &gt;= 0; k -- )\n        if (fa[a][k] != fa[b][k])\n        {\n            a = fa[a][k];\n            b = fa[b][k];\n        }\n    return fa[a][0];\n}\n\nint main()\n{\n    scanf(\"%d\", &amp;n);\n    int root = 0;\n    memset(h, -1, sizeof h);\n\n    for (int i = 0; i &lt; n; i ++ )\n    {\n        int a, b;\n        scanf(\"%d%d\", &amp;a, &amp;b);\n        if (b == -1) root = a;\n        else add(a, b), add(b, a);\n    }\n\n    bfs(root);\n\n    scanf(\"%d\", &amp;m);\n    while (m -- )\n    {\n        int a, b;\n        scanf(\"%d%d\", &amp;a, &amp;b);\n        int p = lca(a, b);\n        if (p == a) puts(\"1\");\n        else if (p == b) puts(\"2\");\n        else puts(\"0\");\n    }\n\n    return 0;\n}\n</code></pre></p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#tarjan","title":"Tarjan\u7b97\u6cd5","text":"<p>1171. \u8ddd\u79bb - AcWing\u9898\u5e93</p> <pre><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;vector&gt;\n\nusing namespace std;\n\ntypedef pair&lt;int, int&gt; PII;\n\nconst int N = 10010, M = N * 2;\n\nint n, m;\nint h[N], e[M], w[M], ne[M], idx;\nint dist[N];\nint p[N];\nint res[M];\nint st[N];\nvector&lt;PII&gt; query[N];   // first\u5b58\u67e5\u8be2\u7684\u53e6\u5916\u4e00\u4e2a\u70b9\uff0csecond\u5b58\u67e5\u8be2\u7f16\u53f7\n\nvoid add(int a, int b, int c)\n{\n    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;\n}\n\nvoid dfs(int u, int fa)\n{\n    for (int i = h[u]; ~i; i = ne[i])\n    {\n        int j = e[i];\n        if (j == fa) continue;\n        dist[j] = dist[u] + w[i];\n        dfs(j, u);\n    }\n}\n\nint find(int x)\n{\n    if (p[x] != x) p[x] = find(p[x]);\n    return p[x];\n}\n\nvoid tarjan(int u)\n{\n    st[u] = 1;\n    for (int i = h[u]; ~i; i = ne[i])\n    {\n        int j = e[i];\n        if (!st[j])\n        {\n            tarjan(j);\n            p[j] = u;\n        }\n    }\n\n    for (auto item : query[u])\n    {\n        int y = item.first, id = item.second;\n        if (st[y] == 2)\n        {\n            int anc = find(y);\n            res[id] = dist[u] + dist[y] - dist[anc] * 2;\n        }\n    }\n\n    st[u] = 2;\n}\n\nint main()\n{\n    scanf(\"%d%d\", &amp;n, &amp;m);\n    memset(h, -1, sizeof h);\n    for (int i = 0; i &lt; n - 1; i ++ )\n    {\n        int a, b, c;\n        scanf(\"%d%d%d\", &amp;a, &amp;b, &amp;c);\n        add(a, b, c), add(b, a, c);\n    }\n\n    for (int i = 0; i &lt; m; i ++ )\n    {\n        int a, b;\n        scanf(\"%d%d\", &amp;a, &amp;b);\n        if (a != b)\n        {\n            query[a].push_back({b, i});\n            query[b].push_back({a, i});\n        }\n    }\n\n    for (int i = 1; i &lt;= n; i ++ ) p[i] = i;\n\n    dfs(1, -1);\n    tarjan(1);\n\n    for (int i = 0; i &lt; m; i ++ ) printf(\"%d\\n\", res[i]);\n\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#scc","title":"SCC(\u5f3a\u8fde\u901a\u5206\u91cf)","text":"<p>Tarjan\u7b97\u6cd5</p> <p></p> <p>1174. \u53d7\u6b22\u8fce\u7684\u725b - AcWing\u9898\u5e93</p> <pre><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\nusing namespace std;\n\nconst int N = 10010, M = 50010;\n\nint n, m;\nint h[N], e[M], ne[M], idx;\nint dfn[N], low[N], timestamp;\nint stk[N], top;\nbool in_stk[N];\nint id[N], scc_cnt, Size[N];//\u6bcf\u4e2a\u5f3a\u8fde\u901a\u5206\u7684\u8282\u70b9\u4e2a\u6570\nint dout[N];\n\nvoid add(int a, int b)\n{\n    e[idx] = b;\n    ne[idx] = h[a];\n    h[a] = idx ++;\n}\n\nvoid tarjan(int u)\n{\n    //u\u7684\u65f6\u95f4\u6233\n    dfn[u] = low[u] = ++timestamp;\n    //\u628a\u5f53\u524d\u70b9\u52a0\u5230\u6808\u4e2d  \u5f53\u524d\u70b9\u5728\u6808\u4e2d\n    stk[++top] = u,in_stk[u] = true;\n\n    for(int i=h[u];i!=-1;i=ne[i])\n    {\n        int j=e[i];\n        if(!dfn[j])//j\u70b9\u672a\u88ab\u904d\u5386\u8fc7\n        {\n            tarjan(j);//\u7ee7\u7eeddfs \u904d\u5386j\n            //j\u4e5f\u8bb8\u5b58\u5728\u53cd\u5411\u8fb9\u5230\u8fbe\u6bd4u\u8fd8\u9ad8\u7684\u5c42,\u6240\u4ee5\u7528j\u80fd\u5230\u7684\u6700\u5c0fdfn\u5e8f(\u6700\u9ad8\u70b9)\u66f4\u65b0u\u80fd\u8fbe\u5230\u7684(\u6700\u5c0fdfn\u5e8f)\u6700\u9ad8\u70b9\n            low[u] = min(low[u],low[j]);\n        }\n        //j\u70b9\u5728\u6808\u4e2d  \u8bf4\u660e\u8fd8\u6ca1\u51fa\u6808 \u662fdfs\u5e8f\u6bd4\u5f53\u524d\u70b9u\u5c0f\u7684\n        //\u5219\u5176 1\u8981\u4e48\u662f\u6a2a\u63d2\u8fb9(\u5de6\u8fb9\u5206\u652f\u7684\u70b9)\n        //         o\n        //        / \\\n        //       j \u2190 u    \n        //     2\u8981\u4e48\u662fu\u7684\u7956\u5b97\u8282\u70b9\n        //         j\n        //       \u2197/ \n        //       u    \n        //    \u4e24\u79cd\u60c5\u51b5u\u7684dfs\u5e8f\u90fd\u6bd4j\u5927 \u6240\u4ee5\u7528dfn[j]\u66f4\u65b0low[u]\n        else if(in_stk[j])\n        {\n            low[u] = min(low[u],dfn[j]);//\u76f4\u63a5\u7528j\u7684\u65f6\u95f4\u6233\u66f4\u65b0u\n        }\n        //\u6808\u4ee3\u8868\u5f53\u524d\u672a\u88ab\u641c\u5b8c\u7684\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u6240\u6709\u70b9\n    }\n    // \u2b50\n    // \u89e3\u91ca\u4e00\u4e0b\u4e3a\u4ec0\u4e48tarjan\u5b8c\u662f\u9006dfs\u5e8f\n    // \u5047\u8bbe\u8fd9\u91cc\u662f\u6700\u9ad8\u7684\u6839\u8282\u70b9fa\n    // \u4e0a\u9762\u51e0\u884c\u4e2d fa\u7684\u513f\u5b50\u8282\u70b9j\u90fd\u5df2\u7ecf\u5728\u5b83\u4eec\u7684\u9012\u5f52\u4e2d\u8d70\u5b8c\u4e86\u4e0b\u97629\u884c\u4ee3\u7801\n    // \u5176\u4e2d\u5c31\u5305\u62ec ++scc_cnt \n    // \u5373\u9012\u5f52\u56de\u6eaf\u5230\u9ad8\u5c42\u8282\u70b9\u7684\u65f6\u5019 \u5b50\u8282\u70b9\u7684scc\u90fd\u6c42\u5b8c\u4e86\n    // \u8282\u70b9\u8d8a\u9ad8 scc_id\u8d8a\u5927\n    // \u5728\u6211\u4eec\u540e\u9762\u60f3\u6c42\u94fe\u8defdp\u7684\u65f6\u5019\u53c8\u5f97\u4ece\u66f4\u9ad8\u5c42\u5f80\u4e0b\n    // \u6240\u4ee5\u5f97for(int i=scc_cnt(\u6839\u8282\u70b9\u6240\u5728\u7684scc);i;i--)\u5f00\u59cb\n\n    // \u6240\u4ee5\u5f53\u904d\u5386\u5b8cu\u7684\u6240\u6709\u80fd\u5230\u7684\u70b9\u540e \u53d1\u73b0u\u6700\u9ad8\u80fd\u5230\u7684\u70b9\u662f\u81ea\u5df1\n    // 1 \u5219u\u4e3a\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u7684\u6700\u9ad8\u70b9,\u5219\u4ee5u\u4e3a\u8d77\u70b9\u5f80\u4e0b\u628a\u8be5\u5f3a\u8fde\u901a\u5206\u91cf\u6240\u6709\u8282\u70b9\u90fd\u627e\u51fa\u6765\n    // 2 \u8981\u4e48\u5b83\u5c31\u6ca1\u6709\u73af,\u5c31\u662f\u4e00\u4e2a\u6b63\u5e38\u7684\u5f80\u4e0b\u7684\u70b9\n    if(dfn[u]==low[u])\n    {\n        int y;\n        ++scc_cnt;//\u5f3a\u8fde\u901a\u5206\u91cf\u603b\u6570+1\n        do\n        {\n            y = stk[top--];//\u53d6\u6808\u9876\u5143\u7d20y\n            in_stk[y] = false;//\u5219y\u4e0d\u518d\u5728\u6808\u4e2d\n            id[y] = scc_cnt;\n            Size[scc_cnt] ++;//\u7b2cscc_cnt\u4e2a\u8fde\u901a\u5757\u70b9\u6570+1\n        }while(y!=u);\n        //1 \u56e0\u4e3a\u6808\u4e2d\u8d8a\u9ad8\u7684\u5143\u7d20\u7684dfs\u5e8f\u8d8a\u5927,\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u628adfs\u5e8f\u6bd4u\u5927\u7684\u8fd9\u4e9bpop\u5230u\n        //\u5373\u56e0\u4e3a\u6700\u7ec8\u4f1a\u4ece\u4e0b\u81f3\u4e0a\u56de\u5230u \u6240\u4ee5\u5f53y==u     \n        //\u5219\u8bf4\u660e\u70b9u\u6240\u5728\u7684\u6240\u6709\u5f3a\u8fde\u901a\u5206\u91cf\u90fd\u6807\u8bb0\u4e86id\n        //           \u2192  u\n        //          /  /\n        //         /  ne1\n        //         \u2190 ne2\n        //      \u56e0\u4e3ane2\u4f1a\u5728u\u80fd\u5230\u7684dfs\u5e8f\u91cc\u6700\u5927\u7684,\u4e5f\u5c31\u662f\u6b64\u65f6\u7684\u6808\u9876\n        //      \u90a3\u4e48\u6211\u4eec\u5c31\u9010\u4e00pop\u51fane2\u548cne1\n        //2 \u8981\u4e48\u5b83\u5c31\u662f\u4e00\u4e2a\u6ca1\u6709\u73af\u7684\u70b9 \u5219\u8be5\u70b9\u5355\u70b9\u6210\u4e00\u4e2a\u8fde\u901a\u5206\u91cf\n    }\n}\n\nint main()\n{\n    cin &gt;&gt; n &gt;&gt; m;\n    memset(h,-1,sizeof h);\n    while(m--)\n    {\n        int a,b;\n        cin &gt;&gt; a &gt;&gt; b;\n        add(a,b);\n    }\n\n    for (int i = 1; i &lt;= n; i ++ )\n        if (!dfn[i])\n            tarjan(i);\n    //\u7edf\u8ba1\u65b0\u56fe\u4e2d\u70b9\u7684\u51fa\u5ea6 \n    for (int i = 1;i &lt;= n; i ++ )\n        for (int j = h[i];j!=-1; j = ne[j])\n        {\n            int k = e[j];\n            int a = id[i], b = id[k];//a,b\u4e0d\u4e3a\u4e00\u4e2a\u8fde\u901a\u5206\u91cf\n            if (a != b) dout[a] ++ ;//a\u51fa\u5ea6+1  dout[a] += i\u2192k\n        }\n    int zeros = 0, sum = 0;//sum \u5b58\u7684\u6240\u6709\u51fa\u5ea6\u4e3a0\u7684\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u70b9\u7684\u6570\u91cf\n    for (int i = 1; i &lt;= scc_cnt; i ++ )\n        if (!dout[i])//\u5982\u679c\u7b2ci\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u51fa\u5ea6==0\n        {\n            zeros ++ ;\n            sum += Size[i];//\u5219\u52a0\u4e0a\u7b2ci\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u70b9\u7684\u4e2a\u6570\n            if (zeros &gt; 1)//\u5982\u679c\u6709k&gt;1\u4e2a\u51fa\u5ea6\u4e3a0\u7684 \u5219\u4f1a\u5b58\u5728k-1\u5934\u725b\u4e0d\u88ab\u6240\u6709\u725b\u6b22\u8fce\n            {\n                sum = 0;\n                break;\n            }\n        }\n\n    cout &lt;&lt; sum;\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_9","title":"\u6570\u5b66","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_10","title":"\u8d28\u6570\u7b5b","text":"<pre><code>//\u6b27\u62c9\u7b5b\u6cd5\uff0c\u65f6\u95f4\u590d\u6742\u5ea6:O(n)\n#include&lt;iostream&gt;\nusing namespace std;\nconst int MAXN = 1000010;\nint p[MAXN];\nint v[MAXN];\nint cnt = 0;\n// C++ Version\nvoid init() {\n  for (int i = 2; i &lt; MAXN; ++i) {\n    if (!v[i]) {\n      p[cnt++] = i;\n    }\n    for (int j = 0; j &lt; cnt; ++j) {\n      if (1ll * i * p[j] &gt;= MAXN) break;\n      v[i * p[j]] = 1;\n      if (i % p[j] == 0) {\n        // i % p[j] == 0\n        // \u6362\u8a00\u4e4b\uff0ci \u4e4b\u524d\u88ab p[j] \u7b5b\u8fc7\u4e86\n        // \u7531\u4e8e p \u91cc\u9762\u8d28\u6570\u662f\u4ece\u5c0f\u5230\u5927\u7684\uff0c\u6240\u4ee5 i \u4e58\u4e0a\u5176\u4ed6\u7684\u8d28\u6570\u7684\u7ed3\u679c\u4e00\u5b9a\u4e5f\u662f\n        // p[j] \u7684\u500d\u6570 \u5b83\u4eec\u90fd\u88ab\u7b5b\u8fc7\u4e86\uff0c\u5c31\u4e0d\u9700\u8981\u518d\u7b5b\u4e86\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f4\u63a5 break\n        // \u6389\u5c31\u597d\u4e86\n        break;\n      }\n    }\n  }\n}\n\nint main()\n{\n  for (int i = 0; i &lt; 100;i++)\n  {\n    cout &lt;&lt; p[i] &lt;&lt; endl;\n  }\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_11","title":"\u5feb\u901f\u5e42","text":"<p>\u6c42\\(a^n\\)</p> <pre><code>//\u9012\u5f52\u5f0f,\u65f6\u95f4\u590d\u6742\u5ea6:O(log n )\nlong long binpow(long long a, long long b) {\n  if (b == 0) return 1;\n  long long res = binpow(a, b / 2);\n  if (b % 2)\n    return res * res * a;\n  else\n    return res * res;\n}\n</code></pre> <pre><code>//\u975e\u9012\u5f52\u5f0f\nlong long binpow(long long a, long long b)\n{\n    long long res = 1;\n    while (b &gt; 0)\n    {\n        if (b &amp; 1)\n            res = res * a;\n        a = a * a;\n        b &gt;&gt;= 1;\n    }\n    return res;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_12","title":"\u4f4d\u8fd0\u7b97","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_13","title":"\u53d6\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c","text":"<pre><code>// \u5982\u679c a&gt;=b,(a-b)&gt;&gt;31 \u4e3a 0\uff0c\u5426\u5219\u4e3a -1 \nint max(int a, int b) { return b &amp; ((a - b) &gt;&gt; 31) | a &amp; (~(a - b) &gt;&gt; 31); } \nint min(int a, int b) { return a &amp; ((a - b) &gt;&gt; 31) | b &amp; (~(a - b) &gt;&gt; 31); }\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_14","title":"\u5224\u65ad\u4e24\u975e\u96f6\u6570\u7b26\u53f7\u662f\u5426\u76f8\u540c","text":"<pre><code>bool isSameSign(int x, int y) \n{ // \u6709 0 \u7684\u60c5\u51b5\u4f8b\u5916 \n    return (x ^ y) &gt;= 0; \n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_15","title":"\u64cd\u4f5c\u4e00\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u4f4d","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_16","title":"\u6a21\u62df\u96c6\u5408\u64cd\u4f5c","text":"<p>\u4e3b\u8981\u7528\u4e8e\u72b6\u6001\u538b\u7f29</p> <p></p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_17","title":"\u6700\u5927\u516c\u7ea6\u6570","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_18","title":"\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5","text":"<p>\u5e38\u7528\u4e8e\u6c42\\(ax+by=gcd(a,b)\\)\u7684\u4e00\u7ec4\u53ef\u884c\u89e3</p> <p></p> <p>\u5b9e\u73b0:</p> <p><pre><code>// \u9012\u5f52\u6cd5\nint Exgcd(int a, int b, int &amp;x, int &amp;y)\n{\n    if (!b)\n    {\n        x = 1;\n        y = 0;\n        return a;\n    }\n    int d = Exgcd(b, a % b, x, y);\n    int t = x;\n    x = y;\n    y = t - (a / b) * y;\n    return d;\n}\n</code></pre> <pre><code>// \u8fed\u4ee3\u6cd5\nint Exgcd(int a, int b, int &amp;x, int &amp;y)\n{\n    x = 1, y = 0;\n    int x1 = 0, y1 = 1, a1 = a, b1 = b;\n    while (b1)\n    {\n        int q = a1 / b1;\n        tie(x, x1) = make_tuple(x1, x - q * x1);\n        tie(y, y1) = make_tuple(y1, y - q * y1);\n        tie(a1, b1) = make_tuple(b1, a1 - q * b1);\n    }\n    return a1;\n}\n</code></pre></p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_19","title":"\u52a8\u6001\u89c4\u5212","text":"<p>\u52a8\u6001\u89c4\u5212</p> <p>DP\u5206\u6790\u6cd5</p> <ol> <li>\u72b6\u6001\u8868\u793a</li> <li>\u96c6\u5408</li> <li>\u5c5e\u6027</li> <li>\u72b6\u6001\u8ba1\u7b97(\u96c6\u5408\u5212\u5206)</li> </ol> <p>\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b</p> <p></p> <p></p> <p></p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#0-1","title":"0-1\u80cc\u5305\u95ee\u9898","text":"<pre><code>//\u4f18\u5316\u540e\n#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\n\nconst int N=1010;\nint n,m;\nint f[N];\nint v[N],w[N];\n\nint main()\n{\n    cin&gt;&gt;n&gt;&gt;m;\n    int i,j;\n    for(i=1;i&lt;=n;i++)\n    {\n        cin&gt;&gt;v[i]&gt;&gt;w[i];\n    }\n\n    for(i=1;i&lt;=n;i++)\n    {\n        for(j=m;j&gt;=v[i];j--)\n        {\n                f[j]=max(f[j],f[j-v[i]]+w[i]);\n                //f[j]-\u4e0d\u653e\u5165\u5165\u7269\u54c1\n                //f[j-v[i]]+w[i]-\u653e\u5165\u7269\u54c1\n                //j-\u5269\u4f59\u7684\u5bb9\u91cf\n                //j-v[i]\u653e\u5165\u7b2ci\u4e2a\u7269\u54c1\u540e\u5269\u4f59\u7684\u5bb9\u91cf\n        }\n    }\n    int res=0;\n    for(i=1;i&lt;=m;i++)\n    {\n        res=max(res,f[i]);\n    }\n    cout&lt;&lt;res&lt;&lt;endl;\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_20","title":"\u5b8c\u5168\u80cc\u5305\u95ee\u9898","text":"<pre><code>//\u672a\u4f18\u5316\n#include&lt;iostream&gt;\nusing namespace std;\n\nconst int N=1010;\nint n,m;\nint f[N][N];\nint v[N],w[N];\n\nint main()\n{\n    cin&gt;&gt;n&gt;&gt;m;\n    int i,j,k;\n    for(i=1;i&lt;=n;i++)\n    {\n        cin&gt;&gt;v[i]&gt;&gt;w[i];\n    }\n    for(i=1;i&lt;=n;i++)\n    {\n        for(j=0;j&lt;=m;j++)\n        {\n            for(k=0;k*v[i]&lt;=j;k++)\n            {\n                f[i][j]=max(f[i][j],f[i-1][j-v[i]*k]+w[i]*k);\n            }\n        }\n    }\n    cout&lt;&lt;f[n][m];\n    return 0;\n}\n</code></pre> <pre><code>//\u4f18\u5316\u540e\n#include&lt;iostream&gt;\n#include&lt;algorithm&gt;\nusing namespace std;\n\nconst int N=1010;\nint n,m;\nint v[N],w[N];\nint f[N];\n\nint main()\n{\n    cin&gt;&gt;n&gt;&gt;m;\n    int i,j,k;\n    for(i=1;i&lt;=n;i++)\n    {\n        cin&gt;&gt;v[i]&gt;&gt;w[i];\n    }\n    for (i = 1; i &lt;= n; i++)\n    {\n        for (j = v[i]; j &lt;= m; j++)\n        {\n            f[j] = max(f[j], f[j - v[i]] + w[i]);\n        }\n    }\n    cout&lt;&lt;f[m];\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#dp","title":"\u7ebf\u6027DP","text":"<p>\u6570\u5b57\u4e09\u89d2\u5f62</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\n\nconst int N = 1010;\nconst int INF = 1e9;\nint f[N][N];\nint a[N][N];\nint main()\n{\n    int r;\n    int i, j, k;\n    cin &gt;&gt; r;\n    int t = -10e9;\n    for (i = 1; i &lt;= r; i++)\n    {\n        for (j = 1; j &lt;= i; j++)\n        {\n            cin &gt;&gt; a[i][j];\n        }\n    }\n    for (i = 0; i &lt;= r; i++)\n    {\n        for (j = 0; j &lt;= i + 1; j++)\n        {\n            f[i][j] = -INF;\n        }\n    }\n    f[1][1] = a[1][1];\n    for (i = 2; i &lt;= r; i++)\n    {\n        for (j = 1; j &lt;= i; j++)\n        {\n            f[i][j] = max(f[i - 1][j - 1] + a[i][j], f[i - 1][j] + a[i][j]);\n        }\n    }\n    for (i = 1; i &lt;= r; i++)\n    {\n        t = max(t, f[r][i]);\n    }\n    cout &lt;&lt; t &lt;&lt; endl;\n    return 0;\n}\n</code></pre> <p>895. \u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217 - AcWing\u9898\u5e93</p> <pre><code>#include&lt;iostream&gt;\nusing namespace std;\nconst int N = 10010;\nint f[N];\nint a[N];\nint main()\n{\n    int n;\n    cin&gt;&gt;n;\n    int i,j,k;\n    for (i = 1; i &lt;=n;i++)\n    {\n        cin &gt;&gt; a[i];\n    }\n    for (i = 1; i &lt;= n;i++)\n    {\n        f[i] = 1;\n        for (j = 1; j &lt; i;j++)\n        {\n            if(a[j]&lt;a[i])\n                f[i] = max(f[i], f[j] + 1);\n        }\n    }\n    int res=0;\n    for (i = 0; i &lt;= n;i++)\n    {\n        res = max(res, f[i]);\n    }\n    cout &lt;&lt; res &lt;&lt; endl;\n    return 0;\n}\n</code></pre> <p>897. \u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217 - AcWing\u9898</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\nusing namespace std;\nconst int N = 100010;\n\nchar a[N];\nchar b[N];\nint f[1010][1010];\n\nint main()\n{\n    int n, m;\n    cin &gt;&gt; n &gt;&gt; m;\n    int i, j, k;\n    for (i = 1; i &lt;= n; i++)\n        cin &gt;&gt; a[i];\n    for (i = 1; i &lt;= m; i++)\n        cin &gt;&gt; b[i];\n    for (i = 1; i &lt;= n; i++)\n        for (j = 1; j &lt;= m; j++)\n        {\n            f[i][j] = max(f[i - 1][j], f[i][j - 1]);\n            if (a[i] == b[j])\n                f[i][j] = max(f[i - 1][j - 1] + 1, f[i][j]);\n        }\n    cout &lt;&lt; f[n][m] &lt;&lt; endl;\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_21","title":"\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_22","title":"\u6811\u72b6\u6570\u7ec4","text":"<p>!(\u4e94\u5206\u949f\u4e1d\u6ed1\u52a8\u753b\u8bb2\u89e3 | \u6811\u72b6\u6570\u7ec4)[https://www.bilibili.com/video/BV1ce411u7qP] </p> <pre><code>int b[N];\n\ninline int lowbit(int x)\n{\n    return x &amp; (-x);\n}\n\nvoid add(int p, int x) // \u5355\u70b9\u4fee\u6539 || \u521d\u59cb\u5316\n{\n    while (p &lt; N)\n    {\n        b[p] += x;\n        p += lowbit(p);\n    }\n}\n\nLL getSum(int p) // a[1]...a[p]\u7684\u548c\n{\n    LL result = 0;\n    while (p)\n    {\n        result += b[p];\n        p -= lowbit(p);\n    }\n    return result;\n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_23","title":"\u7ebf\u6bb5\u6811","text":"<p>\u65e0lazy\u6807\u8bb0 <pre><code>void pushup(int u) // \u7531\u5b50\u8282\u70b9\u7684\u4fe1\u606f\uff0c\u6765\u8ba1\u7b97\u7236\u8282\u70b9\u7684\u4fe1\u606f\n{\n\u00a0 \u00a0 tr[u].v = max(tr[u &lt;&lt; 1].v, tr[u &lt;&lt; 1 | 1].v);\n}\n\nvoid build(int u, int l, int r)\n{\n\u00a0 \u00a0 tr[u] = {l, r};\n\u00a0 \u00a0 if (l == r)\n\u00a0 \u00a0 \u00a0 \u00a0 return;\n\u00a0 \u00a0 int mid = l + r &gt;&gt; 1;\n\u00a0 \u00a0 build(u &lt;&lt; 1, l, mid), build(u &lt;&lt; 1 | 1, mid + 1, r);\n}\n\nint query(int u, int l, int r)\n{\n\u00a0 \u00a0 if (tr[u].l &gt;= l &amp;&amp; tr[u].r &lt;= r)\n\u00a0 \u00a0 \u00a0 \u00a0 return tr[u].v; // \u6811\u4e2d\u8282\u70b9\uff0c\u5df2\u7ecf\u88ab\u5b8c\u5168\u5305\u542b\u5728[l, r]\u4e2d\u4e86\n\n\u00a0 \u00a0 int mid = tr[u].l + tr[u].r &gt;&gt; 1;\n\u00a0 \u00a0 int v = 0;\n\u00a0 \u00a0 if (l &lt;= mid)\n\u00a0 \u00a0 \u00a0 \u00a0 v = query(u &lt;&lt; 1, l, r);\n\u00a0 \u00a0 if (r &gt; mid)\n\u00a0 \u00a0 \u00a0 \u00a0 v = max(v, query(u &lt;&lt; 1 | 1, l, r));\n\n \u00a0 return v;\n}\n\nvoid modify(int u, int x, int v)\n{\n\u00a0 \u00a0 if (tr[u].l == x &amp;&amp; tr[u].r == x)\n\u00a0 \u00a0 \u00a0 \u00a0 tr[u].v = v;\n\u00a0 \u00a0 else\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 int mid = tr[u].l + tr[u].r &gt;&gt; 1;\n\u00a0 \u00a0 \u00a0 \u00a0 if (x &lt;= mid)\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 modify(u &lt;&lt; 1, x, v);\n\u00a0 \u00a0 \u00a0 \u00a0 else\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 modify(u &lt;&lt; 1 | 1, x, v);\n\u00a0 \u00a0 \u00a0 \u00a0 pushup(u);\n\u00a0 \u00a0 }\n}\n</code></pre> \u6709lazy\u6807\u8bb0 <pre><code>int n, m;\nint w[N];\n\nstruct Node\n{\n\u00a0 \u00a0 int l, r;\n\u00a0 \u00a0 LL sum, add;\n} tr[N * 4];\n\n\nvoid pushup(int u)\n{\n\u00a0 \u00a0 tr[u].sum = tr[u &lt;&lt; 1].sum + tr[u &lt;&lt; 1 | 1].sum;\n}\n\n\nvoid pushdown(int u)\n{\n\u00a0 \u00a0 auto &amp;root = tr[u], &amp;left = tr[u &lt;&lt; 1], &amp;right = tr[u &lt;&lt; 1 | 1];\n\u00a0 \u00a0 if (root.add)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 left.add += root.add, left.sum += (LL)(left.r - left.l + 1) * root.add;\n\u00a0 \u00a0 \u00a0 \u00a0 right.add += root.add, right.sum += (LL)(right.r - right.l + 1) * root.add;\n\u00a0 \u00a0 \u00a0 \u00a0 root.add = 0;\n\u00a0 \u00a0 }\n}\nvoid build(int u, int l, int r)\n{\n\u00a0 \u00a0 if (l == r)\n\u00a0 \u00a0 \u00a0 \u00a0 tr[u] = {l, r, w[r], 0};\n\u00a0 \u00a0 else\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 tr[u] = {l, r};\n\u00a0 \u00a0 \u00a0 \u00a0 int mid = l + r &gt;&gt; 1;\n\u00a0 \u00a0 \u00a0 \u00a0 build(u &lt;&lt; 1, l, mid), build(u &lt;&lt; 1 | 1, mid + 1, r);\n\u00a0 \u00a0 \u00a0 \u00a0 pushup(u);\n\u00a0 \u00a0 }\n}\nvoid modify(int u, int l, int r, int d)\n{\n\u00a0 \u00a0 if (tr[u].l &gt;= l &amp;&amp; tr[u].r &lt;= r)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 tr[u].sum += (LL)(tr[u].r - tr[u].l + 1) * d;\n\u00a0 \u00a0 \u00a0 \u00a0 tr[u].add += d;\n\u00a0 \u00a0 }\n\u00a0 \u00a0 else // \u4e00\u5b9a\u8981\u5206\u88c2\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 pushdown(u);\n\u00a0 \u00a0 \u00a0 \u00a0 int mid = tr[u].l + tr[u].r &gt;&gt; 1;\n\u00a0 \u00a0 \u00a0 \u00a0 if (l &lt;= mid)\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 modify(u &lt;&lt; 1, l, r, d);\n\u00a0 \u00a0 \u00a0 \u00a0 if (r &gt; mid)\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 modify(u &lt;&lt; 1 | 1, l, r, d);\n\u00a0 \u00a0 \u00a0 \u00a0 pushup(u);\n\u00a0 \u00a0 }\n}\nLL query(int u, int l, int r)\n{\n\u00a0 \u00a0 if (tr[u].l &gt;= l &amp;&amp; tr[u].r &lt;= r)\n\u00a0 \u00a0 \u00a0 \u00a0 return tr[u].sum;\n\n\u00a0 \u00a0 pushdown(u);\n\u00a0 \u00a0 int mid = tr[u].l + tr[u].r &gt;&gt; 1;\n\u00a0 \u00a0 LL sum = 0;\n\u00a0 \u00a0 if (l &lt;= mid)\n\u00a0 \u00a0 \u00a0 \u00a0 sum = query(u &lt;&lt; 1, l, r);\n\u00a0 \u00a0 if (r &gt; mid)\n\u00a0 \u00a0 \u00a0 \u00a0 sum += query(u &lt;&lt; 1 | 1, l, r);\n\u00a0 \u00a0 return sum;\n}\n</code></pre> P3372 \u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811 1 - \u6d1b\u8c37 </p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#trie","title":"\u5b57\u5178\u6811(Trie)","text":"<p>\u5b57\u5178\u6811 (Trie)-OI Wiki </p> <p>142. \u524d\u7f00\u7edf\u8ba1 - AcWing\u9898\u5e93 <pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;cstring&gt;\nusing namespace std;\n\nconst int N = 100010;\nint son[N][26];\nint cnt[N], idx;\nchar s[N][11];\n\nvoid insert(char *str)  //\u63d2\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\u5230Trie\u91cc\n{\n\u00a0 \u00a0 if (!str)\n\u00a0 \u00a0 \u00a0 \u00a0 return;\n\u00a0 \u00a0 int p = 0;\n\u00a0 \u00a0 int i, j, k;\n\u00a0 \u00a0 for (i = strlen(str) - 1; i &gt;= 0; i--)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 int u = str[i] - 'a';\n\n\u00a0 \u00a0   \u00a0 if (!son[p][u])\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 son[p][u] = ++idx;\n\u00a0 \u00a0 \u00a0 \u00a0 p = son[p][u];\n\u00a0 \u00a0 }\n\u00a0 \u00a0 cnt[p]++;\n}\n\nint query(char *str)  //\u8be2\u95ee\u6709\u591a\u5c11\u4e2a\u5b57\u7b26\u4e32\u662fstr\u7684\u524d\u7f00\n{\n\u00a0 \u00a0 if (!str)\n\u00a0 \u00a0 \u00a0 \u00a0 return 0;\n\u00a0 \u00a0 int p = 0;\n\u00a0 \u00a0 int i, j, k;\n\u00a0 \u00a0 int t = 0;\n\u00a0 \u00a0 for (i = strlen(str) - 1; i &gt;= 0; i--)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 int u = str[i] - 'a';\n\u00a0 \u00a0 \u00a0 \u00a0 if (!son[p][u])\n\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return 0;\n\u00a0 \u00a0 \u00a0 \u00a0 p = son[p][u];\n\u00a0 \u00a0 }\n\u00a0 \u00a0 return cnt[p];\n}\n\nint main()\n{\n\u00a0 \u00a0 int n;\n\u00a0 \u00a0 scanf(\"%d\", &amp;n);\n\u00a0 \u00a0 int i, j, k;\n\u00a0 \u00a0 for (i = 0; i &lt; n; i++)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 scanf(\"%s\", &amp;s[i]);\n\u00a0 \u00a0 \u00a0 \u00a0 insert(s[i]);\n\u00a0 \u00a0 }\n\u00a0 \u00a0 for (i = 0; i &lt; n; i++)\n\u00a0 \u00a0 {\n\u00a0 \u00a0 \u00a0 \u00a0 printf(\"%d\\n\", query(s[i]));\n\u00a0 \u00a0 }\n\u00a0 \u00a0 return 0;\n}\n</code></pre></p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#-treap","title":"\u5e73\u8861\u6811-Treap","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_24","title":"\u4e8c\u53c9\u641c\u7d22\u6811","text":"<p>\u7279\u70b9: \u5de6\u5b50\u6811\u6743\u503c\u4e00\u5b9a\u5c0f\u4e8e\u53f3\u5b50\u6811 </p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_25","title":"\u63d2\u5165","text":"<pre><code>void insert(int&amp; o, int v) { \n    if (!o) { \n        val[o = ++n] = v; \n        cnt[o] = siz[o] = 1; \n        lc[o] = rc[o] = 0; \n        return; \n    } \n    siz[o]++; \n    if (val[o] == v) { \n        cnt[o]++; \n        return;\n    } \n    if (val[o] &gt; v) insert(lc[o], v); \n    if (val[o] &lt; v) insert(rc[o], v); \n}\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_26","title":"\u67e5\u627e\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c","text":"<p>\u6700\u5927\u503c\uff1a\u627e\u6811\u4e2d\u6700\u53f3\u7684\u7ed3\u70b9 \u6700\u5c0f\u503c\uff1a\u627e\u6811\u4e2d\u6700\u5de6\u7684\u7ed3\u70b9 <pre><code>int findmin(int o) { \n    if (!lc[o]) return o; \n    return findmin(lc[o]); // \u4e00\u76f4\u5411\u5de6\u513f\u5b50\u8df3 \n} \n\nint findmax(int o) { \n    if (!rc[o]) return o; \n    return findmax(rc[o]); // \u4e00\u76f4\u5411\u53f3\u513f\u5b50\u8df3 \n}\n</code></pre></p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_27","title":"\u67e5\u627e\u524d\u9a71","text":"<ol> <li>\u5b58\u5728\u5de6\u5b50\u6811\uff0c\u5219\u5de6\u5b50\u6811\u5c31\u662f\u524d\u9a71\u7ed3\u70b9</li> <li>\u4e0d\u5b58\u5728\u5de6\u5b50\u6811\uff0c(1) \u5982\u679c\u8be5\u7ed3\u70b9\u662f\u67d0\u7ed3\u70b9\u7684\u53f3\u5b50\u6811\uff0c\u5219\u7236\u8282\u70b9\u5c31\u662f\u524d\u9a71\u7ed3\u70b9<pre><code>          (2) \u5982\u679c\u8be5\u7ed3\u70b9\u662f\u67d0\u7ed3\u70b9\u7684\u5de6\u5b50\u6811\uff0c\u5219\u7956\u5148\u7ed3\u70b9\u4e2d\u7b2c\u4e00\u4e2a\u65b9\u5411\u76f8\u53cd\u7684\u7ed3\u70b9\u4e3a\u524d\u9a71\u7ed3\u70b9\uff0c\u5982\u56fe\u6240\u793a\n</code></pre> <p> \u4ee5\u4e0a\u64cd\u4f5c\u90fd\u53ef\u4ee5\u7528set\u5904\u7406 \u63d2\u5165: <code>insert()</code> \u5220\u9664: <code>earse()</code> \u67e5\u627e: <code>lower_bound()</code> \u6700\u5927/\u6700\u5c0f\u503c: <code>begin(), end()-1</code></p> </li> </ol>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_28","title":"\u6c42\u67d0\u4e00\u503c\u7684\u6392\u540d","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#k","title":"\u6c42\u6392\u540d\u4e3ak\u7684\u6570","text":""},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#treap","title":"Treap","text":"<p>\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u300c\u5e73\u8861\u300d\u6982\u5ff5\u662f\u6307\uff1a\u6bcf\u4e00\u4e2a\u7ed3\u70b9\u7684\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u9ad8\u5ea6\u5dee\u6700\u591a\u4e3a\u00a01\u3002</p>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_29","title":"\u7ed3\u70b9\u7ed3\u6784","text":"<pre><code>struct Node\n{\n    int l, r;\n    int key, val;  //key:\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6743\u503c val:\u5806\u7684\u6743\u503c\n    int cnt, size; //cnt:\u8be5\u6570\u5b57\u6709\u591a\u5c11\u4e2a size:\u8be5\u5b50\u6811\u4e2d\u4e00\u5171\u6709\u591a\u5c11\u4e2a\u6570\u5b57\n}tr[N];\n</code></pre>"},{"location":"Algorithm/%F0%9F%A7%90%E7%AE%97%E6%B3%95%E7%AC%94%E8%AE%B0/#_30","title":"\u5de6\u65cb\u4e0e\u53f3\u65cb","text":"<p>[!info] \u56fe\u4e2d\u7684\u6570\u5b57\u662f\u7f16\u53f7\uff0c\u800c\u975e\u6743\u503c</p> <p>253. \u666e\u901a\u5e73\u8861\u6811 - AcWing\u9898\u5e93 \u60a8\u9700\u8981\u5199\u4e00\u79cd\u6570\u636e\u7ed3\u6784\uff08\u53ef\u53c2\u8003\u9898\u76ee\u6807\u9898\uff09\uff0c\u6765\u7ef4\u62a4\u4e00\u4e9b\u6570\uff0c\u5176\u4e2d\u9700\u8981\u63d0\u4f9b\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <ol> <li>\u63d2\u5165\u6570\u503c\u00a0x\u3002</li> <li>\u5220\u9664\u6570\u503c\u00a0x(\u82e5\u6709\u591a\u4e2a\u76f8\u540c\u7684\u6570\uff0c\u5e94\u53ea\u5220\u9664\u4e00\u4e2a)\u3002</li> <li>\u67e5\u8be2\u6570\u503c\u00a0x\u00a0\u7684\u6392\u540d(\u82e5\u6709\u591a\u4e2a\u76f8\u540c\u7684\u6570\uff0c\u5e94\u8f93\u51fa\u6700\u5c0f\u7684\u6392\u540d)\u3002</li> <li>\u67e5\u8be2\u6392\u540d\u4e3a\u00a0x\u00a0\u7684\u6570\u503c\u3002</li> <li>\u6c42\u6570\u503c\u00a0x\u00a0\u7684\u524d\u9a71(\u524d\u9a71\u5b9a\u4e49\u4e3a\u5c0f\u4e8e\u00a0x\u00a0\u7684\u6700\u5927\u7684\u6570)\u3002</li> <li>\u6c42\u6570\u503c\u00a0x\u00a0\u7684\u540e\u7ee7(\u540e\u7ee7\u5b9a\u4e49\u4e3a\u5927\u4e8e\u00a0x\u00a0\u7684\u6700\u5c0f\u7684\u6570)\u3002</li> </ol> <p>\u6ce8\u610f\uff1a\u00a0\u6570\u636e\u4fdd\u8bc1\u67e5\u8be2\u7684\u7ed3\u679c\u4e00\u5b9a\u5b58\u5728\u3002</p> <p>\u8f93\u5165\u683c\u5f0f</p> <p>\u7b2c\u4e00\u884c\u4e3a\u00a0n\uff0c\u8868\u793a\u64cd\u4f5c\u7684\u4e2a\u6570\u3002</p> <p>\u63a5\u4e0b\u6765\u00a0n\u00a0\u884c\u6bcf\u884c\u6709\u4e24\u4e2a\u6570\u00a0opt\u00a0\u548c\u00a0x\uff0copt\u00a0\u8868\u793a\u64cd\u4f5c\u7684\u5e8f\u53f7(1\u2264opt\u22646)\u3002</p> <p>\u8f93\u51fa\u683c\u5f0f</p> <p>\u5bf9\u4e8e\u64cd\u4f5c\u00a03,4,5,6\u00a0\u6bcf\u884c\u8f93\u51fa\u4e00\u4e2a\u6570\uff0c\u8868\u793a\u5bf9\u5e94\u7b54\u6848\u3002</p> <p>\u6570\u636e\u8303\u56f4</p> <p>1\u2264n\u2264100000,\u6240\u6709\u6570\u5747\u5728\u00a0\u221210e7 \u5230 10e7\u00a0\u00a0\u5185\u3002</p> <p>\u8f93\u5165\u6837\u4f8b\uff1a</p> <pre><code>8\n1 10\n1 20\n1 30\n3 20\n4 2\n2 10\n5 25\n6 -1\n</code></pre> <p>\u8f93\u51fa\u6837\u4f8b\uff1a</p> <pre><code>2\n20\n20\n20\n</code></pre> <pre><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\nusing namespace std;\n\nconst int N = 100010, INF = 1e8;\n\nint n;\nstruct Node\n{\n    int l, r;\n    int key, val;  //key:\u4e8c\u53c9\u641c\u7d22\u6811\u7684\u6743\u503c val:\u5806\u7684\u6743\u503c\n    int cnt, size; //cnt:\u8be5\u6570\u5b57\u6709\u591a\u5c11\u4e2a size:\u8be5\u5b50\u6811\u4e2d\u4e00\u5171\u6709\u591a\u5c11\u4e2a\u6570\u5b57\n}tr[N];\n\nint root, idx;\n\nvoid pushup(int p) //\u66f4\u65b0\u8be5\u7ed3\u70b9\u4fe1\u606f\n{\n    tr[p].size = tr[tr[p].l].size + tr[tr[p].r].size + tr[p].cnt; //p\u7684size\n}\n\nint get_node(int key)\n{\n    tr[ ++ idx].key = key;\n    tr[idx].val = rand(); //\u4f7f\u7528\u968f\u673a\u503c\uff0c\u9632\u6b62\u9000\u5316\u6210\u94fe\u7684\u6781\u7aef\u60c5\u51b5\uff0c\u8ba9\u4e8c\u53c9\u641c\u7d22\u6811\u8fbe\u5230\u7406\u60f3\u7684\u590d\u6742\u5ea6\n    tr[idx].cnt = tr[idx].size = 1; //\u521a\u521b\u5efa\u65f6\u4e00\u5b9a\u662f\u53f6\u7ed3\u70b9\n    return idx;\n}\n\nvoid zig(int &amp;p)    // \u53f3\u65cb\n{\n    int q = tr[p].l;\n    tr[p].l = tr[q].r, tr[q].r = p, p = q;\n    pushup(tr[p].r), pushup(p);\n}\n\nvoid zag(int &amp;p)    // \u5de6\u65cb\n{\n    int q = tr[p].r;\n    tr[p].r = tr[q].l, tr[q].l = p, p = q;\n    pushup(tr[p].l), pushup(p);\n}\n\nvoid build() //\u5efa\u6811\n{\n    get_node(-INF), get_node(INF); //\u54e8\u5175\u7ed3\u70b9\n    root = 1, tr[1].r = 2;\n    pushup(root);\n\n    if (tr[1].val &lt; tr[2].val) zag(root);\n}\n\n\nvoid insert(int &amp;p, int key) //\u63d2\u5165\n{\n    if (!p) p = get_node(key);\n    else if (tr[p].key == key) tr[p].cnt ++ ;\n    else if (tr[p].key &gt; key)\n    {\n        insert(tr[p].l, key);\n        if (tr[tr[p].l].val &gt; tr[p].val) zig(p);\n    }\n    else\n    {\n        insert(tr[p].r, key);\n        if (tr[tr[p].r].val &gt; tr[p].val) zag(p);\n    }\n    pushup(p);\n}\n\nvoid remove(int &amp;p, int key) //\u5220\u9664\n{\n    if (!p) return;\n    if (tr[p].key == key)\n    {\n        if (tr[p].cnt &gt; 1) tr[p].cnt -- ;\n        else if (tr[p].l || tr[p].r)\n        {\n            if (!tr[p].r || tr[tr[p].l].val &gt; tr[tr[p].r].val)\n            {\n                zig(p);\n                remove(tr[p].r, key);\n            }\n            else\n            {\n                zag(p);\n                remove(tr[p].l, key);\n            }\n        }\n        else p = 0;\n    }\n    else if (tr[p].key &gt; key) remove(tr[p].l, key);\n    else remove(tr[p].r, key);\n\n    pushup(p);\n}\n\nint get_rank_by_key(int p, int key)    // \u901a\u8fc7\u6570\u503c\u627e\u6392\u540d\n{\n    if (!p) return 0;   // \u672c\u9898\u4e2d\u4e0d\u4f1a\u53d1\u751f\u6b64\u60c5\u51b5\n    if (tr[p].key == key) return tr[tr[p].l].size + 1;\n    if (tr[p].key &gt; key) return get_rank_by_key(tr[p].l, key);\n    return tr[tr[p].l].size + tr[p].cnt + get_rank_by_key(tr[p].r, key);\n}\n\nint get_key_by_rank(int p, int rank)   // \u901a\u8fc7\u6392\u540d\u627e\u6570\u503c\n{\n    if (!p) return INF;     // \u672c\u9898\u4e2d\u4e0d\u4f1a\u53d1\u751f\u6b64\u60c5\u51b5\n    if (tr[tr[p].l].size &gt;= rank) return get_key_by_rank(tr[p].l, rank);\n    if (tr[tr[p].l].size + tr[p].cnt &gt;= rank) return tr[p].key;\n    return get_key_by_rank(tr[p].r, rank - tr[tr[p].l].size - tr[p].cnt);\n}\n\nint get_prev(int p, int key)   // \u627e\u5230\u4e25\u683c\u5c0f\u4e8ekey\u7684\u6700\u5927\u6570\n{\n    if (!p) return -INF;\n    if (tr[p].key &gt;= key) return get_prev(tr[p].l, key);\n    return max(tr[p].key, get_prev(tr[p].r, key));\n}\n\nint get_next(int p, int key)    // \u627e\u5230\u4e25\u683c\u5927\u4e8ekey\u7684\u6700\u5c0f\u6570\n{\n    if (!p) return INF;\n    if (tr[p].key &lt;= key) return get_next(tr[p].r, key);\n    return min(tr[p].key, get_next(tr[p].l, key));\n}\n\nint main()\n{\n    build();\n\n    scanf(\"%d\", &amp;n);\n    while (n -- )\n    {\n        int opt, x;\n        scanf(\"%d%d\", &amp;opt, &amp;x);\n        if (opt == 1) insert(root, x);\n        else if (opt == 2) remove(root, x);\n        else if (opt == 3) printf(\"%d\\n\", get_rank_by_key(root, x) - 1);\n        else if (opt == 4) printf(\"%d\\n\", get_key_by_rank(root, x + 1));\n        else if (opt == 5) printf(\"%d\\n\", get_prev(root, x));\n        else printf(\"%d\\n\", get_next(root, x));\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing%E9%A2%98%E9%9B%86/","title":"ACwing\u9898\u96c6","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing%E9%A2%98%E9%9B%86/#_1","title":"\u641c\u7d22","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing%E9%A2%98%E9%9B%86/#_2","title":"\u8d2a\u5fc3","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing%E9%A2%98%E9%9B%86/#_3","title":"\u52a8\u6001\u89c4\u5212","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing%E9%A2%98%E9%9B%86/#_4","title":"\u56fe\u8bba","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing%E9%A2%98%E9%9B%86/#_5","title":"\u6570\u8bba","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing%E9%A2%98%E9%9B%86/#_6","title":"\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing%E9%A2%98%E9%9B%86/#_7","title":"\u6700\u5927\u6570(\u7ebf\u6bb5\u6811)","text":"<p>1275. \u6700\u5927\u6570 - AcWing\u9898\u5e93 <pre><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int N = 200010;\n\nint m, p;\nstruct Node\n{\n    int l, r;\n    int v;  // \u533a\u95f4[l, r]\u4e2d\u7684\u6700\u5927\u503c\n}tr[N * 4];\n\nvoid pushup(int u)  // \u7531\u5b50\u8282\u70b9\u7684\u4fe1\u606f\uff0c\u6765\u8ba1\u7b97\u7236\u8282\u70b9\u7684\u4fe1\u606f\n{\n    tr[u].v = max(tr[u &lt;&lt; 1].v, tr[u &lt;&lt; 1 | 1].v);\n}\n\nvoid build(int u, int l, int r)\n{\n    tr[u] = {l, r};\n    if (l == r) return;\n    int mid = l + r &gt;&gt; 1;\n    build(u &lt;&lt; 1, l, mid), build(u &lt;&lt; 1 | 1, mid + 1, r);\n}\n\nint query(int u, int l, int r)\n{\n    if (tr[u].l &gt;= l &amp;&amp; tr[u].r &lt;= r) return tr[u].v;   // \u6811\u4e2d\u8282\u70b9\uff0c\u5df2\u7ecf\u88ab\u5b8c\u5168\u5305\u542b\u5728[l, r]\u4e2d\u4e86\n\n    int mid = tr[u].l + tr[u].r &gt;&gt; 1;\n    int v = 0;\n    if (l &lt;= mid) v = query(u &lt;&lt; 1, l, r);\n    if (r &gt; mid) v = max(v, query(u &lt;&lt; 1 | 1, l, r));\n\n    return v;\n}\n\nvoid modify(int u, int x, int v)\n{\n    if (tr[u].l == x &amp;&amp; tr[u].r == x) tr[u].v = v;\n    else\n    {\n        int mid = tr[u].l + tr[u].r &gt;&gt; 1;\n        if (x &lt;= mid) modify(u &lt;&lt; 1, x, v);\n        else modify(u &lt;&lt; 1 | 1, x, v);\n        pushup(u);\n    }\n}\n\n\nint main()\n{\n    int n = 0, last = 0;\n    scanf(\"%d%d\", &amp;m, &amp;p);\n    build(1, 1, m);\n\n    int x;\n    char op[2];\n    while (m -- )\n    {\n        scanf(\"%s%d\", op, &amp;x);\n        if (*op == 'Q')\n        {\n            last = query(1, n - x + 1, n);\n            printf(\"%d\\n\", last);\n        }\n        else\n        {\n            modify(1, n + 1, ((LL)last + x) % p);\n            n ++ ;\n        }\n    }\n\n    return 0;\n}\n</code></pre></p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/1499%20%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86/","title":"\u6811\u7684\u904d\u5386 1499","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/1499%20%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86/#_1","title":"\u4e8c\u53c9\u6811 #\u54c8\u5e0c","text":"<p>1497. \u6811\u7684\u904d\u5386 - AcWing\u9898\u5e93</p> <p>\u4e00\u4e2a\u4e8c\u53c9\u6811\uff0c\u6811\u4e2d\u6bcf\u4e2a\u8282\u70b9\u7684\u6743\u503c\u4e92\u4e0d\u76f8\u540c\u3002</p> <p>\u73b0\u5728\u7ed9\u51fa\u5b83\u7684\u540e\u5e8f\u904d\u5386\u548c\u4e2d\u5e8f\u904d\u5386\uff0c\u8bf7\u4f60\u8f93\u51fa\u5b83\u7684\u5c42\u5e8f\u904d\u5386\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/1499%20%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86/#_2","title":"\u8f93\u5165\u683c\u5f0f","text":"<p>\u7b2c\u4e00\u884c\u5305\u542b\u6574\u6570\u00a0N\uff0c\u8868\u793a\u4e8c\u53c9\u6811\u7684\u8282\u70b9\u6570\u3002</p> <p>\u7b2c\u4e8c\u884c\u5305\u542b\u00a0N\u00a0\u4e2a\u6574\u6570\uff0c\u8868\u793a\u4e8c\u53c9\u6811\u7684\u540e\u5e8f\u904d\u5386\u3002</p> <p>\u7b2c\u4e09\u884c\u5305\u542b\u00a0N\u00a0\u4e2a\u6574\u6570\uff0c\u8868\u793a\u4e8c\u53c9\u6811\u7684\u4e2d\u5e8f\u904d\u5386\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/1499%20%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86/#_3","title":"\u8f93\u51fa\u683c\u5f0f","text":"<p>\u8f93\u51fa\u4e00\u884c\u00a0N\u00a0\u4e2a\u6574\u6570\uff0c\u8868\u793a\u4e8c\u53c9\u6811\u7684\u5c42\u5e8f\u904d\u5386\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/1499%20%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86/#_4","title":"\u6570\u636e\u8303\u56f4","text":"<p>1\u2264N\u226430, \u5b98\u65b9\u5e76\u672a\u7ed9\u51fa\u5404\u8282\u70b9\u6743\u503c\u7684\u53d6\u503c\u8303\u56f4\uff0c\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u5728\u672c\u7f51\u7ad9\u8303\u56f4\u53d6\u4e3a\u00a01\u223cN\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/1499%20%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86/#_5","title":"\u8f93\u5165\u6837\u4f8b\uff1a","text":"<pre><code>7\n2 3 1 5 7 6 4\n1 2 3 4 5 6 7\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/1499%20%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86/#_6","title":"\u8f93\u51fa\u6837\u4f8b\uff1a","text":"<pre><code>4 1 6 3 5 7 2\n</code></pre> <pre><code>#include &lt;bits/stdc++.h&gt;\n\n#define x first\n#define y second\n#define IOS                           \\\n    ios_base::sync_with_stdio(false); \\\n    cin.tie(0);\n#define read(x) scanf(\"%lld\", &amp;x)\n\nusing namespace std;\ntypedef pair&lt;int, int&gt; PII;\ntypedef long long LL;\n\nconst int INF = 0x3f3f3f3f;\nconst int N = 1e6 + 10;\nconst int K = 1e3 + 10;\n\nint a[N];\nint b[N];\nint tr[N];\n\nunordered_map&lt;int, int&gt; l, r, pos;\n\nint build(int al, int ar, int bl, int br)\n{\n    int root = a[ar];\n\n    int k = pos[root]; // K \u662f root \u5728\u4e2d\u5e8f\u7684\u4f4d\u7f6e\n    // \u6bcf\u6b21\u5212\u5206\u540e \u540e\u5e8f\u6811\u7684\u5de6\u53f3\u6811\u4e5f\u4f1a\u6709\u4e0e\u4e2d\u5e8f\u6811\u76f8\u5bf9\u5e94\u7684\u533a\u95f4\u8303\u56f4\n    // \u5b58\u5728\u5de6\u5b50\u6811\n    if (bl &lt; k)\n    {\n        l[root] = build(al, al + ((k - 1) - bl), bl, k - 1);\n    }\n    // \u5b58\u5728\u53f3\u5b50\u6811\n    if (br &gt; k)\n    {\n        r[root] = build(al + ((k - 1) - bl + 1), ar - 1, k + 1, br);\n    }\n    return root;\n}\n\nvoid bfs(int root)\n{\n    queue&lt;int&gt; q;\n    q.push(root);\n    while (q.size())\n    {\n        int t = q.front();\n        q.pop();\n        cout &lt;&lt; t &lt;&lt; \" \";\n\n        if (l.count(t))\n            q.push(l[t]);\n        if (r.count(t))\n            q.push(r[t]);\n    }\n}\n\nint main()\n{\n    IOS;\n\n    int n;\n    cin &gt;&gt; n;\n    for (int i = 1; i &lt;= n; i++)\n    {\n        cin &gt;&gt; a[i];\n    }\n    for (int i = 1; i &lt;= n; i++)\n    {\n        cin &gt;&gt; b[i];\n        pos[b[i]] = i;\n    }\n\n    int root = build(1, n, 1, n);\n    bfs(root);\n\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/284%20%E7%9F%B3%E5%AD%90%E5%90%88%E5%B9%B6/","title":"284 \u77f3\u5b50\u5408\u5e76","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/284%20%E7%9F%B3%E5%AD%90%E5%90%88%E5%B9%B6/#_1","title":"\u77f3\u5b50\u5408\u5e76","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/284%20%E7%9F%B3%E5%AD%90%E5%90%88%E5%B9%B6/#dp","title":"\u52a8\u6001\u89c4\u5212 #\u533a\u95f4DP","text":"<p>282. \u77f3\u5b50\u5408\u5e76 - AcWing\u9898\u5e93</p> <p>\u8bbe\u6709\u00a0N\u00a0\u5806\u77f3\u5b50\u6392\u6210\u4e00\u6392\uff0c\u5176\u7f16\u53f7\u4e3a\u00a01,2,3,\u2026,N\u3002</p> <p>\u6bcf\u5806\u77f3\u5b50\u6709\u4e00\u5b9a\u7684\u8d28\u91cf\uff0c\u53ef\u4ee5\u7528\u4e00\u4e2a\u6574\u6570\u6765\u63cf\u8ff0\uff0c\u73b0\u5728\u8981\u5c06\u8fd9\u00a0N\u00a0\u5806\u77f3\u5b50\u5408\u5e76\u6210\u4e3a\u4e00\u5806\u3002</p> <p>\u6bcf\u6b21\u53ea\u80fd\u5408\u5e76\u76f8\u90bb\u7684\u4e24\u5806\uff0c\u5408\u5e76\u7684\u4ee3\u4ef7\u4e3a\u8fd9\u4e24\u5806\u77f3\u5b50\u7684\u8d28\u91cf\u4e4b\u548c\uff0c\u5408\u5e76\u540e\u4e0e\u8fd9\u4e24\u5806\u77f3\u5b50\u76f8\u90bb\u7684\u77f3\u5b50\u5c06\u548c\u65b0\u5806\u76f8\u90bb\uff0c\u5408\u5e76\u65f6\u7531\u4e8e\u9009\u62e9\u7684\u987a\u5e8f\u4e0d\u540c\uff0c\u5408\u5e76\u7684\u603b\u4ee3\u4ef7\u4e5f\u4e0d\u76f8\u540c\u3002</p> <p>\u4f8b\u5982\u6709\u00a04\u00a0\u5806\u77f3\u5b50\u5206\u522b\u4e3a\u00a0<code>1 3 5 2</code>\uff0c \u6211\u4eec\u53ef\u4ee5\u5148\u5408\u5e76 1\u30012 \u5806\uff0c\u4ee3\u4ef7\u4e3a\u00a04\uff0c\u5f97\u5230\u00a0<code>4 5 2</code>\uff0c \u53c8\u5408\u5e76\u00a01\u30012\u00a0\u5806\uff0c\u4ee3\u4ef7\u4e3a\u00a09\uff0c\u5f97\u5230\u00a0<code>9 2</code>\u00a0\uff0c\u518d\u5408\u5e76\u5f97\u5230\u00a011\uff0c\u603b\u4ee3\u4ef7\u4e3a\u00a04+9+11=24\uff1b</p> <p>\u5982\u679c\u7b2c\u4e8c\u6b65\u662f\u5148\u5408\u5e76\u00a02\u30013\u00a0\u5806\uff0c\u5219\u4ee3\u4ef7\u4e3a\u00a07\uff0c\u5f97\u5230\u00a0<code>4 7</code>\uff0c\u6700\u540e\u4e00\u6b21\u5408\u5e76\u4ee3\u4ef7\u4e3a\u00a011\uff0c\u603b\u4ee3\u4ef7\u4e3a\u00a04+7+11=22\u3002</p> <p>\u95ee\u9898\u662f\uff1a\u627e\u51fa\u4e00\u79cd\u5408\u7406\u7684\u65b9\u6cd5\uff0c\u4f7f\u603b\u7684\u4ee3\u4ef7\u6700\u5c0f\uff0c\u8f93\u51fa\u6700\u5c0f\u4ee3\u4ef7\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/284%20%E7%9F%B3%E5%AD%90%E5%90%88%E5%B9%B6/#_2","title":"\u8f93\u5165\u683c\u5f0f","text":"<p>\u7b2c\u4e00\u884c\u4e00\u4e2a\u6570\u00a0N\u00a0\u8868\u793a\u77f3\u5b50\u7684\u5806\u6570\u00a0N\u3002</p> <p>\u7b2c\u4e8c\u884c\u00a0N\u00a0\u4e2a\u6570\uff0c\u8868\u793a\u6bcf\u5806\u77f3\u5b50\u7684\u8d28\u91cf(\u5747\u4e0d\u8d85\u8fc7\u00a01000)\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/284%20%E7%9F%B3%E5%AD%90%E5%90%88%E5%B9%B6/#_3","title":"\u8f93\u51fa\u683c\u5f0f","text":"<p>\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u6700\u5c0f\u4ee3\u4ef7\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/284%20%E7%9F%B3%E5%AD%90%E5%90%88%E5%B9%B6/#_4","title":"\u6570\u636e\u8303\u56f4","text":"<p>\\(1\u2264N\u2264300\\)</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/284%20%E7%9F%B3%E5%AD%90%E5%90%88%E5%B9%B6/#_5","title":"\u8f93\u5165\u6837\u4f8b\uff1a","text":"<pre><code>4\n1 3 5 2\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/284%20%E7%9F%B3%E5%AD%90%E5%90%88%E5%B9%B6/#_6","title":"\u8f93\u51fa\u6837\u4f8b\uff1a","text":"<pre><code>22\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/ACwing/284%20%E7%9F%B3%E5%AD%90%E5%90%88%E5%B9%B6/#code","title":"Code","text":"<pre><code>read(n);\nfor (int i = 1; i &lt;= n; i++)\n{\n    read(a[i]);\n}\nfor (int i = 1; i &lt;= n; i++)\n{\n    a[i] += a[i - 1];\n}\n// len \u5408\u5e76\u533a\u57df\u7684\u957f\u5ea6\n// i + (len - 1) = j\nfor (int len = 2; len &lt;= n; len++)\n{\n    for (int i = 1; i + len - 1 &lt;= n; i++)\n    {\n        int l = i;\n        int r = i + len - 1;\n        f[l][r] = 1e8;\n        for (int k = l; k &lt; r; k++)\n        {\n            // (f[l][k] + f[k+1][r]) + (a[r] - a[l - 1]) \u5408\u5e76\u7684\u6210\u672c\n            f[l][r] = min(f[l][r], f[l][k] + f[k + 1][r] + a[r] - a[l - 1]);\n        }\n    }\n}\ncout &lt;&lt; f[1][n] &lt;&lt; endl;\nreturn 0;\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/","title":"BFS #\u56fe\u8bba #Codeforces","text":"<p>Problem - 1307D - Codeforces Cow and Fields - \u6d1b\u8c37</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#cow-and-fields","title":"Cow and Fields","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#_1","title":"\u9898\u9762\u7ffb\u8bd1","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#_2","title":"\u9898\u610f\u7b80\u8ff0","text":"<p>\u7ed9\u5b9a\u4e00\u4e2a\u6709\\(n\\)\u4e2a\u8282\u70b9\\(m\\)\u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u4e00\u4e2a\u9876\u70b9\u96c6\\(S\\)\u3002</p> <p>\u4f60\u9700\u8981\u9009\u62e9\u4e24\u4e2a\u9876\u70b9\\(u,v(u\\ne v,u\\in S,v\\in S)\\)\u5e76\u8fde\u63a5\u8fd9\u4e24\u4e2a\u9876\u70b9\uff08\u5141\u8bb8\\(u,v\\)\u4e4b\u95f4\u5df2\u7ecf\u6709\u8fde\u8fb9\uff09\uff0c\u6c42\u8fde\u63a5\u540e\u4ece\u9876\u70b9\\(1\\)\u5230\u9876\u70b9\\(n\\)\u6700\u77ed\u8def\u7684\u6700\u5927\u503c\u3002</p> <p>\u6ce8\u610f\uff0c\u8be5\u64cd\u4f5c\u4ec5\u80fd\u8fdb\u884c\u4e00\u6b21\u3002</p> <p>\u4fdd\u8bc1\u7ed9\u5b9a\u7684\u56fe\u8054\u901a\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#_3","title":"\u8f93\u5165\u683c\u5f0f","text":"<p>\u7b2c\u4e00\u884c3\u4e2a\u6574\u6570\\(n,m,k\\) (\\(2 \\le n \\le 2 \\cdot 10^5\\),\\(n-1 \\le m \\le 2 \\cdot 10^5\\),\\(2 \\le k \\le n\\))\u200b\uff0c\u5206\u522b\u8868\u793a\u70b9\u6570\uff0c\u8fb9\u6570\u548c\u70b9\u96c6\u7684\u5927\u5c0f\u3002</p> <p>\u7b2c\u4e8c\u884c\\(k\\)\u4e2a\u6574\u6570\\(a_1, a_2, \\ldots, a_k\\)(\\(1 \\le a_i \\le n\\))\uff0c\u8868\u793a\u70b9\u96c6\u3002</p> <p>\u4e0b\u9762\\(m\\)\u884c\uff0c\u6bcf\u884c\u4e24\u4e2a\u6574\u6570\uff0c\u8868\u793a\u8fd9\u4e24\u4e2a\u6574\u6570\u4e4b\u95f4\u6709\u4e00\u6761\u8fb9\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#_4","title":"\u8f93\u51fa\u683c\u5f0f","text":"<p>\u4e00\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u6dfb\u52a0\u4e00\u6761\u8fb9\u4e4b\u540e\u4ece\u9876\u70b9\\(1\\)\u5230\u9876\u70b9\\(n\\)\u6700\u77ed\u8def\u7684\u6700\u5927\u503c</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#_5","title":"\u9898\u76ee\u63cf\u8ff0","text":"<p>Bessie is out grazing on the farm, which consists of $ n $ fields connected by $ m $ bidirectional roads. She is currently at field $ 1 $ , and will return to her home at field $ n $ at the end of the day.</p> <p>The Cowfederation of Barns has ordered Farmer John to install one extra bidirectional road. The farm has $ k $ special fields and he has decided to install the road between two different special fields. He may add the road between two special fields that already had a road directly connecting them.</p> <p>After the road is added, Bessie will return home on the shortest path from field $ 1 $ to field $ n $ . Since Bessie needs more exercise, Farmer John must maximize the length of this shortest path. Help him!</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#_6","title":"\u8f93\u5165\u683c\u5f0f","text":"<p>The first line contains integers $ n $ , $ m $ , and $ k $ ( $ 2 \\le n \\le 2 \\cdot 10^5 $ , $ n-1 \\le m \\le 2 \\cdot 10^5 $ , $ 2 \\le k \\le n $ ) \u2014 the number of fields on the farm, the number of roads, and the number of special fields.</p> <p>The second line contains $ k $ integers $ a_1, a_2, \\ldots, a_k $ ( $ 1 \\le a_i \\le n $ ) \u2014 the special fields. All $ a_i $ are distinct.</p> <p>The $ i $ -th of the following $ m $ lines contains integers $ x_i $ and $ y_i $ ( $ 1 \\le x_i, y_i \\le n $ , $ x_i \\ne y_i $ ), representing a bidirectional road between fields $ x_i $ and $ y_i $ .</p> <p>It is guaranteed that one can reach any field from every other field. It is also guaranteed that for any pair of fields there is at most one road connecting them.</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#_7","title":"\u8f93\u51fa\u683c\u5f0f","text":"<p>Output one integer, the maximum possible length of the shortest path from field $ 1 $ to $ n $ after Farmer John installs one road optimally.</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#1","title":"\u6837\u4f8b #1","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#1_1","title":"\u6837\u4f8b\u8f93\u5165 #1","text":"<pre><code>5 5 3\n1 3 5\n1 2\n2 3\n3 4\n3 5\n2 4\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#1_2","title":"\u6837\u4f8b\u8f93\u51fa #1","text":"<pre><code>3\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#2","title":"\u6837\u4f8b #2","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#2_1","title":"\u6837\u4f8b\u8f93\u5165 #2","text":"<pre><code>5 4 2\n2 4\n1 2\n2 3\n3 4\n4 5\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#2_2","title":"\u6837\u4f8b\u8f93\u51fa #2","text":"<pre><code>3\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#_8","title":"\u63d0\u793a","text":"<p>The graph for the first example is shown below. The special fields are denoted by red. It is optimal for Farmer John to add a road between fields $ 3 $ and $ 5 $ , and the resulting shortest path from $ 1 $ to $ 5 $ is length $ 3 $ .</p> <p>The graph for the second example is shown below. Farmer John must add a road between fields $ 2 $ and $ 4 $ , and the resulting shortest path from $ 1 $ to $ 5 $ is length $ 3 $ .</p> <p></p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/Codeforces/1307D/#_9","title":"\u9898\u89e3","text":"<pre><code>// CF1307D\n#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n#include &lt;vector&gt;\n#include &lt;queue&gt;\n#include &lt;map&gt;\n#include &lt;cmath&gt;\n#include &lt;set&gt;\n\nusing namespace std;\ntypedef pair&lt;int, int&gt; PII;\ntypedef long long LL;\n\nconst int INF = 1e9;\nconst int N = 2e5 + 10;\n\nint n, m, k;\nint a[N];\nint dis1[N];\nint dis2[N];\n\nvector&lt;int&gt; g[N];\n\nqueue&lt;int&gt; q;\n\nbool cmp(int x, int y)\n{\n    return dis1[x] &lt; dis1[y];\n}\n\nint main()\n{\n    ios_base::sync_with_stdio(false);\n    cin.tie(0);\n    cout.tie(0);\n\n    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;\n    for (int i = 1; i &lt;= k; i++)\n    {\n        cin &gt;&gt; a[i];\n    }\n    for (int i = 1; i &lt;= m; i++)\n    {\n        int u, v;\n        cin &gt;&gt; u &gt;&gt; v;\n        g[u].push_back(v);\n        g[v].push_back(u);\n    }\n    memset(dis1, -1, sizeof(dis1));\n    dis1[1] = 0;\n    q.push(1);\n    while (!q.empty())\n    {\n        int t = q.front();\n        q.pop();\n        for (int i = 0; i &lt; g[t].size(); i++)\n        {\n            if (dis1[g[t][i]] == -1)\n            {\n                dis1[g[t][i]] = dis1[t] + 1;\n                q.push(g[t][i]);\n            }\n        }\n    }\n    memset(dis2, -1, sizeof(dis2));\n    dis2[n] = 0;\n    q.push(n);\n    while (!q.empty())\n    {\n        int t = q.front();\n        q.pop();\n        for (int i = 0; i &lt; g[t].size(); i++)\n        {\n            if (dis2[g[t][i]] == -1)\n            {\n                dis2[g[t][i]] = dis2[t] + 1;\n                q.push(g[t][i]);\n            }\n        }\n    }\n    sort(a + 1, a + k + 1, cmp);\n    int ans = 0;\n    for (int i = 1; i &lt;= k; i++)\n    {\n        ans = max(ans, min(dis1[n], min(dis1[a[i]] + dis2[a[i + 1]], dis1[a[i + 1]] + dis2[a[i]]) + 1));\n    }\n    cout &lt;&lt; ans &lt;&lt; endl;\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/","title":"P1119 \u707e\u540e\u91cd\u5efa","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#_1","title":"\u56fe\u8bba #\u6700\u77ed\u8def","text":"<p>P1119 \u707e\u540e\u91cd\u5efa</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#_2","title":"\u9898\u76ee\u80cc\u666f","text":"<p>B \u5730\u533a\u5728\u5730\u9707\u8fc7\u540e\uff0c\u6240\u6709\u6751\u5e84\u90fd\u9020\u6210\u4e86\u4e00\u5b9a\u7684\u635f\u6bc1\uff0c\u800c\u8fd9\u573a\u5730\u9707\u5374\u6ca1\u5bf9\u516c\u8def\u9020\u6210\u4ec0\u4e48\u5f71\u54cd\u3002\u4f46\u662f\u5728\u6751\u5e84\u91cd\u5efa\u597d\u4e4b\u524d\uff0c\u6240\u6709\u4e0e\u672a\u91cd\u5efa\u5b8c\u6210\u7684\u6751\u5e84\u7684\u516c\u8def\u5747\u65e0\u6cd5\u901a\u8f66\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u53ea\u6709\u8fde\u63a5\u7740\u4e24\u4e2a\u91cd\u5efa\u5b8c\u6210\u7684\u6751\u5e84\u7684\u516c\u8def\u624d\u80fd\u901a\u8f66\uff0c\u53ea\u80fd\u5230\u8fbe\u91cd\u5efa\u5b8c\u6210\u7684\u6751\u5e84\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#_3","title":"\u9898\u76ee\u63cf\u8ff0","text":"<p>\u7ed9\u51fa B \u5730\u533a\u7684\u6751\u5e84\u6570 \\(N\\)\uff0c\u6751\u5e84\u7f16\u53f7\u4ece \\(0\\) \u5230 \\(N-1\\)\uff0c\u548c\u6240\u6709 \\(M\\) \u6761\u516c\u8def\u7684\u957f\u5ea6\uff0c\u516c\u8def\u662f\u53cc\u5411\u7684\u3002\u5e76\u7ed9\u51fa\u7b2c \\(i\\) \u4e2a\u6751\u5e84\u91cd\u5efa\u5b8c\u6210\u7684\u65f6\u95f4 \\(t_i\\)\uff0c\u4f60\u53ef\u4ee5\u8ba4\u4e3a\u662f\u540c\u65f6\u5f00\u59cb\u91cd\u5efa\u5e76\u5728\u7b2c \\(t_i\\) \u5929\u91cd\u5efa\u5b8c\u6210\uff0c\u5e76\u4e14\u5728\u5f53\u5929\u5373\u53ef\u901a\u8f66\u3002\u82e5 \\(t_i\\) \u4e3a \\(0\\) \u5219\u8bf4\u660e\u5730\u9707\u672a\u5bf9\u6b64\u5730\u533a\u9020\u6210\u635f\u574f\uff0c\u4e00\u5f00\u59cb\u5c31\u53ef\u4ee5\u901a\u8f66\u3002\u4e4b\u540e\u6709 \\(Q\\) \u4e2a\u8be2\u95ee \\((x,y,t)\\)\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u4f60\u8981\u56de\u7b54\u5728\u7b2c \\(t\\) \u5929\uff0c\u4ece\u6751\u5e84 \\(x\\) \u5230\u6751\u5e84 \\(y\\) \u7684\u6700\u77ed\u8def\u5f84\u957f\u5ea6\u4e3a\u591a\u5c11\u3002\u5982\u679c\u65e0\u6cd5\u627e\u5230\u4ece \\(x\\) \u6751\u5e84\u5230 \\(y\\) \u6751\u5e84\u7684\u8def\u5f84\uff0c\u7ecf\u8fc7\u82e5\u5e72\u4e2a\u5df2\u91cd\u5efa\u5b8c\u6210\u7684\u6751\u5e84\uff0c\u6216\u8005\u6751\u5e84 \\(x\\) \u6216\u6751\u5e84 \\(y\\) \u5728\u7b2c \\(t\\) \u5929\u4ecd\u672a\u91cd\u5efa\u5b8c\u6210\uff0c\u5219\u9700\u8981\u8fd4\u56de <code>-1</code>\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#_4","title":"\u8f93\u5165\u683c\u5f0f","text":"<p>\u7b2c\u4e00\u884c\u5305\u542b\u4e24\u4e2a\u6b63\u6574\u6570\\(N,M\\)\uff0c\u8868\u793a\u4e86\u6751\u5e84\u7684\u6570\u76ee\u4e0e\u516c\u8def\u7684\u6570\u91cf\u3002</p> <p>\u7b2c\u4e8c\u884c\u5305\u542b\\(N\\)\u4e2a\u975e\u8d1f\u6574\u6570\\(t_0, t_1,\u2026, t_{N-1}\\)\uff0c\u8868\u793a\u4e86\u6bcf\u4e2a\u6751\u5e84\u91cd\u5efa\u5b8c\u6210\u7684\u65f6\u95f4\uff0c\u6570\u636e\u4fdd\u8bc1\u4e86\\(t_0 \u2264 t_1 \u2264 \u2026 \u2264 t_{N-1}\\)\u3002</p> <p>\u63a5\u4e0b\u6765\\(M\\)\u884c\uff0c\u6bcf\u884c\\(3\\)\u4e2a\u975e\u8d1f\u6574\u6570\\(i, j, w\\)\uff0c\\(w\\)\u4e3a\u4e0d\u8d85\u8fc7\\(10000\\)\u7684\u6b63\u6574\u6570\uff0c\u8868\u793a\u4e86\u6709\u4e00\u6761\u8fde\u63a5\u6751\u5e84\\(i\\)\u4e0e\u6751\u5e84\\(j\\)\u7684\u9053\u8def\uff0c\u957f\u5ea6\u4e3a\\(w\\)\uff0c\u4fdd\u8bc1\\(i\u2260j\\)\uff0c\u4e14\u5bf9\u4e8e\u4efb\u610f\u4e00\u5bf9\u6751\u5e84\u53ea\u4f1a\u5b58\u5728\u4e00\u6761\u9053\u8def\u3002</p> <p>\u63a5\u4e0b\u6765\u4e00\u884c\u4e5f\u5c31\u662f\\(M+3\\)\u884c\u5305\u542b\u4e00\u4e2a\u6b63\u6574\u6570\\(Q\\)\uff0c\u8868\u793a\\(Q\\)\u4e2a\u8be2\u95ee\u3002</p> <p>\u63a5\u4e0b\u6765\\(Q\\)\u884c\uff0c\u6bcf\u884c\\(3\\)\u4e2a\u975e\u8d1f\u6574\u6570\\(x, y, t\\)\uff0c\u8be2\u95ee\u5728\u7b2c\\(t\\)\u5929\uff0c\u4ece\u6751\u5e84\\(x\\)\u5230\u6751\u5e84\\(y\\)\u7684\u6700\u77ed\u8def\u5f84\u957f\u5ea6\u4e3a\u591a\u5c11\uff0c\u6570\u636e\u4fdd\u8bc1\u4e86\\(t\\)\u662f\u4e0d\u4e0b\u964d\u7684\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#_5","title":"\u8f93\u51fa\u683c\u5f0f","text":"<p>\u5171\\(Q\\)\u884c\uff0c\u5bf9\u6bcf\u4e00\u4e2a\u8be2\u95ee\\((x, y, t)\\)\u8f93\u51fa\u5bf9\u5e94\u7684\u7b54\u6848\uff0c\u5373\u5728\u7b2c\\(t\\)\u5929\uff0c\u4ece\u6751\u5e84\\(x\\)\u5230\u6751\u5e84\\(y\\)\u7684\u6700\u77ed\u8def\u5f84\u957f\u5ea6\u4e3a\u591a\u5c11\u3002\u5982\u679c\u5728\u7b2ct\u5929\u65e0\u6cd5\u627e\u5230\u4ece\\(x\\)\u6751\u5e84\u5230\\(y\\)\u6751\u5e84\u7684\u8def\u5f84\uff0c\u7ecf\u8fc7\u82e5\u5e72\u4e2a\u5df2\u91cd\u5efa\u5b8c\u6210\u7684\u6751\u5e84\uff0c\u6216\u8005\u6751\u5e84x\u6216\u6751\u5e84\\(y\\)\u5728\u7b2c\\(t\\)\u5929\u4ecd\u672a\u4fee\u590d\u5b8c\u6210\uff0c\u5219\u8f93\u51fa\\(-1\\)\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#1","title":"\u6837\u4f8b #1","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#1_1","title":"\u6837\u4f8b\u8f93\u5165 #1","text":"<pre><code>4 5\n1 2 3 4\n0 2 1\n2 3 1\n3 1 2\n2 1 4\n0 3 5\n4\n2 0 2\n0 1 2\n0 1 3\n0 1 4\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#1_2","title":"\u6837\u4f8b\u8f93\u51fa #1","text":"<pre><code>-1\n-1\n5\n4\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#_6","title":"\u63d0\u793a","text":"<p>\u5bf9\u4e8e\\(30\\%\\)\u7684\u6570\u636e\uff0c\u6709\\(N\u226450\\)\uff1b</p> <p>\u5bf9\u4e8e\\(30\\%\\)\u7684\u6570\u636e\uff0c\u6709\\(t_i= 0\\)\uff0c\u5176\u4e2d\u6709\\(20\\%\\)\u7684\u6570\u636e\u6709\\(t_i = 0\\)\u4e14\\(N&gt;50\\)\uff1b</p> <p>\u5bf9\u4e8e\\(50\\%\\)\u7684\u6570\u636e\uff0c\u6709\\(Q\u2264100\\)\uff1b</p> <p>\u5bf9\u4e8e\\(100\\%\\)\u7684\u6570\u636e\uff0c\u6709\\(N\u2264200\\)\uff0c\\(M\u2264N \\times (N-1)/2\\)\uff0c\\(Q\u226450000\\)\uff0c\u6240\u6709\u8f93\u5165\u6570\u636e\u6d89\u53ca\u6574\u6570\u5747\u4e0d\u8d85\u8fc7\\(100000\\)\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P1119%20%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/#code","title":"Code","text":"<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;string&gt;\n#include &lt;cmath&gt;\n#include &lt;cstring&gt;\n#include &lt;vector&gt;\n#include &lt;queue&gt;\n#include &lt;map&gt;\n#include &lt;cmath&gt;\n#include &lt;set&gt;\n#include &lt;stack&gt;\n\nusing namespace std;\ntypedef pair&lt;int, int&gt; PII;\ntypedef long long LL;\n\nconst int INF = 0x3f3f3f3f;\nconst int N = 1e6 + 10;\nconst int K = 1e3 + 10;\n\nint n, m;\nint ti[N];\n\nLL g[K][K];\nint x, y, t;\nint p;\n\nint floyd()\n{\n    while (ti[p] &lt;= t)\n    {\n        int k = p;\n        p++;\n        for (int i = 0; i &lt; n; i++)\n        {\n            for (int j = 0; j &lt; n; j++)\n            {\n                if (g[i][k] != INF &amp;&amp; g[k][j] != INF)\n                {\n                    g[i][j] = min(g[i][j], g[i][k] + g[k][j]);\n                }\n            }\n        }\n    }\n    if (ti[x] &gt; t || ti[y] &gt; t || g[x][y] &gt;= INF)\n    {\n        return -1;\n    }\n    else\n    {\n        return g[x][y];\n    }\n}\n\nint main()\n{\n    cin &gt;&gt; n &gt;&gt; m;\n    memset(g, INF, sizeof(g));\n    for (int i = 0; i &lt; n; i++)\n    {\n        cin &gt;&gt; ti[i];\n    }\n    for (int i = 0; i &lt; m; i++)\n    {\n        int a, b, w;\n        cin &gt;&gt; a &gt;&gt; b &gt;&gt; w;\n        g[a][b] = g[b][a] = w;\n    }\n    int q;\n    cin &gt;&gt; q;\n    ti[n] = INF;\n    for (int i = 0; i &lt; q; i++)\n    {\n        cin &gt;&gt; x &gt;&gt; y &gt;&gt; t;\n        cout &lt;&lt; floyd() &lt;&lt; endl;\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/","title":"\u4e8c\u53c9\u6811 #\u4e8c\u53c9\u641c\u7d22\u6811","text":"<p>P5076 \u3010\u6df1\u57fa16.\u4f8b7\u3011\u666e\u901a\u4e8c\u53c9\u6811\uff08\u7b80\u5316\u7248\uff09 - \u6d1b\u8c37</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/#167","title":"\u3010\u6df1\u57fa16.\u4f8b7\u3011\u666e\u901a\u4e8c\u53c9\u6811\uff08\u7b80\u5316\u7248\uff09","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/#_2","title":"\u9898\u76ee\u63cf\u8ff0","text":"<p>\u60a8\u9700\u8981\u5199\u4e00\u79cd\u6570\u636e\u7ed3\u6784\uff0c\u6765\u7ef4\u62a4\u4e00\u4e9b\u6570\uff08 \u90fd\u662f \\(10^9\\) \u4ee5\u5185\u7684\u6570\u5b57\uff09\u7684\u96c6\u5408\uff0c\u6700\u5f00\u59cb\u65f6\u96c6\u5408\u662f\u7a7a\u7684\u3002\u5176\u4e2d\u9700\u8981\u63d0\u4f9b\u4ee5\u4e0b\u64cd\u4f5c\uff0c\u64cd\u4f5c\u6b21\u6570 \\(q\\) \u4e0d\u8d85\u8fc7 \\(10^4\\)\uff1a</p> <ol> <li>\u67e5\u8be2 \\(x\\) \u6570\u7684\u6392\u540d\uff08\u6392\u540d\u5b9a\u4e49\u4e3a\u6bd4\u5f53\u524d\u6570\u5c0f\u7684\u6570\u7684\u4e2a\u6570 \\(+1\\)\u3002\u82e5\u6709\u591a\u4e2a\u76f8\u540c\u7684\u6570\uff0c\u5e94\u8f93\u51fa\u6700\u5c0f\u7684\u6392\u540d\uff09\u3002</li> <li>\u67e5\u8be2\u6392\u540d\u4e3a \\(x\\) \u7684\u6570\u3002</li> <li>\u6c42 \\(x\\) \u7684\u524d\u9a71\uff08\u524d\u9a71\u5b9a\u4e49\u4e3a\u5c0f\u4e8e \\(x\\)\uff0c\u4e14\u6700\u5927\u7684\u6570\uff09\u3002\u82e5\u672a\u627e\u5230\u5219\u8f93\u51fa \\(-2147483647\\)\u3002</li> <li>\u6c42 \\(x\\) \u7684\u540e\u7ee7\uff08\u540e\u7ee7\u5b9a\u4e49\u4e3a\u5927\u4e8e \\(x\\)\uff0c\u4e14\u6700\u5c0f\u7684\u6570\uff09\u3002\u82e5\u672a\u627e\u5230\u5219\u8f93\u51fa \\(2147483647\\)\u3002</li> <li>\u63d2\u5165\u4e00\u4e2a\u6570 \\(x\\)\u3002</li> </ol>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/#_3","title":"\u8f93\u5165\u683c\u5f0f","text":"<p>\u7b2c\u4e00\u884c\u662f\u4e00\u4e2a\u6574\u6570 \\(q\\)\uff0c\u8868\u793a\u64cd\u4f5c\u6b21\u6570\u3002</p> <p>\u63a5\u4e0b\u6765 \\(q\\) \u884c\uff0c\u6bcf\u884c\u4e24\u4e2a\u6574\u6570 \\(op,x\\)\uff0c\u5206\u522b\u8868\u793a\u64cd\u4f5c\u5e8f\u53f7\u4ee5\u53ca\u64cd\u4f5c\u7684\u53c2\u6570 \\(x\\)\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/#_4","title":"\u8f93\u51fa\u683c\u5f0f","text":"<p>\u8f93\u51fa\u6709\u82e5\u5e72\u884c\u3002\u5bf9\u4e8e\u64cd\u4f5c \\(1,2,3,4\\)\uff0c\u8f93\u51fa\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u8be5\u64cd\u4f5c\u7684\u7ed3\u679c\u3002</p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/#1","title":"\u6837\u4f8b #1","text":""},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/#1_1","title":"\u6837\u4f8b\u8f93\u5165 #1","text":"<pre><code>7\n5 1\n5 3\n5 5\n1 3\n2 2\n3 3\n4 3\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/#1_2","title":"\u6837\u4f8b\u8f93\u51fa #1","text":"<pre><code>2\n3\n1\n5\n</code></pre>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/#_5","title":"\u65b9\u6cd5\u4e00\uff1a\u4e8c\u53c9\u6811","text":"<p>TODO: </p>"},{"location":"Algorithm/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%F0%9F%92%AD%F0%9F%92%A1%F0%9F%8E%88/%E6%B4%9B%E8%B0%B7/P5076%20%E6%99%AE%E9%80%9A%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89/#multiset","title":"\u65b9\u6cd5\u4e8c\uff1amultiset","text":"<pre><code>#include &lt;iostream&gt;\n#include &lt;algorithm&gt;\n#include &lt;set&gt;\nusing namespace std;\n\nmultiset&lt;int&gt; q;\nint n, order;\n\nint main()\n{\n    q.insert(-2147483647);\n    q.insert(2147483647);\n\n    cin &gt;&gt; n;\n    while (n--)\n    {\n        int op, x;\n        cin &gt;&gt; op &gt;&gt; x;\n        if (op == 1)\n        {\n            auto it = q.lower_bound(x);\n\n            order = 0;\n\n            for (auto i = q.begin(); i != it; i++, order++)\n                ;\n            cout &lt;&lt; order &lt;&lt; endl;\n        }\n        else if (op == 2)\n        {\n            order = -1;\n            for (int i : q)\n                if (++order == x)\n                    cout &lt;&lt; i &lt;&lt; endl;\n        }\n        else if (op == 3)\n        {\n            auto it = q.lower_bound(x);\n\n            cout &lt;&lt; *--it &lt;&lt; endl;\n        }\n        else if (op == 4)\n        {\n            cout &lt;&lt; *q.upper_bound(x) &lt;&lt; endl;\n        }\n        else\n        {\n            q.insert(x);\n        }\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"Misc/RPC%E5%AD%A6%E4%B9%A0/","title":"RPC\u5b66\u4e60","text":"<p>RPC(Remote procedure call)</p> <p>\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528</p> <p>Remote procedure call - Wikipedia</p>"},{"location":"Misc/Record/","title":"Record","text":""},{"location":"Misc/Record/#20239","title":"2023.9","text":""},{"location":"Misc/Record/#915","title":"9.15","text":"<ol> <li>pandoc</li> <li>rust 3/4</li> <li>java spring</li> </ol>"},{"location":"Misc/Record/#202310","title":"2023.10","text":""},{"location":"Misc/Record/#106","title":"10.6","text":"<ol> <li>java springboot</li> <li>\u6df1\u5ea6\u5b66\u4e60.\u5377\u79ef\u795e\u7ecf\u7f51\u7edc</li> <li>rust</li> </ol>"},{"location":"Misc/Record/#1013","title":"10.13","text":"<ol> <li>Rustlings 100/100 \u8017\u65f62\u5929</li> <li>C++ \u6a21\u7248\u3001\u5e76\u53d1\u7f16\u7a0b -- \u57fa\u7840</li> <li>CMU15445 project 0</li> <li>CMake\u5165\u95e8</li> </ol>"},{"location":"Misc/Record/#1020","title":"10.20","text":"<ol> <li>A Simple Database 6/14</li> <li>nginx \u5165\u95e8</li> </ol>"},{"location":"Misc/Record/#1027","title":"10.27","text":"<ol> <li>A Simple Database 8/14</li> <li>rCore\u8fdb\u884c\u4e2d</li> </ol>"},{"location":"Misc/Record/#week-5","title":"Week 5","text":""},{"location":"Misc/Record/#1028","title":"10.28","text":"<ul> <li>Linux\u7f51\u7edc\u7f16\u7a0b\u521d\u6b65(socket bind) Linux\u7f51\u7edc\u7f16\u7a0b</li> <li>rCore Lab1</li> <li>Kaggle Titanic competitions(Kaggle\u57fa\u672c\u4f7f\u7528)</li> </ul>"},{"location":"Misc/Record/#1029","title":"10.29","text":"<ul> <li>simple database 9/14</li> <li>Linux-UNIX \u7cfb\u7edf\u7f16\u7a0b\u624b\u518c\uff08\u4e0a\uff09 63/602</li> </ul>"},{"location":"Misc/Record/#1030","title":"10.30","text":"<ul> <li>None</li> </ul>"},{"location":"Misc/Record/#1031","title":"10.31","text":"<ul> <li>TCP-IP\u7f51\u7edc\u7f16\u7a0b</li> </ul>"},{"location":"Misc/Record/#111","title":"11.1","text":"<ul> <li>TCP-IP\u7f51\u7edc\u7f16\u7a0b</li> </ul>"},{"location":"Misc/Record/#112","title":"11.2","text":""},{"location":"Misc/Record/#202311","title":"2023.11","text":""},{"location":"Misc/Record/#week-6","title":"Week 6","text":"<p>\u591a\u7ebf\u7a0bC++\u670d\u52a1\u5668\uff08100\u54cd\u5e94/s\uff09</p>"},{"location":"Misc/Todo%20List/","title":"TODO LIST","text":"<ul> <li> \u5fae\u5206\u7b97\u5b50\u6cd5</li> </ul> <p>https://fengmuzi2003.gitbook.io/csapp3e/#you-qing-zan-zhu</p>"},{"location":"Misc/mermaid/","title":"mermaid","text":"<pre><code>graph TD;\n    subgraph Internet\n        A(\u5ba2\u6237\u7aef) --&gt;|\u8bf7\u6c42| B(\u672c\u5730ISP);\n        B --&gt;|BGP| C(\u4e3b\u5e72ISP);\n        C --&gt;|BGP| D(\u8fb9\u7f18\u8def\u7531\u5668);\n        D --&gt;|\u8def\u7531| E(\u76ee\u6807\u670d\u52a1\u5668);\n    end\n\n    subgraph \u534f\u8bae\u4e0e\u6280\u672f\n        BGP((BGP));\n        TCP((TCP));\n        HTTP((HTTP));\n        DNS((DNS));\n        EGP((EGP));\n    end\n\n    A --- HTTP;\n    B --- TCP;\n    C --- TCP;\n    D --- TCP;\n    E --- HTTP;\n    BGP --- C;\n    EGP --- D;\n    DNS --&gt;|\u67e5\u8be2| D;\n\n    style A fill:#FFCC00,stroke:#333,stroke-width:2px;\n    style B fill:#CCFF99,stroke:#333,stroke-width:2px;\n    style C fill:#66CCFF,stroke:#333,stroke-width:2px;\n    style D fill:#CC99FF,stroke:#333,stroke-width:2px;\n    style E fill:#FFCC00,stroke:#333,stroke-width:2px;\n    style TCP fill:#00CC99,stroke:#333,stroke-width:2px;\n    style HTTP fill:#FF6666,stroke:#333,stroke-width:2px;\n    style DNS fill:#66FFFF,stroke:#333,stroke-width:2px;\n    style BGP fill:#FF9933,stroke:#333,stroke-width:2px;\n    style EGP fill:#9933FF,stroke:#333,stroke-width:2px;\n</code></pre> <pre><code>graph LR;\n    subgraph Internet\n        A(\u5ba2\u6237\u7aef) --&gt;|HTTP\u8bf7\u6c42| B(\u5bb6\u5ead\u8def\u7531\u5668);\n        B --&gt;|HTTP\u8bf7\u6c42| C(ISP\u7f51\u7edc);\n        C --&gt;|BGP| D(\u8fb9\u7f18\u8def\u7531\u5668);\n        D --&gt;|\u8def\u7531\u534f\u8bae| E(\u76ee\u6807\u7f51\u7edc);\n        E --&gt;|HTTP\u54cd\u5e94| D;\n        D --&gt;|HTTP\u54cd\u5e94| C;\n        C --&gt;|HTTP\u54cd\u5e94| B;\n        B --&gt;|HTTP\u54cd\u5e94| A;\n    end\n\n    subgraph \u534f\u8bae\u4e0e\u6280\u672f\n        BGP((BGP));\n        TCP((TCP));\n        HTTP((HTTP));\n        DNS((DNS));\n        EGP((EGP));\n    end\n\n    A --- HTTP;\n    B --- TCP;\n    C --- TCP;\n    D --- TCP;\n    E --- HTTP;\n    BGP --- C;\n    EGP --- D;\n    DNS --&gt;|\u67e5\u8be2| D;\n\n    style A fill:#FFCC00,stroke:#333,stroke-width:2px;\n    style B fill:#CCFF99,stroke:#333,stroke-width:2px;\n    style C fill:#66CCFF,stroke:#333,stroke-width:2px;\n    style D fill:#CC99FF,stroke:#333,stroke-width:2px;\n    style E fill:#FFCC00,stroke:#333,stroke-width:2px;\n    style TCP fill:#00CC99,stroke:#333,stroke-width:2px;\n    style HTTP fill:#FF6666,stroke:#333,stroke-width:2px;\n    style DNS fill:#66FFFF,stroke:#333,stroke-width:2px;\n    style BGP fill:#FF9933,stroke:#333,stroke-width:2px;\n    style EGP fill:#9933FF,stroke:#333,stroke-width:2px;\n</code></pre>"},{"location":"Misc/obsidian%20%E5%A5%BD%E7%94%A8%E7%9A%84%E6%8F%92%E4%BB%B6/","title":"Obsidian \u597d\u7528\u7684\u63d2\u4ef6","text":"<p>Auto link title</p> <p>editing toolbar</p> <p>Hover editor</p>"},{"location":"Misc/%E5%90%84%E7%A7%8D%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/","title":"\u5404\u79cd\u914d\u7f6e\u6587\u4ef6","text":""},{"location":"Misc/%E5%90%84%E7%A7%8D%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/#ideavim","title":"IdeaVim","text":"<pre><code>\" \u5feb\u901f\u8fdb\u5165normal\u6a21\u5f0f\ninoremap jj &lt;Esc&gt;\ninoremap jk &lt;Esc&gt;\n\n\n\n\" \u5173\u95ed\u94c3\u58f0\nset visualbell \n\n\" \u76f8\u5bf9\u884c\u6570\nset relativenumber\n</code></pre>"},{"location":"Misc/%E5%90%84%E7%A7%8D%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/#idea","title":"IDEA\u5feb\u6377\u952e","text":"<p>Linux-KDE\u73af\u5883\u4e0b</p> <p><code>alt + shift + l</code> \u683c\u5f0f\u5316\u6587\u4ef6</p>"},{"location":"Misc/%E5%B0%8F%E8%AE%B0/","title":"\u5c0f\u8bb0","text":"<ul> <li> <p>SSH\u7aef\u53e3\u6620\u5c04\uff1a     ssh -L \u672c\u673a\u7aef\u53e3\u53f7:127.0.0.1:\u670d\u52a1\u5668\u7aef\u53e3\u53f7 \u670d\u52a1\u5668\u7528\u6237\u540d@\u670d\u52a1\u5668\u5730\u5740</p> </li> <li> <p>conda\u4e0d\u8981\u7528\u56fd\u5185\u955c\u50cf\u6e90\uff01\uff01\uff01     \u5b89\u88c5\u7684pytorch\u90fd\u662fcpu\u7248\u7684\ud83d\ude2d\ud83d\ude2d\ud83d\ude2d</p> </li> <li> <p>https://cbovar.github.io/ConvNetDraw/      \u53ef\u89c6\u5316\u7f51\u7ad9</p> </li> <li>opencv \u8bfb\u53d6\u3001\u663e\u793a\u56fe\u7247OpenCV | imshow()\u5f39\u51fa\u7a97\u53e3\u56fe\u7247\u672a\u54cd\u5e94\uff1b\u65e0\u6cd5\u663e\u793a\u56fe\u7247</li> <li>PIL \u6253\u5f00\u56fe\u7247, <code>\u53d8\u91cf\u540d.show()</code>\u3002\u5728notebook\u4e2d\u663e\u793a, <code>disply(\u53d8\u91cf\u540d)</code></li> <li>Linux\u6743\u9650\uff1asudo chmod -R 777     \u4e00\u6587\u5e26\u4f60\u5f7b\u5e95\u641e\u61c2Linux \u6587\u4ef6\u6743\u9650\u7ba1\u7406 linux\u67e5\u770b\u548c\u4fee\u6539\u6587\u4ef6\u4e0e\u76ee\u5f55\u7684\u6743\u9650</li> <li>command not found-wsl:ubuntu install \u5b89\u88c5\u6210\u529f\u4f46\u662f\u6267\u884c\u5931\u8d25\u95ee\u9898</li> <li>\u4f7f\u7528 WSL \u8bbf\u95ee\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f | Microsoft Learn</li> <li> <p>Linux - \u914d\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u51e0\u79cd\u65b9\u5f0f</p> </li> <li> <p>wsl mysql\u914d\u7f6e\u95ee\u9898</p> <ul> <li>windows subsystem for linux - WSL: Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) - Stack Overflow</li> <li>lamp - ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/run/mysqld/mysqld.sock' (2) - Stack Overflow</li> <li>Setting up WSL 2 for Web Development - xzhan's blog</li> </ul> </li> <li> <p>Linux\u5378\u8f7dMySQL Ubuntu\u5b8c\u5168\u5378\u8f7d\u4e0e\u5b89\u88c5Mysql</p> </li> <li>proxyconnect \u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c \u95ee\u9898\uff1aproxyconnect \u4e0d\u80fd\u6b63\u5e38\u5de5\u4f5c \u00b7 Issue #71 \u00b7 goproxy/goproxy.cn (github.com)</li> <li>jwt-go \u7684\u4f7f\u7528godevelop/\u4f7f\u7528jwt-go\u7684\u65f6\u5019\u62a5\u9519key-is-of-invalid-type.md at master \u00b7 voyager-go/godevelop (github.com)</li> </ul>"},{"location":"Misc/%E5%B0%8F%E8%AE%B0/#python","title":"\u50bb\u903cPython","text":"<ul> <li> <p>\u5982\u679c\u7528conda\u5b89\u88c5pytorch\u6ca1\u6709gpu\u7248 \u6539\u7528pip\uff01</p> </li> <li> <p>opencv \u5728PyCharm\u4e0b\u6ca1\u6709\u63d0\u793a\uff1a \u5728pychram\u91cc\u52a0\u89e3\u91ca\u5668\u76ee\u5f55 or \u5728site-packages\u76ee\u5f55\u5efa\u7acb.so\u6587\u4ef6\u94fe\u63a5 https://github.com/opencv/opencv/issues/20997  \u8be5.so\u6587\u4ef6\u53ef\u80fd\u4e0d\u76f4\u63a5\u5728cv2\u6587\u4ef6\u5939\uff0c\u800c\u662f\u5728cv2\u7684\u5b50\u6587\u4ef6\u5939\u91cc,\u5982\u4e0a\u56fe\uff1a\u5728<code>cv2/python-3.10/</code></p> </li> </ul>"},{"location":"Misc/%E8%80%83%E7%A0%94%E9%99%A2%E6%A0%A1/","title":"\u8003\u7814\u9662\u6821\u8bb0\u5f55","text":"<p>\u53c2\u8003\u6570\u636e\uff1a CSRankings: Computer Science Rankings</p>"},{"location":"System/System/","title":"System","text":"<p>How Program Run, Big Overview</p> <p>The memory layout of C program \u2b07  C\u7a0b\u5e8f\u7684\u5185\u5b58\u5e03\u5c40 | FlyingMcdull (wongxingjun.github.io)</p> <p> A typical C\u2019s process memory layout on an x86. The C/C++ typical process image illustration from the memory layout perspective</p> <p>C\u7a0b\u5e8f\u5185\u5b58\u5e03\u5c40 - \u817e\u8baf\u4e91\u5f00\u53d1\u8005\u793e\u533a-\u817e\u8baf\u4e91 (tencent.com)</p>"},{"location":"System/System/#stack","title":"\u6808 stack","text":"<p>\u51fd\u6570\u8c03\u7528 \u4e0e \u6808\u7684\u7ed3\u6784 </p> <p>\u52a8\u6001</p> <p>\u81ea\u52a8\u7ba1\u7406\u76f8\u5173\u5185\u5b58</p> <p>\u4fbf\u4e8e\u5904\u7406\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4ea7\u751f\u7684\u65b0\u7684\u6570\u636e</p>"},{"location":"System/System/#heap","title":"\u5806 heap","text":"<p>\u9759\u6001</p> <p>\u865a\u62df\u5730\u5740--&gt;\u8f6c\u6362\u6210\u7269\u7406\u5730\u5740--&gt;\u8bbf\u95ee\u7269\u7406\u5185\u5b58</p> <p></p>"},{"location":"System/%E5%B9%B6%E5%8F%91/","title":"\u5e76\u53d1","text":"<p>\u591a\u8fdb\u7a0b\u5e76\u53d1\uff1a \u901a\u5e38\u901a\u8fc7\u8fdb\u7a0b\u95f4\u5e38\u89c4\u7684\u901a\u4fe1\u6e20\u9053\u4f20\u9012\u8baf\u606f(\u4fe1\u53f7\u3001\u5957\u63a5\u5b57\u3001\u6587\u4ef6\u3001\u7ba1\u9053\u7b49\u7b49)\u3002</p> <p>\u591a\u8fdb\u7a0b\u5e76\u53d1\u7684\u7f3a\u70b9\uff1a - \u8fdb\u7a0b\u95f4\u7684\u901a\u4fe1\u8bbe\u7f6e\u590d\u6742\uff0c\u4ea6\u6216\u662f\u901a\u8baf\u901f\u5ea6\u6162     - \u56e0\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5728\u8fdb\u7a0b\u95f4\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u4fdd\u62a4\u63aa\u65bd\uff0c\u4ee5\u907f\u514d\u4e00\u4e2a\u8fdb\u7a0b\u53bb\u4fee\u6539\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u7684\u6570\u636e\u3002 - \u8fd0\u884c\u591a\u4e2a\u8fdb\u7a0b\u6240\u9700\u7684\u56fa\u5b9a\u5f00\u9500\uff1a\u9700\u8981\u65f6\u95f4\u542f\u52a8\u8fdb\u7a0b\uff0c\u64cd\u4f5c\u7cfb\u7edf\u9700\u8981\u5185\u90e8\u8d44\u6e90\u6765\u7ba1\u7406\u8fdb\u7a0b\uff0c\u7b49\u7b49\u3002</p> <p>\u591a\u8fdb\u7a0b\u5e76\u53d1\u7684\u989d\u5916\u4f18\u52bf\uff1a - \u5728\u64cd\u4f5c\u7cfb\u7edf\u7684\u7ba1\u7406\u4e0b\uff0c\u66f4\u52a0\u5b89\u5168 - \u53ef\u4ee5\u901a\u8fc7\u8fdc\u7a0b\u8fde\u63a5\uff0c\u5728\u4e0d\u540c\u7684\u673a\u5668\u4e0a\u8fd0\u884c\u72ec\u7acb\u7684\u8fdb\u7a0b</p> <p>\u591a\u7ebf\u7a0b\u5e76\u53d1\uff1a</p> <p>\u8fdb\u7a0b\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u90fd\u5171\u4eab\u5730\u5740\u7a7a\u95f4</p> <p>Reference\uff1a</p> <p>\u7b2c1\u7ae0 \u4f60\u597d\uff0cC++\u7684\u5e76\u53d1\u4e16\u754c \u00b7 C++\u5e76\u53d1\u7f16\u7a0b\u5b9e\u6218</p>"},{"location":"System/RISC-V/RISC-V/","title":"RISC-V","text":""},{"location":"System/RISC-V/RISC-V/#rv3264","title":"RV32/64 \u7279\u6743\u67b6\u6784","text":"<p>\u4e0e\u7279\u6743\u7ea7\u65e0\u5173\u7684\u4e00\u822c\u7684\u6307\u4ee4\u548c\u901a\u7528\u5bc4\u5b58\u5668\u00a0<code>x0</code>\u00a0~\u00a0<code>x31</code>\u00a0\u5728\u4efb\u4f55\u7279\u6743\u7ea7\u90fd\u53ef\u4ee5\u6267\u884c\u3002</p> <p>\u673a\u5668\u6a21\u5f0f\uff08M \u6a21\u5f0f\uff0cM-mode\uff09</p> <ul> <li>\u662f RISC-V \u4e2d hart(hardware thread,\u786c\u4ef6\u7ebf\u7a0b)\u53ef\u4ee5\u6267\u884c\u7684\u6700\u9ad8\u6743\u9650\u6a21\u5f0f\u3002</li> <li>\u552f\u4e00\u6240\u6709\u6807\u51c6 RISC-V \u5904\u7406\u5668\u90fd\u5fc5\u987b\u5b9e\u73b0\u7684\u6743\u9650\u6a21\u5f0f</li> </ul> <p>RISC-V \u5c06\u5f02\u5e38\u5206\u4e3a\u4e24\u7c7b\uff1a</p> <ul> <li>\u4e00\u7c7b\u662f\u540c\u6b65\u5f02\u5e38\uff0c\u8fd9\u7c7b\u5f02\u5e38\u5728\u6307\u4ee4\u6267\u884c\u671f\u95f4\u4ea7\u751f\uff0c\u5982 \u8bbf\u95ee\u4e86\u65e0\u6548\u7684\u5b58\u50a8\u5668\u5730\u5740 \u6216 \u6267\u884c\u4e86\u5177\u6709\u65e0\u6548\u64cd\u4f5c\u7801\u7684\u6307\u4ee4\u65f6\u3002</li> <li>\u53e6\u4e00\u7c7b\u662f\u4e2d\u65ad\uff0c\u5b83\u662f\u4e0e\u6307\u4ee4\u6d41\u5f02\u6b65\u7684\u5916\u90e8\u4e8b\u4ef6\uff0c\u6bd4\u5982\u9f20\u6807\u7684\u5355\u51fb\u3002</li> </ul> <p>\u7cbe\u786e\u4f8b\u5916\uff1a\u4fdd\u8bc1\u5f02\u5e38\u4e4b\u524d\u7684\u6240\u6709\u6307\u4ee4\u90fd\u5b8c\u6574\u5730\u6267\u884c\u4e86\uff0c\u800c\u540e\u7eed\u7684\u6307\u4ee4\u90fd\u6ca1\u6709\u5f00\u59cb\u6267\u884c\uff08\u6216\u7b49\u540c\u4e8e\u6ca1\u6709\u6267\u884c\uff09</p> <p>\u89e6\u53d1\u7cbe\u786e\u4f8b\u5916\u7684\u539f\u56e0\uff1a - \u8bbf\u95ee\u9519\u8bef\u5f02\u5e38 - \u65ad\u70b9\u5f02\u5e38 - \u73af\u5883\u8c03\u7528\u5f02\u5e38 - \u975e\u6cd5\u6307\u4ee4\u5f02\u5e38 - \u975e\u5bf9\u9f50\u5730\u5740\u5f02\u5e38</p> <p></p> <p>\u673a\u5668\u6a21\u5f0f\u4e0b\u7684\u5f02\u5e38\u5904\u7406</p> <p>\u516b\u4e2a\u63a7\u5236\u72b6\u6001\u5bc4\u5b58\u5668(CSR)\u662f\u673a\u5668\u6a21\u5f0f\u4e0b\u5f02\u5e38\u5904\u7406\u7684\u5fc5\u8981\u90e8\u5206:</p> <ul> <li>mtvec\uff08Machine Trap Vector\uff09\u5b83\u4fdd\u5b58\u53d1\u751f\u5f02\u5e38\u65f6\u5904\u7406\u5668\u9700\u8981\u8df3\u8f6c\u5230\u7684\u5730\u5740\u3002</li> <li>mepc\uff08Machine Exception PC\uff09\u5b83\u6307\u5411\u53d1\u751f\u5f02\u5e38\u7684\u6307\u4ee4\u3002</li> <li>mcause\uff08Machine Exception Cause\uff09\u5b83\u6307\u793a\u53d1\u751f\u5f02\u5e38\u7684\u79cd\u7c7b\u3002</li> <li>mie\uff08Machine Interrupt Enable\uff09\u5b83\u6307\u51fa\u5904\u7406\u5668\u76ee\u524d\u80fd\u5904\u7406\u548c\u5fc5\u987b\u5ffd\u7565\u7684\u4e2d\u65ad\u3002</li> <li>mip\uff08Machine Interrupt Pending\uff09\u5b83\u5217\u51fa\u76ee\u524d\u6b63\u51c6\u5907\u5904\u7406\u7684\u4e2d\u65ad\u3002</li> <li>mtval\uff08Machine Trap Value\uff09\u5b83\u4fdd\u5b58\u4e86\u9677\u5165(trap)\u7684\u9644\u52a0\u4fe1\u606f:\u5730\u5740\u4f8b\u5916\u4e2d\u51fa\u9519\u7684\u5730\u5740\u3001\u53d1\u751f\u975e\u6cd5\u6307\u4ee4\u4f8b\u5916\u7684\u6307\u4ee4\u672c\u8eab,\u5bf9\u4e8e\u5176\u4ed6\u5f02\u5e38,\u5b83\u7684\u503c\u4e3a 0\u3002</li> <li>mscratch\uff08Machine Scratch\uff09\u5b83\u6682\u65f6\u5b58\u653e\u4e00\u4e2a\u5b57\u5927\u5c0f\u7684\u6570\u636e\u3002</li> <li>mstatus\uff08Machine Status\uff09\u5b83\u4fdd\u5b58\u5168\u5c40\u4e2d\u65ad\u4f7f\u80fd,\u4ee5\u53ca\u8bb8\u591a\u5176\u4ed6\u7684\u72b6\u6001,</li> </ul> <p>\u7528\u6237\u6a21\u5f0f\uff08U \u6a21\u5f0f\uff09</p> <ul> <li>\u7981\u6b62\u4e0d\u53ef\u4fe1\u7684\u4ee3\u7801\u6267\u884c\u7279\u6743\u6307\u4ee4\u548c\u8bbf\u95ee\u7279\u6743\u63a7\u5236\u72b6\u6001\u5bc4\u5b58\u5668\uff0c\u8fd9\u79cd\u6a21\u5f0f\u62d2\u7edd\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd,\u5e76\u5728\u5c1d\u8bd5\u6267\u884c M \u6a21\u5f0f\u6307\u4ee4\u6216\u8bbf\u95ee CSR \u7684\u65f6\u5019\u4ea7\u751f\u975e\u6cd5\u6307\u4ee4\u5f02\u5e38\u3002</li> <li>\u5176\u4ed6\u65f6\u5019\uff0cU \u6a21\u5f0f\u548c M \u6a21\u5f0f\u7684\u8868\u73b0\u5341\u5206\u76f8\u4f3c</li> </ul> <p>\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u7684\u76d1\u7ba1\u8005\u6a21\u5f0f\uff08S \u6a21\u5f0f\uff09</p> <p>\u8fd9\u662f\u4e00\u79cd\u53ef\u9009\u7684\u6743\u9650\u6a21\u5f0f</p> <p>S \u6a21\u5f0f\u6bd4 U \u6a21\u5f0f\u6743\u9650\u66f4\u9ad8\uff0c\u4f46\u6bd4 M \u6a21\u5f0f\u4f4e\u3002</p> <p>\u4e0e U \u6a21\u5f0f\u4e00\u6837,S \u6a21\u5f0f\u4e0b\u8fd0\u884c\u7684\u8f6f\u4ef6\u4e0d\u80fd\u4f7f\u7528 M \u6a21\u5f0f\u7684 CSR \u548c\u6307\u4ee4,\u5e76\u4e14\u53d7\u5230 PMP \u7684\u9650\u5236\u3002</p>"},{"location":"System/RISC-V/%E5%9F%BA%E6%9C%AC%E6%8C%87%E4%BB%A4/","title":"RISC-V\u57fa\u672c\u6307\u4ee4","text":"<p>addi</p> <pre><code>addi t0, t1, imm; # t0 = t1 + imm\n</code></pre>"},{"location":"System/RISC-V/%E6%B5%8B%E8%AF%95/","title":"\u6d4b\u8bd5","text":"<pre><code>riscv64-unknown-elf-c++ -c -nostdlib -nostdinc -static -g -Ttext 0x80000000 -o sum.elf sum.s\n</code></pre> <p>\u5404\u4e2a\u7f16\u8bd1\u53c2\u6570\u7684\u89e3\u91ca\uff1a</p> <p>-nostdlib -nostdinc \u4e0d\u9700\u8981\u6807\u51c6\u5e93</p> <p>-c \u53ea\u8fdb\u884c\u7f16\u8bd1\u548c\u6c47\u7f16\uff0c\u4e0d\u8fdb\u884c\u94fe\u63a5</p> <p>-static \u9759\u6001\u7f16\u8bd1\uff0c\u4e0d\u505a\u52a8\u6001\u7684\u7279\u6b8a\u5904\u7406</p> <p>-g \u52a0\u5165\u8c03\u8bd5\u4fe1\u606f\uff08\u7b26\u53f7\u8868\u7b49\uff09\uff0c\u4fbf\u4e8e\u8c03\u8bd5</p> <p>-o \u8f93\u51fa\u6587\u4ef6</p>"},{"location":"System/rCore/ch0/","title":"ch0","text":"<p>\u4e22\u5f03\u5185\u6838\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u7684\u5143\u6570\u636e\u5f97\u5230\u5185\u6838\u955c\u50cf <pre><code>rust-objcopy --strip-all target/riscv64gc-unknown-none-elf/release/os -O binary target/riscv64gc-unknown-none-elf/release/os.bin\n</code></pre></p> <p>\u5728 <code>os</code> \u76ee\u5f55\u4e0b\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u542f\u52a8 Qemu \u5e76\u52a0\u8f7d RustSBI \u548c\u5185\u6838\u955c\u50cf\uff1a <pre><code>qemu-system-riscv64 \\\n    -machine virt \\\n    -nographic \\\n    -bios ../bootloader/rustsbi-qemu.bin \\\n    -device loader,file=target/riscv64gc-unknown-none-elf/release/os.bin,addr=0x80200000 \\\n    -s -S\n</code></pre></p> <p>\u4f7f\u7528gdb\u76d1\u542c1234\u7aef\u53e3 <pre><code>riscv64-unknown-elf-gdb \\\n    -ex 'file target/riscv64gc-unknown-none-elf/release/os' \\\n    -ex 'set arch riscv:rv64' \\\n    -ex 'target remote localhost:1234'\n</code></pre></p> <p>\u5b89\u88c5\u8f85\u52a9\u5de5\u5177 <pre><code>wget https://static.dev.sifive.com/dev-tools/riscv64-unknown-elf-gcc-8.3.0-2020.04.1-x86_64-linux-ubuntu14.tar.gz\ntar xvf riscv64-unknown-elf-gcc-8.3.0-2020.04.1-x86_64-linux-ubuntu14.tar.gz\nmv riscv64-unknown-elf-gcc-8.3.0-2020.04.1-x86_64-linux-ubuntu14 riscv64-utils\nrm riscv64-unknown-elf-gcc-8.3.0-2020.04.1-x86_64-linux-ubuntu14.tar.gz\n</code></pre></p> <p>\u5feb\u901f\u6253\u5f00docker\u73af\u5883 <pre><code>docker restart rCore &amp;&amp; docker exec -it rCore /bin/bash -c \"cd /mnt/os; bash\"\n</code></pre></p>"},{"location":"System/rCore/ch1/","title":"ch1","text":"<ul> <li>BASE_ADDRESS\uff1a\u5b9a\u4e49\u57fa\u5730\u5740</li> <li>skernel\uff1a\u5b9a\u4e49\u5f53\u524d\u4f4d\u7f6e\uff08\u53ef\u901a\u8fc7<code>.</code>\u8868\u793a\uff09</li> <li>stext\uff1a\u5b9a\u4e49.text\u8282\u7684\u8d77\u59cb\u4f4d\u7f6e</li> <li>etext\uff1a\u5b9a\u4e49.text\u8282\u7684\u7ed3\u675f\u4f4d\u7f6e</li> <li>srodata\uff1a\u5b9a\u4e49.rodata\u8282\u7684\u8d77\u59cb\u4f4d\u7f6e</li> <li>erodata\uff1a\u5b9a\u4e49.rodata\u8282\u7684\u7ed3\u675f\u4f4d\u7f6e</li> <li>sdata\uff1a\u5b9a\u4e49.data\u8282\u7684\u8d77\u59cb\u4f4d\u7f6e</li> <li>edata\uff1a\u5b9a\u4e49.data\u8282\u7684\u7ed3\u675f\u4f4d\u7f6e</li> <li>sbss\uff1a\u5b9a\u4e49.bss\u8282\u7684\u8d77\u59cb\u4f4d\u7f6e</li> <li>ebss\uff1a\u5b9a\u4e49.bss\u8282\u7684\u7ed3\u675f\u4f4d\u7f6e</li> <li>ekernel\uff1a\u5b9a\u4e49\u94fe\u63a5\u811a\u672c\u7684\u7ed3\u675f\u4f4d\u7f6e</li> </ul> <p>\u94fe\u63a5\u811a\u672c\u7684\u7ed3\u6784</p>"},{"location":"System/rCore/ch1/#ch2","title":"ch2","text":"<p>\u63a7\u5236\u72b6\u6001\u5bc4\u5b58\u5668\u00a0(CSR, Control and Status Register)</p> <p>\u5f53 CPU \u6267\u884c\u5b8c\u4e00\u6761\u6307\u4ee4\uff08\u5982 ecall \uff09\u5e76\u51c6\u5907\u4ece\u7528\u6237\u7279\u6743\u7ea7 \u9677\u5165\uff08 Trap \uff09\u5230 S \u7279\u6743\u7ea7\u7684\u65f6\u5019\uff0c\u786c\u4ef6\u4f1a\u81ea\u52a8\u5b8c\u6210\u5982\u4e0b\u8fd9\u4e9b\u4e8b\u60c5\uff1a</p> <ul> <li>sstatus \u7684 SPP \u5b57\u6bb5\u4f1a\u88ab\u4fee\u6539\u4e3a CPU \u5f53\u524d\u7684\u7279\u6743\u7ea7\uff08U/S\uff09\u3002</li> <li>sepc \u4f1a\u88ab\u4fee\u6539\u4e3a Trap \u5904\u7406\u5b8c\u6210\u540e\u9ed8\u8ba4\u4f1a\u6267\u884c\u7684\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u5730\u5740\u3002</li> <li>scause/stval \u5206\u522b\u4f1a\u88ab\u4fee\u6539\u6210\u8fd9\u6b21 Trap \u7684\u539f\u56e0\u4ee5\u53ca\u76f8\u5173\u7684\u9644\u52a0\u4fe1\u606f\u3002</li> <li>CPU \u4f1a\u8df3\u8f6c\u5230 stvec \u6240\u8bbe\u7f6e\u7684 Trap \u5904\u7406\u5165\u53e3\u5730\u5740\uff0c\u5e76\u5c06\u5f53\u524d\u7279\u6743\u7ea7\u8bbe\u7f6e\u4e3a S \uff0c\u7136\u540e\u4eceTrap \u5904\u7406\u5165\u53e3\u5730\u5740\u5904\u5f00\u59cb\u6267\u884c\u3002</li> </ul> <p>\u800c\u5f53 CPU \u5b8c\u6210 Trap \u5904\u7406\u51c6\u5907\u8fd4\u56de\u7684\u65f6\u5019\uff0c\u9700\u8981\u901a\u8fc7\u4e00\u6761 S \u7279\u6743\u7ea7\u7684\u7279\u6743\u6307\u4ee4 sret \u6765\u5b8c\u6210\uff0c\u8fd9\u4e00\u6761\u6307\u4ee4\u5177\u4f53\u5b8c\u6210\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ul> <li>CPU \u4f1a\u5c06\u5f53\u524d\u7684\u7279\u6743\u7ea7\u6309\u7167 sstatus \u7684 SPP \u5b57\u6bb5\u8bbe\u7f6e\u4e3a U \u6216\u8005 S \uff1b</li> <li>CPU \u4f1a\u8df3\u8f6c\u5230 sepc \u5bc4\u5b58\u5668\u6307\u5411\u7684\u90a3\u6761\u6307\u4ee4\uff0c\u7136\u540e\u7ee7\u7eed\u6267\u884c\u3002</li> </ul> <p><code>KernelStact</code> \u5185\u6838\u6808</p> <p><code>UserStack</code> \u7528\u6237\u6808</p> <p>\u4e24\u79cd\u6808\u7684\u5927\u5c0f\u90fd\u8bbe\u4e3a8KiB</p> <p>Trap\u4e0a\u4e0b\u6587 <pre><code>// os/src/trap/context.rs\n\n#[repr(C)]\npub struct TrapContext {\n    pub x: [usize; 32],\n    pub sstatus: Sstatus,\n    pub sepc: usize,\n}\n</code></pre></p> <p>\u53ef\u4ee5\u770b\u5230\u91cc\u9762\u5305\u542b\u6240\u6709\u7684\u901a\u7528\u5bc4\u5b58\u5668 x0~x31 \uff0c\u8fd8\u6709 sstatus \u548c sepc \u3002\u90a3\u4e48\u4e3a\u4ec0\u4e48\u9700\u8981\u4fdd\u5b58\u5b83\u4eec\u5462\uff1f</p> <ul> <li>\u5bf9\u4e8e\u901a\u7528\u5bc4\u5b58\u5668\u800c\u8a00\uff0c\u4e24\u6761\u63a7\u5236\u6d41\uff08\u5e94\u7528\u7a0b\u5e8f\u63a7\u5236\u6d41\u548c\u5185\u6838\u63a7\u5236\u6d41\uff09\u8fd0\u884c\u5728\u4e0d\u540c\u7684\u7279\u6743\u7ea7\uff0c\u6240\u5c5e\u7684\u8f6f\u4ef6\u4e5f\u53ef\u80fd\u7531\u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u7f16\u5199\uff0c\u867d\u7136\u5728 Trap \u63a7\u5236\u6d41\u4e2d\u53ea\u662f\u4f1a\u6267\u884c Trap \u5904\u7406\u76f8\u5173\u7684\u4ee3\u7801\uff0c\u4f46\u4f9d\u7136\u53ef\u80fd\u76f4\u63a5\u6216\u95f4\u63a5\u8c03\u7528\u5f88\u591a\u6a21\u5757\uff0c\u56e0\u6b64\u5f88\u96be\u751a\u81f3\u4e0d\u53ef\u80fd\u627e\u51fa\u54ea\u4e9b\u5bc4\u5b58\u5668\u65e0\u9700\u4fdd\u5b58\u3002\u65e2\u7136\u5982\u6b64\u6211\u4eec\u5c31\u53ea\u80fd\u5168\u90e8\u4fdd\u5b58\u4e86\u3002\u4f46\u8fd9\u91cc\u4e5f\u6709\u4e00\u4e9b\u4f8b\u5916\uff0c\u5982 x0 \u88ab\u786c\u7f16\u7801\u4e3a 0 \uff0c\u5b83\u81ea\u7136\u4e0d\u4f1a\u6709\u53d8\u5316\uff1b\u8fd8\u6709 tp(x4) \u5bc4\u5b58\u5668\uff0c\u9664\u975e\u6211\u4eec\u624b\u52a8\u51fa\u4e8e\u4e00\u4e9b\u7279\u6b8a\u7528\u9014\u4f7f\u7528\u5b83\uff0c\u5426\u5219\u4e00\u822c\u4e5f\u4e0d\u4f1a\u88ab\u7528\u5230\u3002\u867d\u7136\u5b83\u4eec\u65e0\u9700\u4fdd\u5b58\uff0c\u4f46\u6211\u4eec\u4ecd\u7136\u5728 TrapContext \u4e2d\u4e3a\u5b83\u4eec\u9884\u7559\u7a7a\u95f4\uff0c\u4e3b\u8981\u662f\u4e3a\u4e86\u540e\u7eed\u7684\u5b9e\u73b0\u65b9\u4fbf\u3002</li> <li>\u5bf9\u4e8e CSR \u800c\u8a00\uff0c\u6211\u4eec\u77e5\u9053\u8fdb\u5165 Trap \u7684\u65f6\u5019\uff0c\u786c\u4ef6\u4f1a\u7acb\u5373\u8986\u76d6\u6389 scause/stval/sstatus/sepc \u7684\u5168\u90e8\u6216\u662f\u5176\u4e2d\u4e00\u90e8\u5206\u3002scause/stval \u7684\u60c5\u51b5\u662f\uff1a\u5b83\u603b\u662f\u5728 Trap \u5904\u7406\u7684\u7b2c\u4e00\u65f6\u95f4\u5c31\u88ab\u4f7f\u7528\u6216\u8005\u662f\u5728\u5176\u4ed6\u5730\u65b9\u4fdd\u5b58\u4e0b\u6765\u4e86\uff0c\u56e0\u6b64\u5b83\u6ca1\u6709\u88ab\u4fee\u6539\u5e76\u9020\u6210\u4e0d\u826f\u5f71\u54cd\u7684\u98ce\u9669\u3002\u800c\u5bf9\u4e8e sstatus/sepc \u800c\u8a00\uff0c\u5b83\u4eec\u4f1a\u5728 Trap \u5904\u7406\u7684\u5168\u7a0b\u6709\u610f\u4e49\uff08\u5728 Trap \u63a7\u5236\u6d41\u6700\u540e sret \u7684\u65f6\u5019\u8fd8\u7528\u5230\u4e86\u5b83\u4eec\uff09\uff0c\u800c\u4e14\u786e\u5b9e\u4f1a\u51fa\u73b0 Trap \u5d4c\u5957\u7684\u60c5\u51b5\u4f7f\u5f97\u5b83\u4eec\u7684\u503c\u88ab\u8986\u76d6\u6389\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5c06\u5b83\u4eec\u4e5f\u4e00\u8d77\u4fdd\u5b58\u4e0b\u6765\uff0c\u5e76\u5728 sret \u4e4b\u524d\u6062\u590d\u539f\u6837\u3002</li> </ul>"},{"location":"System/rCore/ch5/","title":"Ch5","text":"<p>\u8fdb\u7a0b (Process) \u7684\u542b\u4e49\u662f \u5728\u64cd\u4f5c\u7cfb\u7edf\u7ba1\u7406\u4e0b\u7684\u7a0b\u5e8f\u7684\u4e00\u6b21\u6267\u884c\u8fc7\u7a0b\u3002</p>"},{"location":"System/rCore/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/","title":"\u5b66\u4e60\u8bb0\u5f55","text":""},{"location":"System/rCore/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#lab","title":"\u5728Lab\u5f00\u59cb\u4e4b\u524d","text":"<p>\u914d\u7f6e\u73af\u5883</p> <p>\u672c\u6765\u60f3\u76f4\u63a5\u7528\u7269\u7406\u673a\u76f4\u63a5\u8fdb\u884c\u914d\u7f6e\u5b9e\u9a8c\u73af\u5883\u7684</p> <p>\u4f46\u662fArchLinux\u9ed8\u8ba4\u7684qemu\u7248\u672c\u662f8.1\uff0c\u548c\u4ed3\u5e93\u4e2drustsbi\u8981\u6c42\u7684\u7248\u672c\u6709\u51b2\u7a81\u3002</p> <p>\u6240\u4ee5\u6700\u540e\u8fd8\u662f\u6539\u7528\u4e86docker\u6765\u642d\u5efa\u73af\u5883......\ud83d\ude22</p> <pre><code>make build_docker\n\n# \u7528\u540c\u4e00\u4e2adocker\u5bb9\u5668\u8fdb\u884c\u5168\u90e8\u5b9e\u9a8c\uff0c\u4e0d\u60f3\u5b9e\u9a8c\u4e00\u6b21\u521b\u5efa\u4e00\u6b21\ndocker run -it -v ${PWD}:/mnt -w /mnt rCore bash\n</code></pre> <p>\u4fee\u6539ci-user\u4e2d\u7684makefile</p> <pre><code>env:\n    rustup uninstall nightly &amp;&amp; rustup install nightly\n    (rustup target list | grep \"riscv64gc-unknown-none-elf (installed)\") || rustup target add riscv64gc-unknown-none-elf\n    cargo install cargo-binutils\n    rustup component add rust-src\n    rustup component add llvm-tools-preview\n</code></pre> <p>\u5c06<code>rustup uninstall nightly &amp;&amp; rustup install nightly</code> \u6ce8\u91ca\u6389\uff0c\u907f\u514d\u6bcf\u6b21\u672c\u5730\u6d4b\u8bd5\u7684\u65f6\u5019\u90fd\u4e0b\u8f7d\u4e00\u904d</p>"},{"location":"System/rCore/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#lab-1","title":"Lab 1","text":"<p>lab1 \u672c\u8eab\u96be\u5ea6\u5176\u5b9e\u5e76\u4e0d\u5927\u3002\u611f\u89c9\u4e3b\u8981\u8fd8\u662f\u7ed3\u5408\u4e4b\u524d\u7684\u7ae0\u8282\u719f\u6089\u4e00\u4e0b rCore \u9879\u76ee\u4ee3\u7801\u7684\u6574\u4f53\u7ed3\u6784\uff0c</p> <p>\u4f46\u662f\u7531\u4e8e\u6211\u5bf9\u7cfb\u7edf\u7ed3\u6784\u8fd8\u4e0d\u662f\u5f88\u719f\u6089\uff0c\u6240\u4ee5\u8fd8\u662f\u82b1\u4e86\u6bd4\u8f83\u591a\u7684\u65f6\u95f4\u3002</p> <ul> <li>\u5b9e\u73b0 <code>sys_task_info</code>  \u7cfb\u7edf\u8c03\u7528\uff1a</li> </ul> <p>\u5728 TCB \u4e2d\u6dfb\u52a0\u8bb0\u5f55\u7cfb\u7edf\u8c03\u7528\u6b21\u6570\u7684\u4fe1\u606f\uff0c\u6bcf\u6b21\u7cfb\u7edf\u8c03\u7528\u65f6\uff0c\u6839\u636e syscall id \u66f4\u65b0\u76f8\u5e94\u6570\u636e\u3002</p> <p>\u6211\u8fd9\u91cc\u5c31\u76f4\u63a5\u7c97\u66b4\u5730\u7528\u6876\u65b9\u6cd5\u8bb0\u5f55\u4e86\u8fd9\u4e9b\u4fe1\u606f\u3002</p> <p>\u540e\u9762\u5199\u5230 lab3 \u7684\u65f6\u5019\uff0c\u53d1\u73b0\u6211\u4e4b\u524d sys_task_info \u4e2d\u7684\u83b7\u53d6\u65f6\u95f4\u7684\u65b9\u5f0f\u6709\u4e9b\u95ee\u9898\u3002\u6b63\u786e\u7684\u5e94\u8be5\u9700\u8981\u8bb0\u5f55\u8fdb\u7a0b\u7b2c\u4e00\u6b21\u8fd0\u884c\u7684\u65f6\u95f4\uff0c\u7136\u540e\u8bb0\u5f55\u65f6\u95f4\u5dee\u3002</p>"},{"location":"System/rCore/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#lab-2","title":"Lab 2","text":"<p>\u611f\u89c9\u5728\u524d\u4e09\u4e2a lab \u4e2d\uff0clab2 \u7b97\u662f\u76f8\u5bf9\u6bd4\u8f83\u96be\u7684\u4e00\u4e2a\u4e86\u3002\u4e3b\u8981\u7684\u65f6\u95f4\u90fd\u82b1\u5728\u4e86\u8fd9\u91cc\u3002</p> <p>\u56e0\u4e3a\u6709\u4e86\u865a\u62df\u5185\u5b58\u7684\u673a\u5236\uff0c\u6240\u4ee5\u8981\u91cd\u5199 lab1 \u4e2d\u7cfb\u7edf\u8c03\u7528</p> <ul> <li> <p>\u5b9e\u73b0 mmap \u548c munmap \u7cfb\u7edf\u8c03\u7528</p> <ul> <li>mmap</li> </ul> <p>\u9700\u8981\u6ce8\u610f\uff0cport\u53c2\u6570\u4e0d\u80fd\u76f4\u63a5\u8f6c\u6210MapPermission\uff0c\u4e24\u8005\u6709\u533a\u522b\uff0c\u5e76\u975e\u4ec5\u4ec5\u662f\u7c7b\u578b\u4e0d\u540c\u3002 \u5728\u8fdb\u884cmap\u524d\uff0c\u9700\u8981\u68c0\u67e5\u5bf9\u5e94\u7684\u865a\u62df\u5185\u5b58\u5730\u5740\u662f\u4e0d\u662f\u5df2\u7ecf\u88ab\u4f7f\u7528\u8fc7\u4e86\uff0c\u8fd9\u91cc\u53ef\u4ee5\u68c0\u67e5 vpn_range\u7684 start \u548c end \u770b\u770b\u662f\u5426\u88ab\u4f7f\u7528 \u4e0b\u9762\u7684munmap\u540c\u7406</p> <ul> <li>munmap</li> </ul> <p>\u57fa\u672c\u4e0a\u5c31\u662fmap\u7684\u9006\u64cd\u4f5c</p> </li> </ul> <p>\u53ef\u4ee5\u6839\u636e\u4ee3\u7801\u753b\u4e2a\u7ed3\u6784\u56fe\uff0c\u65b9\u4fbf\u7406\u89e3\u865a\u62df\u5185\u5b58\u7684\u7ed3\u6784\u3002</p>"},{"location":"System/rCore/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#lab-3","title":"Lab 3","text":"<ul> <li>\u5b9e\u73b0 <code>sys_spawn</code> \u7cfb\u7edf\u8c03\u7528\uff1a</li> </ul> <p>\u611f\u89c9\u8fd8\u662f\u6bd4\u8f83\u7b80\u5355\uff0c\u4f7f\u7528 <code>translated_str</code> \u628a path \u6307\u9488\u8f6c\u6210 \u7a0b\u5e8f\u540d\u79f0\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u521b\u5efa\u8fdb\u7a0b\uff0c\u52a0\u5165\u8fdb\u7a0b\u961f\u5217\u3002\u8981\u8bb0\u5f97\u628a\u65b0\u5efa\u7684\u8fdb\u7a0bpush\u5230\u7236\u8fdb\u7a0b\u7684child\u4e2d\u3002</p> <ul> <li>\u5b9e\u73b0 stride \u8c03\u5ea6\uff1a</li> </ul> <p>TCB \u4e0a\u518d\u6dfb\u52a0\u4e0a priority, stride \u7684\u4fe1\u606f\uff0c\u7136\u540e\u6bcf\u6b21\u8fdb\u7a0b\u5207\u6362\u7684\u65f6\u5019\u66f4\u65b0\u4e00\u4e0b\u3002</p> <p>\u8fdb\u7a0b\u63d2\u5165\u8fdb\u7a0b\u961f\u5217\u65f6\u6bd4\u8f83\u4e0b stride \u7684\u5927\u5c0f\u5c31\u884c\u3002</p>"},{"location":"System/rCore/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/rCore%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/#_2","title":"\u603b\u7ed3","text":"<p>\u56de\u987e\u5b66\u4e60\u7684\u8fc7\u7a0b\uff0c\u6211\u89c9\u5f97\u5b8c\u6210lab\u91cd\u8981\u7684\u662f\u8981\u6709\u4e00\u4e2a\u6e05\u6670\u7684\u601d\u8def\uff0c\u660e\u767d\u81ea\u5df1\u8981\u505a\u4ec0\u4e48\uff0c\u660e\u767d\u8981\u600e\u4e48\u505a\uff0c\u8981\u5bf9lab\u6709\u4e00\u4e2a\u6574\u4f53\u4e0a\u7684\u8ba4\u8bc6\u3002\u81ea\u5df1\u9605\u8bfb\u4ee3\u7801\u7684\u80fd\u529b\u8fd8\u662f\u5dee\u4e86\u4e00\u4e9b\uff0c\u4ee5\u540e\u8981\u52a0\u5f3a\u3002</p> <p>\u901a\u8fc7\u5b66\u4e60rCore\uff0c\u6211\u611f\u89c9\u6211\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u7406\u89e3\u66f4\u6df1\u4e86\uff0c\u4e0d\u50cf\u4ee5\u524d\u53ea\u662f\u6d6e\u4e8e\u8868\u9762\uff0c\u53ea\u8bb0\u5f97\u4e00\u4e9b\u6982\u5ff5\uff0c\u800c\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b9e\u73b0\u6ca1\u6709\u771f\u5207\u5730\u611f\u77e5\u3002</p> <p>\u6700\u540e\u8981\u611f\u8c22\u8001\u5e08\u3001\u52a9\u6559\u4eec\u8f9b\u82e6\u7684\u4ed8\u51fa\uff0c\u8ba9\u6211\u4eec\u80fd\u591f\u5b66\u4e60\u5230\u8fd9\u6837\u597d\u7684\u5f00\u6e90\u8bfe\u7a0b\uff0c\u8ba9\u6211\u4eec\u6709\u673a\u4f1a\u66f4\u52a0\u6df1\u5165\u4e86\u89e3\u64cd\u4f5c\u7cfb\u7edf\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/","title":"epoll","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/#linux-cpp","title":"linux #CPP","text":"<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/epoll.h&gt;\n#include &lt;fcntl.h&gt;\n\n#define MAX_EVENTS 10\n\nvoid fatal_error(const char* str) {\n    perror(str);\n    exit(EXIT_FAILURE);\n}\n\nint main() {\n    struct epoll_event event, events[MAX_EVENTS];\n    int epoll_fd, nfds;\n    char buf[256];\n\n    // \u521b\u5efa\u4e00\u4e2a\u65b0\u7684epoll\u5b9e\u4f8b\n    epoll_fd = epoll_create1(0);\n    if (epoll_fd == -1) {\n        fatal_error(\"epoll_create1\");\n    }\n\n    event.events = EPOLLIN; // \u8bbe\u7f6e\u5173\u6ce8\u7684\u4e8b\u4ef6\u4e3a\u53ef\u8bfb\n    event.data.fd = STDIN_FILENO; // \u8bbe\u7f6e\u8981\u5173\u6ce8\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e3a\u6807\u51c6\u8f93\u5165\n\n    // \u5c06\u6807\u51c6\u8f93\u5165\u6dfb\u52a0\u5230epoll\u7684\u5173\u6ce8\u5217\u8868\u4e2d\n    if (epoll_ctl(epoll_fd, EPOLL_CTL_ADD, STDIN_FILENO, &amp;event) == -1) {\n        fatal_error(\"epoll_ctl: add\");\n    }\n\n    // \u7b49\u5f85\u4e8b\u4ef6\u4ea7\u751f\n    nfds = epoll_wait(epoll_fd, events, MAX_EVENTS, -1);\n    if (nfds == -1) {\n        fatal_error(\"epoll_wait\");\n    }\n\n    //\u5904\u7406\u6240\u6709\u4ea7\u751f\u7684\u4e8b\u4ef6\n    for (int n = 0; n &lt; nfds; ++n) {\n        if (events[n].data.fd == STDIN_FILENO) {\n            memset(buf, 0, sizeof(buf));\n            int res = read(STDIN_FILENO, buf, sizeof(buf));\n            if (res == -1)\n                fatal_error(\"read\");\n            printf(\"Read: %s\\n\", buf);\n        }\n    }\n\n    // \u5173\u95edepoll\n    close(epoll_fd);\n\n    return 0;\n}\n</code></pre> <pre><code>$&gt; ./a.out\nasdf\nRead: adsf\n$&gt;  \n</code></pre> <p>\u6c34\u5e73\u89e6\u53d1\u548c\u8fb9\u7f18\u89e6\u53d1</p> <p>\u6c34\u5e73\u89e6\u53d1\uff08Level-triggered\uff0cLT\uff09\u548c\u8fb9\u7f18\u89e6\u53d1\uff08Edge-triggered\uff0cET\uff09\u662fIO\u591a\u8def\u590d\u7528\u6280\u672f\u4e2d\u7528\u6765\u63cf\u8ff0\u4e8b\u4ef6\u89e6\u53d1\u65b9\u5f0f\u7684\u4e24\u4e2a\u672f\u8bed\uff0c\u5177\u4f53\u8bf4\u6765\uff1a</p> <ol> <li> <p>\u6c34\u5e73\u89e6\u53d1\uff08Level-triggered\uff09\uff1a\u8fd9\u662f\u5927\u591a\u6570\u4eba\u7406\u89e3\u7684\u6a21\u5f0f\uff0c\u53ea\u8981\u6761\u4ef6\u6ee1\u8db3\uff08\u6bd4\u5982\u53ef\u8bfb/\u53ef\u5199\uff09\uff0c\u5b83\u5c31\u4f1a\u89e6\u53d1\u4e00\u6b21\u3002\u4f8b\u5982\u6211\u4eec\u628a\u4e00\u5806\u6587\u4ef6\u63cf\u8ff0\u7b26\u4ea4\u7ed9epoll\u53bb\u76d1\u63a7\u53ef\u8bfb\u4e8b\u4ef6\uff0c\u5982\u679c\u67d0\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u53d8\u5f97\u53ef\u8bfb\uff0c\u90a3\u4e48epoll_wait\u5c31\u4f1a\u8fd4\u56de\u8fd9\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u8868\u793a\u5b83\u5df2\u7ecf\u53ef\u4ee5\u5f00\u59cb\u8bfb\u53d6\u6570\u636e\u4e86\u3002\u5982\u679c\u6211\u4eec\u8bfb\u53d6\u4e86\u4e00\u90e8\u5206\u6570\u636e\uff0c\u8fd8\u6709\u4e00\u90e8\u5206\u6570\u636e\u7559\u5728\u4e86\u5185\u6838\u7684\u63a5\u6536\u7f13\u51b2\u533a\uff0c\u4e0d\u518d\u8bfb\u53d6\u5269\u4f59\u7684\u6570\u636e\uff0c\u90a3\u4e48\u4e0b\u4e00\u6b21\u518d\u8c03\u7528epoll_wait\uff0c\u8fd9\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u8fd8\u4f1a\u7acb\u523b\u8fd4\u56de\uff0c\u56e0\u4e3a\u4ecd\u7136\u6ee1\u8db3\u53ef\u8bfb\u6761\u4ef6\uff08\u63a5\u6536\u7f13\u51b2\u533a\u4e2d\u4ecd\u7136\u6709\u672a\u8bfb\u6570\u636e\uff09\u3002\u6240\u4ee5\uff0c\u53ea\u8981\u6709\u672a\u5904\u7406\u7684\u4e8b\u4ef6\uff08\u8fd9\u91cc\u662f\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\u6709\u672a\u8bfb\u53d6\u7684\u6570\u636e\uff09\uff0c\u6bcf\u4e00\u6b21epoll_wait\u90fd\u4f1a\u8fd4\u56de\u8fd9\u4e2a\u4e8b\u4ef6\u3002\u8fd9\u5c31\u662f\u6240\u8c13\u7684\u201c\u6c34\u5e73\u89e6\u53d1\u201d\u3002</p> </li> <li> <p>\u8fb9\u7f18\u89e6\u53d1\uff08Edge-triggered\uff09\uff1a\u8fb9\u7f18\u89e6\u53d1\u6a21\u5f0f\u4e0b\uff0c\u5f53\u72b6\u6001\u53d1\u751f\u53d8\u66f4\u7684\u65f6\u5019\uff0cepoll_wait\u4f1a\u8fd4\u56de\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u4f8b\u5982\u5728\u6570\u636e\u5230\u8fbe\u7684\u65f6\u5019\u89e6\u53d1\u4e00\u4e2a\u8bfb\u4e8b\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u5c3d\u53ef\u80fd\u591a\u7684\u8bfb\u53d6\u6570\u636e\uff0c\u4f46\u662f\u53ea\u6709\u518d\u6b21\u6709\u65b0\u6570\u636e\u5230\u6765\u65f6\u624d\u4f1a\u518d\u6b21\u89e6\u53d1\u3002\u6bd4\u5982\u6211\u4eec\u628a\u4e00\u5806\u6587\u4ef6\u63cf\u8ff0\u7b26\u4ea4\u7ed9epoll\u53bb\u76d1\u63a7\uff0c\u5e76\u8981\u6c42\u4ee5\u8fb9\u7f18\u89e6\u53d1\u6a21\u5f0f\u8fd4\u56de\u3002\u5f53\u67d0\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u53d8\u5f97\u53ef\u8bfb\u7684\u65f6\u5019\uff0cepoll_wait\u8fd4\u56de\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u6211\u4eec\u53ea\u8bfb\u53d6\u4e86\u90e8\u5206\u6570\u636e\uff0c\u7559\u4e0b\u4e86\u4e00\u90e8\u5206\u5728\u5185\u6838\u7684\u63a5\u6536\u7f13\u51b2\u533a\uff0c\u518d\u6b21\u8c03\u7528epoll_wait\uff0c\u8fd9\u6b21\u5b83\u5c06\u4e0d\u4f1a\u8fd4\u56de\u90a3\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e86\uff0c\u5373\u4f7f\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\u8fd8\u6709\u672a\u8bfb\u53d6\u7684\u6570\u636e\u3002\u56e0\u4e3a\u4eceepoll\u7684\u89d2\u5ea6\u770b\uff0c\u5b83\u7684\u72b6\u6001\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff08\u5b83\u4e00\u76f4\u662f\u53ef\u8bfb\u7684\uff09\u3002\u53ea\u6709\u5728\u6709\u65b0\u7684\u6570\u636e\u5230\u6765\u7684\u65f6\u5019\uff0cepoll_wait\u624d\u4f1a\u8fd4\u56de\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u7136\u800c\uff0c\u8fb9\u7f18\u89e6\u53d1\u867d\u7136\u6548\u7387\u8f83\u9ad8\uff0c\u4f46\u662f\u7f16\u7801\u96be\u5ea6\u4e5f\u5c31\u8f83\u5927\u3002</p> </li> </ol> <p>\u603b\u7ed3\u4e0b\u6765\uff0c\u6c34\u5e73\u89e6\u53d1\u548c\u8fb9\u7f18\u89e6\u53d1\u6700\u5927\u7684\u533a\u522b\u662f\uff0c\u6c34\u5e73\u89e6\u53d1\u5173\u6ce8\u7684\u662f\u72b6\u6001\uff0c\u800c\u8fb9\u7f18\u89e6\u53d1\u5173\u6ce8\u7684\u662f\u72b6\u6001\u7684\u6539\u53d8\u3002\u5728\u5b9e\u9645\u4f7f\u7528\u4e2d\u7684\u533a\u522b\u662f\uff0c\u4f7f\u7528\u6c34\u5e73\u89e6\u53d1\u65f6\uff0c\u5982\u679c\u4e0d\u5b8c\u5168\u5904\u7406\u8be5IO\u4e8b\u4ef6\uff08\u6bd4\u5982\u8bfb\u53d6\u5168\u90e8\u5f85\u8bfb\u53d6\u7684\u6570\u636e\uff09\uff0c\u90a3\u4e48\u4e0b\u6b21epoll_wait\u4f9d\u7136\u4f1a\u8fd4\u56de\u8be5\u4e8b\u4ef6\uff1b\u800c\u4f7f\u7528\u8fb9\u7f18\u89e6\u53d1\u65f6\uff0c\u5fc5\u987b\u4fdd\u8bc1\u4e00\u6b21\u6027\u5904\u7406\u5b8c\u8be5IO\u4e8b\u4ef6\uff0c\u5426\u5219\u540e\u7eed\u7684epoll_wait\u5c06\u4e0d\u518d\u8fd4\u56de\u8be5\u4e8b\u4ef6\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/#io_uring","title":"io_uring","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/","title":"Linux \u7f51\u7edc\u7f16\u7a0b","text":"<p>\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528socket\u8fdb\u884c\u901a\u4fe1\u7684\u65b9\u5f0f\u5982\u4e0b\uff1a - \u5404\u4e2a\u5404\u4e2a\u5e94\u7528\u7a0b\u5e8f\u521b\u5efa\u4e00\u4e2a socket\u3002socket \u662f\u4e00\u4e2a\u5141\u8bb8\u901a\u4fe1\u7684\u201c\u8bbe\u5907\u201d,\u4e24\u4e2a\u5e94\u7528\u7a0b\u5e8f\u90fd\u9700\u8981\u7528\u5230\u5b83\u3002 - \u670d\u52a1\u5668\u5c06\u81ea\u5df1\u7684 socket \u7ed1\u5b9a\u5230\u4e00\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u5730\u5740(\u540d\u79f0)\u4e0a\u4f7f\u5f97\u5ba2\u6237\u7aef\u80fd\u591f\u5b9a\u4f4d\u5230\u5b83\u7684\u4f4d\u7f6e\u3002</p> <p>\u4f7f\u7528 socket() \u7cfb\u7edf\u8c03\u7528\u80fd\u591f\u521b\u5efa\u4e00\u4e2a socket,\u5b83\u8fd4\u56de\u4e00\u4e2a\u7528\u6765\u5728\u540e\u7eed\u7cfb\u7edf\u8c03\u7528\u4e2d\u5f15\u7528\u8be5 socket \u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</p> <p><code>fd = socket(domain, type, protocol)</code></p> <p>\u6bcf\u4e2a socket \u5b9e\u73b0\u90fd\u81f3\u5c11\u63d0\u4f9b\u4e86\u4e24\u79cd socket\uff1a\u6d41\u548c\u6570\u636e\u62a5</p> \u5c5e\u6027 \u6d41 \u6570\u636e\u62a5 \u53ef\u9760\u5730\u9012\u9001\uff1f \u662f \u5426 \u6d88\u606f\u8fb9\u754c\u4fdd\u7559\uff1f \u5426 \u662f \u9762\u5411\u8fde\u63a5\uff1f \u662f \u5426 <p>\u4e00\u4e2a\u6570\u636e\u62a5 socket \u5728\u4f7f\u7528\u65f6\u65e0\u9700\u4e0e\u53e6\u4e00\u4e2a socket \u8fde\u63a5\u3002</p> <p>\u5173\u952e\u7684 socket \u7cfb\u7edf\u8c03\u7528 - <code>socket()</code>: \u521b\u5efa\u4e00\u4e2a\u65b0\u7684<code>socket</code> - <code>bind()</code>: \u5c06\u4e00\u4e2a<code>socket</code>\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5730\u5740\u4e0a - <code>lieten()</code>: \u5141\u8bb8\u4e00\u4e2a\u6d41<code>socket</code>\u63a5\u53d7\u6765\u81ea\u5176\u4ed6<code>socket</code>\u7684\u63a5\u5165\u8fde\u63a5 - <code>accept()</code>: \u5728\u4e00\u4e2a\u76d1\u542c\u6d41 <code>socket</code> \u4e0a\u63a5\u53d7\u6765\u81ea\u4e00\u4e2a\u5bf9\u7b49\u5e94\u7528\u7a0b\u5e8f\u7684\u8fde\u63a5\uff0c\u5e76\u53ef\u9009\u5730\u8fd4\u56de\u5bf9\u7b49 <code>socket</code> \u7684\u5730\u5740 - <code>connect()</code>: \u5efa\u7acb\u4e0e\u53e6\u4e00\u4e2a<code>socket</code>\u4e4b\u95f4\u7684\u8fde\u63a5</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#function","title":"function","text":"<p>socket()</p> <p>\u521b\u5efa\u4e00\u4e2a\u65b0\u7684socket</p> <pre><code>#include &lt;sys/socket.h&gt;\n\nint socket(int domain, int type, int protocol) // Returns filedescriptor on success, or -1 on error\n</code></pre> <ul> <li> <p><code>domain</code> \u53c2\u6570\u6307\u5b9a\u4e86 <code>socket</code> \u7684\u901a\u4fe1 domain\u3002\u5bf9\u4e8eTCP/IP\u534f\u8bae\u65cf\u800c\u8a00\uff0c\u8be5\u53c2\u6570\u5e94\u8be5\u8bbe\u7f6e\u4e3aPF_INET(Protocal Family of Internet\uff0c\u7528\u4e8eIPv4)\u6216PF_INET6(\u7528\u4e8eIPv6)\uff0c\u5bf9\u4e8eUNIX\u672c\u5730\u534f\u8bae\u65cf\u800c\u8a00\uff0c\u8be5\u53c2\u6570\u5e94\u8bbe\u7f6e\u4e3aPF_UNIX\u3002</p> </li> <li> <p><code>type</code> \u53c2\u6570\u6307\u5b9a\u4e86 <code>socket</code> \u7c7b\u578b\u3002\u8fd9\u4e2a\u53c2\u6570\u901a\u5e38\u5728\u521b\u5efa\u6d41 <code>socket</code> \u65f6\u4f1a\u88ab\u6307\u5b9a\u4e3a <code>SOCK_STREAM</code>\uff0c\u800c\u5728\u521b\u5efa\u6570\u636e\u62a5 <code>socket</code> \u65f6\u4f1a\u88ab\u6307\u5b9a\u4e3a <code>SOCK_DGRAM</code>\u3002</p> </li> <li><code>protocol</code> \u51e0\u4e4e\u90fd\u6307\u5b9a\u4e3a 0</li> </ul> <p>bind()</p> <p>\u5c06\u4e00\u4e2a<code>socket</code>\u7ed1\u5b9a\u5230\u4e00\u4e2a\u5730\u5740\u4e0a</p> <pre><code>#include &lt;sys/socket.h&gt;\n\nint bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen); // Returns 0 on success, or -1 on error\n</code></pre> <ul> <li><code>socket</code>\u662f\u5728\u4e0a\u4e00\u4e2asocket()\u8c03\u7528\u4e2d\u83b7\u5f97\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26</li> <li><code>addr</code> \u662f\u4e00\u4e2a\u6307\u9488\uff0c\u6307\u5411\u4e00\u4e2a\u6307\u5b9a\u8be5socket\u7ed1\u5b9a\u5230\u7684\u5730\u5740\u7684\u7ed3\u6784</li> <li><code>addlen</code> \u662f\u5730\u5740\u7ed3\u6784\u7684\u5927\u5c0f</li> </ul> <p>struct sockaddr</p> <pre><code>struct sockaddr {\n    sa_family_t sa_family;    // Address family\n    char        sa_data[14];  // Socket address (size varies according to socket domain)\n}\n</code></pre> <p>\u76d1\u542c\u63a5\u5165\u8fde\u63a5\uff1alisten()</p> <p>TCP</p> <p><code>listen()</code>\u7cfb\u7edf\u8c03\u7528\u5c06\u6587\u4ef6\u63cf\u8ff0\u7b26 sockfd \u5f15\u7528\u7684\u6d41 socket \u6807\u8bb0\u4e3a\u88ab\u52a8\u3002\u8fd9\u4e2a socket \u540e\u9762\u4f1a\u88ab\u7528\u6765\u63a5\u53d7\u6765\u81ea\u5176\u4ed6(\u4e3b\u52a8\u7684)socket \u7684\u8fde\u63a5\u3002</p> <pre><code>#include &lt;sys/socket.h&gt;\n\nint listen(int sockfd, int backlog); // Returns 0 on success, or -1 on error\n</code></pre> <p>\u63a5\u53d7\u8fde\u63a5\uff1aaccept()</p> <p>TCP</p> <p><code>accept()</code>\u7cfb\u7edf\u8c03\u7528\u5728\u6587\u4ef6\u63cf\u8ff0\u7b26 sockfd \u5f15\u7528\u7684\u76d1\u542c\u6d41 socket \u4e0a\u63a5\u53d7\u4e00\u4e2a\u63a5\u5165\u8fde\u63a5\u3002\u5982\u679c\u5728\u8c03\u7528<code>accept()</code>\u65f6\u4e0d\u5b58\u5728\u672a\u51b3\u7684\u8fde\u63a5,\u90a3\u4e48\u8c03\u7528\u5c31\u4f1a\u963b\u585e\u76f4\u5230\u6709\u8fde\u63a5\u8bf7\u6c42\u5230\u8fbe\u4e3a\u6b62\u3002</p> <pre><code>#include &lt;sys/socket.h&gt;\n\nint accept(int sockfd, struct sockaddr *addr, socklen_t *addrlen);// Returns file descriptor on success, or -1 on error\n</code></pre> <p>\u8fde\u63a5\u5230\u5bf9\u7b49 socket\uff1aconnect()</p> <p>TCP</p> <p>connect()\u7cfb\u7edf\u8c03\u7528\u5c06\u6587\u4ef6\u63cf\u8ff0\u7b26 sockfd \u5f15\u7528\u7684\u4e3b\u52a8 socket \u8fde\u63a5\u5230\u5730\u5740\u901a\u8fc7 addr \u548c addrlen\u6307\u5b9a\u7684\u76d1\u542c socket \u4e0a\u3002</p> <pre><code>#include &lt;sys/socket.h&gt;\n\nint connect(int sockfd, const struct sockaddr *addr, socklen_t addrlen);// Returns 0 on success, or -1 on error\n</code></pre> <p>\u8fde\u63a5\u7ec8\u6b62\uff1aclose()</p> <p>\u7ec8\u6b62\u4e00\u4e2a\u6d41 socket \u8fde\u63a5\u7684\u5e38\u89c1\u65b9\u5f0f\u662f\u8c03\u7528 close()\u3002\u5982\u679c\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u5f15\u7528\u4e86\u540c\u4e00\u4e2asocket,\u90a3\u4e48\u5f53\u6240\u6709\u63cf\u8ff0\u7b26\u88ab\u5173\u95ed\u4e4b\u540e\u8fde\u63a5\u5c31\u4f1a\u7ec8\u6b62\u3002</p> <p>sendto()</p> <p>UDP</p> <p>sendto\u662f\u4e00\u4e2a\u7f51\u7edc\u7f16\u7a0b\u4e2d\u7528\u4e8e\u53d1\u9001\u6570\u636e\u7684\u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u5411\u6307\u5b9a\u7684\u76ee\u7684\u5730\u5740\u53d1\u9001\u6570\u636e\uff0c\u5e76\u4e14\u652f\u6301\u5728UDP\u548cRaw Socket\u4e2d\u4f7f\u7528\u3002\u5728Linux\u4e2d\uff0csendto\u51fd\u6570\u901a\u5e38\u7528\u4e8e\u53d1\u9001\u6570\u636e\u62a5\u6587\u5230\u6307\u5b9a\u7684\u76ee\u7684\u5730\u5740\uff0c\u53ef\u4ee5\u662fIPv4\u6216IPv6\u5730\u5740\u3002</p> <p>sendto\u51fd\u6570\u7684\u539f\u578b\u5982\u4e0b\uff1a <pre><code>ssize_t sendto(int sockfd, const void *buf, size_t len, int flags, const struct sockaddr *dest_addr, socklen_t addrlen);\n</code></pre> \u53c2\u6570\u8bf4\u660e\uff1a - sockfd\uff1a\u6307\u5b9a\u53d1\u9001\u6570\u636e\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26\u3002 - buf\uff1a\u6307\u5411\u8981\u53d1\u9001\u6570\u636e\u7684\u7f13\u51b2\u533a\u7684\u6307\u9488\u3002 - len\uff1a\u8981\u53d1\u9001\u7684\u6570\u636e\u7684\u957f\u5ea6\u3002 - flags\uff1a\u6307\u5b9a\u53d1\u9001\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u901a\u5e38\u53ef\u4ee5\u8bbe\u7f6e\u4e3a0\u3002 - dest_addr\uff1a\u6307\u5b9a\u76ee\u7684\u5730\u5740\u7684sockaddr\u7ed3\u6784\u4f53\u6307\u9488\uff0c\u5305\u62ec\u76ee\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002 - addrlen\uff1adest_addr\u7ed3\u6784\u4f53\u7684\u957f\u5ea6\u3002</p> <p>\u6210\u529f\u8c03\u7528sendto\u51fd\u6570\u540e\uff0c\u6570\u636e\u5c06\u88ab\u53d1\u9001\u5230\u6307\u5b9a\u7684\u76ee\u7684\u5730\u5740\u3002\u5982\u679c\u51fd\u6570\u8c03\u7528\u6210\u529f\uff0c\u5b83\u5c06\u8fd4\u56de\u5df2\u53d1\u9001\u7684\u5b57\u8282\u6570\uff0c\u5982\u679c\u53d1\u751f\u9519\u8bef\uff0c\u5219\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u53d8\u91cf\u4ee5\u6307\u793a\u9519\u8bef\u7c7b\u578b\u3002</p> <p>recvfrom()</p> <p>UDP</p> <p>recvfrom\u51fd\u6570\u7528\u4e8e\u4ece\u4e00\u4e2a\u5df2\u8fde\u63a5\u7684\u5957\u63a5\u5b57\u4e0a\u63a5\u6536\u6570\u636e\uff0c\u5e76\u540c\u65f6\u83b7\u53d6\u53d1\u9001\u6570\u636e\u7684\u4e3b\u673a\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002\u5b83\u7684\u539f\u578b\u5982\u4e0b\uff1a</p> <pre><code>ssize_t recvfrom(int sockfd, void *buf, size_t len, int flags, struct sockaddr *src_addr, socklen_t *addrlen);\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li>sockfd\uff1a\u8981\u63a5\u6536\u6570\u636e\u7684\u5df2\u8fde\u63a5\u5957\u63a5\u5b57\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</li> <li>buf\uff1a\u7528\u4e8e\u5b58\u653e\u63a5\u6536\u6570\u636e\u7684\u7f13\u51b2\u533a\u3002</li> <li>len\uff1abuf\u7684\u5927\u5c0f\u3002</li> <li>flags\uff1a\u63a5\u6536\u64cd\u4f5c\u7684\u6807\u5fd7\u3002\u901a\u5e38\u8bbe\u7f6e\u4e3a0\u3002</li> <li>src_addr\uff1a\u7528\u4e8e\u5b58\u653e\u53d1\u9001\u6570\u636e\u7684\u4e3b\u673a\u5730\u5740\u4fe1\u606f\u7684\u7ed3\u6784\u4f53\u6307\u9488\u3002</li> <li>addrlen\uff1asrc_addr\u7684\u5927\u5c0f\u3002</li> </ul> <p>recvfrom\u51fd\u6570\u8fd4\u56de\u63a5\u6536\u5230\u7684\u5b57\u8282\u6570\uff0c\u5982\u679c\u8fd4\u56de0\u8868\u793a\u8fde\u63a5\u5df2\u7ecf\u5173\u95ed\uff0c-1\u8868\u793a\u51fa\u9519\u3002</p> <ul> <li>\u7531\u4e8eUDP\u662f\u4e0d\u9762\u5411\u8fde\u63a5\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u9664\u4e86\u83b7\u53d6\u5230\u6570\u636e\u4ee5\u5916\u8fd8\u9700\u8981\u83b7\u53d6\u5230\u5bf9\u7aef\u7f51\u7edc\u76f8\u5173\u7684\u5c5e\u6027\u4fe1\u606f\uff0c\u5305\u62ecIP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u7b49\u3002</li> <li>\u5728\u8c03\u7528recvfrom\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u5fc5\u987b\u5c06addrlen\u8bbe\u7f6e\u4e3a\u4f60\u8981\u8bfb\u53d6\u7684\u7ed3\u6784\u4f53\u5bf9\u5e94\u7684\u5927\u5c0f\u3002</li> <li>\u7531\u4e8erecvfrom\u51fd\u6570\u63d0\u4f9b\u7684\u53c2\u6570\u4e5f\u662fstruct sockaddr_\u7c7b\u578b\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u5728\u4f20\u5165\u7ed3\u6784\u4f53\u5730\u5740\u65f6\u9700\u8981\u5c06struct sockaddr_in_\u7c7b\u578b\u8fdb\u884c\u5f3a\u8f6c\u3002</li> </ul> <p>[!tip]  sendto\u51fd\u6570\u7528\u4e8e\u5411\u6307\u5b9a\u7684\u76ee\u6807\u5730\u5740\u53d1\u9001\u6570\u636e\uff0c\u5e38\u7528\u4e8eUDP\u901a\u4fe1\uff0c\u53ef\u4ee5\u6307\u5b9a\u6570\u636e\u7684\u76ee\u6807\u5730\u5740\u548c\u7aef\u53e3\u3002</p> <p>accept\u51fd\u6570\u7528\u4e8e\u5728\u670d\u52a1\u5668\u7aef\u63a5\u53d7\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u5f53\u6709\u65b0\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u670d\u52a1\u5668\u65f6\uff0c\u670d\u52a1\u5668\u8c03\u7528accept\u51fd\u6570\u6765\u5efa\u7acb\u4e00\u4e2a\u4e0e\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u5957\u63a5\u5b57\u7528\u4e8e\u4e0e\u5ba2\u6237\u7aef\u901a\u4fe1\u3002</p> <p>htons()\u3001htonl()\u3001ntohs()\u4ee5\u53ca ntohl()\u51fd\u6570\u88ab\u5b9a\u4e49(\u901a\u5e38\u4e3a\u5b8f)\u7528\u6765\u5728\u4e3b\u673a\u548c\u7f51\u7edc\u5b57\u8282\u5e8f\u4e4b\u95f4\u8f6c\u6362\u6574\u6570\u3002</p> <pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n\n// host to network\nuint16_t htons(uint16_t host_uint16);\n\nuint32_t htonl(uint32_t host_uint32);\n\n// network to host\nuint16_t ntohs(uint16_t net_uint16);\n\nuint32_t ntohl(uint32_t net_uint32);\n</code></pre> <p>Internet socket \u5730\u5740</p> <p><code>struct sockadd_in</code></p> <pre><code>#include &lt;arpa/inet.h&gt;\n\nstruct in_addr {        // IPv4 4-byte address\n    in_addr_t s_addr;   // Unsigned 32-bit integer\n}\n\nstruct sockaddr_in {\n    sa_family_t    sin_family;\n    in_port_t      sin_port;\n    struct in_addr sin_addr;\n    unsigned char  __pad[X];\n}\n</code></pre> <p>example</p> <p>server\u7aef <pre><code>    struct sockaddr_in server_addr;\n\n    memset(&amp;serv_addr, 0, sizeof(serv_addr));\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = htonl(INADDR_ANY);\n    serv_addr.sin_port = htons(atoi(argv[1])); // port \u7aef\u53e3\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#server","title":"server","text":"<p>\u670d\u52a1\u5668\u7aef\u4ee3\u7801\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define PORT 8080\n#define BUFFER_SIZE 1024\n\nint main() {\n    int server_fd, client_fd;\n    struct sockaddr_in server_addr, client_addr;\n    socklen_t client_addr_len = sizeof(client_addr);\n    char buffer[BUFFER_SIZE];\n\n    // \u521b\u5efa\u5957\u63a5\u5b57\n    server_fd = socket(AF_INET, SOCK_STREAM, 0);\n    if (server_fd == -1) {\n        perror(\"socket\");\n        exit(EXIT_FAILURE);\n    }\n\n    // \u8bbe\u7f6e\u670d\u52a1\u5668\u5730\u5740\u548c\u7aef\u53e3\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_addr.s_addr = INADDR_ANY;\n    server_addr.sin_port = htons(PORT);\n\n    // \u7ed1\u5b9a\u5957\u63a5\u5b57\u5230\u670d\u52a1\u5668\u5730\u5740\u548c\u7aef\u53e3\n    if (bind(server_fd, (struct sockaddr *)&amp;server_addr, sizeof(server_addr)) == -1) {\n        perror(\"bind\");\n        exit(EXIT_FAILURE);\n    }\n\n    // \u76d1\u542c\u8fde\u63a5\u8bf7\u6c42\n    if (listen(server_fd, 5) == -1) {\n        perror(\"listen\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Server listening on port %d...\\n\", PORT);\n\n    // \u63a5\u53d7\u5ba2\u6237\u7aef\u8fde\u63a5\n    client_fd = accept(server_fd, (struct sockaddr *)&amp;client_addr, &amp;client_addr_len);\n    if (client_fd == -1) {\n        perror(\"accept\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Client connected: %s:%d\\n\", inet_ntoa(client_addr.sin_addr), ntohs(client_addr.sin_port));\n\n    // \u63a5\u6536\u5e76\u6253\u5370\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u6d88\u606f\n    while (1) {\n        memset(buffer, 0, BUFFER_SIZE);\n        if (recv(client_fd, buffer, BUFFER_SIZE, 0) == -1) {\n            perror(\"recv\");\n            exit(EXIT_FAILURE);\n        }\n\n        if (strcmp(buffer, \"exit\\n\") == 0) {\n            break;\n        }\n\n        printf(\"Received message: %s\", buffer);\n    }\n\n    // \u5173\u95ed\u8fde\u63a5\n    close(client_fd);\n    close(server_fd);\n\n    printf(\"Server disconnected.\\n\");\n\n    return 0;\n}\n</code></pre> <p>\u5ba2\u6237\u7aef\u4ee3\u7801\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define SERVER_IP \"127.0.0.1\"\n#define PORT 8080\n#define BUFFER_SIZE 1024\n\nint main() {\n    int client_fd;\n    struct sockaddr_in server_addr;\n    char buffer[BUFFER_SIZE];\n\n    // \u521b\u5efa\u5957\u63a5\u5b57\n    client_fd = socket(AF_INET, SOCK_STREAM, 0);\n    if (client_fd == -1) {\n        perror(\"socket\");\n        exit(EXIT_FAILURE);\n    }\n\n    // \u8bbe\u7f6e\u670d\u52a1\u5668\u5730\u5740\u548c\u7aef\u53e3\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_addr.s_addr = inet_addr(SERVER_IP);\n    server_addr.sin_port = htons(PORT);\n\n    // \u8fde\u63a5\u670d\u52a1\u5668\n    if (connect(client_fd, (struct sockaddr *)&amp;server_addr, sizeof(server_addr)) == -1) {\n        perror(\"connect\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"Connected to server: %s:%d\\n\", SERVER_IP, PORT);\n\n    // \u53d1\u9001\u6d88\u606f\u7ed9\u670d\u52a1\u5668\n    while (1) {\n        printf(\"Enter a message (or 'exit' to quit): \");\n        fgets(buffer, BUFFER_SIZE, stdin);\n\n        if (send(client_fd, buffer, strlen(buffer), 0) == -1) {\n            perror(\"send\");\n            exit(EXIT_FAILURE);\n        }\n\n        if (strcmp(buffer, \"exit\\n\") == 0) {\n            break;\n        }\n    }\n\n    // \u5173\u95ed\u8fde\u63a5\n    close(client_fd);\n\n    printf(\"Disconnected from server.\\n\");\n\n    return 0;\n}\n</code></pre> <p>helloserver.c <pre><code>#include &lt;netinet/in.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid error_handing(char *message);\n\n\n// ./build/server 9091 \n\nint main(int argc, char *argv[]) \n{\n    int serv_sock;\n    int clnt_sock;\n\n    struct sockaddr_in serv_addr;\n    struct sockaddr_in clnt_addr;\n\n    socklen_t clnt_addr_size;\n\n    char message[] = \"Hello, World!\";\n\n    if (argc != 2) \n    {\n        printf(\"Usage : %s &lt;port&gt;\\n\", argv[0]);\n        exit(1);\n    }\n\n    serv_sock = socket(PF_INET, SOCK_STREAM, 0);\n\n    if (serv_sock == -1) {\n        error_handing(\"socket() error\");\n    }\n\n    memset(&amp;serv_addr, 0, sizeof(serv_addr));\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = htonl(INADDR_ANY);\n    serv_addr.sin_port = htons(atoi(argv[1]));\n\n    if (bind(serv_sock, (struct sockaddr*) &amp;serv_addr, sizeof(serv_addr)) == -1)\n    {\n        error_handing(\"bind() error\");\n    }\n\n    if (listen(serv_sock, 5) == -1)\n    {\n        error_handing(\"listen() error\");\n    }\n\n    clnt_addr_size = sizeof(clnt_addr);\n    clnt_sock = accept(serv_sock, (struct sockaddr*)&amp;clnt_addr, &amp;clnt_addr_size);\n\n    if (clnt_sock == -1) {\n        error_handing(\"accept() error\");\n    }\n\n    write(clnt_sock, message, sizeof(message));\n    close(clnt_sock);\n    close(serv_sock);\n\n    return 0;\n\n}\n\n\n\nvoid error_handing(char *message) {\n    fputs(message, stderr);\n    fputc('\\n', stderr);\n    exit(1);\n\n}\n</code></pre></p> <p>helloclient.c <pre><code>#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n\nvoid error_handing(char *message);\n\n//  ./build/client 127.0.0.1 9091\n\nint main(int argc, char* argv[]) {\n    int sock;\n    struct sockaddr_in serv_addr;\n    char message[30];\n    int str_len;\n\n    if (argc != 3) {\n        printf(\"Usage : %s &lt;IP&gt; &lt;port&gt;\\n\", argv[0]);\n        exit(1);\n    }\n\n    sock = socket(PF_INET, SOCK_STREAM, 0);\n\n    if (sock == -1) \n        error_handing(\"socket() error\");\n\n    memset(&amp;serv_addr, 0, sizeof(serv_addr));\n    serv_addr.sin_family = AF_INET;\n    serv_addr.sin_addr.s_addr = inet_addr(argv[1]);\n    serv_addr.sin_port = htons(atoi(argv[2]));\n\n    if (connect(sock, (struct sockaddr*)&amp;serv_addr, sizeof(serv_addr)) == -1)\n        error_handing(\"connect() error!\");\n\n    str_len = read(sock, message, sizeof(message) - 1);\n    if (str_len == -1)\n        error_handing(\"read() error\");\n\n    printf(\"Message from server : %s \\n\", message);\n    close(sock);\n    return 0;\n}\n\n\nvoid error_handing(char *message) {\n    fputs(message, stderr);\n    fputc('\\n', stderr);\n    exit(1);\n\n}\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/Linux%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#epollserver","title":"\u4f7f\u7528epoll\u7684server","text":"<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/epoll.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/tcp.h&gt;\n\n#define MAX_EVENTS 10\n#define PORT 8080\n\n/* \u8bbe\u7f6e\u5957\u63a5\u5b57\u4e3a\u975e\u963b\u585e */\nint make_socket_non_blocking(int sfd) {\n    int flags = fcntl(sfd, F_GETFL, 0);\n    if (flags == -1) {\n        perror(\"fcntl\");\n        return -1;\n    }\n\n    flags |= O_NONBLOCK;\n    if (fcntl(sfd, F_SETFL, flags) == -1) {\n        perror(\"fcntl\");\n        return -1;\n    }\n\n    return 0;\n}\n\nint main() {\n    /* \u521b\u5efa\u5957\u63a5\u5b57\uff0c\u8bbe\u7f6e\u5957\u63a5\u5b57\u9009\u9879\uff0c\u7ed1\u5b9a\u548c\u76d1\u542c */\n    int sfd, s;\n    int efd;\n    struct epoll_event event;\n    struct epoll_event *events;\n\n    sfd = socket(AF_INET, SOCK_STREAM, 0);\n    if (sfd == -1) {\n        perror(\"socket\");\n        exit(EXIT_FAILURE);\n    }\n\n    make_socket_non_blocking(sfd);\n\n    int optval = 1;\n    setsockopt(sfd, SOL_SOCKET, SO_REUSEADDR, &amp;optval, sizeof(optval));\n\n    struct sockaddr_in addr;\n    memset(&amp;addr, 0, sizeof(struct sockaddr_in));\n    addr.sin_family = AF_INET;\n    addr.sin_addr.s_addr = INADDR_ANY;\n    addr.sin_port = htons(PORT);\n\n    if (bind(sfd, (struct sockaddr *)&amp;addr, sizeof(struct sockaddr_in)) == -1) {\n        perror(\"bind\");\n        exit(EXIT_FAILURE);\n    }\n\n    if (listen(sfd, SOMAXCONN) == -1) {\n        perror(\"listen\");\n        exit(EXIT_FAILURE);\n    }\n\n    /* \u521b\u5efaepoll\u5b9e\u4f8b\uff0c\u7136\u540e\u6dfb\u52a0\u76d1\u542csocket\u5230\u4e8b\u4ef6\u5217\u8868 */\n    efd = epoll_create1(0);\n    if (efd == -1) {\n        perror(\"epoll_create\");\n        exit(EXIT_FAILURE);\n    }\n\n    event.data.fd = sfd;\n    event.events = EPOLLIN | EPOLLET;\n    s = epoll_ctl(efd, EPOLL_CTL_ADD, sfd, &amp;event);\n    if (s == -1) {\n        perror(\"epoll_ctl\");\n        exit(EXIT_FAILURE);\n    }\n\n    /* \u7f13\u51b2\u533a\uff0c\u7528\u4e8e\u5b58\u653eepoll\u8fd4\u56de\u7684\u4e8b\u4ef6 */\n    events = calloc(MAX_EVENTS, sizeof(event));\n\n    /* \u4e8b\u4ef6\u5faa\u73af */\n    while (1) {\n        /* \u7b49\u5f85\u4e8b\u4ef6\u53d1\u751f */\n        int n, i;\n        n = epoll_wait(efd, events, MAX_EVENTS, -1);\n        for (i = 0; i &lt; n; i++) {\n            if ((events[i].events &amp; EPOLLERR) ||\n                (events[i].events &amp; EPOLLHUP) ||\n                (!(events[i].events &amp; EPOLLIN))) {\n                /* \u53d1\u751f\u9519\u8bef\uff0c\u6216\u8005socket\u672a\u5c31\u7eea\uff0c\u5173\u95ed\u8fd9\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26 */\n                fprintf(stderr, \"epoll error\\n\");\n                close(events[i].data.fd);\n                continue;\n            } else if (sfd == events[i].data.fd) {\n                /* \u76d1\u542csocket\u6536\u5230\u901a\u77e5\uff0c\u8868\u793a\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5c06\u8981\u5165\u7ad9\u8fde\u63a5 */\n                while (1) {\n                    /* \u63a5\u6536\u8fde\u63a5\uff0c\u5e76\u5c06\u65b0\u7684socket\u6dfb\u52a0\u5230epoll\u4e8b\u4ef6\u5217\u8868 */\n                    struct sockaddr in_addr;\n                    socklen_t in_len = sizeof(in_addr);\n                    int infd = accept(sfd, &amp;in_addr, &amp;in_len);\n                    if (infd == -1) {\n                        if ((errno == EAGAIN) ||\n                            (errno == EWOULDBLOCK)) {\n                            /* \u6240\u6709\u8fde\u63a5\u5df2\u7ecf\u5904\u7406\u5b8c\u6bd5 */\n                            break;\n                        } else {\n                            perror(\"accept\");\n                            break;\n                        }\n                    }\n\n                    /* \u8bbe\u7f6e\u65b0\u7684socket\u4e3a\u975e\u963b\u585e\uff0c\u7136\u540e\u5c06\u5b83\u6dfb\u52a0\u5230epoll\u7684\u4e8b\u4ef6\u5217\u8868 */\n                    make_socket_non_blocking(infd);\n\n                    event.data.fd = infd;\n                    event.events = EPOLLIN | EPOLLET;\n                    s = epoll_ctl(efd, EPOLL_CTL_ADD, infd, &amp;event);\n                    if (s == -1) {\n                        perror(\"epoll_ctl\");\n                        exit(EXIT_FAILURE);\n                    }\n                }\n                continue;\n            } else {\n                /* fd\u4e0a\u6709\u6570\u636e\u7b49\u5f85\u8bfb\u53d6 */\n                int done = 0;\n\n                while (1) {\n                    ssize_t count;\n                    char buf[512];\n                    count = read(events[i].data.fd, buf, sizeof buf);\n                    if (count == -1) {\n                        /* \u5982\u679cerrno\u7b49\u4e8eEAGAIN\uff0c\u8bf4\u660e\u6211\u4eec\u5df2\u7ecf\u8bfb\u53d6\u4e86\u6240\u6709\u6570\u636e\uff0c\u6b64\u65f6\u8fd4\u56de\u5230\u4e3b\u5faa\u73af */\n                        if (errno != EAGAIN) {\n                            perror(\"read\");\n                            done = 1;\n                        }\n                        break;\n                    } else if (count == 0) {\n                        /* \u6587\u4ef6\u7ed3\u675f\u7b26\uff0c\u8868\u793a\u8fdc\u7a0b\u5df2\u5173\u95ed\u8fde\u63a5 */\n                        done = 1;\n                        break;\n                    }\n\n                    /* \u5c06\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u5199\u5165\u6807\u51c6\u8f93\u51fa */\n                    s = write(1, buf, count);\n                    if (s == -1) {\n                        perror(\"write\");\n                        exit(EXIT_FAILURE);\n                    }\n\n                    /* \u5411\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2a\u57fa\u672c\u7684HTTP\u54cd\u5e94 */\n                    char response[] = \"HTTP/1.1 200 OK\\r\\nContent-Length: 14\\r\\nContent-Type: text/plain\\r\\n\\r\\nHello, world!\\n\";\n                    write(events[i].data.fd, response, sizeof(response) - 1);\n                }\n\n                if (done) {\n                    printf(\"Closed connection on descriptor %d\\n\", events[i].data.fd);\n\n                    /* \u5173\u95ed\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0cepoll\u4f1a\u5c06\u5176\u4ece\u76d1\u63a7\u5217\u8868\u4e2d\u5220\u9664 */\n                    close(events[i].data.fd);\n                }\n            }\n        }\n    }\n\n    free(events);\n    close(sfd);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/","title":"connect\u3001listen\u548caccept","text":"<p><code>connect</code>\u3001<code>listen</code> \u548c <code>accept</code> \u662f Linux \u7f51\u7edc\u7f16\u7a0b\u4e2d\u7528\u4e8e TCP \u901a\u4fe1\u7684\u4e09\u4e2a\u5173\u952e\u7cfb\u7edf\u8c03\u7528\uff0c\u5b83\u4eec\u7684\u4f5c\u7528\u548c\u4f7f\u7528\u573a\u666f\u5404\u4e0d\u76f8\u540c\u3002\u4ee5\u4e0b\u662f\u5b83\u4eec\u7684\u533a\u522b\u3001\u5f02\u540c\u4ee5\u53ca\u4e3a\u4ec0\u4e48 <code>connect</code> \u4e0d\u80fd\u66ff\u4ee3 <code>listen</code> \u548c <code>accept</code> \u7684\u8be6\u7ec6\u89e3\u91ca\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#1-connectlisten-accept","title":"1. <code>connect</code>\u3001<code>listen</code> \u548c <code>accept</code> \u7684\u533a\u522b","text":"\u51fd\u6570 \u4f5c\u7528 \u4f7f\u7528\u573a\u666f \u8c03\u7528\u8005 <code>connect</code> \u5ba2\u6237\u7aef\u4e3b\u52a8\u8fde\u63a5\u5230\u670d\u52a1\u7aef\u3002 \u5ba2\u6237\u7aef \u5ba2\u6237\u7aef <code>listen</code> \u670d\u52a1\u7aef\u5c06\u5957\u63a5\u5b57\u8bbe\u7f6e\u4e3a\u76d1\u542c\u72b6\u6001\uff0c\u7b49\u5f85\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42\u3002 \u670d\u52a1\u7aef \u670d\u52a1\u7aef <code>accept</code> \u670d\u52a1\u7aef\u4ece\u76d1\u542c\u5957\u63a5\u5b57\u7684\u8fde\u63a5\u961f\u5217\u4e2d\u53d6\u51fa\u4e00\u4e2a\u5df2\u5b8c\u6210\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u5e76\u521b\u5efa\u65b0\u5957\u63a5\u5b57\u3002 \u670d\u52a1\u7aef \u670d\u52a1\u7aef"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#2-connectlisten-accept","title":"2. <code>connect</code>\u3001<code>listen</code> \u548c <code>accept</code> \u7684\u5f02\u540c","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#21","title":"2.1 \u76f8\u540c\u70b9","text":"<ul> <li>\u90fd\u662f\u7528\u4e8e TCP \u7f51\u7edc\u901a\u4fe1\u7684\u7cfb\u7edf\u8c03\u7528\u3002</li> <li>\u90fd\u9700\u8981\u4e00\u4e2a\u5df2\u521b\u5efa\u7684\u5957\u63a5\u5b57\uff08\u901a\u8fc7 <code>socket</code> \u521b\u5efa\uff09\u3002</li> <li>\u90fd\u6d89\u53ca\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4e4b\u95f4\u7684\u8fde\u63a5\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#22","title":"2.2 \u4e0d\u540c\u70b9","text":"\u7279\u6027 <code>connect</code> <code>listen</code> <code>accept</code> \u8c03\u7528\u8005 \u5ba2\u6237\u7aef \u670d\u52a1\u7aef \u670d\u52a1\u7aef \u4f5c\u7528 \u4e3b\u52a8\u8fde\u63a5\u5230\u670d\u52a1\u7aef \u8bbe\u7f6e\u5957\u63a5\u5b57\u4e3a\u76d1\u542c\u72b6\u6001 \u63a5\u53d7\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42 \u53c2\u6570 \u670d\u52a1\u7aef\u5730\u5740\u548c\u7aef\u53e3 \u8fde\u63a5\u961f\u5217\u7684\u6700\u5927\u957f\u5ea6 \u5ba2\u6237\u7aef\u5730\u5740\u4fe1\u606f\uff08\u53ef\u9009\uff09 \u8fd4\u56de\u503c \u6210\u529f\u8fd4\u56de <code>0</code>\uff0c\u5931\u8d25\u8fd4\u56de <code>-1</code> \u6210\u529f\u8fd4\u56de <code>0</code>\uff0c\u5931\u8d25\u8fd4\u56de <code>-1</code> \u6210\u529f\u8fd4\u56de\u65b0\u5957\u63a5\u5b57\uff0c\u5931\u8d25\u8fd4\u56de <code>-1</code> \u963b\u585e\u884c\u4e3a \u963b\u585e\u76f4\u5230\u8fde\u63a5\u6210\u529f\u6216\u5931\u8d25 \u975e\u963b\u585e\uff0c\u4ec5\u8bbe\u7f6e\u76d1\u542c\u72b6\u6001 \u963b\u585e\u76f4\u5230\u6709\u8fde\u63a5\u8bf7\u6c42\u5230\u8fbe \u4f7f\u7528\u987a\u5e8f \u5ba2\u6237\u7aef\u5728 <code>socket</code> \u540e\u8c03\u7528 \u670d\u52a1\u7aef\u5728 <code>bind</code> \u540e\u8c03\u7528 \u670d\u52a1\u7aef\u5728 <code>listen</code> \u540e\u8c03\u7528"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#3-connect-listen-accept","title":"3. <code>connect</code> \u80fd\u5426\u66ff\u4ee3 <code>listen</code> \u548c <code>accept</code>\uff1f","text":"<p>\u4e0d\u80fd\uff0c\u539f\u56e0\u5982\u4e0b\uff1a</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#31","title":"3.1 \u529f\u80fd\u4e0d\u540c","text":"<ul> <li><code>connect</code> \u662f\u5ba2\u6237\u7aef\u4e3b\u52a8\u8fde\u63a5\u5230\u670d\u52a1\u7aef\u3002</li> <li><code>listen</code> \u548c <code>accept</code> \u662f\u670d\u52a1\u7aef\u88ab\u52a8\u63a5\u53d7\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#32","title":"3.2 \u89d2\u8272\u4e0d\u540c","text":"<ul> <li><code>connect</code> \u662f\u5ba2\u6237\u7aef\u7684\u884c\u4e3a\u3002</li> <li><code>listen</code> \u548c <code>accept</code> \u662f\u670d\u52a1\u7aef\u7684\u884c\u4e3a\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#33","title":"3.3 \u901a\u4fe1\u65b9\u5411\u4e0d\u540c","text":"<ul> <li><code>connect</code> \u662f\u5355\u5411\u7684\uff08\u5ba2\u6237\u7aef \u2192 \u670d\u52a1\u7aef\uff09\u3002</li> <li><code>listen</code> \u548c <code>accept</code> \u662f\u53cc\u5411\u7684\uff08\u670d\u52a1\u7aef \u2190 \u5ba2\u6237\u7aef\uff09\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#34","title":"3.4 \u5b9e\u73b0\u673a\u5236\u4e0d\u540c","text":"<ul> <li><code>connect</code> \u76f4\u63a5\u53d1\u8d77 TCP \u4e09\u6b21\u63e1\u624b\u3002</li> <li><code>listen</code> \u8bbe\u7f6e\u5957\u63a5\u5b57\u4e3a\u76d1\u542c\u72b6\u6001\uff0c\u5e76\u521b\u5efa\u8fde\u63a5\u961f\u5217\u3002</li> <li><code>accept</code> \u4ece\u8fde\u63a5\u961f\u5217\u4e2d\u53d6\u51fa\u5df2\u5b8c\u6210\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u5e76\u521b\u5efa\u65b0\u7684\u5957\u63a5\u5b57\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#4-listen-accept","title":"4. \u4e3a\u4ec0\u4e48\u9700\u8981 <code>listen</code> \u548c <code>accept</code>\uff1f","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#41-listen","title":"4.1 <code>listen</code> \u7684\u4f5c\u7528","text":"<ul> <li>\u5c06\u5957\u63a5\u5b57\u8bbe\u7f6e\u4e3a\u76d1\u542c\u72b6\u6001\uff0c\u4f7f\u5176\u80fd\u591f\u63a5\u53d7\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42\u3002</li> <li>\u521b\u5efa\u8fde\u63a5\u961f\u5217\uff0c\u7528\u4e8e\u5b58\u653e\u672a\u5904\u7406\u7684\u8fde\u63a5\u8bf7\u6c42\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#42-accept","title":"4.2 <code>accept</code> \u7684\u4f5c\u7528","text":"<ul> <li>\u4ece\u8fde\u63a5\u961f\u5217\u4e2d\u53d6\u51fa\u4e00\u4e2a\u5df2\u5b8c\u6210\u7684\u8fde\u63a5\u8bf7\u6c42\u3002</li> <li>\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5957\u63a5\u5b57\uff0c\u7528\u4e8e\u4e0e\u5ba2\u6237\u7aef\u8fdb\u884c\u6570\u636e\u901a\u4fe1\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#43-listen-accept","title":"4.3 \u5982\u679c\u6ca1\u6709 <code>listen</code> \u548c <code>accept</code>","text":"<ul> <li>\u670d\u52a1\u7aef\u65e0\u6cd5\u63a5\u53d7\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42\u3002</li> <li>\u5ba2\u6237\u7aef\u5373\u4f7f\u8c03\u7528 <code>connect</code>\uff0c\u4e5f\u65e0\u6cd5\u6210\u529f\u8fde\u63a5\u5230\u670d\u52a1\u7aef\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#5","title":"5. \u793a\u4f8b\u5bf9\u6bd4","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#51-connect","title":"5.1 \u5ba2\u6237\u7aef\u4f7f\u7528 <code>connect</code>","text":"<pre><code>int sockfd = socket(AF_INET, SOCK_STREAM, 0);\nstruct sockaddr_in server_addr;\nserver_addr.sin_family = AF_INET;\nserver_addr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\nserver_addr.sin_port = htons(8080);\n\nconnect(sockfd, (struct sockaddr *)&amp;server_addr, sizeof(server_addr));\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#52-listen-accept","title":"5.2 \u670d\u52a1\u7aef\u4f7f\u7528 <code>listen</code> \u548c <code>accept</code>","text":"<pre><code>int sockfd = socket(AF_INET, SOCK_STREAM, 0);\nstruct sockaddr_in server_addr;\nserver_addr.sin_family = AF_INET;\nserver_addr.sin_addr.s_addr = htonl(INADDR_ANY);\nserver_addr.sin_port = htons(8080);\n\nbind(sockfd, (struct sockaddr *)&amp;server_addr, sizeof(server_addr));\nlisten(sockfd, 10);\n\nstruct sockaddr_in client_addr;\nsocklen_t client_len = sizeof(client_addr);\nint connfd = accept(sockfd, (struct sockaddr *)&amp;client_addr, &amp;client_len);\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/connect%E3%80%81listen%E5%92%8Caccept/#6","title":"6. \u603b\u7ed3","text":"<ul> <li><code>connect</code>\u3001<code>listen</code> \u548c <code>accept</code> \u662f TCP \u7f51\u7edc\u7f16\u7a0b\u4e2d\u4e0d\u53ef\u6216\u7f3a\u7684\u4e09\u4e2a\u7cfb\u7edf\u8c03\u7528\uff0c\u5206\u522b\u7528\u4e8e\u5ba2\u6237\u7aef\u8fde\u63a5\u3001\u670d\u52a1\u7aef\u76d1\u542c\u548c\u63a5\u53d7\u8fde\u63a5\u3002</li> <li><code>connect</code> \u4e0d\u80fd\u66ff\u4ee3 <code>listen</code> \u548c <code>accept</code>\uff0c\u56e0\u4e3a\u5b83\u4eec\u7684\u529f\u80fd\u3001\u89d2\u8272\u548c\u4f7f\u7528\u573a\u666f\u5b8c\u5168\u4e0d\u540c\u3002</li> <li>\u670d\u52a1\u7aef\u5fc5\u987b\u4f7f\u7528 <code>listen</code> \u548c <code>accept</code> \u6765\u63a5\u53d7\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u800c\u5ba2\u6237\u7aef\u5fc5\u987b\u4f7f\u7528 <code>connect</code> \u6765\u4e3b\u52a8\u8fde\u63a5\u5230\u670d\u52a1\u7aef\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/","title":"epoll","text":"<p><code>epoll</code> \u662f Linux \u63d0\u4f9b\u7684\u4e00\u79cd\u9ad8\u6548\u7684 I/O \u4e8b\u4ef6\u901a\u77e5\u673a\u5236\uff0c\u7528\u4e8e\u76d1\u63a7\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08file descriptors\uff09\u7684\u72b6\u6001\u53d8\u5316\uff08\u5982\u53ef\u8bfb\u3001\u53ef\u5199\u3001\u9519\u8bef\u7b49\uff09\u3002\u5b83\u662f <code>select</code> \u548c <code>poll</code> \u7684\u6539\u8fdb\u7248\u672c\uff0c\u7279\u522b\u9002\u5408\u5904\u7406\u5927\u91cf\u5e76\u53d1\u8fde\u63a5\u7684\u573a\u666f\uff08\u5982\u9ad8\u6027\u80fd\u7f51\u7edc\u670d\u52a1\u5668\uff09\u3002</p> <p><code>epoll</code> \u7684\u6838\u5fc3\u601d\u60f3\u662f\uff1a\u901a\u8fc7\u5185\u6838\u4e0e\u7528\u6237\u7a7a\u95f4\u7684\u534f\u4f5c\uff0c\u9ad8\u6548\u5730\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u54ea\u4e9b\u6587\u4ef6\u63cf\u8ff0\u7b26\u5df2\u7ecf\u5c31\u7eea\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#1-epoll","title":"1. <code>epoll</code> \u7684\u6838\u5fc3\u673a\u5236","text":"<p><code>epoll</code> \u7684\u673a\u5236\u53ef\u4ee5\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\uff1a</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#11","title":"1.1 \u4e8b\u4ef6\u9a71\u52a8","text":"<ul> <li><code>epoll</code> \u662f\u4e8b\u4ef6\u9a71\u52a8\u7684\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ea\u9700\u8981\u5173\u6ce8\u611f\u5174\u8da3\u7684\u4e8b\u4ef6\uff08\u5982\u53ef\u8bfb\u3001\u53ef\u5199\uff09\uff0c\u800c\u4e0d\u9700\u8981\u4e3b\u52a8\u8f6e\u8be2\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u72b6\u6001\u3002</li> <li>\u5f53\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u72b6\u6001\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5185\u6838\u4f1a\u901a\u77e5\u5e94\u7528\u7a0b\u5e8f\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#12","title":"1.2 \u9ad8\u6548\u7684\u6570\u636e\u7ed3\u6784","text":"<ul> <li><code>epoll</code> \u4f7f\u7528\u7ea2\u9ed1\u6811\uff08Red-Black Tree\uff09\u548c\u53cc\u5411\u94fe\u8868\uff08Doubly Linked List\uff09\u6765\u7ba1\u7406\u6587\u4ef6\u63cf\u8ff0\u7b26\u548c\u4e8b\u4ef6\u3002</li> <li>\u7ea2\u9ed1\u6811\uff1a\u7528\u4e8e\u5b58\u50a8\u6240\u6709\u88ab\u76d1\u63a7\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u652f\u6301\u9ad8\u6548\u7684\u63d2\u5165\u3001\u5220\u9664\u548c\u67e5\u627e\u64cd\u4f5c\u3002</li> <li>\u53cc\u5411\u94fe\u8868\uff1a\u7528\u4e8e\u5b58\u50a8\u5c31\u7eea\u7684\u4e8b\u4ef6\uff0c\u5185\u6838\u4f1a\u5c06\u5c31\u7eea\u7684\u4e8b\u4ef6\u6dfb\u52a0\u5230\u94fe\u8868\u4e2d\uff0c\u4f9b\u5e94\u7528\u7a0b\u5e8f\u8bfb\u53d6\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#13-etlt","title":"1.3 \u8fb9\u7f18\u89e6\u53d1\uff08ET\uff09\u548c\u6c34\u5e73\u89e6\u53d1\uff08LT\uff09","text":"<ul> <li><code>epoll</code> \u652f\u6301\u4e24\u79cd\u4e8b\u4ef6\u89e6\u53d1\u6a21\u5f0f\uff1a</li> <li>\u6c34\u5e73\u89e6\u53d1\uff08Level Triggered, LT\uff09\uff1a<ul> <li>\u9ed8\u8ba4\u6a21\u5f0f\u3002</li> <li>\u53ea\u8981\u6587\u4ef6\u63cf\u8ff0\u7b26\u5904\u4e8e\u5c31\u7eea\u72b6\u6001\uff08\u5982\u7f13\u51b2\u533a\u6709\u6570\u636e\uff09\uff0c<code>epoll_wait</code> \u5c31\u4f1a\u4e0d\u65ad\u901a\u77e5\u3002</li> </ul> </li> <li>\u8fb9\u7f18\u89e6\u53d1\uff08Edge Triggered, ET\uff09\uff1a<ul> <li>\u9700\u8981\u663e\u5f0f\u8bbe\u7f6e <code>EPOLLET</code> \u6807\u5fd7\u3002</li> <li>\u53ea\u6709\u5f53\u6587\u4ef6\u63cf\u8ff0\u7b26\u72b6\u6001\u53d1\u751f\u53d8\u5316\u65f6\uff08\u5982\u4ece\u65e0\u6570\u636e\u5230\u6709\u6570\u636e\uff09\uff0c<code>epoll_wait</code> \u624d\u4f1a\u901a\u77e5\u3002</li> </ul> </li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#14","title":"1.4 \u5185\u6838\u4e0e\u7528\u6237\u7a7a\u95f4\u7684\u534f\u4f5c","text":"<ul> <li><code>epoll</code> \u901a\u8fc7\u4ee5\u4e0b\u7cfb\u7edf\u8c03\u7528\u5b9e\u73b0\u5185\u6838\u4e0e\u7528\u6237\u7a7a\u95f4\u7684\u534f\u4f5c\uff1a</li> <li><code>epoll_create</code>\uff1a\u521b\u5efa\u4e00\u4e2a <code>epoll</code> \u5b9e\u4f8b\u3002</li> <li><code>epoll_ctl</code>\uff1a\u5411 <code>epoll</code> \u5b9e\u4f8b\u4e2d\u6dfb\u52a0\u3001\u4fee\u6539\u6216\u5220\u9664\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</li> <li><code>epoll_wait</code>\uff1a\u7b49\u5f85\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u4e8b\u4ef6\u53d1\u751f\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#2-epoll","title":"2. <code>epoll</code> \u7684\u5de5\u4f5c\u6d41\u7a0b","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#21-epoll","title":"2.1 \u521b\u5efa <code>epoll</code> \u5b9e\u4f8b","text":"<ul> <li>\u4f7f\u7528 <code>epoll_create</code> \u6216 <code>epoll_create1</code> \u521b\u5efa\u4e00\u4e2a <code>epoll</code> \u5b9e\u4f8b\u3002</li> <li>\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u7528\u4e8e\u540e\u7eed\u64cd\u4f5c\u3002</li> </ul> <pre><code>int epoll_fd = epoll_create1(0);\nif (epoll_fd == -1) {\n    perror(\"epoll_create1\");\n    exit(EXIT_FAILURE);\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#22","title":"2.2 \u6ce8\u518c\u6587\u4ef6\u63cf\u8ff0\u7b26","text":"<ul> <li>\u4f7f\u7528 <code>epoll_ctl</code> \u5411 <code>epoll</code> \u5b9e\u4f8b\u4e2d\u6dfb\u52a0\u3001\u4fee\u6539\u6216\u5220\u9664\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</li> <li>\u9700\u8981\u6307\u5b9a\u611f\u5174\u8da3\u7684\u4e8b\u4ef6\u7c7b\u578b\uff08\u5982 <code>EPOLLIN</code>\u3001<code>EPOLLOUT</code>\uff09\u548c\u7528\u6237\u6570\u636e\uff08\u5982\u6587\u4ef6\u63cf\u8ff0\u7b26\uff09\u3002</li> </ul> <pre><code>struct epoll_event ev;\nev.events = EPOLLIN;  // \u76d1\u542c\u53ef\u8bfb\u4e8b\u4ef6\nev.data.fd = sockfd;  // \u5b58\u50a8\u6587\u4ef6\u63cf\u8ff0\u7b26\nif (epoll_ctl(epoll_fd, EPOLL_CTL_ADD, sockfd, &amp;ev) == -1) {\n    perror(\"epoll_ctl\");\n    exit(EXIT_FAILURE);\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#23","title":"2.3 \u7b49\u5f85\u4e8b\u4ef6","text":"<ul> <li>\u4f7f\u7528 <code>epoll_wait</code> \u7b49\u5f85\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u4e8b\u4ef6\u53d1\u751f\u3002</li> <li>\u5185\u6838\u4f1a\u5c06\u5c31\u7eea\u7684\u4e8b\u4ef6\u586b\u5145\u5230 <code>epoll_event</code> \u7ed3\u6784\u4f53\u6570\u7ec4\u4e2d\u3002</li> </ul> <pre><code>struct epoll_event events[MAX_EVENTS];\nint n = epoll_wait(epoll_fd, events, MAX_EVENTS, -1);\nif (n == -1) {\n    perror(\"epoll_wait\");\n    exit(EXIT_FAILURE);\n}\n\nfor (int i = 0; i &lt; n; i++) {\n    if (events[i].events &amp; EPOLLIN) {\n        printf(\"File descriptor %d is ready for reading.\\n\", events[i].data.fd);\n    }\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#24","title":"2.4 \u5904\u7406\u4e8b\u4ef6","text":"<ul> <li>\u6839\u636e <code>epoll_wait</code> \u8fd4\u56de\u7684\u4e8b\u4ef6\u7c7b\u578b\uff0c\u6267\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff08\u5982\u8bfb\u53d6\u6570\u636e\u3001\u5199\u5165\u6570\u636e\u3001\u5173\u95ed\u8fde\u63a5\u7b49\uff09\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#3-epoll","title":"3. <code>epoll</code> \u7684\u4f18\u52bf","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#31","title":"3.1 \u9ad8\u6548\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u7ba1\u7406","text":"<ul> <li><code>epoll</code> \u4f7f\u7528\u7ea2\u9ed1\u6811\u7ba1\u7406\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u63d2\u5165\u3001\u5220\u9664\u548c\u67e5\u627e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a O(log N)\u3002</li> <li>\u76f8\u6bd4\u4e8e <code>select</code> \u548c <code>poll</code> \u7684\u7ebf\u6027\u626b\u63cf\uff0c<code>epoll</code> \u7684\u6027\u80fd\u66f4\u9ad8\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#32","title":"3.2 \u9ad8\u6548\u7684\u4e8b\u4ef6\u901a\u77e5","text":"<ul> <li><code>epoll</code> \u4f7f\u7528\u53cc\u5411\u94fe\u8868\u5b58\u50a8\u5c31\u7eea\u7684\u4e8b\u4ef6\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ea\u9700\u8981\u904d\u5386\u5c31\u7eea\u7684\u4e8b\u4ef6\uff0c\u800c\u4e0d\u9700\u8981\u904d\u5386\u6240\u6709\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#33-et","title":"3.3 \u652f\u6301\u8fb9\u7f18\u89e6\u53d1\uff08ET\uff09","text":"<ul> <li>\u8fb9\u7f18\u89e6\u53d1\u6a21\u5f0f\u53ef\u4ee5\u51cf\u5c11\u4e8b\u4ef6\u901a\u77e5\u7684\u6b21\u6570\uff0c\u9002\u5408\u9ad8\u6027\u80fd\u573a\u666f\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#34","title":"3.4 \u652f\u6301\u5927\u91cf\u6587\u4ef6\u63cf\u8ff0\u7b26","text":"<ul> <li><code>epoll</code> \u6ca1\u6709\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u91cf\u7684\u9650\u5236\uff08\u4ec5\u53d7\u7cfb\u7edf\u8d44\u6e90\u9650\u5236\uff09\uff0c\u800c <code>select</code> \u548c <code>poll</code> \u901a\u5e38\u6709\u6587\u4ef6\u63cf\u8ff0\u7b26\u6570\u91cf\u7684\u9650\u5236\uff08\u5982 1024\uff09\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#4-epoll","title":"4. <code>epoll</code> \u7684\u5c40\u9650\u6027","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#41-linux","title":"4.1 \u4ec5\u9002\u7528\u4e8e Linux","text":"<ul> <li><code>epoll</code> \u662f Linux \u7279\u6709\u7684\u673a\u5236\uff0c\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\uff08\u5982 Windows\u3001macOS\uff09\u4e0d\u652f\u6301\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#42","title":"4.2 \u7f16\u7a0b\u590d\u6742\u5ea6\u8f83\u9ad8","text":"<ul> <li>\u76f8\u6bd4\u4e8e <code>select</code> \u548c <code>poll</code>\uff0c<code>epoll</code> \u7684\u7f16\u7a0b\u6a21\u578b\u66f4\u590d\u6742\uff0c\u5c24\u5176\u662f\u8fb9\u7f18\u89e6\u53d1\u6a21\u5f0f\u9700\u8981\u786e\u4fdd\u4e00\u6b21\u6027\u5904\u7406\u5b8c\u6240\u6709\u6570\u636e\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#5","title":"5. \u5b8c\u6574\u793a\u4f8b","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u4f7f\u7528 <code>epoll</code> \u7684\u5b8c\u6574\u793a\u4f8b\uff0c\u5c55\u793a\u4e86\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a\u7b80\u5355\u7684 TCP \u670d\u52a1\u5668\uff1a</p> <pre><code>#include &lt;sys/epoll.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define MAX_EVENTS 10\n\nint main() {\n    int listen_fd, conn_fd, epoll_fd;\n    struct sockaddr_in server_addr;\n    struct epoll_event ev, events[MAX_EVENTS];\n\n    // \u521b\u5efa\u76d1\u542c\u5957\u63a5\u5b57\n    listen_fd = socket(AF_INET, SOCK_STREAM, 0);\n    if (listen_fd == -1) {\n        perror(\"socket\");\n        exit(EXIT_FAILURE);\n    }\n\n    // \u7ed1\u5b9a\u5730\u5740\n    memset(&amp;server_addr, 0, sizeof(server_addr));\n    server_addr.sin_family = AF_INET;\n    server_addr.sin_addr.s_addr = htonl(INADDR_ANY);\n    server_addr.sin_port = htons(8080);\n    if (bind(listen_fd, (struct sockaddr *)&amp;server_addr, sizeof(server_addr)) == -1) {\n        perror(\"bind\");\n        close(listen_fd);\n        exit(EXIT_FAILURE);\n    }\n\n    // \u76d1\u542c\n    if (listen(listen_fd, 10) == -1) {\n        perror(\"listen\");\n        close(listen_fd);\n        exit(EXIT_FAILURE);\n    }\n\n    // \u521b\u5efa epoll \u5b9e\u4f8b\n    epoll_fd = epoll_create1(0);\n    if (epoll_fd == -1) {\n        perror(\"epoll_create1\");\n        close(listen_fd);\n        exit(EXIT_FAILURE);\n    }\n\n    // \u6ce8\u518c\u76d1\u542c\u5957\u63a5\u5b57\n    ev.events = EPOLLIN;\n    ev.data.fd = listen_fd;\n    if (epoll_ctl(epoll_fd, EPOLL_CTL_ADD, listen_fd, &amp;ev) == -1) {\n        perror(\"epoll_ctl\");\n        close(listen_fd);\n        close(epoll_fd);\n        exit(EXIT_FAILURE);\n    }\n\n    // \u4e8b\u4ef6\u5faa\u73af\n    while (1) {\n        int n = epoll_wait(epoll_fd, events, MAX_EVENTS, -1);\n        if (n == -1) {\n            perror(\"epoll_wait\");\n            break;\n        }\n\n        for (int i = 0; i &lt; n; i++) {\n            if (events[i].data.fd == listen_fd) {\n                // \u63a5\u53d7\u65b0\u8fde\u63a5\n                conn_fd = accept(listen_fd, NULL, NULL);\n                if (conn_fd == -1) {\n                    perror(\"accept\");\n                    continue;\n                }\n\n                // \u6ce8\u518c\u65b0\u8fde\u63a5\n                ev.events = EPOLLIN | EPOLLET;\n                ev.data.fd = conn_fd;\n                if (epoll_ctl(epoll_fd, EPOLL_CTL_ADD, conn_fd, &amp;ev) == -1) {\n                    perror(\"epoll_ctl\");\n                    close(conn_fd);\n                }\n            } else {\n                // \u5904\u7406\u53ef\u8bfb\u4e8b\u4ef6\n                char buffer[1024];\n                ssize_t count = read(events[i].data.fd, buffer, sizeof(buffer));\n                if (count == -1) {\n                    perror(\"read\");\n                } else if (count == 0) {\n                    // \u5bf9\u7aef\u5173\u95ed\u8fde\u63a5\n                    close(events[i].data.fd);\n                } else {\n                    // \u5904\u7406\u6570\u636e\n                    printf(\"Received: %s\\n\", buffer);\n                }\n            }\n        }\n    }\n\n    close(listen_fd);\n    close(epoll_fd);\n    return 0;\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#6","title":"6. \u603b\u7ed3","text":"<ul> <li><code>epoll</code> \u662f Linux \u63d0\u4f9b\u7684\u9ad8\u6548 I/O \u4e8b\u4ef6\u901a\u77e5\u673a\u5236\uff0c\u9002\u5408\u5904\u7406\u5927\u91cf\u5e76\u53d1\u8fde\u63a5\u3002</li> <li>\u5b83\u901a\u8fc7\u7ea2\u9ed1\u6811\u548c\u53cc\u5411\u94fe\u8868\u5b9e\u73b0\u9ad8\u6548\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u7ba1\u7406\u548c\u4e8b\u4ef6\u901a\u77e5\u3002</li> <li><code>epoll</code> \u652f\u6301\u6c34\u5e73\u89e6\u53d1\uff08LT\uff09\u548c\u8fb9\u7f18\u89e6\u53d1\uff08ET\uff09\u4e24\u79cd\u6a21\u5f0f\uff0c\u9002\u5408\u4e0d\u540c\u7684\u5e94\u7528\u573a\u666f\u3002</li> <li>\u76f8\u6bd4\u4e8e <code>select</code> \u548c <code>poll</code>\uff0c<code>epoll</code> \u7684\u6027\u80fd\u66f4\u9ad8\uff0c\u4f46\u7f16\u7a0b\u590d\u6742\u5ea6\u4e5f\u66f4\u9ad8\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#_1","title":"\u5de5\u4f5c\u6d41\u7a0b","text":"<p><code>epoll</code> \u7684\u5de5\u4f5c\u6d41\u7a0b\u53ef\u4ee5\u6982\u62ec\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#1-epoll_1","title":"1. \u521b\u5efa <code>epoll</code> \u5b9e\u4f8b","text":"<ul> <li>\u9996\u5148\uff0c\u901a\u8fc7 <code>epoll_create</code> \u6216 <code>epoll_create1</code> \u521b\u5efa\u4e00\u4e2a <code>epoll</code> \u5b9e\u4f8b\u3002</li> <li>\u8fd9\u4e2a\u5b9e\u4f8b\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u5185\u6838\u4e2d\u7684\u6570\u636e\u7ed3\u6784\uff0c\u7528\u4e8e\u5b58\u50a8\u548c\u7ba1\u7406\u9700\u8981\u76d1\u63a7\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08\u5982\u5957\u63a5\u5b57\uff09\u3002</li> <li>\u521b\u5efa\u6210\u529f\u540e\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08<code>epoll_fd</code>\uff09\uff0c\u7528\u4e8e\u540e\u7eed\u64cd\u4f5c\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#2","title":"2. \u6ce8\u518c\u9700\u8981\u76d1\u63a7\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26","text":"<ul> <li>\u4f7f\u7528 <code>epoll_ctl</code> \u5411 <code>epoll</code> \u5b9e\u4f8b\u6ce8\u518c\u9700\u8981\u76d1\u63a7\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</li> <li>\u6ce8\u518c\u65f6\u9700\u8981\u6307\u5b9a\uff1a<ul> <li>\u8981\u76d1\u63a7\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08\u5982\u5957\u63a5\u5b57\uff09\u3002</li> <li>\u611f\u5174\u8da3\u7684\u4e8b\u4ef6\u7c7b\u578b\uff08\u5982\u53ef\u8bfb\u4e8b\u4ef6 <code>EPOLLIN</code>\u3001\u53ef\u5199\u4e8b\u4ef6 <code>EPOLLOUT</code> \u7b49\uff09\u3002</li> <li>\u53ef\u9009\u7684\u7528\u6237\u6570\u636e\uff08\u901a\u5e38\u7528\u4e8e\u6807\u8bc6\u6587\u4ef6\u63cf\u8ff0\u7b26\uff09\u3002</li> </ul> </li> <li>\u6ce8\u518c\u540e\uff0c<code>epoll</code> \u5b9e\u4f8b\u4f1a\u5f00\u59cb\u76d1\u63a7\u8fd9\u4e9b\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u72b6\u6001\u53d8\u5316\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#3","title":"3. \u7b49\u5f85\u4e8b\u4ef6\u53d1\u751f","text":"<ul> <li>\u4f7f\u7528 <code>epoll_wait</code> \u7b49\u5f85\u6ce8\u518c\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u53d1\u751f\u4e8b\u4ef6\u3002</li> <li><code>epoll_wait</code> \u4f1a\u963b\u585e\uff08\u9664\u975e\u8bbe\u7f6e\u4e86\u8d85\u65f6\uff09\uff0c\u76f4\u5230\u6709\u6587\u4ef6\u63cf\u8ff0\u7b26\u5c31\u7eea\uff08\u5982\u6570\u636e\u5230\u8fbe\u3001\u8fde\u63a5\u8bf7\u6c42\u7b49\uff09\u3002</li> <li>\u5f53\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c<code>epoll_wait</code> \u4f1a\u8fd4\u56de\u4e00\u4e2a\u5c31\u7eea\u4e8b\u4ef6\u5217\u8868\uff0c\u5217\u8868\u4e2d\u5305\u542b\u6240\u6709\u89e6\u53d1\u4e8b\u4ef6\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ca\u5176\u4e8b\u4ef6\u7c7b\u578b\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#4","title":"4. \u5904\u7406\u5c31\u7eea\u4e8b\u4ef6","text":"<ul> <li>\u904d\u5386 <code>epoll_wait</code> \u8fd4\u56de\u7684\u5c31\u7eea\u4e8b\u4ef6\u5217\u8868\uff0c\u5904\u7406\u6bcf\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u4e8b\u4ef6\u3002</li> <li>\u4f8b\u5982\uff1a<ul> <li>\u5982\u679c\u662f\u53ef\u8bfb\u4e8b\u4ef6\uff08<code>EPOLLIN</code>\uff09\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6570\u636e\u6216\u63a5\u53d7\u65b0\u8fde\u63a5\u3002</li> <li>\u5982\u679c\u662f\u53ef\u5199\u4e8b\u4ef6\uff08<code>EPOLLOUT</code>\uff09\uff0c\u53ef\u4ee5\u53d1\u9001\u6570\u636e\u3002</li> </ul> </li> <li>\u5904\u7406\u5b8c\u4e8b\u4ef6\u540e\uff0c\u6839\u636e\u9700\u8981\u51b3\u5b9a\u662f\u5426\u7ee7\u7eed\u76d1\u63a7\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u6216\u8005\u5c06\u5176\u4ece <code>epoll</code> \u5b9e\u4f8b\u4e2d\u79fb\u9664\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#5_1","title":"5. \u5faa\u73af\u76d1\u63a7","text":"<ul> <li>\u901a\u5e38\uff0c<code>epoll</code> \u4f1a\u4e0e\u4e00\u4e2a\u4e8b\u4ef6\u5faa\u73af\u7ed3\u5408\u4f7f\u7528\u3002</li> <li>\u5728\u5faa\u73af\u4e2d\uff0c\u4e0d\u65ad\u8c03\u7528 <code>epoll_wait</code> \u7b49\u5f85\u65b0\u4e8b\u4ef6\uff0c\u5e76\u5904\u7406\u5c31\u7eea\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002</li> <li>\u8fd9\u79cd\u673a\u5236\u975e\u5e38\u9002\u5408\u9ad8\u5e76\u53d1\u573a\u666f\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u9ad8\u6548\u5730\u5904\u7406\u5927\u91cf\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u800c\u4e0d\u4f1a\u56e0\u4e3a\u904d\u5386\u6240\u6709\u63cf\u8ff0\u7b26\u800c\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#6-etlt","title":"6. \u8fb9\u7f18\u89e6\u53d1\uff08ET\uff09\u4e0e\u6c34\u5e73\u89e6\u53d1\uff08LT\uff09\u6a21\u5f0f","text":"<ul> <li><code>epoll</code> \u652f\u6301\u4e24\u79cd\u4e8b\u4ef6\u89e6\u53d1\u6a21\u5f0f\uff1a<ul> <li>\u6c34\u5e73\u89e6\u53d1\uff08LT\uff09\uff1a\u53ea\u8981\u6587\u4ef6\u63cf\u8ff0\u7b26\u5904\u4e8e\u5c31\u7eea\u72b6\u6001\uff0c<code>epoll_wait</code> \u5c31\u4f1a\u4e0d\u65ad\u901a\u77e5\u3002</li> <li>\u8fb9\u7f18\u89e6\u53d1\uff08ET\uff09\uff1a\u53ea\u5728\u6587\u4ef6\u63cf\u8ff0\u7b26\u72b6\u6001\u53d1\u751f\u53d8\u5316\u65f6\u901a\u77e5\u4e00\u6b21\uff0c\u9700\u8981\u4e00\u6b21\u6027\u5904\u7406\u6240\u6709\u6570\u636e\u3002</li> </ul> </li> <li>\u5f00\u53d1\u8005\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u6a21\u5f0f\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#7","title":"7. \u5173\u95ed\u548c\u6e05\u7406","text":"<ul> <li>\u5f53\u4e0d\u518d\u9700\u8981\u76d1\u63a7\u67d0\u4e9b\u6587\u4ef6\u63cf\u8ff0\u7b26\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>epoll_ctl</code> \u5c06\u5176\u4ece <code>epoll</code> \u5b9e\u4f8b\u4e2d\u79fb\u9664\u3002</li> <li>\u6700\u540e\uff0c\u5173\u95ed <code>epoll</code> \u5b9e\u4f8b\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08<code>epoll_fd</code>\uff09\uff0c\u91ca\u653e\u8d44\u6e90\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/epoll/#_2","title":"\u5de5\u4f5c\u6d41\u7a0b\u603b\u7ed3","text":"<ol> <li>\u521b\u5efa <code>epoll</code> \u5b9e\u4f8b\u3002</li> <li>\u6ce8\u518c\u9700\u8981\u76d1\u63a7\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ca\u5176\u4e8b\u4ef6\u3002</li> <li>\u7b49\u5f85\u4e8b\u4ef6\u53d1\u751f\uff08<code>epoll_wait</code>\uff09\u3002</li> <li>\u5904\u7406\u5c31\u7eea\u4e8b\u4ef6\u3002</li> <li>\u5faa\u73af\u76d1\u63a7\uff0c\u76f4\u5230\u7a0b\u5e8f\u7ed3\u675f\u3002</li> <li>\u5173\u95ed\u548c\u6e05\u7406\u8d44\u6e90\u3002</li> </ol> <p><code>epoll</code> \u7684\u6838\u5fc3\u4f18\u52bf\u5728\u4e8e\u5176\u9ad8\u6548\u7684\u4e8b\u4ef6\u901a\u77e5\u673a\u5236\uff0c\u80fd\u591f\u5904\u7406\u5927\u91cf\u5e76\u53d1\u8fde\u63a5\uff0c\u7279\u522b\u9002\u5408\u9ad8\u5e76\u53d1\u7684\u7f51\u7edc\u670d\u52a1\u5668\u573a\u666f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/io_uring/","title":"io_uring","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/io_uring/#linux","title":"linux","text":"<p>ref: \u6559\u4f60\u4f7f\u7528io_uring\u6765\u5199\u4e00\u4e2a\u5e76\u53d1\u56de\u58f0\u670d\u52a1\u5668_io_uring \u6559\u7a0b-CSDN\u535a\u5ba2</p>"},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/Linux-Unix%E7%BC%96%E7%A8%8B%E6%89%8B%E5%86%8C/1.%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/","title":"\u57fa\u672c\u6982\u5ff5","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/Linux-Unix%E7%BC%96%E7%A8%8B%E6%89%8B%E5%86%8C/1.%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#linux","title":"linux","text":""},{"location":"Web%E5%BC%80%E5%8F%91/Linux%E7%BC%96%E7%A8%8B/Linux-Unix%E7%BC%96%E7%A8%8B%E6%89%8B%E5%86%8C/1.%20%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_2","title":"\u5185\u6838","text":"<ul> <li>\u5185\u6838\u7684\u804c\u8d23<ul> <li>\u8fdb\u7a0b\u8c03\u5ea6</li> <li>\u5185\u5b58\u7ba1\u7406</li> <li>\u6587\u4ef6\u7cfb\u7edf</li> <li>\u521b\u5efa\u548c\u7ec8\u6b62\u8fdb\u7a0b</li> <li>\u8bbe\u5907\u8bbf\u95ee</li> <li>\u8054\u7f51</li> <li>\u7cfb\u7edf\u8c03\u7528API</li> </ul> </li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/CSS%E5%9F%BA%E7%A1%80/","title":"CSS\u57fa\u7840","text":"<p>CSS\u7684\u57fa\u672c\u8bed\u6cd5\uff1a</p> <ol> <li>\u9009\u62e9\u5668\uff08Selector\uff09\uff1a\u7528\u4e8e\u9009\u62e9\u8981\u5e94\u7528\u6837\u5f0f\u7684HTML\u5143\u7d20\uff0c\u53ef\u4ee5\u662f\u6807\u7b7e\u540d\u3001\u7c7b\u540d\u3001ID\u7b49\u7b49\u3002</li> <li>\u58f0\u660e\uff08Declaration\uff09\uff1a\u5728\u9009\u62e9\u5668\u540e\u9762\u52a0\u4e0a\u4e00\u5bf9\u82b1\u62ec\u53f7\uff0c\u62ec\u53f7\u4e2d\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u6837\u5f0f\u5c5e\u6027\u548c\u503c\u7684\u952e\u503c\u5bf9\uff0c\u7528\u5192\u53f7\u5206\u9694\uff0c\u7528\u5206\u53f7\u7ed3\u675f\u3002</li> <li>\u5c5e\u6027\uff08Property\uff09\uff1a\u63cf\u8ff0\u8981\u4fee\u6539\u7684\u6837\u5f0f\u5c5e\u6027\u7684\u540d\u79f0\uff0c\u5982font-size\u3001color\u7b49\u3002</li> <li>\u503c\uff08Value\uff09\uff1a\u63cf\u8ff0\u8981\u8bbe\u7f6e\u7684\u5c5e\u6027\u503c\uff0c\u53ef\u4ee5\u662f\u957f\u5ea6\u3001\u989c\u8272\u3001\u5b57\u4f53\u540d\u79f0\u3001\u80cc\u666f\u56fe\u50cf\u7b49\u7b49\u3002</li> </ol> <pre><code>// \u9009\u62e9\u5668\u6837\u4f8b\np {\n  color: red;\n  background-color: gray;\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/CSS%E5%9F%BA%E7%A1%80/#htmlcss","title":"\u5982\u4f55\u5728HTML\u6587\u4ef6\u4e2d\u4f7f\u7528CSS","text":"<ol> <li>\u5185\u8054\u6837\u5f0f\uff1a\u5728HTML\u5143\u7d20\u4e2d\u4f7f\u7528style\u5c5e\u6027\uff0c\u76f4\u63a5\u5b9a\u4e49CSS\u6837\u5f0f\u3002\u4f8b\u5982\uff1a</li> </ol> <pre><code>&lt;p style=\"color: red;\"&gt;\u8fd9\u662f\u4e00\u6bb5\u7ea2\u8272\u6587\u5b57\u3002&lt;/p&gt;\n</code></pre> <p>\u5185\u8054\u6837\u5f0f\u7684\u4f18\u70b9\u662f\u7b80\u5355\u65b9\u4fbf\uff0c\u53ef\u4ee5\u76f4\u63a5\u9488\u5bf9\u5355\u4e2a\u5143\u7d20\u5b9a\u4e49\u6837\u5f0f\uff0c\u4f46\u662f\u4e0d\u5229\u4e8e\u590d\u7528\u548c\u7ef4\u62a4\u3002</p> <ol> <li>\u5185\u90e8\u6837\u5f0f\u8868\uff1a\u5728HTML\u6587\u6863\u5934\u90e8\u4f7f\u7528<code>&lt;style&gt;</code>\u6807\u7b7e\uff0c\u5b9a\u4e49CSS\u6837\u5f0f\u8868\u3002\u4f8b\u5982\uff1a <pre><code>&lt;head&gt;\n    &lt;style&gt;\n        p {\n            color: red;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;p&gt;\u8fd9\u662f\u4e00\u6bb5\u7ea2\u8272\u6587\u5b57\u3002&lt;/p&gt;\n&lt;/body&gt;\n</code></pre></li> </ol> <p>\u5185\u90e8\u6837\u5f0f\u8868\u7684\u4f18\u70b9\u662f\u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a\u6837\u5f0f\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u591a\u4e2a\u9875\u9762\u4e2d\u5171\u4eab\uff0c\u4f46\u662f\u4f1a\u5bfc\u81f4HTML\u6587\u4ef6\u53d8\u5f97\u81c3\u80bf\uff0c\u4e0d\u5229\u4e8e\u9875\u9762\u7684\u7ed3\u6784\u5316\u548c\u6a21\u5757\u5316\u3002</p> <ol> <li>\u5916\u90e8\u6837\u5f0f\u8868\uff1a\u5c06CSS\u6837\u5f0f\u8868\u653e\u5728\u5916\u90e8\u6587\u4ef6\u4e2d\uff0c\u901a\u8fc7HTML\u7684<code>&lt;link&gt;</code>\u6807\u7b7e\u5f15\u7528\u3002\u4f8b\u5982\uff1a <pre><code>&lt;head&gt;\n  &lt;link rel=\"stylesheet\" href=\"style.css\"&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n  &lt;p&gt;\u8fd9\u662f\u4e00\u6bb5\u7ea2\u8272\u6587\u5b57\u3002&lt;/p&gt;\n&lt;/body&gt;\n</code></pre>    \u5916\u90e8\u6837\u5f0f\u8868\u7684\u4f18\u70b9\u662f\u53ef\u4ee5\u5c06\u6837\u5f0f\u4e0eHTML\u6587\u6863\u5206\u79bb\uff0c\u6709\u5229\u4e8e\u9875\u9762\u7684\u7ed3\u6784\u5316\u548c\u6a21\u5757\u5316\uff0c\u5e76\u4e14\u53ef\u4ee5\u7f13\u5b58\uff0c\u63d0\u9ad8\u9875\u9762\u52a0\u8f7d\u901f\u5ea6\u3002\u540c\u65f6\uff0c\u591a\u4e2a\u9875\u9762\u53ef\u4ee5\u5171\u7528\u540c\u4e00\u4e2a\u5916\u90e8\u6837\u5f0f\u8868\uff0c\u6709\u5229\u4e8e\u4ee3\u7801\u7684\u590d\u7528\u548c\u7ef4\u62a4\u3002</li> </ol> <p>[!note]  \u4e00\u822c\u53ea\u7528\u5916\u90e8\u6837\u5f0f\u8868</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/CSS%E5%9F%BA%E7%A1%80/#_1","title":"\u7c7b","text":"<p>\u5728CSS\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u7c7b\u9009\u62e9\u5668\uff08\u4ee5\u70b9<code>.</code>\u5f00\u5934\uff09\u6765\u9009\u62e9\u5177\u6709\u7279\u5b9a\u7c7b\u540d\u7684\u5143\u7d20\u3002 <pre><code>/* \u7c7b  */\n.\u6211\u4e0d\u77e5\u9053\u8fd9\u662f\u4ec0\u4e48{\n    color: red;\n}\n</code></pre></p> <pre><code>&lt;div class=\"\u6211\u4e0d\u77e5\u9053\u8fd9\u662f\u4ec0\u4e48\"&gt;\n        this is a doc\n&lt;/div&gt;\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/CSS%E5%9F%BA%E7%A1%80/#_2","title":"\u7ee7\u627f","text":"<p>CSS\u4e2d\u7684\u67d0\u4e9b\u5c5e\u6027\u5177\u6709\u7ee7\u627f\u7279\u6027\uff0c\u8fd9\u610f\u5473\u7740\u5f53\u7236\u5143\u7d20\u5e94\u7528\u8fd9\u4e9b\u5c5e\u6027\u65f6\uff0c\u5b50\u5143\u7d20\u4f1a\u7ee7\u627f\u8fd9\u4e9b\u5c5e\u6027\u7684\u503c\u3002\u4f8b\u5982\uff0c<code>color</code>\uff08\u6587\u5b57\u989c\u8272\uff09\u3001<code>font-family</code>\uff08\u5b57\u4f53\u7cfb\u5217\uff09\u3001<code>font-size</code>\uff08\u5b57\u4f53\u5927\u5c0f\uff09\u7b49\u5c5e\u6027\u90fd\u5177\u6709\u7ee7\u627f\u7279\u6027\u3002</p> <p>\u5b50\u5143\u7d20\u7684style &gt; \u7236\u5143\u7d20\u7684style</p> <p>\u7ee7\u627f\u793a\u4f8b:</p> <pre><code>body{\n    color: red;\n}\n</code></pre> <pre><code>&lt;body&gt;\n    &lt;p1&gt;\n        \u5b57\u4f53\u4e3a\u7ea2\u8272\n    &lt;/p1&gt;\n&lt;/body&gt;\n</code></pre> <pre><code>&lt;head&gt;\n        &lt;div&gt;\n            \u5b57\u4e3a\u7ea2\u8272\n        &lt;/div&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n\n&lt;/body&gt;\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528<code>inherit</code>\u5173\u952e\u5b57\u6765\u660e\u786e\u6307\u5b9a\u67d0\u4e2a\u5c5e\u6027\u7684\u503c\u8981\u7ee7\u627f\u81ea\u7236\u5143\u7d20\uff0c\u5373\u4f7f\u8be5\u5c5e\u6027\u9ed8\u8ba4\u4e0d\u5177\u6709\u7ee7\u627f\u7279\u6027\u3002</p> <pre><code>&lt;style&gt;\n  .parent {\n    font-size: 16px;\n  }\n\n  .child {\n    font-size: inherit;\n  }\n&lt;/style&gt;\n\n&lt;div class=\"parent\"&gt;\n  &lt;p class=\"child\"&gt;This is a paragraph with inherited font size.&lt;/p&gt;\n&lt;/div&gt;\n</code></pre> <p>[!note] \u5728CSS\u4e2d\uff0c\u7c7b\uff08Class\uff09\u4e4b\u95f4\u5e76\u4e0d\u5b58\u5728\u76f4\u63a5\u7684\u7ee7\u627f\u5173\u7cfb\u3002CSS\u4e2d\u7684\u7ee7\u627f\u4e3b\u8981\u662f\u6307\u5c5e\u6027\u503c\u7684\u7ee7\u627f\uff0c\u800c\u4e0d\u662f\u7c7b\u672c\u8eab\u7684\u7ee7\u627f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/CSS%E5%9F%BA%E7%A1%80/#_3","title":"\u9009\u62e9\u5668","text":"<p>\u901a\u8fc7\u9009\u62e9\u5668\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u5143\u7d20\u7684\u6807\u7b7e\u540d\u3001\u7c7b\u540d\u3001ID\u3001\u5c5e\u6027\u7b49\u7279\u5f81\u6765\u9009\u62e9\u5143\u7d20\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u9009\u62e9\u5668\u793a\u4f8b\uff1a</p> <ol> <li> <p>\u6807\u7b7e\u9009\u62e9\u5668\uff08Tag Selector\uff09\uff1a\u901a\u8fc7\u6807\u7b7e\u540d\u9009\u62e9\u5143\u7d20\u3002\u4f8b\u5982\uff0c<code>p</code>\u9009\u62e9\u5668\u5c06\u9009\u62e9\u6240\u6709<code>&lt;p&gt;</code>\u5143\u7d20\u3002</p> </li> <li> <p>\u7c7b\u9009\u62e9\u5668\uff08Class Selector\uff09\uff1a\u901a\u8fc7\u7c7b\u540d\u9009\u62e9\u5143\u7d20\u3002\u7c7b\u9009\u62e9\u5668\u4ee5<code>.</code>\u5f00\u5934\uff0c\u540e\u9762\u8ddf\u7740\u7c7b\u540d\u3002\u4f8b\u5982\uff0c<code>.highlight</code>\u9009\u62e9\u5668\u5c06\u9009\u62e9\u6240\u6709\u5177\u6709<code>highlight</code>\u7c7b\u7684\u5143\u7d20\u3002</p> </li> <li> <p>ID\u9009\u62e9\u5668\uff08ID Selector\uff09\uff1a\u901a\u8fc7ID\u9009\u62e9\u5143\u7d20\u3002ID\u9009\u62e9\u5668\u4ee5<code>#</code>\u5f00\u5934\uff0c\u540e\u9762\u8ddf\u7740ID\u503c\u3002\u4f8b\u5982\uff0c<code>#header</code>\u9009\u62e9\u5668\u5c06\u9009\u62e9\u5177\u6709<code>header</code> ID\u7684\u5143\u7d20\u3002</p> </li> <li> <p>\u5c5e\u6027\u9009\u62e9\u5668\uff08Attribute Selector\uff09\uff1a\u901a\u8fc7\u5143\u7d20\u7684\u5c5e\u6027\u9009\u62e9\u5143\u7d20\u3002\u5c5e\u6027\u9009\u62e9\u5668\u4f7f\u7528\u65b9\u62ec\u53f7<code>[]</code>\u6765\u6307\u5b9a\u5c5e\u6027\u540d\u548c\u5c5e\u6027\u503c\u3002\u4f8b\u5982\uff0c<code>[type=\"text\"]</code>\u9009\u62e9\u5668\u5c06\u9009\u62e9\u6240\u6709<code>type</code>\u5c5e\u6027\u503c\u4e3a\"text\"\u7684\u5143\u7d20\u3002</p> </li> <li> <p>\u540e\u4ee3\u9009\u62e9\u5668\uff08Descendant Selector\uff09\uff1a\u9009\u62e9\u67d0\u4e2a\u5143\u7d20\u7684\u540e\u4ee3\u5143\u7d20\u3002\u540e\u4ee3\u9009\u62e9\u5668\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u4e24\u4e2a\u9009\u62e9\u5668\u3002\u4f8b\u5982\uff0c<code>.container p</code>\u9009\u62e9\u5668\u5c06\u9009\u62e9\u6240\u6709\u4f4d\u4e8e<code>.container</code>\u5143\u7d20\u5185\u90e8\u7684<code>&lt;p&gt;</code>\u5143\u7d20\u3002</p> </li> <li> <p>\u5b50\u5143\u7d20\u9009\u62e9\u5668\uff08Child Selector\uff09\uff1a\u9009\u62e9\u67d0\u4e2a\u5143\u7d20\u7684\u76f4\u63a5\u5b50\u5143\u7d20\u3002\u5b50\u5143\u7d20\u9009\u62e9\u5668\u4f7f\u7528\u5927\u4e8e\u53f7<code>&gt;</code>\u5206\u9694\u4e24\u4e2a\u9009\u62e9\u5668\u3002\u4f8b\u5982\uff0c<code>.container &gt; p</code>\u9009\u62e9\u5668\u5c06\u9009\u62e9<code>.container</code>\u5143\u7d20\u7684\u76f4\u63a5\u5b50\u5143\u7d20\u4e2d\u7684<code>&lt;p&gt;</code>\u5143\u7d20\u3002</p> </li> <li> <p>\u4f2a\u7c7b\u9009\u62e9\u5668\uff08Pseudo-Class Selectors\uff09\uff1a\u4f2a\u7c7b\u9009\u62e9\u5668\u53ef\u4ee5\u7528\u6765\u9009\u62e9\u5143\u7d20\u7684\u7279\u5b9a\u72b6\u6001\uff0c\u6bd4\u5982\u60ac\u505c\u3001\u88ab\u70b9\u51fb\u3001\u88ab\u8bbf\u95ee\u7b49\u3002\u4f2a\u7c7b\u9009\u62e9\u5668\u4ee5\u5192\u53f7<code>:</code>\u5f00\u5934\uff0c\u540e\u9762\u8ddf\u7740\u4f2a\u7c7b\u540d\u79f0\u3002\u4f8b\u5982\uff0c<code>:hover</code>\u9009\u62e9\u5668\u5c06\u9009\u62e9\u9f20\u6807\u60ac\u505c\u5728\u5143\u7d20\u4e0a\u65f6\u7684\u72b6\u6001\u3002</p> </li> </ol> <p>\u8fd8\u6709\u5176\u4ed6\u9009\u62e9\u5668\uff0c\u8be6\u7ec6\u53ef\u67e5\u770b\uff1aCSS \u9009\u62e9\u5668</p> <p>\u5173\u4e8eHTML\u5c5e\u6027\u53ef\u4ee5\u67e5\u770b\uff1aHTML\u5c5e\u6027</p> <p>\u591a\u4e2a\u9009\u62e9\u5668\u7684\u7ec4\u5408</p> <p>\u4e0b\u9009\u62e9\u5668\u9009\u62e9\u5177\u6709\u7c7b\u540d\u4e3a<code>box</code>\u4e14\u4f4d\u4e8e<code>&lt;div&gt;</code>\u5143\u7d20\u5185\u90e8\u7684\u76f4\u63a5\u5b50\u5143\u7d20\u7684<code>&lt;p&gt;</code>\u5143\u7d20\uff1a</p> <pre><code>div .box &gt; p {\n  /* \u6837\u5f0f\u5b9a\u4e49 */\n}\n</code></pre> <p>\u9009\u62e9\u5668\u662fCSS\u4e2d\u975e\u5e38\u91cd\u8981\u7684\u6982\u5ff5\uff0c\u901a\u8fc7\u5408\u7406\u8fd0\u7528\u9009\u62e9\u5668\uff0c\u4f60\u53ef\u4ee5\u7cbe\u786e\u5730\u9009\u62e9\u5e76\u6837\u5f0f\u5316\u9875\u9762\u4e2d\u7684\u5143\u7d20\u3002</p> <p>ID <pre><code>&lt;!-- \u6ce8\u610f ID\u5e94\u8be5\u5728\u6574\u4e2aHTML\u6587\u6863\u4e2d\u662f\u552f\u4e00\u7684 --&gt;\n&lt;div id=\"123\"&gt;id \u4e3a 123&lt;/div&gt;\n</code></pre></p> <p>\u6807\u7b7e\u9009\u62e9\u5668\u4e0e\u4f2a\u7c7b\u9009\u62e9\u5668\u7684\u7ec4\u5408 <pre><code>h1:hover {\n    color: red;\n}\n</code></pre></p> <p></p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/CSS%E5%9F%BA%E7%A1%80/#_4","title":"\u76d2\u6a21\u578b","text":"<p>\u6bcf\u4e2aHTML\u5143\u7d20\u90fd\u53ef\u4ee5\u88ab\u89c6\u4e3a\u4e00\u4e2a\u77e9\u5f62\u7684\u76d2\u5b50\uff0c\u8be5\u76d2\u5b50\u5305\u62ec\u5185\u5bb9\u533a\u57df\uff08content\uff09\u3001\u5185\u8fb9\u8ddd\uff08padding\uff09\u3001\u8fb9\u6846\uff08border\uff09\u548c\u5916\u8fb9\u8ddd\uff08margin\uff09\u56db\u4e2a\u90e8\u5206\uff0c\u5b83\u4eec\u76f8\u4e92\u53e0\u52a0\u5f62\u6210\u6700\u7ec8\u7684\u5143\u7d20\u5e03\u5c40\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u76d2\u6a21\u578b\u7684\u7ec4\u6210\u90e8\u5206\u5305\u62ec\uff1a</p> <ol> <li> <p>\u5185\u5bb9\u533a\u57df\uff08Content\uff09\uff1a\u8be5\u533a\u57df\u5305\u542b\u5143\u7d20\u7684\u5b9e\u9645\u5185\u5bb9\uff0c\u4f8b\u5982\u6587\u672c\u3001\u56fe\u50cf\u6216\u5176\u4ed6\u5d4c\u5957\u7684\u5143\u7d20\u3002\u5185\u5bb9\u533a\u57df\u7684\u5927\u5c0f\u7531\u5143\u7d20\u7684\u5bbd\u5ea6\uff08width\uff09\u548c\u9ad8\u5ea6\uff08height\uff09\u5c5e\u6027\u786e\u5b9a\u3002</p> </li> <li> <p>\u5185\u8fb9\u8ddd\uff08Padding\uff09\uff1a\u5185\u8fb9\u8ddd\u662f\u5185\u5bb9\u533a\u57df\u4e0e\u8fb9\u6846\u4e4b\u95f4\u7684\u7a7a\u767d\u533a\u57df\uff0c\u7528\u4e8e\u63a7\u5236\u5185\u5bb9\u4e0e\u8fb9\u6846\u4e4b\u95f4\u7684\u95f4\u8ddd\u3002\u5185\u8fb9\u8ddd\u7684\u5927\u5c0f\u7531\u5143\u7d20\u7684\u5185\u8fb9\u8ddd\u5c5e\u6027\uff08padding\uff09\u63a7\u5236\u3002</p> </li> <li> <p>\u8fb9\u6846\uff08Border\uff09\uff1a\u8fb9\u6846\u662f\u56f4\u7ed5\u5185\u5bb9\u548c\u5185\u8fb9\u8ddd\u7684\u7ebf\u6761\u6216\u6837\u5f0f\u3002\u8fb9\u6846\u7684\u5927\u5c0f\u3001\u6837\u5f0f\u548c\u989c\u8272\u7531\u5143\u7d20\u7684\u8fb9\u6846\u5c5e\u6027\uff08border\uff09\u63a7\u5236\u3002</p> </li> <li> <p>\u5916\u8fb9\u8ddd\uff08Margin\uff09\uff1a\u5916\u8fb9\u8ddd\u662f\u5143\u7d20\u4e0e\u5176\u5468\u56f4\u5143\u7d20\u4e4b\u95f4\u7684\u7a7a\u767d\u533a\u57df\uff0c\u7528\u4e8e\u63a7\u5236\u5143\u7d20\u4e4b\u95f4\u7684\u95f4\u8ddd\u3002\u5916\u8fb9\u8ddd\u7684\u5927\u5c0f\u7531\u5143\u7d20\u7684\u5916\u8fb9\u8ddd\u5c5e\u6027\uff08margin\uff09\u63a7\u5236\u3002</p> </li> </ol> <p>\u8fd9\u4e9b\u90e8\u5206\u7ec4\u6210\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684\u76d2\u5b50\uff0c\u5b83\u4eec\u7684\u5c3a\u5bf8\u548c\u6392\u5217\u65b9\u5f0f\u51b3\u5b9a\u4e86\u5143\u7d20\u5728\u9875\u9762\u4e0a\u7684\u5e03\u5c40\u3002CSS\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u7684\u5c5e\u6027\u548c\u503c\uff0c\u53ef\u4ee5\u7528\u4e8e\u63a7\u5236\u548c\u8c03\u6574\u76d2\u6a21\u578b\u7684\u5404\u4e2a\u90e8\u5206\uff0c\u4ece\u800c\u5b9e\u73b0\u6240\u9700\u7684\u9875\u9762\u5e03\u5c40\u6548\u679c\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u76d2\u6a21\u578b\u7684\u5c3a\u5bf8\u8ba1\u7b97\u5305\u62ec\u5185\u5bb9\u533a\u57df\u3001\u5185\u8fb9\u8ddd\u548c\u8fb9\u6846\uff0c\u4f46\u4e0d\u5305\u62ec\u5916\u8fb9\u8ddd\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5143\u7d20\u7684\u5b9e\u9645\u5c3a\u5bf8\u662f\u5185\u5bb9\u533a\u57df\u3001\u5185\u8fb9\u8ddd\u548c\u8fb9\u6846\u7684\u603b\u548c\u3002\u5916\u8fb9\u8ddd\u7528\u4e8e\u63a7\u5236\u5143\u7d20\u4e4b\u95f4\u7684\u95f4\u8ddd\uff0c\u4e0d\u4f1a\u5f71\u54cd\u5143\u7d20\u81ea\u8eab\u7684\u5c3a\u5bf8\u3002</p> <p>\u7b80\u5355\u5b9e\u4f8b\uff1a <pre><code>.container {\n  display: flex;\n}\n.container &gt; div {\n  flex: 1 1 auto;\n}\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/CSS%E5%9F%BA%E7%A1%80/#_5","title":"\u52a8\u753b","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/CSS%E5%9F%BA%E7%A1%80/#flexbox","title":"FlexBox\u5e03\u5c40","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/CSS%E5%9F%BA%E7%A1%80/#grid","title":"Grid\u7f51\u683c\u5e03\u5c40","text":"<p>\u6709\u4e9b\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\uff0c\u6240\u4ee5\u5f88\u5c11\u7528</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/HTML%E7%AC%94%E8%AE%B0/","title":"HTML\u7b14\u8bb0","text":"<p>\u57fa\u672c\u7ed3\u6784 <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;HTML5 Boilerplate&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    &lt;h1&gt;Hello world&lt;/h1&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/HTML%E7%AC%94%E8%AE%B0/#_1","title":"\u6807\u7b7e","text":"<ol> <li> <p>\u6807\u9898\u6807\u7b7e\uff1a<code>&lt;h1&gt;</code>\u5230<code>&lt;h6&gt;</code>\uff0c\u7528\u4e8e\u5b9a\u4e49\u4e0d\u540c\u7ea7\u522b\u7684\u6807\u9898\u3002</p> </li> <li> <p>\u6bb5\u843d\u6807\u7b7e\uff1a<code>&lt;p&gt;</code>\uff0c\u7528\u4e8e\u5b9a\u4e49\u6bb5\u843d\u3002</p> </li> <li> <p>\u94fe\u63a5\u6807\u7b7e\uff1a<code>&lt;a&gt;</code>\uff0c\u7528\u4e8e\u521b\u5efa\u8d85\u94fe\u63a5\uff0c\u94fe\u63a5\u5230\u5176\u4ed6\u9875\u9762\u6216\u6587\u4ef6\u3002</p> </li> <li> <p>\u56fe\u50cf\u6807\u7b7e\uff1a<code>&lt;img&gt;</code>\uff0c\u7528\u4e8e\u5728\u9875\u9762\u4e2d\u63d2\u5165\u56fe\u7247\u3002</p> </li> <li> <p>\u5217\u8868\u6807\u7b7e\uff1a<code>&lt;ul&gt;</code>\u3001<code>&lt;ol&gt;</code>\u548c<code>&lt;li&gt;</code>\uff0c\u7528\u4e8e\u521b\u5efa\u65e0\u5e8f\u5217\u8868\u3001\u6709\u5e8f\u5217\u8868\u548c\u5217\u8868\u9879\u3002</p> </li> <li> <p>\u8868\u683c\u6807\u7b7e\uff1a<code>&lt;table&gt;</code>\u3001<code>&lt;tr&gt;</code>\u3001<code>&lt;td&gt;</code>\u548c<code>&lt;th&gt;</code>\uff0c\u7528\u4e8e\u521b\u5efa\u8868\u683c\u3002</p> </li> <li> <p>\u8868\u5355\u6807\u7b7e\uff1a<code>&lt;form&gt;</code>\u3001<code>&lt;input&gt;</code>\u3001<code>&lt;select&gt;</code>\u3001<code>&lt;textarea&gt;</code>\u7b49\uff0c\u7528\u4e8e\u521b\u5efa\u8868\u5355\uff0c\u63a5\u6536\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u3002</p> </li> <li> <p>\u6837\u5f0f\u6807\u7b7e\uff1a<code>&lt;style&gt;</code>\u548c<code>&lt;link&gt;</code>\uff0c\u7528\u4e8e\u5b9a\u4e49\u7f51\u9875\u7684\u6837\u5f0f\u548c\u5f15\u5165CSS\u6587\u4ef6\u3002</p> </li> <li> <p>\u811a\u672c\u6807\u7b7e\uff1a<code>&lt;script&gt;</code>\uff0c\u7528\u4e8e\u5728\u7f51\u9875\u4e2d\u5d4c\u5165JavaScript\u4ee3\u7801\u3002</p> </li> <li> <p>\u6587\u672c\u6837\u5f0f\u6807\u7b7e\uff1a<code>&lt;strong&gt;</code>\u3001<code>&lt;em&gt;</code>\u3001<code>&lt;u&gt;</code>\u7b49\uff0c\u7528\u4e8e\u5b9a\u4e49\u6587\u672c\u6837\u5f0f\uff0c\u5982\u52a0\u7c97\u3001\u659c\u4f53\u3001\u4e0b\u5212\u7ebf\u7b49\u3002</p> </li> <li> <p>\u5206\u5272\u7ebf\u6807\u7b7e\uff1a<code>&lt;hr&gt;</code>\uff0c\u7528\u4e8e\u521b\u5efa\u6c34\u5e73\u5206\u5272\u7ebf\u3002</p> </li> </ol> <p><code>&lt;div&gt;</code> : \u5bf9\u9875\u9762\u7a7a\u95f4\u8fdb\u884c\u5206\u5757 <code>&lt;span&gt;</code> : \u5bf9\u9875\u9762\u5185\u5143\u7d20\u8fdb\u884c\u5206\u5757 </p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/","title":"\u524d\u7aef\u57fa\u7840","text":"<p>\u7ecf\u8fc7\u524d\u9762\u57fa\u7840\u5185\u5bb9\u7684\u5b66\u4e60\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u53ef\u4ee5\u6b63\u5f0f\u5730\u8fdb\u5165Web\u5f00\u53d1\u7684\u5b66\u4e60\u5f53\u4e2d\u5566~</p> <p>\u672c\u7ae0\u8282\u4f1a\u8bb2\u89e3\u524d\u7aef\u57fa\u7840\u5185\u5bb9\uff08\u5982\u679c\u5df2\u7ecf\u5b66\u4e60\u8fc7\uff0c\u53ef\u4ee5\u76f4\u63a5\u8df3\u5230\u4e0b\u4e00\u4e2a\u5927\u7ae0\u8282\u4e86\uff09\u90a3\u4e48\u4ec0\u4e48\u662f\u524d\u7aef\uff0c\u4ec0\u4e48\u53c8\u662f\u540e\u7aef\u5462\uff1f</p> <ul> <li>\u524d\u7aef\uff1a\u6211\u4eec\u7f51\u7ad9\u7684\u9875\u9762\uff0c\u5305\u62ec\u7f51\u7ad9\u7684\u6837\u5f0f\u3001\u56fe\u7247\u3001\u89c6\u9891\u7b49\u4e00\u5207\u7528\u6237\u53ef\u89c1\u7684\u5185\u5bb9\u90fd\u662f\u524d\u7aef\u7684\u5185\u5bb9\u3002</li> <li>\u540e\u7aef\uff1a\u5904\u7406\u7f51\u7ad9\u7684\u6240\u6709\u6570\u636e\u6765\u6e90\uff0c\u6bd4\u5982\u6211\u4eec\u4e4b\u524d\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u8be2\u6570\u636e\uff0c\u800c\u6211\u4eec\u67e5\u8be2\u7684\u6570\u636e\u7ecf\u8fc7\u5904\u7406\u6700\u7ec8\u4f1a\u88ab\u5c55\u793a\u5230\u524d\u7aef\uff0c\u800c\u7528\u4e8e\u5904\u7406\u524d\u7aef\u6570\u636e\u7684\u5de5\u4f5c\u5c31\u662f\u7531\u540e\u7aef\u6765\u5b8c\u6210\u7684\u3002</li> </ul> <p>\u76f8\u5f53\u4e8e\uff0c\u524d\u7aef\u4ec5\u4ec5\u662f\u4e00\u5c42\u76ae\uff0c\u5b83\u76f4\u63a5\u51b3\u5b9a\u4e86\u6574\u4e2a\u7f51\u7ad9\u7684\u7f8e\u89c2\u7a0b\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u7531\u5730\u7f16\u6392\u9875\u9762\u7684\u5e03\u5c40\uff0c\u751a\u81f3\u53ef\u4ee5\u7f16\u5199\u597d\u770b\u7684\u7279\u6548\uff1b\u800c\u7075\u9b42\u5219\u662f\u540e\u7aef\uff0c\u5982\u4f55\u5904\u7406\u7528\u6237\u7684\u4ea4\u4e92\u3001\u5982\u4f55\u5904\u7406\u6570\u636e\u67e5\u8be2\u662f\u540e\u7aef\u7684\u804c\u8d23\u6240\u5728\uff0c\u6211\u4eec\u524d\u9762\u5b66\u4e60\u7684\u90fd\u662f\u540e\u7aef\u5185\u5bb9\uff0c\u800cJava\u4e5f\u662f\u4e00\u95e8\u4e13\u6ce8\u4e8e\u540e\u7aef\u5f00\u53d1\u7684\u8bed\u8a00\u3002</p> <p>\u5bf9\u4e8e\u524d\u7aef\u5f00\u53d1\u6211\u4eec\u9700\u8981\u5b66\u4e60\u4e00\u4e9b\u65b0\u7684\u5185\u5bb9\uff0c\u53ea\u6709\u4e86\u89e3\u4e86\u5b83\u4eec\uff0c\u6211\u4eec\u624d\u80fd\u7f16\u5199\u51fa\u7f8e\u89c2\u7684\u9875\u9762\u3002</p> <p>\u672c\u6559\u7a0b\u5e76\u4e0d\u4f1a\u8fc7\u591a\u5730\u53bb\u8bb2\u89e3\u524d\u7aef\u77e5\u8bc6\uff0c\u6211\u4eec\u53ea\u4f1a\u63d0\u53ca\u4e00\u4e9b\u5fc5\u8981\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u4e3b\u8981\u5b66\u4e60\u7684\u662fJavaWeb\uff0c\u66f4\u503e\u5411\u4e8e\u540e\u7aef\u5f00\u53d1\uff0c\u5b66\u4e60\u524d\u7aef\u7684\u76ee\u7684\u53ea\u662f\u4e3a\u4e86\u8ba9\u540c\u5b66\u4eec\u4e86\u89e3\u524d\u540e\u7aef\u7684\u4ea4\u4e92\u65b9\u5f0f\uff0c\u5728\u8fdb\u884c\u540e\u7aef\u5f00\u53d1\u65f6\u601d\u8def\u80fd\u591f\u66f4\u52a0\u6e05\u6670\uff0c\u6709\u5173\u524d\u7aef\u7684\u5b8c\u6574\u5185\u5bb9\u5b66\u4e60\uff0c\u53ef\u4ee5\u6d4f\u89c8\u5176\u4ed6\u524d\u7aef\u77e5\u8bc6\u6559\u7a0b\u3002</p> <p>\u6211\u4eec\u5728\u6700\u5f00\u59cb\u8bb2\u89e3\u7f51\u7edc\u7f16\u7a0b\u65f6\uff0c\u63d0\u5230\u4e86\u6d4f\u89c8\u5668\u8bbf\u95ee\u670d\u52a1\u5668\uff0c\u5b9e\u9645\u4e0a\u6d4f\u89c8\u5668\u8bbf\u95ee\u670d\u52a1\u5668\u5c31\u662f\u4e00\u79cdB/S\u7ed3\u6784\uff0c\u800c\u6211\u4eec\u4f7f\u7528Java\u4ee3\u7801\u7f16\u5199\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u670d\u52a1\u5668\u5c31\u662f\u4e00\u79cdC/S\u7ed3\u6784\u3002</p> <p>Web\u5f00\u53d1\u8fd8\u8981\u4eceHTML\u5f00\u59cb\u8bb2\u8d77\uff0c\u8fd9\u4e2a\u8bed\u8a00\u975e\u5e38\u7b80\u5355\uff0c\u5f88\u597d\u5b66\u4e60\uff0c\u770b\u5b8c\u89c6\u9891\u5982\u679c\u4f60\u89c9\u5f97\u524d\u7aef\u7b80\u5355\u81ea\u5df1\u66f4\u559c\u6b22\u4e00\u4e9b\uff0c\u5efa\u8bae\u9a6c\u4e0a\u8f6c\u524d\u7aef\u5427\uff0c\u8fd8\u6765\u5f97\u53ca\uff0c\u5de5\u8d44\u8fd8\u6bd4\u540e\u7aef\u9ad8\uff0c\u4e0d\u50cf\u540e\u7aef\u90a3\u4e48\u67af\u71e5\u4e4f\u5473\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#html","title":"HTML\u9875\u9762","text":"<p>\u6211\u4eec\u524d\u9762\u5b66\u4e60\u4e86XML\u8bed\u8a00\uff0c\u5b83\u662f\u4e00\u79cd\u6807\u8bb0\u8bed\u8a00\uff0c\u6211\u4eec\u9700\u8981\u4ee5\u6210\u5bf9\u6807\u7b7e\u7684\u683c\u5f0f\u8fdb\u884c\u586b\u5199\uff0c\u4f46\u662f\u5b83\u662f\u4e13\u7528\u4e8e\u4fdd\u5b58\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5c55\u793a\u6570\u636e\uff0c\u800cHTML\u6070\u6070\u76f8\u53cd\uff0c\u5b83\u4e13\u7528\u4e8e\u5c55\u793a\u6570\u636e\uff0c\u7531\u4e8e\u6211\u4eec\u524d\u9762\u5df2\u7ecf\u5b66\u4e60\u8fc7XML\u8bed\u8a00\u4e86\uff0cHTML\u8bed\u8a00\u548cXML\u5f88\u76f8\u4f3c\uff0c\u6240\u4ee5\u6211\u4eec\u5b66\u4e60\u8d77\u6765\u4f1a\u5f88\u5feb\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#html_1","title":"\u7b2c\u4e00\u4e2aHTML\u9875\u9762","text":"<p>\u6211\u4eec\u524d\u9762\u77e5\u9053\uff0c\u901a\u8fc7\u6d4f\u89c8\u5668\u53ef\u4ee5\u76f4\u63a5\u6d4f\u89c8XML\u6587\u4ef6\uff0c\u800c\u6d4f\u89c8\u5668\u4e00\u822c\u662f\u7528\u4e8e\u6d4f\u89c8HTML\u6587\u4ef6\u7684\uff0c\u4ee5HTML\u8bed\u8a00\u7f16\u5199\u7684\u5185\u5bb9\uff0c\u4f1a\u88ab\u6d4f\u89c8\u5668\u8bc6\u522b\u4e3a\u4e00\u4e2a\u9875\u9762\uff0c\u5e76\u6839\u636e\u6211\u4eec\u7f16\u5199\u7684\u5185\u5bb9\uff0c\u5c06\u5bf9\u5e94\u7684\u7ec4\u4ef6\u6dfb\u52a0\u5230\u6d4f\u89c8\u5668\u7a97\u53e3\u4e2d\u3002</p> <p>\u6211\u4eec\u4e00\u822c\u4f7f\u7528Chrome\u3001Safari\u3001Microsoft Edge\u7b49\u6d4f\u89c8\u5668\u8fdb\u884c\u6d4b\u8bd5\uff0cIE\u6d4f\u89c8\u5668\u5df2\u7ecf\u5f7b\u5e95\u6dd8\u6c70\u4e86\uff01</p> <p>\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aHtml\u6587\u4ef6\u6765\u770b\u770b\u6d4f\u89c8\u5668\u4f1a\u5982\u4f55\u8bc6\u522b\uff0c\u4f7f\u7528IDEA\u4e5f\u80fd\u7f16\u5199HTML\u9875\u9762\uff0c\u6211\u4eec\u5728IDEA\u4e2d\u65b0\u5efa\u4e00\u4e2a<code>Web\u6a21\u5757</code>\uff0c\u8fdb\u5165\u4e4b\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u9879\u76ee\u4e2d\u6ca1\u6709\u4efb\u4f55\u5185\u5bb9\uff0c\u6211\u4eec\u53f3\u952e\u65b0\u5efa\u4e00\u4e2aHTML\u6587\u4ef6\uff0c\u9009\u62e9HTML5\u6587\u4ef6\uff0c\u5e76\u547d\u540d\u4e3aindex\uff0c\u521b\u5efa\u540e\u51fa\u73b0\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u5b83\u548cXML\u57fa\u672c\u957f\u5f97\u4e00\u6837\uff0c\u5e76\u4e14\u8fd8\u81ea\u5e26\u4e86\u4e00\u4e9b\u6807\u7b7e\uff0c\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u901a\u8fc7\u6d4f\u89c8\u5668\u6765\u6d4f\u89c8\u8fd9\u4e2aHTML\u6587\u4ef6\uff08\u8fd9\u91cc\u63a8\u8350\u4f7f\u7528\u5185\u7f6e\u9884\u89c8\uff0c\u4e0d\u7136\u8fd8\u5f97\u6765\u56de\u5207\u6362\u7a97\u53e3\uff09</p> <p>\u6211\u4eec\u53d1\u73b0\u73b0\u5728\u4ec0\u4e48\u4e1c\u897f\u90fd\u6ca1\u6709\uff0c\u4f46\u662f\u5728\u6d4f\u89c8\u5668\u7684\u6807\u7b7e\u4f4d\u7f6e\u663e\u793a\u4e86\u7f51\u9875\u7684\u540d\u79f0\u4e3a<code>Title</code>\uff0c\u5e76\u4e14\u663e\u793a\u4e86\u4e00\u4e2aIDEA\u7684\u56fe\u6807\u4f5c\u4e3a\u7f51\u9875\u56fe\u6807\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u7a0d\u5fae\u8fdb\u884c\u4e00\u4e9b\u4fee\u6539\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;lbw\u7684\u76f4\u64ad\u95f4&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    \u73b0\u5728\u5168\u4f53\u8d77\u7acb\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u518d\u6b21\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u6211\u4eec\u53d1\u73b0\u9875\u9762\u4e2d\u51fa\u73b0\u4e86\u6211\u4eec\u8f93\u5165\u7684\u6587\u672c\u5185\u5bb9\uff0c\u5e76\u4e14\u6807\u9898\u4e5f\u6539\u4e3a\u4e86\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u6807\u9898\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5728\u8bbe\u7f6e-&gt;\u5de5\u5177-&gt;Web\u6d4f\u89c8\u5668\u548c\u9884\u89c8\u4e2d\u5c06\u91cd\u65b0\u52a0\u8f7d\u9875\u9762\u89c4\u5219\u6539\u4e3a<code>\u53d8\u66f4\u65f6</code>\uff0c\u8fd9\u6837\u6211\u4eec\u4f7f\u7528\u5185\u7f6e\u6d4f\u89c8\u5668\u6216\u662f\u5916\u90e8\u6d4f\u89c8\u5668\uff0c\u53ef\u4ee5\u81ea\u52a8\u66f4\u65b0\u6211\u4eec\u7f16\u5199\u7684\u5185\u5bb9\u3002</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5728\u9875\u9762\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u56fe\u7247\uff0c\u968f\u4fbf\u5c06\u4e00\u5f20\u56fe\u7247\u653e\u5230html\u6587\u4ef6\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\uff0c\u547d\u540d\u4e3a<code>image.xxx</code>\uff0c\u5176\u4e2dxxx\u662f\u540e\u7f00\u540d\u79f0\uff0c\u4e0d\u8981\u4fee\u6539\uff0c\u6211\u4eec\u5728body\u8282\u70b9\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>&lt;img width=\"300\" src=\"image.xxx\" alt=\"\u5251\u5149\u5982\u6211\uff0c\u65a9\u5c3d\u725b\u6742\"&gt;\n&lt;!--  \u6ce8\u610fxxx\u66ff\u6362\u6210\u5bf9\u5e94\u7684\u540e\u7f00\u540d\u79f0  --&gt;\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u7684\u9875\u9762\u4e2d\u5c45\u7136\u80fd\u591f\u663e\u793a\u6211\u4eec\u6dfb\u52a0\u7684\u56fe\u7247\u5185\u5bb9\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7f16\u5199\u5bf9\u5e94\u7684\u6807\u7b7e\uff0c\u6d4f\u89c8\u5668\u5c31\u80fd\u591f\u81ea\u52a8\u8bc6\u522b\u4e3a\u5bf9\u5e94\u7684\u7ec4\u4ef6\uff0c\u5e76\u5c06\u5176\u5c55\u793a\u5230\u6211\u4eec\u7684\u6d4f\u89c8\u5668\u7a97\u53e3\u4e2d\u3002</p> <p>\u6211\u4eec\u518d\u6765\u770b\u770b\u63d2\u5165\u4e00\u4e2aB\u7ad9\u7684\u89c6\u9891\uff0c\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5230\u5bf9\u5e94\u7684\u89c6\u9891\u4e0b\u65b9\uff0c\u627e\u5230\u5206\u4eab\uff0c\u6211\u4eec\u770b\u5230\u6709\u4e00\u4e2a\u5d4c\u5165\u4ee3\u7801\uff1a</p> <pre><code>&lt;iframe src=\"//player.bilibili.com/player.html?aid=333231998&amp;bvid=BV1rA411g7q8&amp;cid=346917516&amp;page=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\" width=\"800\" height=\"500\"&gt; &lt;/iframe&gt;\n</code></pre> <p>\u6bcf\u4e00\u4e2a\u9875\u9762\u90fd\u662f\u901a\u8fc7\u8fd9\u4e9b\u6807\u7b7e\u6765\u7f16\u5199\u7684\uff0c\u51e0\u4e4e\u6240\u6709\u7684\u7f51\u7ad9\u90fd\u662f\u4f7f\u7528HTML\u7f16\u5199\u9875\u9762\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#html_2","title":"HTML\u8bed\u6cd5\u89c4\u8303","text":"<p>\u4e00\u4e2aHTML\u6587\u4ef6\u4e2d\u4e00\u822c\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a</p> <ul> <li>\u5934\u90e8\uff1a\u4e00\u822c\u5305\u542b\u9875\u9762\u7684\u6807\u9898\u3001\u9875\u9762\u7684\u56fe\u6807\u3001\u8fd8\u6709\u9875\u9762\u7684\u4e00\u4e9b\u8bbe\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u5728\u8fd9\u91cc\u5bfc\u5165css\u3001js\u7b49\u5185\u5bb9\u3002</li> <li>\u4e3b\u4f53\uff1a\u6574\u4e2a\u9875\u9762\u6240\u6709\u9700\u8981\u663e\u793a\u7684\u5185\u5bb9\u5168\u90e8\u5728\u4e3b\u4f53\u7f16\u5199\u3002</li> </ul> <p>\u6211\u4eec\u9996\u5148\u6765\u770b\u5934\u90e8\uff0c\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684HTML\u6587\u4ef6\u4e2d\u5934\u90e8\u5305\u542b\u4e86\u8fd9\u4e9b\u5185\u5bb9\uff1a</p> <pre><code>&lt;meta charset=\"UTF-8\"&gt;\n&lt;title&gt;lbw\u7684\u76f4\u64ad\u95f4&lt;/title&gt;\n</code></pre> <p>\u9996\u5148<code>meta</code>\u6807\u7b7e\u7528\u4e8e\u5b9a\u4e49\u9875\u9762\u7684\u4e00\u4e9b\u5143\u4fe1\u606f\uff0c\u8fd9\u91cc\u4f7f\u7528\u5b83\u6765\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5b57\u7b26\u96c6\uff08\u7f16\u7801\u683c\u5f0f\uff09\uff0c\u4e00\u822c\u662fUTF-8\uff0c\u4e0b\u9762\u7684<code>title</code>\u6807\u7b7e\u5c31\u662f\u9875\u9762\u7684\u6807\u9898\uff0c\u4f1a\u663e\u793a\u5728\u6d4f\u89c8\u5668\u7684\u4e0a\u65b9\u3002\u6211\u4eec\u73b0\u5728\u6765\u7ed9\u9875\u9762\u8bbe\u7f6e\u4e00\u4e2a\u56fe\u6807\uff0c\u56fe\u6807\u4e00\u822c\u53ef\u4ee5\u5728\u5b57\u8282\u8df3\u52a8\u7684IconPark\u7f51\u7ad9\u627e\u5230\uff1ahttps://iconpark.oceanengine.com/home\uff0c\u9009\u62e9\u4e00\u4e2a\u81ea\u5df1\u559c\u6b22\u7684\u56fe\u6807\u4e0b\u8f7d\u5373\u53ef\u3002</p> <p>\u5c06\u56fe\u6807\u653e\u5165\u5230\u9879\u76ee\u76ee\u5f55\u4e2d\uff0c\u5e76\u547d\u540d\u4e3aicon.png\uff0c\u5728HTML\u5934\u90e8\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>&lt;link rel=\"icon\" href=\"icon.png\" type=\"image/x-icon\" /&gt;\n</code></pre> <p><code>link</code>\u6807\u7b7e\u7528\u4e8e\u5173\u8054\u5f53\u524dHTML\u9875\u9762\u4e0e\u5176\u4ed6\u8d44\u6e90\u7684\u5173\u7cfb\uff0c\u5173\u7cfb\u901a\u8fc7<code>rel</code>\u5c5e\u6027\u6307\u5b9a\uff0c\u8fd9\u91cc\u4f7f\u7528\u7684\u662ficon\u8868\u793a\u8fd9\u4e2a\u6587\u4ef6\u662f\u5f53\u524d\u9875\u9762\u56fe\u6807\u3002</p> <p>\u73b0\u5728\u8bbf\u95ee\u6b64\u9875\u9762\uff0c\u6211\u4eec\u53d1\u73b0\u9875\u9762\u7684\u56fe\u6807\u5df2\u7ecf\u53d8\u6210\u6211\u4eec\u6307\u5b9a\u7684\u56fe\u6807\u6837\u5f0f\u4e86\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u518d\u6765\u770b\u4e3b\u4f53\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4e3b\u4f53\u5185\u90e8\u7f16\u5199\u8be5\u9875\u9762\u8981\u5c55\u793a\u7684\u6240\u6709\u5185\u5bb9\uff0c\u6bd4\u5982\u6211\u4eec\u4e4b\u524d\u5c31\u7528\u5230\u4e86img\u6807\u7b7e\u6765\u5c55\u793a\u4e00\u4e2a\u56fe\u7247\uff0c\u5176\u4e2d\u6bcf\u4e00\u4e2a\u6807\u7b7e\u90fd\u79f0\u4e3a\u4e00\u4e2a\u5143\u7d20\uff1a</p> <pre><code>&lt;img width=\"300\" src=\"image.xxx\" alt=\"\u5f53\u56fe\u7247\u52a0\u8f7d\u5931\u8d25\u65f6\uff0c\u663e\u793a\u7684\u6587\u672c\"&gt;\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u6807\u7b7e\u53ea\u5b58\u5728\u4e00\u4e2a\uff0c\u5e76\u6ca1\u6709\u6210\u5bf9\u51fa\u73b0\uff0cHTML\u4e2d\u6709\u4e9b\u6807\u7b7e\u662f\u5355\u6807\u7b7e\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u6709\u8fd9\u4e00\u4e2a\uff0c\u8fd8\u6709\u4e00\u4e9b\u6807\u7b7e\u662f\u53cc\u6807\u7b7e\uff0c\u5fc5\u987b\u6210\u5bf9\u51fa\u73b0\uff0cHTML\u4e2d\uff0c\u4e5f\u4e0d\u5141\u8bb8\u4ea4\u53c9\u5d4c\u5957\uff0c\u4f46\u662f\u51fa\u73b0\u4ea4\u53c9\u5d4c\u5957\u65f6\uff0c\u6d4f\u89c8\u5668\u5e76\u4e0d\u4f1a\u63d0\u793a\u9519\u8bef\uff0c\u800c\u662f\u4ecd\u65e7\u5c1d\u8bd5\u53bb\u89e3\u6790\u8fd9\u4e9b\u5185\u5bb9\uff0c\u751a\u81f3\u4f1a\u5e2e\u52a9\u6211\u4eec\u8fdb\u884c\u4e00\u5b9a\u7a0b\u5ea6\u7684\u4fee\u590d\uff0c\u6bd4\u5982\uff1a</p> <pre><code>&lt;body&gt;\n\n    &lt;iframe src=\"//player.bilibili.com/player.html?aid=333231998&amp;bvid=BV1rA411g7q8&amp;cid=346917516&amp;page=1\" width=\"800\" height=\"500\"\n            scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\"&gt;\n&lt;/body&gt;\n&lt;/iframe&gt;\n</code></pre> <p>\u5f88\u660e\u663e\u4e0a\u9762\u7684\u4ee3\u7801\u5df2\u7ecf\u51fa\u73b0\u4ea4\u53c9\u5d4c\u5957\u7684\u60c5\u51b5\u4e86\uff0c\u4f46\u662f\u4f9d\u7136\u80fd\u591f\u5728\u6d4f\u89c8\u5668\u4e2d\u6b63\u786e\u5730\u663e\u793a\u3002</p> <p>\u5728\u4e3b\u4f53\u4e2d\uff0c\u6211\u4eec\u4e00\u822c\u4f7f\u7528div\u6807\u7b7e\u6765\u5206\u5272\u9875\u9762\uff1a</p> <pre><code>&lt;body&gt;\n    &lt;div&gt;\u6211\u662f\u7b2c\u4e00\u5757&lt;/div&gt;\n    &lt;div&gt;\u6211\u662f\u7b2c\u4e8c\u5757&lt;/div&gt;\n&lt;/body&gt;\n</code></pre> <p>\u901a\u8fc7\u4f7f\u7528<code>div</code>\u6807\u7b7e\uff0c\u6211\u4eec\u5c06\u6574\u4e2a\u9875\u9762\u6309\u884c\u5212\u5206\uff0c\u800c\u9ad8\u5ea6\u5c31\u662f\u5185\u90e8\u5143\u7d20\u7684\u9ad8\u5ea6\uff0c\u90a3\u4e48\u5982\u679c\u53ea\u5e0c\u671b\u6309\u5143\u7d20\u5212\u5206\uff0c\u4e5f\u5c31\u662f\u8bf4\u5143\u7d20\u5360\u591a\u5927\u5c31\u5212\u5206\u591a\u5927\u7684\u7a7a\u95f4\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528<code>span</code>\u6807\u7b7e\u6765\u5212\u5206\uff1a</p> <pre><code>&lt;body&gt;\n    &lt;div&gt;\n        &lt;span&gt;\u6211\u662f\u7b2c\u4e00\u5757\u7b2c\u4e00\u4e2a\u90e8\u5206&lt;/span&gt;\n        &lt;span&gt;\u6211\u662f\u7b2c\u4e00\u5757\u7b2c\u4e8c\u4e2a\u90e8\u5206&lt;/span&gt;\n    &lt;/div&gt;\n    &lt;div&gt;\u6211\u662f\u7b2c\u4e8c\u5757&lt;/div&gt;\n&lt;/body&gt;\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>p</code>\u6bb5\u843d\u6807\u7b7e\uff0c\u5b83\u4e00\u822c\u7528\u4e8e\u6587\u7ae0\u5206\u6bb5\uff1a</p> <pre><code>&lt;body&gt;\n    &lt;p&gt;\n        \u4f60\u770b\u8fd9\u4e2a\u5f6c\u5f6c\u554a\uff0c\u624d\u559d\u51e0\u7f50\u5c31\u9189\u4e86\uff0c\u771f\u7684\u592a\u900a\u4e86\u3002 \u8fd9\u4e2a\u5f6c\u5f6c\u5c31\u662f\u900a\u5440\uff01\n        \u542c\u4f60\u8fd9\u4e48\u8bf4\uff0c\u4f60\u5f88\u52c7\u54e6\uff1f \u5f00\u73a9\u7b11\uff0c\u6211\u8d85\u52c7\u7684\uff0c\u8d85\u4f1a\u559d\u7684\u5566\u3002\n        \u8d85\u4f1a\u559d\uff0c\u5f88\u52c7\u561b\u3002\u8eab\u6750\u4e0d\u9519\u54e6\uff0c\u86ee\u7ed3\u5b9e\u7684\u561b\u3002\n    &lt;/p&gt;\n    &lt;p&gt;\n        \u54ce\uff0c\u6770\u54e5\uff0c\u4f60\u5e72\u561b\u554a\u3002\u90fd\u51e0\u5c81\u4e86\uff0c\u8fd8\u90a3\u4e48\u5bb3\u7f9e\uff01\u6211\u770b\u4f60\uff0c\u5b8c\u5168\u662f\u4e0d\u61c2\u54e6\uff01\n        \u61c2\uff0c\u61c2\u4ec0\u4e48\u554a\uff1f \u4f60\u60f3\u61c2\uff1f\u6211\u623f\u91cc\u6709\u4e00\u4e9b\u597d\u5eb7\u7684\u3002\n        \u597d\u5eb7\uff0c\u662f\u65b0\u6e38\u620f\u54e6\uff01 \u4ec0\u4e48\u65b0\u6e38\u620f\uff0c\u6bd4\u6e38\u620f\u8fd8\u523a\u6fc0\uff01\n    &lt;/p&gt;\n    &lt;p&gt;\n        \u6770\u54e5\uff0c\u8fd9\u662f\u4ec0\u4e48\u554a\uff1f \u54ce\u5466\uff0c\u4f60\u8138\u7ea2\u5566\uff01\u6765\uff0c\u8ba9\u6211\u770b\u770b\u3002\n        \u4e0d\u8981\u5566\uff01\uff01 \u8ba9\u6211\u770b\u770b\u561b\u3002 \u4e0d\u8981\u5566\uff0c\u6770\u54e5\uff0c\u4f60\u5e72\u561b\u554a\uff01\n        \u8ba9\u6211\u770b\u770b\u4f60\u6cd5\u8bed\u6b63\u4e0d\u6b63\u5e38\u554a\uff01\n    &lt;/p&gt;\n&lt;/body&gt;\n</code></pre> <p>\u90a3\u4e48\u5982\u679c\u9047\u5230\u7279\u6b8a\u5b57\u7b26\u8be5\u600e\u4e48\u529e\u5462\uff1f\u548cXML\u4e00\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8f6c\u4e49\u5b57\u7b26\uff1a</p> <p></p> <p>\u6ce8\u610f\uff1a\u591a\u4e2a\u8fde\u7eed\u7684\u7a7a\u683c\u5b57\u7b26\u53ea\u80fd\u88ab\u8bc6\u522b\u4e3a\u4e00\u4e2a\uff0c\u5982\u679c\u9700\u8981\u8fde\u7eed\u591a\u4e2a\u5fc5\u987b\u4f7f\u7528\u8f6c\u4e49\u5b57\u7b26\uff0c\u540c\u65f6\u4e5f\u4e0d\u4f1a\u8bc6\u522b\u6362\u884c\uff0c\u6362\u884c\u53ea\u4f1a\u53d8\u6210\u4e00\u4e2a\u7a7a\u683c\uff0c\u9700\u8981\u6362\u884c\u5fc5\u987b\u4f7f\u7528<code>br</code>\u6807\u7b7e\u3002</p> <p>\u901a\u8fc7\u4e86\u89e3\u4e86HTML\u7684\u4e00\u4e9b\u57fa\u7840\u8bed\u6cd5\uff0c\u6211\u4eec\u73b0\u5728\u5c31\u77e5\u9053\u4e00\u4e2a\u9875\u9762\u5927\u81f4\u662f\u5982\u4f55\u7f16\u5199\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#html_3","title":"HTML\u5e38\u7528\u6807\u7b7e","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86HTML\u7684\u57fa\u672c\u8bed\u6cd5\u89c4\u8303\uff0c\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u5c31\u6765\u770b\u770b\uff0c\u6709\u54ea\u4e9b\u5e38\u7528\u7684\u6807\u7b7e\u5427\uff0c\u9996\u5148\u662f\u6362\u884c\u548c\u5206\u5272\u7ebf\uff1a</p> <ul> <li>br \u6362\u884c</li> <li>hr \u5206\u5272\u7ebf</li> </ul> <pre><code>&lt;body&gt;\n    &lt;div&gt;\n        \u6211\u662f\u4e00\u6bb5\u6587\u5b57&lt;br&gt;\u6211\u662f\u7b2c\u4e8c\u6bb5\u6587\u5b57\n    &lt;/div&gt;\n    &lt;hr&gt;\n    &lt;div&gt;\u6211\u662f\u5e95\u90e8\u6587\u5b57&lt;/div&gt;\n&lt;/body&gt;\n</code></pre> <p>\u6807\u9898\u4e00\u822c\u7528h1\u5230h6\u8868\u793a\uff0c\u6211\u4eec\u6765\u770b\u770b\u6548\u679c\uff1a</p> <pre><code>&lt;body&gt;\n&lt;h1&gt;\u4e00\u7ea7\u6807\u9898&lt;/h1&gt;\n&lt;h2&gt;\u4e8c\u7ea7\u6807\u9898&lt;/h2&gt;\n&lt;h3&gt;\u4e09\u7ea7\u6807\u9898&lt;/h3&gt;\n&lt;h4&gt;\u56db\u7ea7\u6807\u9898&lt;/h4&gt;\n&lt;h5&gt;\u4e94\u7ea7\u6807\u9898&lt;/h5&gt;\n&lt;h6&gt;\u516d\u7ea7\u6807\u9898&lt;/h6&gt;\n&lt;p&gt;\u6211\u662f\u6b63\u6587\u5185\u5bb9\uff0c\u771f\u4e0d\u9519\u3002&lt;/p&gt;\n&lt;/body&gt;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u8d85\u94fe\u63a5\uff0c\u6211\u4eec\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2a\u94fe\u63a5\u7528\u4e8e\u6307\u5411\u5176\u4ed6\u7f51\u7ad9\uff1a</p> <pre><code>&lt;a href=\"https://www.bilibili.com\"&gt;\u70b9\u51fb\u8bbf\u95ee\u5c0f\u7834\u7ad9&lt;/a&gt;\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u6307\u5b9a\u9875\u9762\u4e0a\u7684\u4e00\u4e2a\u951a\u70b9\u8fdb\u884c\u6eda\u52a8\uff1a</p> <pre><code>&lt;body&gt;\n&lt;a href=\"#test\"&gt;\u8df3\u8f6c\u951a\u70b9&lt;/a&gt;\n&lt;img src=\"image.jpeg\" width=\"500\"&gt;\n&lt;img src=\"image.jpeg\" width=\"500\"&gt;\n&lt;img src=\"image.jpeg\" width=\"500\"&gt;\n&lt;img src=\"image.jpeg\" width=\"500\"&gt;\n&lt;div id=\"test\"&gt;\u6211\u662f\u951a\u70b9&lt;/div&gt;\n&lt;img src=\"image.jpeg\" width=\"500\"&gt;\n&lt;img src=\"image.jpeg\" width=\"500\"&gt;\n&lt;img src=\"image.jpeg\" width=\"500\"&gt;\n&lt;/body&gt;\n</code></pre> <p>\u6bcf\u4e2a\u5143\u7d20\u90fd\u53ef\u4ee5\u6709\u4e00\u4e2aid\u5c5e\u6027\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ed9\u5143\u7d20\u6dfb\u52a0\u4e00\u4e2aid\u5c5e\u6027\uff0c\u5c31\u4f7f\u7528a\u6807\u7b7e\u53ef\u4ee5\u8df3\u8f6c\u5230\u4e00\u4e2a\u6307\u5b9a\u951a\u70b9\u3002</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u770b\u5217\u8868\u5143\u7d20\uff0c\u8fd9\u662f\u4e00\u4e2a\u65e0\u9700\u5217\u8868\uff0c\u5176\u4e2d\u6bcf\u4e00\u4e2a<code>li</code>\u8868\u793a\u4e00\u4e2a\u5217\u8868\u9879\uff1a</p> <pre><code>&lt;ul&gt;\n    &lt;li&gt;\u4e00\u53f7\u9009\u9879&lt;/li&gt;\n    &lt;li&gt;\u4e8c\u53f7\u9009\u9879&lt;/li&gt;\n    &lt;li&gt;\u4e09\u53f7\u9009\u9879&lt;/li&gt;\n    &lt;li&gt;\u56db\u53f7\u9009\u9879&lt;/li&gt;\n    &lt;li&gt;\u4e94\u53f7\u9009\u9879&lt;/li&gt;\n&lt;/ul&gt;\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>ol</code>\u6765\u663e\u793a\u4e00\u4e2a\u6709\u5e8f\u5217\u8868\uff1a</p> <pre><code>&lt;ol&gt;\n    &lt;li&gt;\u4e00\u53f7\u9009\u9879&lt;/li&gt;\n    &lt;li&gt;\u4e8c\u53f7\u9009\u9879&lt;/li&gt;\n    &lt;li&gt;\u4e09\u53f7\u9009\u9879&lt;/li&gt;\n    &lt;li&gt;\u56db\u53f7\u9009\u9879&lt;/li&gt;\n    &lt;li&gt;\u4e94\u53f7\u9009\u9879&lt;/li&gt;\n&lt;/ol&gt;\n</code></pre> <p>\u8868\u683c\u4e5f\u662f\u5f88\u91cd\u8981\u7684\u4e00\u79cd\u5143\u7d20\uff0c\u4f46\u662f\u5b83\u7f16\u5199\u8d77\u6765\u76f8\u5bf9\u6709\u4e00\u70b9\u9ebb\u70e6\uff1a</p> <pre><code>&lt;table&gt;\n    &lt;thead&gt;\n    &lt;tr&gt;\n        &lt;th&gt;\u5b66\u53f7&lt;/th&gt;\n        &lt;th&gt;\u59d3\u540d&lt;/th&gt;\n        &lt;th&gt;\u6027\u522b&lt;/th&gt;\n        &lt;th&gt;\u5e74\u7ea7&lt;/th&gt;\n    &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n    &lt;tr&gt;\n        &lt;td&gt;0001&lt;/td&gt;\n        &lt;td&gt;\u5c0f\u660e&lt;/td&gt;\n        &lt;td&gt;\u7537&lt;/td&gt;\n        &lt;td&gt;2019&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;0002&lt;/td&gt;\n        &lt;td&gt;\u5c0f\u7ea2&lt;/td&gt;\n        &lt;td&gt;\u5973&lt;/td&gt;\n        &lt;td&gt;2020&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre> <p>\u867d\u7136\u8fd9\u6837\u751f\u6210\u4e86\u4e00\u4e2a\u8868\u683c\uff0c\u4f46\u662f\u8fd9\u4e2a\u8868\u683c\u5e76\u6ca1\u6709\u5206\u5272\u7ebf\uff0c\u5e76\u4e14\u683c\u5f0f\u4e5f\u4e0d\u7b26\u5408\u6211\u4eec\u60f3\u8981\u7684\u6837\u5f0f\uff0c\u90a3\u4e48\u5982\u4f55\u624d\u80fd\u4fee\u6539\u8fd9\u4e9b\u57fa\u7840\u5c5e\u6027\u7684\u6837\u5f0f\u5462\uff0c\u6211\u4eec\u5c31\u9700\u8981\u804a\u804aCSS\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#html_4","title":"HTML\u8868\u5355","text":"<p>\u8868\u5355\u5c31\u50cf\u5176\u540d\u5b57\u4e00\u6837\uff0c\u7528\u6237\u5728\u9875\u9762\u4e2d\u586b\u5199\u4e86\u5bf9\u5e94\u7684\u5185\u5bb9\uff0c\u70b9\u51fb\u6309\u94ae\u5c31\u53ef\u4ee5\u63d0\u4ea4\u5230\u540e\u53f0\uff0c\u6bd4\u5982\u767b\u9646\u754c\u9762\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u8868\u5355\u6765\u5b9e\u73b0\uff1a</p> <p>\u4e00\u4e2a\u7f51\u9875\u4e2d\u6700\u91cd\u8981\u7684\u5f53\u5c5e\u8f93\u5165\u6846\u548c\u6309\u94ae\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u521b\u5efa\u4e00\u4e2a\u8f93\u5165\u6846\u548c\u6309\u94ae\uff1a</p> <pre><code>&lt;label&gt;\n    \u6211\u662f\u8f93\u5165\u6846\n    &lt;input type=\"text\"&gt;\n&lt;/label&gt;\n</code></pre> <p>\u5bf9\u4e8e\u4e00\u4e2a\u8f93\u5165\u6846\uff0c\u6211\u4eec\u4e00\u822c\u4f1a\u5c06\u5176\u5305\u62ec\u5728\u4e00\u4e2a<code>lable</code>\u6807\u7b7e\u4e2d\uff0c\u5b83\u548cspan\u6548\u679c\u4e00\u6837\uff0c\u4f46\u662f\u6211\u4eec\u70b9\u51fb\u524d\u9762\u6587\u5b57\u4e5f\u80fd\u5feb\u901f\u83b7\u53d6\u8f93\u5165\u6846\u7126\u70b9\u3002</p> <pre><code>&lt;body&gt;\n&lt;div&gt;\u767b\u9646\u6211\u4eec\u7684\u7f51\u7ad9&lt;/div&gt;\n&lt;hr&gt;\n&lt;div&gt;\n    &lt;label&gt;\n        \u8d26\u53f7\uff1a\n        &lt;input type=\"text\"&gt;\n    &lt;/label&gt;\n&lt;/div&gt;\n&lt;div&gt;\n    &lt;label&gt;\n        \u5bc6\u7801\uff1a\n        &lt;input type=\"password\"&gt;\n    &lt;/label&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n</code></pre> <p>\u8f93\u5165\u6846\u53ef\u4ee5\u6709\u5f88\u591a\u7c7b\u578b\uff0c\u6211\u4eec\u6765\u8bd5\u8bd5\u770bpassword\uff0c\u73b0\u5728\u8f93\u5165\u5185\u5bb9\u5c31\u4e0d\u4f1a\u76f4\u63a5\u5c55\u793a\u539f\u6587\u4e86\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a\u6309\u94ae\u6709\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\uff0c\u5728\u5b66\u4e60JavaWeb\u65f6\uff0c\u6211\u4eec\u66f4\u63a8\u8350\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u540e\u9762\u8fdb\u884c\u767b\u9646\u64cd\u4f5c\u9700\u8981\u914d\u5408\u8868\u5355\u4f7f\u7528\uff1a</p> <pre><code>&lt;button&gt;\u767b\u9646&lt;/button&gt;\n&lt;input type=\"submit\" value=\"\u767b\u9646\"&gt;\n&lt;input type=\"button\" value=\"\u767b\u9646\"&gt;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5c31\u53ef\u4ee5\u5199\u4e00\u4e2a\u5927\u81f4\u7684\u767b\u9646\u9875\u9762\u4e86\uff1a</p> <pre><code>&lt;body&gt;\n    &lt;h1&gt;\u767b\u9646\u6211\u4eec\u7684\u7f51\u7ad9&lt;/h1&gt;\n    &lt;form&gt;\n        &lt;div&gt;\n            &lt;label&gt;\n                \u8d26\u53f7\uff1a\n                &lt;input type=\"text\" placeholder=\"Username...\"&gt;\n            &lt;/label&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n            &lt;label&gt;\n                \u5bc6\u7801\uff1a\n                &lt;input type=\"password\" placeholder=\"Password...\"&gt;\n            &lt;/label&gt;\n        &lt;/div&gt;\n        &lt;br&gt;\n        &lt;a href=\"https://www.baidu.com\"&gt;\u5fd8\u8bb0\u5bc6\u7801&lt;/a&gt;\n        &lt;br&gt;\n        &lt;br&gt;\n        &lt;div&gt;\n            &lt;input type=\"submit\" value=\"\u767b\u9646\"&gt;\n        &lt;/div&gt;\n    &lt;/form&gt;\n&lt;/body&gt;\n</code></pre> <p>\u8868\u5355\u4e00\u822c\u4f7f\u7528<code>form</code>\u6807\u7b7e\u5c06\u5176\u56ca\u62ec\uff0c\u4f46\u662f\u73b0\u5728\u6211\u4eec\u8fd8\u7528\u4e0d\u5230\u8868\u5355\u63d0\u4ea4\uff0c\u56e0\u6b64\u4e4b\u540e\u6211\u4eec\u518d\u6765\u8bb2\u89e3\u8868\u5355\u7684\u63d0\u4ea4\u3002</p> <p><code>input</code>\u53ea\u80fd\u5b9e\u73b0\u5355\u884c\u6587\u672c\uff0c\u90a3\u4e48\u5982\u4f55\u5b9e\u73b0\u591a\u884c\u6587\u672c\u5462\uff1f</p> <pre><code>&lt;label&gt;\n    \u8fd9\u662f\u6211\u4eec\u7684\u6587\u672c\u6846&lt;br&gt;\n    &lt;textarea placeholder=\"\u6587\u672c\u5185\u5bb9...\" cols=\"10\" rows=\"10\"&gt;&lt;/textarea&gt;\n&lt;/label&gt;\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u6307\u5b9a\u9ed8\u8ba4\u7684\u884c\u6570\u548c\u5217\u6570\uff0c\u62d6\u52a8\u5de6\u4e0b\u89d2\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6587\u672c\u6846\u7684\u5927\u5c0f\u3002</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5728\u9875\u9762\u4e2d\u6dfb\u52a0\u52fe\u9009\u6846\uff1a</p> <pre><code>&lt;label&gt;\n    &lt;input type=\"checkbox\"&gt;\n    \u6211\u540c\u610f\u672c\u7f51\u7ad9\u7684\u9690\u79c1\u653f\u7b56\n&lt;/label&gt;\n</code></pre> <p>\u4e0a\u9762\u6f14\u793a\u7684\u662f\u4e00\u4e2a\u591a\u9009\u6846\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770b\u5355\u9009\u6846\uff1a</p> <pre><code>&lt;label&gt;\n    &lt;input type=\"radio\" name=\"role\"&gt;\n    \u5b66\u751f\n&lt;/label&gt;\n&lt;label&gt;\n    &lt;input type=\"radio\" name=\"role\"&gt;\n    \u6559\u5e08\n&lt;/label&gt;\n</code></pre> <p>\u8fd9\u91cc\u9700\u8981\u4f7f\u7528name\u5c5e\u6027\u8fdb\u884c\u5206\u7ec4\uff0c\u540c\u4e00\u4e2a\u7ec4\u5185\u7684\u9009\u9879\u53ea\u80fd\u9009\u62e9\u4e00\u4e2a\u3002</p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u6dfb\u52a0\u5217\u8868\u8ba9\u7528\u6237\u8fdb\u884c\u9009\u62e9\uff0c\u521b\u5efa\u4e00\u4e2a\u4e0b\u62c9\u5217\u8868\uff1a</p> <pre><code>&lt;label&gt;\n    \u767b\u9646\u8eab\u4efd\uff1a\n    &lt;select&gt;\n        &lt;option&gt;\u5b66\u751f&lt;/option&gt;\n        &lt;option&gt;\u6559\u5e08&lt;/option&gt;\n    &lt;/select&gt;\n&lt;/label&gt;\n</code></pre> <p>\u9ed8\u8ba4\u9009\u53d6\u7684\u662f\u7b2c\u4e00\u4e2a\u9009\u9879\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>selected</code>\u5c5e\u6027\u6765\u51b3\u5b9a\u9ed8\u8ba4\u4f7f\u7528\u7684\u662f\u54ea\u4e2a\u9009\u9879\u3002</p> <p>\u5f53\u7136\uff0cHTML\u7684\u5143\u7d20\u8fdc\u4e0d\u6b62\u6211\u4eec\u6240\u63d0\u5230\u7684\u8fd9\u4e9b\uff0c\u6709\u5173\u66f4\u591aHTML\u5143\u7d20\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u81ea\u884c\u4e86\u89e3\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#css","title":"CSS\u6837\u5f0f","text":"<p>\u4e4b\u524d\u6211\u4eec\u7f16\u5199\u7684\u9875\u9762\u975e\u5e38\u57fa\u7840\uff0c\u6211\u4eec\u53ea\u80fd\u901a\u8fc7\u4e00\u4e9b\u5f88\u57fa\u672c\u7684\u5c5e\u6027\u6765\u6392\u5217\u6211\u4eec\u7684\u9875\u9762\u5143\u7d20\uff0c\u90a3\u4e48\u5982\u4f55\u5b9e\u73b0\u66f4\u9ad8\u5ea6\u7684\u81ea\u5b9a\u4e49\u5462\uff0c\u6211\u4eec\u5c31\u9700\u8981\u7528\u5230CSS\u6765\u81ea\u5b9a\u4e49\u6837\u5f0f\uff0c\u9996\u5148\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a<code>style.css</code>\u7684\u6587\u4ef6\u3002</p> <p>\u9996\u5148\u5728\u6211\u4eecHTML\u6587\u4ef6\u7684\u5934\u90e8\u6dfb\u52a0\uff1a</p> <pre><code>&lt;link href=\"style.css\" rel=\"stylesheet\"&gt;\n</code></pre> <p>\u6211\u4eec\u5728CSS\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>body {\n    text-align: center;\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u7f51\u9875\u7684\u5185\u5bb9\u5168\u90e8\u53d8\u4e3a\u5c45\u4e2d\u663e\u793a\u4e86\uff0c\u8fd9\u6b63\u662fcss\u5728\u751f\u6548\uff0c\u76f8\u5f53\u4e8e\u6211\u4eec\u73b0\u5728\u7ed9\u9875\u9762\u6dfb\u52a0\u4e86\u81ea\u5b9a\u4e49\u7684\u6837\u5f0f\u89c4\u5219\u3002</p> <p>\u5f53\u7136\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u9009\u62e9\u4e0d\u4f7f\u7528CSS\uff0c\u800c\u662f\u76f4\u63a5\u5bf9\u67d0\u4e2a\u5143\u7d20\u6dfb\u52a0\u6837\u5f0f\uff1a</p> <pre><code>&lt;body style=\"text-align: center;\"&gt;\n  ...\n</code></pre> <p>\u8fd9\u6837\u7684\u6548\u679c\u5176\u5b9e\u662f\u7b49\u540c\u4e8e\u4e0a\u9762\u7684css\u6587\u4ef6\u7684\uff0c\u76f8\u5f53\u4e8e\u6211\u4eec\u76f4\u63a5\u628a\u6837\u5f0f\u5b9a\u4e49\u5728\u6307\u5b9a\u5143\u7d20\u4e0a\u3002</p> <p>\u4e5f\u53ef\u4ee5\u5728\u5934\u90e8\u76f4\u63a5\u5b9a\u4e49\u6837\u5f0f\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u5916\u90e8\u6587\u4ef6\uff1a</p> <pre><code>&lt;style&gt;\n    body {\n        text-align: center;\n    }\n&lt;/style&gt;\n</code></pre> <p>\u4f7f\u7528\u4ee5\u4e0a\u4e09\u79cd\u65b9\u5f0f\u90fd\u53ef\u4ee5\u81ea\u5b9a\u4e49\u9875\u9762\u7684\u6837\u5f0f\uff0c\u6211\u4eec\u63a8\u8350\u4f7f\u7528\u8fd8\u662f\u7b2c\u4e00\u79cd\uff0c\u4e0d\u7136\u6211\u4eec\u7684\u4ee3\u7801\u4f1a\u5f88\u7e41\u6742\u3002</p> <p>\u6837\u5f0f\u7684\u5c5e\u6027\u662f\u975e\u5e38\u591a\u7684\uff0c\u6211\u4eec\u4e0d\u53ef\u80fd\u4e00\u4e2a\u4e00\u4e2a\u5168\u90e8\u8bb2\u5b8c\uff0c\u89c6\u9891\u4e2d\u7528\u5230\u4ec0\u4e48\u518d\u6765\u8bb2\u89e3\u4ec0\u4e48\uff0c\u5982\u679c\u540c\u5b66\u4eec\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u81ea\u884c\u4e0b\u53bb\u4e86\u89e3\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#css_1","title":"CSS\u9009\u62e9\u5668","text":"<p>\u6211\u4eec\u9996\u5148\u6765\u4e86\u89e3\u4e00\u4e0b\u9009\u62e9\u5668\uff0c\u90a3\u4e48\u4ec0\u4e48\u662f\u9009\u62e9\u5668\u5462\uff1f\u6211\u4eec\u60f3\u8981\u81ea\u5b9a\u4e49\u4e00\u4e2a\u5143\u7d20\u7684\u6837\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u80af\u5b9a\u8981\u53bb\u9009\u62e9\u67d0\u4e2a\u5143\u7d20\uff0c\u53ea\u6709\u5148\u627e\u5230\u8981\u81ea\u5b9a\u4e49\u7684\u5143\u7d20\uff0c\u6211\u4eec\u624d\u80fd\u5f00\u59cb\u7f16\u5199\u6837\u5f0f\u3002</p> <p>\u6211\u4eec\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u4f7f\u7528\u7684\u5c31\u662f\u6807\u7b7e\u540d\u9009\u62e9\u5668\uff0c\u5b83\u53ef\u4ee5\u5feb\u901f\u9009\u62e9\u9875\u9762\u4e2d\u6240\u6709\u6307\u5b9a\u7684\u7684\u6807\u7b7e\uff0c\u6bd4\u5982\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u5c31\u662f<code>body</code>\u6807\u7b7e\uff0c\u90a3\u4e48\u5c31\u76f8\u5f53\u4e8e\u9875\u9762\u4e2d\u6240\u6709\u7684body\u5143\u7d20\u5168\u90fd\u4f7f\u7528\u6b64\u6837\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u6765\u8bd5\u8bd5\u770b\u9009\u62e9\u9875\u9762\u4e2d\u6240\u6709\u7684<code>input</code>\u6807\u7b7e\uff1a</p> <pre><code>input {\n    width: 200px;\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u9875\u9762\u4e2d\u6240\u6709\u7684<code>input</code>\u5143\u7d20\u5bbd\u5ea6\u5168\u90e8\u88ab\u8bbe\u5b9a\u4e3a\u4e86200\u4e2a\u50cf\u7d20\uff08<code>px</code>\u662f\u5355\u4f4d\u5927\u5c0f\uff0c\u4ee3\u8868\u50cf\u7d20\uff0c\u9664\u4e86<code>px</code>\u8fd8\u6709<code>em</code>\u548c<code>rem</code>\uff0c\u4ed6\u4eec\u662f\u6839\u636e\u5f53\u524d\u5143\u7d20\u5b57\u4f53\u5927\u5c0f\u51b3\u5b9a\u7684\u76f8\u5bf9\u5927\u5c0f\uff0c\u4e00\u822c\u7528\u4e8e\u9002\u914d\u5404\u79cd\u5927\u5c0f\u7684\u6d4f\u89c8\u5668\u7a97\u53e3\uff0c\u8fd9\u91cc\u6682\u65f6\u4e0d\u7528\uff09</p> <p>\u6837\u5f0f\u7f16\u5199\u5b8c\u6210\u540e\uff0c\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u5c5e\u6027\uff0c\u53ef\u4ee5\u4e0d\u5e26<code>;</code>\u82e5\u591a\u4e2a\u5c5e\u6027\u5219\u6bcf\u4e2a\u5c5e\u6027\u540e\u9762\u90fd\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a<code>;</code></p> <p>\u56e0\u6b64\uff0c\u4e00\u4e2a\u6807\u7b7e\u9009\u62e9\u5668\u7684\u683c\u5f0f\u4e3a\uff1a</p> <pre><code>\u6807\u7b7e\u540d\u79f0 {\n  \u5c5e\u6027\u540d\u79f0: \u5c5e\u6027\u503c\n}\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u8bbe\u5b9a\u8f93\u5165\u6846\u7684\u5b57\u4f53\u5927\u5c0f\u3001\u884c\u9ad8\u7b49\uff1a</p> <pre><code>input {\n    width: 200px;\n    font-size: 20px;\n    line-height: 40px;\n}\n</code></pre> <p>\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7\u9009\u62e9\u5668\u5feb\u901f\u5730\u53bb\u8bbe\u7f6e\u67d0\u4e2a\u5143\u7d20\u6837\u5f0f\u4e86\uff0c\u90a3\u4e48\u5982\u4f55\u5b9e\u73b0\u53ea\u8bbe\u7f6e\u67d0\u4e2a\u5143\u7d20\u7684\u6837\u5f0f\u5462\uff0c\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\uff0cid\u9009\u62e9\u5668\uff0c\u6211\u4eec\u4e4b\u524d\u5df2\u7ecf\u8bb2\u89e3\u8fc7\u4e86\uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u53ef\u4ee5\u6709\u4e00\u4e2aid\u5c5e\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u5f53\u505a\u4e00\u4e2a\u8df3\u8f6c\u7684\u951a\u70b9\u4f7f\u7528\uff0c\u800c\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528css\u6765\u8fdb\u884c\u5b9a\u4f4d\uff1a</p> <p>\u6211\u4eec\u5148\u4e3a\u5143\u7d20\u6dfb\u52a0id\u5c5e\u6027\uff1a</p> <pre><code>&lt;h1 id=\"title\"&gt;\u767b\u9646\u6211\u4eec\u7684\u7f51\u7ad9&lt;/h1&gt;\n</code></pre> <p>\u73b0\u5728\u4f7f\u7528CSS\u9009\u62e9\u6211\u4eec\u7684\u5143\u7d20\uff0c\u5e76\u8bbe\u5b9a\u4e00\u4e2a\u5c5e\u6027\uff0c\u9009\u62e9\u67d0\u4e2aid\u9700\u8981\u5728\u524d\u9762\u52a0\u4e0a\u4e00\u4e2a<code>#</code>\uff1a</p> <pre><code>#title {\n    color: red;\n}\n</code></pre> <p>\u867d\u7136id\u9009\u62e9\u5668\u5df2\u7ecf\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u6307\u5b9a\u67d0\u4e2a\u5143\u7d20\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u5e0c\u671bn\u4e2a\u4f46\u4e0d\u662f\u5143\u7d20\u90fd\u88ab\u9009\u62e9\uff0cid\u9009\u62e9\u5668\u5c31\u65e0\u6cd5\u5b9e\u73b0\u4e86\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u5143\u7d20\u7684id\u662f\u552f\u4e00\u7684\uff0c\u4e0d\u5141\u8bb8\u51fa\u73b0\u91cd\u590did\u7684\u5143\u7d20\uff0c\u56e0\u6b64\u63a5\u7740\u6211\u4eec\u6765\u8bb2\u89e3\u4e00\u4e0b\u7c7b\u9009\u62e9\u5668\u3002</p> <p>\u6bcf\u4e2a\u5143\u7d20\u90fd\u53ef\u4ee5\u6709\u4e00\u4e2a<code>class</code>\u5c5e\u6027\uff0c\u8868\u793a\u5f53\u524d\u5143\u7d20\u5c5e\u4e8e\u67d0\u4e2a\u7c7b\uff08\u6ce8\u610f\u8fd9\u91cc\u7684\u7c7b\u548c\u6211\u4eecJava\u4e2d\u7684\u7c7b\u6982\u5ff5\u5b8c\u5168\u4e0d\u540c\uff09\u4e00\u4e2a\u5143\u7d20\u53ef\u4ee5\u5c5e\u4e8e\u5f88\u591a\u4e2a\u7c7b\uff0c\u4e00\u4e2a\u7c7b\u4e5f\u53ef\u4ee5\u88ab\u5f88\u591a\u4e2a\u5143\u7d20\u4f7f\u7528\uff1a</p> <pre><code>&lt;form&gt;\n    &lt;div &gt;\n        &lt;label class=\"test\"&gt;\n            \u8d26\u53f7\uff1a\n            &lt;input type=\"text\" placeholder=\"Username...\"&gt;\n        &lt;/label&gt;\n    &lt;/div&gt;\n    &lt;div&gt;\n        &lt;label class=\"test\"&gt;\n            \u5bc6\u7801\uff1a\n            &lt;input type=\"password\" placeholder=\"Password...\"&gt;\n        &lt;/label&gt;\n    &lt;/div&gt;\n&lt;/form&gt;\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u4e24\u4e2a<code>label</code>\u5143\u7d20\u90fd\u4f7f\u7528\u4e86<code>test</code>\u7c7b\uff08\u7c7b\u540d\u79f0\u662f\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\uff09\uff0c\u73b0\u5728\u6211\u4eec\u5728css\u6587\u4ef6\u4e2d\u7f16\u5199\u4ee5\u4e0b\u5185\u5bb9\u6765\u4ee5\u7c7b\u8fdb\u884c\u9009\u62e9\uff1a</p> <p>```\u00a0css .test{     color: blue; } <pre><code>\u6211\u4eec\u53d1\u73b0\uff0c\u4e24\u4e2a\u6807\u7b7e\u7684\u6587\u672c\u5185\u5bb9\u90fd\u53d8\u4e3a\u4e86\u84dd\u8272\uff0c\u56e0\u6b64\u4f7f\u7528\u7c7b\u9009\u62e9\u5668\uff0c\u80fd\u591f\u5bf9\u6240\u6709\u4e3a\u6b64\u7c7b\u7684\u5143\u7d20\u6dfb\u52a0\u6837\u5f0f\u3002\u6ce8\u610f\u5728\u8fdb\u884c\u7c7b\u9009\u62e9\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5728\u7c7b\u540d\u524d\u9762\u52a0\u4e0a`.`\u6765\u8868\u793a\u3002\n\n### \u7ec4\u5408\u9009\u62e9\u5668\u548c\u4f18\u5148\u7ea7\u95ee\u9898\n\n\u6211\u4eec\u4e5f\u53ef\u4ee5\u8ba9\u591a\u4e2a\u9009\u62e9\u5668\uff0c\u5171\u7528\u4e00\u4e2acss\u6837\u5f0f\uff1a\n\n```css\n.test, #title {\n    color: red;\n}\n</code></pre></p> <p>\u53ea\u9700\u8981\u5e76\u6392\u5199\u5373\u53ef\uff0c\u6ce8\u610f\u4e2d\u95f4\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u82f1\u6587\u7684\u9017\u53f7\u7528\u4e8e\u5206\u5272\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>*</code>\u6765\u4e00\u6b21\u6027\u9009\u62e9\u6240\u6709\u7684\u5143\u7d20\uff1a</p> <pre><code>* {\n    color: red;\n}\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u9009\u62e9\u4f4d\u4e8e\u67d0\u4e2a\u5143\u7d20\u5185\u7684\u67d0\u4e2a\u5143\u7d20\uff1a</p> <pre><code>div label {\n    color: red;\n}\n</code></pre> <p>\u8fd9\u6837\u7684\u8bdd\uff0c\u5c31\u4f1a\u9009\u62e9\u6240\u6709\u4f4d\u4e8ediv\u5143\u7d20\u4e2d\u7684label\u5143\u7d20\u3002</p> <p>\u5f53\u7136\uff0c\u6211\u4eec\u8fd9\u91cc\u53ea\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u9009\u62e9\u5668\uff0c\u6709\u5173\u8be6\u7ec6\u7684CSS\u9009\u62e9\u5668\u53ef\u4ee5\u67e5\u9605\uff1ahttps://www.runoob.com/cssref/css-selectors.html</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u4e00\u4e0b\u9009\u62e9\u5668\u7684\u4f18\u5148\u7ea7\uff1a</p> <p></p> <p>\u6211\u4eec\u6839\u636e\u4e0a\u9762\u7684\u4fe1\u606f\uff0c\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u9996\u5148\u7f16\u5199\u4e00\u4e0bHTML\u6587\u4ef6\uff1a</p> <pre><code>&lt;body&gt;\n    &lt;div class=\"test\" id=\"simple\" style=\"color: blue\"&gt;\u6211\u662f\u6d4b\u8bd5\u6587\u672c\u5185\u5bb9&lt;/div&gt;\n&lt;/body&gt;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u6765\u7f16\u5199\u4e00\u4e0bcss\u6587\u4ef6\uff1a</p> <pre><code>.test {\n    color: yellow;\n}\n\n#simple {\n    color: red;\n}\n\n* {\n    color: palegreen;\n}\n</code></pre> <p>\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u5b9e\u9645\u4e0a\u751f\u6548\u7684\u662f\u6211\u4eec\u76f4\u63a5\u7f16\u5199\u5728\u6807\u7b7e\u5185\u90e8\u7684\u5185\u8054\u5c5e\u6027\uff0c\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u4f9d\u6b21\u8fdb\u884c\u79fb\u9664\uff0c\u6765\u770b\u770b\u5b83\u4eec\u7684\u4f18\u5148\u7ea7\u3002</p> <p>\u90a3\u4e48\u5982\u679c\u6211\u4eec\u5e0c\u671b\u67d0\u4e2a\u5c5e\u6027\u65e0\u89c6\u4efb\u4f55\u7684\u4f18\u5148\u7ea7\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5c5e\u6027\u540e\u9762\u6dfb\u52a0<code>!important</code>\u6807\u8bb0\uff0c\u8868\u793a\u6b64\u5c5e\u6027\u662f\u4e00\u4e2a\u91cd\u8981\u5c5e\u6027\uff0c\u5b83\u7684\u4f18\u5148\u7ea7\u4f1a\u88ab\u7f6e\u4e3a\u6700\u9ad8\u3002</p> <p>\u601d\u8003\uff1a\u90a3\u8981\u662f\u6211\u6bcf\u4e2a\u9009\u62e9\u5668\u7684\u8fd9\u4e2a\u5c5e\u6027\u540e\u9762\u90fd\u52a0\u4e00\u4e2a<code>!important</code>\u4f1a\u600e\u4e48\u6837\uff1f</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#_2","title":"\u81ea\u5b9a\u4e49\u8fb9\u8ddd","text":"<p>\u6211\u4eec\u6765\u770b\u770b\uff0c\u5982\u4f55\u4f7f\u7528css\u63a7\u5236\u4e00\u4e2adiv\u677f\u5757\u7684\u6837\u5f0f\uff0c\u9996\u5148\u7f16\u5199\u4ee5\u4e0b\u4ee3\u7801\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2adiv\u5d4c\u5957\u4e86\u4e00\u4e2adiv\u5143\u7d20\uff1a</p> <pre><code>&lt;div id=\"outer\"&gt;\n    &lt;div id=\"inner\"&gt;\n\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre> <p>\u73b0\u5728\u7f16\u5199\u4e00\u4e0b\u81ea\u5b9a\u4e49\u7684css\u6837\u5f0f\uff0c\u6211\u4eec\u5c06div\u8bbe\u5b9a\u4e3a\u56fa\u5b9a\u5927\u5c0f\uff0c\u5e76\u4e14\u80cc\u666f\u989c\u8272\u6dfb\u52a0\u4e3a\u7eff\u8272\uff1a</p> <pre><code>#outer {\n    background: palegreen;\n    width: 300px;\n    height: 300px;\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u5de6\u4fa7\u5feb\u901f\u9884\u89c8\u9875\u9762\u5b58\u5728\u7a7a\u9699\uff0c\u8fd9\u662f\u56e0\u4e3a\u6d4f\u89c8\u5668\u7ed9\u6211\u4eec\u6dfb\u52a0\u4e86\u4e00\u4e2a\u8fb9\u8ddd\u5c5e\u6027\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8986\u76d6\u6b64\u5c5e\u6027\u5e76\u5c06\u5176\u8bbe\u5b9a\u4e3a0\u5373\u53ef\uff1a</p> <pre><code>body {\n    margin: 0;\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u7ed9\u5185\u90e8\u5d4c\u5957\u7684div\u4e5f\u8bbe\u5b9a\u4e00\u4e2a\u5927\u5c0f\uff0c\u5e76\u5c06\u989c\u8272\u8bbe\u5b9a\u4e3a\u6a59\u8272\uff1a</p> <pre><code>#inner {\n    background: darkorange;\n    width: 100px;\n    height: 100px;\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u53d1\u73b0\u5185\u90e8\u7684div\u5143\u7d20\u4f4d\u4e8e\u53f3\u4e0a\u89d2\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u4ee5\u767e\u5206\u6bd4\u7684\u5f62\u5f0f\u6765\u6307\u5b9a\u5927\u5c0f\uff1a</p> <pre><code>#inner {\n    background: darkorange;\n    width: 100%;\n    height: 100%;\n}\n</code></pre> <p>\u767e\u5206\u6bd4\u4f1a\u4f9d\u7167\u5f53\u524d\u53ef\u7528\u5927\u5c0f\u6765\u8fdb\u884c\u5206\u914d\uff0c\u6bd4\u5982\u5f53\u524d\u4f4d\u4e8e\u4e00\u4e2adiv\u5185\u90e8\uff0c\u5e76\u4e14\u5916\u90e8div\u5143\u7d20\u662f\u56fa\u5b9a\u5927\u5c0f300px\uff0c\u56e0\u6b64100%\u5c31\u76f8\u5f53\u4e8e\u4f7f\u7528\u4e86\u5916\u90e8\u7684\u5168\u90e8\u5927\u5c0f\uff0c\u4e5f\u662f300px\uff0c\u73b0\u5728\u5185\u90e8\u5143\u7d20\u5b8c\u5168\u5c06\u5916\u90e8\u5143\u7d20\u8986\u76d6\u4e86\uff0c\u6574\u4e2a\u5143\u7d20\u73b0\u5728\u5448\u73b0\u4e3a\u6a59\u8272\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4e3a\u4e00\u4e2a\u5143\u7d20\u8bbe\u5b9a\u8fb9\u8ddd\uff0c\u8fb9\u8ddd\u5206\u4e3a\u5916\u8fb9\u8ddd\u548c\u5185\u8fb9\u8ddd\uff0c\u5916\u90e8\u5143\u7d20\u5185\u8fb9\u8ddd\u51b3\u5b9a\u4e86\u5185\u90e8\u5143\u7d20\u4e0e\u5916\u90e8\u5143\u7d20\u4e4b\u95f4\u7684\u95f4\u9694\uff0c\u6211\u4eec\u6765\u4fee\u6539\u4e00\u4e0bcss\u6837\u5f0f\uff1a</p> <pre><code>#outer {\n    background: palegreen;\n    width: 300px;\n    height: 300px;\n    padding: 10px;\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u5185\u90e8\u7684div\u5143\u7d20\u5c0f\u4e86\u4e00\u5708\uff0c\u8fd9\u662f\u56e0\u4e3a\u5916\u90e8div\u5143\u7d20\u8bbe\u5b9a\u4e86\u5185\u8fb9\u8ddd\uff0c\u4e0a\u4e0b\u5de6\u53f3\u90fd\u88ab\u8bbe\u5b9a\u4e3a10px\u5927\u5c0f\u3002</p> <p>\u800c\u6211\u4eec\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u5728\u4e00\u5f00\u59cb\u4e5f\u662f\u5c06body\u7684\u5916\u8fb9\u8ddd\u8bbe\u5b9a\u4e3a\u4e860\uff0c\u6574\u4e2a\u9875\u9762\u8ddf\u6d4f\u89c8\u5668\u7a97\u53e3\u76f4\u63a5\u95f4\u96940px\u7684\u5bbd\u5ea6\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#_3","title":"\u7f16\u5199\u4e00\u4e2a\u6f02\u4eae\u7684\u767b\u9646\u754c\u9762","text":"<p>\u73b0\u5728\u6211\u4eec\u5c31\u6765\u5c1d\u8bd5\u7f16\u5199\u4e00\u4e2a\u6f02\u4eae\u7684\u767b\u9646\u754c\u9762\u5427\uff01</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#javascript","title":"JavaScript\u8bed\u8a00","text":"<p>\u4e5f\u79f0\u4e3ajs\uff0c\u662f\u6211\u4eec\u6574\u4e2a\u524d\u7aef\u57fa\u7840\u7684\u91cd\u70b9\u5185\u5bb9\uff0c\u53ea\u6709\u4e86\u89e3\u4e86JavaScript\u8bed\u8a00\uff0c\u6211\u4eec\u624d\u80fd\u4e86\u89e3\u524d\u7aef\u5982\u4f55\u4e0e\u540e\u7aef\u4ea4\u4e92\u3002</p> <p>JavaScript\u4e0eJava\u6ca1\u6709\u6bdb\u5173\u7cfb\uff0c\u4ec5\u4ec5\u53ea\u662f\u540d\u5b57\u4e2d\u5305\u542b\u4e86Java\u800c\u5df2\uff0c\u8ddfJava\u6bd4\u8d77\u6765\uff0c\u5b83\u66f4\u50cfPython\uff0c\u5b83\u662f\u4e00\u95e8\u89e3\u91ca\u578b\u8bed\u8a00\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u7f16\u8bd1\uff0c\u5b83\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u5728\u6d4f\u89c8\u5668\u7684\u547d\u4ee4\u7a97\u53e3\u4e2d\u8fd0\u884c\u3002</p> <p>\u5b83\u76f8\u5f53\u4e8e\u662f\u524d\u7aef\u9759\u6001\u9875\u9762\u7684\u4e00\u4e2a\u8865\u5145\uff0c\u5b83\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u666e\u901a\u7684\u9875\u9762\u5728\u540e\u53f0\u6267\u884c\u4e00\u4e9b\u7a0b\u5e8f\uff0c\u6bd4\u5982\u6211\u4eec\u70b9\u51fb\u4e00\u4e2a\u6309\u94ae\uff0c\u6211\u4eec\u53ef\u80fd\u5e0c\u671b\u6267\u884c\u67d0\u4e9b\u64cd\u4f5c\uff0c\u6bd4\u5982\u4e0b\u8f7d\u6587\u4ef6\u3001\u9875\u9762\u8df3\u8f6c\u3001\u9875\u9762\u5f39\u7a97\u3001\u8fdb\u884c\u767b\u9646\u7b49\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528JavaScript\u6765\u5e2e\u52a9\u6211\u4eec\u5b9e\u73b0\u3002</p> <p>\u6211\u4eec\u6765\u770b\u770b\u4e00\u4e2a\u7b80\u5355\u7684JavaScript\u7a0b\u5e8f\uff1a</p> <pre><code>const arr = [0, 2, 1, 5, 9, 3, 4, 6, 7, 8]\n\nfor (let i = 0; i &lt; arr.length; i++) {\n    for (let j = 0; j &lt; arr.length - 1; j++) {\n        if(arr[j] &gt; arr[j+1]){\n            const tmp = arr[j]\n            arr[j] = arr[j+1]\n            arr[j+1] = tmp\n        }\n    }\n}\n\nwindow.alert(arr)\n</code></pre> <p>\u8fd9\u6bb5\u4ee3\u7801\u5b9e\u9645\u4e0a\u5c31\u662f\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5192\u6ce1\u6392\u5e8f\u7b97\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u9875\u9762\u7684\u5934\u90e8\u4e2d\u5f15\u7528\u6b64js\u6587\u4ef6\uff0c\u6d4f\u89c8\u5668\u4f1a\u5728\u52a0\u8f7d\u65f6\u81ea\u52a8\u6267\u884cjs\u6587\u4ef6\u4e2d\u7f16\u5199\u7684\u5185\u5bb9\uff1a</p> <pre><code>&lt;script src=\"test.js\"&gt;&lt;/script&gt;\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0JS\u7684\u8bed\u6cd5\u548cJava\u975e\u5e38\u76f8\u4f3c\uff0c\u4f46\u662f\u5b83\u8fd8\u662f\u548cJava\u5b58\u5728\u4e00\u4e9b\u4e0d\u540c\u4e4b\u5904\uff0c\u800c\u4e14\u5b58\u5728\u5f88\u591a\u9634\u95f4\u8bed\u6cd5\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770bJS\u7684\u8bed\u6cd5\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#javascript_1","title":"JavaScript\u57fa\u672c\u8bed\u6cd5","text":"<p>\u5728js\u4e2d\uff0c\u5b9a\u4e49\u53d8\u91cf\u548cJava\u4e2d\u6709\u4e00\u4e9b\u4e0d\u540c\uff0c\u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\u53ef\u4ee5\u4f7f\u7528<code>let</code>\u5173\u952e\u5b57\u6216\u662f<code>var</code>\u5173\u952e\u5b57\uff0cIDEA\u63a8\u8350\u6211\u4eec\u4f7f\u7528<code>let</code>\u5173\u952e\u5b57\uff0c\u56e0\u4e3a<code>var</code>\u5b58\u5728\u4e00\u5b9a\u7684\u8bbe\u8ba1\u7f3a\u9677\uff08\u8fd9\u91cc\u5c31\u4e0d\u505a\u8bb2\u89e3\u4e86\uff0c\u4e4b\u540e\u4e00\u5f8b\u4f7f\u7528let\u5173\u952e\u5b57\u8fdb\u884c\u53d8\u91cf\u58f0\u660e\uff09\uff1a</p> <pre><code>let a = 10;\na++;\nwindow.alert(a)\n</code></pre> <p>\u4e0a\u9762\u7684\u7ed3\u679c\u4e2d\uff0c\u6211\u4eec\u5f97\u5230\u4e86a\u7684\u7ed3\u679c\u662f11\uff0c\u4e5f\u5c31\u662f\u8bf4\u81ea\u589e\u548c\u81ea\u51cf\u8fd0\u7b97\u5728JS\u4e2d\u4e5f\u662f\u652f\u6301\u7684\uff0c\u5e76\u4e14JS\u6bcf\u4e00\u53e5\u7ed3\u5c3e\u53ef\u4ee5\u4e0d\u7528\u52a0\u5206\u53f7\u3002</p> <p>js\u5e76\u4e0d\u662fJava\u90a3\u6837\u7684\u5f3a\u7c7b\u578b\u8bed\u8a00\uff08\u4efb\u610f\u53d8\u91cf\u7684\u7c7b\u578b\u4e00\u5b9a\u662f\u660e\u786e\u7684\uff09\uff0c\u5b83\u662f\u4e00\u95e8\u5f31\u7c7b\u578b\u8bed\u8a00\uff0c\u53d8\u91cf\u7684\u7c7b\u578b\u5e76\u4e0d\u4f1a\u5728\u4e00\u5f00\u59cb\u786e\u5b9a\uff0c\u56e0\u6b64\u6211\u4eec\u5728\u5b9a\u4e49\u53d8\u91cf\u65f6\u65e0\u9700\u6307\u5b9a\u53d8\u91cf\u7684\u786e\u5207\u7c7b\u578b\uff0c\u800c\u662f\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u89e3\u6790\u7c7b\u578b\uff1a</p> <pre><code>let a = 10;\na = \"HelloWorld\uff01\"\nconsole.info(a)\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u53d8\u91cfa\u5df2\u7ecf\u88ab\u8d4b\u503c\u4e3a\u6570\u5b57\u7c7b\u578b\uff0c\u4f46\u662f\u6211\u4eec\u4f9d\u7136\u5728\u540e\u7eed\u80fd\u5c06\u5176\u8d4b\u503c\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5b83\u7684\u7c7b\u578b\u662f\u968f\u65f6\u53ef\u53d8\u7684\u3002</p> <p>\u5f88\u591a\u4eba\u8bf4\uff0c\u8fd9\u79cd\u53d8\u6001\u7684\u7c7b\u578b\u673a\u5236\u662fJS\u7684\u4e00\u5927\u7f3a\u9677\u3002</p> <p>\u4e16\u754c\u4e0a\u53ea\u6709\u4e24\u79cd\u8bed\u8a00\uff1a\u4e00\u79cd\u662f\u5f88\u591a\u4eba\u9a82\u7684\uff0c\u4e00\u79cd\u662f\u6ca1\u4eba\u7528\u7684\u3002</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u770b\uff0cJS\u4e2d\u5b58\u5728\u7684\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff1a</p> <ul> <li>Number\uff1a\u6570\u5b57\u7c7b\u578b\uff08\u5305\u62ec\u5c0f\u6570\u548c\u6574\u6570\uff09</li> <li>String\uff1a\u5b57\u7b26\u4e32\u7c7b\u578b\uff08\u53ef\u4ee5\u4f7f\u7528\u5355\u5f15\u53f7\u6216\u662f\u53cc\u5f15\u53f7\uff09</li> <li>Boolean\uff1a\u5e03\u5c14\u7c7b\u578b\uff08\u4e0eJava\u4e00\u81f4\uff09</li> </ul> <p>\u8fd8\u5305\u62ec\u4e00\u4e9b\u7279\u6b8a\u503c\uff1a</p> <ul> <li> <p>undefined\uff1a\u672a\u5b9a\u4e49 - \u53d8\u91cf\u58f0\u660e\u4f46\u4e0d\u8d4b\u503c\u9ed8\u8ba4\u4e3aundefined</p> </li> <li> <p>null\uff1a\u7a7a\u503c - \u7b49\u540c\u4e8eJava\u4e2d\u7684null</p> </li> <li> <p>NaN\uff1a\u975e\u6570\u5b57 - \u503c\u4e0d\u662f\u5408\u6cd5\u6570\u5b57\uff0c\u6bd4\u5982\uff1a</p> </li> </ul> <pre><code>window.alert(100/'xx')\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>typeof</code>\u5173\u952e\u5b57\u6765\u67e5\u770b\u5f53\u524d\u53d8\u91cf\u503c\u7684\u7c7b\u578b\uff1a</p> <pre><code>let a = 10;\nconsole.info(typeof a)\na = 'Hello World'\nconsole.info(typeof a)\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#javascript_2","title":"JavaScript\u903b\u8f91\u8fd0\u7b97\u548c\u6d41\u7a0b\u63a7\u5236","text":"<p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u770bjs\u4e2d\u7684\u5173\u7cfb\u8fd0\u7b97\u7b26\uff0c\u5305\u62ec\u5982\u4e0b8\u4e2a\u5173\u7cfb\u8fd0\u7b97\u7b26\uff1a\u5927\u4e8e\uff08&gt;\uff09,\u5c0f\u4e8e\uff08&lt;\uff09,\u5c0f\u4e8e\u7b49\u4e8e\uff08&lt;=\uff09,\u5927\u4e8e\u7b49\u4e8e\uff08&gt;=\uff09,\u76f8\u7b49\uff08\uff09\uff0c\u4e0d\u7b49\uff08!=\uff09\uff0c\u5168\u7b49\uff08=\uff09\uff0c\u4e0d\u5168\u7b49\uff08!==\uff09</p> <p>\u5176\u5b9e\u5173\u7cfb\u8fd0\u7b97\u7b26\u5927\u81f4\u548cJava\u4e2d\u7684\u4f7f\u7528\u65b9\u6cd5\u4e00\u81f4\uff0c\u4e0d\u8fc7\u5b83\u8fd8\u53ef\u4ee5\u8fdb\u884c\u5b57\u7b26\u4e32\u6bd4\u8f83\uff0c\u6709\u70b9\u50cfC++\u7684\u8bed\u6cd5\uff1a</p> <pre><code>console.info(666 &gt; 777)\nconsole.info('aa' &gt; 'ab')\n</code></pre> <p>\u90a3\u4e48\uff0c\u76f8\u7b49\u548c\u5168\u7b49\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f</p> <pre><code>console.info('10' == 10)\nconsole.info('10' === 10)\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u5728Java\u4e2d\uff0c\u82e5\u8fd0\u7b97\u7b26\u4e24\u8fb9\u662f\u4e0d\u540c\u7684\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u4f1a\u76f4\u63a5\u5f97\u5230false\uff0c\u800cJS\u4e2d\u5374\u4e0d\u50cf\u8fd9\u6837\uff0c\u6211\u4eec\u53d1\u73b0\u5b57\u7b26\u4e32\u768410\u5c45\u7136\u7b49\u4e8e\u6570\u5b5710\uff0c\u800c\u4f7f\u7528\u5168\u7b49\u5224\u65ad\u624d\u662f\u6211\u4eec\u5e0c\u671b\u7684\u7ed3\u679c\u3002</p> <p><code>==</code>\u7684\u6bd4\u8f83\u89c4\u5219\u662f\uff1a\u5f53\u64cd\u4f5c\u6570\u7c7b\u578b\u4e00\u6837\u65f6\uff0c\u6bd4\u8f83\u7684\u89c4\u5219\u548c\u6052\u7b49\u8fd0\u7b97\u7b26\u4e00\u6837\uff0c\u90fd\u76f8\u7b49\u624d\u76f8\u7b49\uff0c\u5982\u679c\u4e24\u4e2a\u64cd\u4f5c\u6570\u662f\u5b57\u7b26\u4e32\uff0c\u5219\u8fdb\u884c\u5b57\u7b26\u4e32\u7684\u6bd4\u8f83\uff0c\u5982\u679c\u91cc\u9762\u6709\u4e00\u4e2a\u64cd\u4f5c\u6570\u4e0d\u662f\u5b57\u7b26\u4e32\uff0c\u90a3\u4e24\u4e2a\u64cd\u4f5c\u6570\u901a\u8fc7Number()\u65b9\u6cd5\u8fdb\u884c\u8f6c\u6362\uff0c\u8f6c\u6210\u6570\u5b57\u8fdb\u884c\u6bd4\u8f83\u3002</p> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u4e0a\u9762\u8fdb\u884c\u7684\u5224\u65ad\u5b9e\u9645\u4e0a\u662f\u8fd0\u7b97\u7b26\u4e24\u8fb9\u90fd\u8fdb\u884c\u4e86\u6570\u5b57\u8f6c\u6362\u7684\u7ed3\u679c\u8fdb\u884c\u6bd4\u8f83\uff0c\u81ea\u7136\u4e5f\u5c31\u5f97\u5230\u4e86true\uff0c\u800c\u5168\u7b49\u5224\u65ad\u624d\u662f\u6211\u4eec\u5728Java\u4e2d\u8ba4\u8bc6\u7684\u76f8\u7b49\u5224\u65ad\u3002</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u903b\u8f91\u8fd0\u7b97\uff0cJS\u4e2d\u5305\u62ec&amp;&amp;\u3001||\u3001&amp;\u3001|\u3001?:\u7b49\uff0c\u6211\u4eec\u5148\u6765\u770b\u770b\u4f4d\u8fd0\u7b97\u7b26\uff1a</p> <pre><code>console.info(4 &amp; 7)\nconsole.info(4 | 7)\n</code></pre> <p>\u5b9e\u9645\u4e0a\u548cJava\u4e2d\u662f\u4e00\u6837\u7684\uff0c\u90a3\u4e48\u6211\u518d\u6765\u770b\u770b\u903b\u8f91\u8fd0\u7b97\uff1a</p> <pre><code>console.info(true || false)\n</code></pre> <p>\u5bf9\u4e8eboolean\u53d8\u91cf\u7684\u5224\u65ad\uff0c\u662f\u4e0eJava\u4e00\u81f4\u7684\uff0c\u4f46\u662fJS\u4e5f\u53ef\u4ee5\u4f7f\u7528\u975eBoolen\u7c7b\u578b\u53d8\u91cf\u8fdb\u884c\u5224\u65ad\uff1a</p> <pre><code>console.info(!0)\nconsole.info(!1)\n</code></pre> <p>\u548cC/C++\u8bed\u8a00\u4e00\u6837\uff0c0\u4ee3\u8868false\uff0c\u975e0\u4ee3\u8868true\uff0c\u90a3\u4e48\u5b57\u7b26\u4e32\u5462\uff1f</p> <pre><code>console.info(!\"a\")\nconsole.info(!\"\")\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u7a7a\u4e32\u4e3afalse\uff0c\u975e\u7a7a\u4e32\u4e3atrue\uff0c\u6211\u4eec\u518d\u6765\u770b\u770b\uff1a</p> <pre><code>console.info(true || 7)\nconsole.info(7 || true)\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u524d\u8005\u5f97\u5230\u7684\u7ed3\u679c\u4e3atrue\uff0c\u800c\u540e\u8005\u5f97\u5230\u7684\u7ed3\u679c\u5374\u662f\u662f7\uff0c\u771f\u662f\u6ed1\u5929\u4e0b\u4e4b\u5927\u7a3d\uff0c\u4ec0\u4e48\u9b3c\u73a9\u610f\uff0c\u5b9e\u9645\u4e0a\u662f\u56e0\u4e3a\uff0c\u9ed8\u8ba4\u975e0\u90fd\u662ftrue\uff0c\u800c\u540e\u8005\u53c8\u662f\u5148\u5224\u65ad\u76847\uff0c\u56e0\u6b64\u4f1a\u76f4\u63a5\u5f97\u52307\u800c\u4e0d\u662f\u88ab\u8f6c\u6362\u4e3atrue</p> <p>\u90a3\u4e48\u6211\u4eec\u518d\u6765\u770b\u770b\u51e0\u4e2a\u7279\u6b8a\u503c\u9ed8\u8ba4\u4ee3\u8868\u4ec0\u4e48\uff1a</p> <pre><code>console.info(!undefined)\nconsole.info(!null)\nconsole.info(!NaN)\n</code></pre> <p>\u6700\u540e\u6765\u4f7f\u7528\u4e00\u4e0b\u4e09\u5143\u8fd0\u7b97\u7b26\uff0c\u5b9e\u9645\u4e0a\u548cJava\u4e2d\u662f\u4e00\u6837\u7684\uff1a</p> <pre><code>let a = true ? \"xx\" : 20\nconsole.info(a)\n</code></pre> <p>\u5f97\u76ca\u4e8eJS\u7684\u52a8\u6001\u7c7b\u578b\uff0cemmm\uff0c\u4e09\u5143\u8fd0\u7b97\u7b26\u4e0d\u4e00\u5b9a\u9700\u8981\u56fa\u5b9a\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u3002</p> <p>JS\u7684\u5206\u652f\u7ed3\u6784\uff0c\u5b9e\u9645\u4e0a\u548cJava\u662f\u4e00\u6837\u7684\uff0c\u4e5f\u662f\u4f7f\u7528if-else\u8bed\u53e5\u6765\u8fdb\u884c\uff1a</p> <pre><code>if(\"lbwnb\"){   //\u975e\u7a7a\u4e32\u4e3atrue\n    console.info(\"!!!\")\n} else {\n    console.info(\"???\")\n}\n</code></pre> <p>\u540c\u7406\uff0c\u591a\u5206\u652f\u8bed\u53e5\u4e5f\u80fd\u5b9e\u73b0\uff1a</p> <pre><code>if(\"\"){\n    console.info(\"!!!\")\n} else if(-666){\n    console.info(\"???\")\n} else {\n    console.info(\"O.O\")\n}\n</code></pre> <p>\u5f53\u7136\uff0c\u591a\u5206\u652f\u8bed\u53e5\u4e5f\u53ef\u4ee5\u4f7f\u7528switch\u6765\u5b8c\u6210\uff1a</p> <pre><code>let a = \"a\"\nswitch (a){\n    case \"a\":\n        console.info(\"1\")\n        break\n    case \"b\":\n        console.info(\"2\")\n        break\n    case \"c\":\n        console.info(\"3\")\n        break\n    default:\n        console.info(\"4\")\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u770b\u770b\u5faa\u73af\u7ed3\u6784\uff0c\u5176\u5b9e\u5faa\u73af\u7ed3\u6784\u4e5f\u548cJava\u76f8\u5dee\u4e0d\u5927\uff1a</p> <pre><code>let i = 10\nwhile(i--){\n    console.info(\"100\")\n}\n</code></pre> <pre><code>for (let i = 0; i &lt; 10; i++) {\n    console.info(\"??\")\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#javascript_3","title":"JavaScript\u51fd\u6570\u5b9a\u4e49","text":"<p>JS\u4e2d\u7684\u65b9\u6cd5\u548cJava\u4e2d\u7684\u65b9\u6cd5\u5b9a\u4e49\u4e0d\u592a\u4e00\u6837\uff0cJS\u4e2d\u4e00\u822c\u79f0\u5176\u4e3a\u51fd\u6570\uff0c\u6211\u4eec\u6765\u770b\u770b\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\u7684\u683c\u5f0f\u662f\u4ec0\u4e48\uff1a</p> <pre><code>function f() {\n    console.info(\"\u6709\u4e00\u4e2a\u4eba\u524d\u6765\u4e70\u74dc\")\n}\n</code></pre> <p>\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\uff0c\u9700\u8981\u5728\u524d\u9762\u52a0\u4e0a<code>function</code>\u5173\u952e\u5b57\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u540e\u9762\u8ddf\u4e0a\u51fd\u6570\u540d\u79f0\u548c<code>()</code>\uff0c\u5176\u4e2d\u53ef\u4ee5\u5305\u542b\u53c2\u6570\uff0c\u5728<code>{}</code>\u4e2d\u7f16\u5199\u51fd\u6570\u4ee3\u7801\u3002\u6211\u4eec\u53ea\u9700\u8981\u76f4\u63a5\u4f7f\u7528\u51fd\u6570\u540d+<code>()</code>\u5c31\u80fd\u8c03\u7528\u51fd\u6570\uff1a</p> <pre><code>f();\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u4e00\u4e0b\uff0c\u5982\u4f55\u7ed9\u51fd\u6570\u6dfb\u52a0\u5f62\u5f0f\u53c2\u6570\u4ee5\u53ca\u8fd4\u56de\u503c\uff1a</p> <pre><code>function f(a) {\n    console.info(\"\u5f97\u5230\u7684\u5b9e\u53c2\u4e3a\uff1a\"+a)\n    return 666\n}\n\nf(\"aa\");\n</code></pre> <p>\u7531\u4e8eJS\u662f\u52a8\u6001\u7c7b\u578b\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u5fc5\u6307\u660e\u53c2\u6570a\u7684\u7c7b\u578b\uff0c\u540c\u65f6\u4e5f\u4e0d\u5fc5\u6307\u660e\u8fd4\u56de\u503c\u7684\u7c7b\u578b\uff0c\u4e00\u4e2a\u51fd\u6570\u53ef\u80fd\u8fd4\u56de\u4e0d\u540c\u7c7b\u578b\u7684\u7ed3\u679c\uff0c\u56e0\u6b64\u76f4\u63a5\u7f16\u5199return\u8bed\u53e5\u5373\u53ef\u3002\u540c\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8c03\u7528\u51fd\u6570\u65f6\uff0c\u4e0d\u4f20\u53c2\uff0c\u90a3\u4e48\u9ed8\u8ba4\u4f1a\u4f7f\u7528undefined\uff1a</p> <pre><code>function f(a) {\n    console.info(\"\u5f97\u5230\u7684\u5b9e\u53c2\u4e3a\uff1a\"+a)\n    return 666\n}\n\nf();\n</code></pre> <p>\u90a3\u4e48\u5982\u679c\u6211\u4eec\u5e0c\u671b\u4e0d\u4f20\u53c2\u7684\u65f6\u5019\u4f7f\u7528\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u9ed8\u8ba4\u503c\u5462\uff1f</p> <pre><code>function f(a = \"6666\") {\n    console.info(\"\u5f97\u5230\u7684\u5b9e\u53c2\u4e3a\uff1a\"+a)\n    return 666\n}\n\nf();\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u5f62\u53c2\u540e\u9762\u6307\u5b9a\u9ed8\u8ba4\u503c\u3002</p> <p>\u51fd\u6570\u672c\u8eab\u4e5f\u662f\u4e00\u79cd\u7c7b\u578b\uff0c\u4ed6\u53ef\u4ee5\u88ab\u53d8\u91cf\u63a5\u6536\uff0c\u6240\u6709\u51fd\u6570\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u88ab\u8c03\u7528\uff1a</p> <pre><code>function f(a = \"6666\") {\n    console.info(\"\u5f97\u5230\u7684\u5b9e\u53c2\u4e3a\uff1a\"+a)\n    return 666\n}\n\nlet k = f;\nk();\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5c06\u533f\u540d\u51fd\u6570\u8d4b\u503c\u7ed9\u53d8\u91cf\uff1a</p> <pre><code>let f = function (str) {\n    console.info(\"\u5b9e\u53c2\u4e3a\uff1a\"+str)\n}\n</code></pre> <p>\u65e2\u7136\u51fd\u6570\u662f\u4e00\u79cd\u7c7b\u578b\uff0c\u90a3\u4e48\u51fd\u6570\u4e5f\u80fd\u4f5c\u4e3a\u4e00\u4e2a\u53c2\u6570\u8fdb\u884c\u4f20\u9012\uff1a</p> <pre><code>function f(test) {\n    test();\n}\n\nf(function () {\n    console.info(\"\u8fd9\u662f\u4e00\u4e2a\u533f\u540d\u51fd\u6570\")\n})\n</code></pre> <p>\u5bf9\u4e8e\u6240\u6709\u7684\u533f\u540d\u51fd\u6570\uff0c\u53ef\u4ee5\u50cfJava\u7684\u533f\u540d\u63a5\u53e3\u5b9e\u73b0\u4e00\u6837\u7f16\u5199lambda\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>function f(test) {\n    test();\n}\n\nf(() =&gt; {\n    console.info(\"\u53ef\u4ee5\uff0c\u4e0d\u8ddf\u4f60\u591abb\")\n})\n</code></pre> <pre><code>function f(test) {\n    test(\"\u8fd9\u4e2a\u662f\u56de\u8c03\u53c2\u6570\");\n}\n\nf(param =&gt; {\n    console.info(\"\u63a5\u53d7\u5230\u56de\u8c03\u53c2\u6570\uff1a\"+param)\n})\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#javascript_4","title":"JavaScript\u6570\u7ec4\u548c\u5bf9\u8c61","text":"<p>JS\u4e2d\u7684\u6570\u7ec4\u5b9a\u4e49\u4e0eJava\u4e0d\u540c\uff0c\u5b83\u66f4\u50cf\u662fPython\u4e2d\u7684\u5217\u8868\uff0c\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u5e76\u4e0d\u9700\u8981\u65f6\u540c\u6837\u7684\u7c7b\u578b\uff1a</p> <pre><code>let arr = [1, \"lbwnb\", false, undefined, NaN]\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e0b\u6807\u6765\u8bbf\u95ee\uff1a</p> <pre><code>let arr = [1, \"lbwnb\", false, undefined, NaN]\nconsole.info(arr[1])\n</code></pre> <p>\u6211\u4eec\u4e00\u5f00\u59cb\u7f16\u5199\u7684\u6392\u5e8f\u7b97\u6cd5\uff0c\u4e5f\u662f\u4f7f\u7528\u4e86\u6570\u7ec4\u3002</p> <p>\u6570\u7ec4\u8fd8\u53ef\u4ee5\u52a8\u6001\u6269\u5bb9\uff0c\u5982\u679c\u6211\u4eec\u5c1d\u8bd5\u8bbf\u95ee\u8d85\u51fa\u6570\u7ec4\u957f\u5ea6\u7684\u5143\u7d20\uff0c\u5e76\u4e0d\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c\u800c\u662f\u5f97\u5230undefined\uff0c\u540c\u6837\u7684\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5f80\u8d85\u51fa\u6570\u7ec4\u957f\u5ea6\u7684\u5730\u65b9\u8bbe\u7f6e\u5143\u7d20\uff1a</p> <pre><code>let arr = [1, \"lbwnb\", false, undefined, NaN]\narr[5] = \"???\"\nconsole.info(arr)\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>push</code>\u548c<code>pop</code>\u6765\u5b9e\u73b0\u6808\u64cd\u4f5c\uff1a</p> <pre><code>let arr = [1, \"lbwnb\", false, undefined, NaN]\narr.push(\"bbb\")\nconsole.info(arr.pop())\nconsole.info(arr)\n</code></pre> <p>\u6570\u7ec4\u8fd8\u5305\u62ec\u4e00\u4e9b\u5176\u4ed6\u7684\u65b9\u6cd5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4e00\u4e00\u5217\u51fa\u4e86\uff1a</p> <pre><code>let arr = [1, \"lbwnb\", false, undefined, NaN]\narr.fill(1)\nconsole.info(arr.map(o =&gt; {\n    return 'xxx'+o\n}))\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u5bf9\u8c61\uff0cJS\u4e2d\u4e5f\u80fd\u5b9a\u4e49\u5bf9\u8c61\uff0c\u4f46\u662f\u8fd9\u91cc\u7684\u5bf9\u8c61\u6709\u70b9\u98a0\u8986\u6211\u4eec\u7684\u8ba4\u77e5\uff1a</p> <pre><code>let obj = new Object()\nlet obj = {}\n</code></pre> <p>\u4ee5\u4e0a\u4e24\u79cd\u5199\u6cd5\u90fd\u80fd\u591f\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f46\u662f\u66f4\u63a8\u8350\u4f7f\u7528\u4e0b\u9762\u7684\u4e00\u79cd\u3002</p> <p>JS\u4e2d\u7684\u5bf9\u8c61\u4e5f\u662f\u975e\u5e38\u968f\u610f\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u52a8\u6001\u4e3a\u5176\u6dfb\u52a0\u5c5e\u6027\uff1a</p> <pre><code>let obj = {}\nobj.name = \"\u4f1e\u5175\u4e00\u53f7\"\nconsole.info(obj)\n</code></pre> <p>\u540c\u7406\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7ed9\u5bf9\u8c61\u52a8\u6001\u6dfb\u52a0\u4e00\u4e2a\u51fd\u6570\uff1a</p> <pre><code>let obj = {}\nobj.f = function (){\n    console.info(\"\u6211\u662f\u5bf9\u8c61\u5185\u90e8\u7684\u51fd\u6570\")\n}\n\nobj.f()\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u5728\u51fd\u6570\u5185\u4f7f\u7528this\u5173\u952e\u5b57\u6765\u6307\u5b9a\u5bf9\u8c61\u5185\u7684\u5c5e\u6027\uff1a</p> <pre><code>let name = \"\u6211\u662f\u5916\u90e8\u53d8\u91cf\"\nlet obj = {}\nobj.name = \"\u6211\u662f\u5185\u90e8\u53d8\u91cf\"\nobj.f = function (){\n    console.info(\"name\u5c5e\u6027\u4e3a\uff1a\"+this.name)\n}\n\nobj.f()\n</code></pre> <p>\u6ce8\u610f\uff1a\u5982\u679c\u4f7f\u7528lambda\u8868\u8fbe\u5f0f\uff0c\u90a3\u4e48this\u5e76\u4e0d\u4f1a\u6307\u5411\u5bf9\u8c61\u3002</p> <p>\u9664\u4e86\u52a8\u6001\u6dfb\u52a0\u5c5e\u6027\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u4e00\u5f00\u59cb\u7684\u65f6\u5019\u6307\u5b9a\u5bf9\u8c61\u5185\u90e8\u7684\u6210\u5458\uff1a</p> <pre><code>let obj = {\n    name: \"\u6211\u662f\u5185\u90e8\u7684\u53d8\u91cf\",\n    f: function (){\n        console.info(\"name\u5c5e\u6027\u4e3a\uff1a\"+this.name)\n    }\n}\n\nobj.f()\n</code></pre> <p>\u6ce8\u610f\u5982\u679c\u6709\u591a\u884c\u5c5e\u6027\uff0c\u9700\u8981\u5728\u5c5e\u6027\u5b9a\u4e49\u540e\u6dfb\u52a0\u4e00\u4e2a<code>,</code>\u8fdb\u884c\u5206\u5272\uff01</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#javascript_5","title":"JavaScript\u4e8b\u4ef6","text":"<p>\u5f53\u6211\u4eec\u70b9\u51fb\u4e00\u4e2a\u9875\u9762\u4e2d\u7684\u6309\u94ae\u4e4b\u540e\uff0c\u6211\u4eec\u5e0c\u671b\u4e4b\u540e\u80fd\u591f\u8fdb\u884c\u767b\u9646\u64cd\u4f5c\uff0c\u6216\u662f\u6267\u884c\u4e00\u4e9bJS\u4ee3\u7801\u6765\u5b9e\u73b0\u67d0\u4e9b\u529f\u80fd\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\uff0c\u5c31\u9700\u8981\u7528\u5230\u4e8b\u4ef6\u3002</p> <p>\u4e8b\u4ef6\u76f8\u5f53\u4e8e\u4e00\u4e2a\u901a\u77e5\uff0c\u6211\u4eec\u53ef\u4ee5\u63d0\u524d\u8bbe\u5b9a\u597d\u4e8b\u4ef6\u53d1\u751f\u65f6\u9700\u8981\u6267\u884c\u7684\u5185\u5bb9\uff0c\u5f53\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0c\u5c31\u4f1a\u6267\u884c\u6211\u4eec\u9884\u5148\u8bbe\u5b9a\u597d\u7684JS\u4ee3\u7801\u3002</p> <p>\u4e8b\u4ef6\u6709\u5f88\u591a\u79cd\u7c7b\u578b\uff0c\u5176\u4e2d\u5e38\u7528\u7684\u6709\uff1a</p> <ul> <li>onclick\uff1a\u70b9\u51fb\u4e8b\u4ef6</li> <li>oninput\uff1a\u5185\u5bb9\u8f93\u5165\u4e8b\u4ef6</li> <li>onsubmit\uff1a\u5185\u5bb9\u63d0\u4ea4\u4e8b\u4ef6</li> </ul> <p>\u90a3\u4e48\u5982\u4f55\u4e3a\u4e8b\u4ef6\u6dfb\u52a0\u4e00\u4e2a\u52a8\u4f5c\u5462\uff1f</p> <pre><code>&lt;input type=\"password\" oninput=\"console.info('\u6b63\u5728\u8f93\u5165\u6587\u672c')\"&gt;\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4e3a\u4e00\u4e2a\u5143\u7d20\u6dfb\u52a0\u5bf9\u5e94\u4e8b\u4ef6\u7684\u5c5e\u6027\uff0c\u6bd4\u5982<code>oninput</code>\u4e8b\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u4e8b\u4ef6\u7684\u503c\u4e2d\u7f16\u5199js\u4ee3\u7801\uff0c\u4f46\u662f\u6ce8\u610f\uff0c\u53ea\u80fd\u4f7f\u7528\u5355\u5f15\u53f7\uff0c\u56e0\u4e3a\u53cc\u5f15\u53f7\u7528\u4e8e\u56ca\u62ec\u6574\u4e2a\u503c\u3002</p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5355\u72ec\u7f16\u5199\u4e00\u4e2a\u51fd\u6570\uff0c\u5f53\u4e8b\u4ef6\u53d1\u751f\u65f6\u76f4\u63a5\u8c03\u7528\u6211\u4eec\u7684\u51fd\u6570\uff1a</p> <pre><code>function f() {\n    window.alert(\"\u4f60\u8f93\u5165\u4e86\u4e00\u4e2a\u5b57\u7b26\")\n}\n</code></pre> <pre><code>&lt;input type=\"password\" oninput=\"oninput()\"&gt;\n</code></pre> <p>\u4ec5\u4ec5\u4e86\u89e3\u4e86\u4e8b\u4ef6\uff0c\u8fd8\u4e0d\u8db3\u4ee5\u5b9e\u73b0\u9ad8\u5ea6\u81ea\u5b9a\u4e49\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770bDOM\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#document","title":"Document\u5bf9\u8c61","text":"<p>\u5f53\u7f51\u9875\u88ab\u52a0\u8f7d\u65f6\uff0c\u6d4f\u89c8\u5668\u4f1a\u521b\u5efa\u9875\u9762\u7684\u6587\u6863\u5bf9\u8c61\u6a21\u578b\uff08Document Object Model\uff09\uff0c\u5b83\u5c06\u6574\u4e2a\u9875\u9762\u7684\u6240\u6709\u5143\u7d20\u5168\u90e8\u6620\u5c04\u4e3aJS\u5bf9\u8c61\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728JS\u4e2d\u64cd\u7eb5\u9875\u9762\u4e2d\u7684\u5143\u7d20\u3002</p> <p></p> <p>\u6bd4\u5982\u6211\u73b0\u5728\u60f3\u8981\u8bfb\u53d6\u9875\u9762\u4e2d\u67d0\u4e2a\u8f93\u5165\u6846\u4e2d\u7684\u5185\u5bb9\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u4eceDOM\u4e2d\u83b7\u53d6\u6b64\u8f93\u5165\u6846\u5143\u7d20\u7684\u5bf9\u8c61\uff1a</p> <pre><code>document.getElementById(\"pwd\").value\n</code></pre> <p>\u901a\u8fc7document\u5bf9\u8c61\u5c31\u80fd\u591f\u5feb\u901f\u83b7\u53d6\u5f53\u524d\u9875\u9762\u4e2d\u5bf9\u5e94\u7684\u5143\u7d20\uff0c\u5e76\u4e14\u6211\u4eec\u4e5f\u53ef\u4ee5\u5feb\u901f\u83b7\u53d6\u5143\u7d20\u4e2d\u7684\u4e00\u4e9b\u5c5e\u6027\u3002</p> <p>\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u7ed3\u5408\u4e8b\u4ef6\uff0c\u6765\u8fdb\u884c\u5bc6\u7801\u957f\u5ea6\u7684\u6821\u9a8c\uff0c\u5bc6\u7801\u957f\u5ea6\u5c0f\u4e8e6\u5219\u4e0d\u5408\u6cd5\uff0c\u4e0d\u5408\u6cd5\u7684\u5bc6\u7801\uff0c\u4f1a\u8ba9\u5bc6\u7801\u6846\u8fb9\u6846\u53d8\u7ea2\uff0c\u90a3\u4e48\u9996\u5148\u6211\u4eec\u5148\u6765\u7f16\u5199\u4e00\u4e2acss\u6837\u5f0f\uff1a</p> <pre><code>.illegal-pwd{\n    border: red 1px solid !important;\n    box-shadow: 0 0 5px red;\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u7f16\u5199\u4e00\u4e0bjs\u4ee3\u7801\uff0c\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\uff0c\u6b64\u51fd\u6570\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff08\u5143\u7d20\u672c\u8eab\u7684\u5bf9\u8c61\uff09\u68c0\u6d4b\u8f93\u5165\u7684\u957f\u5ea6\u662f\u5426\u5927\u4e8e6\uff0c\u5426\u5219\u5c31\u5c06\u5f53\u524d\u5143\u7d20\u7684class\u5c5e\u6027\u8bbe\u5b9a\u4e3acss\u6307\u5b9a\u7684class\uff1a</p> <pre><code>function checkIllegal(e) {\n    if(e.value.length &lt; 6) {\n        e.setAttribute(\"class\", \"illegal-pwd\")   \n    }else {\n        e.removeAttribute(\"class\")\n    }\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u5c06\u6b64\u51fd\u6570\u7ed1\u5b9a\u5230<code>oninput</code>\u4e8b\u4ef6\u5373\u53ef\uff0c\u6ce8\u610f\u4f20\u5165\u4e86\u4e00\u4e2athis\uff0c\u8fd9\u91cc\u7684this\u4ee3\u8868\u7684\u662f\u8f93\u5165\u6846\u5143\u7d20\u672c\u8eab\uff1a</p> <pre><code>&lt;input id=\"pwd\" oninput=\"checkIllegal(this)\" type=\"password\"&gt;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5728\u8f93\u5165\u7684\u65f6\u5019\uff0c\u4f1a\u81ea\u52a8\u68c0\u67e5\u5bc6\u7801\u662f\u5426\u5408\u6cd5\u3002</p> <p>\u65e2\u7136oninput\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u5c5e\u6027\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u6211\u4eec\u53ef\u4ee5\u52a8\u6001\u8fdb\u884c\u4fee\u6539\uff1a</p> <pre><code>document.getElementById(\"pwd\").oninput = () =&gt; console.info(\"???\")\n</code></pre> <p>\u90a3\u4e48\uff0c\u6211\u4eec\u524d\u9762\u63d0\u53ca\u7684window\u5bf9\u8c61\u53c8\u662f\u4ec0\u4e48\u4e1c\u897f\u5462\uff1f</p> <p>\u5b9e\u9645\u4e0aWindow\u5bf9\u8c61\u8303\u56f4\u66f4\u52a0\u5e7f\u9614\uff0c\u5b83\u751a\u81f3\u76f4\u63a5\u4ee3\u8868\u4e86\u6574\u4e2a\u7a97\u53e3\uff0c\u5f53\u7136\u4e5f\u5305\u542b\u6211\u4eec\u7684Document\u5bf9\u8c61\uff0c\u6211\u4eec\u4e00\u822c\u901a\u8fc7Window\u5bf9\u8c61\u6765\u5f39\u51fa\u63d0\u793a\u6846\u4e4b\u7c7b\u7684\u4e1c\u897f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%89%8D%E7%AB%AF/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/#xhr","title":"\u53d1\u9001XHR\u8bf7\u6c42","text":"<p>JS\u7684\u5927\u81f4\u5185\u5bb9\u6211\u4eec\u5df2\u7ecf\u5168\u90e8\u5b66\u4e60\u5b8c\u6210\u4e86\uff0c\u90a3\u4e48\u5982\u4f55\u4f7f\u7528JS\u4e0e\u540e\u7aef\u8fdb\u884c\u4ea4\u4e92\u5462\uff1f</p> <p>\u6211\u4eec\u77e5\u9053\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u63d0\u4ea4\u8868\u5355\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u5c06\u8868\u5355\u7684\u4fe1\u606f\u5168\u90e8\u53d1\u9001\u7ed9\u6211\u4eec\u7684\u670d\u52a1\u5668\uff0c\u90a3\u4e48\uff0c\u5982\u4f55\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u5462\uff1f</p> <p>\u901a\u8fc7\u4f7f\u7528XMLHttpRequest\u5bf9\u8c61\uff0c\u6765\u5411\u670d\u52a1\u5668\u53d1\u9001\u4e00\u4e2aHTTP\u8bf7\u6c42\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u8bf7\u6c42\u683c\u5f0f\uff1a</p> <pre><code>let xhr = new XMLHttpRequest();\nxhr.open('GET', 'https://www.baidu.com');\nxhr.send();\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5411\u670d\u52a1\u5668\u53d1\u8d77\u4e86\u4e00\u6b21\u7f51\u7edc\u8bf7\u6c42\uff0c\u4f46\u662f\u6211\u4eec\u8bf7\u6c42\u7684\u662f\u767e\u5ea6\u7684\u670d\u52a1\u5668\uff0c\u5e76\u4e14\u6b64\u8bf7\u6c42\u7684\u65b9\u6cd5\u4e3aGET\u8bf7\u6c42\u3002</p> <p>\u6211\u4eec\u73b0\u5728\u5c06\u5176\u7ed1\u5b9a\u5230\u4e00\u4e2a\u6309\u94ae\u4e0a\u4f5c\u4e3a\u4e8b\u4ef6\u89e6\u53d1\uff1a</p> <pre><code>function http() {\n    let xhr = new XMLHttpRequest();\n    xhr.open('GET', 'https://www.baidu.com');\n    xhr.send();    \n}\n</code></pre> <pre><code>&lt;input id=\"button\" type=\"button\" onclick=\"http()\"&gt;\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u5728\u7f51\u7edc\u4e2d\u67e5\u770b\u6211\u4eec\u53d1\u8d77\u7684HTTP\u8bf7\u6c42\u5e76\u4e14\u67e5\u770b\u8bf7\u6c42\u7684\u54cd\u5e94\u7ed3\u679c\uff0c\u6bd4\u5982\u4e0a\u9762\u7684\u8bf7\u6c42\uff0c\u4f1a\u8fd4\u56de\u767e\u5ea6\u8fd9\u4e2a\u9875\u9762\u7684\u5168\u90e8HTML\u4ee3\u7801\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u7684\u6d4f\u89c8\u5668\u5728\u6211\u4eec\u8f93\u5165\u7f51\u5740\u540e\uff0c\u4e5f\u4f1a\u5411\u5bf9\u5e94\u7f51\u7ad9\u7684\u670d\u52a1\u5668\u53d1\u8d77\u4e00\u6b21HTTP\u7684GET\u8bf7\u6c42\u3002</p> <p>\u5728\u6d4f\u89c8\u5668\u5f97\u5230\u9875\u9762\u54cd\u5e94\u540e\uff0c\u4f1a\u52a0\u8f7d\u5f53\u524d\u9875\u9762\uff0c\u5982\u679c\u5f53\u524d\u9875\u9762\u8fd8\u5f15\u7528\u4e86\u5176\u4ed6\u8d44\u6e90\u6587\u4ef6\uff0c\u90a3\u4e48\u4f1a\u7ee7\u7eed\u5411\u670d\u52a1\u5668\u53d1\u8d77\u8bf7\u6c42\uff0c\u76f4\u5230\u9875\u9762\u4e2d\u6240\u6709\u7684\u8d44\u6e90\u6587\u4ef6\u5168\u90e8\u52a0\u8f7d\u5b8c\u6210\u540e\uff0c\u624d\u4f1a\u505c\u6b62\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Java%E7%9A%84%E5%9D%91/","title":"Java\u7684\u5751","text":"<ol> <li>\u5728\u5411\u524d\u7aef\u8fd4\u56de\u6570\u636e\u65f6\uff0c\u8981\u4fdd\u8bc1\u8fd4\u56de\u6570\u636e\u4e2d\u4f7f\u7528\u7684\u7c7b\u4e2d\u7684\u5143\u7d20\u662fpublic\u7684\u6216\u8005\u62e5\u6709getter\uff0c\u5426\u5219\u65e0\u6cd5\u8f6c\u6362\u4e3ajson</li> </ol>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Jwt%E7%BB%93%E6%9E%84/","title":"Jwt\u7ed3\u6784","text":"<ol> <li>Header</li> <li>Payload</li> <li>Signature</li> </ol> <p>HEADER</p> <pre><code>{\n    \"alg\": \"HS256\",\n    \"typ\": \"JWT\"\n}\n</code></pre> <p>alg \u4f7f\u7528\u7684\u7b97\u6cd5 typ token\u7684\u7c7b\u578b</p> <p>PAYLOAD</p> <pre><code>{\n  \"sub\": \"1234567890\",\n  \"name\": \"John Doe\",\n  \"iat\": 1516239022\n}\n</code></pre> <ul> <li>iss (issuer)\uff1a\u7b7e\u53d1\u4eba</li> <li>exp (expiration time)\uff1a\u8fc7\u671f\u65f6\u95f4</li> <li>sub (subject)\uff1a\u4e3b\u9898</li> <li>aud (audience)\uff1a\u53d7\u4f17</li> <li>nbf (Not Before)\uff1a\u751f\u6548\u65f6\u95f4</li> <li>iat (Issued At)\uff1a\u7b7e\u53d1\u65f6\u95f4</li> <li>jti (JWT ID)\uff1a\u7f16\u53f7</li> </ul> <p>VERIFY SIGNATURE</p> <pre><code>HMACSHA256(\n  base64UrlEncode(header) + \".\" +\n  base64UrlEncode(payload),\n  $your-256-bit-secret\n)\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%9E%B6%E6%9E%84/","title":"\u8f6f\u4ef6\u67b6\u6784","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%9E%B6%E6%9E%84/#_2","title":"\u5206\u5c42\u67b6\u6784","text":"<p>\u8be5\u79cd\u67b6\u6784\u662f\u6700\u4e3a\u5e38\u89c1\u7684\u8f6f\u4ef6\u67b6\u6784 \u901a\u5e38\u5206\u4e3a\u4ee5\u4e0b\u56db\u5c42:</p> <ul> <li>\u8868\u73b0\u5c42\uff08presentation\uff09\uff1a\u7528\u6237\u754c\u9762\uff0c\u8d1f\u8d23\u89c6\u89c9\u548c\u7528\u6237\u4e92\u52a8</li> <li>\u4e1a\u52a1\u5c42\uff08business\uff09\uff1a\u5b9e\u73b0\u4e1a\u52a1\u903b\u8f91</li> <li>\u6301\u4e45\u5c42\uff08persistence\uff09\uff1a\u63d0\u4f9b\u6570\u636e\uff0cSQL \u8bed\u53e5\u5c31\u653e\u5728\u8fd9\u4e00\u5c42</li> <li>\u6570\u636e\u5e93\uff08database\uff09 \uff1a\u4fdd\u5b58\u6570\u636e</li> </ul> <p>\u6709\u7684\u8f6f\u4ef6\u5728\u903b\u8f91\u5c42\u548c\u6301\u4e45\u5c42\u4e4b\u95f4\uff0c\u52a0\u4e86\u4e00\u4e2a\u670d\u52a1\u5c42\uff08service\uff09\uff0c\u4ee5\u63d0\u4f9b\u4e0d\u540c\u4e1a\u52a1\u903b\u8f91\u9700\u8981\u7684\u4e00\u4e9b\u901a\u7528\u63a5\u53e3\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/%E6%9E%B6%E6%9E%84/#_3","title":"\u5fae\u670d\u52a1\u67b6\u6784","text":"<p>HTTP/RPC/ORM \u67b6\u6784 gin/gRPC/gorm</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/Mybatis/","title":"Mybatis","text":"<p>Mybatis with spring</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/Mybatis/#mybatis_1","title":"Mybatis\u521d\u6b65","text":"<p>pom.xml</p> <pre><code>        &lt;dependency&gt;\n            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n            &lt;artifactId&gt;mybatis&lt;/artifactId&gt;\n            &lt;version&gt;3.5.13&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n            &lt;version&gt;8.0.33&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n            &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;\n            &lt;version&gt;3.0.2&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;\n            &lt;version&gt;6.0.11&lt;/version&gt;\n        &lt;/dependency&gt;\n</code></pre> <p>\u76ee\u5f55\u7ed3\u6784\uff1a</p> <pre><code>.\n\u2514\u2500\u2500 main\n    \u251c\u2500\u2500 java\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 org\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 example\n    \u2502\u00a0\u00a0         \u251c\u2500\u2500 config\n    \u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 MainConfiguration.java\n    \u2502\u00a0\u00a0         \u251c\u2500\u2500 entity\n    \u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 Teacher.java\n    \u2502\u00a0\u00a0         \u251c\u2500\u2500 Main.java\n    \u2502\u00a0\u00a0         \u2514\u2500\u2500 mapper\n    \u2502\u00a0\u00a0             \u2514\u2500\u2500 TestMapper.java\n    \u2514\u2500\u2500 resources\n        \u2514\u2500\u2500 mybatis-config.xml\n</code></pre> <p>config/MainConfiguration.java</p> <p>1.xml\u5199\u6cd5 <pre><code>@Configuration\n@ComponentScans({ //\u626b\u63cfbean\n        @ComponentScan(\"org.example.entity\") \n})\n@MapperScan(\"org.example.mapper\") //\u626b\u63cfmapper\npublic class MainConfiguration {\n    @Bean\n    public SqlSessionTemplate sqlSessionTemplate() throws IOException {\n        SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(\n                Resources.getResourceAsReader(\"mybatis-config.xml\")); // \u8bfb\u53d6mybatis\u914d\u7f6e\u6587\u4ef6\n\n        return new SqlSessionTemplate(factory);\n    }\n}\n</code></pre></p> <p>2.\u6ce8\u89e3\u5199\u6cd5 <pre><code>@Configuration\n@ComponentScans({\n        @ComponentScan(\"org.example.entity\")\n})\n@MapperScan(\"org.example.mapper\") //\u626b\u63cfmapper\npublic class MainConfiguration {\n\n    @Bean //\u5355\u72ec\u521b\u5efa\u4e00\u4e2aBean\uff0c\u65b9\u4fbf\u4e4b\u540e\u66f4\u6362\n    public DataSource dataSource() {\n        return new PooledDataSource(\"com.mysql.cj.jdbc.Driver\",\n                \"jdbc:mysql://localhost:3306/study\",\n                \"root\",\n                \"123456\");\n    }\n\n    @Bean\n    public SqlSessionFactoryBean sqlSessionFactoryBean(DataSource dataSource){  //\u76f4\u63a5\u53c2\u6570\u5f97\u5230Bean\u5bf9\u8c61\n        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();\n        bean.setDataSource(dataSource);\n        return bean;\n    }\n}\n</code></pre></p> <p>entity/Teacher.java</p> <pre><code>@Data\npublic class Teacher {\n    private int tid;\n    private String name;\n    private String sex;\n}\n</code></pre> <p>mybatis-config.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;!DOCTYPE configuration\n        PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\"\n        \"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;\n&lt;configuration&gt;\n    &lt;environments default=\"development\"&gt;\n        &lt;environment id=\"development\"&gt;\n            &lt;transactionManager type=\"JDBC\"/&gt;\n            &lt;dataSource type=\"POOLED\"&gt;\n                &lt;property name=\"driver\" value=\"com.mysql.cj.jdbc.Driver\"/&gt;\n                &lt;property name=\"url\" value=\"jdbc:mysql://localhost:3306/study\"/&gt;\n                &lt;property name=\"username\" value=\"root\"/&gt;\n                &lt;property name=\"password\" value=\"123456\"/&gt;\n            &lt;/dataSource&gt;\n        &lt;/environment&gt;\n    &lt;/environments&gt;\n    &lt;mappers&gt;\n        &lt;mapper class=\"org.example.mapper.TestMapper\"/&gt;\n    &lt;/mappers&gt;\n&lt;/configuration&gt;\n</code></pre> <p>mapper/TestMapper.java</p> <pre><code>public interface TestMapper {\n    @Select(\"select * from Teacher where tid = 1\")\n    Teacher getTeacher();\n}\n</code></pre> <p>Main.java</p> <pre><code>public class Main {  \n    public static void main(String[] args) {  \n        // \u8bfb\u53d6\u914d\u7f6e\n        ApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class);\n\n        TestMapper testMapper = context.getBean(TestMapper.class);  \n\n        System.out.println(testMapper.getTeacher());  \n    }  \n}\n</code></pre> <p>output</p> <pre><code>Teacher(tid=1, name=2, sex=1)\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/Mybatis/#hikaricp","title":"HikariCP \u8fde\u63a5\u6c60","text":"<p>\u4f18\u70b9\uff0c\u901f\u5ea6\u66f4\u5feb</p> <p>pom.xml</p> <pre><code>        &lt;dependency&gt;\n            &lt;groupId&gt;com.zaxxer&lt;/groupId&gt;\n            &lt;artifactId&gt;HikariCP&lt;/artifactId&gt;\n            &lt;version&gt;5.0.1&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt; // \u65e5\u5fd7\u7ba1\u7406    \u9700\u8981\u548c slf4j-api\u7248\u672c\u4e00\u81f4\n            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n            &lt;artifactId&gt;slf4j-jdk14&lt;/artifactId&gt;\n            &lt;version&gt;2.0.0-alpha1&lt;/version&gt;\n        &lt;/dependency&gt;\n</code></pre> <p>MainConfiguration.java</p> <pre><code>@Configuration\n@ComponentScans({\n        @ComponentScan(\"org.example.entity\")\n})\n@MapperScan(\"org.example.mapper\") //\u626b\u63cfmapper\npublic class MainConfiguration {\n\n    @Bean //\u5355\u72ec\u521b\u5efa\u4e00\u4e2aBean\uff0c\u65b9\u4fbf\u4e4b\u540e\u66f4\u6362\n    public DataSource dataSource() { // \n        HikariDataSource dataSource = new HikariDataSource();\n        dataSource.setJdbcUrl(\"jdbc:mysql://localhost:3306/study\");\n        dataSource.setDriverClassName(\"com.mysql.cj.jdbc.Driver\");\n        dataSource.setUsername(\"root\");\n        dataSource.setPassword(\"a=)zgatsf8hL\");\n        return dataSource;\n    }\n\n    @Bean\n    public SqlSessionFactoryBean sqlSessionFactoryBean(DataSource dataSource){  //\u76f4\u63a5\u53c2\u6570\u5f97\u5230Bean\u5bf9\u8c61\n        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();\n        bean.setDataSource(dataSource);\n        return bean;\n    }\n}\n</code></pre> <p>\u66f4\u6539\u4e3a HikariCP</p> <p>output <pre><code>9\u6708 15, 2023 3:28:25 \u4e0b\u5348 com.zaxxer.hikari.HikariDataSource getConnection\n\u4fe1\u606f: HikariPool-1 - Starting...\n9\u6708 15, 2023 3:28:26 \u4e0b\u5348 com.zaxxer.hikari.pool.HikariPool checkFailFast\n\u4fe1\u606f: HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@a68df9\n9\u6708 15, 2023 3:28:26 \u4e0b\u5348 com.zaxxer.hikari.HikariDataSource getConnection\n\u4fe1\u606f: HikariPool-1 - Start completed.\n\nTeacher(tid=1, name=2, sex=1)\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/Mybatis/#mybatis_2","title":"Mybatis\u4e8b\u52a1\u7ba1\u7406","text":"<p>MyBatis\u7684\u4e8b\u52a1\u7ba1\u7406\u5206\u4e3a\u4e24\u79cd\u5f62\u5f0f\uff1a</p> <ol> <li>\u4f7f\u7528JDBC\u7684\u4e8b\u52a1\u7ba1\u7406\u673a\u5236\uff1a\u5373\u5229\u7528\u5bf9\u5e94\u6570\u636e\u5e93\u7684\u9a71\u52a8\u751f\u6210\u7684<code>Connection</code>\u5bf9\u8c61\u5b8c\u6210\u5bf9\u4e8b\u52a1\u7684\u63d0\u4ea4\uff08commit()\uff09\u3001\u56de\u6eda\uff08rollback()\uff09\u3001\u5173\u95ed\uff08close()\uff09\u7b49\uff0c\u5bf9\u5e94\u7684\u5b9e\u73b0\u7c7b\u4e3a<code>JdbcTransaction</code></li> <li>\u4f7f\u7528MANAGED\u7684\u4e8b\u52a1\u7ba1\u7406\u673a\u5236\uff1a\u8fd9\u79cd\u673a\u5236MyBatis\u81ea\u8eab\u4e0d\u4f1a\u53bb\u5b9e\u73b0\u4e8b\u52a1\u7ba1\u7406\uff0c\u800c\u662f\u8ba9\u7a0b\u5e8f\u7684\u5bb9\u5668\uff08\u6bd4\u5982Spring\uff09\u6765\u5b9e\u73b0\u5bf9\u4e8b\u52a1\u7684\u7ba1\u7406\uff0c\u5bf9\u5e94\u7684\u5b9e\u73b0\u7c7b\u4e3a<code>ManagedTransaction</code></li> <li>\u5982\u679c\u9700\u8981\u81ea\u5b9a\u4e49\uff0c\u90a3\u4e48\u5f97\u5b9e\u73b0<code>org.apache.ibatis.transaction.Transaction</code>\u63a5\u53e3\uff0c\u7136\u540e\u5728<code>type</code>\u5c5e\u6027\u4e2d\u6307\u5b9a\u5176\u7c7b\u540d\u3002\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u4e8b\u52a1\u7ba1\u7406\u5668\u53ef\u4ee5\u6839\u636e\u5177\u4f53\u9700\u6c42\u6765\u5b9e\u73b0\u4e00\u4e9b\u7279\u5b9a\u7684\u4e8b\u52a1\u7ba1\u7406\u884c\u4e3a\u3002</li> </ol> <p>Mybatis\u4e8b\u52a1\u7ba1\u7406</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/Mybatis/#spring","title":"Spring\u4e8b\u52a1","text":"<p>MainConfiguration.java</p> <p>\u6dfb\u52a0\u4e8b\u52a1\u7ba1\u7406\u5668</p> <pre><code>@Configuration\n@ComponentScans({\n        @ComponentScan(\"org.example\")\n})\n@MapperScan(\"org.example.mapper\") //\u626b\u63cfmapper\n@EnableTransactionManagement      // \u542f\u7528\u4e8b\u52a1\u7ba1\u7406\u5668\npublic class MainConfiguration {\n\n    @Bean\n    public TransactionManager transactionManager(DataSource dataSource) {\n        return new DataSourceTransactionManager(dataSource);\n    }\n// --------------------- snip ------------------\n}\n</code></pre> <p>mapper/TestMapper.java</p> <pre><code>@Mapper\npublic interface TestMapper {\n    @Select(\"select * from Teacher where tid = 1\")\n    Teacher getTeacher();\n\n\n    @Insert(\"insert into Teacher(name, sex) values ('\u6d4b\u8bd5', '\u7537')\")\n    void insertTeacher();\n}\n</code></pre> <p>service/TestService.java</p> <pre><code>public interface TestService {\n    void test();\n}\n</code></pre> <p>service/impl/TestServiceImpl.java</p> <pre><code>@Component\npublic class TestServiceImpl implements TestService {\n\n    @Autowired\n    TestMapper mapper;\n\n    @Transactional // \u542f\u7528\u9519\u8bef\u56de\u6eda\n    public void test() { \n        mapper.insertTeacher();\n        if (true) throw new RuntimeException(\"\u6211\u662f\u6d4b\u8bd5\u5f02\u5e38! \"); // \u5f02\u5e38\u81ea\u52a8\u56de\u6eda, \u6700\u540e\u6ca1\u6709\u63d2\u5165\n        mapper.insertTeacher();\n    }\n}\n</code></pre> <p>@Transactional() \u7684\u6bd4\u8f83\u5173\u952e\u7684\u53c2\u6570</p> <ul> <li>transactionManager\uff1a\u6307\u5b9a\u4e8b\u52a1\u7ba1\u7406\u5668</li> <li>propagation\uff1a\u4e8b\u52a1\u4f20\u64ad\u89c4\u5219\uff0c\u4e00\u4e2a\u4e8b\u52a1\u53ef\u4ee5\u5305\u62ecN\u4e2a\u5b50\u4e8b\u52a1</li> <li>isolation\uff1a\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0c\u4e0d\u591a\u8bf4\u4e86</li> <li>timeout\uff1a\u4e8b\u52a1\u8d85\u65f6\u65f6\u95f4</li> <li>readOnly\uff1a\u662f\u5426\u4e3a\u53ea\u8bfb\u4e8b\u52a1\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4f1a\u6839\u636e\u53ea\u8bfb\u5c5e\u6027\u8fdb\u884c\u4f18\u5316\uff0c\u6bd4\u5982MySQL\u4e00\u65e6\u58f0\u660e\u4e8b\u52a1\u4e3a\u53ea\u8bfb\uff0c\u90a3\u4e48\u4e45\u4e0d\u5141\u8bb8\u589e\u5220\u6539\u64cd\u4f5c\u4e86\u3002</li> <li>rollbackFor\u548cnoRollbackFor\uff1a\u53d1\u751f\u6307\u5b9a\u5f02\u5e38\u65f6\u56de\u6eda\u6216\u662f\u4e0d\u56de\u6eda\uff0c\u9ed8\u8ba4\u53d1\u751f\u4efb\u4f55\u5f02\u5e38\u90fd\u56de\u6eda\u3002</li> </ul> <p>\u4e8b\u52a1\u7684\u4f20\u64ad\u89c4\u5219\uff1a Spring\u9ed8\u8ba4\u7684\u4f20\u64ad\u7ea7\u522b\u662f<code>PROPAGATION_REQUIRED</code></p> <p>\u4f7f\u7528Spring\u4e8b\u52a1\u7ba1\u7406</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/","title":"SSM\u7b14\u8bb0\uff08\u4e00\uff09Spring\u57fa\u7840","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#spring","title":"Spring\u6838\u5fc3\u6280\u672f","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#java-spring","title":"java #spring","text":"<p>\u524d\u7f6e\u8bfe\u7a0b\u8981\u6c42\uff1a\u8bf7\u5404\u4f4d\u5c0f\u4f19\u4f34\u5148\u5b8c\u6210\u300aJavaWeb\u300b\u7bc7\u3001\u300aJava 9-17\u65b0\u7279\u6027\u300b\u7bc7\u89c6\u9891\u6559\u7a0b\u4e4b\u540e\uff0c\u518d\u6765\u89c2\u770b\u6b64\u6559\u7a0b\u3002</p> <p>\u5efa\u8bae\uff1a\u5bf9Java\u5f00\u53d1\u8fd8\u4e0d\u662f\u5f88\u719f\u6089\u7684\u540c\u5b66\uff0c\u6700\u597d\u5148\u82b1\u8d39\u534a\u4e2a\u6708\u5230\u4e00\u4e2a\u6708\u65f6\u95f4\u5927\u91cf\u5730\u53bb\u7f16\u5199\u5c0f\u9879\u76ee\uff0c\u4e0d\u63a8\u8350\u4e00\u53e3\u6c14\u5b66\u5b8c\uff0c\u540e\u9762\u7684\u5185\u5bb9\u76f8\u6bd4\u524d\u9762\u7684\u5185\u5bb9\u51e0\u4e4e\u662f\u964d\u7ef4\u6253\u51fb\uff0c\u4e00\u53e3\u6c14\u5b66\u5b8c\u5f88\u5bb9\u6613\u5fd8\u8bb0\u4e4b\u524d\u6240\u5b66\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u5c24\u5176\u662fJavaSE\u9636\u6bb5\u7684\u5185\u5bb9\u3002</p> <p>\u4e0d\u540c\u4e8e2021\u7248\u672cSSM\u6559\u7a0b\uff0c\u672c\u671f\u89c6\u9891\u4e3a\u91cd\u5236\u7248\u672c\uff0c\u89c6\u9891\u5b66\u4e60\u7684Spring\u6846\u67b6\u7248\u672c\u4e3a\uff1a6.0</p> <p>\u606d\u559c\u5404\u4f4d\u987a\u5229\u8fdb\u5165\u5230SSM\uff08Spring+SpringMVC+Mybatis\uff09\u9636\u6bb5\u7684\u5b66\u4e60\uff0c\u4e5f\u7b97\u662f\u6210\u529f\u51fa\u4e86Java\u65b0\u624b\u6751\uff0c\u7531\u4e8e\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u8fc7Mybatis\u4e86\uff0c\u56e0\u6b64\uff0c\u672c\u671f\u6559\u7a0b\u7684\u65f6\u95f4\u5b89\u6392\u76f8\u6bd4\u4e4b\u524d\u4f1a\u66f4\u77ed\u4e00\u4e9b\u3002\u4ece\u8fd9\u91cc\u5f00\u59cb\uff0c\u5f88\u591a\u7684\u6982\u5ff5\u7406\u89e3\u8d77\u6765\u5c31\u7a0d\u5fae\u6709\u4e00\u70b9\u96be\u5ea6\u4e86\uff0c\u56e0\u4e3a\u4f60\u4eec\u6ca1\u6709\u63a5\u89e6\u8fc7\u4f01\u4e1a\u5f00\u53d1\u573a\u666f\uff0c\u5f88\u96be\u4f53\u4f1a\u5230\u90a3\u79cd\u601d\u60f3\u5e26\u6765\u7684\u597d\u5904\uff0c\u751a\u81f3\u5230\u540e\u671f\u63a5\u89e6\u5230\u7684\u51e0\u4e4e\u90fd\u662f\u57fa\u4e8e\u4e91\u8ba1\u7b97\u548c\u5927\u6570\u636e\u7406\u8bba\u5b9e\u73b0\u7684\u6846\u67b6\uff08\u5f53\u4e0b\u6700\u70ed\u95e8\u6700\u524d\u6cbf\u7684\u6280\u672f\uff09\u9010\u6e10\u4e0d\u518d\u662f\u548c\u8ba1\u7b97\u673a\u57fa\u7840\u76f8\u5173\u8054\uff0c\u800c\u662f\u548c\u600e\u4e48\u9ad8\u6548\u5e72\u6d3b\u76f8\u5173\u4e86\u3002</p> <p>\u5728JavaWeb\u9636\u6bb5\uff0c\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u4e86\u5982\u4f55\u4f7f\u7528Java\u8fdb\u884cWeb\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\uff0c\u6211\u4eec\u73b0\u5728\u5df2\u7ecf\u5177\u6709\u642d\u5efaWeb\u7f51\u7ad9\u7684\u80fd\u529b\uff0c\u4f46\u662f\uff0c\u6211\u4eec\u5728\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53d1\u73b0\u5b58\u5728\u8bf8\u591a\u7684\u4e0d\u4fbf\uff0c\u5728\u6700\u540e\u7684\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u7f16\u7a0b\u5b9e\u6218\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u867d\u7136\u6211\u4eec\u601d\u8def\u5f88\u6e05\u6670\uff0c\u77e5\u9053\u5982\u4f55\u7f16\u5199\u5bf9\u5e94\u7684\u63a5\u53e3\uff0c\u4f46\u662f\u8fd9\u6837\u7684\u5f00\u53d1\u6548\u7387\uff0c\u5b9e\u5728\u662f\u592a\u6162\u4e86\uff0c\u5e76\u4e14\u5bf9\u4e8e\u5bf9\u8c61\u521b\u5efa\u7684\u7ba1\u7406\uff0c\u5b58\u5728\u8bf8\u591a\u7684\u4e0d\u59a5\u4e4b\u5904\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u8981\u53bb\u7ee7\u7eed\u5b66\u4e60\u66f4\u591a\u7684\u6846\u67b6\u6280\u672f\uff0c\u6765\u7b80\u5316\u548c\u89c4\u8303\u6211\u4eec\u7684Java\u5f00\u53d1\u3002</p> <p>Spring\u5c31\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u6846\u67b6\uff08\u6587\u6863\uff1ahttps://docs.spring.io/spring-framework/docs/6.0.10/reference/html/core.html#spring-core\uff09\uff0c\u5b83\u5c31\u662f\u4e3a\u4e86\u7b80\u5316\u5f00\u53d1\u800c\u751f\uff0c\u5b83\u662f\u8f7b\u91cf\u7ea7\u7684IoC\u548cAOP\u7684\u5bb9\u5668\u6846\u67b6\uff0c\u4e3b\u8981\u662f\u9488\u5bf9Bean\u7684\u751f\u547d\u5468\u671f\u8fdb\u884c\u7ba1\u7406\u7684\u8f7b\u91cf\u7ea7\u5bb9\u5668\uff0c\u5e76\u4e14\u5b83\u7684\u751f\u6001\u5df2\u7ecf\u53d1\u5c55\u5f97\u6781\u4e3a\u5e9e\u5927\u3002\u90a3\u4e48\uff0c\u9996\u5148\u4e00\u95ee\uff0c\u4ec0\u4e48\u662fIoC\u548cAOP\uff0c\u4ec0\u4e48\u53c8\u662fBean\u5462\uff1f\u4e0d\u8981\u5bb3\u6015\uff0c\u8fd9\u4e9b\u6982\u5ff5\u53ea\u662f\u542c\u8d77\u6765\u6ee1\u6ee1\u7684\u9ad8\u7ea7\u611f\uff0c\u5b9e\u9645\u4e0a\u6ca1\u6709\u591a\u9ad8\u7ea7\uff08\u5f88\u591a\u4e1c\u897f\u90fd\u662f\u8fd9\u6837\uff0c\u540d\u5b57\u542c\u8d77\u6765\u5f88\u725b\uff0c\u5b9e\u9645\u4e0a\u53ea\u662f\u4e00\u4e2a\u5f88\u5bb9\u6613\u7406\u89e3\u7684\u4e1c\u897f\uff09</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#ioc","title":"IoC\u5bb9\u5668\u57fa\u7840","text":"<p>Spring\u6846\u67b6\u6700\u6838\u5fc3\u7684\u5176\u5b9e\u5b83\u7684IoC\u5bb9\u5668\uff0c\u8fd9\u662f\u6211\u4eec\u5f00\u542fSpring\u5b66\u4e60\u7684\u7b2c\u4e00\u7ad9\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#ioc_1","title":"IoC\u7406\u8bba\u4ecb\u7ecd","text":"<p>\u5728\u6211\u4eec\u4e4b\u524d\u7684\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edfWeb\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u6574\u4e2a\u7a0b\u5e8f\u5176\u5b9e\u662f\u4f9d\u9760\u5404\u4e2a\u90e8\u5206\u76f8\u4e92\u534f\u4f5c\uff0c\u5171\u540c\u5b8c\u6210\u4e00\u4e2a\u64cd\u4f5c\uff0c\u6bd4\u5982\u8981\u5c55\u793a\u501f\u9605\u4fe1\u606f\u5217\u8868\uff0c\u90a3\u4e48\u9996\u5148\u9700\u8981\u4f7f\u7528Servlet\u8fdb\u884c\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u6570\u636e\u5904\u7406\uff0c\u7136\u540e\u8bf7\u6c42\u7684\u6570\u636e\u5168\u90e8\u4ea4\u7ed9\u5bf9\u5e94\u7684Service\uff08\u4e1a\u52a1\u5c42\uff09\u6765\u5904\u7406\uff0c\u5f53Service\u53d1\u73b0\u8981\u4ece\u6570\u636e\u5e93\u4e2d\u83b7\u53d6\u6570\u636e\u65f6\uff0c\u518d\u5411\u5bf9\u5e94\u7684Mapper\u53d1\u8d77\u8bf7\u6c42\u3002</p> <p>\u5b83\u4eec\u4e4b\u95f4\u5c31\u50cf\u8fde\u63a5\u5728\u4e00\u8d77\u7684\u9f7f\u8f6e\uff0c\u8c01\u4e5f\u79bb\u4e0d\u5f00\u8c01\uff1a</p> <p></p> <p>\u5c31\u50cf\u4e00\u4e2a\u56e2\u961f\uff0c\u6bcf\u4e2a\u4eba\u7684\u5206\u5de5\u90fd\u5f88\u660e\u786e\uff0c\u6d41\u6c34\u7ebf\u4e0a\u7684\u4e00\u5957\u64cd\u4f5c\u5fc5\u987b\u73af\u73af\u76f8\u6263\uff0c\u8fd9\u662f\u4e00\u79cd\u9ad8\u5ea6\u8026\u5408\u7684\u4f53\u7cfb\u3002</p> <p>\u867d\u7136\u8fd9\u6837\u7684\u4f53\u7cfb\u903b\u8f91\u975e\u5e38\u6e05\u6670\uff0c\u6574\u4e2a\u6d41\u7a0b\u4e5f\u80fd\u591f\u8ba9\u4eba\u5feb\u901f\u4e86\u89e3\uff0c\u4f46\u662f\u8fd9\u6837\u5b58\u5728\u4e00\u4e2a\u5f88\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u6211\u4eec\u73b0\u5728\u7684\u65f6\u4ee3\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u8f6f\u4ef6\u9879\u76ee\u9ad8\u901f\u8fed\u4ee3\u7684\u65f6\u4ee3\uff0c\u6211\u4eec\u53d1\u73b0\u5f88\u591aApp\u4e09\u5929\u4e24\u5934\u9694\u4e09\u5dee\u4e94\u5730\u5c31\u66f4\u65b0\uff0c\u800c\u4e14\u662f\u4ec0\u4e48\u529f\u80fd\u5f53\u4e0b\u6700\u706b\uff0c\u5c31\u9a6c\u4e0d\u505c\u8e44\u5730\u8fdb\u884c\u8ddf\u8fdb\u5f00\u53d1\uff0c\u56e0\u6b64\uff0c\u5c31\u5f88\u5bb9\u6613\u51fa\u73b0\uff0c\u4e4b\u524d\u5199\u597d\u7684\u4ee3\u7801\uff0c\u5b9e\u73b0\u7684\u529f\u80fd\uff0c\u9700\u8981\u5168\u90e8\u63a8\u7ffb\uff0c\u6539\u6210\u65b0\u7684\u529f\u80fd\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u4e0d\u5f97\u4e0d\u53bb\u4fee\u6539\u67d0\u4e9b\u6d41\u6c34\u7ebf\u4e0a\u7684\u6a21\u5757\uff0c\u4f46\u662f\u8fd9\u6837\u4e00\u4fee\u6539\uff0c\u4f1a\u76f4\u63a5\u5bfc\u81f4\u6574\u4e2a\u6d41\u6c34\u7ebf\u7684\u5f15\u7528\u5173\u7cfb\u5927\u9762\u79ef\u66f4\u65b0\u3002</p> <p>\u6bd4\u5982\u4e0b\u9762\u7684\u60c5\u51b5\uff1a</p> <pre><code>class A{\n    private List&lt;B&gt; list;\n    public B test(B b){\n        return null;\n    }\n}\n\nclass C{\n    public C(B b){}\n}\n\nclass B{ }\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0cA\u548cC\u5728\u5927\u91cf\u5730\u76f4\u63a5\u4f7f\u7528B\uff0c\u4f46\u662f\u67d0\u4e00\u5929\uff0c\u8fd9\u4e2aB\u7684\u5b9e\u73b0\u5df2\u7ecf\u8fc7\u65f6\u4e86\uff0c\u6b64\u65f6\u6765\u4e86\u4e2a\u628a\u529f\u80fd\u5b9e\u73b0\u7684\u66f4\u597d\u7684D\uff0c\u6211\u4eec\u9700\u8981\u7528\u8fd9\u4e2a\u65b0\u7684\u7c7b\u6765\u5b8c\u6210\u4e1a\u52a1\u4e86\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u56e0\u4e3a\u7c7b\u4e4b\u95f4\u7684\u5173\u8054\u6027\u592a\u5f3a\u4e86\uff0c\u4f1a\u5f00\u59cb\u5927\u9762\u79ef\u62a5\u9519\uff0c\u6240\u6709\u4e4b\u524d\u7528\u4e86B\u7684\u7c7b\uff0c\u5f97\u6328\u4e2a\u8fdb\u884c\u4fee\u6539\uff0c\u5168\u90fd\u6539\u6210D\uff0c\u8fd9\u7b80\u76f4\u662f\u707e\u96be\u554a\uff01</p> <p>\u5305\u62ec\u6211\u4eec\u4e4b\u524dJavaWeb\u9636\u6bb5\u7f16\u5199\u7684\u5b9e\u6218\u9879\u76ee\uff0c\u5982\u679c\u6211\u4eec\u4e0d\u60f3\u7528\u67d0\u4e2aService\u5b9e\u73b0\u7c7b\u4e86\uff0c\u6211\u60f3\u4f7f\u7528\u5176\u4ed6\u7684\u5b9e\u73b0\u7c7b\u7528\u4e0d\u540c\u7684\u903b\u8f91\u505a\u8fd9\u4e9b\u529f\u80fd\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u53ea\u80fd\u6bcf\u4e2a\u7c7b\u90fd\u53bb\u6328\u4e2a\u8fdb\u884c\u4fee\u6539\uff0c\u5f53\u9879\u76ee\u7279\u522b\u5e9e\u5927\u65f6\uff0c\u5149\u662f\u6539\u4e2a\u7c7b\u540d\u5bfc\u81f4\u7684\u8fde\u5e26\u4fee\u6539\u5c31\u591f\u4f60\u6539\u4e00\u5929\u4e86\u3002</p> <p>\u56e0\u6b64\uff0c\u9ad8\u8026\u5408\u5ea6\u5e26\u6765\u7684\u7f3a\u70b9\u662f\u5f88\u660e\u663e\u7684\uff0c\u4e5f\u662f\u73b0\u4ee3\u8f6f\u4ef6\u5f00\u53d1\u4e2d\u5f88\u81f4\u547d\u7684\u95ee\u9898\u3002\u5982\u679c\u8981\u6539\u5584\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ea\u80fd\u5c06\u5404\u4e2a\u6a21\u5757\u8fdb\u884c\u89e3\u8026\uff0c\u8ba9\u5404\u4e2a\u6a21\u5757\u4e4b\u95f4\u7684\u4f9d\u8d56\u6027\u4e0d\u518d\u90a3\u4e48\u5730\u5f3a\u3002\u4e5f\u5c31\u662f\u8bf4\uff0cService\u7684\u5b9e\u73b0\u7c7b\uff0c\u4e0d\u518d\u7531\u6211\u4eec\u51b3\u5b9a\uff0c\u800c\u662f\u8ba9\u7a0b\u5e8f\u81ea\u5df1\u51b3\u5b9a\uff0c\u6240\u6709\u7684\u5b9e\u73b0\u7c7b\u5bf9\u8c61\uff0c\u5168\u90e8\u4ea4\u7ed9\u7a0b\u5e8f\u6765\u7ba1\u7406\uff0c\u6240\u6709\u5bf9\u8c61\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u4e5f\u7531\u7a0b\u5e8f\u6765\u52a8\u6001\u51b3\u5b9a\uff0c\u8fd9\u6837\u5c31\u5f15\u5165\u4e86IoC\u7406\u8bba\u3002</p> <p>IOC\u662fInversion of Control\u7684\u7f29\u5199\uff0c\u7ffb\u8bd1\u4e3a\uff1a\u201c\u63a7\u5236\u53cd\u8f6c\u201d\uff0c\u628a\u590d\u6742\u7cfb\u7edf\u5206\u89e3\u6210\u76f8\u4e92\u5408\u4f5c\u7684\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u7c7b\u901a\u8fc7\u5c01\u88c5\u4ee5\u540e\uff0c\u5185\u90e8\u5b9e\u73b0\u5bf9\u5916\u90e8\u662f\u900f\u660e\u7684\uff0c\u4ece\u800c\u964d\u4f4e\u4e86\u89e3\u51b3\u95ee\u9898\u7684\u590d\u6742\u5ea6\uff0c\u800c\u4e14\u53ef\u4ee5\u7075\u6d3b\u5730\u88ab\u91cd\u7528\u548c\u6269\u5c55\u3002</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u5c06\u5bf9\u8c61\u4ea4\u7ed9IoC\u5bb9\u5668\u8fdb\u884c\u7ba1\u7406\uff0c\u6bd4\u5982\u5f53\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\u65f6\uff0c\u7531\u5b83\u6839\u636e\u914d\u7f6e\u6587\u4ef6\u6765\u51b3\u5b9a\u5230\u5e95\u7ed9\u6211\u4eec\u54ea\u4e00\u4e2a\u5b9e\u73b0\u7c7b\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4e0d\u7528\u518d\u5173\u5fc3\u6211\u4eec\u8981\u53bb\u4f7f\u7528\u54ea\u4e00\u4e2a\u5b9e\u73b0\u7c7b\u4e86\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5173\u5fc3\uff0c\u7ed9\u5230\u6211\u7684\u4e00\u5b9a\u662f\u4e00\u4e2a\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u7684\u5b9e\u73b0\u7c7b\uff0c\u80fd\u7528\u5c31\u5b8c\u4e8b\u4e86\uff0c\u53cd\u6b63\u63a5\u53e3\u5b9a\u4e49\u4e86\u5565\uff0c\u6211\u53ea\u7ba1\u8c03\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u653e\u5fc3\u5730\u8ba9\u4e00\u4e2a\u4eba\u53bb\u5199\u89c6\u56fe\u5c42\u7684\u4ee3\u7801\uff0c\u4e00\u4e2a\u4eba\u53bb\u5199\u4e1a\u52a1\u5c42\u7684\u4ee3\u7801\uff0c\u5f00\u53d1\u6548\u7387\u90a3\u662f\u9ad8\u7684\u4e00\u5339\u554a\u3002</p> <p>\u8fd8\u662f\u4e4b\u524d\u7684\u4ee3\u7801\uff0c\u4f46\u662f\u6709\u4e86IoC\u5bb9\u5668\u52a0\u6301\u4e4b\u540e\uff1a</p> <pre><code>public static void main(String[] args) {\n        A a = new A();\n    a.test(IoC.getBean(Service.class));   //\u778e\u7f16\u7684\u4e00\u4e2a\u5bb9\u5668\u7c7b\uff0c\u4f46\u662f\u662f\u90a3\u4e2a\u610f\u601d\n    //\u6bd4\u5982\u73b0\u5728\u5728IoC\u5bb9\u5668\u4e2d\u7ba1\u7406\u7684Service\u7684\u5b9e\u73b0\u662fB\uff0c\u90a3\u4e48\u6211\u4eec\u4ece\u91cc\u9762\u62ff\u5230\u7684Service\u5b9e\u73b0\u5c31\u662fB\n}\n\nclass A{\n    private List&lt;Service&gt; list;   //\u4e00\u5f8b\u4f7f\u7528Service\uff0c\u5177\u4f53\u5b9e\u73b0\u7531IoC\u5bb9\u5668\u63d0\u4f9b\n    public Service test(Service b){\n        return null;\n    }\n}\n\ninterface Service{ }   //\u4f7f\u7528Service\u505a\u4e00\u4e2a\u9876\u5c42\u62bd\u8c61\n\nclass B implements Service{}  //B\u4f9d\u7136\u662f\u5177\u4f53\u5b9e\u73b0\u7c7b\uff0c\u5e76\u4ea4\u7ed9IoC\u5bb9\u5668\u7ba1\u7406\n</code></pre> <p>\u5f53\u5177\u4f53\u5b9e\u73b0\u7c7b\u53d1\u751f\u4fee\u6539\u65f6\uff0c\u6211\u4eec\u540c\u6837\u53ea\u9700\u8981\u5c06\u65b0\u7684\u5b9e\u73b0\u7c7b\u4ea4\u7ed9IoC\u5bb9\u5668\u7ba1\u7406\uff0c\u8fd9\u6837\u6211\u4eec\u65e0\u9700\u4fee\u6539\u4e4b\u524d\u7684\u4efb\u4f55\u4ee3\u7801\uff1a</p> <pre><code>interface Service{ }\n\nclass D implements Service{}   //\u73b0\u5728\u5b9e\u73b0\u7c7b\u53d8\u6210\u4e86D\uff0c\u4f46\u662f\u4e4b\u524d\u7684\u4ee3\u7801\u5e76\u4e0d\u4f1a\u62a5\u9519\n</code></pre> <p>\u8fd9\u6837\uff0c\u5373\u4f7f\u6211\u4eec\u7684\u5e95\u5c42\u5b9e\u73b0\u7c7b\u53d1\u751f\u4e86\u4fee\u6539\uff0c\u4e5f\u4e0d\u4f1a\u5bfc\u81f4\u4e0e\u5176\u76f8\u5173\u8054\u7684\u7c7b\u51fa\u73b0\u9519\u8bef\uff0c\u800c\u8fdb\u884c\u5927\u9762\u79ef\u4fee\u6539\uff0c\u901a\u8fc7\u5b9a\u4e49\u62bd\u8c61+\u5bb9\u5668\u7ba1\u7406\u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u539f\u6709\u7684\u5f3a\u5173\u8054\u89e3\u9664\u3002</p> <p>\u9ad8\u5185\u805a\uff0c\u4f4e\u8026\u5408\uff0c\u662f\u73b0\u4ee3\u8f6f\u4ef6\u7684\u5f00\u53d1\u7684\u8bbe\u8ba1\u76ee\u6807\uff0c\u800cSpring\u6846\u67b6\u5c31\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u8fd9\u6837\u7684\u4e00\u4e2aIoC\u5bb9\u5668\u8fdb\u884c\u5bf9\u8c61\u7684\u7684\u7ba1\u7406\uff0c\u4e00\u4e2a\u7531Spring IoC\u5bb9\u5668\u5b9e\u4f8b\u5316\u3001\u7ec4\u88c5\u548c\u7ba1\u7406\u7684\u5bf9\u8c61\uff0c\u6211\u4eec\u79f0\u5176\u4e3aBean\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#spring_1","title":"\u7b2c\u4e00\u4e2aSpring\u9879\u76ee","text":"<p>\u9996\u5148\u4e00\u5b9a\u8981\u660e\u786e\uff0c\u4f7f\u7528Spring\u9996\u8981\u76ee\u7684\u662f\u4e3a\u4e86\u4f7f\u5f97\u8f6f\u4ef6\u9879\u76ee\u8fdb\u884c\u89e3\u8026\uff0c\u800c\u4e0d\u662f\u4e3a\u4e86\u53bb\u7b80\u5316\u4ee3\u7801\uff01\u901a\u8fc7\u5b83\uff0c\u5c31\u53ef\u4ee5\u66f4\u597d\u7684\u5bf9\u6211\u4eec\u7684Bean\u8fdb\u884c\u7ba1\u7406\uff0c\u8fd9\u4e00\u90e8\u5206\u6211\u4eec\u6765\u4f53\u9a8c\u4e00\u4e0bSpring\u7684\u57fa\u672c\u4f7f\u7528\u3002</p> <p>Spring\u5e76\u4e0d\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u6846\u67b6\uff0c\u5b83\u5b9e\u9645\u4e0a\u5305\u542b\u4e86\u5f88\u591a\u7684\u6a21\u5757\uff1a</p> <p></p> <p>\u800c\u6211\u4eec\u9996\u5148\u8981\u53bb\u5b66\u4e60\u7684\u5c31\u662fCore Container\uff0c\u4e5f\u5c31\u662f\u6838\u5fc3\u5bb9\u5668\u6a21\u5757\uff0c\u53ea\u6709\u4e86\u89e3\u4e86Spring\u7684\u6838\u5fc3\u6280\u672f\uff0c\u6211\u4eec\u624d\u80fd\u771f\u6b63\u8ba4\u8bc6\u8fd9\u4e2a\u6846\u67b6\u4e3a\u6211\u4eec\u5e26\u6765\u7684\u4fbf\u6377\u4e4b\u5904\u3002</p> <p>Spring\u662f\u4e00\u4e2a\u975e\u5165\u4fb5\u5f0f\u7684\u6846\u67b6\uff0c\u5c31\u50cf\u4e00\u4e2a\u5de5\u5177\u5e93\u4e00\u6837\uff0c\u5b83\u53ef\u4ee5\u5f88\u7b80\u5355\u5730\u52a0\u5165\u5230\u6211\u4eec\u5df2\u6709\u7684\u9879\u76ee\u4e2d\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u53ea\u9700\u8981\u76f4\u63a5\u5bfc\u5165\u5176\u4f9d\u8d56\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\uff0cSpring\u6838\u5fc3\u6846\u67b6\u7684Maven\u4f9d\u8d56\u5750\u6807\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n    &lt;version&gt;6.0.10&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6ce8\u610f\uff1a\u4e0e\u65e7\u7248\u6559\u7a0b\u4e0d\u540c\u7684\u662f\uff0cSpring 6\u8981\u6c42\u4f60\u4f7f\u7528\u7684Java\u7248\u672c\u4e3a<code>17</code>\u53ca\u4ee5\u4e0a\uff0c\u5305\u62ec\u540e\u9762\u6211\u4eec\u5728\u5b66\u4e60SpringMvc\u65f6\uff0c\u8981\u6c42Tomcat\u7248\u672c\u5fc5\u987b\u4e3a10\u4ee5\u4e0a\u3002\u8fd9\u4e2a\u4f9d\u8d56\u4e2d\u5305\u542b\u4e86\u5982\u4e0b\u4f9d\u8d56\uff1a</p> <p></p> <p>\u8fd9\u91cc\u51fa\u73b0\u7684\u90fd\u662fSpring\u6838\u5fc3\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u5982Beans\u3001Core\u3001Context\u3001SpEL\u4ee5\u53ca\u975e\u5e38\u5173\u952e\u7684AOP\u6846\u67b6\uff0c\u5728\u672c\u7ae0\u4e2d\uff0c\u6211\u4eec\u90fd\u4f1a\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p>\u5982\u679c\u5728\u4f7f\u7528Spring\u6846\u67b6\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u5982\u4e0b\u8b66\u544a\uff1a</p> <pre><code>12\u6708 17, 2022 3:26:26 \u4e0b\u5348 org.springframework.core.LocalVariableTableParameterNameDiscoverer inspectClass\n\u8b66\u544a: Using deprecated '-debug' fallback for parameter name resolution. Compile the affected code with '-parameters' instead or avoid its introspection: XXXX\n</code></pre> <p>\u8fd9\u662f\u56e0\u4e3aLocalVariableTableParameterNameDiscoverer\u5728Spring 6.0.1\u7248\u672c\u5df2\u7ecf\u88ab\u6807\u8bb0\u4e3a\u8fc7\u65f6\uff0c\u5e76\u4e14\u5373\u5c06\u79fb\u9664\uff0c\u8bf7\u5728Maven\u914d\u7f6e\u6587\u4ef6\u4e2d\u4e3a\u7f16\u8bd1\u63d2\u4ef6\u6dfb\u52a0<code>-parameters</code>\u7f16\u8bd1\u53c2\u6570\uff1a</p> <pre><code>&lt;build&gt;\n    &lt;pluginManagement&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.10.1&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;compilerArgs&gt;\n                        &lt;arg&gt;-parameters&lt;/arg&gt;\n                    &lt;/compilerArgs&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/pluginManagement&gt;\n&lt;/build&gt;\n</code></pre> <p>\u6ca1\u6709\u6b64\u95ee\u9898\u8bf7\u65e0\u89c6\u8fd9\u90e8\u5206\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5c31\u6765\u5c1d\u8bd5\u7f16\u5199\u4e00\u4e2a\u6700\u7b80\u7684Spring\u9879\u76ee\uff0c\u6211\u4eec\u5728\u524d\u9762\u5df2\u7ecf\u8bb2\u8fc7\u4e86\uff0cSpring\u4f1a\u7ed9\u6211\u4eec\u63d0\u4f9bIoC\u5bb9\u5668\u7528\u4e8e\u7ba1\u7406Bean\uff0c\u4f46\u662f\u6211\u4eec\u5f97\u5148\u4e3a\u8fd9\u4e2a\u5bb9\u5668\u7f16\u5199\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u544a\u8bc9\u5bb9\u5668\u9700\u8981\u7ba1\u7406\u54ea\u4e9bBean\u4ee5\u53caBean\u7684\u5c5e\u6027\u3001\u4f9d\u8d56\u5173\u7cfb\u7b49\u7b49\u3002</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u5728resource\u4e2d\u521b\u5efa\u4e00\u4e2aSpring\u914d\u7f6e\u6587\u4ef6\uff08\u5728resource\u4e2d\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u4f1a\u5728\u7f16\u8bd1\u65f6\u88ab\u4e00\u8d77\u653e\u5230\u7c7b\u8def\u5f84\u4e0b\uff09\uff0c\u547d\u540d\u4e3atest.xml\uff0c\u76f4\u63a5\u53f3\u952e\u70b9\u51fb\u5373\u53ef\u521b\u5efa\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n&lt;/beans&gt;\n</code></pre> <p>\u6b64\u65f6IDEA\u4f1a\u63d0\u793a\u6211\u4eec\u6ca1\u6709\u4e3a\u6b64\u6587\u4ef6\u914d\u7f6e\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981\u6307\u5b9a\u6210\u5f53\u524d\u9879\u76ee\u5c31\u884c\u4e86\uff0c\u5f53\u7136\u914d\u7f6e\u8fd9\u4e2a\u53ea\u662f\u4e3a\u4e86\u4ee3\u7801\u63d0\u793a\u548c\u4f9d\u8d56\u5173\u7cfb\u5feb\u901f\u67e5\u770b\uff0c\u5982\u679c\u4e0d\u8fdb\u884c\u914d\u7f6e\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u4ec0\u4e48\uff0c\u7a0b\u5e8f\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u6309\u7167\u9ed8\u8ba4\u914d\u7f6e\u70b9\u786e\u5b9a\u5c31\u884c\u4e86\uff1a</p> <p></p> <p>Spring\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2aIoC\u5bb9\u5668\uff0c\u7528\u4e8e\u53bb\u5b58\u653e\u6211\u4eec\u9700\u8981\u4f7f\u7528\u7684\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5bf9\u8c61\u4ea4\u7ed9IoC\u5bb9\u5668\u8fdb\u884c\u7ba1\u7406\uff0c\u5f53\u6211\u4eec\u9700\u8981\u4f7f\u7528\u5bf9\u8c61\u65f6\uff0c\u5c31\u53ef\u4ee5\u5411IoC\u5bb9\u5668\u53bb\u7d22\u8981\uff0c\u5e76\u7531\u5b83\u6765\u51b3\u5b9a\u7ed9\u6211\u4eec\u54ea\u4e00\u4e2a\u5bf9\u8c61\u3002\u800c\u6211\u4eec\u5982\u679c\u9700\u8981\u4f7f\u7528Spring\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684IoC\u5bb9\u5668\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\uff0c\u5b83\u4ee3\u8868\u7684\u5c31\u662fIoC\u5bb9\u5668\uff0c\u5b83\u4f1a\u8d1f\u8d23\u5b9e\u4f8b\u5316\u3001\u914d\u7f6e\u548c\u7ec4\u88c5Bean\uff1a</p> <pre><code>public static void main(String[] args) {\n    //ApplicationContext\u662f\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u7684\u9876\u5c42\u63a5\u53e3\uff0c\u5b83\u6709\u5f88\u591a\u79cd\u5b9e\u73b0\uff0c\u8fd9\u91cc\u6211\u4eec\u5148\u4ecb\u7ecd\u7b2c\u4e00\u79cd\n    //\u56e0\u4e3a\u8fd9\u91cc\u4f7f\u7528\u7684\u662fXML\u914d\u7f6e\u6587\u4ef6\uff0c\u6240\u4ee5\u8bf4\u6211\u4eec\u5c31\u4f7f\u7528 ClassPathXmlApplicationContext \u8fd9\u4e2a\u5b9e\u73b0\u7c7b\n    ApplicationContext context = new ClassPathXmlApplicationContext(\"test.xml\");  //\u8fd9\u91cc\u5199\u4e0a\u521a\u521a\u7684\u540d\u5b57\n}\n</code></pre> <p>\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u8981\u8ba9IoC\u5bb9\u5668\u5e2e\u52a9\u6211\u4eec\u7ba1\u7406\u4e00\u4e2aStudent\u5bf9\u8c61\uff08Bean\uff09\uff0c\u5f53\u6211\u4eec\u9700\u8981\u8fd9\u4e2a\u5bf9\u8c61\u65f6\u518d\u7533\u8bf7\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u8fd9\u6837\uff0c\u9996\u5148\u5148\u5c06Student\u7c7b\u5b9a\u4e49\u51fa\u6765\uff1a</p> <pre><code>package com.test.bean;\n\npublic class Student {\n    public void hello(){\n        System.out.println(\"Hello World!\");\n    }\n}\n</code></pre> <p>\u65e2\u7136\u73b0\u5728\u8981\u8ba9\u522b\u4eba\u5e2e\u5fd9\u7ba1\u7406\u5bf9\u8c61\uff0c\u90a3\u4e48\u5c31\u4e0d\u80fd\u518d\u7531\u6211\u4eec\u81ea\u5df1\u53bbnew\u8fd9\u4e2a\u5bf9\u8c61\u4e86\uff0c\u800c\u662f\u7f16\u5199\u5bf9\u5e94\u7684\u914d\u7f6e\uff0c\u6211\u4eec\u6253\u5f00\u521a\u521a\u521b\u5efa\u7684<code>test.xml</code>\u6587\u4ef6\u8fdb\u884c\u7f16\u8f91\uff0c\u6dfb\u52a0\uff1a</p> <pre><code>&lt;bean name=\"student\" class=\"com.test.bean.Student\"/&gt;\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u5c31\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u7f16\u5199\u597d\u4e86\u5bf9\u5e94Bean\u7684\u4fe1\u606f\uff0c\u4e4b\u540e\u5bb9\u5668\u5c31\u4f1a\u6839\u636e\u8fd9\u91cc\u7684\u914d\u7f6e\u8fdb\u884c\u5904\u7406\u4e86\u3002</p> <p>\u73b0\u5728\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u4e0d\u9700\u8981\u6211\u4eec\u518d\u53bb\u521b\u5efa\u4e86\uff0c\u800c\u662f\u7531IoC\u5bb9\u5668\u81ea\u52a8\u8fdb\u884c\u521b\u5efa\u5e76\u63d0\u4f9b\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4ece\u4e0a\u4e0b\u6587\u4e2d\u83b7\u53d6\u5230\u5b83\u4e3a\u6211\u4eec\u521b\u5efa\u7684\u5bf9\u8c61\uff1a</p> <pre><code>public static void main(String[] args) {\n    ApplicationContext context = new ClassPathXmlApplicationContext(\"test.xml\");\n    Student student = (Student) context.getBean(\"student\");   //\u4f7f\u7528getBean\u65b9\u6cd5\u6765\u83b7\u53d6\u5bf9\u5e94\u7684\u5bf9\u8c61\uff08Bean\uff09\n    student.hello();\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0c\u8fd9\u91cc\u5f97\u5230\u7684Student\u5bf9\u8c61\u662f\u7531Spring\u901a\u8fc7\u53cd\u5c04\u673a\u5236\u5e2e\u52a9\u6211\u4eec\u521b\u5efa\u7684\uff0c\u521d\u5b66\u8005\u4f1a\u975e\u5e38\u7591\u60d1\uff0c\u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\u6765\u521b\u5efa\u5bf9\u8c61\uff0c\u6211\u4eec\u76f4\u63a5new\u4e00\u4e2a\u5b83\u4e0d\u9999\u5417\uff1f\u4e3a\u4ec0\u4e48\u8981\u4ea4\u7ed9IoC\u5bb9\u5668\u7ba1\u7406\u5462\uff1f\u5728\u540e\u9762\u7684\u5b66\u4e60\u4e2d\uff0c\u6211\u4eec\u518d\u6162\u6162\u8fdb\u884c\u4f53\u4f1a\u3002</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#bean","title":"Bean\u6ce8\u518c\u4e0e\u914d\u7f6e","text":"<p>\u524d\u9762\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u4f8b\u5b50\u4f53\u9a8c\u4e86\u4e00\u4e0b\u5982\u4f55\u4f7f\u7528Spring\u6765\u7ba1\u7406\u6211\u4eec\u7684\u5bf9\u8c61\uff0c\u5e76\u5411IoC\u5bb9\u5668\u7d22\u8981\u88ab\u7ba1\u7406\u7684\u5bf9\u8c61\u3002\u8fd9\u8282\u8bfe\u6211\u4eec\u5c31\u6765\u8be6\u7ec6\u4e86\u89e3\u4e00\u4e0b\u5982\u4f55\u5411Spring\u6ce8\u518cBean\u4ee5\u53caBean\u7684\u76f8\u5173\u914d\u7f6e\u3002</p> <p>\u5b9e\u9645\u4e0a\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u53ef\u4ee5\u6709\u5f88\u591a\u4e2a\uff0c\u5e76\u4e14\u8fd9\u4e9b\u914d\u7f6e\u6587\u4ef6\u662f\u53ef\u4ee5\u76f8\u4e92\u5bfc\u5165\u7684\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans ...&gt;\n    &lt;import resource=\"test.xml\"/&gt;\n&lt;/beans&gt;\n</code></pre> <p>\u4f46\u662f\u4e3a\u4e86\u7b80\u5355\u8d77\u89c1\uff0c\u6211\u4eec\u8fd8\u662f\u4ece\u5355\u914d\u7f6e\u6587\u4ef6\u5f00\u59cb\u8bb2\u8d77\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u77e5\u9053\u5982\u4f55\u914d\u7f6eBean\u5e76\u6ce8\u518c\u3002</p> <p>\u8981\u914d\u7f6e\u4e00\u4e2aBean\uff0c\u53ea\u9700\u8981\u6dfb\u52a0\uff1a</p> <pre><code>&lt;bean/&gt;\n</code></pre> <p>\u4f46\u662f\u8fd9\u6837\u5199\u7684\u8bdd\uff0cSpring\u65e0\u6cd5\u5f97\u77e5\u6211\u4eec\u8981\u914d\u7f6e\u7684Bean\u5230\u5e95\u662f\u54ea\u4e00\u4e2a\u7c7b\uff0c\u6240\u4ee5\u8bf4\u6211\u4eec\u8fd8\u5f97\u6307\u5b9a\u5bf9\u5e94\u7684\u7c7b\u624d\u53ef\u4ee5\uff1a</p> <pre><code>&lt;bean class=\"com.test.bean.Student\"/&gt;\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u7c7b\u7684\u65c1\u8fb9\u51fa\u73b0\u4e86Bean\u7684\u56fe\u6807\uff0c\u8868\u793a\u6211\u4eec\u7684Bean\u5df2\u7ecf\u6ce8\u518c\u6210\u529f\u4e86\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6839\u636e\u7c7b\u578b\u5411\u5bb9\u5668\u7d22\u8981Bean\u5b9e\u4f8b\u5bf9\u8c61\u4e86\uff1a</p> <pre><code>public static void main(String[] args) {\n    ApplicationContext context = new ClassPathXmlApplicationContext(\"test.xml\");\n    //getBean\u6709\u591a\u79cd\u5f62\u5f0f\uff0c\u5176\u4e2d\u7b2c\u4e00\u79cd\u5c31\u662f\u6839\u636e\u7c7b\u578b\u83b7\u53d6\u5bf9\u5e94\u7684Bean\n    //\u5bb9\u5668\u4e2d\u53ea\u8981\u6ce8\u518c\u4e86\u5bf9\u5e94\u7c7b\u7684Bean\u6216\u662f\u5bf9\u5e94\u7c7b\u578b\u5b50\u7c7b\u7684Bean\uff0c\u90fd\u53ef\u4ee5\u83b7\u53d6\u5230\n    Student student = context.getBean(Student.class);\n    student.hello();\n}\n</code></pre> <p>\u4e0d\u8fc7\u5728\u6709\u4e9b\u65f6\u5019\uff0cBean\u7684\u83b7\u53d6\u53ef\u80fd\u4f1a\u51fa\u73b0\u6b67\u4e49\uff0c\u6211\u4eec\u53ef\u4ee5\u6765\u5206\u522b\u6ce8\u518c\u4e24\u4e2a\u5b50\u7c7b\u7684Bean\uff1a</p> <pre><code>public class ArtStudent extends Student{\n    public void art(){\n        System.out.println(\"\u6211\u7231\u753b\u753b\");\n    }\n}\n</code></pre> <pre><code>public class SportStudent extends Student{\n        public void sport(){\n        System.out.println(\"\u6211\u7231\u8fd0\u52a8\");\n    }\n}\n</code></pre> <pre><code>&lt;bean class=\"com.test.bean.ArtStudent\"/&gt;\n&lt;bean class=\"com.test.bean.SportStudent\"/&gt;\n</code></pre> <p>\u4f46\u662f\u6b64\u65f6\u6211\u4eec\u5728\u83b7\u53d6Bean\u65f6\u5374\u662f\u7d22\u8981\u7684\u5b83\u4eec\u7684\u7236\u7c7b\uff1a</p> <pre><code>Student student = context.getBean(Student.class);\nstudent.hello();\n</code></pre> <p>\u8fd0\u884c\u65f6\u5f97\u5230\u5982\u4e0b\u62a5\u9519\uff1a</p> <p></p> <p>\u8fd9\u91cc\u51fa\u73b0\u4e86\u4e00\u4e2aBean\u5b9a\u4e49\u4e0d\u552f\u4e00\u5f02\u5e38\uff0c\u5f88\u660e\u663e\uff0c\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u7684\u7c7b\u578b\u662fStudent\uff0c\u4f46\u662f\u6b64\u65f6\u6709\u4e24\u4e2aBean\u5b9a\u4e49\u90fd\u6ee1\u8db3\u8fd9\u4e2a\u7c7b\u578b\uff0c\u5b83\u4eec\u90fd\u662fStudent\u7684\u5b50\u7c7b\uff0c\u6b64\u65f6IoC\u5bb9\u5668\u4e0d\u77e5\u9053\u7ed9\u6211\u4eec\u8fd4\u56de\u54ea\u4e00\u4e2aBean\uff0c\u6240\u4ee5\u5c31\u53ea\u80fd\u629b\u51fa\u5f02\u5e38\u4e86\u3002</p> <p>\u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u4e00\u4e2aBean\u5e76\u4e14\u4f7f\u7528\u7c7b\u578b\u8fdb\u884c\u83b7\u53d6\uff0c\u90a3\u4e48\u5fc5\u987b\u8981\u6307\u660e\u7c7b\u578b\u5e76\u4e14\u4e0d\u80fd\u51fa\u73b0\u6b67\u4e49\uff1a</p> <pre><code>ArtStudent student = context.getBean(ArtStudent.class);\nstudent.art();\n</code></pre> <p>\u90a3\u8981\u662f\u4e24\u4e2aBean\u7684\u7c7b\u578b\u90fd\u662f\u4e00\u6837\u7684\u5462\uff1f</p> <pre><code>&lt;bean class=\"com.test.bean.Student\"/&gt;\n&lt;bean class=\"com.test.bean.Student\"/&gt;\n</code></pre> <p>\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c31\u65e0\u6cd5\u4f7f\u7528Class\u6765\u8fdb\u884c\u533a\u5206\u4e86\uff0c\u9664\u4e86\u4e3aBean\u6307\u5b9a\u5bf9\u5e94\u7c7b\u578b\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4e3aBean\u6307\u5b9a\u4e00\u4e2a\u540d\u79f0\u7528\u4e8e\u533a\u5206\uff1a</p> <pre><code>&lt;bean name=\"art\" class=\"com.test.bean.ArtStudent\"/&gt;\n&lt;bean name=\"sport\" class=\"com.test.bean.SportStudent\"/&gt;\n</code></pre> <p>name\u5c5e\u6027\u5c31\u662f\u4e3a\u8fd9\u4e2aBean\u8bbe\u5b9a\u4e00\u4e2a\u72ec\u4e00\u65e0\u4e8c\u7684\u540d\u79f0\uff08id\u5c5e\u6027\u4e5f\u53ef\u4ee5\uff0c\u8ddfname\u529f\u80fd\u76f8\u540c\uff0c\u4f46\u662f\u4f1a\u68c0\u67e5\u547d\u540d\u662f\u5426\u89c4\u8303\uff0c\u5426\u5219\u4f1a\u663e\u793a\u9ec4\u6807\uff09\uff0c\u4e0d\u540c\u7684Bean\u540d\u5b57\u4e0d\u80fd\u76f8\u540c\uff0c\u5426\u5219\u62a5\u9519\uff1a</p> <pre><code>&lt;bean name=\"a\" class=\"com.test.bean.Student\"/&gt;\n&lt;bean name=\"b\" class=\"com.test.bean.Student\"/&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u8fd9\u4e24\u4e2aBean\u6211\u4eec\u5c31\u53ef\u4ee5\u533a\u5206\u51fa\u6765\u4e86\uff1a</p> <pre><code>Student student = (Student) context.getBean(\"a\");\nstudent.hello();\n</code></pre> <p>\u867d\u7136\u76ee\u524d\u8fd9\u4e24Bean\u5b9a\u4e49\u90fd\u662f\u4e00\u6a21\u4e00\u6837\u7684\uff0c\u4e5f\u6ca1\u4ec0\u4e48\u533a\u522b\uff0c\u4f46\u662f\u8fd9\u786e\u5b9e\u662f\u4e24\u4e2a\u4e0d\u540c\u7684Bean\uff0c\u53ea\u662f\u7c7b\u578b\u4e00\u6837\u800c\u5df2\uff0c\u4e4b\u540e\u6211\u4eec\u8fd8\u53ef\u4ee5\u4e3a\u8fd9\u4e24\u4e2aBean\u5206\u522b\u8bbe\u7f6e\u4e0d\u540c\u7684\u5176\u4ed6\u5c5e\u6027\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u7ed9Bean\u8d77\u540d\u5b57\uff0c\u4e5f\u53ef\u4ee5\u8d77\u522b\u540d\uff0c\u5c31\u884c\u6211\u4eec\u9664\u4e86\u6709\u4e00\u4e2a\u540d\u5b57\u4e4b\u5916\uff0c\u53ef\u80fd\u5728\u5bb6\u91cc\u8fd8\u6709\u81ea\u5df1\u7684\u5c0f\u540d\uff1a</p> <pre><code>&lt;bean name=\"a\" class=\"com.test.bean.Student\"/&gt;\n&lt;alias name=\"a\" alias=\"test\"/&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u4f7f\u7528\u522b\u540d\u4e5f\u662f\u53ef\u4ee5\u62ff\u5230\u5bf9\u5e94\u7684Bean\u7684\uff1a</p> <pre><code>Student student = (Student) context.getBean(\"test\");\nstudent.hello();\n</code></pre> <p>\u90a3\u4e48\u73b0\u5728\u53c8\u6709\u65b0\u7684\u95ee\u9898\u4e86\uff0cIoC\u5bb9\u5668\u521b\u5efa\u7684Bean\u662f\u53ea\u6709\u4e00\u4e2a\u8fd8\u662f\u6bcf\u6b21\u7d22\u8981\u7684\u65f6\u5019\u90fd\u4f1a\u7ed9\u6211\u4eec\u4e00\u4e2a\u65b0\u7684\u5bf9\u8c61\uff1f\u6211\u4eec\u73b0\u5728\u5728\u4e3b\u65b9\u6cd5\u4e2d\u8fde\u7eed\u83b7\u53d6\u4e24\u6b21Bean\u5bf9\u8c61\uff1a</p> <pre><code>Student student1 = context.getBean(Student.class);\nStudent student2 = context.getBean(Student.class);\nSystem.out.println(student1 == student2);   //\u9ed8\u8ba4\u4e3a\u5355\u4f8b\u6a21\u5f0f\uff0c\u5bf9\u8c61\u59cb\u7ec8\u4e3a\u540c\u4e00\u4e2a\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u6700\u540e\u5f97\u5230\u7684\u7ed3\u679c\u4e3atrue\uff0c\u90a3\u4e48\u8bf4\u660e\u6bcf\u6b21\u4eceIoC\u5bb9\u5668\u83b7\u53d6\u5230\u7684\u5bf9\u8c61\uff0c\u59cb\u7ec8\u90fd\u662f\u540c\u4e00\u4e2a\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u901a\u8fc7IoC\u5bb9\u5668\u8fdb\u884c\u7ba1\u7406\u7684Bean\u90fd\u662f\u5355\u4f8b\u6a21\u5f0f\u7684\uff0c\u8fd9\u4e2a\u5bf9\u8c61\u53ea\u4f1a\u88ab\u521b\u5efa\u4e00\u6b21\u3002</p> <p>\u5982\u679c\u6211\u4eec\u5e0c\u671b\u6bcf\u6b21\u62ff\u5230\u7684\u5bf9\u8c61\u90fd\u662f\u4e00\u4e2a\u65b0\u7684\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u5176\u4f5c\u7528\u57df\u8fdb\u884c\u4fee\u6539\uff1a</p> <p></p> <p>\u8fd9\u91cc\u4e00\u5171\u6709\u4e24\u79cd\u4f5c\u7528\u57df\uff0c\u7b2c\u4e00\u79cd\u662f<code>singleton</code>\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c31\u662f\u8fd9\u4e00\u79cd\uff0c\u5f53\u7136\u8fd8\u6709<code>prototype</code>\uff0c\u8868\u793a\u4e3a\u539f\u578b\u6a21\u5f0f\uff08\u4e3a\u4e86\u65b9\u4fbf\u53eb\u591a\u4f8b\u6a21\u5f0f\u4e5f\u884c\uff09\u8fd9\u79cd\u6a21\u5f0f\u6bcf\u6b21\u5f97\u5230\u7684\u5bf9\u8c61\u90fd\u662f\u4e00\u4e2a\u65b0\u7684\uff1a</p> <pre><code>Student student1 = context.getBean(Student.class);  //\u539f\u578b\u6a21\u5f0f\u4e0b\uff0c\u5bf9\u8c61\u4e0d\u518d\u59cb\u7ec8\u662f\u540c\u4e00\u4e2a\u4e86\nStudent student2 = context.getBean(Student.class);\nSystem.out.println(student1 == student2);\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0c\u5f53Bean\u7684\u4f5c\u7528\u57df\u4e3a\u5355\u4f8b\u6a21\u5f0f\u65f6\uff0c\u90a3\u4e48\u5b83\u4f1a\u5728\u4e00\u5f00\u59cb\uff08\u5bb9\u5668\u52a0\u8f7d\u914d\u7f6e\u65f6\uff09\u5c31\u88ab\u521b\u5efa\uff0c\u6211\u4eec\u4e4b\u540e\u62ff\u5230\u7684\u90fd\u662f\u8fd9\u4e2a\u5bf9\u8c61\u3002\u800c\u5904\u4e8e\u539f\u578b\u6a21\u5f0f\u4e0b\uff0c\u53ea\u6709\u5728\u83b7\u53d6\u65f6\u624d\u4f1a\u88ab\u521b\u5efa\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5355\u4f8b\u6a21\u5f0f\u4e0b\uff0cBean\u4f1a\u88abIoC\u5bb9\u5668\u5b58\u50a8\uff0c\u53ea\u8981\u5bb9\u5668\u6ca1\u6709\u88ab\u9500\u6bc1\uff0c\u90a3\u4e48\u6b64\u5bf9\u8c61\u5c06\u4e00\u76f4\u5b58\u5728\uff0c\u800c\u539f\u578b\u6a21\u5f0f\u624d\u662f\u76f8\u5f53\u4e8e\u5728\u8981\u7528\u7684\u65f6\u5019\u76f4\u63a5new\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5e76\u4e0d\u4f1a\u88ab\u4fdd\u5b58\u3002</p> <p>\u5f53\u7136\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u5355\u4f8b\u6a21\u5f0f\u4e0b\u7684Bean\u4e0d\u7528\u518d\u4e00\u5f00\u59cb\u5c31\u52a0\u8f7d\uff0c\u800c\u662f\u4e00\u6837\u7b49\u5230\u9700\u8981\u65f6\u518d\u52a0\u8f7d\uff08\u52a0\u8f7d\u540e\u4f9d\u7136\u4f1a\u88ab\u5bb9\u5668\u5b58\u50a8\uff0c\u4e4b\u540e\u4e00\u76f4\u4f7f\u7528\u8fd9\u4e2a\u5bf9\u8c61\u4e86\uff0c\u4e0d\u4f1a\u518d\u521b\u5efa\u65b0\u7684\uff09\u6211\u4eec\u4e5f\u53ef\u4ee5\u5f00\u542f\u61d2\u52a0\u8f7d\uff1a</p> <pre><code>&lt;bean class=\"com.test.bean.Student\" lazy-init=\"true\"/&gt;\n</code></pre> <p>\u5f00\u542f\u61d2\u52a0\u8f7d\u540e\uff0c\u53ea\u6709\u5728\u771f\u6b63\u7b2c\u4e00\u6b21\u4f7f\u7528\u65f6\u624d\u4f1a\u521b\u5efa\u5bf9\u8c61\u3002</p> <p>\u56e0\u4e3a\u5355\u4f8b\u6a21\u5f0f\u4e0bBean\u662f\u7531IoC\u5bb9\u5668\u52a0\u8f7d\uff0c\u4f46\u662f\u52a0\u8f7d\u987a\u5e8f\u6211\u4eec\u5e76\u4e0d\u6e05\u695a\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u7ef4\u62a4Bean\u7684\u52a0\u8f7d\u987a\u5e8f\uff08\u6bd4\u5982\u67d0\u4e2aBean\u5fc5\u987b\u8981\u5728\u53e6\u4e00\u4e2aBean\u4e4b\u524d\u521b\u5efa\uff09\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>depends-on</code>\u6765\u8bbe\u5b9a\u524d\u7f6e\u52a0\u8f7dBean\uff0c\u8fd9\u6837\u88ab\u4f9d\u8d56\u7684Bean\u4e00\u5b9a\u4f1a\u5728\u4e4b\u524d\u52a0\u8f7d\uff0c\u6bd4\u5982Teacher\u5e94\u8be5\u5728Student\u4e4b\u524d\u52a0\u8f7d\uff1a</p> <pre><code>&lt;bean name=\"teacher\" class=\"com.test.bean.Teacher\"/&gt;\n&lt;bean name=\"student\" class=\"com.test.bean.Student\" depends-on=\"teacher\"/&gt;\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1Bean\u7684\u52a0\u8f7d\u987a\u5e8f\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_1","title":"\u4f9d\u8d56\u6ce8\u5165","text":"<p>\u4f9d\u8d56\u6ce8\u5165(Dependency Injection, DI)\u662f\u4e00\u79cd\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u4e5f\u662fSpring\u6846\u67b6\u7684\u6838\u5fc3\u6982\u5ff5\u4e4b\u4e00\u3002\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u5982\u4f55\u6ce8\u518c\u548c\u4f7f\u7528\u4e00\u4e2aBean\uff0c\u4f46\u662f\u8fd9\u6837\u8fd8\u8fdc\u8fdc\u4e0d\u591f\uff0c\u8fd8\u8bb0\u5f97\u6211\u4eec\u4e00\u5f00\u59cb\u8bf4\u7684\uff0c\u6d88\u9664\u7c7b\u4e4b\u95f4\u7684\u5f3a\u5173\u8054\u5417\uff1f\u6bd4\u5982\u73b0\u5728\u6709\u4e00\u4e2a\u6559\u5e08\u63a5\u53e3\uff1a</p> <pre><code>public interface Teacher {\n    void teach();\n}\n</code></pre> <p>\u5177\u4f53\u7684\u5b9e\u73b0\u6709\u4e24\u4e2a\uff1a</p> <pre><code>public class ArtTeacher implements Teacher{\n    @Override\n    public void teach() {\n        System.out.println(\"\u6211\u662f\u7f8e\u672f\u8001\u5e08\uff0c\u6211\u6559\u4f60\u753b\u753b\uff01\");\n    }\n}\n</code></pre> <pre><code>public class ProgramTeacher implements Teacher{\n    @Override\n    public void teach() {\n        System.out.println(\"\u6211\u662f\u7f16\u7a0b\u8001\u5e08\uff0c\u6211\u6559\u4f60\u5b66Golang\uff01\");\n    }\n}\n</code></pre> <p>\u6211\u4eec\u7684\u5b66\u751f\u4e00\u5f00\u59cb\u6709\u4e00\u4e2a\u8001\u5e08\u6559\u4ed6\uff0c\u6bd4\u5982\u7f8e\u672f\u8001\u5e08\uff1a</p> <pre><code>public class Student {\n    private Teacher teacher = new ArtTeacher();   \n    //\u5728\u4ee5\u524d\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u5236\u5b9a\u54ea\u4e2a\u8001\u5e08\u6559\u6211\u4eec\uff0c\u76f4\u63a5new\u521b\u5efa\u5bf9\u5e94\u7684\u5bf9\u8c61\u5c31\u53ef\u4ee5\u4e86\n    public void study(){\n        teacher.teach();\n    }\n}\n</code></pre> <p>\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u7f8e\u672f\u8001\u5e08\u4e0d\u6559\u4e86\uff0c\u73b0\u5728\u6765\u4e86\u4e00\u4e2a\u5176\u4ed6\u7684\u8001\u5e08\u6559\u5b66\u751f\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u53bb\u4fee\u6539Student\u7c7b\u7684\u5b9a\u4e49\uff1a</p> <pre><code>public class Student {\n    private Teacher teacher = new ProgramTeacher();\n    ...\n</code></pre> <p>\u53ef\u4ee5\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c\u73b0\u5728\u5192\u51fa\u6765\u5404\u79cd\u5404\u6837\u7684\u7c7b\u90fd\u9700\u8981\u8fd9\u6837\u53bb\u7528Teacher\uff0c\u90a3\u4e48\u4e00\u65e6Teacher\u7684\u5b9e\u73b0\u53d1\u751f\u53d8\u5316\uff0c\u4f1a\u5bfc\u81f4\u6211\u4eec\u6328\u4e2a\u5bf9\u4e4b\u524d\u7528\u5230Teacher\u7684\u7c7b\u8fdb\u884c\u4fee\u6539\uff0c\u8fd9\u5c31\u5f88\u96be\u53d7\u4e86\u3002</p> <p>\u800c\u6709\u4e86\u4f9d\u8d56\u6ce8\u5165\u4e4b\u540e\uff0cStudent\u4e2d\u7684Teacher\u6210\u5458\u53d8\u91cf\uff0c\u53ef\u4ee5\u7531IoC\u5bb9\u5668\u6765\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684Teacher\u5bf9\u8c61\u8fdb\u884c\u8d4b\u503c\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cIoC\u5bb9\u5668\u5728\u521b\u5efa\u5bf9\u8c61\u65f6\uff0c\u9700\u8981\u5c06\u6211\u4eec\u9884\u5148\u7ed9\u5b9a\u7684\u5c5e\u6027\u6ce8\u5165\u5230\u5bf9\u8c61\u4e2d\uff0c\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>property</code>\u6807\u7b7e\u6765\u5b9e\u73b0\uff0c\u6211\u4eec\u5c06bean\u6807\u7b7e\u5c55\u5f00\uff1a</p> <pre><code>&lt;bean name=\"teacher\" class=\"com.test.bean.ProgramTeacher\"/&gt;\n&lt;bean name=\"student\" class=\"com.test.bean.Student\"&gt;\n    &lt;property name=\"teacher\" ref=\"teacher\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u540c\u65f6\u6211\u4eec\u8fd8\u9700\u8981\u4fee\u6539\u4e00\u4e0bStudent\u7c7b\uff0c\u4f9d\u8d56\u6ce8\u5165\u8981\u6c42\u5bf9\u5e94\u7684\u5c5e\u6027\u5fc5\u987b\u6709\u4e00\u4e2aset\u65b9\u6cd5\uff1a</p> <pre><code>public class Student {\n    private Teacher teacher;\n    //\u8981\u4f7f\u7528\u4f9d\u8d56\u6ce8\u5165\uff0c\u6211\u4eec\u5fc5\u987b\u63d0\u4f9b\u4e00\u4e2aset\u65b9\u6cd5\uff08\u65e0\u8bba\u6210\u5458\u53d8\u91cf\u7684\u8bbf\u95ee\u6743\u9650\u662f\u4ec0\u4e48\uff09\u547d\u540d\u89c4\u5219\u4f9d\u7136\u662f\u9a7c\u5cf0\u547d\u540d\u6cd5\n    public void setTeacher(Teacher teacher) {\n        this.teacher = teacher;\n    }\n    ...\n</code></pre> <p></p> <p>\u4f7f\u7528<code>property</code>\u6765\u6307\u5b9a\u9700\u8981\u6ce8\u5165\u7684\u503c\u6216\u662f\u4e00\u4e2aBean\uff0c\u8fd9\u91cc\u6211\u4eec\u9009\u62e9ProgramTeacher\uff0c\u90a3\u4e48\u5728\u4f7f\u7528\u65f6\uff0cStudent\u7c7b\u4e2d\u7684\u5f97\u5230\u7684\u5c31\u662f\u8fd9\u4e2aBean\u7684\u5bf9\u8c61\u4e86\uff1a</p> <pre><code>Student student = context.getBean(Student.class);\nstudent.study();\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u73b0\u5728\u6211\u4eec\u7684Java\u4ee3\u7801\u4e2d\uff0c\u6ca1\u6709\u51fa\u73b0\u4efb\u4f55\u7684\u5177\u4f53\u5b9e\u73b0\u7c7b\u4fe1\u606f\uff08ArtTeacher\u3001ProgramTeacher\u90fd\u6ca1\u51fa\u73b0\uff09\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u90a3\u4e00\u5806xml\u914d\u7f6e\uff0c\u8fd9\u6837\uff0c\u5c31\u7b97\u6211\u4eec\u5207\u6362\u8001\u5e08\u7684\u5b9e\u73b0\u4e3a\u53e6\u4e00\u4e2a\u7c7b\uff0c\u4e5f\u4e0d\u7528\u53bb\u8c03\u6574\u4ee3\u7801\uff0c\u53ea\u9700\u8981\u53d8\u52a8\u4e00\u4e0bBean\u7684\u7c7b\u578b\u5c31\u53ef\u4ee5\uff1a</p> <pre><code>&lt;!--  \u53ea\u9700\u8981\u4fee\u6539\u8fd9\u91cc\u7684class\u5373\u53ef\uff0c\u73b0\u5728\u6539\u4e3aArtTeacher  --&gt;\n&lt;bean name=\"teacher\" class=\"com.test.bean.ArtTeacher\"/&gt;\n&lt;bean name=\"student\" class=\"com.test.bean.Student\"&gt;\n    &lt;property name=\"teacher\" ref=\"teacher\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u8fd9\u4e2aBean\u7684class\u5c31\u53d8\u6210\u4e86\u65b0\u7684\u7c7b\u578b\uff0c\u5e76\u4e14\u6211\u4eec\u4e0d\u9700\u8981\u518d\u53bb\u8c03\u6574\u5176\u4ed6\u4f4d\u7f6e\u7684\u4ee3\u7801\uff0c\u518d\u6b21\u542f\u52a8\u7a0b\u5e8f\uff1a</p> <p></p> <p>\u901a\u8fc7\u4f9d\u8d56\u6ce8\u5165\uff0c\u662f\u4e0d\u662f\u5f00\u59cb\u9010\u6e10\u611f\u53d7\u5230Spring\u4e3a\u6211\u4eec\u5e26\u6765\u7684\u4fbf\u5229\u4e86\uff1f\u5f53\u7136\uff0c\u4f9d\u8d56\u6ce8\u5165\u5e76\u4e0d\u4e00\u5b9a\u8981\u6ce8\u5165\u5176\u4ed6\u7684Bean\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u503c\uff1a</p> <pre><code>&lt;bean name=\"student\" class=\"com.test.bean.Student\"&gt;\n    &lt;property name=\"name\" value=\"\u5362\u672c\u4f1f\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u76f4\u63a5\u4f7f\u7528<code>value</code>\u53ef\u4ee5\u76f4\u63a5\u4f20\u5165\u4e00\u4e2a\u5177\u4f53\u503c\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u5728\u5f88\u591a\u60c5\u51b5\u4e0b\uff0c\u7c7b\u4e2d\u7684\u67d0\u4e9b\u53c2\u6570\u662f\u5728\u6784\u9020\u65b9\u6cd5\u4e2d\u5c31\u5df2\u7ecf\u5b8c\u6210\u7684\u521d\u59cb\u5316\uff0c\u800c\u4e0d\u662f\u521b\u5efa\u4e4b\u540e\uff0c\u6bd4\u5982\uff1a</p> <pre><code>public class Student {\n    private final Teacher teacher;   //\u6784\u9020\u65b9\u6cd5\u4e2d\u5b8c\u6210\uff0c\u6240\u4ee5\u8bf4\u662f\u4e00\u4e2afinal\u53d8\u91cf\n\n    public Student(Teacher teacher){   //Teacher\u5c5e\u6027\u662f\u5728\u6784\u9020\u65b9\u6cd5\u4e2d\u5b8c\u6210\u7684\u521d\u59cb\u5316\n        this.teacher = teacher;\n    }\n    ...\n</code></pre> <p>\u6211\u4eec\u524d\u9762\u8bf4\u4e86\uff0cBean\u5b9e\u9645\u4e0a\u662f\u7531IoC\u5bb9\u5668\u8fdb\u884c\u521b\u5efa\u7684\uff0c\u4f46\u662f\u73b0\u5728\u6211\u4eec\u4fee\u6539\u4e86\u9ed8\u8ba4\u7684\u65e0\u53c2\u6784\u9020\uff0c\u53ef\u4ee5\u770b\u5230\u914d\u7f6e\u6587\u4ef6\u91cc\u9762\u62a5\u9519\u4e86\uff1a</p> <p></p> <p>\u5f88\u660e\u663e\uff0c\u662f\u56e0\u4e3a\u6211\u4eec\u4fee\u6539\u4e86\u6784\u9020\u65b9\u6cd5\uff0cIoC\u5bb9\u5668\u9ed8\u8ba4\u53ea\u4f1a\u8c03\u7528\u65e0\u53c2\u6784\u9020\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u6307\u660e\u4e00\u4e2a\u53ef\u4ee5\u7528\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u6211\u4eec\u5c55\u5f00bean\u6807\u7b7e\uff0c\u6dfb\u52a0\u4e00\u4e2a<code>constructor-arg</code>\u6807\u7b7e\uff1a</p> <pre><code>&lt;bean name=\"teacher\" class=\"com.test.bean.ArtTeacher\"/&gt;\n&lt;bean name=\"student\" class=\"com.test.bean.Student\"&gt;\n    &lt;constructor-arg name=\"teacher\" ref=\"teacher\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u8fd9\u91cc\u7684<code>constructor-arg</code>\u5c31\u662f\u6784\u9020\u65b9\u6cd5\u7684\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u53ef\u4ee5\u5199\u5f88\u591a\u4e2a\uff0c\u4f1a\u81ea\u52a8\u5339\u914d\u7b26\u5408\u91cc\u9762\u53c2\u6570\u6570\u91cf\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u8fd9\u91cc\u5339\u914d\u7684\u5c31\u662f\u6211\u4eec\u521a\u521a\u7f16\u5199\u7684\u9700\u8981\u4e00\u4e2a\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\u3002</p> <p></p> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u4e5f\u80fd\u5b9e\u73b0\u4f9d\u8d56\u6ce8\u5165\uff0c\u53ea\u4e0d\u8fc7\u73b0\u5728\u6211\u4eec\u5c06\u4f9d\u8d56\u6ce8\u5165\u7684\u65f6\u673a\u63d0\u524d\u5230\u4e86\u5bf9\u8c61\u6784\u9020\u65f6\u3002</p> <p>\u90a3\u8981\u662f\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u5462\uff1f\u73b0\u5728\u6211\u4eec\u7684Student\u7c7b\u4e2d\u662f\u8fd9\u6837\u5b9a\u4e49\u7684\uff1a</p> <pre><code>public class Student {\n    private final String name;\n    public Student(String name){\n        System.out.println(\"\u6211\u662f\u4e00\u53f7\u6784\u9020\u65b9\u6cd5\");\n        this.name = name;\n    }\n\n    public Student(int age){\n        System.out.println(\"\u6211\u662f\u4e8c\u53f7\u6784\u9020\u65b9\u6cd5\");\n        this.name = String.valueOf(age);\n    }\n}\n</code></pre> <p>\u6b64\u65f6\u6211\u4eec\u5e0c\u671b\u4f7f\u7528\u7684\u662f\u4e8c\u53f7\u6784\u9020\u65b9\u6cd5\uff0c\u90a3\u4e48\u600e\u4e48\u624d\u80fd\u6307\u5b9a\u5462\uff1f\u67092\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u7ed9\u6807\u7b7e\u6dfb\u52a0\u7c7b\u578b\uff1a</p> <pre><code>&lt;constructor-arg value=\"1\" type=\"int\"/&gt;\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u6307\u5b9a\u4e3a\u5bf9\u5e94\u7684\u53c2\u6570\u540d\u79f0\uff1a</p> <pre><code>&lt;constructor-arg value=\"1\" name=\"age\"/&gt;\n</code></pre> <p>\u53cd\u6b63\u53ea\u8981\u80fd\u591f\u4fdd\u8bc1\u6211\u4eec\u6307\u5b9a\u7684\u53c2\u6570\u5339\u914d\u5230\u76ee\u6807\u6784\u9020\u65b9\u6cd5\u5373\u53ef\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u7684\u7c7b\u4e2d\u51fa\u73b0\u4e86\u4e00\u4e2a\u6bd4\u8f83\u7279\u6b8a\u7684\u7c7b\u578b\uff0c\u5b83\u662f\u4e00\u4e2a\u96c6\u5408\u7c7b\u578b\uff1a</p> <pre><code>public class Student {\n    private List&lt;String&gt; list;\n\n    public void setList(List&lt;String&gt; list) {\n        this.list = list;\n    }\n}\n</code></pre> <p>\u5bf9\u4e8e\u8fd9\u79cd\u96c6\u5408\u7c7b\u578b\uff0c\u6709\u7740\u7279\u6b8a\u7684\u652f\u6301\uff1a</p> <pre><code>&lt;bean name=\"student\" class=\"com.test.bean.Student\"&gt;\n    &lt;!--  \u5bf9\u4e8e\u96c6\u5408\u7c7b\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6807\u7b7e\u7f16\u8f91\u96c6\u5408\u7684\u9ed8\u8ba4\u503c  --&gt;\n    &lt;property name=\"list\"&gt;\n        &lt;list&gt;\n            &lt;value&gt;AAA&lt;/value&gt;\n            &lt;value&gt;BBB&lt;/value&gt;\n            &lt;value&gt;CCC&lt;/value&gt;\n        &lt;/list&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u4e0d\u4ec5\u4ec5\u662fList\uff0cMap\u3001Set\u8fd9\u7c7b\u5e38\u7528\u96c6\u5408\u7c7b\u5305\u62ec\u6570\u7ec4\u5728\u5185\uff0c\u90fd\u662f\u652f\u6301\u8fd9\u6837\u7f16\u5199\u7684\uff0c\u6bd4\u5982Map\u7c7b\u578b\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>entry</code>\u6765\u6ce8\u5165\uff1a</p> <pre><code>&lt;bean name=\"student\" class=\"com.test.bean.Student\"&gt;\n    &lt;property name=\"map\"&gt;\n        &lt;map&gt;\n            &lt;entry key=\"\u8bed\u6587\" value=\"100.0\"/&gt;\n            &lt;entry key=\"\u6570\u5b66\" value=\"80.0\"/&gt;\n            &lt;entry key=\"\u82f1\u8bed\" value=\"92.5\"/&gt;\n        &lt;/map&gt;\n    &lt;/property&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u81f3\u6b64\uff0c\u6211\u4eec\u5c31\u5df2\u7ecf\u5b8c\u6210\u4e86\u4e24\u79cd\u4f9d\u8d56\u6ce8\u5165\u7684\u5b66\u4e60\uff1a</p> <ul> <li>Setter\u4f9d\u8d56\u6ce8\u5165\uff1a\u901a\u8fc7\u6210\u5458\u5c5e\u6027\u5bf9\u5e94\u7684set\u65b9\u6cd5\u5b8c\u6210\u6ce8\u5165\u3002</li> <li>\u6784\u9020\u65b9\u6cd5\u4f9d\u8d56\u6ce8\u5165\uff1a\u901a\u8fc7\u6784\u9020\u65b9\u6cd5\u5b8c\u6210\u6ce8\u5165\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_2","title":"\u81ea\u52a8\u88c5\u914d","text":"<p>\u5728\u4e4b\u524d\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4f9d\u8d56\u6ce8\u5165\u7684\u8bdd\uff0c\u6211\u4eec\u9700\u8981\u5bf9<code>property</code>\u53c2\u6570\u8fdb\u884c\u914d\u7f6e\uff1a</p> <pre><code>&lt;bean name=\"student\" class=\"com.test.bean.Student\"&gt;\n    &lt;property name=\"teacher\" ref=\"teacher\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u4f46\u662f\u6709\u4e9b\u65f6\u5019\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5f00\u542f\u81ea\u52a8\u88c5\u914d\u3002\u81ea\u52a8\u88c5\u914d\u5c31\u662f\u8ba9IoC\u5bb9\u5668\u81ea\u5df1\u53bb\u5bfb\u627e\u9700\u8981\u586b\u5165\u7684\u503c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5c06set\u65b9\u6cd5\u63d0\u4f9b\u597d\u5c31\u53ef\u4ee5\u4e86\uff0c\u8fd9\u91cc\u9700\u8981\u6dfb\u52a0autowire\u5c5e\u6027\uff1a</p> <pre><code>&lt;bean name=\"student\" class=\"com.test.bean.Student\" autowire=\"byType\"/&gt;\n</code></pre> <p><code>autowire</code>\u5c5e\u6027\u6709\u4e24\u4e2a\u503c\u666e\u901a\uff0c\u4e00\u4e2a\u662fbyName\uff0c\u8fd8\u6709\u4e00\u4e2a\u662fbyType\uff0c\u987e\u540d\u601d\u4e49\uff0c\u4e00\u4e2a\u662f\u6839\u636e\u7c7b\u578b\u53bb\u5bfb\u627e\u5408\u9002\u7684Bean\u81ea\u52a8\u88c5\u914d\uff0c\u8fd8\u6709\u4e00\u4e2a\u662f\u6839\u636e\u540d\u5b57\u53bb\u627e\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u663e\u5f0f\u6307\u5b9a<code>property</code>\u4e86\u3002</p> <p></p> <p>\u6b64\u65f6set\u65b9\u6cd5\u65c1\u8fb9\u4f1a\u51fa\u73b0\u4e00\u4e2a\u81ea\u52a8\u88c5\u914d\u56fe\u6807\uff0c\u6548\u679c\u548c\u4e0a\u9762\u662f\u4e00\u6837\u7684\u3002</p> <p>\u5bf9\u4e8e\u4f7f\u7528\u6784\u9020\u65b9\u6cd5\u5b8c\u6210\u7684\u4f9d\u8d56\u6ce8\u5165\uff0c\u4e5f\u652f\u6301\u81ea\u52a8\u88c5\u914d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5c06autowire\u4fee\u6539\u4e3a\uff1a</p> <pre><code>&lt;bean name=\"student\" class=\"com.test.bean.Student\" autowire=\"constructor\"/&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u53ea\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u5bf9\u5e94\u53c2\u6570\u7684\u6784\u9020\u65b9\u6cd5\u5c31\u53ef\u4ee5\u4e86\uff08\u8fd9\u79cd\u60c5\u51b5\u9ed8\u8ba4\u4e5f\u662fbyType\u5bfb\u627e\u7684\uff09\uff1a</p> <p></p> <p>\u8fd9\u6837\u540c\u6837\u53ef\u4ee5\u5b8c\u6210\u81ea\u52a8\u6ce8\u5165\uff1a</p> <p></p> <p>\u81ea\u52a8\u5316\u7684\u4e1c\u897f\u867d\u7136\u7701\u4e8b\uff0c\u4f46\u662f\u592a\u8fc7\u673a\u68b0\uff0c\u6709\u4e9b\u65f6\u5019\uff0c\u81ea\u52a8\u88c5\u914d\u53ef\u80fd\u4f1a\u9047\u5230\u4e00\u4e9b\u95ee\u9898\uff0c\u6bd4\u5982\u51fa\u73b0\u4e86\u4e0b\u9762\u7684\u60c5\u51b5\uff1a</p> <p></p> <p>\u6b64\u65f6\uff0c\u7531\u4e8e<code>autowire</code>\u7684\u89c4\u5219\u4e3abyType\uff0c\u5b58\u5728\u4e24\u4e2a\u5019\u9009Bean\uff0c\u4f46\u662f\u6211\u4eec\u5176\u5b9e\u5e0c\u671bProgramTeacher\u8fd9\u4e2aBean\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\u90fd\u4e0d\u53c2\u4e0e\u5230\u81ea\u52a8\u88c5\u914d\u4e2d\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u5b83\u7684\u81ea\u52a8\u88c5\u914d\u5019\u9009\u5173\u95ed\uff1a</p> <pre><code>&lt;bean name=\"teacher\" class=\"com.test.bean.ArtTeacher\"/&gt;\n&lt;bean name=\"teacher2\" class=\"com.test.bean.ProgramTeacher\" autowire-candidate=\"false\"/&gt;\n&lt;bean name=\"student\" class=\"com.test.bean.Student\" autowire=\"byType\"/&gt;\n</code></pre> <p>\u5f53<code>autowire-candidate</code>\u8bbe\u5b9afalse\u65f6\uff0c\u8fd9\u4e2aBean\u5c06\u4e0d\u518d\u4f5c\u4e3a\u81ea\u52a8\u88c5\u914d\u7684\u5019\u9009Bean\uff0c\u6b64\u65f6\u81ea\u52a8\u88c5\u914d\u5019\u9009\u5c31\u53ea\u5269\u4e0b\u4e00\u4e2a\u552f\u4e00\u7684Bean\u4e86\uff0c\u62a5\u9519\u6d88\u5931\uff0c\u7a0b\u5e8f\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\u3002</p> <p>\u9664\u4e86\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u8bbe\u5b9aprimary\u5c5e\u6027\uff0c\u8868\u793a\u8fd9\u4e2aBean\u4f5c\u4e3a\u4e3b\u8981\u7684Bean\uff0c\u5f53\u51fa\u73b0\u6b67\u4e49\u65f6\uff0c\u4e5f\u4f1a\u4f18\u5148\u9009\u62e9\uff1a</p> <pre><code>&lt;bean name=\"teacher\" class=\"com.test.bean.ArtTeacher\" primary=\"true\"/&gt;\n&lt;bean name=\"teacher2\" class=\"com.test.bean.ProgramTeacher\"/&gt;\n&lt;bean name=\"student\" class=\"com.test.bean.Student\" autowire=\"byType\"/&gt;\n</code></pre> <p>\u8fd9\u6837\u5199\u7a0b\u5e8f\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\uff0c\u5e76\u4e14\u9009\u62e9\u7684\u4e5f\u662fArtTeacher\uff08\u5c31\u662f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48IDEA\u4f1a\u4e0a\u7ea2\u6807\uff0cBUG\uff1f\uff09</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_3","title":"\u751f\u547d\u5468\u671f\u4e0e\u7ee7\u627f","text":"<p>\u9664\u4e86\u4fee\u6539\u6784\u9020\u65b9\u6cd5\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4e3aBean\u6307\u5b9a\u521d\u59cb\u5316\u65b9\u6cd5\u548c\u9500\u6bc1\u65b9\u6cd5\uff0c\u4ee5\u4fbf\u5728\u5bf9\u8c61\u521b\u5efa\u548c\u88ab\u9500\u6bc1\u65f6\u6267\u884c\u4e00\u4e9b\u5176\u4ed6\u7684\u4efb\u52a1\uff1a</p> <pre><code>public void init(){\n    System.out.println(\"\u6211\u662f\u5bf9\u8c61\u521d\u59cb\u5316\u65f6\u8981\u505a\u7684\u4e8b\u60c5\uff01\");    \n}\n\npublic void destroy(){\n    System.out.println(\"\u6211\u662f\u5bf9\u8c61\u9500\u6bc1\u65f6\u8981\u505a\u7684\u4e8b\u60c5\uff01\");\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>init-method</code>\u548c<code>destroy-method</code>\u6765\u6307\u5b9a\uff1a</p> <pre><code>&lt;bean name=\"student\" class=\"com.test.bean.Student\" init-method=\"init\" destroy-method=\"destroy\"/&gt;\n</code></pre> <p>\u90a3\u4e48\u4ec0\u4e48\u65f6\u5019\u662f\u521d\u59cb\u5316\uff0c\u4ec0\u4e48\u65f6\u5019\u53c8\u662f\u9500\u6bc1\u5462\uff1f</p> <pre><code>//\u5f53\u5bb9\u5668\u521b\u5efa\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bBean\u90fd\u662f\u5355\u4f8b\u7684\uff0c\u90a3\u4e48\u90fd\u4f1a\u5728\u4e00\u5f00\u59cb\u5c31\u52a0\u8f7d\u597d\uff0c\u5bf9\u8c61\u6784\u9020\u5b8c\u6210\u540e\uff0c\u4f1a\u6267\u884cinit-method\nClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(\"test.xml\");\n//\u6211\u4eec\u53ef\u4ee5\u8c03\u7528close\u65b9\u6cd5\u5173\u95ed\u5bb9\u5668\uff0c\u6b64\u65f6\u5bb9\u5668\u5185\u5b58\u653e\u7684Bean\u4e5f\u4f1a\u88ab\u4e00\u8d77\u9500\u6bc1\uff0c\u4f1a\u6267\u884cdestroy-method\ncontext.close();\n</code></pre> <p>\u6240\u4ee5\u8bf4\uff0c\u6700\u540e\u7684\u7ed3\u679c\u4e3a\uff1a</p> <p></p> <p>\u6ce8\u610f\uff0c\u5982\u679cBean\u4e0d\u662f\u5355\u4f8b\u6a21\u5f0f\uff0c\u800c\u662f\u91c7\u7528\u7684\u539f\u578b\u6a21\u5f0f\uff0c\u90a3\u4e48\u5c31\u53ea\u4f1a\u5728\u83b7\u53d6\u65f6\u624d\u521b\u5efa\uff0c\u5e76\u8c03\u7528init-method\uff0c\u800c\u5bf9\u5e94\u7684\u9500\u6bc1\u65b9\u6cd5\u4e0d\u4f1a\u88ab\u8c03\u7528\uff08\u56e0\u6b64\uff0c\u5bf9\u4e8e\u539f\u578b\u6a21\u5f0f\u4e0b\u7684Bean\uff0cSpring\u65e0\u6cd5\u987e\u53ca\u5176\u5b8c\u6574\u751f\u547d\u5468\u671f\uff0c\u800c\u5728\u5355\u4f8b\u6a21\u5f0f\u4e0b\uff0cSpring\u80fd\u591f\u4eceBean\u5bf9\u8c61\u7684\u521b\u5efa\u4e00\u76f4\u7ba1\u7406\u5230\u5bf9\u8c61\u7684\u9500\u6bc1\uff09\u5b98\u65b9\u6587\u6863\u539f\u6587\u5982\u4e0b\uff1a</p> <p>In contrast to the other scopes, Spring does not manage the complete lifecycle of a prototype bean. The container instantiates, configures, and otherwise assembles a prototype object and hands it to the client, with no further record of that prototype instance. Thus, although initialization lifecycle callback methods are called on all objects regardless of scope, in the case of prototypes, configured destruction lifecycle callbacks are not called. The client code must clean up prototype-scoped objects and release expensive resources that the prototype beans hold. To get the Spring container to release resources held by prototype-scoped beans, try using a custom bean post-processor, which holds a reference to beans that need to be cleaned up.</p> <p>Bean\u4e4b\u95f4\u4e5f\u662f\u5177\u5907\u7ee7\u627f\u5173\u7cfb\u7684\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u91cc\u7684\u7ee7\u627f\u5e76\u4e0d\u662f\u7c7b\u7684\u7ee7\u627f\uff0c\u800c\u662f\u5c5e\u6027\u7684\u7ee7\u627f\uff0c\u6bd4\u5982\uff1a</p> <pre><code>public class SportStudent {\n    private String name;\n\n    public void setName(String name) {\n        this.name = name;\n    }\n}\n</code></pre> <pre><code>public class ArtStudent {\n    private String name;\n\n    public void setName(String name) {\n        this.name = name;\n    }\n}\n</code></pre> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u5148\u5c06ArtStudent\u6ce8\u518c\u4e00\u4e2aBean\uff1a</p> <pre><code>&lt;bean name=\"artStudent\" class=\"com.test.bean.ArtStudent\"&gt;\n    &lt;property name=\"name\" value=\"\u5c0f\u660e\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u4f1a\u6ce8\u5165\u4e00\u4e2aname\u7684\u521d\u59cb\u503c\uff0c\u6b64\u65f6\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2aSportStudent\u7684Bean\uff0c\u6211\u4eec\u5e0c\u671b\u8fd9\u4e2aBean\u7684\u5c5e\u6027\u8ddf\u521a\u521a\u521b\u5efa\u7684Bean\u5c5e\u6027\u662f\u4e00\u6837\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u4e00\u6a21\u4e00\u6837\u7684\uff1a</p> <pre><code>&lt;bean class=\"com.test.bean.SportStudent\"&gt;\n    &lt;property name=\"name\" value=\"\u5c0f\u660e\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u4f46\u662f\u5982\u679c\u5c5e\u6027\u592a\u591a\u7684\u8bdd\uff0c\u662f\u4e0d\u662f\u5199\u8d77\u6765\u6709\u70b9\u9ebb\u70e6\uff1f\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u914d\u7f6eBean\u4e4b\u95f4\u7684\u7ee7\u627f\u5173\u7cfb\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9SportStudent\u8fd9\u4e2aBean\u76f4\u63a5\u7ee7\u627fArtStudent\u8fd9\u4e2aBean\u914d\u7f6e\u7684\u5c5e\u6027\uff1a</p> <pre><code>&lt;bean class=\"com.test.bean.SportStudent\" parent=\"artStudent\"/&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u5728ArtStudent Bean\u4e2d\u914d\u7f6e\u7684\u5c5e\u6027\uff0c\u4f1a\u76f4\u63a5\u7ee7\u627f\u7ed9SportStudent Bean\uff08\u6ce8\u610f\uff0c\u6240\u6709\u914d\u7f6e\u7684\u5c5e\u6027\uff0c\u5728\u5b50Bean\u4e2d\u5fc5\u987b\u4e5f\u8981\u5b58\u5728\uff0c\u5e76\u4e14\u53ef\u4ee5\u8fdb\u884c\u6ce8\u5165\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u9519\u8bef\uff09\u5f53\u7136\uff0c\u5982\u679c\u5b50\u7c7b\u4e2d\u67d0\u4e9b\u5c5e\u6027\u6bd4\u8f83\u7279\u6b8a\uff0c\u4e5f\u53ef\u4ee5\u5728\u7ee7\u627f\u7684\u57fa\u7840\u4e0a\u5355\u72ec\u914d\u7f6e\uff1a</p> <pre><code>&lt;bean name=\"artStudent\" class=\"com.test.bean.ArtStudent\" abstract=\"true\"&gt;\n    &lt;property name=\"name\" value=\"\u5c0f\u660e\"/&gt;\n    &lt;property name=\"id\" value=\"1\"/&gt;\n&lt;/bean&gt;\n&lt;bean class=\"com.test.bean.SportStudent\" parent=\"artStudent\"&gt;\n    &lt;property name=\"id\" value=\"2\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u53ea\u662f\u5e0c\u671b\u67d0\u4e00\u4e2aBean\u4ec5\u4f5c\u4e3a\u4e00\u4e2a\u914d\u7f6e\u6a21\u7248\u4f9b\u5176\u4ed6Bean\u7ee7\u627f\u4f7f\u7528\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u914d\u7f6e\u4e3aabstract\uff0c\u8fd9\u6837\uff0c\u5bb9\u5668\u5c31\u4e0d\u4f1a\u521b\u5efa\u8fd9\u4e2aBean\u7684\u5bf9\u8c61\u4e86\uff1a</p> <pre><code>&lt;bean name=\"artStudent\" class=\"com.test.bean.ArtStudent\" abstract=\"true\"&gt;\n    &lt;property name=\"name\" value=\"\u5c0f\u660e\"/&gt;\n&lt;/bean&gt;\n&lt;bean class=\"com.test.bean.SportStudent\" parent=\"artStudent\"/&gt;\n</code></pre> <p>\u6ce8\u610f\uff0c\u4e00\u65e6\u58f0\u660e\u4e3a\u62bd\u8c61Bean\uff0c\u90a3\u4e48\u5c31\u65e0\u6cd5\u901a\u8fc7\u5bb9\u5668\u83b7\u53d6\u5230\u5176\u5b9e\u4f8b\u5316\u5bf9\u8c61\u4e86\u3002</p> <p></p> <p>\u4e0d\u8fc7Bean\u7684\u7ee7\u627f\u4f7f\u7528\u9891\u7387\u4e0d\u662f\u5f88\u9ad8\uff0c\u4e86\u89e3\u5c31\u884c\u3002</p> <p>\u8fd9\u91cc\u6700\u540e\u518d\u63d0\u4e00\u4e0b\uff0c\u6211\u4eec\u524d\u9762\u5df2\u7ecf\u5b66\u4e60\u4e86\u5404\u79cd\u5404\u6837\u7684Bean\u914d\u7f6e\u5c5e\u6027\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u6574\u4e2a\u4e0a\u4e0b\u6587\u4e2d\u6240\u6709\u7684Bean\u90fd\u91c7\u7528\u67d0\u79cd\u914d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6700\u5916\u5c42\u7684beans\u6807\u7b7e\u4e2d\u8fdb\u884c\u9ed8\u8ba4\u914d\u7f6e\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u5373\u4f7fBean\u6ca1\u6709\u914d\u7f6e\u67d0\u9879\u5c5e\u6027\uff0c\u4f46\u662f\u53ea\u8981\u5728\u6700\u5916\u5c42\u7f16\u5199\u4e86\u9ed8\u8ba4\u914d\u7f6e\uff0c\u90a3\u4e48\u540c\u6837\u4f1a\u751f\u6548\uff0c\u9664\u975eBean\u81ea\u5df1\u8fdb\u884c\u914d\u7f6e\u8986\u76d6\u6389\u9ed8\u8ba4\u914d\u7f6e\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#bean_1","title":"\u5de5\u5382\u6a21\u5f0f\u548c\u5de5\u5382Bean","text":"<p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86IoC\u5bb9\u5668\u7684Bean\u521b\u5efa\u673a\u5236\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bb9\u5668\u4f1a\u8c03\u7528Bean\u5bf9\u5e94\u7c7b\u578b\u7684\u6784\u9020\u65b9\u6cd5\u8fdb\u884c\u5bf9\u8c61\u521b\u5efa\uff0c\u4f46\u662f\u5728\u67d0\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u4e0d\u5e0c\u671b\u5916\u754c\u4f7f\u7528\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\u5b8c\u6210\u5bf9\u8c61\u521b\u5efa\uff0c\u6bd4\u5982\u5728\u5de5\u5382\u65b9\u6cd5\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\uff08\u8be6\u60c5\u8bf7\u89c2\u770b\u300aJava\u8bbe\u8ba1\u6a21\u5f0f\u300b\u7bc7 \u89c6\u9891\u6559\u7a0b\uff09\u6211\u4eec\u66f4\u5e0c\u671b Spring\u4e0d\u8981\u76f4\u63a5\u5229\u7528\u53cd\u5c04\u673a\u5236\u901a\u8fc7\u6784\u9020\u65b9\u6cd5\u521b\u5efaBean\u5bf9\u8c61\uff0c \u800c\u662f\u5229\u7528\u53cd\u5c04\u673a\u5236\u5148\u627e\u5230\u5bf9\u5e94\u7684\u5de5\u5382\u7c7b\uff0c\u7136\u540e\u5229\u7528\u5de5\u5382\u7c7b\u53bb\u751f\u6210\u9700\u8981\u7684Bean\u5bf9\u8c61\uff1a</p> <pre><code>public class Student {\n    Student() {\n        System.out.println(\"\u6211\u88ab\u6784\u9020\u4e86\");\n    }\n}\n</code></pre> <pre><code>public class StudentFactory {\n    public static Student getStudent(){\n        System.out.println(\"\u6b22\u8fce\u5149\u4e34\u7535\u5b50\u5382\");\n        return new Student();\n    }\n}\n</code></pre> <p>\u6b64\u65f6Student\u6709\u4e00\u4e2a\u5de5\u5382\uff0c\u6211\u4eec\u6b63\u5e38\u60c5\u51b5\u4e0b\u9700\u8981\u4f7f\u7528\u5de5\u5382\u624d\u53ef\u4ee5\u5f97\u5230Student\u5bf9\u8c61\uff0c\u73b0\u5728\u6211\u4eec\u5e0c\u671bSpring\u4e5f\u8fd9\u6837\u505a\uff0c\u4e0d\u8981\u76f4\u63a5\u53bb\u53cd\u5c04\u641e\u6784\u9020\u65b9\u6cd5\u521b\u5efa\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7factory-method\u8fdb\u884c\u6307\u5b9a\uff1a</p> <pre><code>&lt;bean class=\"com.test.bean.StudentFactory\" factory-method=\"getStudent\"/&gt;\n</code></pre> <p>\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684Bean\u7c7b\u578b\u9700\u8981\u586b\u5199\u4e3aStudent\u7c7b\u7684\u5de5\u5382\u7c7b\uff0c\u5e76\u4e14\u6dfb\u52a0factory-method\u6307\u5b9a\u5bf9\u5e94\u7684\u5de5\u5382\u65b9\u6cd5\uff0c\u4f46\u662f\u6700\u540e\u6ce8\u518c\u7684\u662f\u5de5\u5382\u65b9\u6cd5\u7684\u8fd4\u56de\u7c7b\u578b\uff0c\u6240\u4ee5\u8bf4\u4f9d\u7136\u662fStudent\u7684Bean\uff1a</p> <p></p> <p>\u6b64\u65f6\u6211\u4eec\u518d\u53bb\u8fdb\u884c\u83b7\u53d6\uff0c\u62ff\u5230\u7684\u4e5f\u662f\u901a\u8fc7\u5de5\u5382\u65b9\u6cd5\u5f97\u5230\u7684\u5bf9\u8c61\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6709\u4e00\u4e2a\u8bef\u533a\uff0c\u5343\u4e07\u4e0d\u8981\u8ba4\u4e3a\u662f\u6211\u4eec\u6ce8\u518c\u4e86StudentFactory\u8fd9\u4e2aBean\uff0cclass\u586b\u5199\u4e3a\u8fd9\u4e2a\u7c7b\u8fd9\u4e2a\u53ea\u662f\u4e3a\u4e86\u544a\u8bc9Spring\u6211\u4eec\u7684\u5de5\u5382\u65b9\u6cd5\u5728\u54ea\u4e2a\u4f4d\u7f6e\uff0c\u771f\u6b63\u6ce8\u518c\u7684\u662f\u5de5\u5382\u65b9\u6cd5\u63d0\u4f9b\u7684\u4e1c\u897f\u3002</p> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f53\u6211\u4eec\u91c7\u7528\u5de5\u5382\u6a21\u5f0f\u540e\uff0c\u6211\u4eec\u5c31\u65e0\u6cd5\u518d\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u5bf9Bean\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165\u7b49\u64cd\u4f5c\u4e86\uff0c\u800c\u662f\u53ea\u80fd\u5728\u5de5\u5382\u65b9\u6cd5\u4e2d\u5b8c\u6210\uff0c\u8fd9\u4f3c\u4e4e\u4e0eSpring\u7684\u8bbe\u8ba1\u7406\u5ff5\u80cc\u9053\u800c\u9a70\uff1f</p> <p>\u5f53\u7136\uff0c\u53ef\u80fd\u67d0\u4e9b\u5de5\u5382\u7c7b\u9700\u8981\u6784\u9020\u51fa\u5bf9\u8c61\u4e4b\u540e\u624d\u80fd\u4f7f\u7528\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u67d0\u4e2a\u5de5\u5382\u7c7b\u76f4\u63a5\u6ce8\u518c\u4e3a\u5de5\u5382Bean\uff1a</p> <pre><code>public class StudentFactory {\n    public Student getStudent(){\n        System.out.println(\"\u6b22\u8fce\u5149\u4e34\u7535\u5b50\u5382\");\n        return new Student();\n    }\n}\n</code></pre> <p>\u73b0\u5728\u9700\u8981StudentFactory\u5bf9\u8c61\u624d\u53ef\u4ee5\u83b7\u53d6\u5230Student\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u53ea\u80fd\u5148\u5c06\u5176\u6ce8\u518c\u4e3aBean\u4e86\uff1a</p> <pre><code>&lt;bean name=\"studentFactory\" class=\"com.test.bean.StudentFactory\"/&gt;\n</code></pre> <p>\u50cf\u8fd9\u6837\u5c06\u5de5\u5382\u7c7b\u6ce8\u518c\u4e3aBean\uff0c\u6211\u4eec\u79f0\u5176\u4e3a\u5de5\u5382Bean\uff0c\u7136\u540e\u518d\u4f7f\u7528<code>factory-bean</code>\u6765\u6307\u5b9aBean\u7684\u5de5\u5382Bean\uff1a</p> <pre><code>&lt;bean factory-bean=\"studentFactory\" factory-method=\"getStudent\"/&gt;\n</code></pre> <p>\u6ce8\u610f\uff0c\u4f7f\u7528factory-bean\u4e4b\u540e\uff0c\u4e0d\u518d\u8981\u6c42\u6307\u5b9aclass\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e86\uff1a</p> <p></p> <p>\u6b64\u65f6\u53ef\u4ee5\u770b\u5230\uff0c\u5de5\u5382\u65b9\u6cd5\u4e0a\u540c\u6837\u6709\u4e86\u56fe\u6807\uff0c\u8fd9\u79cd\u65b9\u5f0f\uff0c\u7531\u4e8e\u5de5\u5382\u7c7b\u88ab\u6ce8\u518c\u4e3aBean\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4e3a\u5de5\u5382Bean\u914d\u7f6e\u4f9d\u8d56\u6ce8\u5165\u7b49\u5185\u5bb9\u4e86\u3002</p> <p>\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u5f88\u7ec6\u8282\u7684\u64cd\u4f5c\uff0c\u5982\u679c\u6211\u4eec\u60f3\u83b7\u53d6\u5de5\u5382Bean\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684Bean\uff0c\u53ef\u4ee5\u76f4\u63a5\u8f93\u5165\u5de5\u5382Bean\u7684\u540d\u79f0\uff0c\u8fd9\u6837\u4e0d\u4f1a\u5f97\u5230\u5de5\u5382Bean\u7684\u5b9e\u4f8b\uff0c\u800c\u662f\u5de5\u5382Bean\u751f\u4ea7\u7684Bean\u7684\u5b9e\u4f8b\uff1a</p> <pre><code>Student bean = (Student) context.getBean(\"studentFactory\");\n</code></pre> <p>\u5f53\u7136\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u83b7\u53d6\u5de5\u5382\u7c7b\u7684\u5b9e\u4f8b\uff0c\u53ef\u4ee5\u5728\u540d\u79f0\u524d\u9762\u6dfb\u52a0<code>&amp;</code>\u7b26\u53f7\uff1a</p> <pre><code>StudentFactory bean = (StudentFactory) context.getBean(\"&amp;studentFactory\");\n</code></pre> <p>\u53c8\u662f\u4e00\u4e2a\u5c0f\u7ec6\u8282\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_4","title":"\u4f7f\u7528\u6ce8\u89e3\u5f00\u53d1","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86\u5927\u90e8\u5206\u7684\u914d\u7f6e\u6587\u4ef6\u5b66\u4e60\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e\uff0c\u8c8c\u4f3c\u6709\u70b9\u592a\u7d2f\u4e86\u5427\uff1f\u53ef\u4ee5\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c\u6211\u4eec\u7684\u9879\u76ee\u975e\u5e38\u5e9e\u5927\uff0c\u6574\u4e2a\u914d\u7f6e\u6587\u4ef6\u5c06\u4f1a\u5145\u6ee1Bean\u914d\u7f6e\uff0c\u5e76\u4e14\u4f1a\u7ee7\u7eed\u5e9e\u5927\u4e0b\u53bb\uff0c\u80fd\u5426\u6709\u4e00\u79cd\u66f4\u52a0\u9ad8\u6548\u7684\u65b9\u6cd5\u80fd\u591f\u7701\u53bb\u914d\u7f6e\u5462\uff1f\u8fd8\u8bb0\u5f97\u6211\u4eec\u5728JavaWeb\u9636\u6bb5\u7528\u5230\u7684\u975e\u5e38\u65b9\u4fbf\u4e1c\u897f\u5417\uff1f\u6ca1\u9519\uff0c\u5c31\u662f\u6ce8\u89e3\u3002</p> <p>\u65e2\u7136\u73b0\u5728\u8981\u4f7f\u7528\u6ce8\u89e3\u6765\u8fdb\u884c\u5f00\u53d1\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5220\u6389\u4e4b\u524d\u7684xml\u914d\u7f6e\u6587\u4ef6\u5427\uff0c\u6211\u4eec\u6765\u770b\u770b\u4f7f\u7528\u6ce8\u89e3\u80fd\u6709\u591a\u65b9\u4fbf\u3002</p> <pre><code>ApplicationContext context = new AnnotationConfigApplicationContext();\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u4f7f\u7528AnnotationConfigApplicationContext\u4f5c\u4e3a\u4e0a\u4e0b\u6587\u5b9e\u73b0\uff0c\u5b83\u662f\u6ce8\u89e3\u914d\u7f6e\u7684\u3002</p> <p>\u65e2\u7136\u73b0\u5728\u91c7\u7528\u6ce8\u89e3\uff0c\u6211\u4eec\u5c31\u9700\u8981\u4f7f\u7528\u7c7b\u6765\u7f16\u5199\u914d\u7f6e\u6587\u4ef6\uff0c\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u5982\u679c\u8981\u7f16\u5199\u4e00\u4e2a\u914d\u7f6e\u7684\u8bdd\uff0c\u9700\u8981\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n&lt;/beans&gt;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u7c7b\u5c31\u53ef\u4ee5\u4e86\uff1a</p> <pre><code>@Configuration\npublic class MainConfiguration {\n}\n</code></pre> <p>\u8fd9\u4e24\u8005\u662f\u7b49\u4ef7\u7684\uff0c\u540c\u6837\u7684\uff0c\u5728\u4e00\u5f00\u59cb\u4f1a\u63d0\u793a\u6211\u4eec\u6ca1\u6709\u914d\u7f6e\u4e0a\u4e0b\u6587\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6309\u7167\u8981\u6c42\u914d\u7f6e\u4e00\u4e0b\u5c31\u53ef\u4ee5\uff0c\u540c\u4e0a\uff0c\u8fd9\u4e2a\u53ea\u662f\u4f1a\u5f71\u54cdIDEA\u7684\u4ee3\u7801\u63d0\u793a\uff0c\u4e0d\u4f1a\u5f71\u54cd\u7a0b\u5e8f\u8fd0\u884c\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4e3aAnnotationConfigApplicationContext\u6307\u5b9a\u4e00\u4e2a\u9ed8\u8ba4\u7684\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>ApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class);\n//\u8fd9\u4e2a\u6784\u9020\u65b9\u6cd5\u53ef\u4ee5\u63a5\u6536\u591a\u4e2a\u914d\u7f6e\u7c7b\uff08\u66f4\u51c6\u786e\u7684\u8bf4\u662f\u591a\u4e2a\u7ec4\u4ef6\uff09\n</code></pre> <p>\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u8be5\u5982\u4f55\u914d\u7f6eBean\u5462\uff1f</p> <pre><code>@Configuration\npublic class MainConfiguration {\n\n    @Bean(\"student\")\n    public Student student(){\n        return new Student();\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u5199\u76f8\u5bf9\u4e8e\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n    &lt;bean name = \"student\" class=\"com.test.bean.Student\"/&gt;\n&lt;/beans&gt;\n</code></pre> <p>\u901a\u8fc7@Import\u8fd8\u53ef\u4ee5\u5f15\u5165\u5176\u4ed6\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>@Import(LBWConfiguration.class)  //\u5728\u8bb2\u89e3\u5230Spring\u539f\u7406\u65f6\uff0c\u6211\u4eec\u8fd8\u4f1a\u9047\u5230\u5b83\uff0c\u76ee\u524d\u53ea\u505a\u4e86\u89e3\u5373\u53ef\u3002\n@Configuration\npublic class MainConfiguration {\n</code></pre> <p>\u53ea\u4e0d\u8fc7\u73b0\u5728\u53d8\u6210\u4e86\u7531Java\u4ee3\u7801\u4e3a\u6211\u4eec\u63d0\u4f9bBean\u914d\u7f6e\uff0c\u8fd9\u6837\u4f1a\u66f4\u52a0\u7684\u7075\u6d3b\uff0c\u4e5f\u66f4\u52a0\u4fbf\u4e8e\u63a7\u5236Bean\u5bf9\u8c61\u7684\u521b\u5efa\u3002</p> <pre><code>ApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class);\nStudent student = context.getBean(Student.class);\nSystem.out.println(student);\n</code></pre> <p>\u4f7f\u7528\u65b9\u6cd5\u662f\u76f8\u540c\u7684\uff0c\u8fd9\u8ddf\u4f7f\u7528XML\u914d\u7f6e\u662f\u4e00\u6837\u7684\u3002</p> <p>\u90a3\u4e48\u80af\u5b9a\u5c31\u6709\u5c0f\u4f19\u4f34\u597d\u5947\u4e86\uff0c\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u90a3\u4e48\u591a\u7279\u6027\u5728\u54ea\u91cc\u914d\u7f6e\u5462\uff1f\u9996\u5148\uff0c\u521d\u59cb\u5316\u65b9\u6cd5\u548c\u6467\u6bc1\u65b9\u6cd5\u3001\u81ea\u52a8\u88c5\u914d\u53ef\u4ee5\u76f4\u63a5\u5728@Bean\u6ce8\u89e3\u4e2d\u8fdb\u884c\u914d\u7f6e\uff1a</p> <pre><code>@Bean(name = \"\", initMethod = \"\", destroyMethod = \"\", autowireCandidate = false)\npublic Student student(){\n    return new Student();\n}\n</code></pre> <p>\u5176\u6b21\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5176\u4ed6\u7684\u6ce8\u89e3\u6765\u914d\u7f6e\u5176\u4ed6\u5c5e\u6027\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@Bean\n@Lazy(true)     //\u5bf9\u5e94lazy-init\u5c5e\u6027\n@Scope(\"prototype\")    //\u5bf9\u5e94scope\u5c5e\u6027\n@DependsOn(\"teacher\")    //\u5bf9\u5e94depends-on\u5c5e\u6027\npublic Student student(){\n    return new Student();\n}\n</code></pre> <p>\u5bf9\u4e8e\u90a3\u4e9b\u6211\u4eec\u9700\u8981\u901a\u8fc7\u6784\u9020\u65b9\u6cd5\u6216\u662fSetter\u5b8c\u6210\u4f9d\u8d56\u6ce8\u5165\u7684Bean\uff0c\u6bd4\u5982\uff1a</p> <pre><code>&lt;bean name=\"teacher\" class=\"com.test.bean.ProgramTeacher\"/&gt;\n&lt;bean name=\"student\" class=\"com.test.bean.Student\"&gt;\n    &lt;property name=\"teacher\" ref=\"teacher\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u50cf\u8fd9\u79cd\u9700\u8981\u5f15\u5165\u5176\u4ed6Bean\u8fdb\u884c\u7684\u6ce8\u5165\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u4f5c\u4e3a\u5f62\u5f0f\u53c2\u6570\u653e\u5230\u65b9\u6cd5\u4e2d\uff1a</p> <pre><code>@Configuration\npublic class MainConfiguration {\n    @Bean\n    public Teacher teacher(){\n        return new Teacher();\n    }\n\n    @Bean\n    public Student student(Teacher teacher){\n        return new Student(teacher);\n    }\n}\n</code></pre> <p>\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u65c1\u8fb9\u5df2\u7ecf\u51fa\u73b0\u56fe\u6807\u4e86\uff1a</p> <p></p> <p>\u8fd0\u884c\u7a0b\u5e8f\u4e4b\u540e\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u6837\u786e\u5b9e\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u5bf9\u5e94\u7684Bean\u5e76\u4f7f\u7528\u3002</p> <p>\u53ea\u4e0d\u8fc7\uff0c\u9664\u4e86\u8fd9\u79cd\u57fa\u4e8e\u6784\u9020\u5668\u6216\u662fSetter\u7684\u4f9d\u8d56\u6ce8\u5165\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5230Bean\u5bf9\u5e94\u7684\u7c7b\u4e2d\u4f7f\u7528\u81ea\u52a8\u88c5\u914d\uff1a</p> <pre><code>public class Student {\n    @Autowired   //\u4f7f\u7528\u6b64\u6ce8\u89e3\u6765\u8fdb\u884c\u81ea\u52a8\u88c5\u914d\uff0c\u7531IoC\u5bb9\u5668\u81ea\u52a8\u4e3a\u5176\u8d4b\u503c\n    private Teacher teacher;\n}\n</code></pre> <p>\u73b0\u5728\uff0c\u6211\u4eec\u751a\u81f3\u8fde\u6784\u9020\u65b9\u6cd5\u548cSetter\u90fd\u4e0d\u9700\u8981\u53bb\u7f16\u5199\u4e86\uff0c\u5c31\u80fd\u76f4\u63a5\u5b8c\u6210\u81ea\u52a8\u88c5\u914d\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u6bd4\u90a3\u5806\u914d\u7f6e\u65b9\u4fbf\u591a\u4e86\uff1f</p> <p>\u5f53\u7136\uff0c@Autowired\u5e76\u4e0d\u662f\u53ea\u80fd\u7528\u4e8e\u5b57\u6bb5\uff0c\u5bf9\u4e8e\u6784\u9020\u65b9\u6cd5\u6216\u662fSetter\uff0c\u5b83\u540c\u6837\u53ef\u4ee5\uff1a</p> <pre><code>public class Student {\n    private Teacher teacher;\n\n    @Autowired\n    public void setTeacher(Teacher teacher) {\n        this.teacher = teacher;\n    }\n}\n</code></pre> <p>@Autowired\u9ed8\u8ba4\u91c7\u7528byType\u7684\u65b9\u5f0f\u8fdb\u884c\u81ea\u52a8\u88c5\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f1a\u4f7f\u7528\u7c7b\u578b\u8fdb\u884c\u914d\uff0c\u90a3\u4e48\u8981\u662f\u51fa\u73b0\u4e86\u591a\u4e2a\u76f8\u540c\u7c7b\u578b\u7684Bean\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u6307\u5b9a\u4f7f\u7528\u5176\u4e2d\u7684\u67d0\u4e00\u4e2a\u8be5\u600e\u4e48\u529e\u5462\uff1f</p> <pre><code>@Bean(\"a\")\npublic Teacher teacherA(){\n    return new Teacher();\n}\n\n@Bean(\"b\")\npublic Teacher teacherB(){\n    return new Teacher();\n}\n</code></pre> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u914d\u5408@Qualifier\u8fdb\u884c\u540d\u79f0\u5339\u914d\uff1a</p> <pre><code>public class Student {\n    @Autowired\n    @Qualifier(\"a\")   //\u5339\u914d\u540d\u79f0\u4e3aa\u7684Teacher\u7c7b\u578b\u7684Bean\n    private Teacher teacher;\n}\n</code></pre> <p>\u8fd9\u91cc\u9700\u8981\u63d0\u4e00\u4e0b\uff0c\u5728\u6211\u4eec\u65e7\u7248\u672c\u7684SSM\u6559\u7a0b\u4e2d\u8bb2\u89e3\u4e86@Resource\u8fd9\u4e2a\u6ce8\u89e3\uff0c\u4f46\u662f\u73b0\u5728\u5b83\u6ca1\u6709\u4e86\u3002</p> <p>\u968f\u7740Java\u7248\u672c\u7684\u66f4\u65b0\u8fed\u4ee3\uff0c\u67d0\u4e9bjavax\u5305\u4e0b\u7684\u5305\uff0c\u4f1a\u88ab\u9010\u6e10\u5f03\u7528\u5e76\u79fb\u9664\u3002\u5728JDK11\u7248\u672c\u4ee5\u540e\uff0cjavax.annotation\u8fd9\u4e2a\u5305\u88ab\u79fb\u9664\u5e76\u4e14\u66f4\u540d\u4e3ajakarta.annotation\uff08\u6211\u4eec\u5728JavaWeb\u7bc7\u5df2\u7ecf\u4ecb\u7ecd\u8fc7\u4e3a\u4ec0\u4e48\u8981\u6539\u540d\u5b57\u4e86\uff09\u5176\u4e2d\u6709\u4e00\u4e2a\u975e\u5e38\u91cd\u8981\u7684\u6ce8\u89e3\uff0c\u53eb\u505a@Resource\uff0c\u5b83\u7684\u4f5c\u7528\u4e0e@Autowired\u65f6\u76f8\u540c\u7684\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u81ea\u52a8\u88c5\u914d\uff0c\u4f46\u662f\u5728IDEA\u4e2d\u5e76\u4e0d\u63a8\u8350\u4f7f\u7528@Autowired\u6ce8\u89e3\u5bf9\u6210\u5458\u5b57\u6bb5\u8fdb\u884c\u81ea\u52a8\u88c5\u914d\uff0c\u800c\u662f\u63a8\u8350\u4f7f\u7528@Resource\uff0c\u5982\u679c\u9700\u8981\u4f7f\u7528\u8fd9\u4e2a\u6ce8\u89e3\uff0c\u8fd8\u9700\u8981\u989d\u5916\u5bfc\u5165\u5305\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt;\n    &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt;\n    &lt;version&gt;2.1.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u4f7f\u7528\u65b9\u6cd5\u4e00\u6837\uff0c\u76f4\u63a5\u66ff\u6362\u6389\u5c31\u53ef\u4ee5\u4e86\uff1a</p> <pre><code>public class Student {\n    @Resource\n    private Teacher teacher;\n}\n</code></pre> <p>\u53ea\u4e0d\u8fc7\uff0c\u4ed6\u4eec\u4e24\u6709\u4e9b\u673a\u5236\u4e0a\u7684\u4e0d\u540c\uff1a</p> <ul> <li>@Resource\u9ed8\u8ba4ByName\u5982\u679c\u627e\u4e0d\u5230\u5219ByType\uff0c\u53ef\u4ee5\u6dfb\u52a0\u5230set\u65b9\u6cd5\u3001\u5b57\u6bb5\u4e0a\u3002</li> <li>@Autowired\u9ed8\u8ba4\u662fbyType\uff0c\u53ea\u4f1a\u6839\u636e\u7c7b\u578b\u5bfb\u627e\uff0c\u53ef\u4ee5\u6dfb\u52a0\u5728\u6784\u9020\u65b9\u6cd5\u3001set\u65b9\u6cd5\u3001\u5b57\u6bb5\u3001\u65b9\u6cd5\u53c2\u6570\u4e0a\u3002</li> </ul> <p>\u56e0\u4e3a@Resource\u7684\u5339\u914d\u673a\u5236\u66f4\u52a0\u5408\u7406\u9ad8\u6548\uff0c\u56e0\u6b64\u5b98\u65b9\u5e76\u4e0d\u63a8\u8350\u4f7f\u7528@Autowired\u5b57\u6bb5\u6ce8\u5165\uff0c\u5f53\u7136\uff0c\u5b9e\u9645\u4e0aSpring\u5b98\u65b9\u66f4\u63a8\u8350\u6211\u4eec\u4f7f\u7528\u57fa\u4e8e\u6784\u9020\u65b9\u6cd5\u6216\u662fSetter\u7684@Autowired\u6ce8\u5165\uff0c\u6bd4\u5982Setter \u6ce8\u5165\u7684\u4e00\u4e2a\u597d\u5904\u662f\uff0cSetter \u65b9\u6cd5\u4f7f\u8be5\u7c7b\u7684\u5bf9\u8c61\u80fd\u591f\u5728\u4ee5\u540e\u91cd\u65b0\u914d\u7f6e\u6216\u91cd\u65b0\u6ce8\u5165\u3002\u5176\u5b9e\uff0c\u6700\u540e\u4f7f\u7528\u54ea\u4e2a\u6ce8\u89e3\uff0c\u8fd8\u662f\u770b\u4f60\u81ea\u5df1\uff0c\u8981\u662f\u6709\u5f3a\u8feb\u75c7\u4e0d\u80fd\u5fcd\u53d7\u9ec4\u6807\u4f46\u662f\u53c8\u5b9e\u5728\u60f3\u7528\u5b57\u6bb5\u6ce8\u5165\uff0c\u90a3\u5c31\u7528@Resource\u6ce8\u89e3\u3002</p> <p>\u9664\u4e86\u8fd9\u4e2a\u6ce8\u89e3\u4e4b\u5916\uff0c\u8fd8\u6709@PostConstruct\u548c@PreDestroy\uff0c\u5b83\u4eec\u6548\u679c\u548cinit-method\u548cdestroy-method\u662f\u4e00\u6837\u7684\uff1a</p> <pre><code>@PostConstruct\npublic void init(){\n    System.out.println(\"\u6211\u662f\u521d\u59cb\u5316\u65b9\u6cd5\");\n}\n\n@PreDestroy\npublic void destroy(){\n    System.out.println(\"\u6211\u662f\u9500\u6bc1\u65b9\u6cd5\");\n}\n</code></pre> <p>\u6211\u4eec\u53ea\u9700\u8981\u5c06\u5176\u6dfb\u52a0\u5230\u5bf9\u5e94\u7684\u65b9\u6cd5\u4e0a\u5373\u53ef\uff1a</p> <pre><code>AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class);\nStudent student = context.getBean(Student.class);\ncontext.close();\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6548\u679c\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u8fd9\u4e9b\u6ce8\u89e3\u90fd\u662fjakarta.annotation\u63d0\u4f9b\u7684\uff0c\u6709\u5173Spring\u548cJakartaEE\u7684\u6e0a\u6e90\uff0c\u8fd8\u8bf7\u5404\u4f4d\u5c0f\u4f19\u4f34\u81ea\u884c\u4e86\u89e3\u3002</p> <p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u4f7f\u7528@Bean\u6765\u6ce8\u518cBean\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u53ea\u662f\u7b80\u5355\u5c06\u4e00\u4e2a\u7c7b\u4f5c\u4e3aBean\u7684\u8bdd\uff0c\u8fd9\u6837\u5199\u8fd8\u662f\u4e0d\u592a\u65b9\u4fbf\uff0c\u56e0\u4e3a\u90fd\u662f\u56fa\u5b9a\u6a21\u5f0f\uff0c\u5c31\u662f\u5355\u7eaf\u7684new\u4e00\u4e2a\u5bf9\u8c61\u51fa\u6765\uff0c\u80fd\u4e0d\u80fd\u50cf\u4e4b\u524d\u4e00\u6837\uff0c\u8ba9\u5bb9\u5668\u81ea\u5df1\u53cd\u5c04\u83b7\u53d6\u6784\u9020\u65b9\u6cd5\u53bb\u751f\u6210\u8fd9\u4e2a\u5bf9\u8c61\u5462\uff1f</p> <p>\u80af\u5b9a\u662f\u53ef\u4ee5\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u9700\u8981\u6ce8\u518c\u4e3aBean\u7684\u7c7b\u4e0a\u6dfb\u52a0<code>@Component</code>\u6ce8\u89e3\u6765\u5c06\u4e00\u4e2a\u7c7b\u8fdb\u884c\u6ce8\u518c\uff08\u73b0\u5728\u6700\u5e38\u7528\u7684\u65b9\u5f0f\uff09\uff0c\u4e0d\u8fc7\u8981\u5b9e\u73b0\u8fd9\u6837\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u81ea\u52a8\u626b\u63cf\u6765\u544a\u8bc9Spring\uff0c\u5b83\u9700\u8981\u5728\u54ea\u4e9b\u5305\u4e2d\u67e5\u627e\u6211\u4eec\u63d0\u4f9b\u7684<code>@Component</code>\u58f0\u660e\u7684Bean\u3002</p> <pre><code>@Component(\"lbwnb\")   //\u540c\u6837\u53ef\u4ee5\u81ea\u5df1\u8d77\u540d\u5b57\npublic class Student {\n\n}\n</code></pre> <p>\u8981\u6ce8\u518c\u8fd9\u4e2a\u7c7b\u7684Bean\uff0c\u53ea\u9700\u8981\u6dfb\u52a0@Component\u5373\u53ef\uff0c\u7136\u540e\u914d\u7f6e\u4e00\u4e0b\u5305\u626b\u63cf\uff1a</p> <pre><code>@Configuration\n@ComponentScan(\"com.test.bean\")   //\u5305\u626b\u63cf\uff0c\u8fd9\u6837Spring\u5c31\u4f1a\u53bb\u626b\u63cf\u5bf9\u5e94\u5305\u4e0b\u6240\u6709\u7684\u7c7b\npublic class MainConfiguration {\n\n}\n</code></pre> <p>Spring\u5728\u626b\u63cf\u5bf9\u5e94\u5305\u4e0b\u6240\u6709\u7684\u7c7b\u65f6\uff0c\u4f1a\u81ea\u52a8\u5c06\u90a3\u4e9b\u6dfb\u52a0\u4e86@Component\u7684\u7c7b\u6ce8\u518c\u4e3aBean\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u5f88\u65b9\u4fbf\uff1f\u53ea\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u53ea\u9002\u7528\u4e8e\u6211\u4eec\u81ea\u5df1\u7f16\u5199\u7c7b\u7684\u60c5\u51b5\uff0c\u5982\u679c\u662f\u7b2c\u4e09\u65b9\u5305\u63d0\u4f9b\u7684\u7c7b\uff0c\u53ea\u80fd\u4f7f\u7528\u524d\u8005\u5b8c\u6210\u6ce8\u518c\uff0c\u5e76\u4e14\u8fd9\u79cd\u65b9\u5f0f\u5e76\u4e0d\u662f\u90a3\u4e48\u7684\u7075\u6d3b\u3002</p> <p>\u4e0d\u8fc7\uff0c\u65e0\u8bba\u662f\u901a\u8fc7@Bean\u8fd8\u662f@Component\u5f62\u5f0f\u6ce8\u518c\u7684Bean\uff0cSpring\u90fd\u4f1a\u4e3a\u5176\u6dfb\u52a0\u4e00\u4e2a\u9ed8\u8ba4\u7684name\u5c5e\u6027\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@Component\npublic class Student {\n}\n</code></pre> <p>\u5b83\u7684\u9ed8\u8ba4\u540d\u79f0\u751f\u4ea7\u89c4\u5219\u4f9d\u7136\u662f\u7c7b\u540d\u5e76\u6309\u7167\u9996\u5b57\u6bcd\u5c0f\u5199\u7684\u9a7c\u5cf0\u547d\u540d\u6cd5\u6765\u7684\uff0c\u6240\u4ee5\u8bf4\u5bf9\u5e94\u7684\u5c31\u662fstudent\uff1a</p> <pre><code>Student student = (Student) context.getBean(\"student\");   //\u8fd9\u6837\u540c\u6837\u53ef\u4ee5\u83b7\u53d6\u5230\nSystem.out.println(student);\n</code></pre> <p>\u540c\u6837\u7684\uff0c\u5982\u679c\u662f\u901a\u8fc7@Bean\u6ce8\u518c\u7684\uff0c\u9ed8\u8ba4\u540d\u79f0\u662f\u5bf9\u5e94\u7684\u65b9\u6cd5\u540d\u79f0\uff1a</p> <pre><code>@Bean\npublic Student artStudent(){\n    return new Student();\n}\n</code></pre> <pre><code>Student student = (Student) context.getBean(\"artStudent\");\nSystem.out.println(student);\n</code></pre> <p>\u76f8\u6bd4\u4f20\u7edf\u7684XML\u914d\u7f6e\u65b9\u5f0f\uff0c\u6ce8\u89e3\u5f62\u5f0f\u7684\u914d\u7f6e\u786e\u5b9e\u80fd\u591f\u51cf\u5c11\u6211\u4eec\u5f88\u591a\u5de5\u4f5c\u91cf\u3002\u5e76\u4e14\uff0c\u5bf9\u4e8e\u8fd9\u79cd\u4f7f\u7528<code>@Component</code>\u6ce8\u518c\u7684Bean\uff0c\u5982\u679c\u5176\u6784\u9020\u65b9\u6cd5\u4e0d\u662f\u9ed8\u8ba4\u65e0\u53c2\u6784\u9020\uff0c\u90a3\u4e48\u9ed8\u8ba4\u4f1a\u5bf9\u5176\u6bcf\u4e00\u4e2a\u53c2\u6570\u90fd\u8fdb\u884c\u81ea\u52a8\u6ce8\u5165\uff1a</p> <pre><code>@Component\npublic class Student {\n    Teacher teacher;\n    public Student(Teacher teacher){   //\u5982\u679c\u6709Teacher\u7c7b\u578b\u7684Bean\uff0c\u90a3\u4e48\u8fd9\u91cc\u7684\u53c2\u6570\u4f1a\u88ab\u81ea\u52a8\u6ce8\u5165\n        this.teacher = teacher;\n    }\n}\n</code></pre> <p>\u6700\u540e\uff0c\u5bf9\u4e8e\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u5de5\u5382\u6a21\u5f0f\uff0cSpring\u4e5f\u63d0\u4f9b\u4e86\u63a5\u53e3\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5b9e\u73b0\u63a5\u53e3\u8868\u793a\u8fd9\u4e2aBean\u662f\u4e00\u4e2a\u5de5\u5382Bean\uff1a</p> <pre><code>@Component\npublic class StudentFactory implements FactoryBean&lt;Student&gt; {\n    @Override\n    public Student getObject() {   //\u751f\u4ea7\u7684Bean\u5bf9\u8c61\n        return new Student();\n    }\n\n    @Override\n    public Class&lt;?&gt; getObjectType() {   //\u751f\u4ea7\u7684Bean\u7c7b\u578b\n        return Student.class;\n    }\n\n    @Override\n    public boolean isSingleton() {   //\u751f\u4ea7\u7684Bean\u662f\u5426\u91c7\u7528\u5355\u4f8b\u6a21\u5f0f\n        return false;\n    }\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\u8ddf\u6211\u4eec\u4e4b\u524d\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u7f16\u5199\u662f\u4e00\u6837\u7684\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bf4\u4e86\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0c\u4f7f\u7528\u6ce8\u89e3\u867d\u7136\u53ef\u4ee5\u7701\u4e8b\u5f88\u591a\uff0c\u4ee3\u7801\u4e5f\u80fd\u53d8\u5f97\u66f4\u7b80\u6d01\uff0c\u4f46\u662f\u8fd9\u5e76\u4e0d\u4ee3\u8868XML\u914d\u7f6e\u6587\u4ef6\u5c31\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff0c\u5b83\u4eec\u6709\u7740\u5404\u81ea\u7684\u4f18\u70b9\uff0c\u5728\u4e0d\u540c\u7684\u573a\u666f\u4e0b\u5408\u7406\u4f7f\u7528\uff0c\u80fd\u591f\u8d77\u5230\u4e8b\u534a\u529f\u500d\u7684\u6548\u679c\uff0c\u5b98\u65b9\u539f\u6587\uff1a</p> <p>Are annotations better than XML for configuring Spring?</p> <p>The introduction of annotation-based configuration raised the question of whether this approach is \u201cbetter\u201d than XML. The short answer is \u201cit depends.\u201d The long answer is that each approach has its pros and cons, and, usually, it is up to the developer to decide which strategy suits them better. Due to the way they are defined, annotations provide a lot of context in their declaration, leading to shorter and more concise configuration. However, XML excels at wiring up components without touching their source code or recompiling them. Some developers prefer having the wiring close to the source while others argue that annotated classes are no longer POJOs and, furthermore, that the configuration becomes decentralized and harder to control.</p> <p>No matter the choice, Spring can accommodate both styles and even mix them together. It is worth pointing out that through its JavaConfig option, Spring lets annotations be used in a non-invasive way, without touching the target components source code and that, in terms of tooling, all configuration styles are supported by the Spring Tools for Eclipse.</p> <p>\u81f3\u6b64\uff0c\u5173\u4e8eSpring\u7684IoC\u57fa\u7840\u90e8\u5206\uff0c\u6211\u4eec\u5c31\u5168\u90e8\u4ecb\u7ecd\u5b8c\u4e86\u3002\u5728\u6700\u540e\uff0c\u7559\u7ed9\u5404\u4f4d\u5c0f\u4f19\u4f34\u4e00\u4e2a\u95ee\u9898\uff0c\u73b0\u5728\u6709\u4e24\u4e2a\u7c7b\uff1a</p> <pre><code>@Component\npublic class Student {\n    @Resource\n    private Teacher teacher;\n}\n</code></pre> <pre><code>@Component\npublic class Teacher {\n    @Resource\n    private Student student;\n}\n</code></pre> <p>\u8fd9\u4e24\u4e2a\u7c7b\u4e92\u76f8\u9700\u8981\u6ce8\u5165\u5bf9\u65b9\u7684\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u65f6\u5019Spring\u4f1a\u600e\u4e48\u8fdb\u884c\u5904\u7406\u5462\uff1f\u5982\u679cBean\u53d8\u6210\u539f\u578b\u6a21\u5f0f\uff0cSpring\u53c8\u4f1a\u600e\u4e48\u5904\u7406\u5462\uff1f</p> <p>\u8fd9\u4e2a\u95ee\u9898\u6211\u4eec\u4f1a\u5728\u5b9e\u73b0\u539f\u7406\u63a2\u7a76\u90e8\u5206\u8fdb\u884c\u8be6\u7ec6\u4ecb\u7ecd\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#spring_2","title":"Spring\u9ad8\u7ea7\u7279\u6027\uff08\u9009\u5b66\uff09","text":"<p>\u6ce8\u610f\uff1a\u672c\u90e8\u5206\u4e3a\u9009\u5b66\u5185\u5bb9\uff0c\u5982\u679cSpring\u57fa\u7840\u90e8\u5206\u5b66\u7684\u4e0d\u662f\u5f88\u660e\u767d\uff0c\u4e0d\u5efa\u8bae\u770b\u8fd9\u4e00\u90e8\u5206\uff0c\u5728\u7406\u89e3\u6e05\u695a\u4e4b\u540e\u518d\u6765\u770b\u4e5f\u53ef\u4ee5\uff0c\u4f46\u4e5f\u4e0d\u662f\u8bf4\u4ee5\u540e\u5c31\u4e0d\u7528\u5b66\u4e86\uff0c\u8fd9\u4e9b\u4e1c\u897f\u5728\u67d0\u4e9b\u9879\u76ee\u4e2d\u53ef\u80fd\u4f1a\u7528\u5230\uff0c\u4f60\u8fdf\u65e9\u8fd8\u662f\u8981\u56de\u6765\u8865\u7684\u3002</p> <p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86Spring\u7684\u57fa\u7840\u90e8\u5206\uff0c\u6211\u4eec\u63a5\u7740\u6765\u4ecb\u7ecdSpring\u7684\u4e00\u4e9b\u5176\u4ed6\u9ad8\u7ea7\u7279\u6027\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#bean-aware","title":"Bean Aware","text":"<p>\u5728Spring\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e9b\u4ee5Aware\u7ed3\u5c3e\u7684\u63a5\u53e3\uff0c\u5b9e\u73b0\u4e86Aware\u63a5\u53e3\u7684bean\u5728\u88ab\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u53ef\u4ee5\u83b7\u53d6\u76f8\u5e94\u8d44\u6e90\u3002Aware\u7684\u4e2d\u6587\u610f\u601d\u4e3a\u611f\u77e5\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u4ed6\u5c31\u662f\u4e00\u4e2a\u6807\u8bc6\uff0c\u5b9e\u73b0\u6b64\u63a5\u53e3\u7684\u7c7b\u4f1a\u83b7\u5f97\u67d0\u4e9b\u611f\u77e5\u80fd\u529b\uff0cSpring\u5bb9\u5668\u4f1a\u5728Bean\u88ab\u52a0\u8f7d\u65f6\uff0c\u6839\u636e\u7c7b\u5b9e\u73b0\u7684\u611f\u77e5\u63a5\u53e3\uff0c\u4f1a\u8c03\u7528\u7c7b\u4e2d\u5b9e\u73b0\u7684\u5bf9\u5e94\u611f\u77e5\u65b9\u6cd5\u3002</p> <p>\u6bd4\u5982BeanNameAware\u4e4b\u7c7b\u7684\u4ee5Aware\u7ed3\u5c3e\u7684\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u83b7\u53d6\u7684\u8d44\u6e90\u5c31\u662fBeanName\uff1a</p> <pre><code>@Component\npublic class Student implements BeanNameAware {   //\u6211\u4eec\u53ea\u9700\u8981\u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\u5c31\u53ef\u4ee5\u4e86\n\n    @Override\n    public void setBeanName(String name) {   //Bean\u5728\u52a0\u8f7d\u7684\u65f6\u5019\uff0c\u5bb9\u5668\u5c31\u4f1a\u81ea\u52a8\u8c03\u7528\u6b64\u65b9\u6cd5\uff0c\u5c06Bean\u7684\u540d\u79f0\u7ed9\u5230\u6211\u4eec\n        System.out.println(\"\u6211\u5728\u52a0\u8f7d\u9636\u6bb5\u83b7\u5f97\u4e86Bean\u540d\u5b57\uff1a\"+name);\n    }\n}\n</code></pre> <p>\u53c8\u6bd4\u5982BeanClassLoaderAware\uff0c\u90a3\u4e48\u5b83\u80fd\u591f\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u5728Bean\u52a0\u8f7d\u9636\u6bb5\u5c31\u83b7\u53d6\u5230\u5f53\u524dBean\u7684\u7c7b\u52a0\u8f7d\u5668\uff1a</p> <pre><code>@Component\npublic class Student implements BeanClassLoaderAware {\n\n    @Override\n    public void setBeanClassLoader(ClassLoader classLoader) {\n        System.out.println(classLoader);\n    }\n}\n</code></pre> <p>\u6709\u5173\u5176\u4ed6\u7684Aware\u8fd9\u91cc\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e\u4e86\uff0c\u6211\u4eec\u4f1a\u5728\u540e\u9762\u7684\u5b9e\u73b0\u539f\u7406\u63a2\u7a76\u90e8\u5206\u9010\u6b65\u8ba4\u8bc6\u7684\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_5","title":"\u4efb\u52a1\u8c03\u5ea6","text":"<p>\u4e3a\u4e86\u6267\u884c\u67d0\u4e9b\u4efb\u52a1\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u975e\u5e38\u89c4\u7684\u64cd\u4f5c\uff0c\u6bd4\u5982\u6211\u4eec\u5e0c\u671b\u4f7f\u7528\u591a\u7ebf\u7a0b\u6765\u5904\u7406\u6211\u4eec\u7684\u7ed3\u679c\u6216\u662f\u6267\u884c\u4e00\u4e9b\u5b9a\u65f6\u4efb\u52a1\uff0c\u5230\u8fbe\u6307\u5b9a\u65f6\u95f4\u518d\u53bb\u6267\u884c\u3002\u8fd9\u65f6\u6211\u4eec\u9996\u5148\u60f3\u5230\u7684\u5c31\u662f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\u6765\u5904\u7406\uff0c\u6216\u662f\u4f7f\u7528TimerTask\u6765\u5b8c\u6210\u5b9a\u65f6\u4efb\u52a1\uff0c\u4f46\u662f\u6211\u4eec\u6709\u4e86Spring\u6846\u67b6\u4e4b\u540e\uff0c\u5c31\u4e0d\u7528\u8fd9\u6837\u4e86\uff0c\u56e0\u4e3aSpring\u6846\u67b6\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u66f4\u52a0\u4fbf\u6377\u7684\u65b9\u5f0f\u8fdb\u884c\u4efb\u52a1\u8c03\u5ea6\u3002</p> <p>\u9996\u5148\u6211\u4eec\u6765\u770b\u5f02\u6b65\u4efb\u52a1\u6267\u884c\uff0c\u9700\u8981\u4f7f\u7528Spring\u5f02\u6b65\u4efb\u52a1\u652f\u6301\uff0c\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u7c7b\u4e0a\u6dfb\u52a0<code>@EnableAsync</code>\u6ce8\u89e3\u3002</p> <pre><code>@EnableAsync\n@Configuration\n@ComponentScan(\"com.test.bean\")\npublic class MainConfiguration {\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u53ea\u9700\u8981\u5728\u9700\u8981\u5f02\u6b65\u6267\u884c\u7684\u65b9\u6cd5\u4e0a\uff0c\u6dfb\u52a0<code>@Async</code>\u6ce8\u89e3\u5373\u53ef\u5c06\u6b64\u65b9\u6cd5\u6807\u8bb0\u4e3a\u5f02\u6b65\uff0c\u5f53\u6b64\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\uff0c\u4f1a\u5f02\u6b65\u6267\u884c\uff0c\u4e5f\u5c31\u662f\u65b0\u5f00\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\uff0c\u800c\u4e0d\u662f\u5728\u5f53\u524d\u7ebf\u7a0b\u6267\u884c\u3002\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <pre><code>@Component\npublic class Student {\n    public void syncTest() throws InterruptedException {\n        System.out.println(Thread.currentThread().getName()+\"\u6211\u662f\u540c\u6b65\u6267\u884c\u7684\u65b9\u6cd5\uff0c\u5f00\u59cb...\");\n        Thread.sleep(3000);\n        System.out.println(\"\u6211\u662f\u540c\u6b65\u6267\u884c\u7684\u65b9\u6cd5\uff0c\u7ed3\u675f\uff01\");\n    }\n\n    @Async\n    public void asyncTest() throws InterruptedException {\n        System.out.println(Thread.currentThread().getName()+\"\u6211\u662f\u5f02\u6b65\u6267\u884c\u7684\u65b9\u6cd5\uff0c\u5f00\u59cb...\");\n        Thread.sleep(3000);\n        System.out.println(\"\u6211\u662f\u5f02\u6b65\u6267\u884c\u7684\u65b9\u6cd5\uff0c\u7ed3\u675f\uff01\");\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5728\u4e3b\u65b9\u6cd5\u4e2d\u5206\u522b\u8c03\u7528\u4e00\u4e0b\u8bd5\u8bd5\u770b\uff1a</p> <pre><code>public static void main(String[] args) throws InterruptedException {\n    AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class);\n    Student student = context.getBean(Student.class);\n    student.asyncTest();   //\u5f02\u6b65\u6267\u884c\n    student.syncTest();    //\u540c\u6b65\u6267\u884c\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u7684\u4efb\u52a1\u6267\u884c\u7ed3\u679c\u4e3a\uff1a</p> <p></p> <p>\u5f88\u660e\u663e\uff0c\u5f02\u6b65\u6267\u884c\u7684\u4efb\u52a1\u5e76\u4e0d\u662f\u5728\u5f53\u524d\u7ebf\u7a0b\u542f\u52a8\u7684\uff0c\u800c\u662f\u5728\u5176\u4ed6\u7ebf\u7a0b\u542f\u52a8\u7684\uff0c\u6240\u4ee5\u8bf4\u5e76\u4e0d\u4f1a\u5728\u5f53\u524d\u7ebf\u7a0b\u963b\u585e\uff0c\u53ef\u4ee5\u770b\u5230\u9a6c\u4e0a\u5c31\u5f00\u59cb\u6267\u884c\u4e0b\u4e00\u884c\u4ee3\u7801\uff0c\u8c03\u7528\u540c\u6b65\u6267\u884c\u7684\u4efb\u52a1\u4e86\u3002</p> <p>\u56e0\u6b64\uff0c\u5f53\u6211\u4eec\u8981\u5c06Bean\u7684\u67d0\u4e2a\u65b9\u6cd5\u8bbe\u8ba1\u4e3a\u5f02\u6b65\u6267\u884c\u65f6\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u6dfb\u52a0\u8fd9\u4e2a\u6ce8\u89e3\u3002\u4f46\u662f\u9700\u8981\u6ce8\u610f\uff0c\u6dfb\u52a0\u6b64\u6ce8\u89e3\u8981\u6c42\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u53ea\u80fd\u662fvoid\u6216\u662fFuture\u7c7b\u578b\u624d\u53ef\u4ee5\uff08Future\u7c7b\u578b\u6211\u4eec\u5728JUC\u7bc7\u89c6\u9891\u6559\u7a0b\u4e2d\u6709\u8be6\u7ec6\u4ecb\u7ecd\uff09</p> <p>\u8fd8\u6709\uff0c\u5728\u4f7f\u7528\u65f6\uff0c\u53ef\u80fd\u8fd8\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u4fe1\u606f\uff1a</p> <p></p> <p>\u867d\u7136\u51fa\u73b0\u4e86\u8fd9\u6837\u7684\u4fe1\u606f\uff0c\u4f46\u662f\u6211\u4eec\u7684\u7a0b\u5e8f\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\uff0c\u8fd9\u662f\u56e0\u4e3aSpring\u9ed8\u8ba4\u4f1a\u4ece\u5bb9\u5668\u4e2d\u9009\u62e9\u4e00\u4e2a<code>Executor</code>\u7c7b\u578b\uff08\u8fd9\u540c\u6837\u662f\u5728JUC\u7bc7\u89c6\u9891\u6559\u7a0b\u4e2d\u4ecb\u7ecd\u7684\u7c7b\u578b\uff09\u7684\u5b9e\u4f8b\uff0c\u5e76\u4f7f\u7528\u5b83\u6765\u521b\u5efa\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1\uff0c\u8fd9\u662fSpring\u63a8\u8350\u7684\u65b9\u5f0f\uff0c\u5f53\u7136\uff0c\u5982\u679c\u6ca1\u6709\u627e\u5230\uff0c\u90a3\u4e48\u4f1a\u4f7f\u7528\u81ea\u5e26\u7684 SimpleAsyncTaskExecutor \u5904\u7406\u5f02\u6b65\u65b9\u6cd5\u8c03\u7528\u3002</p> <p>\u80af\u5b9a\u4f1a\u6709\u5c0f\u4f19\u4f34\u7591\u60d1\uff0c\u4ec0\u4e48\u60c5\u51b5\uff1f\uff01\u8fd9\u4e2a\u65b9\u6cd5\u5f88\u660e\u663e\u6211\u4eec\u5e76\u6ca1\u6709\u53bb\u7f16\u5199\u5f02\u6b65\u6267\u884c\u7684\u903b\u8f91\uff0c\u90a3\u4e48\u4e3a\u4ec0\u4e48\u4f1a\u5f02\u6b65\u6267\u884c\u5462\uff1f\u8fd9\u91cc\u5f88\u660e\u663e\u662f\u540c\u6b65\u8c03\u7528\u7684\u65b9\u6cd5\u554a\u3002\u7684\u786e\uff0c\u5982\u679c\u8fd9\u4e2aBean\u53ea\u662f\u4e00\u4e2a\u7b80\u7b80\u5355\u5355\u7684Student\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u786e\u5b9e\u505a\u4e0d\u5230\u3002\u4f46\u662f\u5b83\u771f\u7684\u53ea\u662f\u4e00\u4e2a\u7b80\u7b80\u5355\u5355\u7684Student\u7c7b\u578b\u5bf9\u8c61\u5417\uff1f</p> <pre><code>Student student = context.getBean(Student.class);\nSystem.out.println(student.getClass());   //\u8fd9\u91cc\u6211\u4eec\u901a\u8fc7getClass\u6765\u83b7\u53d6\u4e00\u4e0b\u7c7b\u578b\uff0c\u4f60\u4f1a\u53d1\u73b0\u60ca\u559c\n</code></pre> <p>\u6211\u4eec\u6765\u770b\u770b\u7ed3\u679c\uff1a</p> <p></p> <p>\uff1f\uff1f\uff1f\u8fd9\u662f\u4ec0\u4e48\u4e1c\u897f\uff1f\u8fd9\u5b9e\u9645\u4e0aSpring\u5e2e\u52a9\u6211\u4eec\u52a8\u6001\u751f\u6210\u7684\u4e00\u4e2a\u4ee3\u7406\u7c7b\uff0c\u6211\u4eec\u539f\u672c\u7684\u7c7b\u4ee3\u7801\u5df2\u7ecf\u88ab\u4fee\u6539\u4e86\uff0c\u5f53\u7136\uff0c\u8fd9\u53ea\u662f\u51b0\u5c71\u4e00\u89d2\uff0c\u66f4\u591a\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u8fd8\u4f1a\u518dAOP\u9762\u5411\u5207\u7247\u90e8\u5206\u4e2d\u7ee7\u7eed\u4e3a\u5927\u5bb6\u8fdb\u884c\u4ecb\u7ecd\uff0c\u80fd\u505a\u5230\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u8fd9\u5176\u5b9e\u90fd\u662fAOP\u7684\u529f\u52b3\u3002</p> <p>\u770b\u5b8c\u4e86\u5f02\u6b65\u4efb\u52a1\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\u5b9a\u65f6\u4efb\u52a1\uff0c\u5b9a\u65f6\u4efb\u52a1\u5176\u5b9e\u5c31\u662f\u6307\u5b9a\u5728\u54ea\u4e2a\u65f6\u5019\u518d\u53bb\u6267\u884c\uff0c\u5728JavaSE\u9636\u6bb5\u6211\u4eec\u4f7f\u7528\u8fc7TimerTask\u6765\u6267\u884c\u5b9a\u65f6\u4efb\u52a1\u3002Spring\u4e2d\u7684\u5b9a\u65f6\u4efb\u52a1\u662f\u5168\u5c40\u6027\u8d28\u7684\uff0c\u5f53\u6211\u4eec\u7684Spring\u7a0b\u5e8f\u542f\u52a8\u540e\uff0c\u90a3\u4e48\u5b9a\u65f6\u4efb\u52a1\u4e5f\u5c31\u8ddf\u7740\u542f\u52a8\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u914d\u7f6e\u7c7b\u4e0a\u6dfb\u52a0<code>@EnableScheduling</code>\u6ce8\u89e3\uff1a</p> <pre><code>@EnableScheduling\n@Configuration\n@ComponentScan(\"com.test.bean\")\npublic class MainConfiguration {\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u914d\u7f6e\u7c7b\u91cc\u9762\u7f16\u5199\u5b9a\u65f6\u4efb\u52a1\uff0c\u628a\u6211\u4eec\u8981\u505a\u7684\u4efb\u52a1\u5199\u6210\u65b9\u6cd5\uff0c\u5e76\u6dfb\u52a0<code>@Scheduled</code>\u6ce8\u89e3\uff1a</p> <pre><code>@Scheduled(fixedRate = 2000)   //\u5355\u4f4d\u4f9d\u7136\u662f\u6beb\u79d2\uff0c\u8fd9\u91cc\u662f\u6bcf\u4e24\u79d2\u949f\u6253\u5370\u4e00\u6b21\npublic void task(){\n    System.out.println(\"\u6211\u662f\u5b9a\u65f6\u4efb\u52a1\uff01\"+new Date());\n}\n</code></pre> <p></p> <p>\u6211\u4eec\u6ce8\u610f\u5230<code>@Scheduled</code>\u4e2d\u6709\u5f88\u591a\u53c2\u6570\uff0c\u6211\u4eec\u9700\u8981\u6307\u5b9a'cron', 'fixedDelay(String)', or 'fixedRate(String)'\u7684\u5176\u4e2d\u4e00\u4e2a\uff0c\u5426\u5219\u65e0\u6cd5\u521b\u5efa\u5b9a\u65f6\u4efb\u52a1\uff0c\u4ed6\u4eec\u7684\u533a\u522b\u5982\u4e0b\uff1a</p> <ul> <li>fixedDelay\uff1a\u5728\u4e0a\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1\u6267\u884c\u5b8c\u4e4b\u540e\uff0c\u95f4\u9694\u591a\u4e45\u7ee7\u7eed\u6267\u884c\u3002</li> <li>fixedRate\uff1a\u65e0\u8bba\u4e0a\u4e00\u6b21\u5b9a\u65f6\u4efb\u52a1\u6709\u6ca1\u6709\u6267\u884c\u5b8c\u6210\uff0c\u4e24\u6b21\u4efb\u52a1\u4e4b\u95f4\u7684\u65f6\u95f4\u95f4\u9694\u3002</li> <li>cron\uff1a\u5982\u679c\u5acc\u4e0a\u9762\u4e24\u4e2a\u4e0d\u591f\u7075\u6d3b\uff0c\u4f60\u8fd8\u53ef\u4ee5\u4f7f\u7528cron\u8868\u8fbe\u5f0f\u6765\u6307\u5b9a\u4efb\u52a1\u8ba1\u5212\u3002</li> </ul> <p>\u8fd9\u91cc\u7b80\u5355\u8bb2\u89e3\u4e00\u4e0bcron\u8868\u8fbe\u5f0f\uff1ahttps://blog.csdn.net/sunnyzyq/article/details/98597252</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_6","title":"\u76d1\u542c\u5668","text":"<p>\u76d1\u542c\u5668\u5bf9\u6211\u4eec\u6765\u8bf4\u4e5f\u662f\u4e00\u4e2a\u6bd4\u8f83\u964c\u751f\u7684\u6982\u5ff5\uff0c\u90a3\u4e48\u4f55\u8c13\u76d1\u542c\u5462\uff1f</p> <p>\u76d1\u542c\u5b9e\u9645\u4e0a\u5c31\u662f\u7b49\u5f85\u67d0\u4e2a\u4e8b\u4ef6\u7684\u89e6\u53d1\uff0c\u5f53\u4e8b\u4ef6\u89e6\u53d1\u65f6\uff0c\u5bf9\u5e94\u4e8b\u4ef6\u7684\u76d1\u542c\u5668\u5c31\u4f1a\u88ab\u901a\u77e5\uff0c\u5982\u679c\u4f60\u5b66\u4e60\u8fc7Java Swing\u7bc7\u89c6\u9891\u6559\u7a0b\uff0c\u5e94\u8be5\u4f1a\u6df1\u6709\u4f53\u4f1a\uff0c\u76d1\u542c\u5668\u53ef\u662f\u5f88\u5173\u952e\u7684\uff0c\u53ea\u4e0d\u8fc7\u5728Spring\u4e2d\u7528\u7684\u4e0d\u662f\u5f88\u9891\u7e41\u7f62\u4e86\u3002\u4f46\u662f\u8fd9\u91cc\u8fd8\u662f\u8981\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\uff1a</p> <pre><code>@Component\npublic class TestListener implements ApplicationListener&lt;ContextRefreshedEvent&gt; {\n    @Override\n    public void onApplicationEvent(ContextRefreshedEvent event) {\n        System.out.println(event.getApplicationContext());   //\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u4e8b\u4ef6\u83b7\u53d6\u5230\u4e8b\u4ef6\u76f8\u5173\u7684\u4e1c\u897f\n    }\n}\n</code></pre> <p>\u8981\u7f16\u5199\u76d1\u542c\u5668\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8ba9Bean\u7ee7\u627fApplicationListener\u5c31\u53ef\u4ee5\u4e86\uff0c\u5e76\u4e14\u5c06\u7c7b\u578b\u6307\u5b9a\u4e3a\u5bf9\u5e94\u7684Event\u4e8b\u4ef6\uff0c\u8fd9\u6837\uff0c\u5f53\u53d1\u751f\u67d0\u4e2a\u4e8b\u4ef6\u65f6\u5c31\u4f1a\u901a\u77e5\u6211\u4eec\uff0c\u6bd4\u5982ContextRefreshedEvent\uff0c\u8fd9\u4e2a\u4e8b\u4ef6\u4f1a\u5728Spring\u5bb9\u5668\u521d\u59cb\u5316\u5b8c\u6210\u4f1a\u89e6\u53d1\u4e00\u6b21\uff1a</p> <p></p> <p>\u662f\u4e0d\u662f\u611f\u89c9\u633a\u667a\u80fd\u7684\uff1fSpring\u5185\u90e8\u6709\u5404\u79cd\u5404\u6837\u7684\u4e8b\u4ef6\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u81ea\u5df1\u7f16\u5199\u4e8b\u4ef6\uff0c\u7136\u540e\u5728\u67d0\u4e2a\u65f6\u523b\u53d1\u5e03\u8fd9\u4e2a\u4e8b\u4ef6\u5230\u6240\u6709\u7684\u76d1\u542c\u5668\uff1a</p> <pre><code>public class TestEvent extends ApplicationEvent {   //\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u9700\u8981\u7ee7\u627fApplicationEvent\n    public TestEvent(Object source) {\n        super(source);\n    }\n}\n</code></pre> <pre><code>@Component\npublic class TestListener implements ApplicationListener&lt;TestEvent&gt; {\n    @Override\n    public void onApplicationEvent(TestEvent event) {\n        System.out.println(\"\u53d1\u751f\u4e86\u4e00\u6b21\u81ea\u5b9a\u4e49\u4e8b\u4ef6\uff0c\u6210\u529f\u76d1\u542c\u5230\uff01\");\n    }\n}\n</code></pre> <p>\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u5728\u5b9a\u65f6\u4efb\u52a1\u4e2d\u6bcf\u79d2\u949f\u53d1\u751f\u4e00\u6b21\u8fd9\u4e2a\u4e8b\u4ef6\uff1a</p> <pre><code>@Component\npublic class TaskComponent  implements ApplicationEventPublisherAware {  \n    //\u8981\u53d1\u5e03\u4e8b\u4ef6\uff0c\u9700\u8981\u62ff\u5230ApplicationEventPublisher\uff0c\u8fd9\u91cc\u6211\u4eec\u901a\u8fc7Aware\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u62ff\u5230\n    //\u5b9e\u9645\u4e0a\u6211\u4eec\u7684ApplicationContext\u5c31\u662fApplicationEventPublisher\u7684\u5b9e\u73b0\u7c7b\uff0c\u8fd9\u91cc\u62ff\u5230\u7684\u5c31\u662f\n    //\u6211\u4eec\u521b\u5efa\u7684ApplicationContext\u5bf9\u8c61\n    ApplicationEventPublisher publisher;\n\n    @Scheduled(fixedRate = 1000)   //\u4e00\u79d2\u4e00\u6b21\n    public void task(){\n        //\u76f4\u63a5\u901a\u8fc7ApplicationEventPublisher\u7684publishEvent\u65b9\u6cd5\u53d1\u5e03\u4e8b\u4ef6\n        //\u8fd9\u6837\uff0c\u6240\u6709\u8fd9\u4e2a\u4e8b\u4ef6\u7684\u76d1\u542c\u5668\uff0c\u90fd\u4f1a\u76d1\u542c\u5230\u8fd9\u4e2a\u4e8b\u4ef6\u53d1\u751f\u4e86\n        publisher.publishEvent(new TestEvent(this));\n    }\n\n    @Override\n    public void setApplicationEventPublisher(ApplicationEventPublisher publisher) {\n        this.publisher = publisher;\n    }\n}\n</code></pre> <p>\u6b64\u65f6\uff0c\u53d1\u5e03\u4e8b\u4ef6\u65c1\u8fb9\u51fa\u73b0\u4e86\u56fe\u6807\uff0c\u8bf4\u660e\u5c31\u53ef\u4ee5\u4e86\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u70b9\u51fb\u8fd9\u4e2a\u56fe\u6807\u5feb\u901f\u8df3\u8f6c\u5230\u54ea\u91cc\u76d1\u542c\u4e86\u8fd9\u4e2a\u4e8b\u4ef6\uff0cIDEA\u8fd9\u4e9b\u7ec6\u8282\u505a\u7684\u8fd8\u662f\u633a\u597d\u7684\u3002\u6211\u4eec\u6765\u770b\u770b\u8fd0\u884c\u7ed3\u679c\u5427\uff1a</p> <p></p> <p>\u662f\u4e0d\u662f\u611f\u89c9\u597d\u50cf\u4e5f\u6ca1\u90a3\u4e48\u96be\uff0c\u8fd9\u5957\u673a\u5236\u5176\u5b9e\u8fd8\u633a\u7b80\u5355\u7684\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u53d1\u5e03\u548c\u76d1\u542c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#springel","title":"SpringEL\u8868\u8fbe\u5f0f","text":"<p>SpEL \u662f\u4e00\u79cd\u5f3a\u5927\uff0c\u7b80\u6d01\u7684\u88c5\u914d Bean \u7684\u65b9\u5f0f\uff0c\u5b83\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u671f\u95f4\u6267\u884c\u7684\u8868\u8fbe\u5f0f\u5c06\u503c\u88c5\u914d\u5230\u6211\u4eec\u7684\u5c5e\u6027\u6216\u6784\u9020\u51fd\u6570\u5f53\u4e2d\uff0c\u66f4\u53ef\u4ee5\u8c03\u7528 JDK \u4e2d\u63d0\u4f9b\u7684\u9759\u6001\u5e38\u91cf\uff0c\u83b7\u53d6\u5916\u90e8 Properties \u6587\u4ef6\u4e2d\u7684\u7684\u914d\u7f6e\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_7","title":"\u5916\u90e8\u5c5e\u6027\u6ce8\u5165","text":"<p>\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u5c06\u4e00\u4e9b\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u914d\u7f6e\u8fdb\u884c\u8bfb\u53d6\uff0c\u5e76\u5b8c\u6210\u6ce8\u5165\u3002</p> <p>\u6211\u4eec\u9700\u8981\u521b\u5efa\u4ee5<code>.properties</code>\u7ed3\u5c3e\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u79cd\u914d\u7f6e\u6587\u4ef6\u683c\u5f0f\u5f88\u7b80\u5355\uff0c\u7c7b\u4f3c\u4e8eMap\uff0c\u9700\u8981\u4e00\u4e2aKey\u548c\u4e00\u4e2aValue\uff0c\u4e2d\u95f4\u4f7f\u7528\u7b49\u53f7\u8fdb\u884c\u8fde\u63a5\uff0c\u8fd9\u91cc\u6211\u4eec\u5728resource\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a<code>test.properties</code>\u6587\u4ef6\uff1a</p> <pre><code>test.name=\u53ea\u56e0\n</code></pre> <p>\u8fd9\u6837\uff0cKey\u5c31\u662f<code>test.name</code>\uff0cValue\u5c31\u662f<code>\u53ea\u56e0</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u6ce8\u89e3\u76f4\u63a5\u8bfb\u53d6\u5230\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\u4e2d\u5bf9\u5e94\u7684\u5c5e\u6027\u503c\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u5f15\u5165\u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u914d\u7f6e\u7c7b\u4e0a\u6dfb\u52a0<code>@PropertySource</code>\u6ce8\u89e3\uff1a</p> <pre><code>@Configuration\n@ComponentScan(\"com.test.bean\")\n@PropertySource(\"classpath:test.properties\")   //\u6ce8\u610f\uff0c\u7c7b\u8def\u5f84\u4e0b\u7684\u6587\u4ef6\u540d\u79f0\u9700\u8981\u5728\u524d\u9762\u52a0\u4e0aclasspath:\npublic class MainConfiguration{\n\n}\n</code></pre> <p>\u63a5\u7740\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u5feb\u4e50\u7684\u4f7f\u7528\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 @Value \u6ce8\u89e3\u5c06\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\u6ce8\u5165\u5230\u4efb\u4f55\u6211\u4eec\u60f3\u8981\u7684\u4f4d\u7f6e\uff0c\u5c31\u50cf\u6211\u4eec\u4e4b\u524d\u4f7f\u7528@Resource\u81ea\u52a8\u6ce8\u5165\u4e00\u6837\uff1a</p> <pre><code>@Component\npublic class Student {\n    @Value(\"${test.name}\")   //\u8fd9\u91cc\u9700\u8981\u5728\u5916\u5c42\u5957\u4e0a ${ }\n    private String name;   //String\u4f1a\u88ab\u81ea\u52a8\u8d4b\u503c\u4e3a\u914d\u7f6e\u6587\u4ef6\u4e2d\u5bf9\u5e94\u5c5e\u6027\u7684\u503c\n\n    public void hello(){\n        System.out.println(\"\u6211\u7684\u540d\u5b57\u662f\uff1a\"+name);\n    }\n}\n</code></pre> <p><code>@Value</code>\u4e2d\u7684<code>${...}</code>\u8868\u793a\u5360\u4f4d\u7b26\uff0c\u5b83\u4f1a\u8bfb\u53d6\u5916\u90e8\u914d\u7f6e\u6587\u4ef6\u7684\u5c5e\u6027\u503c\u88c5\u914d\u5230\u5c5e\u6027\u4e2d\uff0c\u5982\u679c\u914d\u7f6e\u6b63\u786e\u6ca1\u95ee\u9898\u7684\u8bdd\uff0c\u8fd9\u91cc\u751a\u81f3\u8fd8\u4f1a\u76f4\u63a5\u663e\u793a\u5bf9\u5e94\u914d\u7f6e\u9879\u7684\u503c\uff1a</p> <p></p> <p>\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\u5427\uff1a</p> <p></p> <p>\u5982\u679c\u9047\u5230\u4e71\u7801\u7684\u60c5\u51b5\uff0c\u8bf7\u5c06\u914d\u7f6e\u6587\u4ef6\u7684\u7f16\u7801\u683c\u5f0f\u5207\u6362\u6210UTF-8\uff08\u53ef\u4ee5\u5728IDEA\u8bbe\u7f6e\u4e2d\u8fdb\u884c\u914d\u7f6e\uff09\u7136\u540e\u5728@PropertySource\u6ce8\u89e3\u4e2d\u6dfb\u52a0\u5c5e\u6027 encoding = \"UTF-8\" \u8fd9\u6837\u5c31\u6b63\u5e38\u4e86\uff0c\u5f53\u7136\uff0c\u5176\u5b9e\u4e00\u822c\u60c5\u51b5\u4e0b\u4e5f\u5f88\u5c11\u4f1a\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u7528\u5230\u4e2d\u6587\u3002</p> <p>\u9664\u4e86\u5728\u5b57\u6bb5\u4e0a\u8fdb\u884c\u6ce8\u5165\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u9700\u8981\u6ce8\u5165\u7684\u65b9\u6cd5\u4e2d\u4f7f\u7528\uff1a</p> <pre><code>@Component\npublic class Student {\n    private final String name;\n\n    //\u6784\u9020\u65b9\u6cd5\u4e2d\u7684\u53c2\u6570\u9664\u4e86\u88ab\u81ea\u52a8\u6ce8\u5165\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u9009\u62e9\u4f7f\u7528@Value\u8fdb\u884c\u6ce8\u5165\n    public Student(@Value(\"${test.name}\") String name){\n        this.name = name;\n    }\n\n    public void hello(){\n        System.out.println(\"\u6211\u7684\u540d\u5b57\u662f\uff1a\"+name);\n    }\n}\n</code></pre> <p>\u5f53\u7136\uff0c\u5982\u679c\u6211\u4eec\u53ea\u662f\u60f3\u7b80\u5355\u7684\u6ce8\u5165\u4e00\u4e2a\u5e38\u91cf\u503c\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u586b\u5165\u56fa\u5b9a\u503c\uff1a</p> <pre><code>private final String name;\npublic Student(@Value(\"10\") String name){   //\u53ea\u4e0d\u8fc7\uff0c\u8fd9\u91cc\u90fd\u662f\u5e38\u91cf\u503c\u4e86\uff0c\u6211\u5e72\u561b\u4e0d\u76f4\u63a5\u5199\u5230\u4ee3\u7801\u91cc\u5462\n    this.name = name;\n}\n</code></pre> <p>\u5f53\u7136\uff0c@Value \u7684\u529f\u80fd\u8fd8\u8fdc\u4e0d\u6b62\u8fd9\u4e9b\uff0c\u914d\u5408SpringEL\u8868\u8fbe\u5f0f\uff0c\u80fd\u591f\u5b9e\u73b0\u66f4\u52a0\u5f3a\u5927\u7684\u529f\u80fd\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#spel","title":"SpEL\u7b80\u5355\u4f7f\u7528","text":"<p>Spring\u5b98\u65b9\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u5957\u975e\u5e38\u9ad8\u7ea7SpEL\u8868\u8fbe\u5f0f\uff0c\u901a\u8fc7\u4f7f\u7528\u8868\u8fbe\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u66f4\u52a0\u7075\u6d3b\u5730\u4f7f\u7528Spring\u6846\u67b6\u3002</p> <p>\u9996\u5148\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u521b\u5efa\u4e00\u4e2aSpEL\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>ExpressionParser parser = new SpelExpressionParser();\nExpression exp = parser.parseExpression(\"'Hello World'\");  //\u4f7f\u7528parseExpression\u65b9\u6cd5\u6765\u521b\u5efa\u4e00\u4e2a\u8868\u8fbe\u5f0f\nSystem.out.println(exp.getValue());   //\u8868\u8fbe\u5f0f\u6700\u7ec8\u7684\u8fd0\u7b97\u7ed3\u679c\u53ef\u4ee5\u901a\u8fc7getValue()\u83b7\u53d6\n</code></pre> <p>\u8fd9\u91cc\u5f97\u5230\u7684\u5c31\u662f\u4e00\u4e2a\u5f88\u7b80\u5355\u7684 Hello World \u5b57\u7b26\u4e32\uff0c\u5b57\u7b26\u4e32\u4f7f\u7528\u5355\u5f15\u53f7\u56ca\u62ec\uff0cSpEL\u662f\u5177\u6709\u8fd0\u7b97\u80fd\u529b\u7684\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u50cf\u5199Java\u4e00\u6837\uff0c\u5bf9\u8fd9\u4e2a\u5b57\u7b26\u4e32\u8fdb\u884c\u5404\u79cd\u64cd\u4f5c\uff0c\u6bd4\u5982\u8c03\u7528\u65b9\u6cd5\u4e4b\u7c7b\u7684\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"'Hello World'.toUpperCase()\");   //\u8c03\u7528String\u7684toUpperCase\u65b9\u6cd5\nSystem.out.println(exp.getValue());\n</code></pre> <p></p> <p>\u4e0d\u4ec5\u80fd\u8c03\u7528\u65b9\u6cd5\u3001\u8fd8\u53ef\u4ee5\u8bbf\u95ee\u5c5e\u6027\u3001\u4f7f\u7528\u6784\u9020\u65b9\u6cd5\u7b49\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u633a\u725b\u7684\uff0c\u5c45\u7136\u8fd8\u80fd\u8fd9\u6837\u73a9\u3002</p> <p>\u5bf9\u4e8eGetter\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u50cf\u8bbf\u95ee\u5c5e\u6027\u4e00\u6837\u53bb\u4f7f\u7528\uff1a</p> <pre><code>//\u6bd4\u5982 String.getBytes() \u65b9\u6cd5\uff0c\u5c31\u662f\u4e00\u4e2aGetter\uff0c\u90a3\u4e48\u53ef\u4ee5\u5199\u6210 bytes\nExpression exp = parser.parseExpression(\"'Hello World'.bytes\");\nSystem.out.println(exp.getValue());\n</code></pre> <p>\u8868\u8fbe\u5f0f\u53ef\u4ee5\u4e0d\u6b62\u4e00\u7ea7\uff0c\u6211\u4eec\u53ef\u4ee5\u591a\u7ea7\u8c03\u7528\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"'Hello World'.bytes.length\");   //\u7ee7\u7eed\u8bbf\u95ee\u6570\u7ec4\u7684length\u5c5e\u6027\nSystem.out.println(exp.getValue());\n</code></pre> <p>\u662f\u4e0d\u662f\u611f\u89c9\u633a\u597d\u73a9\u7684\uff1f\u6211\u4eec\u7ee7\u7eed\u6765\u8bd5\u8bd5\u770b\u6784\u9020\u65b9\u6cd5\uff0c\u5176\u5b9e\u5c31\u662f\u5199Java\u4ee3\u7801\uff0c\u53ea\u662f\u53ef\u4ee5\u5199\u6210\u8fd9\u79cd\u8868\u8fbe\u5f0f\u800c\u5df2\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"new String('hello world').toUpperCase()\");\nSystem.out.println(exp.getValue());\n</code></pre> <p></p> <p>\u5b83\u751a\u81f3\u8fd8\u652f\u6301\u6839\u636e\u7279\u5b9a\u8868\u8fbe\u5f0f\uff0c\u4ece\u7ed9\u5b9a\u5bf9\u8c61\u4e2d\u83b7\u53d6\u5c5e\u6027\u51fa\u6765\uff1a</p> <pre><code>@Component\npublic class Student {\n    private final String name;\n    public Student(@Value(\"${test.name}\") String name){\n        this.name = name;\n    }\n\n    public String getName() {    //\u6bd4\u5982\u4e0b\u9762\u8981\u8bbf\u95eename\u5c5e\u6027\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5c5e\u6027\u5f97\u53ef\u4ee5\u8bbf\u95ee\u624d\u884c\uff0c\u8bbf\u95ee\u6743\u9650\u4e0d\u591f\u662f\u4e0d\u884c\u7684\n        return name;\n    }\n}\n</code></pre> <pre><code>Student student = context.getBean(Student.class);\nExpressionParser parser = new SpelExpressionParser();\nExpression exp = parser.parseExpression(\"name\");\nSystem.out.println(exp.getValue(student));    //\u76f4\u63a5\u8bfb\u53d6\u5bf9\u8c61\u7684name\u5c5e\u6027\n</code></pre> <p>\u62ff\u5230\u5bf9\u8c61\u5c5e\u6027\u4e4b\u540e\uff0c\u751a\u81f3\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u53bb\u5904\u7406\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"name.bytes.length\");   //\u62ff\u5230name\u4e4b\u540e\u7ee7\u7eedgetBytes\u7136\u540elength\n</code></pre> <p>\u9664\u4e86\u83b7\u53d6\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u8c03\u7528\u8868\u8fbe\u5f0f\u7684setValue\u65b9\u6cd5\u6765\u8bbe\u5b9a\u5c5e\u6027\u7684\u503c\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"name\");\nexp.setValue(student, \"\u523b\u5e08\u5085\");   //\u540c\u6837\u7684\uff0c\u8fd9\u4e2a\u5c5e\u6027\u5f97\u6709\u8bbf\u95ee\u6743\u9650\u4e14\u80fdset\u624d\u53ef\u4ee5\uff0c\u5426\u5219\u4f1a\u62a5\u9519\n</code></pre> <p>\u9664\u4e86\u5c5e\u6027\u8c03\u7528\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd0\u7b97\u7b26\u8fdb\u884c\u5404\u79cd\u9ad8\u7ea7\u8fd0\u7b97\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"66 &gt; 77\");   //\u6bd4\u8f83\u8fd0\u7b97\nSystem.out.println(exp.getValue());\n</code></pre> <pre><code>Expression exp = parser.parseExpression(\"99 + 99 * 3\");   //\u7b97\u6570\u8fd0\u7b97\nSystem.out.println(exp.getValue());\n</code></pre> <p>\u5bf9\u4e8e\u90a3\u4e9b\u9700\u8981\u5bfc\u5165\u624d\u80fd\u4f7f\u7528\u7684\u7c7b\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u7684\u8bed\u6cd5\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"T(java.lang.Math).random()\");   //\u7531T()\u56ca\u62ec\uff0c\u5305\u542b\u5b8c\u6574\u5305\u540d+\u7c7b\u540d\n//Expression exp = parser.parseExpression(\"T(System).nanoTime()\");   //\u9ed8\u8ba4\u5bfc\u5165\u7684\u7c7b\u53ef\u4ee5\u4e0d\u52a0\u5305\u540d\nSystem.out.println(exp.getValue());\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_8","title":"\u96c6\u5408\u64cd\u4f5c\u76f8\u5173\u8bed\u6cd5","text":"<p>\u73b0\u5728\u6211\u4eec\u7684\u7c7b\u4e2d\u5b58\u5728\u4e00\u4e9b\u96c6\u5408\u7c7b\uff1a</p> <pre><code>@Component\npublic class Student {\n    public Map&lt;String, String&gt; map = Map.of(\"test\", \"\u4f60\u5e72\u561b\");\n    public List&lt;String&gt; list = List.of(\"AAA\", \"BBB\", \"CCC\");\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528SpEL\u5feb\u901f\u53d6\u51fa\u96c6\u5408\u4e2d\u7684\u5143\u7d20\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"map['test']\");  //\u5bf9\u4e8eMap\u8fd9\u91cc\u6620\u5c04\u578b\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528map[key]\u6765\u53d6\u51favalue\nSystem.out.println(exp.getValue(student));\n</code></pre> <pre><code>Expression exp = parser.parseExpression(\"list[2]\");   //\u5bf9\u4e8eList\u3001\u6570\u7ec4\u8fd9\u7c7b\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528[index]\nSystem.out.println(exp.getValue(student));\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5feb\u901f\u521b\u5efa\u96c6\u5408\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"{5, 2, 1, 4, 6, 7, 0, 3, 9, 8}\"); //\u4f7f\u7528{}\u6765\u5feb\u901f\u521b\u5efaList\u96c6\u5408\nList value = (List) exp.getValue();\nvalue.forEach(System.out::println);\n</code></pre> <pre><code>Expression exp = parser.parseExpression(\"{{1, 2}, {3, 4}}\");   //\u5b83\u662f\u652f\u6301\u5d4c\u5957\u4f7f\u7528\u7684\n</code></pre> <pre><code>//\u521b\u5efaMap\u4e5f\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u8981key:value\u5c31\u53ef\u4ee5\u4e86\uff0c\u600e\u4e48\u6709\u80a1JSON\u5473\nExpression exp = parser.parseExpression(\"{name: '\u5c0f\u660e', info: {address: '\u5317\u4eac\u5e02\u671d\u9633\u533a', tel: 10086}}\");\nSystem.out.println(exp.getValue());\n</code></pre> <p>\u4f60\u4ee5\u4e3a\u5c31\u8fd9\u4e48\u7b80\u5355\u5417\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u76f4\u63a5\u6839\u636e\u6761\u4ef6\u83b7\u53d6\u96c6\u5408\u4e2d\u7684\u5143\u7d20\uff1a</p> <pre><code>@Component\npublic class Student {\n    public List&lt;Clazz&gt; list = List.of(new Clazz(\"\u9ad8\u7b49\u6570\u5b66\", 4));\n\n    public record Clazz(String name, int score){ }\n}\n</code></pre> <pre><code>//\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u4ecelist\u4e2d\u83b7\u53d6\u90a3\u4e9b\u6ee1\u8db3\u6211\u4eec\u6761\u4ef6\u7684\u5143\u7d20\uff0c\u5e76\u7ec4\u6210\u4e00\u4e2a\u65b0\u7684\u96c6\u5408\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528.?\u8fd0\u7b97\u7b26\nExpression exp = parser.parseExpression(\"list.?[name == '\u9ad8\u7b49\u6570\u5b66']\");\nSystem.out.println(exp.getValue(student));\n</code></pre> <pre><code>Expression exp = parser.parseExpression(\"list.?[score &gt; 3]\");   //\u9009\u62e9\u5b66\u5206\u5927\u4e8e3\u5206\u7684\u79d1\u76ee\nSystem.out.println(exp.getValue(student));\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u9488\u5bf9\u67d0\u4e2a\u5c5e\u6027\u521b\u5efa\u5bf9\u5e94\u7684\u6295\u5f71\u96c6\u5408\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"list.![name]\");   //\u4f7f\u7528.!\u521b\u5efa\u6295\u5f71\u96c6\u5408\uff0c\u8fd9\u91cc\u521b\u5efa\u7684\u65f6\u8bfe\u7a0b\u540d\u79f0\u7ec4\u6210\u7684\u65b0\u96c6\u5408\nSystem.out.println(exp.getValue(student));\n</code></pre> <p></p> <p>\u6211\u4eec\u63a5\u7740\u6765\u4ecb\u7ecd\u5b89\u5168\u5bfc\u822a\u8fd0\u7b97\u7b26\uff0c\u5b89\u5168\u5bfc\u822a\u8fd0\u7b97\u7b26\u7528\u4e8e\u907f\u514dNullPointerException\uff0c\u5b83\u6765\u81eaGroovy\u8bed\u8a00\u3002\u901a\u5e38\uff0c\u5f53\u60a8\u6709\u5bf9\u5bf9\u8c61\u7684\u5f15\u7528\u65f6\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u5728\u8bbf\u95ee\u5bf9\u8c61\u7684\u65b9\u6cd5\u6216\u5c5e\u6027\u4e4b\u524d\u9a8c\u8bc1\u5b83\u662f\u5426\u4e3a\u7a7a\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u5b89\u5168\u5bfc\u822a\u8fd0\u7b97\u7b26\u8fd4\u56denull\u800c\u4e0d\u662f\u629b\u51fa\u5f02\u5e38\u3002\u4ee5\u4e0b\u793a\u4f8b\u663e\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u5b89\u5168\u5bfc\u822a\u8fd0\u7b97\u7b26\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"name.toUpperCase()\");   //\u5982\u679cStudent\u5bf9\u8c61\u4e2d\u7684name\u5c5e\u6027\u4e3anull\nSystem.out.println(exp.getValue(student));\n</code></pre> <p></p> <p>\u5f53\u9047\u5230null\u65f6\u5f88\u4e0d\u65b9\u4fbf\uff0c\u6211\u4eec\u8fd8\u5f97\u5199\u5224\u65ad\uff1a</p> <pre><code>if(student.name != null)\n    System.out.println(student.name.toUpperCase());\n</code></pre> <p>Java 8\u4e4b\u540e\u80fd\u8fd9\u6837\u5199\uff1a</p> <pre><code>Optional.ofNullable(student.name).ifPresent(System.out::println);\n</code></pre> <p>\u4f46\u662f\u4f60\u5982\u679c\u5199\u8fc7Kotlin\uff1a <pre><code>println(student.name?.toUpperCase());\n</code></pre></p> <p>\u7c7b\u4f3c\u4e8e\u8fd9\u79cd\u5224\u7a7a\u95ee\u9898\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5b89\u5168\u5bfc\u822a\u8fd0\u7b97\u7b26\uff0cSpEL\u4e5f\u652f\u6301\u8fd9\u79cd\u5199\u6cd5\uff1a</p> <pre><code>Expression exp = parser.parseExpression(\"name?.toUpperCase()\");\nSystem.out.println(exp.getValue(student));\n</code></pre> <p>\u5f53\u9047\u5230\u7a7a\u65f6\uff0c\u53ea\u4f1a\u5f97\u5230\u4e00\u4e2anull\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u629b\u51fa\u4e00\u4e2a\u5f02\u5e38\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u5c06SpEL\u914d\u5408 @Value \u6ce8\u89e3\u6216\u662fxml\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684value\u5c5e\u6027\u4f7f\u7528\uff0c\u6bd4\u5982XML\u4e2d\u53ef\u4ee5\u8fd9\u6837\u5199\uff1a</p> <pre><code>&lt;bean id=\"numberGuess\" class=\"org.spring.samples.NumberGuess\"&gt;\n    &lt;property name=\"randomNumber\" value=\"#{ T(java.lang.Math).random() * 100.0 }\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u6216\u662f\u4f7f\u7528\u6ce8\u89e3\u5f00\u53d1\uff1a</p> <pre><code>public class FieldValueTestBean {\n    @Value(\"#{ systemProperties['user.region'] }\")\n    private String defaultLocale;\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u6709\u65f6\u5019\u5728\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u503c\u65f6\uff0c\u5c31\u80fd\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u5904\u7406\u4e86\u3002</p> <p>\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u8bed\u6cd5\u6559\u7a0b\uff0c\u8bf7\u524d\u5f80\uff1ahttps://docs.spring.io/spring-framework/docs/current/reference/html/core.html#expressions-language-ref</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#aop","title":"AOP\u9762\u5411\u5207\u7247","text":"<p>\u53c8\u662f\u4e00\u4e2a\u542c\u8d77\u6765\u5f88\u9ad8\u5927\u4e0a\u7684\u540d\u8bcd\uff0cAOP\uff08Aspect Oriented Programming\uff09\u601d\u60f3\u5b9e\u9645\u4e0a\u5c31\u662f\uff1a\u5728\u8fd0\u884c\u65f6\uff0c\u52a8\u6001\u5730\u5c06\u4ee3\u7801\u5207\u5165\u5230\u7c7b\u7684\u6307\u5b9a\u65b9\u6cd5\u3001\u6307\u5b9a\u4f4d\u7f6e\u4e0a\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528AOP\u6765\u5e2e\u52a9\u6211\u4eec\u5728\u65b9\u6cd5\u6267\u884c\u524d\u6216\u6267\u884c\u4e4b\u540e\uff0c\u505a\u4e00\u4e9b\u989d\u5916\u7684\u64cd\u4f5c\uff0c\u5b9e\u9645\u4e0a\uff0c\u5b83\u5c31\u662f\u4ee3\u7406\uff01</p> <p>\u901a\u8fc7AOP\u6211\u4eec\u53ef\u4ee5\u5728\u4fdd\u8bc1\u539f\u6709\u4e1a\u52a1\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\uff0c\u6dfb\u52a0\u989d\u5916\u7684\u52a8\u4f5c\uff0c\u6bd4\u5982\u6211\u4eec\u7684\u67d0\u4e9b\u65b9\u6cd5\u6267\u884c\u5b8c\u6210\u4e4b\u540e\uff0c\u9700\u8981\u6253\u5370\u65e5\u5fd7\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528AOP\u6765\u5e2e\u52a9\u6211\u4eec\u5b8c\u6210\uff0c\u5b83\u53ef\u4ee5\u6279\u91cf\u5730\u4e3a\u8fd9\u4e9b\u65b9\u6cd5\u6dfb\u52a0\u52a8\u4f5c\u3002\u53ef\u4ee5\u8bf4\uff0c\u5b83\u76f8\u5f53\u4e8e\u5c06\u6211\u4eec\u539f\u6709\u7684\u65b9\u6cd5\uff0c\u5728\u4e0d\u6539\u53d8\u6e90\u4ee3\u7801\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u4e86\u589e\u5f3a\u5904\u7406\u3002</p> <p></p> <p>\u76f8\u5f53\u4e8e\u6211\u4eec\u7684\u6574\u4e2a\u4e1a\u52a1\u6d41\u7a0b\uff0c\u88ab\u76f4\u63a5\u65a9\u65ad\uff0c\u5e76\u5728\u65ad\u6389\u7684\u4f4d\u7f6e\u6dfb\u52a0\u4e86\u4e00\u4e2a\u989d\u5916\u7684\u64cd\u4f5c\uff0c\u518d\u8fde\u63a5\u8d77\u6765\uff0c\u4e5f\u5c31\u662f\u5728\u4e00\u4e2a\u5207\u70b9\u4f4d\u7f6e\u63d2\u5165\u5185\u5bb9\u3002\u5b83\u7684\u539f\u7406\u5b9e\u9645\u4e0a\u5c31\u662f\u901a\u8fc7\u52a8\u6001\u4ee3\u7406\u673a\u5236\u5b9e\u73b0\u7684\uff0c\u6211\u4eec\u5728JavaWeb\u9636\u6bb5\u5df2\u7ecf\u7ed9\u5927\u5bb6\u8bb2\u89e3\u8fc7\u52a8\u6001\u4ee3\u7406\u4e86\u3002\u4e0d\u8fc7Spring\u5e95\u5c42\u5e76\u4e0d\u662f\u4f7f\u7528\u7684JDK\u63d0\u4f9b\u7684\u52a8\u6001\u4ee3\u7406\uff0c\u800c\u662f\u4f7f\u7528\u7684\u7b2c\u4e09\u65b9\u5e93\u5b9e\u73b0\uff0c\u5b83\u80fd\u591f\u4ee5\u7236\u7c7b\u7684\u5f62\u5f0f\u4ee3\u7406\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u63a5\u53e3\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#aop_1","title":"\u4f7f\u7528\u914d\u7f6e\u5b9e\u73b0AOP","text":"<p>\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6362\u56de\u4e4b\u524d\u7684XML\u914d\u7f6e\u6a21\u5f0f\uff0c\u4e4b\u540e\u4e5f\u4f1a\u7ed9\u5927\u5bb6\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528\u6ce8\u89e3\u5b8c\u6210AOP\u64cd\u4f5c\uff0c\u6ce8\u610f\u8fd9\u91cc\u6211\u4eec\u8fd8\u52a0\u5165\u4e86\u4e00\u4e9b\u65b0\u7684AOP\u76f8\u5173\u7684\u7ea6\u675f\u8fdb\u6765\uff0c\u5efa\u8bae\u76f4\u63a5CV\u4e0b\u9762\u7684\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xmlns:aop=\"http://www.springframework.org/schema/aop\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd\"&gt;\n&lt;/beans&gt;\n</code></pre> <p>Spring\u662f\u652f\u6301AOP\u7f16\u7a0b\u7684\u6846\u67b6\u4e4b\u4e00\uff08\u5b9e\u9645\u4e0a\u5b83\u6574\u5408\u4e86AspectJ\u6846\u67b6\u7684\u4e00\u90e8\u5206\uff09\uff0c\u8981\u4f7f\u7528AOP\u6211\u4eec\u9700\u8981\u5148\u5bfc\u5165\u4e00\u4e2a\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt;\n    &lt;version&gt;6.0.10&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u90a3\u4e48\uff0c\u5982\u4f55\u4f7f\u7528AOP\u5462\uff1f\u9996\u5148\u6211\u4eec\u8981\u660e\u786e\uff0c\u8981\u5b9e\u73b0AOP\u64cd\u4f5c\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u8fd9\u4e9b\u5185\u5bb9\uff1a</p> <ol> <li>\u9700\u8981\u5207\u5165\u7684\u7c7b\uff0c\u7c7b\u7684\u54ea\u4e2a\u65b9\u6cd5\u9700\u8981\u88ab\u5207\u5165</li> <li>\u5207\u5165\u4e4b\u540e\u9700\u8981\u6267\u884c\u4ec0\u4e48\u52a8\u4f5c</li> <li>\u662f\u5728\u65b9\u6cd5\u6267\u884c\u524d\u5207\u5165\u8fd8\u662f\u5728\u65b9\u6cd5\u6267\u884c\u540e\u5207\u5165</li> <li>\u5982\u4f55\u544a\u8bc9Spring\u9700\u8981\u8fdb\u884c\u5207\u5165</li> </ol> <p>\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u5bf9\u8fd9\u4e2a\u5b66\u751f\u5bf9\u8c61\u7684<code>study</code>\u65b9\u6cd5\u8fdb\u884c\u589e\u5f3a\uff0c\u5728\u4e0d\u4fee\u6539\u6e90\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u589e\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u64cd\u4f5c\uff1a</p> <pre><code>public class Student {\n    public void study(){\n        System.out.println(\"\u5ba4\u53cb\u8fd8\u5728\u6253\u6e38\u620f\uff0c\u6211\u72e0\u72e0\u7684\u5b66Java\uff0c\u592a\u723d\u4e86\"); \n        //\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u5728\u8fd9\u4e2a\u65b9\u6cd5\u6267\u884c\u5b8c\u4e4b\u540e\uff0c\u6253\u5370\u4e00\u4e9b\u5176\u4ed6\u7684\u5185\u5bb9\uff0c\u5728\u4e0d\u4fee\u6539\u539f\u6709\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u8be5\u600e\u4e48\u505a\u5462\uff1f\n    }\n}\n</code></pre> <pre><code>&lt;bean class=\"org.example.entity.Student\"/&gt;\n</code></pre> <p>\u90a3\u4e48\u6211\u4eec\u6309\u7167\u4e0a\u9762\u7684\u6d41\u7a0b\uff0c\u4f9d\u6b21\u6765\u770b\uff0c\u9996\u5148\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f\uff0c\u627e\u5230\u9700\u8981\u5207\u5165\u7684\u7c7b\uff0c\u5f88\u660e\u663e\uff0c\u5c31\u662f\u8fd9\u4e2aStudent\u7c7b\uff0c\u6211\u4eec\u8981\u5207\u5165\u7684\u662f\u8fd9\u4e2a<code>study</code>\u65b9\u6cd5\u3002</p> <p>\u7b2c\u4e8c\u6b65\uff0c\u6211\u4eec\u5207\u5165\u4e4b\u540e\u8981\u505a\u4ec0\u4e48\u5462\uff1f\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7c7b\uff0c\u5e76\u5c06\u8981\u6267\u884c\u7684\u64cd\u4f5c\u5199\u6210\u4e00\u4e2a\u65b9\u6cd5\uff1a</p> <pre><code>public class StudentAOP {\n    //\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u662f\u6211\u4eec\u6253\u7b97\u5bf9\u5176\u8fdb\u884c\u7684\u589e\u5f3a\u64cd\u4f5c\n    public void afterStudy() {\n        System.out.println(\"\u4e3a\u4ec0\u4e48\u6bd5\u4e1a\u4e86\u4ed6\u4eec\u90fd\u7ee7\u627f\u5bb6\u4ea7\uff0c\u6211\u8fd8\u5012\u7ed9\u4ed6\u4eec\u6253\u5de5\uff0c\u6211\u52aa\u529b\u7684\u610f\u4e49\u5728\u54ea\u91cc...\");\n    }\n}\n</code></pre> <p>\u6ce8\u610f\u8fd9\u4e2a\u7c7b\u4e5f\u5f97\u6ce8\u518c\u4e3aBean\u624d\u53ef\u4ee5\uff1a</p> <pre><code>&lt;bean id=\"studentAOP\" class=\"org.example.entity.StudentAOP\"/&gt;\n</code></pre> <p>\u7b2c\u4e09\u6b65\uff0c\u6211\u4eec\u8981\u660e\u786e\u8fd9\u662f\u5728\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\u5207\u5165\u8fd8\u662f\u6267\u884c\u4e4b\u540e\u5207\u5165\uff0c\u5f88\u660e\u663e\uff0c\u6309\u7167\u4e0a\u9762\u7684\u8981\u6c42\uff0c\u6211\u4eec\u9700\u8981\u6267\u884c\u4e4b\u540e\u8fdb\u884c\u5207\u5165\u3002</p> <p>\u7b2c\u56db\u6b65\uff0c\u6700\u5173\u952e\u7684\u6765\u4e86\uff0c\u6211\u4eec\u600e\u4e48\u624d\u80fd\u544a\u8bc9Spring\u6211\u4eec\u8981\u8fdb\u884c\u5207\u5165\u64cd\u4f5c\u5462\uff1f\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884cAOP\u914d\u7f6e\uff1a</p> <pre><code>&lt;aop:config&gt;\n\n&lt;/aop:config&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u5207\u70b9\uff0c\u9996\u5148\u586b\u5199ID\uff0c\u8fd9\u4e2a\u968f\u4fbf\u8d77\u90fd\u53ef\u4ee5\uff1a</p> <pre><code>&lt;aop:pointcut id=\"test\" expression=\"\"/&gt;\n</code></pre> <p>\u7136\u540e\u5c31\u662f\u901a\u8fc7\u540e\u9762\u7684<code>expression</code>\u8868\u8fbe\u5f0f\u6765\u9009\u62e9\u5230\u6211\u4eec\u9700\u8981\u5207\u5165\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u652f\u6301\u5f88\u591a\u79cd\u65b9\u5f0f\u8fdb\u884c\u9009\u62e9\uff0cSpring AOP\u652f\u6301\u4ee5\u4e0bAspectJ\u5207\u70b9\u6307\u793a\u5668\uff08PCD\uff09\u7528\u4e8e\u8868\u8fbe\u5f0f\uff1a</p> <ul> <li><code>execution</code>\uff1a\u7528\u4e8e\u5339\u914d\u65b9\u6cd5\u6267\u884c\u8fde\u63a5\u70b9\u3002\u8fd9\u662f\u4f7f\u7528Spring AOP\u65f6\u4f7f\u7528\u7684\u4e3b\u8981\u70b9\u5207\u5272\u6307\u793a\u5668\u3002</li> <li><code>within</code>\uff1a\u9650\u5236\u5339\u914d\u5230\u67d0\u4e9b\u7c7b\u578b\u7684\u8fde\u63a5\u70b9\uff08\u4f7f\u7528Spring AOP\u65f6\u5728\u5339\u914d\u7c7b\u578b\u4e2d\u58f0\u660e\u7684\u65b9\u6cd5\u7684\u6267\u884c\uff09\u3002</li> <li><code>this</code>\uff1a\u9650\u5236\u4e0e\u8fde\u63a5\u70b9\u5339\u914d\uff08\u4f7f\u7528Spring AOP\u65f6\u65b9\u6cd5\u7684\u6267\u884c\uff09\uff0c\u5176\u4e2dbean\u5f15\u7528\uff08Spring AOP\u4ee3\u7406\uff09\u662f\u7ed9\u5b9a\u7c7b\u578b\u7684\u5b9e\u4f8b\u3002</li> <li><code>target</code>\uff1a\u9650\u5236\u5339\u914d\u8fde\u63a5\u70b9\uff08\u4f7f\u7528Spring AOP\u65f6\u65b9\u6cd5\u7684\u6267\u884c\uff09\uff0c\u5176\u4e2d\u76ee\u6807\u5bf9\u8c61\uff08\u6b63\u5728\u4ee3\u7406\u7684\u5e94\u7528\u7a0b\u5e8f\u5bf9\u8c61\uff09\u662f\u7ed9\u5b9a\u7c7b\u578b\u7684\u5b9e\u4f8b\u3002</li> <li><code>args</code>\uff1a\u9650\u5236\u4e0e\u8fde\u63a5\u70b9\u5339\u914d\uff08\u4f7f\u7528Spring AOP\u65f6\u65b9\u6cd5\u7684\u6267\u884c\uff09\uff0c\u5176\u4e2d\u53c2\u6570\u662f\u7ed9\u5b9a\u7c7b\u578b\u7684\u5b9e\u4f8b\u3002</li> <li><code>@target</code>\uff1a\u9650\u5236\u5339\u914d\u8fde\u63a5\u70b9\uff08\u4f7f\u7528Spring AOP\u65f6\u65b9\u6cd5\u7684\u6267\u884c\uff09\uff0c\u5176\u4e2d\u6267\u884c\u5bf9\u8c61\u7684\u7c7b\u5177\u6709\u7ed9\u5b9a\u7c7b\u578b\u7684\u6ce8\u91ca\u3002</li> <li><code>@args</code>\uff1a\u9650\u5236\u5339\u914d\u5230\u8fde\u63a5\u70b9\uff08\u4f7f\u7528Spring AOP\u65f6\u65b9\u6cd5\u7684\u6267\u884c\uff09\uff0c\u5176\u4e2d\u4f20\u9012\u7684\u5b9e\u9645\u53c2\u6570\u7684\u8fd0\u884c\u65f6\u7c7b\u578b\u5177\u6709\u7ed9\u5b9a\u7c7b\u578b\u7684\u6ce8\u91ca\u3002</li> <li><code>@within</code>\uff1a\u9650\u5236\u4e0e\u5177\u6709\u7ed9\u5b9a\u6ce8\u91ca\u7684\u7c7b\u578b\u4e2d\u7684\u8fde\u63a5\u70b9\u5339\u914d\uff08\u4f7f\u7528Spring AOP\u65f6\u5728\u5e26\u6709\u7ed9\u5b9a\u6ce8\u91ca\u7684\u7c7b\u578b\u4e2d\u58f0\u660e\u7684\u65b9\u6cd5\u7684\u6267\u884c\uff09\u3002</li> <li><code>@annotation</code>\uff1a\u4e0e\u8fde\u63a5\u70b9\u4e3b\u4f53\uff08\u5728Spring AOP\u4e2d\u8fd0\u884c\u7684\u65b9\u6cd5\uff09\u5177\u6709\u7ed9\u5b9a\u6ce8\u91ca\u7684\u8fde\u63a5\u70b9\u5339\u914d\u7684\u9650\u5236\u3002</li> </ul> <p>\u66f4\u591a\u8be6\u7ec6\u5185\u5bb9\u8bf7\u67e5\u9605\uff1ahttps://docs.spring.io/spring-framework/docs/current/reference/html/core.html#aop-pointcuts-designators</p> <p>\u5176\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u5b66\u4e60\u7684<code>execution</code>\u586b\u5199\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>\u4fee\u9970\u7b26 \u5305\u540d.\u7c7b\u540d.\u65b9\u6cd5\u540d\u79f0(\u65b9\u6cd5\u53c2\u6570)\n</code></pre> <ul> <li>\u4fee\u9970\u7b26\uff1apublic\u3001protected\u3001private\u3001\u5305\u62ec\u8fd4\u56de\u503c\u7c7b\u578b\u3001static\u7b49\u7b49\uff08\u4f7f\u7528* \u4ee3\u8868\u4efb\u610f\u4fee\u9970\u7b26\uff09</li> <li>\u5305\u540d\uff1a\u5982com.test\uff08 \u4ee3\u8868\u5168\u90e8\uff0c\u6bd4\u5982com. \u4ee3\u8868com\u5305\u4e0b\u7684\u5168\u90e8\u5305\uff09</li> <li>\u7c7b\u540d\uff1a\u4f7f\u7528* \u4e5f\u53ef\u4ee5\u4ee3\u8868\u5305\u4e0b\u7684\u6240\u6709\u7c7b</li> <li>\u65b9\u6cd5\u540d\u79f0\uff1a\u53ef\u4ee5\u4f7f\u7528* \u4ee3\u8868\u5168\u90e8\u65b9\u6cd5</li> <li>\u65b9\u6cd5\u53c2\u6570\uff1a\u586b\u5199\u5bf9\u5e94\u7684\u53c2\u6570\u5373\u53ef\uff0c\u6bd4\u5982(String, String)\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528* \u6765\u4ee3\u8868\u4efb\u610f\u4e00\u4e2a\u53c2\u6570\uff0c\u4f7f\u7528..\u4ee3\u8868\u6240\u6709\u53c2\u6570\u3002</li> </ul> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5c5e\u6027\u6765\u8fdb\u884c\u5339\u914d\uff0c\u6bd4\u5982<code>@annotation</code>\u53ef\u4ee5\u7528\u4e8e\u8868\u793a\u6807\u8bb0\u4e86\u54ea\u4e9b\u6ce8\u89e3\u7684\u65b9\u6cd5\u88ab\u5207\u5165\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u53ea\u662f\u7b80\u5355\u7684\u6267\u884c\uff0c\u6240\u4ee5\u8bf4\u53ea\u9700\u8981\u8fd9\u6837\u5199\u5c31\u53ef\u4ee5\u4e86\uff1a</p> <pre><code>&lt;aop:pointcut id=\"test\" expression=\"execution(* org.example.entity.Student.study())\"/&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u6307\u660e\u4e86\u9700\u8981\u5207\u5165\u7684\u65b9\u6cd5\uff0c\u7136\u540e\u5c31\u662f\u5c06\u6211\u4eec\u7684\u589e\u5f3a\u65b9\u6cd5\uff0c\u6211\u4eec\u5728\u91cc\u9762\u7ee7\u7eed\u6dfb\u52a0<code>aop:aspect</code>\u6807\u7b7e\uff0c\u5e76\u4f7f\u7528<code>ref</code>\u5c5e\u6027\u5c06\u5176\u6307\u5411\u6211\u4eec\u521a\u521a\u6ce8\u518c\u7684AOP\u7c7bBean\uff1a</p> <pre><code>&lt;aop:config&gt;\n    &lt;aop:pointcut id=\"test\" expression=\"execution(* org.example.entity.Student.study())\"/&gt;\n    &lt;aop:aspect ref=\"studentAOP\"&gt;\n\n    &lt;/aop:aspect&gt;\n&lt;/aop:config&gt;\n</code></pre> <p>\u63a5\u7740\u5c31\u662f\u6dfb\u52a0\u540e\u7eed\u52a8\u4f5c\u4e86\uff0c\u5f53\u7136\uff0c\u5b98\u65b9\u652f\u6301\u7684\u6709\u591a\u79cd\u591a\u6837\u7684\uff0c\u6bd4\u5982\u6267\u884c\u524d\u3001\u6267\u884c\u540e\u3001\u629b\u51fa\u5f02\u5e38\u540e\u3001\u65b9\u6cd5\u8fd4\u56de\u540e\u7b49\u7b49\uff1a</p> <p></p> <p>\u5176\u4e2daround\u65b9\u6cd5\u4e3a\u73af\u7ed5\u65b9\u6cd5\uff0c\u81ea\u5b9a\u4e49\u5ea6\u4f1a\u66f4\u9ad8\uff0c\u6211\u4eec\u4f1a\u5728\u7a0d\u540e\u4ecb\u7ecd\u3002\u8fd9\u91cc\u6211\u4eec\u6309\u7167\u4e0a\u9762\u7684\u8981\u6c42\uff0c\u76f4\u63a5\u6dfb\u52a0\u540e\u7eed\u52a8\u4f5c\uff0c\u6ce8\u610f\u9700\u8981\u6307\u660e\u751f\u6548\u7684\u5207\u70b9\uff1a</p> <pre><code>&lt;aop:aspect ref=\"studentAOP\"&gt;\n    &lt;!--     method\u5c31\u662f\u6211\u4eec\u7684\u589e\u5f3a\u65b9\u6cd5\uff0cpointcut-ref\u6307\u5411\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684\u5207\u70b9     --&gt;\n    &lt;aop:after method=\"afterStudy\" pointcut-ref=\"test\"/&gt;\n&lt;/aop:aspect&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u6210\u529f\u914d\u7f6e\u597d\u4e86\uff0c\u914d\u7f6e\u6b63\u786e\u4f1a\u5728\u65c1\u8fb9\u51fa\u73b0\u56fe\u6807\uff1a</p> <p></p> <p>\u6211\u4eec\u6765\u8bd5\u8bd5\u770b\u5427\uff1a</p> <pre><code>public static void main(String[] args) {\n    ApplicationContext context = new ClassPathXmlApplicationContext(\"application.xml\");\n    Student bean = context.getBean(Student.class);\n    bean.study();\n}\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5728\u6211\u4eec\u539f\u672c\u7684\u65b9\u6cd5\u6267\u884c\u5b8c\u6210\u4e4b\u540e\uff0c\u5b83\u8fd8\u7ee7\u7eed\u6267\u884c\u4e86\u6211\u4eec\u7684\u589e\u5f3a\u65b9\u6cd5\uff0c\u8fd9\u5b9e\u9645\u4e0a\u5c31\u662f\u52a8\u6001\u4ee3\u7406\u505a\u5230\u7684\uff0c\u5b9e\u73b0\u5728\u4e0d\u4fee\u6539\u539f\u6709\u4ee3\u7801\u7684\u57fa\u7840\u4e0a\uff0c\u5bf9\u65b9\u6cd5\u7684\u8c03\u7528\u8fdb\u884c\u5404\u79cd\u589e\u5f3a\uff0c\u5728\u4e4b\u540e\u7684SpringMVC\u5b66\u4e60\u4e2d\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u4f7f\u7528\u5b83\u6765\u5feb\u901f\u914d\u7f6e\u8bbf\u95ee\u65e5\u5fd7\u6253\u5370\u3002</p> <p>\u524d\u9762\u6211\u4eec\u8bf4\u4e86\uff0cAOP\u662f\u57fa\u4e8e\u52a8\u6001\u4ee3\u7406\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u8bf4\u6211\u4eec\u5982\u679c\u76f4\u63a5\u83b7\u53d6Bean\u7684\u7c7b\u578b\uff0c\u4f1a\u53d1\u73b0\u4e0d\u662f\u539f\u672c\u7684\u7c7b\u578b\u4e86\uff1a</p> <pre><code>Student bean = context.getBean(Student.class);\nSystem.out.println(bean.getClass());\n</code></pre> <p></p> <p>\u8fd9\u91cc\u5176\u5b9e\u662fSpring\u901a\u8fc7CGLib\u4e3a\u6211\u4eec\u751f\u6210\u7684\u52a8\u6001\u4ee3\u7406\u7c7b\uff0c\u4e5f\u5c31\u4e0d\u96be\u7406\u89e3\u4e3a\u4ec0\u4e48\u8c03\u7528\u65b9\u6cd5\u4f1a\u76f4\u63a5\u5f97\u5230\u589e\u5f3a\u4e4b\u540e\u7684\u7ed3\u679c\u4e86\u3002\u5305\u62ec\u6211\u4eec\u524d\u9762\u8bb2\u89e3Spring\u7684\u5f02\u6b65\u4efb\u52a1\u8c03\u5ea6\u65f6\uff0c\u4e3a\u4ec0\u4e48\u80fd\u591f\u76f4\u63a5\u5b9e\u73b0\u5f02\u6b65\uff0c\u5176\u5b9e\u5c31\u662f\u5229\u7528\u4e86AOP\u673a\u5236\u5b9e\u73b0\u7684\u65b9\u6cd5\u589e\u5f3a\u3002</p> <p>\u867d\u7136\u8fd9\u4e9b\u529f\u80fd\u5df2\u7ecf\u975e\u5e38\u5f3a\u5927\u4e86\uff0c\u4f46\u662f\u4ec5\u4ec5\u53ea\u80fd\u7b80\u5355\u7684\u5207\u5165\u8fd8\u662f\u4e0d\u80fd\u6ee1\u8db3\u4e00\u4e9b\u9700\u6c42\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u9700\u6c42\u65b9\u6cd5\u6267\u884c\u7684\u4e00\u4e9b\u53c2\u6570\uff0c\u6bd4\u5982\u65b9\u6cd5\u6267\u884c\u4e4b\u540e\u8fd4\u56de\u4e86\u4ec0\u4e48\uff0c\u6216\u662f\u65b9\u6cd5\u5f00\u59cb\u4e4b\u524d\u4f20\u5165\u4e86\u4ec0\u4e48\u53c2\u6570\u7b49\u7b49\uff0c\u73b0\u5728\u6211\u4eec\u4fee\u6539\u4e00\u4e0bStudent\u4e2d<code>study</code>\u65b9\u6cd5\u7684\u53c2\u6570\uff1a</p> <pre><code>public class Student {\n    public void study(String str){  //\u73b0\u5728\u65b9\u6cd5\u6709\u4e00\u4e2aString\u7c7b\u578b\u7684\u53c2\u6570\n        System.out.println(\"\u90fd\u522b\u5b66Java\u4e86\uff0c\u6839\u672c\u627e\u4e0d\u5230\u5de5\u4f5c\uff0c\u5feb\u53bb\u5377\"+str);\n    }\n}\n</code></pre> <p>\u6211\u4eec\u5e0c\u671b\u5728\u589e\u5f3a\u7684\u65b9\u6cd5\u4e2d\u4e5f\u80fd\u62ff\u5230\u8fd9\u4e2a\u53c2\u6570\uff0c\u7136\u540e\u8fdb\u884c\u5904\u7406\uff1a</p> <pre><code>public class StudentAOP {\n    public void afterStudy() {\n        //\u8fd9\u4e2astr\u53c2\u6570\u6211\u4eec\u8be5\u4ece\u54ea\u91cc\u62ff\u5462\uff1f\n        System.out.println(\"\u5b66\u4ec0\u4e48\"+str+\"\uff0cRust\u5929\u4e0b\u7b2c\u4e00\uff01\");\n    }\n}\n</code></pre> <p>\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a\u6211\u4eec\u5207\u5165\u7684\u65b9\u6cd5\u6dfb\u52a0\u4e00\u4e2aJoinPoint\u53c2\u6570\uff0c\u901a\u8fc7\u6b64\u53c2\u6570\u5c31\u53ef\u4ee5\u5feb\u901f\u83b7\u53d6\u5207\u70b9\u4f4d\u7f6e\u7684\u4e00\u4e9b\u4fe1\u606f\uff1a</p> <pre><code>public void afterStudy(JoinPoint point) {   //JoinPoint\u5b9e\u4f8b\u4f1a\u88ab\u81ea\u52a8\u4f20\u5165\n    //\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u901a\u8fc7getArgs()\u8fd4\u56de\u7684\u53c2\u6570\u6570\u7ec4\u83b7\u53d6\u7b2c1\u4e2a\u53c2\u6570\n    System.out.println(\"\u5b66\u4ec0\u4e48\"+point.getArgs()[0]+\"\uff0cRust\u5929\u4e0b\u7b2c\u4e00\uff01\");\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u4fee\u6539\u4e00\u4e0b\u521a\u521a\u7684AOP\u914d\u7f6e\uff08\u56e0\u4e3a\u65b9\u6cd5\u53c2\u6570\u6709\u53d8\u52a8\uff09\u770b\u770b\u7ed3\u679c\u5427\uff1a</p> <pre><code>&lt;aop:pointcut id=\"test\" expression=\"execution(* org.example.entity.Student.study(String))\"/&gt;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <pre><code>public static void main(String[] args) {\n    ApplicationContext context = new ClassPathXmlApplicationContext(\"application.xml\");\n    Student bean = context.getBean(Student.class);\n    bean.study(\"PHP\");\n}\n</code></pre> <p></p> <p>\u662f\u4e0d\u662f\u611f\u89c9\u5927\u90e8\u5206\u529f\u80fd\u90fd\u53ef\u4ee5\u901a\u8fc7AOP\u6765\u5b8c\u6210\u4e86\uff1f</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u81ea\u5b9a\u4e49\u5ea6\u66f4\u9ad8\u7684\u73af\u7ed5\u65b9\u6cd5\uff0c\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u5728\u65b9\u6cd5\u6267\u884c\u524d\u548c\u6267\u884c\u540e\u90fd\u52a0\u5165\u5404\u79cd\u5404\u6837\u7684\u52a8\u4f5c\uff0c\u5982\u679c\u8fd8\u662f\u4e00\u4e2a\u4e00\u4e2a\u5207\u70b9\u5199\uff0c\u6709\u70b9\u592a\u6162\u4e86\uff0c\u80fd\u4e0d\u80fd\u76f4\u63a5\u5199\u4e00\u8d77\u5462\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u73af\u7ed5\u65b9\u6cd5\u3002</p> <p>\u73af\u7ed5\u65b9\u6cd5\u76f8\u5f53\u4e8e\u5b8c\u5168\u4ee3\u7406\u4e86\u6b64\u65b9\u6cd5\uff0c\u5b83\u5b8c\u5168\u5c06\u6b64\u65b9\u6cd5\u5305\u542b\u5728\u4e2d\u95f4\uff0c\u9700\u8981\u6211\u4eec\u624b\u52a8\u8c03\u7528\u624d\u53ef\u4ee5\u6267\u884c\u6b64\u65b9\u6cd5\uff0c\u5e76\u4e14\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u83b7\u53d6\u66f4\u591a\u7684\u53c2\u6570\uff1a</p> <pre><code>public Object around(ProceedingJoinPoint joinPoint) throws Throwable {\n    System.out.println(\"\u65b9\u6cd5\u5f00\u59cb\u4e4b\u524d\");\n    Object value = joinPoint.proceed();   //\u8c03\u7528process\u65b9\u6cd5\u6765\u6267\u884c\u88ab\u4ee3\u7406\u7684\u539f\u65b9\u6cd5\uff0c\u5982\u679c\u6709\u8fd4\u56de\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528value\u63a5\u6536\n    System.out.println(\"\u65b9\u6cd5\u6267\u884c\u5b8c\u6210\uff0c\u7ed3\u679c\u4e3a\uff1a\"+value);\n    return value;\n}\n</code></pre> <p>\u6ce8\u610f\uff0c\u5982\u679c\u4ee3\u7406\u65b9\u6cd5\u5b58\u5728\u8fd4\u56de\u503c\uff0c\u90a3\u4e48\u73af\u7ed5\u65b9\u6cd5\u4e5f\u9700\u8981\u6709\u4e00\u4e2a\u8fd4\u56de\u503c\uff0c\u901a\u8fc7<code>proceed</code>\u65b9\u6cd5\u6765\u6267\u884c\u4ee3\u7406\u7684\u65b9\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u4fee\u6539\u53c2\u6570\u4e4b\u540e\u8c03\u7528<code>proceed(Object[])</code>\uff0c\u4f7f\u7528\u6211\u4eec\u7ed9\u5b9a\u7684\u53c2\u6570\u518d\u53bb\u6267\u884c\uff1a</p> <pre><code>public Object around(ProceedingJoinPoint joinPoint) throws Throwable {\n    System.out.println(\"\u65b9\u6cd5\u5f00\u59cb\u4e4b\u524d\");\n    String arg = joinPoint.getArgs()[0] + \"\u4f1e\u5175\u4e00\u53f7\";\n    Object value = joinPoint.proceed(new Object[]{arg});\n    System.out.println(\"\u65b9\u6cd5\u6267\u884c\u5b8c\u6210\uff0c\u7ed3\u679c\u4e3a\uff1a\"+value);\n    return value;\n}\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u8fd8\u662f\u4ee5<code>study</code>\u65b9\u6cd5\u4e3a\u4f8b\uff0c\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u5728\u8c03\u7528\u524d\u4fee\u6539\u8fd9\u4e2a\u65b9\u6cd5\u4f20\u5165\u7684\u53c2\u6570\u503c\uff0c\u6539\u6210\u6211\u4eec\u81ea\u5df1\u7684\uff0c\u7136\u540e\u5728\u8c03\u7528\u4e4b\u540e\u5bf9\u8fd4\u56de\u503c\u7ed3\u679c\u4e5f\u8fdb\u884c\u5904\u7406\uff1a</p> <pre><code>public String study(String str){\n    if(str.equals(\"Java\"))\n        System.out.println(\"\u6211\u7684\u68a6\u60f3\u662f\u5b66Java\");\n    else {\n        System.out.println(\"\u6211\u5c31\u8981\u5b66Java\uff0c\u4e0d\u8981\u4fee\u6539\u6211\u7684\u68a6\u60f3\uff01\");\n        str = \"Java\";\n    }\n    return str;\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u7f16\u5199\u4e00\u4e2a\u73af\u7ed5\u65b9\u6cd5\uff0c\u5bf9\u5176\u8fdb\u884c\u5168\u65b9\u9762\u5904\u7406\uff1a</p> <pre><code>public Object around(ProceedingJoinPoint joinPoint) throws Throwable {\n    System.out.println(\"\u6211\u662f\u5979\u7684\u5bb6\u957f\uff0c\u4ed6\u4e0d\u80fd\u5b66Java\uff0c\u5fc5\u987b\u5b66Rust\uff0c\u8fd9\u662f\u4e3a\u4ed6\u597d\");\n    Object value = joinPoint.proceed(new Object[]{\"Rust\"});\n    if(value.equals(\"Java\")) {\n        System.out.println(\"\u542c\u8bdd\uff0c\u5b66Rust\u4ee5\u540e\u8fdb\u5927\u5382\uff01\");\n        value = \"Rust\";\n    }\n    return value;\n}\n</code></pre> <p>\u540c\u6837\u7684\uff0c\u56e0\u4e3a\u65b9\u6cd5\u53d8\u52a8\u4e86\uff0c\u73b0\u5728\u6211\u4eec\u53bb\u4fee\u6539\u4e00\u4e0b\u6211\u4eec\u7684AOP\u914d\u7f6e\uff1a</p> <pre><code>&lt;aop:pointcut id=\"test\" expression=\"execution(* org.example.entity.Student.study(String))\"/&gt;\n&lt;aop:aspect ref=\"studentAOP\"&gt;\n    &lt;aop:around method=\"around\" pointcut-ref=\"test\"/&gt;\n&lt;/aop:aspect&gt;\n</code></pre> <p></p> <p>\u7ec6\u5fc3\u7684\u5c0f\u4f19\u4f34\u53ef\u80fd\u4f1a\u53d1\u73b0\uff0c\u73af\u7ed5\u65b9\u6cd5\u7684\u56fe\u6807\u662f\u5168\u5305\u7684\uff0c\u8ddf\u6211\u4eec\u4e4b\u524d\u7684\u56fe\u6807\u4e0d\u592a\u4e00\u6837\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u6765\u8bd5\u8bd5\u770b\u5427\uff1a</p> <pre><code>public static void main(String[] args) {\n    ApplicationContext context = new ClassPathXmlApplicationContext(\"application.xml\");\n    Student bean = context.getBean(Student.class);\n    System.out.println(\"\u5df2\u62a5\u540d\uff1a\"+bean.study(\"Java\"));\n}\n</code></pre> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u73af\u7ed5\u65b9\u6cd5\uff0c\u901a\u8fc7\u5408\u7406\u5229\u7528AOP\u5e26\u6765\u7684\u4fbf\u6377\uff0c\u53ef\u4ee5\u4f7f\u5f97\u6211\u4eec\u7684\u4ee3\u7801\u66f4\u52a0\u6e05\u723d\u548c\u4f18\u7f8e\u3002\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e0b AOP \u9886\u57df\u4e2d\u7684\u7279\u6027\u672f\u8bed\uff0c\u9632\u6b62\u81ea\u5df1\u4e0b\u6765\u770b\u4e0d\u61c2\u6587\u7ae0\uff1a</p> <ul> <li>\u901a\u77e5\uff08Advice\uff09: AOP \u6846\u67b6\u4e2d\u7684\u589e\u5f3a\u5904\u7406\uff0c\u901a\u77e5\u63cf\u8ff0\u4e86\u5207\u9762\u4f55\u65f6\u6267\u884c\u4ee5\u53ca\u5982\u4f55\u6267\u884c\u589e\u5f3a\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u4e0a\u9762\u7f16\u5199\u7684\u65b9\u6cd5\u5b9e\u73b0\u3002</li> <li>\u8fde\u63a5\u70b9\uff08join point\uff09: \u8fde\u63a5\u70b9\u8868\u793a\u5e94\u7528\u6267\u884c\u8fc7\u7a0b\u4e2d\u80fd\u591f\u63d2\u5165\u5207\u9762\u7684\u4e00\u4e2a\u70b9\uff0c\u8fd9\u4e2a\u70b9\u53ef\u4ee5\u662f\u65b9\u6cd5\u7684\u8c03\u7528\u3001\u5f02\u5e38\u7684\u629b\u51fa\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u6211\u4eec\u5728\u65b9\u6cd5\u6267\u884c\u524d\u6216\u662f\u6267\u884c\u540e\u9700\u8981\u505a\u7684\u5185\u5bb9\u3002</li> <li>\u5207\u70b9\uff08PointCut\uff09: \u53ef\u4ee5\u63d2\u5165\u589e\u5f3a\u5904\u7406\u7684\u8fde\u63a5\u70b9\uff0c\u53ef\u4ee5\u662f\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\u4e5f\u53ef\u4ee5\u65b9\u6cd5\u6267\u884c\u4e4b\u540e\uff0c\u8fd8\u53ef\u4ee5\u662f\u629b\u51fa\u5f02\u5e38\u4e4b\u7c7b\u7684\u3002</li> <li>\u5207\u9762\uff08Aspect\uff09: \u5207\u9762\u662f\u901a\u77e5\u548c\u5207\u70b9\u7684\u7ed3\u5408\uff0c\u6211\u4eec\u4e4b\u524d\u5728xml\u4e2d\u5b9a\u4e49\u7684\u5c31\u662f\u5207\u9762\uff0c\u5305\u62ec\u5f88\u591a\u4fe1\u606f\u3002</li> <li>\u5f15\u5165\uff08Introduction\uff09\uff1a\u5f15\u5165\u5141\u8bb8\u6211\u4eec\u5411\u73b0\u6709\u7684\u7c7b\u6dfb\u52a0\u65b0\u7684\u65b9\u6cd5\u6216\u8005\u5c5e\u6027\u3002</li> <li>\u7ec7\u5165\uff08Weaving\uff09: \u5c06\u589e\u5f3a\u5904\u7406\u6dfb\u52a0\u5230\u76ee\u6807\u5bf9\u8c61\u4e2d\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u88ab\u589e\u5f3a\u7684\u5bf9\u8c61\uff0c\u6211\u4eec\u4e4b\u524d\u90fd\u662f\u5728\u5c06\u6211\u4eec\u7684\u589e\u5f3a\u5904\u7406\u6dfb\u52a0\u5230\u76ee\u6807\u5bf9\u8c61\uff0c\u4e5f\u5c31\u662f\u7ec7\u5165\uff08\u8fd9\u540d\u5b57\u633a\u6709\u6587\u827a\u8303\u7684\uff09</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#aop_2","title":"\u4f7f\u7528\u63a5\u53e3\u5b9e\u73b0AOP","text":"<p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u4f55\u4f7f\u7528xml\u914d\u7f6e\u4e00\u4e2aAOP\u64cd\u4f5c\uff0c\u8fd9\u8282\u8bfe\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u4f7f\u7528Advice\u5b9e\u73b0AOP\u3002</p> <p>\u5b83\u4e0e\u6211\u4eec\u4e4b\u524d\u5b66\u4e60\u7684\u52a8\u6001\u4ee3\u7406\u66f4\u63a5\u8fd1\u4e00\u4e9b\uff0c\u6bd4\u5982\u5728\u65b9\u6cd5\u5f00\u59cb\u6267\u884c\u4e4b\u524d\u6216\u662f\u6267\u884c\u4e4b\u540e\u4f1a\u53bb\u8c03\u7528\u6211\u4eec\u5b9e\u73b0\u7684\u63a5\u53e3\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u5c06\u4e00\u4e2a\u7c7b\u5b9e\u73b0Advice\u63a5\u53e3\uff0c\u53ea\u6709\u5b9e\u73b0\u6b64\u63a5\u53e3\uff0c\u624d\u53ef\u4ee5\u88ab\u901a\u77e5\uff0c\u6bd4\u5982\u6211\u4eec\u8fd9\u91cc\u4f7f\u7528<code>MethodBeforeAdvice</code>\u8868\u793a\u662f\u4e00\u4e2a\u5728\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\u7684\u52a8\u4f5c\uff1a</p> <pre><code>public class StudentAOP implements MethodBeforeAdvice {\n    @Override\n    public void before(Method method, Object[] args, Object target) throws Throwable {\n        System.out.println(\"\u901a\u8fc7Advice\u5b9e\u73b0AOP\");\n    }\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u65b9\u6cd5\u4e2d\u5305\u62ec\u4e86\u5f88\u591a\u7684\u53c2\u6570\uff0c\u5176\u4e2dargs\u4ee3\u8868\u7684\u662f\u65b9\u6cd5\u6267\u884c\u524d\u5f97\u5230\u7684\u5b9e\u53c2\u5217\u8868\uff0c\u8fd8\u6709target\u8868\u793a\u6267\u884c\u6b64\u65b9\u6cd5\u7684\u5b9e\u4f8b\u5bf9\u8c61\u3002\u8fd0\u884c\u4e4b\u540e\uff0c\u6548\u679c\u548c\u4e4b\u524d\u662f\u4e00\u6837\u7684\uff0c\u4f46\u662f\u5728\u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5\u5feb\u901f\u83b7\u53d6\u5230\u66f4\u591a\u4fe1\u606f\u3002\u8fd8\u662f\u4ee5\u7b80\u5355\u7684study\u65b9\u6cd5\u4e3a\u4f8b\uff1a</p> <pre><code>public class Student {\n    public void study(){\n        System.out.println(\"\u6211\u662f\u5b66\u4e60\u65b9\u6cd5\uff01\");\n    }\n}\n</code></pre> <pre><code>&lt;bean id=\"student\" class=\"org.example.entity.Student\"/&gt;\n&lt;bean id=\"studentAOP\" class=\"org.example.entity.StudentAOP\"/&gt;\n&lt;aop:config&gt;\n    &lt;aop:pointcut id=\"test\" expression=\"execution(* org.example.entity.Student.study())\"/&gt;\n    &lt;!--  \u8fd9\u91cc\u53ea\u9700\u8981\u6dfb\u52a0\u6211\u4eec\u521a\u521a\u5199\u597d\u7684advisor\u5c31\u53ef\u4ee5\u4e86\uff0c\u6ce8\u610f\u662fBean\u7684\u540d\u5b57  --&gt;\n    &lt;aop:advisor advice-ref=\"studentAOP\" pointcut-ref=\"test\"/&gt;\n&lt;/aop:config&gt;\n</code></pre> <p>\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\u5427\uff1a</p> <p></p> <p>\u9664\u4e86\u6b64\u63a5\u53e3\u4ee5\u5916\uff0c\u8fd8\u6709\u5176\u4ed6\u7684\u63a5\u53e3\uff0c\u6bd4\u5982<code>AfterReturningAdvice</code>\u5c31\u9700\u8981\u5b9e\u73b0\u4e00\u4e2a\u65b9\u6cd5\u6267\u884c\u4e4b\u540e\u7684\u64cd\u4f5c\uff1a</p> <pre><code>public class StudentAOP implements MethodBeforeAdvice, AfterReturningAdvice {\n    @Override\n    public void before(Method method, Object[] args, Object target) throws Throwable {\n        System.out.println(\"\u901a\u8fc7Advice\u5b9e\u73b0AOP\");\n    }\n\n    @Override\n    public void afterReturning(Object returnValue, Method method, Object[] args, Object target) throws Throwable {\n        System.out.println(\"\u6211\u662f\u65b9\u6cd5\u6267\u884c\u4e4b\u540e\u7684\u7ed3\u679c\uff0c\u65b9\u6cd5\u8fd4\u56de\u503c\u4e3a\uff1a\"+returnValue);\n    }\n}\n</code></pre> <p>\u56e0\u4e3a\u4f7f\u7528\u7684\u662f\u63a5\u53e3\uff0c\u5c31\u975e\u5e38\u65b9\u4fbf\uff0c\u76f4\u63a5\u5199\u4e00\u8d77\uff0c\u914d\u7f6e\u6587\u4ef6\u90fd\u4e0d\u9700\u8981\u6539\u4e86\uff1a</p> <p></p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528MethodInterceptor\uff08\u540c\u6837\u4e5f\u662fAdvice\u7684\u5b50\u63a5\u53e3\uff09\u8fdb\u884c\u66f4\u52a0\u73af\u7ed5\u90a3\u6837\u7684\u81ea\u5b9a\u4e49\u7684\u589e\u5f3a\uff0c\u5b83\u7528\u8d77\u6765\u5c31\u771f\u7684\u50cf\u4ee3\u7406\u4e00\u6837\uff0c\u4f8b\u5b50\u5982\u4e0b\uff1a</p> <pre><code>public class Student {\n    public String study(){\n        System.out.println(\"\u6211\u662f\u5b66\u4e60\u65b9\u6cd5\uff01\");\n        return \"lbwnb\";\n    }\n}\n</code></pre> <pre><code>public class StudentAOP implements MethodInterceptor {   //\u5b9e\u73b0MethodInterceptor\u63a5\u53e3\n    @Override\n    public Object invoke(MethodInvocation invocation) throws Throwable {  //invoke\u65b9\u6cd5\u5c31\u662f\u4ee3\u7406\u65b9\u6cd5\n        Object value = invocation.proceed();   //\u8ddf\u4e4b\u524d\u4e00\u6837\uff0c\u9700\u8981\u624b\u52a8proceed()\u624d\u80fd\u8c03\u7528\u539f\u65b9\u6cd5\n        return value+\"\u589e\u5f3a\";\n    }\n}\n</code></pre> <p>\u6211\u4eec\u6765\u770b\u770b\u7ed3\u679c\u5427\uff1a</p> <p></p> <p>\u4f7f\u7528\u8d77\u6765\u8fd8\u662f\u633a\u7b80\u5355\u7684\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#aop_3","title":"\u4f7f\u7528\u6ce8\u89e3\u5b9e\u73b0AOP","text":"<p>\u63a5\u7740\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u4f7f\u7528\u6ce8\u89e3\u5b9e\u73b0AOP\u64cd\u4f5c\uff0c\u73b0\u5728\u53d8\u56de\u6211\u4eec\u4e4b\u524d\u7684\u6ce8\u89e3\u5f00\u53d1\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u5728\u4e3b\u7c7b\u6dfb\u52a0<code>@EnableAspectJAutoProxy</code>\u6ce8\u89e3\uff0c\u5f00\u542fAOP\u6ce8\u89e3\u652f\u6301\uff1a</p> <pre><code>@EnableAspectJAutoProxy\n@ComponentScan(\"org.example.entity\")\n@Configuration\npublic class MainConfiguration {\n}\n</code></pre> <p>\u8fd8\u662f\u719f\u6089\u7684\u73a9\u6cd5\uff0c\u7c7b\u4e0a\u76f4\u63a5\u6dfb\u52a0<code>@Component</code>\u5feb\u901f\u6ce8\u518cBean\uff1a</p> <pre><code>@Component\npublic class Student {\n    public void study(){\n        System.out.println(\"\u6211\u662f\u5b66\u4e60\u65b9\u6cd5\uff01\");\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5728\u5b9a\u4e49AOP\u589e\u5f3a\u64cd\u4f5c\u7684\u7c7b\u4e0a\u6dfb\u52a0<code>@Aspect</code>\u6ce8\u89e3\u548c<code>@Component</code>\u5c06\u5176\u6ce8\u518c\u4e3aBean\u5373\u53ef\uff0c\u5c31\u50cf\u6211\u4eec\u4e4b\u524d\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4e5f\u8981\u5c06\u5176\u6ce8\u518c\u4e3aBean\u90a3\u6837\uff1a</p> <pre><code>@Aspect\n@Component\npublic class StudentAOP {\n\n}\n</code></pre> <p>\u63a5\u7740\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u91cc\u9762\u7f16\u5199\u589e\u5f3a\u65b9\u6cd5\uff0c\u5e76\u5c06\u6b64\u65b9\u6cd5\u6dfb\u52a0\u5230\u4e00\u4e2a\u5207\u70b9\u4e2d\uff0c\u6bd4\u5982\u6211\u4eec\u5e0c\u671b\u5728Student\u7684study\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\u6267\u884c\u6211\u4eec\u7684<code>before</code>\u65b9\u6cd5\uff1a</p> <pre><code>public void before(){\n    System.out.println(\"\u6211\u662f\u4e4b\u524d\u6267\u884c\u7684\u5185\u5bb9\uff01\");\n}\n</code></pre> <p>\u90a3\u4e48\u53ea\u9700\u8981\u6dfb\u52a0@Before\u6ce8\u89e3\u5373\u53ef\uff1a</p> <pre><code>@Before(\"execution(* org.example.entity.Student.study())\")  //execution\u5199\u6cd5\u8ddf\u4e4b\u524d\u4e00\u6837\npublic void before(){\n    System.out.println(\"\u6211\u662f\u4e4b\u524d\u6267\u884c\u7684\u5185\u5bb9\uff01\");\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u4f1a\u5728\u6307\u5b9a\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\u6267\u884c\u4e86\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u6bd4XML\u914d\u7f6e\u65b9\u4fbf\u591a\u4e86\u3002\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <pre><code>public static void main(String[] args) {\n    ApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class);\n    Student bean = context.getBean(Student.class);\n    bean.study();\n}\n</code></pre> <p></p> <p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a\u5176\u6dfb\u52a0<code>JoinPoint</code>\u53c2\u6570\u6765\u83b7\u53d6\u5207\u5165\u70b9\u4fe1\u606f\uff0c\u4f7f\u7528\u65b9\u6cd5\u8ddf\u4e4b\u524d\u4e00\u6837\uff1a</p> <pre><code>@Before(\"execution(* org.example.entity.Student.study())\")\npublic void before(JoinPoint point){\n    System.out.println(\"\u53c2\u6570\u5217\u8868\uff1a\"+ Arrays.toString(point.getArgs()));\n    System.out.println(\"\u6211\u662f\u4e4b\u524d\u6267\u884c\u7684\u5185\u5bb9\uff01\");\n}\n</code></pre> <p>\u4e3a\u4e86\u66f4\u65b9\u4fbf\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u76f4\u63a5\u5c06\u53c2\u6570\u653e\u5165\uff0c\u6bd4\u5982\uff1a</p> <pre><code>public void study(String str){\n    System.out.println(\"\u6211\u662f\u5b66\u4e60\u65b9\u6cd5\uff01\");\n}\n</code></pre> <p>\u4f7f\u7528\u547d\u540d\u7ed1\u5b9a\u6a21\u5f0f\uff0c\u53ef\u4ee5\u5feb\u901f\u5f97\u5230\u539f\u65b9\u6cd5\u7684\u53c2\u6570\uff1a</p> <pre><code>@Before(value = \"execution(* org.example.entity.Student.study(..)) &amp;&amp; args(str)\", argNames = \"str\")\n//\u547d\u540d\u7ed1\u5b9a\u6a21\u5f0f\u5c31\u662f\u6839\u636e\u4e0b\u9762\u7684\u65b9\u6cd5\u53c2\u6570\u5217\u8868\u8fdb\u884c\u5339\u914d\n//\u8fd9\u91ccargs\u6307\u660e\u53c2\u6570\uff0c\u6ce8\u610f\u9700\u8981\u8ddf\u539f\u65b9\u6cd5\u4fdd\u6301\u4e00\u81f4\uff0c\u7136\u540e\u5728argNames\u4e2d\u6307\u660e\npublic void before(String str){\n    System.out.println(str);   //\u53ef\u4ee5\u5feb\u901f\u5f97\u5230\u4f20\u5165\u7684\u53c2\u6570\n    System.out.println(\"\u6211\u662f\u4e4b\u524d\u6267\u884c\u7684\u5185\u5bb9\uff01\");\n}\n</code></pre> <p>\u9664\u4e86@Before\uff0c\u8fd8\u6709\u5f88\u591a\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u7684\u6ce8\u89e3\uff0c\u6bd4\u5982@AfterReturning\u3001@AfterThrowing\u7b49\uff0c\u6bd4\u5982@AfterReturning\uff1a</p> <pre><code>public String study(){\n    System.out.println(\"\u6211\u662f\u5b66\u4e60\u65b9\u6cd5\uff01\");\n    return \"lbwnb\";\n}\n</code></pre> <pre><code>@AfterReturning(value = \"execution(* org.example.entity.Student.study())\", argNames = \"returnVal\", returning = \"returnVal\")   //\u4f7f\u7528returning\u6307\u5b9a\u63a5\u6536\u65b9\u6cd5\u8fd4\u56de\u503c\u7684\u53c2\u6570returnVal\npublic void afterReturn(Object returnVal){\n    System.out.println(\"\u8fd4\u56de\u503c\u662f\uff1a\"+returnVal);\n}\n</code></pre> <p>\u540c\u6837\u7684\uff0c\u73af\u7ed5\u4e5f\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u6ce8\u89e3\u58f0\u660e\uff1a</p> <pre><code>@Around(\"execution(* com.test.bean.Student.test(..))\")\npublic Object around(ProceedingJoinPoint point) throws Throwable {\n    System.out.println(\"\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\uff01\");\n    Object val = point.proceed();\n    System.out.println(\"\u65b9\u6cd5\u6267\u884c\u4e4b\u540e\uff01\");\n    return val;\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0c\u65e0\u8bba\u662f\u4f7f\u7528\u6ce8\u89e3\u6216\u662fXML\u914d\u7f6e\uff0c\u6211\u4eec\u8981\u505a\u7684\u6d41\u7a0b\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5728\u4e4b\u540e\u7684\u5b66\u4e60\u4e2d\uff0c\u6211\u4eec\u8fd8\u4f1a\u9047\u5230\u66f4\u591a\u9700\u8981\u4f7f\u7528AOP\u7684\u5730\u65b9\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_9","title":"\u6570\u636e\u5e93\u6846\u67b6\u6574\u5408","text":"<p>\u5b66\u4e60\u4e86Spring\u4e4b\u540e\uff0c\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u5982\u4f55\u5c06\u4e00\u4e2a\u7c7b\u4f5c\u4e3aBean\u4ea4\u7531IoC\u5bb9\u5668\u7ba1\u7406\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u66f4\u65b9\u4fbf\u7684\u65b9\u5f0f\u6765\u4f7f\u7528Mybatis\u6846\u67b6\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u628aSqlSessionFactory\u3001Mapper\u4ea4\u7ed9Spring\u8fdb\u884c\u7ba1\u7406\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u6ce8\u5165\u7684\u65b9\u5f0f\u5feb\u901f\u5730\u4f7f\u7528\u5b83\u4eec\u3002</p> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u8981\u5b66\u4e60\u4e00\u4e0b\u5982\u4f55\u5c06Mybatis\u4e0eSpring\u8fdb\u884c\u6574\u5408\uff0c\u90a3\u4e48\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5728\u4e4b\u524d\u77e5\u8bc6\u7684\u57fa\u7840\u4e0a\u7ee7\u7eed\u6df1\u5316\u5b66\u4e60\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_10","title":"\u4e86\u89e3\u6570\u636e\u6e90","text":"<p>\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u5982\u679c\u9700\u8981\u521b\u5efa\u4e00\u4e2aJDBC\u7684\u8fde\u63a5\uff0c\u90a3\u4e48\u5fc5\u987b\u4f7f\u7528<code>DriverManager.getConnection()</code>\u6765\u521b\u5efa\u8fde\u63a5\uff0c\u8fde\u63a5\u5efa\u7acb\u540e\uff0c\u6211\u4eec\u624d\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u5e93\u64cd\u4f5c\u3002\u800c\u5b66\u4e60\u4e86Mybatis\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u4e0d\u7528\u518d\u53bb\u4f7f\u7528<code>DriverManager</code>\u4e3a\u6211\u4eec\u63d0\u4f9b\u8fde\u63a5\u5bf9\u8c61\uff0c\u800c\u662f\u76f4\u63a5\u4f7f\u7528Mybatis\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684<code>SqlSessionFactory</code>\u5de5\u5177\u7c7b\u6765\u83b7\u53d6\u5bf9\u5e94\u7684<code>SqlSession</code>\u901a\u8fc7\u4f1a\u8bdd\u5bf9\u8c61\u53bb\u64cd\u4f5c\u6570\u636e\u5e93\u3002</p> <p>\u90a3\u4e48\uff0c\u5b83\u5230\u5e95\u662f\u5982\u4f55\u5c01\u88c5JDBC\u7684\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u8bd5\u7740\u6765\u731c\u60f3\u4e00\u4e0b\uff0c\u4f1a\u4e0d\u4f1a\u662fMybatis\u6bcf\u6b21\u90fd\u662f\u5e2e\u52a9\u6211\u4eec\u8c03\u7528<code>DriverManager</code>\u6765\u5b9e\u73b0\u7684\u6570\u636e\u5e93\u8fde\u63a5\u521b\u5efa\uff1f\u6211\u4eec\u53ef\u4ee5\u770b\u770bMybatis\u7684\u6e90\u7801\uff1a</p> <pre><code>public SqlSession openSession(boolean autoCommit) {\n    return this.openSessionFromDataSource(this.configuration.getDefaultExecutorType(), (TransactionIsolationLevel)null, autoCommit);\n}\n</code></pre> <p>\u5728\u901a\u8fc7<code>SqlSessionFactory</code>\u8c03\u7528<code>openSession</code>\u65b9\u6cd5\u4e4b\u540e\uff0c\u5b83\u8c03\u7528\u4e86\u5185\u90e8\u7684\u4e00\u4e2a\u79c1\u6709\u7684\u65b9\u6cd5<code>openSessionFromDataSource</code>\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u91cc\u9762\u5b9a\u4e49\u4e86\u4ec0\u4e48\u5185\u5bb9\uff1a</p> <pre><code>private SqlSession openSessionFromDataSource(ExecutorType execType, TransactionIsolationLevel level, boolean autoCommit) {\n    Transaction tx = null;\n\n    DefaultSqlSession var8;\n    try {\n        //\u83b7\u53d6\u5f53\u524d\u73af\u5883\uff08\u7531\u914d\u7f6e\u6587\u4ef6\u6620\u5c04\u7684\u5bf9\u8c61\u5b9e\u4f53\uff09\n        Environment environment = this.configuration.getEnvironment();\n        //\u4e8b\u52a1\u5de5\u5382\uff08\u6682\u65f6\u4e0d\u63d0\uff0c\u4e0b\u4e00\u677f\u5757\u8bb2\u89e3\uff09\n        TransactionFactory transactionFactory = this.getTransactionFactoryFromEnvironment(environment);\n        //\u914d\u7f6e\u6587\u4ef6\u4e2d\uff1a&lt;transactionManager type=\"JDBC\"/&gt;\n        //\u751f\u6210\u4e8b\u52a1\uff08\u6839\u636e\u6211\u4eec\u7684\u914d\u7f6e\uff0c\u4f1a\u9ed8\u8ba4\u751f\u6210JdbcTransaction\uff09\uff0c\u8fd9\u91cc\u662f\u5173\u952e\uff0c\u6211\u4eec\u770b\u5230\u8fd9\u91cc\u7528\u5230\u4e86environment.getDataSource()\u65b9\u6cd5\n        tx = transactionFactory.newTransaction(environment.getDataSource(), level, autoCommit);\n        //\u6267\u884c\u5668\uff0c\u5305\u62ec\u5168\u90e8\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u65b9\u6cd5\u5b9a\u4e49\uff0c\u672c\u8d28\u4e0a\u662f\u5728\u4f7f\u7528\u6267\u884c\u5668\u64cd\u4f5c\u6570\u636e\u5e93\uff0c\u9700\u8981\u4f20\u5165\u4e8b\u52a1\u5bf9\u8c61\n        Executor executor = this.configuration.newExecutor(tx, execType);\n        //\u5c01\u88c5\u4e3aSqlSession\u5bf9\u8c61\n        var8 = new DefaultSqlSession(this.configuration, executor, autoCommit);\n    } catch (Exception var12) {\n        this.closeTransaction(tx);\n        throw ExceptionFactory.wrapException(\"Error opening session.  Cause: \" + var12, var12);\n    } finally {\n        ErrorContext.instance().reset();\n    }\n\n    return var8;\n}\n</code></pre> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u7684\u6570\u636e\u6e90\u914d\u7f6e\u4fe1\u606f\uff0c\u5b58\u653e\u5728\u4e86<code>Transaction</code>\u5bf9\u8c61\u4e2d\uff0c\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u6267\u884c\u5668\u5230\u5e95\u662f\u5982\u4f55\u6267\u884cSQL\u8bed\u53e5\u7684\uff0c\u6211\u4eec\u5c31\u77e5\u9053\u5230\u5e95\u5982\u4f55\u521b\u5efa<code>Connection</code>\u5bf9\u8c61\u4e86\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u83b7\u53d6\u6570\u636e\u5e93\u7684\u94fe\u63a5\u4fe1\u606f\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770b\uff0c\u8fd9\u4e2a<code>DataSource</code>\u5230\u5e95\u662f\u4e2a\u4ec0\u4e48\uff1a</p> <pre><code>public interface DataSource  extends CommonDataSource, Wrapper {\n\n  Connection getConnection() throws SQLException;\n\n  Connection getConnection(String username, String password)\n    throws SQLException;\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u5b83\u662f\u5728<code>javax.sql</code>\u5b9a\u4e49\u7684\u4e00\u4e2a\u63a5\u53e3\uff0c\u5b83\u5305\u62ec\u4e86\u4e24\u4e2a\u65b9\u6cd5\uff0c\u90fd\u662f\u7528\u4e8e\u83b7\u53d6\u8fde\u63a5\u7684\u3002\u56e0\u6b64\uff0c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u65ad\u5b9a\uff0c\u5e76\u4e0d\u662f\u901a\u8fc7\u4e4b\u524d<code>DriverManager</code>\u7684\u65b9\u6cd5\u53bb\u83b7\u53d6\u8fde\u63a5\u4e86\uff0c\u800c\u662f\u4f7f\u7528<code>DataSource</code>\u7684\u5b9e\u73b0\u7c7b\u6765\u83b7\u53d6\u7684\uff0c\u56e0\u6b64\uff0c\u4e5f\u5c31\u6b63\u5f0f\u5f15\u5165\u5230\u6211\u4eec\u8fd9\u4e00\u8282\u7684\u8bdd\u9898\u4e86\uff1a</p> <p>\u6570\u636e\u5e93\u94fe\u63a5\u7684\u5efa\u7acb\u548c\u5173\u95ed\u662f\u6781\u5176\u8017\u8d39\u7cfb\u7edf\u8d44\u6e90\u7684\u64cd\u4f5c\uff0c\u901a\u8fc7DriverManager\u83b7\u53d6\u7684\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u5bf9\u8c61\u5747\u5bf9\u5e94\u4e00\u4e2a\u7269\u7406\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u6bcf\u6b21\u64cd\u4f5c\u90fd\u6253\u5f00\u4e00\u4e2a\u7269\u7406\u8fde\u63a5\uff0c\u4f7f\u7528\u5b8c\u540e\u7acb\u5373\u5173\u95ed\u8fde\u63a5\uff0c\u9891\u7e41\u7684\u6253\u5f00\u3001\u5173\u95ed\u8fde\u63a5\u4f1a\u6301\u7eed\u6d88\u8017\u7f51\u7edc\u8d44\u6e90\uff0c\u9020\u6210\u6574\u4e2a\u7cfb\u7edf\u6027\u80fd\u7684\u4f4e\u4e0b\u3002</p> <p>\u56e0\u6b64\uff0cJDBC\u4e3a\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6570\u636e\u6e90\u7684\u6807\u51c6\uff0c\u4e5f\u5c31\u662f<code>DataSource</code>\u63a5\u53e3\uff0c\u544a\u8bc9\u6570\u636e\u6e90\u6570\u636e\u5e93\u7684\u8fde\u63a5\u4fe1\u606f\uff0c\u5e76\u5c06\u6240\u6709\u7684\u8fde\u63a5\u5168\u90e8\u4ea4\u7ed9\u6570\u636e\u6e90\u8fdb\u884c\u96c6\u4e2d\u7ba1\u7406\uff0c\u5f53\u9700\u8981\u4e00\u4e2a<code>Connection</code>\u5bf9\u8c61\u65f6\uff0c\u53ef\u4ee5\u5411\u6570\u636e\u6e90\u7533\u8bf7\uff0c\u6570\u636e\u6e90\u4f1a\u6839\u636e\u5185\u90e8\u673a\u5236\uff0c\u5408\u7406\u5730\u5206\u914d\u8fde\u63a5\u5bf9\u8c61\u7ed9\u6211\u4eec\u3002</p> <p>\u4e00\u822c\u6bd4\u8f83\u5e38\u7528\u7684<code>DataSource</code>\u5b9e\u73b0\uff0c\u90fd\u662f\u91c7\u7528\u6c60\u5316\u6280\u672f\uff0c\u5c31\u662f\u5728\u4e00\u5f00\u59cb\u5c31\u521b\u5efa\u597dN\u4e2a\u8fde\u63a5\uff0c\u8fd9\u6837\u4e4b\u540e\u4f7f\u7528\u5c31\u65e0\u9700\u518d\u6b21\u8fdb\u884c\u8fde\u63a5\uff0c\u800c\u662f\u76f4\u63a5\u4f7f\u7528\u73b0\u6210\u7684<code>Connection</code>\u5bf9\u8c61\u8fdb\u884c\u6570\u636e\u5e93\u64cd\u4f5c\u3002</p> <p></p> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4f20\u7edf\u7684\u5373\u7528\u5373\u8fde\u7684\u65b9\u5f0f\u83b7\u53d6<code>Connection</code>\u5bf9\u8c61\uff0cMybatis\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u51e0\u4e2a\u9ed8\u8ba4\u7684\u6570\u636e\u6e90\u5b9e\u73b0\uff0c\u6211\u4eec\u4e4b\u524d\u4e00\u76f4\u5728\u4f7f\u7528\u7684\u662f\u5b98\u65b9\u7684\u9ed8\u8ba4\u914d\u7f6e\uff0c\u4e5f\u5c31\u662f\u6c60\u5316\u6570\u636e\u6e90\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;!DOCTYPE configuration\n        PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\"\n        \"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;\n&lt;configuration&gt;\n    &lt;environments default=\"development\"&gt;\n        &lt;environment id=\"development\"&gt;\n            &lt;transactionManager type=\"JDBC\"/&gt;\n            &lt;dataSource type=\"POOLED\"&gt;\n                &lt;property name=\"driver\" value=\"${\u9a71\u52a8\u7c7b\uff08\u542b\u5305\u540d\uff09}\"/&gt;\n                &lt;property name=\"url\" value=\"${\u6570\u636e\u5e93\u8fde\u63a5URL}\"/&gt;\n                &lt;property name=\"username\" value=\"${\u7528\u6237\u540d}\"/&gt;\n                &lt;property name=\"password\" value=\"${\u5bc6\u7801}\"/&gt;\n            &lt;/dataSource&gt;\n        &lt;/environment&gt;\n    &lt;/environments&gt;\n&lt;/configuration&gt;\n</code></pre> <p>\u8fd9\u91cc\u7684<code>type</code>\u5c5e\u6027\u4e00\u5171\u4e09\u4e2a\u9009\u9879\uff1a</p> <ul> <li>UNPOOLED   \u4e0d\u4f7f\u7528\u8fde\u63a5\u6c60\u7684\u6570\u636e\u6e90</li> <li>POOLED    \u4f7f\u7528\u8fde\u63a5\u6c60\u7684\u6570\u636e\u6e90</li> <li>JNDI     \u4f7f\u7528JNDI\u5b9e\u73b0\u7684\u6570\u636e\u6e90</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#mybatis","title":"\u89e3\u8bfbMybatis\u6570\u636e\u6e90\u5b9e\u73b0\uff08\u9009\u5b66\uff09","text":"<p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86DataSource\u6570\u636e\u6e90\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6765\u770b\u770b\uff0cMybatis\u5230\u5e95\u662f\u600e\u4e48\u5b9e\u73b0\u7684\u3002\u6211\u4eec\u5148\u6765\u770b\u770b\uff0c\u4e0d\u4f7f\u7528\u6c60\u5316\u7684\u6570\u636e\u6e90\u5b9e\u73b0\uff0c\u5b83\u53eb\u505a<code>UnpooledDataSource</code>\uff0c\u6211\u4eec\u6765\u770b\u770b\u6e90\u7801\uff1a</p> <pre><code>public class UnpooledDataSource implements DataSource {\n    private ClassLoader driverClassLoader;\n    private Properties driverProperties;\n    private static Map&lt;String, Driver&gt; registeredDrivers = new ConcurrentHashMap();\n    private String driver;\n    private String url;\n    private String username;\n    private String password;\n    private Boolean autoCommit;\n    private Integer defaultTransactionIsolationLevel;\n    private Integer defaultNetworkTimeout;\n    ...\n</code></pre> <p>\u9996\u5148\u8fd9\u4e2a\u7c7b\u4e2d\u5b9a\u4e49\u4e86\u5f88\u591a\u7684\u6210\u5458\uff0c\u5305\u62ec\u6570\u636e\u5e93\u7684\u8fde\u63a5\u4fe1\u606f\u3001\u6570\u636e\u5e93\u9a71\u52a8\u4fe1\u606f\u3001\u4e8b\u52a1\u76f8\u5173\u4fe1\u606f\u7b49\u3002\u6211\u4eec\u63a5\u7740\u6765\u770b\uff0c\u5b83\u662f\u5982\u4f55\u5b9e\u73b0<code>DataSource</code>\u4e2d\u63d0\u4f9b\u7684\u63a5\u53e3\u65b9\u6cd5\u7684\uff1a</p> <pre><code>public Connection getConnection() throws SQLException {\n    return this.doGetConnection(this.username, this.password);\n}\n\npublic Connection getConnection(String username, String password) throws SQLException {\n    return this.doGetConnection(username, password);\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0c\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u90fd\u6307\u5411\u4e86\u5185\u90e8\u7684\u4e00\u4e2a<code>doGetConnection</code>\u65b9\u6cd5\uff0c\u90a3\u4e48\u6211\u4eec\u63a5\u7740\u6765\u770b\uff1a</p> <pre><code>private Connection doGetConnection(String username, String password) throws SQLException {\n    Properties props = new Properties();\n    if (this.driverProperties != null) {\n        props.putAll(this.driverProperties);\n    }\n\n    if (username != null) {\n        props.setProperty(\"user\", username);\n    }\n\n    if (password != null) {\n        props.setProperty(\"password\", password);\n    }\n\n    return this.doGetConnection(props);\n}\n</code></pre> <p>\u8fd9\u91cc\u5c06\u7528\u6237\u540d\u548c\u5bc6\u7801\u914d\u7f6e\u5c01\u88c5\u4e3a\u4e00\u4e2aProperties\u5bf9\u8c61\uff0c\u7136\u540e\u6267\u884c\u53e6\u4e00\u4e2a\u91cd\u8f7d\u540c\u540d\u7684\u65b9\u6cd5\uff1a</p> <pre><code>private Connection doGetConnection(Properties properties) throws SQLException {\n    //\u82e5\u672a\u521d\u59cb\u5316\u9a71\u52a8\uff0c\u9700\u8981\u5148\u521d\u59cb\u5316\uff0c\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2aMap\u6765\u8bb0\u5f55\u521d\u59cb\u5316\u4fe1\u606f\uff0c\u8fd9\u91cc\u4e0d\u591a\u4ecb\u7ecd\u4e86\n    this.initializeDriver();\n    //\u4f20\u7edf\u7684\u83b7\u53d6\u8fde\u63a5\u7684\u65b9\u5f0f\uff0c\u662f\u4e0d\u662f\u7ec8\u4e8e\u627e\u5230\u719f\u6089\u7684\u5473\u9053\u4e86\n    Connection connection = DriverManager.getConnection(this.url, properties);\n    //\u5bf9\u8fde\u63a5\u8fdb\u884c\u989d\u5916\u7684\u4e00\u4e9b\u914d\u7f6e\n    this.configureConnection(connection);\n    return connection;   //\u8fd4\u56de\u5f97\u5230\u7684Connection\u5bf9\u8c61\n}\n</code></pre> <p>\u5230\u8fd9\u91cc\uff0c\u5c31\u8fd4\u56de<code>Connection</code>\u5bf9\u8c61\u4e86\uff0c\u800c\u6b64\u5bf9\u8c61\u6b63\u662f\u901a\u8fc7<code>DriverManager</code>\u6765\u521b\u5efa\u7684\uff0c\u56e0\u6b64\uff0c\u975e\u6c60\u5316\u7684\u6570\u636e\u6e90\u5b9e\u73b0\u4f9d\u7136\u4f7f\u7528\u7684\u662f\u4f20\u7edf\u7684\u8fde\u63a5\u521b\u5efa\u65b9\u5f0f\uff0c\u90a3\u6211\u4eec\u63a5\u7740\u6765\u770b\u6c60\u5316\u7684\u6570\u636e\u6e90\u5b9e\u73b0\uff0c\u5b83\u662f<code>PooledDataSource</code>\u7c7b\uff1a</p> <pre><code>public class PooledDataSource implements DataSource {\n    private static final Log log = LogFactory.getLog(PooledDataSource.class);\n    private final PoolState state = new PoolState(this);\n    //\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2a\u975e\u6c60\u5316\u7684\u6570\u636e\u6e90\uff0c\u8fd9\u662f\u8981\u5e72\u561b\uff1f\n    private final UnpooledDataSource dataSource;\n    protected int poolMaximumActiveConnections = 10;\n    protected int poolMaximumIdleConnections = 5;\n    protected int poolMaximumCheckoutTime = 20000;\n    protected int poolTimeToWait = 20000;\n    protected int poolMaximumLocalBadConnectionTolerance = 3;\n    protected String poolPingQuery = \"NO PING QUERY SET\";\n    protected boolean poolPingEnabled;\n    protected int poolPingConnectionsNotUsedFor;\n    private int expectedConnectionTypeCode;\n    //\u5e76\u53d1\u76f8\u5173\u7c7b\uff0c\u6211\u4eec\u5728JUC\u7bc7\u89c6\u9891\u6559\u7a0b\u4e2d\u4ecb\u7ecd\u8fc7\uff0c\u611f\u5174\u8da3\u53ef\u4ee5\u524d\u5f80\u89c2\u770b\n    private final Lock lock = new ReentrantLock();\n    private final Condition condition;\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u5728\u8fd9\u91cc\u7684\u5b9a\u4e49\u5c31\u6bd4\u975e\u6c60\u5316\u7684\u5b9e\u73b0\u590d\u6742\u5f97\u591a\u4e86\uff0c\u56e0\u4e3a\u5b83\u8fd8\u8981\u8003\u8651\u5e76\u53d1\u7684\u95ee\u9898\uff0c\u5e76\u4e14\u8fd8\u8981\u8003\u8651\u5982\u4f55\u5408\u7406\u5730\u5b58\u653e\u5927\u91cf\u7684\u94fe\u63a5\u5bf9\u8c61\uff0c\u8be5\u5982\u4f55\u8fdb\u884c\u5408\u7406\u5206\u914d\uff0c\u56e0\u6b64\u5b83\u7684\u73a9\u6cd5\u975e\u5e38\u4e4b\u9ad8\u7ea7\uff0c\u4f46\u662f\uff0c\u518d\u9ad8\u7ea7\u7684\u73a9\u6cd5\uff0c\u6211\u4eec\u90fd\u8981\u62ff\u4e0b\u3002</p> <p>\u9996\u5148\u6ce8\u610f\uff0c\u5b83\u5b58\u653e\u4e86\u4e00\u4e2aUnpooledDataSource\uff0c\u6b64\u5bf9\u8c61\u662f\u5728\u6784\u9020\u65f6\u5c31\u88ab\u521b\u5efa\uff0c\u5176\u5b9e\u521b\u5efaConnection\u8fd8\u662f\u4f9d\u9760\u6570\u636e\u5e93\u9a71\u52a8\u521b\u5efa\uff0c\u6211\u4eec\u540e\u9762\u6162\u6162\u89e3\u6790\uff0c\u9996\u5148\u6211\u4eec\u6765\u770b\u770b\u5b83\u662f\u5982\u4f55\u5b9e\u73b0\u63a5\u53e3\u65b9\u6cd5\u7684\uff1a</p> <pre><code>public Connection getConnection() throws SQLException {\n    return this.popConnection(this.dataSource.getUsername(), this.dataSource.getPassword()).getProxyConnection();\n}\n\npublic Connection getConnection(String username, String password) throws SQLException {\n    return this.popConnection(username, password).getProxyConnection();\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5b83\u8c03\u7528\u4e86<code>popConnection()</code>\u65b9\u6cd5\u6765\u83b7\u53d6\u8fde\u63a5\u5bf9\u8c61\uff0c\u7136\u540e\u8fdb\u884c\u4e86\u4e00\u4e2a\u4ee3\u7406\uff0c\u901a\u8fc7\u8fd9\u65b9\u6cd5\u540d\u5b57\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\uff0c\u6709\u53ef\u80fd\u6574\u4e2a\u8fde\u63a5\u6c60\u5c31\u662f\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u6808\u7684\u96c6\u5408\u7c7b\u578b\u7ed3\u6784\u5b9e\u73b0\u7684\u3002\u90a3\u4e48\u6211\u4eec\u63a5\u7740\u6765\u770b\u770b<code>popConnection</code>\u65b9\u6cd5\uff1a</p> <pre><code>private PooledConnection popConnection(String username, String password) throws SQLException {\n    boolean countedWait = false;\n    //\u8fd4\u56de\u7684\u662fPooledConnection\u5bf9\u8c61\uff0c\n    PooledConnection conn = null;\n    long t = System.currentTimeMillis();\n    int localBadConnectionCount = 0;\n\n    while(conn == null) {\n        synchronized(this.state) {   //\u52a0\u9501\uff0c\u56e0\u4e3a\u6709\u53ef\u80fd\u5f88\u591a\u4e2a\u7ebf\u7a0b\u90fd\u9700\u8981\u83b7\u53d6\u8fde\u63a5\u5bf9\u8c61\n            PoolState var10000;\n            //PoolState\u5b58\u4e86\u4e24\u4e2aList\uff0c\u4e00\u4e2a\u662f\u7a7a\u95f2\u5217\u8868\uff0c\u4e00\u4e2a\u662f\u6d3b\u8dc3\u5217\u8868\n            if (!this.state.idleConnections.isEmpty()) {   //\u6709\u7a7a\u95f2\u7684\u8fde\u63a5\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u5206\u914dConnection\n                conn = (PooledConnection)this.state.idleConnections.remove(0);  //ArrayList\u4e2d\u53d6\u7b2c\u4e00\u4e2a\u5143\u7d20\n                if (log.isDebugEnabled()) {\n                    log.debug(\"Checked out connection \" + conn.getRealHashCode() + \" from pool.\");\n                }\n            //\u5982\u679c\u5df2\u7ecf\u6ca1\u6709\u591a\u4f59\u7684\u8fde\u63a5\u53ef\u4ee5\u5206\u914d\uff0c\u90a3\u4e48\u5c31\u68c0\u67e5\u4e00\u4e0b\u6d3b\u8dc3\u8fde\u63a5\u6570\u662f\u5426\u8fbe\u5230\u6700\u5927\u7684\u5206\u914d\u4e0a\u9650\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5c31new\u4e00\u4e2a\u65b0\u7684\n            } else if (this.state.activeConnections.size() &lt; this.poolMaximumActiveConnections) {\n                //\u6ce8\u610fnew\u4e86\u4e4b\u540e\u5e76\u6ca1\u6709\u7acb\u5373\u5f80List\u91cc\u9762\u585e\uff0c\u53ea\u662f\u5b58\u4e86\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f\n                //\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u91cc\u4f9d\u9760UnpooledDataSource\u521b\u5efa\u4e86\u4e00\u4e2aConnection\u5bf9\u8c61\uff0c\u5e76\u5c06\u5176\u5c01\u88c5\u5230PooledConnection\u4e2d\n                //\u6240\u4ee5\u8bf4\u5185\u90e8\u7ef4\u62a4\u7684UnpooledDataSource\u5bf9\u8c61\u5176\u5b9e\u662f\u4e3a\u4e86\u8282\u7701\u4ee3\u7801\uff0c\u56e0\u4e3a\u521b\u5efa\u6570\u636e\u5e93\u8fde\u63a5\u5176\u5b9e\u90fd\u662f\u4e00\u6837\u7684\u65b9\u5f0f\n                conn = new PooledConnection(this.dataSource.getConnection(), this);\n                if (log.isDebugEnabled()) {\n                    log.debug(\"Created connection \" + conn.getRealHashCode() + \".\");\n                }\n              //\u4ee5\u4e0a\u6761\u4ef6\u90fd\u4e0d\u6ee1\u8db3\uff0c\u90a3\u4e48\u53ea\u80fd\u4ece\u4e4b\u524d\u7684\u8fde\u63a5\u4e2d\u5bfb\u627e\u4e86\uff0c\u770b\u770b\u6709\u6ca1\u6709\u90a3\u79cd\u5361\u4f4f\u7684\u94fe\u63a5\uff08\u6bd4\u5982\uff0c\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u6709\u53ef\u80fd\u4e4b\u524d\u7684\u8fde\u63a5\u4e00\u76f4\u88ab\u5361\u4f4f\uff0c\u7136\u800c\u6b63\u5e38\u60c5\u51b5\u4e0b\u65e9\u5c31\u7ed3\u675f\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u4e86\uff0c\u6240\u4ee5\u8fd9\u91cc\u76f8\u5f53\u4e8e\u662f\u4f18\u5316\u4e5f\u7b97\u662f\u4e00\u79cd\u6361\u6f0f\u7684\u65b9\u5f0f\uff09\n            } else {\n                //\u83b7\u53d6\u6700\u65e9\u521b\u5efa\u7684\u8fde\u63a5\n                PooledConnection oldestActiveConnection = (PooledConnection)this.state.activeConnections.get(0);\n                long longestCheckoutTime = oldestActiveConnection.getCheckoutTime();\n                //\u5224\u65ad\u662f\u5426\u8d85\u8fc7\u6700\u5927\u7684\u4f7f\u7528\u65f6\u95f4\n                if (longestCheckoutTime &gt; (long)this.poolMaximumCheckoutTime) {\n                    //\u8d85\u65f6\u7edf\u8ba1\u4fe1\u606f\uff08\u4e0d\u91cd\u8981\uff09\n                    ++this.state.claimedOverdueConnectionCount;\n                    var10000 = this.state;\n                    var10000.accumulatedCheckoutTimeOfOverdueConnections += longestCheckoutTime;\n                    var10000 = this.state;\n                    var10000.accumulatedCheckoutTime += longestCheckoutTime;\n                    //\u4ece\u6d3b\u8dc3\u5217\u8868\u4e2d\u79fb\u9664\u6b64\u94fe\u63a5\u4fe1\u606f\n                    this.state.activeConnections.remove(oldestActiveConnection);\n                    //\u5982\u679c\u5f00\u542f\u4e8b\u52a1\uff0c\u8fd8\u9700\u8981\u56de\u6eda\u4e00\u4e0b\n                    if (!oldestActiveConnection.getRealConnection().getAutoCommit()) {\n                        try {\n                            oldestActiveConnection.getRealConnection().rollback();\n                        } catch (SQLException var15) {\n                            log.debug(\"Bad connection. Could not roll back\");\n                        }\n                    }\n\n                    //\u8fd9\u91cc\u5c31\u6839\u636e\u4e4b\u524d\u7684\u8fde\u63a5\u5bf9\u8c61\u76f4\u63a5new\u4e00\u4e2a\u65b0\u7684\u8fde\u63a5\uff08\u6ce8\u610f\u4f7f\u7528\u7684\u8fd8\u662f\u4e4b\u524d\u7684Connection\u5bf9\u8c61\uff0c\u5e76\u6ca1\u6709\u521b\u5efa\u65b0\u7684\u5bf9\u8c61\uff0c\u53ea\u662f\u88ab\u91cd\u65b0\u5c01\u88c5\u4e86\uff09\n                    conn = new PooledConnection(oldestActiveConnection.getRealConnection(), this);\n                    conn.setCreatedTimestamp(oldestActiveConnection.getCreatedTimestamp());\n                    conn.setLastUsedTimestamp(oldestActiveConnection.getLastUsedTimestamp());\n                    //\u8fc7\u671f\n                    oldestActiveConnection.invalidate();\n                    if (log.isDebugEnabled()) {\n                        log.debug(\"Claimed overdue connection \" + conn.getRealHashCode() + \".\");\n                    }\n                } else {\n                  //\u6ca1\u6709\u8d85\u65f6\uff0c\u90a3\u5c31\u786e\u5b9e\u662f\u6ca1\u8fde\u63a5\u53ef\u4ee5\u7528\u4e86\uff0c\u53ea\u80fd\u5361\u4f4f\u4e86\uff08\u963b\u585e\uff09\n                  //\u7136\u540e\u987a\u624b\u8bb0\u5f55\u4e00\u4e0b\u76ee\u524d\u6709\u51e0\u4e2a\u7ebf\u7a0b\u5728\u7b49\u5f85\u5176\u4ed6\u7684\u4efb\u52a1\u641e\u5b8c\n                    try {\n                        if (!countedWait) {\n                            ++this.state.hadToWaitCount;\n                            countedWait = true;\n                        }\n\n                        if (log.isDebugEnabled()) {\n                            log.debug(\"Waiting as long as \" + this.poolTimeToWait + \" milliseconds for connection.\");\n                        }\n                        //\u6700\u540e\u518d\u7b49\u7b49\n                        long wt = System.currentTimeMillis();\n                        this.state.wait((long)this.poolTimeToWait);\n                        //\u8981\u662f\u8d85\u8fc7\u7b49\u5f85\u65f6\u95f4\u8fd8\u662f\u6ca1\u7b49\u5230\uff0c\u53ea\u80fd\u653e\u5f03\u4e86\n                        //\u6ce8\u610f\u8fd9\u6837\u7684\u8bddcon\u5c31\u4e3anull\u4e86\n                        var10000 = this.state;\n                        var10000.accumulatedWaitTime += System.currentTimeMillis() - wt;\n                    } catch (InterruptedException var16) {\n                        break;\n                    }\n                }\n            }\n\n            //\u7ecf\u8fc7\u4e4b\u524d\u7684\u64cd\u4f5c\uff0c\u5e76\u4e14\u5df2\u7ecf\u6210\u529f\u5206\u914d\u5230\u8fde\u63a5\u5bf9\u8c61\u7684\u60c5\u51b5\u4e0b\n            if (conn != null) {\n                if (conn.isValid()) {  //\u9996\u5148\u9a8c\u8bc1\u662f\u5426\u6709\u6548\n                    if (!conn.getRealConnection().getAutoCommit()) {  //\u6e05\u7406\u4e4b\u524d\u53ef\u80fd\u5b58\u5728\u7684\u9057\u7559\u4e8b\u52a1\u64cd\u4f5c\n                        conn.getRealConnection().rollback();\n                    }\n\n                    conn.setConnectionTypeCode(this.assembleConnectionTypeCode(this.dataSource.getUrl(), username, password));\n                    conn.setCheckoutTimestamp(System.currentTimeMillis());\n                    conn.setLastUsedTimestamp(System.currentTimeMillis());\n                    //\u6dfb\u52a0\u5230\u6d3b\u8dc3\u8868\u4e2d\n                    this.state.activeConnections.add(conn);\n                    //\u7edf\u8ba1\u4fe1\u606f\uff08\u4e0d\u91cd\u8981\uff09\n                    ++this.state.requestCount;\n                    var10000 = this.state;\n                    var10000.accumulatedRequestTime += System.currentTimeMillis() - t;\n                } else {\n                    //\u65e0\u6548\u7684\u8fde\u63a5\uff0c\u76f4\u63a5\u629b\u5f02\u5e38\n                    if (log.isDebugEnabled()) {\n                        log.debug(\"A bad connection (\" + conn.getRealHashCode() + \") was returned from the pool, getting another connection.\");\n                    }\n\n                    ++this.state.badConnectionCount;\n                    ++localBadConnectionCount;\n                    conn = null;\n                    if (localBadConnectionCount &gt; this.poolMaximumIdleConnections + this.poolMaximumLocalBadConnectionTolerance) {\n                        if (log.isDebugEnabled()) {\n                            log.debug(\"PooledDataSource: Could not get a good connection to the database.\");\n                        }\n\n                        throw new SQLException(\"PooledDataSource: Could not get a good connection to the database.\");\n                    }\n                }\n            }\n        }\n    }\n\n    //\u6700\u540e\u8be5\u5e72\u561b\u5e72\u561b\uff0c\u8981\u662f\u4e4b\u524d\u62ff\u5230\u7684con\u662fnull\u7684\u8bdd\uff0c\u76f4\u63a5\u629b\u5f02\u5e38\n    if (conn == null) {\n        if (log.isDebugEnabled()) {\n            log.debug(\"PooledDataSource: Unknown severe error condition.  The connection pool returned a null connection.\");\n        }\n\n        throw new SQLException(\"PooledDataSource: Unknown severe error condition.  The connection pool returned a null connection.\");\n    } else {\n        return conn;   //\u5426\u5219\u6b63\u5e38\u8fd4\u56de\n    }\n}\n</code></pre> <p>\u7ecf\u8fc7\u4e0a\u9762\u4e00\u987f\u731b\u5982\u864e\u7684\u64cd\u4f5c\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <p>\u5982\u679c\u6700\u540e\u5f97\u5230\u4e86\u8fde\u63a5\u5bf9\u8c61\uff08\u6709\u53ef\u80fd\u662f\u4ece\u7a7a\u95f2\u5217\u8868\u4e2d\u5f97\u5230\uff0c\u6709\u53ef\u80fd\u662f\u76f4\u63a5\u521b\u5efa\u7684\u65b0\u7684\uff0c\u8fd8\u6709\u53ef\u80fd\u662f\u7ecf\u8fc7\u56de\u6536\u7b56\u7565\u56de\u6536\u5f97\u5230\u7684\uff09\uff0c\u90a3\u4e48\u8fde\u63a5(Connection)\u5bf9\u8c61\u4e00\u5b9a\u4f1a\u88ab\u653e\u5728\u6d3b\u8dc3\u5217\u8868\u4e2d(state.activeConnections)</p> <p>\u90a3\u4e48\u80af\u5b9a\u6709\u4e00\u4e2a\u7591\u95ee\uff0c\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u83b7\u53d6\u4e00\u4e2a\u94fe\u63a5\u4f1a\u76f4\u63a5\u8fdb\u5165\u5230\u6d3b\u8dc3\u5217\u8868\u4e2d\uff0c\u90a3\u4e48\uff0c\u5982\u679c\u4e00\u4e2a\u8fde\u63a5\u88ab\u5173\u95ed\uff0c\u53c8\u4f1a\u53d1\u751f\u4ec0\u4e48\u4e8b\u60c5\u5462\uff0c\u6211\u4eec\u6765\u770b\u770b\u6b64\u65b9\u6cd5\u8fd4\u56de\u4e4b\u540e\uff0c\u4f1a\u8c03\u7528<code>getProxyConnection</code>\u6765\u83b7\u53d6\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f<code>PooledConnection</code>\u7c7b\uff1a</p> <pre><code>class PooledConnection implements InvocationHandler {\n  private static final String CLOSE = \"close\";\n    private static final Class&lt;?&gt;[] IFACES = new Class[]{Connection.class};\n    private final int hashCode;\n    //\u4f1a\u8bb0\u5f55\u662f\u6765\u81ea\u54ea\u4e00\u4e2a\u6570\u636e\u6e90\u521b\u5efa\u7684\u7684\n    private final PooledDataSource dataSource;\n    //\u8fde\u63a5\u5bf9\u8c61\u672c\u4f53\n    private final Connection realConnection;\n    //\u4ee3\u7406\u7684\u94fe\u63a5\u5bf9\u8c61\n    private final Connection proxyConnection;\n    ...\n</code></pre> <p>\u5b83\u76f4\u63a5\u4ee3\u7406\u4e86\u6784\u9020\u65b9\u6cd5\u4e2d\u4f20\u5165\u7684Connection\u5bf9\u8c61\uff0c\u4e5f\u662f\u4f7f\u7528JDK\u7684\u52a8\u6001\u4ee3\u7406\u5b9e\u73b0\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff0c\u5b83\u662f\u5982\u4f55\u8fdb\u884c\u4ee3\u7406\u7684\uff1a</p> <pre><code>public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n    String methodName = method.getName();\n    //\u5982\u679c\u8c03\u7528\u7684\u662fConnection\u5bf9\u8c61\u7684close\u65b9\u6cd5\uff0c\n    if (\"close\".equals(methodName)) {\n        //\u8fd9\u91cc\u5e76\u4e0d\u4f1a\u771f\u7684\u5173\u95ed\u8fde\u63a5\uff08\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u7528\u4ee3\u7406\uff09\uff0c\u800c\u662f\u8c03\u7528\u4e4b\u524d\u6570\u636e\u6e90\u7684pushConnection\u65b9\u6cd5\uff0c\u5c06\u6b64\u8fde\u63a5\u6539\u4e3a\u4e3a\u7a7a\u95f2\u72b6\u6001\n        this.dataSource.pushConnection(this);\n        return null;\n    } else {\n        try {\n            if (!Object.class.equals(method.getDeclaringClass())) {\n                this.checkConnection();\n                //\u4efb\u4f55\u64cd\u4f5c\u6267\u884c\u4e4b\u524d\u90fd\u4f1a\u68c0\u67e5\u8fde\u63a5\u662f\u5426\u53ef\u7528\n            }\n\n            //\u539f\u65b9\u6cd5\u8be5\u5e72\u561b\u5e72\u561b\n            return method.invoke(this.realConnection, args);\n        } catch (Throwable var6) {\n            throw ExceptionUtil.unwrapThrowable(var6);\n        }\n    }\n}\n</code></pre> <p>\u8fd9\u4e0b\uff0c\u6c60\u5316\u6570\u636e\u6e90\u7684\u5927\u81f4\u6d41\u7a0b\u5176\u5b9e\u5c31\u5df2\u7ecf\u5f88\u6e05\u6670\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u6700\u540e\u518d\u6765\u770b\u770b<code>pushConnection</code>\u65b9\u6cd5\uff1a</p> <pre><code>protected void pushConnection(PooledConnection conn) throws SQLException {\n    synchronized(this.state) {   //\u8001\u89c4\u77e9\uff0c\u5148\u6765\u628a\u9501\n        //\u5148\u4ece\u6d3b\u8dc3\u5217\u8868\u79fb\u9664\u6b64\u8fde\u63a5\n        this.state.activeConnections.remove(conn);\n        //\u5224\u65ad\u6b64\u94fe\u63a5\u662f\u5426\u53ef\u7528\n        if (conn.isValid()) {\n            PoolState var10000;\n            //\u770b\u770b\u95f2\u7f6e\u5217\u8868\u5bb9\u91cf\u662f\u5426\u5df2\u6ee1\uff08\u5bb9\u91cf\u6ee1\u4e86\u5c31\u56de\u4e0d\u53bb\u4e86\uff09\n            if (this.state.idleConnections.size() &lt; this.poolMaximumIdleConnections &amp;&amp; conn.getConnectionTypeCode() == this.expectedConnectionTypeCode) {\n                var10000 = this.state;\n                var10000.accumulatedCheckoutTime += conn.getCheckoutTime();\n                if (!conn.getRealConnection().getAutoCommit()) {\n                    conn.getRealConnection().rollback();\n                }\n\n                //\u628a\u552f\u4e00\u6709\u7528\u7684Connection\u5bf9\u8c61\u62ff\u51fa\u6765\uff0c\u7136\u540e\u91cd\u65b0\u521b\u5efa\u4e00\u4e2aPooledConnection\u5305\u88c5\n                PooledConnection newConn = new PooledConnection(conn.getRealConnection(), this);\n                //\u653e\u5165\u95f2\u7f6e\u5217\u8868\uff0c\u6210\u529f\u56de\u6536\n                this.state.idleConnections.add(newConn);\n                newConn.setCreatedTimestamp(conn.getCreatedTimestamp());\n                newConn.setLastUsedTimestamp(conn.getLastUsedTimestamp());\n                conn.invalidate();\n                if (log.isDebugEnabled()) {\n                    log.debug(\"Returned connection \" + newConn.getRealHashCode() + \" to pool.\");\n                }\n\n                this.state.notifyAll();\n            } else {\n                var10000 = this.state;\n                var10000.accumulatedCheckoutTime += conn.getCheckoutTime();\n                if (!conn.getRealConnection().getAutoCommit()) {\n                    conn.getRealConnection().rollback();\n                }\n\n                conn.getRealConnection().close();\n                if (log.isDebugEnabled()) {\n                    log.debug(\"Closed connection \" + conn.getRealHashCode() + \".\");\n                }\n\n                conn.invalidate();\n            }\n        } else {\n            if (log.isDebugEnabled()) {\n                log.debug(\"A bad connection (\" + conn.getRealHashCode() + \") attempted to return to the pool, discarding connection.\");\n            }\n\n            ++this.state.badConnectionCount;\n        }\n\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5df2\u7ecf\u5b8c\u5168\u4e86\u89e3\u4e86Mybatis\u7684\u6c60\u5316\u6570\u636e\u6e90\u7684\u6267\u884c\u6d41\u7a0b\u4e86\u3002\u53ea\u4e0d\u8fc7\uff0c\u65e0\u8bbaConnection\u7ba1\u7406\u65b9\u5f0f\u5982\u4f55\u53d8\u6362\uff0c\u65e0\u8bba\u6570\u636e\u6e90\u518d\u9ad8\u7ea7\uff0c\u6211\u4eec\u8981\u77e5\u9053\uff0c\u5b83\u90fd\u6700\u7ec8\u90fd\u4f1a\u4f7f\u7528<code>DriverManager</code>\u6765\u521b\u5efa\u8fde\u63a5\u5bf9\u8c61\uff0c\u800c\u6700\u7ec8\u4f7f\u7528\u7684\u4e5f\u662f<code>DriverManager</code>\u63d0\u4f9b\u7684<code>Connection</code>\u5bf9\u8c61\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#mybatis_1","title":"\u6574\u5408Mybatis\u6846\u67b6","text":"<p>\u901a\u8fc7\u4e86\u89e3\u6570\u636e\u6e90\uff0c\u6211\u4eec\u5df2\u7ecf\u6e05\u695a\uff0cMybatis\u5b9e\u9645\u4e0a\u662f\u5728\u4f7f\u7528\u81ea\u5df1\u7f16\u5199\u7684\u6570\u636e\u6e90\uff08\u6570\u636e\u6e90\u5b9e\u73b0\u5176\u5b9e\u6709\u5f88\u591a\uff0c\u4e4b\u540e\u6211\u4eec\u518d\u804a\u5176\u4ed6\u7684\uff09\u9ed8\u8ba4\u4f7f\u7528\u7684\u662f\u6c60\u5316\u6570\u636e\u6e90\uff0c\u5b83\u9884\u5148\u5b58\u50a8\u4e86\u5f88\u591a\u7684\u8fde\u63a5\u5bf9\u8c61\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff0c\u5982\u4f55\u5c06Mybatis\u4e0eSpring\u66f4\u597d\u7684\u7ed3\u5408\u5462\uff0c\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u5e0c\u671b\u5c06SqlSessionFactory\u4ea4\u7ed9IoC\u5bb9\u5668\u8fdb\u884c\u7ba1\u7406\uff0c\u800c\u4e0d\u662f\u6211\u4eec\u81ea\u5df1\u521b\u5efa\u5de5\u5177\u7c7b\u6765\u7ba1\u7406\uff08\u6211\u4eec\u4e4b\u524d\u4e00\u76f4\u90fd\u5728\u4f7f\u7528\u5de5\u5177\u7c7b\u7ba1\u7406\u548c\u521b\u5efa\u4f1a\u8bdd\uff09</p> <pre><code>&lt;!-- \u8fd9\u4e24\u4e2a\u4f9d\u8d56\u4e0d\u7528\u6211\u8bf4\u4e86\u5427 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;\n    &lt;!-- \u6ce8\u610f\uff0c\u5bf9\u4e8eSpring 6.0\u6765\u8bf4\uff0c\u7248\u672c\u9700\u8981\u57283.5\u4ee5\u4e0a --&gt;\n    &lt;version&gt;3.5.13&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n    &lt;version&gt;8.0.31&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;!-- Mybatis\u9488\u5bf9\u4e8eSpring\u4e13\u95e8\u7f16\u5199\u7684\u652f\u6301\u6846\u67b6 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;\n    &lt;version&gt;3.0.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;!-- Spring\u7684JDBC\u652f\u6301\u6846\u67b6 --&gt;\n&lt;dependency&gt;\n     &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n     &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;\n     &lt;version&gt;6.0.10&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u5728mybatis-spring\u4f9d\u8d56\u4e2d\uff0c\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86SqlSessionTemplate\u7c7b\uff0c\u5b83\u5176\u5b9e\u5c31\u662f\u5b98\u65b9\u5c01\u88c5\u7684\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u6ce8\u518c\u4e3aBean\uff0c\u8fd9\u6837\u6211\u4eec\u968f\u65f6\u90fd\u53ef\u4ee5\u5411IoC\u5bb9\u5668\u7d22\u8981\u5bf9\u8c61\uff0c\u800c\u4e0d\u7528\u81ea\u5df1\u518d\u53bb\u7f16\u5199\u4e00\u4e2a\u5de5\u5177\u7c7b\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u914d\u7f6e\u7c7b\u4e2d\u521b\u5efa\u3002\u5bf9\u4e8e\u8fd9\u79cd\u522b\u4eba\u7f16\u5199\u7684\u7c7b\u578b\uff0c\u5982\u679c\u8981\u6ce8\u518c\u4e3aBean\uff0c\u90a3\u4e48\u53ea\u80fd\u5728\u914d\u7f6e\u7c7b\u4e2d\u5b8c\u6210\uff1a</p> <pre><code>@Configuration\n@ComponentScan(\"org.example.entity\")\npublic class MainConfiguration {\n    //\u6ce8\u518cSqlSessionTemplate\u7684Bean\n    @Bean\n    public SqlSessionTemplate sqlSessionTemplate() throws IOException {\n        SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(Resources.getResourceAsReader(\"mybatis-config.xml\"));\n        return new SqlSessionTemplate(factory);\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u968f\u4fbf\u7f16\u5199\u4e00\u4e2a\u6d4b\u8bd5\u7684Mapper\u7c7b\uff1a</p> <pre><code>@Data\npublic class Student {\n    private int sid;\n    private String name;\n    private String sex;\n}\n</code></pre> <pre><code>public interface TestMapper {\n    @Select(\"select * from student where sid = 1\")\n    Student getStudent();\n}\n</code></pre> <p>\u6700\u540e\u662f\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;!DOCTYPE configuration\n        PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\"\n        \"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;\n&lt;configuration&gt;\n    &lt;environments default=\"development\"&gt;\n        &lt;environment id=\"development\"&gt;\n            &lt;transactionManager type=\"JDBC\"/&gt;\n            &lt;dataSource type=\"POOLED\"&gt;\n                &lt;property name=\"driver\" value=\"com.mysql.cj.jdbc.Driver\"/&gt;\n                &lt;property name=\"url\" value=\"jdbc:mysql://localhost:3306/study\"/&gt;\n                &lt;property name=\"username\" value=\"root\"/&gt;\n                &lt;property name=\"password\" value=\"123456\"/&gt;\n            &lt;/dataSource&gt;\n        &lt;/environment&gt;\n    &lt;/environments&gt;\n    &lt;mappers&gt;\n        &lt;mapper class=\"org.example.mapper.TestMapper\"/&gt;\n    &lt;/mappers&gt;\n&lt;/configuration&gt;\n</code></pre> <p>\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\u5427\uff1a</p> <pre><code>public static void main(String[] args) {\n    ApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class);\n    SqlSessionTemplate template = context.getBean(SqlSessionTemplate.class);\n    TestMapper testMapper = template.getMapper(TestMapper.class);\n    System.out.println(testMapper.getStudent());\n}\n</code></pre> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u6210\u529f\u5c06Mybatis\u4e0eSpring\u5b8c\u6210\u4e86\u521d\u6b65\u6574\u5408\uff0c\u76f4\u63a5\u4ece\u5bb9\u5668\u4e2d\u5c31\u80fd\u83b7\u53d6\u5230SqlSessionTemplate\uff0c\u7ed3\u5408\u81ea\u52a8\u6ce8\u5165\uff0c\u6211\u4eec\u7684\u4ee3\u7801\u91cf\u80fd\u591f\u8fdb\u4e00\u6b65\u7684\u51cf\u5c11\u3002</p> <p>\u867d\u7136\u8fd9\u6837\u5df2\u7ecf\u5f88\u65b9\u4fbf\u4e86\uff0c\u4f46\u662f\u8fd8\u4e0d\u591f\u65b9\u4fbf\uff0c\u6211\u4eec\u4f9d\u7136\u9700\u8981\u624b\u52a8\u53bb\u83b7\u53d6Mapper\u5bf9\u8c61\uff0c\u90a3\u4e48\u80fd\u5426\u76f4\u63a5\u5f97\u5230\u5bf9\u5e94\u7684Mapper\u5bf9\u8c61\u5462\uff0c\u6211\u4eec\u5e0c\u671b\u8ba9Spring\u76f4\u63a5\u5e2e\u52a9\u6211\u4eec\u7ba1\u7406\u6240\u6709\u7684Mapper\uff0c\u5f53\u9700\u8981\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u914d\u7f6e\u7c7b\u4e0a\u65b9\u6dfb\u52a0\u6ce8\u89e3\uff1a</p> <pre><code>@Configuration\n@ComponentScan(\"org.example.entity\")\n@MapperScan(\"org.example.mapper\")\npublic class MainConfiguration {\n</code></pre> <p>\u8fd9\u6837\uff0cMybatis\u5c31\u4f1a\u81ea\u52a8\u626b\u63cf\u5bf9\u5e94\u5305\u4e0b\u6240\u6709\u7684\u63a5\u53e3\uff0c\u5e76\u76f4\u63a5\u88ab\u6ce8\u518c\u4e3a\u5bf9\u5e94\u7684Mapper\u4f5c\u4e3aBean\u7ba1\u7406\uff0c\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u5c31\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u5bb9\u5668\u83b7\u53d6\u4e86\uff1a</p> <pre><code>public static void main(String[] args) {\n    ApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class);\n    TestMapper mapper = context.getBean(TestMapper.class);\n    System.out.println(mapper.getStudent());\n}\n</code></pre> <p>\u5728\u6211\u4eec\u540e\u7eed\u7684SpringBoot\u5b66\u4e60\u9636\u6bb5\uff0c\u4f1a\u6709\u66f4\u52a0\u65b9\u4fbf\u7684\u65b9\u5f0f\u6765\u6ce8\u518cMapper\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4e00\u4e2a<code>@Mapper</code>\u6ce8\u89e3\u5373\u53ef\u5b8c\u6210\uff0c\u975e\u5e38\u7b80\u5355\u3002</p> <p>\u8bf7\u4e00\u5b9a\u6ce8\u610f\uff0c\u5fc5\u987b\u5b58\u5728<code>SqlSessionTemplate</code>\u6216\u662f<code>SqlSessionFactoryBean</code>\u7684Bean\uff0c\u5426\u5219\u4f1a\u65e0\u6cd5\u521d\u59cb\u5316\uff08\u6bd5\u7adf\u8981\u6570\u636e\u5e93\u7684\u94fe\u63a5\u4fe1\u606f\uff09\u6211\u4eec\u63a5\u7740\u6765\u770b\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u76f4\u63a5\u53bb\u9664Mybatis\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5b8c\u5168\u5b9e\u73b0\u5168\u6ce8\u89e3\u914d\u7f6e\uff0c\u90a3\u4e48\u6539\u600e\u4e48\u53bb\u5b9e\u73b0\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>SqlSessionFactoryBean</code>\u7c7b\uff1a</p> <pre><code>@Configuration\n@ComponentScan(\"org.example.entity\")\n@MapperScan(\"org.example.mapper\")\npublic class MainConfiguration {\n    @Bean   //\u5355\u72ec\u521b\u5efa\u4e00\u4e2aBean\uff0c\u65b9\u4fbf\u4e4b\u540e\u66f4\u6362\n    public DataSource dataSource(){\n        return new PooledDataSource(\"com.mysql.cj.jdbc.Driver\",\n                \"jdbc:mysql://localhost:3306/study\", \"root\", \"123456\");\n    }\n\n    @Bean\n    public SqlSessionFactoryBean sqlSessionFactoryBean(DataSource dataSource){  //\u76f4\u63a5\u53c2\u6570\u5f97\u5230Bean\u5bf9\u8c61\n        SqlSessionFactoryBean bean = new SqlSessionFactoryBean();\n        bean.setDataSource(dataSource);\n        return bean;\n    }\n}\n</code></pre> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u6570\u636e\u6e90\u7684\u5b9e\u73b0\u7c7b\uff0c\u56e0\u4e3a\u8fd9\u662f\u6570\u636e\u5e93\u6700\u57fa\u672c\u7684\u4fe1\u606f\uff0c\u7136\u540e\u518d\u7ed9\u5230<code>SqlSessionFactoryBean</code>\u5b9e\u4f8b\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u76f8\u5f53\u4e8e\u76f4\u63a5\u5728\u4e00\u5f00\u59cb\u901a\u8fc7IoC\u5bb9\u5668\u914d\u7f6e\u4e86<code>SqlSessionFactory</code>\uff0c\u8fd9\u91cc\u53ea\u9700\u8981\u4f20\u5165\u4e00\u4e2a<code>DataSource</code>\u7684\u5b9e\u73b0\u5373\u53ef\uff0c\u6211\u4eec\u91c7\u7528\u6c60\u5316\u6570\u636e\u6e90\u3002</p> <p>\u5220\u9664\u914d\u7f6e\u6587\u4ef6\uff0c\u91cd\u65b0\u518d\u6765\u8fd0\u884c\uff0c\u540c\u6837\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528Mapper\u3002\u4ece\u8fd9\u91cc\u5f00\u59cb\uff0c\u901a\u8fc7IoC\u5bb9\u5668\uff0cMybatis\u5df2\u7ecf\u4e0d\u518d\u9700\u8981\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u4e86\uff0c\u5728\u6211\u4eec\u4e4b\u540e\u7684\u5b66\u4e60\u4e2d\uff0c\u57fa\u4e8eSpring\u7684\u5f00\u53d1\u5c06\u4e0d\u4f1a\u518d\u51fa\u73b0Mybatis\u7684\u914d\u7f6e\u6587\u4ef6\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#hikaricp","title":"\u4f7f\u7528HikariCP\u8fde\u63a5\u6c60","text":"<p>\u524d\u9762\u6211\u4eec\u63d0\u5230\u4e86\u6570\u636e\u6e90\u8fd8\u6709\u5176\u4ed6\u5b9e\u73b0\uff0c\u6bd4\u5982C3P0\u3001Druid\u7b49\uff0c\u5b83\u4eec\u90fd\u662f\u975e\u5e38\u4f18\u79c0\u7684\u6570\u636e\u6e90\u5b9e\u73b0\uff08\u53ef\u4ee5\u81ea\u884c\u4e86\u89e3\uff09\uff0c\u4e0d\u8fc7\u6211\u4eec\u8fd9\u91cc\u8981\u4ecb\u7ecd\u7684\uff0c\u662f\u4e4b\u540e\u5728SpringBoot\u4e2d\u8fd8\u4f1a\u9047\u5230\u7684HikariCP\u8fde\u63a5\u6c60\u3002</p> <p>HikariCP\u662f\u7531\u65e5\u672c\u7a0b\u5e8f\u5458\u5f00\u6e90\u7684\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7ec4\u4ef6\uff0c\u4ee3\u7801\u975e\u5e38\u8f7b\u91cf\uff0c\u5e76\u4e14\u901f\u5ea6\u975e\u5e38\u7684\u5feb\u3002\u6839\u636e\u5b98\u65b9\u63d0\u4f9b\u7684\u6570\u636e\uff0c\u5728\u9177\u777fi7\u5f00\u542f32\u4e2a\u7ebf\u7a0b32\u4e2a\u8fde\u63a5\u7684\u60c5\u51b5\u4e0b\uff0c\u8fdb\u884c\u968f\u673a\u6570\u636e\u5e93\u8bfb\u5199\u64cd\u4f5c\uff0cHikariCP\u7684\u901f\u5ea6\u662f\u73b0\u5728\u5e38\u7528\u7684C3P0\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u6570\u767e\u500d\u3002\u5728SpringBoot 3.0\u4e2d\uff0c\u5b98\u65b9\u4e5f\u662f\u63a8\u8350\u4f7f\u7528HikariCP\u3002</p> <p></p> <p>\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5bfc\u5165\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.zaxxer&lt;/groupId&gt;\n    &lt;artifactId&gt;HikariCP&lt;/artifactId&gt;\n    &lt;version&gt;5.0.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u8981\u66f4\u6362\u6570\u636e\u6e90\u5b9e\u73b0\uff0c\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u58f0\u660e\u4e00\u4e2aBean\uff1a</p> <pre><code>@Bean\npublic DataSource dataSource() {\n    HikariDataSource dataSource = new HikariDataSource();\n    dataSource.setJdbcUrl(\"jdbc:mysql://localhost:3306/study\");\n    dataSource.setDriverClassName(\"com.mysql.cj.jdbc.Driver\");\n    dataSource.setUsername(\"root\");\n    dataSource.setPassword(\"123456\");\n    return dataSource;\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u540c\u6837\u53ef\u4ee5\u5f97\u5230\u8f93\u51fa\u7ed3\u679c\uff0c\u4f46\u662f\u51fa\u73b0\u4e86\u4e00\u4e2a\u62a5\u9519\uff1a</p> <pre><code>SLF4J: No SLF4J providers were found.\nSLF4J: Defaulting to no-operation (NOP) logger implementation\nSLF4J: See http://www.slf4j.org/codes.html#noProviders for further details.\n</code></pre> <p>\u6b64\u6570\u636e\u6e90\u5b9e\u9645\u4e0a\u662f\u91c7\u7528\u4e86SLF4J\u65e5\u5fd7\u6846\u67b6\u6253\u5370\u65e5\u5fd7\u4fe1\u606f\uff0c\u4f46\u662f\u73b0\u5728\u6ca1\u6709\u4efb\u4f55\u7684\u65e5\u5fd7\u5b9e\u73b0\uff08slf4j\u53ea\u662f\u4e00\u4e2aAPI\u6807\u51c6\uff0c\u5b83\u89c4\u8303\u4e86\u591a\u79cd\u65e5\u5fd7\u6846\u67b6\u7684\u64cd\u4f5c\uff0c\u7edf\u4e00\u4f7f\u7528SLF4J\u5b9a\u4e49\u7684\u65b9\u6cd5\u6765\u64cd\u4f5c\u4e0d\u540c\u7684\u65e5\u5fd7\u6846\u67b6\uff0c\u6211\u4eec\u4f1a\u5728SpringBoot\u7bc7\u8fdb\u884c\u8be6\u7ec6\u4ecb\u7ecd\uff09\u6211\u4eec\u8fd9\u91cc\u5c31\u4f7f\u7528JUL\u4f5c\u4e3a\u65e5\u5fd7\u5b9e\u73b0\uff0c\u6211\u4eec\u9700\u8981\u5bfc\u5165\u53e6\u4e00\u4e2a\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n    &lt;artifactId&gt;slf4j-jdk14&lt;/artifactId&gt;\n    &lt;version&gt;1.7.25&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6ce8\u610f\u7248\u672c\u4e00\u5b9a\u8981\u548c<code>slf4j-api</code>\u4fdd\u6301\u4e00\u81f4\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8fd9\u91cc\u76f4\u63a5\u67e5\u770b\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0cHikariCP\u6570\u636e\u6e90\u7684\u542f\u52a8\u65e5\u5fd7\u5c31\u53ef\u4ee5\u6b63\u5e38\u6253\u5370\u51fa\u6765\u4e86\uff1a</p> <pre><code>12\u6708 17, 2022 3:41:38 \u4e0b\u5348 com.zaxxer.hikari.HikariDataSource getConnection\n\u4fe1\u606f: HikariPool-1 - Starting...\n12\u6708 17, 2022 3:41:38 \u4e0b\u5348 com.zaxxer.hikari.pool.HikariPool checkFailFast\n\u4fe1\u606f: HikariPool-1 - Added connection com.mysql.cj.jdbc.ConnectionImpl@4f8969b0\n12\u6708 17, 2022 3:41:38 \u4e0b\u5348 com.zaxxer.hikari.HikariDataSource getConnection\n\u4fe1\u606f: HikariPool-1 - Start completed.\nStudent(sid=1, name=\u5c0f\u660e, sex=\u7537)\n</code></pre> <p>\u5728SpringBoot\u9636\u6bb5\uff0c\u6211\u4eec\u8fd8\u4f1a\u9047\u5230<code>HikariPool-1 - Starting...</code>\u548c<code>HikariPool-1 - Start completed.</code>\u540c\u6b3e\u65e5\u5fd7\u4fe1\u606f\u3002</p> <p>\u5f53\u7136\uff0cLombok\u80af\u5b9a\u4e5f\u662f\u652f\u6301\u8fd9\u4e2a\u65e5\u5fd7\u6846\u67b6\u5feb\u901f\u6ce8\u89e3\u7684\uff1a</p> <pre><code>@Slf4j\npublic class Main {\n    public static void main(String[] args) {\n        ApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class);\n        TestMapper mapper = context.getBean(TestMapper.class);\n        log.info(mapper.getStudent().toString());\n    }\n}\n</code></pre> <p>\u662f\u4e0d\u662f\u611f\u89c9\u7279\u522b\u65b9\u4fbf\uff1f</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#mybatis_2","title":"Mybatis\u4e8b\u52a1\u7ba1\u7406","text":"<p>\u6211\u4eec\u524d\u9762\u5df2\u7ecf\u8bb2\u89e3\u4e86\u5982\u4f55\u8ba9Mybatis\u4e0eSpring\u66f4\u597d\u5730\u878d\u5408\u5728\u4e00\u8d77\uff0c\u901a\u8fc7\u5c06\u5bf9\u5e94\u7684Bean\u7c7b\u578b\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d\uff0c\u5c31\u80fd\u66f4\u52a0\u65b9\u4fbf\u7684\u53bb\u4f7f\u7528Mapper\uff0c\u90a3\u4e48\u73b0\u5728\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770bSpring\u7684\u4e8b\u52a1\u63a7\u5236\u3002</p> <p>\u5728\u5f00\u59cb\u4e4b\u524d\uff0c\u6211\u4eec\u8fd8\u662f\u56de\u987e\u4e00\u4e0b\u4e8b\u52a1\u673a\u5236\u3002\u9996\u5148\u4e8b\u52a1\u9075\u5faa\u4e00\u4e2aACID\u539f\u5219\uff1a</p> <ul> <li>\u539f\u5b50\u6027\uff08Atomicity\uff09\uff1a\u4e8b\u52a1\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\uff0c\u7531\u4e00\u7cfb\u5217\u52a8\u4f5c\u7ec4\u6210\u3002\u4e8b\u52a1\u7684\u539f\u5b50\u6027\u786e\u4fdd\u52a8\u4f5c\u8981\u4e48\u5168\u90e8\u5b8c\u6210\uff0c\u8981\u4e48\u5b8c\u5168\u4e0d\u8d77\u4f5c\u7528\u3002</li> <li>\u4e00\u81f4\u6027\uff08Consistency\uff09\uff1a\u4e00\u65e6\u4e8b\u52a1\u5b8c\u6210\uff08\u4e0d\u7ba1\u6210\u529f\u8fd8\u662f\u5931\u8d25\uff09\uff0c\u7cfb\u7edf\u5fc5\u987b\u786e\u4fdd\u5b83\u6240\u5efa\u6a21\u7684\u4e1a\u52a1\u5904\u4e8e\u4e00\u81f4\u7684\u72b6\u6001\uff0c\u800c\u4e0d\u4f1a\u662f\u90e8\u5206\u5b8c\u6210\u90e8\u5206\u5931\u8d25\u3002\u5728\u73b0\u5b9e\u4e2d\u7684\u6570\u636e\u4e0d\u5e94\u8be5\u88ab\u7834\u574f\u3002\u7c7b\u6bd4\u94f6\u884c\u8f6c\u8d26\uff0c\u4ece\u4e00\u4e2a\u8d26\u53f7\u6263\u6b3e\uff0c\u53e6\u4e00\u4e2a\u8d26\u53f7\u589e\u6b3e\uff0c\u5fc5\u987b\u4fdd\u8bc1\u603b\u91d1\u989d\u4e0d\u53d8\u3002</li> <li>\u9694\u79bb\u6027\uff08Isolation\uff09\uff1a\u53ef\u80fd\u6709\u8bb8\u591a\u4e8b\u52a1\u4f1a\u540c\u65f6\u5904\u7406\u76f8\u540c\u7684\u6570\u636e\uff0c\u56e0\u6b64\u6bcf\u4e2a\u4e8b\u52a1\u90fd\u5e94\u8be5\u4e0e\u5176\u4ed6\u4e8b\u52a1\u9694\u79bb\u5f00\u6765\uff0c\u9632\u6b62\u6570\u636e\u635f\u574f\u3002\u7c7b\u6bd4\u591a\u4e2a\u4eba\u540c\u65f6\u7f16\u8f91\u540c\u4e00\u6587\u6863\uff0c\u6bcf\u4e2a\u4eba\u770b\u5230\u7684\u7ed3\u679c\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u4e0d\u4f1a\u53d7\u5176\u4ed6\u4eba\u7684\u5f71\u54cd\uff0c\u4e0d\u8fc7\u96be\u514d\u4f1a\u5b58\u5728\u51b2\u7a81\u3002</li> <li>\u6301\u4e45\u6027\uff08Durability\uff09\uff1a\u4e00\u65e6\u4e8b\u52a1\u5b8c\u6210\uff0c\u65e0\u8bba\u53d1\u751f\u4ec0\u4e48\u7cfb\u7edf\u9519\u8bef\uff0c\u5b83\u7684\u7ed3\u679c\u90fd\u4e0d\u5e94\u8be5\u53d7\u5230\u5f71\u54cd\uff0c\u8fd9\u6837\u5c31\u80fd\u4ece\u4efb\u4f55\u7cfb\u7edf\u5d29\u6e83\u4e2d\u6062\u590d\u8fc7\u6765\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u4e8b\u52a1\u7684\u7ed3\u679c\u88ab\u5199\u5230\u6301\u4e45\u5316\u5b58\u50a8\u5668\u4e2d\u3002\u7c7b\u6bd4\u5199\u5165\u786c\u76d8\u7684\u6587\u4ef6\uff0c\u5373\u4f7f\u5173\u673a\u91cd\u542f\uff0c\u6587\u4ef6\u4ecd\u7136\u5b58\u5728\u3002</li> </ul> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u4e8b\u52a1\u5c31\u662f\u8981\u4e48\u5b8c\u6210\uff0c\u8981\u4e48\u5c31\u5565\u90fd\u522b\u505a\uff01\u5e76\u4e14\u4e0d\u540c\u7684\u4e8b\u52a1\u4e4b\u95f4\u76f8\u4e92\u9694\u79bb\uff0c\u4e92\u4e0d\u5e72\u6270\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u63a5\u7740\u6765\u6df1\u5165\u4e86\u89e3\u4e00\u4e0b\u4e8b\u52a1\u7684\u9694\u79bb\u673a\u5236\uff08\u5728\u4e4b\u524d\u6570\u636e\u5e93\u5165\u95e8\u9636\u6bb5\u5e76\u6ca1\u6709\u63d0\u5230\uff09\u6211\u4eec\u8bf4\u4e86\uff0c\u4e8b\u52a1\u4e4b\u95f4\u662f\u76f8\u4e92\u9694\u79bb\u4e92\u4e0d\u5e72\u6270\u7684\uff0c\u90a3\u4e48\u5982\u679c\u51fa\u73b0\u4e86\u4e0b\u9762\u7684\u60c5\u51b5\uff0c\u4f1a\u600e\u4e48\u6837\u5462\uff1a</p> <p>\u5f53\u4e24\u4e2a\u4e8b\u52a1\u540c\u65f6\u5728\u6267\u884c\uff0c\u5e76\u4e14\u540c\u65f6\u5728\u64cd\u4f5c\u540c\u4e00\u4e2a\u6570\u636e\uff0c\u8fd9\u6837\u5f88\u5bb9\u6613\u51fa\u73b0\u5e76\u53d1\u76f8\u5173\u7684\u95ee\u9898\uff0c\u6bd4\u5982\u4e00\u4e2a\u4e8b\u52a1\u5148\u8bfb\u53d6\u4e86\u67d0\u6761\u6570\u636e\uff0c\u800c\u53e6\u4e00\u4e2a\u4e8b\u52a1\u6b64\u65f6\u4fee\u6539\u4e86\u6b64\u6570\u636e\uff0c\u5f53\u524d\u4e00\u4e2a\u4e8b\u52a1\u7d27\u63a5\u7740\u518d\u6b21\u8bfb\u53d6\u65f6\uff0c\u4f1a\u5bfc\u81f4\u548c\u524d\u4e00\u6b21\u8bfb\u53d6\u7684\u6570\u636e\u4e0d\u4e00\u81f4\uff0c\u8fd9\u5c31\u662f\u4e00\u79cd\u5178\u578b\u7684\u6570\u636e\u865a\u8bfb\u73b0\u8c61\u3002</p> <p>\u56e0\u6b64\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0c\u4e8b\u52a1\u4e4b\u95f4\u5b9e\u9645\u4e0a\u662f\u5b58\u5728\u4e00\u4e9b\u9694\u79bb\u7ea7\u522b\u7684\uff1a</p> <ul> <li>ISOLATION_READ_UNCOMMITTED\uff08\u8bfb\u672a\u63d0\u4ea4\uff09\uff1a\u5176\u4ed6\u4e8b\u52a1\u4f1a\u8bfb\u53d6\u5f53\u524d\u4e8b\u52a1\u5c1a\u672a\u66f4\u6539\u7684\u63d0\u4ea4\uff08\u76f8\u5f53\u4e8e\u8bfb\u53d6\u7684\u662f\u8fd9\u4e2a\u4e8b\u52a1\u6682\u65f6\u7f13\u5b58\u7684\u5185\u5bb9\uff0c\u5e76\u4e0d\u662f\u6570\u636e\u5e93\u4e2d\u7684\u5185\u5bb9\uff09</li> <li>ISOLATION_READ_COMMITTED\uff08\u8bfb\u5df2\u63d0\u4ea4\uff09\uff1a\u5176\u4ed6\u4e8b\u52a1\u4f1a\u8bfb\u53d6\u5f53\u524d\u4e8b\u52a1\u5df2\u7ecf\u63d0\u4ea4\u7684\u6570\u636e\uff08\u4e5f\u5c31\u662f\u76f4\u63a5\u8bfb\u53d6\u6570\u636e\u5e93\u4e2d\u5df2\u7ecf\u53d1\u751f\u66f4\u6539\u7684\u5185\u5bb9\uff09</li> <li>ISOLATION_REPEATABLE_READ\uff08\u53ef\u91cd\u590d\u8bfb\uff09\uff1a\u5176\u4ed6\u4e8b\u52a1\u4f1a\u8bfb\u53d6\u5f53\u524d\u4e8b\u52a1\u5df2\u7ecf\u63d0\u4ea4\u7684\u6570\u636e\u5e76\u4e14\u5176\u4ed6\u4e8b\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e0d\u5141\u8bb8\u518d\u8fdb\u884c\u6570\u636e\u4fee\u6539\uff08\u6ce8\u610f\u8fd9\u91cc\u4ec5\u4ec5\u662f\u4e0d\u5141\u8bb8\u4fee\u6539\u6570\u636e\uff09</li> <li>ISOLATION_SERIALIZABLE\uff08\u4e32\u884c\u5316\uff09\uff1a\u5b83\u5b8c\u5168\u670d\u4eceACID\u539f\u5219\uff0c\u4e00\u4e2a\u4e8b\u52a1\u5fc5\u987b\u7b49\u5f85\u5176\u4ed6\u4e8b\u52a1\u7ed3\u675f\u4e4b\u540e\u624d\u80fd\u5f00\u59cb\u6267\u884c\uff0c\u76f8\u5f53\u4e8e\u6328\u4e2a\u6267\u884c\uff0c\u6548\u7387\u5f88\u4f4e</li> </ul> <p>\u6211\u4eec\u4f9d\u6b21\u6765\u770b\u770b\uff0c\u4e0d\u540c\u7684\u9694\u79bb\u7ea7\u522b\u4f1a\u5bfc\u81f4\u4ec0\u4e48\u95ee\u9898\u3002\u9996\u5148\u662f<code>\u8bfb\u672a\u63d0\u4ea4</code>\u7ea7\u522b\uff0c\u6b64\u7ea7\u522b\u5c5e\u4e8e\u6700\u4f4e\u7ea7\u522b\uff0c\u76f8\u5f53\u4e8e\u5404\u4e2a\u4e8b\u52a1\u5171\u4eab\u4e00\u4e2a\u7f13\u5b58\u533a\u57df\uff0c\u4efb\u4f55\u4e8b\u52a1\u7684\u64cd\u4f5c\u90fd\u5728\u8fd9\u91cc\u8fdb\u884c\u3002\u90a3\u4e48\u5b83\u4f1a\u5bfc\u81f4\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <p></p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e8b\u52a1A\u6700\u540e\u5f97\u5230\u7684\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u6beb\u65e0\u610f\u4e49\u7684\u6570\u636e\uff08\u4e8b\u52a1B\u5df2\u7ecf\u56de\u6eda\u4e86\uff09\u6211\u4eec\u79f0\u6b64\u6570\u636e\u4e3a\"\u810f\u6570\u636e\"\uff0c\u8fd9\u79cd\u73b0\u8c61\u79f0\u4e3a\u810f\u8bfb</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b<code>\u8bfb\u5df2\u63d0\u4ea4</code>\u7ea7\u522b\uff0c\u4e8b\u52a1\u53ea\u80fd\u8bfb\u53d6\u5176\u4ed6\u4e8b\u52a1\u5df2\u7ecf\u63d0\u4ea4\u7684\u5185\u5bb9\uff0c\u76f8\u5f53\u4e8e\u76f4\u63a5\u4ece\u6570\u636e\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u810f\u8bfb\u95ee\u9898\u4e86\uff0c\u4f46\u662f\u5b83\u8fd8\u662f\u5b58\u5728\u4ee5\u4e0b\u95ee\u9898\uff1a</p> <p></p> <p>\u8fd9\u6b63\u662f\u6211\u4eec\u524d\u9762\u4f8b\u5b50\u4e2d\u63d0\u5230\u7684\u95ee\u9898\uff0c\u867d\u7136\u5b83\u907f\u514d\u4e86\u810f\u8bfb\u95ee\u9898\uff0c\u4f46\u662f\u5982\u679c\u4e8b\u4ef6B\u4fee\u6539\u5e76\u63d0\u4ea4\u4e86\u6570\u636e\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u4e8b\u52a1A\u4e4b\u524d\u8bfb\u53d6\u5230\u7684\u6570\u636e\u4f9d\u7136\u4e0d\u662f\u6700\u65b0\u7684\u6570\u636e\uff0c\u76f4\u63a5\u5bfc\u81f4\u4e24\u6b21\u8bfb\u53d6\u7684\u6570\u636e\u4e0d\u4e00\u81f4\uff0c\u8fd9\u79cd\u73b0\u8c61\u79f0\u4e3a\u865a\u8bfb\u4e5f\u53ef\u4ee5\u79f0\u4e3a\u4e0d\u53ef\u91cd\u590d\u8bfb</p> <p>\u56e0\u6b64\uff0c\u4e0b\u4e00\u4e2a\u9694\u79bb\u7ea7\u522b<code>\u53ef\u91cd\u590d\u8bfb</code>\u5c31\u80fd\u591f\u89e3\u51b3\u8fd9\u6837\u7684\u95ee\u9898\uff08MySQL\u7684\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b\uff09\uff0c\u5b83\u89c4\u5b9a\u5728\u5176\u4ed6\u4e8b\u52a1\u6267\u884c\u65f6\uff0c\u4e0d\u5141\u8bb8\u4fee\u6539\u6570\u636e\uff0c\u8fd9\u6837\uff0c\u5c31\u53ef\u4ee5\u6709\u6548\u5730\u907f\u514d\u4e0d\u53ef\u91cd\u590d\u8bfb\u7684\u95ee\u9898\uff0c\u4f46\u662f\u8fd9\u6837\u5c31\u4e00\u5b9a\u5b89\u5168\u4e86\u5417\uff1f\u8fd9\u91cc\u4ec5\u4ec5\u662f\u7981\u6b62\u4e86\u4e8b\u52a1\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684UPDATE\u64cd\u4f5c\uff0c\u4f46\u662f\u5b83\u5e76\u6ca1\u6709\u7981\u6b62INSERT\u8fd9\u7c7b\u64cd\u4f5c\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u4e8b\u52a1A\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e8b\u52a1B\u63d2\u5165\u4e86\u65b0\u7684\u6570\u636e\uff0c\u90a3\u4e48A\u8fd9\u65f6\u662f\u6beb\u4e0d\u77e5\u60c5\u7684\uff0c\u6bd4\u5982\uff1a</p> <p></p> <p>\u4e24\u4e2a\u4eba\u540c\u65f6\u62a5\u540d\u4e00\u4e2a\u6d3b\u52a8\uff0c\u4e24\u4e2a\u62a5\u540d\u7684\u4e8b\u52a1\u540c\u65f6\u5728\u8fdb\u884c\uff0c\u4f46\u662f\u4ed6\u4eec\u4e00\u5f00\u59cb\u8bfb\u53d6\u5230\u7684\u4eba\u6570\u90fd\u662f5\uff0c\u800c\u8fd9\u65f6\uff0c\u5b83\u4eec\u90fd\u4f1a\u8ba4\u4e3a\u62a5\u540d\u6210\u529f\u540e\u4eba\u6570\u5e94\u8be5\u53d8\u62106\uff0c\u800c\u6b63\u5e38\u60c5\u51b5\u4e0b\u5e94\u8be5\u662f7\uff0c\u56e0\u6b64\u8fd9\u4e2a\u65f6\u5019\u5c31\u53d1\u751f\u4e86\u6570\u636e\u7684\u5e7b\u8bfb\u73b0\u8c61\u3002</p> <p>\u56e0\u6b64\uff0c\u8981\u89e3\u51b3\u8fd9\u79cd\u95ee\u9898\uff0c\u53ea\u80fd\u4f7f\u7528\u6700\u540e\u4e00\u79cd\u9694\u79bb\u7ea7\u522b<code>\u4e32\u884c\u5316</code>\u6765\u5b9e\u73b0\u4e86\uff0c\u6bcf\u4e2a\u4e8b\u52a1\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c\uff0c\u76f4\u63a5\u907f\u514d\u6240\u6709\u5e76\u53d1\u95ee\u9898\uff0c\u7b80\u5355\u7c97\u66b4\uff0c\u4f46\u662f\u6548\u7387\u7206\u51cf\uff0c\u5e76\u4e0d\u63a8\u8350\u3002</p> <p>\u6700\u540e\u603b\u7ed3\u4e09\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>\u810f\u8bfb\uff1a\u8bfb\u53d6\u5230\u4e86\u88ab\u56de\u6eda\u7684\u6570\u636e\uff0c\u5b83\u6beb\u65e0\u610f\u4e49\u3002</li> <li>\u865a\u8bfb\uff08\u4e0d\u53ef\u91cd\u590d\u8bfb\uff09\uff1a\u7531\u4e8e\u5176\u4ed6\u4e8b\u52a1\u66f4\u65b0\u6570\u636e\uff0c\u4e24\u6b21\u8bfb\u53d6\u7684\u6570\u636e\u4e0d\u4e00\u81f4\u3002</li> <li>\u5e7b\u8bfb\uff1a\u7531\u4e8e\u5176\u4ed6\u4e8b\u52a1\u6267\u884c\u63d2\u5165\u5220\u9664\u64cd\u4f5c\uff0c\u800c\u53c8\u65e0\u6cd5\u611f\u77e5\u5230\u8868\u4e2d\u8bb0\u5f55\u6761\u6570\u53d1\u751f\u53d8\u5316\uff0c\u5f53\u4e0b\u6b21\u518d\u8bfb\u53d6\u65f6\u4f1a\u83ab\u540d\u5176\u5999\u591a\u51fa\u6216\u7f3a\u5931\u6570\u636e\uff0c\u5c31\u50cf\u4ea7\u751f\u5e7b\u89c9\u4e00\u6837\u3002</li> </ul> <p>\uff08\u5bf9\u4e8e\u865a\u8bfb\u548c\u5e7b\u8bfb\u7684\u533a\u5206\uff1a\u865a\u8bfb\u662f\u67d0\u4e2a\u6570\u636e\u524d\u540e\u8bfb\u53d6\u4e0d\u4e00\u81f4\uff0c\u5e7b\u8bfb\u662f\u6574\u4e2a\u8868\u7684\u8bb0\u5f55\u6570\u91cf\u524d\u540e\u8bfb\u53d6\u4e0d\u4e00\u81f4</p> <p>\u6700\u540e\u8fd9\u5f20\u56fe\uff0c\u8bf7\u52a1\u5fc5\u8bb0\u5728\u4f60\u7684\u8111\u6d77\uff0c\u8bb0\u5728\u4f60\u7684\u5fc3\u4e2d\uff1a</p> <p></p> <p>Mybatis\u5bf9\u4e8e\u6570\u636e\u5e93\u7684\u4e8b\u52a1\u7ba1\u7406\uff0c\u4e5f\u6709\u7740\u76f8\u5e94\u7684\u5c01\u88c5\u3002\u4e00\u4e2a\u4e8b\u52a1\u65e0\u975e\u5c31\u662f\u521b\u5efa\u3001\u63d0\u4ea4\u3001\u56de\u6eda\u3001\u5173\u95ed\uff0c\u56e0\u6b64\u8fd9\u4e9b\u64cd\u4f5c\u88abMybatis\u62bd\u8c61\u4e3a\u4e00\u4e2a\u63a5\u53e3\uff1a</p> <pre><code>public interface Transaction {\n    Connection getConnection() throws SQLException;\n\n    void commit() throws SQLException;\n\n    void rollback() throws SQLException;\n\n    void close() throws SQLException;\n\n    Integer getTimeout() throws SQLException;\n}\n</code></pre> <p>\u5bf9\u4e8e\u6b64\u63a5\u53e3\u7684\u5b9e\u73b0\uff0cMyBatis\u7684\u4e8b\u52a1\u7ba1\u7406\u5206\u4e3a\u4e24\u79cd\u5f62\u5f0f\uff1a</p> <ol> <li>\u4f7f\u7528JDBC\u7684\u4e8b\u52a1\u7ba1\u7406\u673a\u5236\uff1a\u5373\u5229\u7528\u5bf9\u5e94\u6570\u636e\u5e93\u7684\u9a71\u52a8\u751f\u6210\u7684<code>Connection</code>\u5bf9\u8c61\u5b8c\u6210\u5bf9\u4e8b\u52a1\u7684\u63d0\u4ea4\uff08commit()\uff09\u3001\u56de\u6eda\uff08rollback()\uff09\u3001\u5173\u95ed\uff08close()\uff09\u7b49\uff0c\u5bf9\u5e94\u7684\u5b9e\u73b0\u7c7b\u4e3a<code>JdbcTransaction</code></li> <li>\u4f7f\u7528MANAGED\u7684\u4e8b\u52a1\u7ba1\u7406\u673a\u5236\uff1a\u8fd9\u79cd\u673a\u5236MyBatis\u81ea\u8eab\u4e0d\u4f1a\u53bb\u5b9e\u73b0\u4e8b\u52a1\u7ba1\u7406\uff0c\u800c\u662f\u8ba9\u7a0b\u5e8f\u7684\u5bb9\u5668\uff08\u6bd4\u5982Spring\uff09\u6765\u5b9e\u73b0\u5bf9\u4e8b\u52a1\u7684\u7ba1\u7406\uff0c\u5bf9\u5e94\u7684\u5b9e\u73b0\u7c7b\u4e3a<code>ManagedTransaction</code></li> <li>\u5982\u679c\u9700\u8981\u81ea\u5b9a\u4e49\uff0c\u90a3\u4e48\u5f97\u5b9e\u73b0<code>org.apache.ibatis.transaction.Transaction</code>\u63a5\u53e3\uff0c\u7136\u540e\u5728<code>type</code>\u5c5e\u6027\u4e2d\u6307\u5b9a\u5176\u7c7b\u540d\u3002\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u4e8b\u52a1\u7ba1\u7406\u5668\u53ef\u4ee5\u6839\u636e\u5177\u4f53\u9700\u6c42\u6765\u5b9e\u73b0\u4e00\u4e9b\u7279\u5b9a\u7684\u4e8b\u52a1\u7ba1\u7406\u884c\u4e3a\u3002</li> </ol> <p>\u800c\u6211\u4eec\u4e4b\u524d\u4e00\u76f4\u4f7f\u7528\u7684\u5176\u5b9e\u5c31\u662fJDBC\u7684\u4e8b\u52a1\uff0c\u76f8\u5f53\u4e8e\u76f4\u63a5\u4f7f\u7528<code>Connection</code>\u5bf9\u8c61\uff08\u4e4b\u524dJavaWeb\u9636\u6bb5\u5df2\u7ecf\u8bb2\u89e3\u8fc7\u4e86\uff09\u5728\u8fdb\u884c\u4e8b\u52a1\u64cd\u4f5c\uff0c\u5e76\u6ca1\u6709\u989d\u5916\u7684\u7ba1\u7406\u673a\u5236\uff0c\u5bf9\u5e94\u7684\u914d\u7f6e\u4e3a\uff1a</p> <pre><code>&lt;transactionManager type=\"JDBC\"/&gt;\n</code></pre> <p>\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770b<code>JdbcTransaction</code>\u662f\u4e0d\u662f\u50cf\u6211\u4eec\u4e0a\u9762\u6240\u8bf4\u7684\u90a3\u6837\u7ba1\u7406\u4e8b\u52a1\u7684\uff0c\u76f4\u63a5\u4e0a\u6e90\u7801\uff1a</p> <pre><code>public class JdbcTransaction implements Transaction {\n    private static final Log log = LogFactory.getLog(JdbcTransaction.class);\n    protected Connection connection;\n    protected DataSource dataSource;\n    protected TransactionIsolationLevel level;\n    protected boolean autoCommit;\n\n    public JdbcTransaction(DataSource ds, TransactionIsolationLevel desiredLevel, boolean desiredAutoCommit) {\n        //\u6570\u636e\u6e90\n        this.dataSource = ds;\n        //\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0c\u4e0a\u9762\u5df2\u7ecf\u63d0\u5230\u8fc7\u4e86\n        this.level = desiredLevel;\n        //\u662f\u5426\u81ea\u52a8\u63d0\u4ea4\n        this.autoCommit = desiredAutoCommit;\n    }\n\n  //\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7ed9\u4e2aConnection\u5bf9\u8c61\n   public JdbcTransaction(Connection connection) {\n        this.connection = connection;\n    }\n\n    public Connection getConnection() throws SQLException {\n        //\u6ca1\u6709\u5c31\u901a\u8fc7\u6570\u636e\u6e90\u65b0\u5f00\u4e00\u4e2aConnection\n        if (this.connection == null) {\n            this.openConnection();\n        }\n\n        return this.connection;\n    }\n\n    public void commit() throws SQLException {\n        //\u8fde\u63a5\u5df2\u7ecf\u521b\u5efa\u5e76\u4e14\u6ca1\u5f00\u542f\u81ea\u52a8\u63d0\u4ea4\u624d\u53ef\u4ee5\u4f7f\u7528\n        if (this.connection != null &amp;&amp; !this.connection.getAutoCommit()) {\n            if (log.isDebugEnabled()) {\n                log.debug(\"Committing JDBC Connection [\" + this.connection + \"]\");\n            }\n                        //\u5b9e\u9645\u4e0a\u4f7f\u7528\u7684\u662f\u6570\u636e\u5e93\u9a71\u52a8\u63d0\u4f9b\u7684Connection\u5bf9\u8c61\u8fdb\u884c\u4e8b\u52a1\u64cd\u4f5c\n            this.connection.commit();\n        }\n    }\n    ...\n</code></pre> <p>\u76f8\u5f53\u4e8e<code>JdbcTransaction</code>\u53ea\u662f\u4e3a\u6570\u636e\u5e93\u9a71\u52a8\u63d0\u4f9b\u7684<code>Connection</code>\u5bf9\u8c61\u5957\u4e86\u5c42\u58f3\uff0c\u6240\u6709\u7684\u4e8b\u52a1\u64cd\u4f5c\u5b9e\u9645\u4e0a\u662f\u76f4\u63a5\u8c03\u7528<code>Connection</code>\u5bf9\u8c61\u3002\u90a3\u4e48\u6211\u4eec\u63a5\u7740\u6765\u770b<code>ManagedTransaction</code>\u7684\u6e90\u7801\uff1a</p> <pre><code>public class ManagedTransaction implements Transaction {\n    ...\n\n    public void commit() throws SQLException {\n    }\n\n    public void rollback() throws SQLException {\n    }\n\n    ...\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u5927\u4f53\u5185\u5bb9\u548c<code>JdbcTransaction</code>\u5dee\u4e0d\u591a\uff0c\u4f46\u662f\u5b83\u5e76\u6ca1\u6709\u5b9e\u73b0\u4efb\u4f55\u7684\u4e8b\u52a1\u64cd\u4f5c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u5e0c\u671b\u5c06\u5b9e\u73b0\u4ea4\u7ed9\u5176\u4ed6\u7684\u7ba1\u7406\u6846\u67b6\u6765\u5b8c\u6210\uff0c\u800cSpring\u5c31\u4e3aMybatis\u63d0\u4f9b\u4e86\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u4e8b\u52a1\u7ba1\u7406\u5b9e\u73b0\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#spring_3","title":"\u4f7f\u7528Spring\u4e8b\u52a1\u7ba1\u7406","text":"<p>\u73b0\u5728\u6211\u4eec\u6765\u5b66\u4e60\u4e00\u4e0bSpring\u63d0\u4f9b\u7684\u4e8b\u52a1\u7ba1\u7406\uff08Spring\u4e8b\u52a1\u7ba1\u7406\u5206\u4e3a\u7f16\u7a0b\u5f0f\u4e8b\u52a1\u548c\u58f0\u660e\u5f0f\u4e8b\u52a1\uff0c\u4f46\u662f\u7f16\u7a0b\u5f0f\u4e8b\u52a1\u8fc7\u4e8e\u590d\u6742\u5e76\u4e14\u5177\u6709\u9ad8\u5ea6\u8026\u5408\u6027\uff0c\u8fdd\u80cc\u4e86Spring\u6846\u67b6\u7684\u8bbe\u8ba1\u521d\u8877\uff0c\u56e0\u6b64\u8fd9\u91cc\u53ea\u8bb2\u89e3\u58f0\u660e\u5f0f\u4e8b\u52a1\uff09\u58f0\u660e\u5f0f\u4e8b\u52a1\u662f\u57fa\u4e8eAOP\u5b9e\u73b0\u7684\u3002</p> <p>\u4f7f\u7528\u58f0\u660e\u5f0f\u4e8b\u52a1\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u914d\u7f6e\u7c7b\u6dfb\u52a0<code>@EnableTransactionManagement</code>\u6ce8\u89e3\u5373\u53ef\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f00\u542fSpring\u7684\u4e8b\u52a1\u652f\u6301\u4e86\u3002\u63a5\u7740\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u4e00\u4e2a\u4e8b\u52a1\u8981\u505a\u7684\u6240\u6709\u4e8b\u60c5\u5c01\u88c5\u5230Service\u5c42\u7684\u4e00\u4e2a\u65b9\u6cd5\u4e2d\u5373\u53ef\uff0c\u9996\u5148\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u518c\u4e00\u4e2a\u65b0\u7684Bean\uff0c\u4e8b\u52a1\u9700\u8981\u6267\u884c\u5fc5\u987b\u6709\u4e00\u4e2a\u4e8b\u52a1\u7ba1\u7406\u5668\uff1a</p> <pre><code>@Configuration\n@ComponentScan(\"org.example\")\n@MapperScan(\"org.example.mapper\")\n@EnableTransactionManagement\npublic class MainConfiguration {\n\n    @Bean\n    public TransactionManager transactionManager(DataSource dataSource){\n        return new DataSourceTransactionManager(dataSource);\n    }\n    ...\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684Mapper\u64cd\u4f5c\uff1a</p> <pre><code>@Mapper\npublic interface TestMapper {\n    ...\n\n    @Insert(\"insert into student(name, sex) values('\u6d4b\u8bd5', '\u7537')\")\n    void insertStudent();\n}\n</code></pre> <p>\u8fd9\u6837\u4f1a\u5411\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u4e00\u6761\u65b0\u7684\u5b66\u751f\u4fe1\u606f\uff0c\u63a5\u7740\uff0c\u5047\u8bbe\u6211\u4eec\u8fd9\u91cc\u6709\u4e00\u4e2a\u4e1a\u52a1\u9700\u8981\u8fde\u7eed\u63d2\u5165\u4e24\u6761\u5b66\u751f\u4fe1\u606f\uff0c\u9996\u5148\u7f16\u5199\u4e1a\u52a1\u5c42\u7684\u63a5\u53e3\uff1a</p> <pre><code>public interface TestService {\n    void test();\n}\n</code></pre> <p>\u63a5\u7740\uff0c\u6211\u4eec\u518d\u6765\u7f16\u5199\u4e1a\u52a1\u5c42\u7684\u5b9e\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u6ce8\u518c\u4e3aBean\uff0c\u4ea4\u7ed9Spring\u6765\u8fdb\u884c\u7ba1\u7406\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u81ea\u52a8\u5c06Mapper\u6ce8\u5165\u5230\u7c7b\u4e2d\u4e86\uff0c\u5e76\u4e14\u53ef\u4ee5\u652f\u6301\u4e8b\u52a1\uff1a</p> <pre><code>@Component\npublic class TestServiceImpl implements TestService{\n\n    @Resource\n    TestMapper mapper;\n\n    @Transactional   //\u6b64\u6ce8\u89e3\u8868\u793a\u4e8b\u52a1\uff0c\u4e4b\u540e\u6267\u884c\u7684\u6240\u6709\u65b9\u6cd5\u90fd\u4f1a\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u6267\u884c\n    public void test() {\n        mapper.insertStudent();\n        if(true) throw new RuntimeException(\"\u6211\u662f\u6d4b\u8bd5\u5f02\u5e38\uff01\");\n        mapper.insertStudent();\n    }\n}\n</code></pre> <p>\u6211\u4eec\u53ea\u9700\u5728\u65b9\u6cd5\u4e0a\u6dfb\u52a0<code>@Transactional</code>\u6ce8\u89e3\uff0c\u5373\u53ef\u8868\u793a\u6b64\u65b9\u6cd5\u6267\u884c\u7684\u662f\u4e00\u4e2a\u4e8b\u52a1\u64cd\u4f5c\uff0c\u5728\u8c03\u7528\u6b64\u65b9\u6cd5\u65f6\uff0cSpring\u4f1a\u901a\u8fc7AOP\u673a\u5236\u4e3a\u5176\u8fdb\u884c\u589e\u5f3a\uff0c\u4e00\u65e6\u53d1\u73b0\u5f02\u5e38\uff0c\u4e8b\u52a1\u4f1a\u81ea\u52a8\u56de\u6eda\u3002\u6700\u540e\u6211\u4eec\u6765\u8c03\u7528\u4e00\u4e0b\u6b64\u65b9\u6cd5\uff1a</p> <pre><code>@Slf4j\npublic class Main {\n    public static void main(String[] args) {\n        log.info(\"\u9879\u76ee\u6b63\u5728\u542f\u52a8...\");\n        ApplicationContext context = new AnnotationConfigApplicationContext(TestConfiguration.class);\n        TestService service = context.getBean(TestService.class);\n        service.test();\n    }\n}\n</code></pre> <p>\u5f97\u5230\u7684\u7ed3\u679c\u662f\u51fa\u73b0\u9519\u8bef\uff1a</p> <pre><code>12\u6708 17, 2022 4:09:00 \u4e0b\u5348 com.zaxxer.hikari.HikariDataSource getConnection\n\u4fe1\u606f: HikariPool-1 - Start completed.\nException in thread \"main\" java.lang.RuntimeException: \u6211\u662f\u6d4b\u8bd5\u5f02\u5e38\uff01\n    at org.example.service.TestServiceImpl.test(TestServiceImpl.java:17)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:568)\n    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u6574\u4e2a\u6808\u8ffd\u8e2a\u4fe1\u606f\u4e2d\u5305\u542b\u4e86\u5927\u91cfaop\u5305\u4e0b\u7684\u5185\u5bb9\uff0c\u4e5f\u5c31\u5370\u8bc1\u4e86\u5b83\u786e\u5b9e\u662f\u901a\u8fc7AOP\u5b9e\u73b0\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u63a5\u7740\u6765\u770b\u4e00\u4e0b\uff0c\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u662f\u5426\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff08\u51fa\u73b0\u5f02\u5e38\u56de\u6eda\u4e86\uff09</p> <p></p> <p>\u7ed3\u679c\u663e\u800c\u6613\u89c1\uff0c\u7b2c\u4e00\u6b21\u7684\u63d2\u5165\u64cd\u4f5c\u786e\u5b9e\u88ab\u56de\u6eda\u4e86\uff0c\u6570\u636e\u5e93\u4e2d\u6ca1\u6709\u4efb\u4f55\u65b0\u589e\u7684\u5185\u5bb9\u3002</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u7814\u7a76\u4e00\u4e0b<code>@Transactional</code>\u6ce8\u89e3\u7684\u4e00\u4e9b\u53c2\u6570\uff1a</p> <pre><code>@Target({ElementType.TYPE, ElementType.METHOD})\n@Retention(RetentionPolicy.RUNTIME)\n@Inherited\n@Documented\npublic @interface Transactional {\n    @AliasFor(\"transactionManager\")\n    String value() default \"\";\n\n    @AliasFor(\"value\")\n    String transactionManager() default \"\";\n\n    String[] label() default {};\n\n    Propagation propagation() default Propagation.REQUIRED;\n\n    Isolation isolation() default Isolation.DEFAULT;\n\n    int timeout() default -1;\n\n    String timeoutString() default \"\";\n\n    boolean readOnly() default false;\n\n    Class&lt;? extends Throwable&gt;[] rollbackFor() default {};\n\n    String[] rollbackForClassName() default {};\n\n    Class&lt;? extends Throwable&gt;[] noRollbackFor() default {};\n\n    String[] noRollbackForClassName() default {};\n}\n</code></pre> <p>\u6211\u4eec\u6765\u8bb2\u89e3\u51e0\u4e2a\u6bd4\u8f83\u5173\u952e\u7684\u5c5e\u6027\uff1a</p> <ul> <li>transactionManager\uff1a\u6307\u5b9a\u4e8b\u52a1\u7ba1\u7406\u5668</li> <li>propagation\uff1a\u4e8b\u52a1\u4f20\u64ad\u89c4\u5219\uff0c\u4e00\u4e2a\u4e8b\u52a1\u53ef\u4ee5\u5305\u62ecN\u4e2a\u5b50\u4e8b\u52a1</li> <li>isolation\uff1a\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0c\u4e0d\u591a\u8bf4\u4e86</li> <li>timeout\uff1a\u4e8b\u52a1\u8d85\u65f6\u65f6\u95f4</li> <li>readOnly\uff1a\u662f\u5426\u4e3a\u53ea\u8bfb\u4e8b\u52a1\uff0c\u4e0d\u540c\u7684\u6570\u636e\u5e93\u4f1a\u6839\u636e\u53ea\u8bfb\u5c5e\u6027\u8fdb\u884c\u4f18\u5316\uff0c\u6bd4\u5982MySQL\u4e00\u65e6\u58f0\u660e\u4e8b\u52a1\u4e3a\u53ea\u8bfb\uff0c\u90a3\u4e48\u4e45\u4e0d\u5141\u8bb8\u589e\u5220\u6539\u64cd\u4f5c\u4e86\u3002</li> <li>rollbackFor\u548cnoRollbackFor\uff1a\u53d1\u751f\u6307\u5b9a\u5f02\u5e38\u65f6\u56de\u6eda\u6216\u662f\u4e0d\u56de\u6eda\uff0c\u9ed8\u8ba4\u53d1\u751f\u4efb\u4f55\u5f02\u5e38\u90fd\u56de\u6eda\u3002</li> </ul> <p>\u9664\u4e86\u4e8b\u52a1\u7684\u4f20\u64ad\u89c4\u5219\uff0c\u5176\u4ed6\u7684\u5185\u5bb9\u5176\u5b9e\u5df2\u7ecf\u7ed9\u5927\u5bb6\u8bb2\u89e3\u8fc7\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6765\u770b\u770b\u4e8b\u52a1\u7684\u4f20\u64ad\u3002\u4e8b\u52a1\u4f20\u64ad\u4e00\u5171\u6709\u4e03\u79cd\u7ea7\u522b\uff1a</p> <p></p> <p>Spring\u9ed8\u8ba4\u7684\u4f20\u64ad\u7ea7\u522b\u662f<code>PROPAGATION_REQUIRED</code>\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770b\uff0c\u5b83\u662f\u5982\u4f55\u4f20\u64ad\u7684\uff0c\u73b0\u5728\u6211\u4eec\u7684<code>Service</code>\u7c7b\u4e2d\u4e00\u5171\u5b58\u5728\u4e24\u4e2a\u4e8b\u52a1\uff0c\u800c\u4e00\u4e2a\u4e8b\u52a1\u65b9\u6cd5\u5305\u542b\u4e86\u53e6\u4e00\u4e2a\u4e8b\u52a1\u65b9\u6cd5\uff1a</p> <pre><code>@Component\npublic class TestServiceImpl implements TestService{\n\n    @Resource\n    TestMapper mapper;\n\n    @Transactional\n    public void test() {\n        test2();   //\u5305\u542b\u53e6\u4e00\u4e2a\u4e8b\u52a1\n        if(true) throw new RuntimeException(\"\u6211\u662f\u6d4b\u8bd5\u5f02\u5e38\uff01\");  //\u53d1\u751f\u5f02\u5e38\u65f6\uff0c\u4f1a\u56de\u6eda\u53e6\u4e00\u4e2a\u4e8b\u52a1\u5417\uff1f\n    }\n\n    @Transactional\n    public void test2() {\n        mapper.insertStudent();\n    }\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u5f97\u5230\u7ed3\u679c\uff0c\u53e6\u4e00\u4e2a\u4e8b\u52a1\u4e5f\u88ab\u56de\u6eda\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u76f8\u5f53\u4e8e\u53e6\u4e00\u4e2a\u4e8b\u52a1\u76f4\u63a5\u52a0\u5165\u5230\u6b64\u4e8b\u52a1\u4e2d\uff0c\u4e5f\u5c31\u662f\u8868\u4e2d\u6240\u63cf\u8ff0\u7684\u90a3\u6837\u3002\u5982\u679c\u5355\u72ec\u6267\u884c<code>test2()</code>\u5219\u4f1a\u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u4e8b\u52a1\uff0c\u800c\u6267\u884c<code>test()</code>\u5219\u4f1a\u76f4\u63a5\u8ba9\u5185\u90e8\u7684<code>test2()</code>\u52a0\u5165\u5230\u5f53\u524d\u4e8b\u52a1\u4e2d\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u5c06<code>test2()</code>\u7684\u4f20\u64ad\u7ea7\u522b\u8bbe\u5b9a\u4e3a<code>SUPPORTS</code>\uff0c\u90a3\u4e48\u8fd9\u65f6\u5982\u679c\u5355\u72ec\u8c03\u7528<code>test2()</code>\u65b9\u6cd5\uff0c\u5e76\u4e0d\u4f1a\u4ee5\u4e8b\u52a1\u7684\u65b9\u5f0f\u6267\u884c\uff0c\u5f53\u53d1\u751f\u5f02\u5e38\u65f6\uff0c\u867d\u7136\u4f9d\u7136\u5b58\u5728AOP\u589e\u5f3a\uff0c\u4f46\u662f\u4e0d\u4f1a\u8fdb\u884c\u56de\u6eda\u64cd\u4f5c\uff0c\u800c\u73b0\u5728\u518d\u8c03\u7528<code>test()</code>\u65b9\u6cd5\uff0c\u624d\u4f1a\u4ee5\u4e8b\u52a1\u7684\u65b9\u5f0f\u6267\u884c\uff1a</p> <pre><code>@Transactional\npublic void test() {\n    test2();\n}\n\n@Transactional(propagation = Propagation.SUPPORTS)\npublic void test2() {\n    mapper.insertStudent();\n    if(true) throw new RuntimeException(\"\u6211\u662f\u6d4b\u8bd5\u5f02\u5e38\uff01\");\n}\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b<code>MANDATORY</code>\uff0c\u5b83\u975e\u5e38\u4e25\u683c\uff0c\u5982\u679c\u5f53\u524d\u65b9\u6cd5\u5e76\u6ca1\u6709\u5728\u4efb\u4f55\u4e8b\u52a1\u4e2d\u8fdb\u884c\uff0c\u4f1a\u76f4\u63a5\u51fa\u73b0\u5f02\u5e38\uff1a</p> <pre><code>@Transactional\npublic void test() {\n    test2();\n}\n\n@Transactional(propagation = Propagation.MANDATORY)\npublic void test2() {\n    mapper.insertStudent();\n    if(true) throw new RuntimeException(\"\u6211\u662f\u6d4b\u8bd5\u5f02\u5e38\uff01\");\n}\n</code></pre> <p>\u76f4\u63a5\u8fd0\u884c<code>test2()</code>\u65b9\u6cd5\uff0c\u62a5\u9519\u5982\u4e0b\uff1a</p> <pre><code>Exception in thread \"main\" org.springframework.transaction.IllegalTransactionStateException: No existing transaction found for transaction marked with propagation 'mandatory'\n    at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:362)\n    at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:595)\n    at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:382)\n    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)\n    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:215)\n    at com.sun.proxy.$Proxy29.test2(Unknown Source)\n    at com.test.Main.main(Main.java:17)\n</code></pre> <p><code>NESTED</code>\u7ea7\u522b\u8868\u793a\u5982\u679c\u5b58\u5728\u5916\u5c42\u4e8b\u52a1\uff0c\u5219\u6b64\u65b9\u6cd5\u5355\u72ec\u521b\u5efa\u4e00\u4e2a\u5b50\u4e8b\u52a1\uff0c\u56de\u6eda\u53ea\u4f1a\u5f71\u54cd\u5230\u6b64\u5b50\u4e8b\u52a1\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u5229\u7528\u521b\u5efaSavepoint\uff0c\u7136\u540e\u56de\u6eda\u5230\u6b64\u4fdd\u5b58\u70b9\u5b9e\u73b0\u7684\u3002<code>NEVER</code>\u7ea7\u522b\u8868\u793a\u6b64\u65b9\u6cd5\u4e0d\u5e94\u8be5\u52a0\u5165\u5230\u4efb\u4f55\u4e8b\u52a1\u4e2d\uff0c\u5176\u4f59\u7c7b\u578b\u9002\u7528\u4e8e\u540c\u65f6\u64cd\u4f5c\u591a\u6570\u636e\u6e90\u60c5\u51b5\u4e0b\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u7ba1\u7406\uff0c\u8fd9\u91cc\u6682\u65f6\u4e0d\u505a\u4ecb\u7ecd\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#junit","title":"\u96c6\u6210JUnit\u6d4b\u8bd5","text":"<p>\u65e2\u7136\u4f7f\u7528\u4e86Spring\uff0c\u90a3\u4e48\u600e\u4e48\u96c6\u6210\u5230JUnit\u4e2d\u8fdb\u884c\u6d4b\u8bd5\u5462\uff0c\u9996\u5148\u5927\u5bb6\u80fd\u591f\u60f3\u5230\u7684\u80af\u5b9a\u662f\uff1a</p> <pre><code>public class TestMain {\n\n    @Test\n    public void test(){\n        ApplicationContext context = new AnnotationConfigApplicationContext(TestConfiguration.class);\n        TestService service = context.getBean(TestService.class);\n        service.test();\n    }\n}\n</code></pre> <p>\u76f4\u63a5\u7f16\u5199\u4e00\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u5373\u53ef\uff0c\u4f46\u662f\u8fd9\u6837\u7684\u8bdd\uff0c\u5982\u679c\u6211\u4eec\u6709\u5f88\u591a\u4e2a\u6d4b\u8bd5\u7528\u4f8b\uff0c\u90a3\u4e48\u6211\u4eec\u4e0d\u53ef\u80fd\u6bcf\u6b21\u6d4b\u8bd5\u90fd\u53bb\u521b\u5efaApplicationContext\u5427\uff1f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>@Before</code>\u6dfb\u52a0\u4e00\u4e2a\u6d4b\u8bd5\u524d\u52a8\u4f5c\u6765\u63d0\u524d\u914d\u7f6eApplicationContext\uff0c\u4f46\u662f\u8fd9\u6837\u7684\u8bdd\uff0c\u8fd8\u662f\u4e0d\u591f\u7b80\u4fbf\uff0c\u80fd\u4e0d\u80fd\u6709\u66f4\u5feb\u901f\u9ad8\u6548\u7684\u65b9\u6cd5\u5462\uff1f</p> <p>Spring\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2aTest\u6a21\u5757\uff0c\u5b83\u4f1a\u81ea\u52a8\u96c6\u6210Junit\u8fdb\u884c\u6d4b\u8bd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5bfc\u5165\u4e00\u4e0b\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n    &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;\n    &lt;version&gt;5.9.0&lt;/version&gt;\n    &lt;scope&gt;test&lt;/scope&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n    &lt;version&gt;6.0.10&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u8fd9\u91cc\u5bfc\u5165\u7684\u662fJUnit5\u548cSpringTest\u6a21\u5757\u4f9d\u8d56\uff0c\u7136\u540e\u76f4\u63a5\u5728\u6211\u4eec\u7684\u6d4b\u8bd5\u7c7b\u4e0a\u6dfb\u52a0\u4e24\u4e2a\u6ce8\u89e3\u5c31\u53ef\u4ee5\u641e\u5b9a\uff1a</p> <pre><code>@ExtendWith(SpringExtension.class)\n@ContextConfiguration(classes = TestConfiguration.class)\npublic class TestMain {\n\n    @Autowired\n    TestService service;\n\n    @Test\n    public void test(){\n        service.test();\n    }\n}\n</code></pre> <p><code>@ExtendWith</code>\u662f\u7531JUnit\u63d0\u4f9b\u7684\u6ce8\u89e3\uff0c\u7b49\u540c\u4e8e\u65e7\u7248\u672c\u7684<code>@RunWith</code>\u6ce8\u89e3\uff0c\u7136\u540e\u4f7f\u7528SpringTest\u6a21\u5757\u63d0\u4f9b\u7684<code>@ContextConfiguration</code>\u6ce8\u89e3\u6765\u8868\u793a\u8981\u52a0\u8f7d\u54ea\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\u53ef\u4ee5\u662fXML\u6587\u4ef6\u4e5f\u53ef\u4ee5\u662f\u7c7b\uff0c\u6211\u4eec\u8fd9\u91cc\u5c31\u76f4\u63a5\u4f7f\u7528\u7c7b\u8fdb\u884c\u52a0\u8f7d\u3002</p> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528<code>@Autowired</code>\u6765\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165\uff0c\u5e76\u4e14\u76f4\u63a5\u5728\u6d4b\u8bd5\u65b9\u6cd5\u4e2d\u4f7f\u7528\u6ce8\u5165\u7684Bean\uff0c\u73b0\u5728\u5c31\u975e\u5e38\u65b9\u4fbf\u4e86\u3002</p> <p>\u81f3\u6b64\uff0cSSM\u4e2d\u7684\u5176\u4e2d\u4e00\u4e2aS\uff08Spring\uff09\u548c\u4e00\u4e2aM\uff08Mybatis\uff09\u5c31\u5df2\u7ecf\u5b66\u5b8c\u4e86\uff0c\u6211\u4eec\u8fd8\u5269\u4e0b\u4e00\u4e2aSpringMvc\u9700\u8981\u53bb\u5b66\u4e60\uff0c\u4e0b\u4e00\u7ae0\uff0c\u6211\u4eec\u5c06\u91cd\u65b0\u56de\u5230Web\u5f00\u53d1\uff0c\u4e86\u89e3\u5728Spring\u6846\u67b6\u7684\u52a0\u6301\u4e0b\uff0c\u6211\u4eec\u5982\u4f55\u66f4\u9ad8\u6548\u5730\u5f00\u53d1Web\u5e94\u7528\u7a0b\u5e8f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_11","title":"\u5b9e\u73b0\u539f\u7406\u63a2\u7a76\uff08\u9009\u5b66\uff09","text":"<p>\u6ce8\u610f\uff1a\u672c\u7248\u5757\u96be\u5ea6\u5f88\u5927\uff0c\u6240\u6709\u5185\u5bb9\u90fd\u4f5c\u4e3a\u9009\u5b66\u5185\u5bb9\u3002</p> <p>\u5982\u679c\u5b66\u4e60Spring\u57fa\u672c\u5185\u5bb9\u5bf9\u4f60\u6765\u8bf4\u5df2\u7ecf\u975e\u5e38\u56f0\u96be\u4e86\uff0c\u5efa\u8bae\u8df3\u8fc7\u6b64\u5c0f\u8282\uff0c\u76f4\u63a5\u8fdb\u5165MVC\u9636\u6bb5\u7684\u5b66\u4e60\uff0c\u6b64\u5c0f\u8282\u4f1a\u4ece\u6e90\u7801\u89d2\u5ea6\u89e3\u91caSpring\u7684\u6574\u4e2a\u8fd0\u884c\u539f\u7406\uff0c\u5bf9\u521d\u5b66\u8005\u6765\u8bf4\u7b49\u540c\u4e8e\u5c0f\u5b66\u8de8\u8d8a\u5230\u9ad8\u4e2d\uff0c\u5b83\u5e76\u4e0d\u662f\u5fc5\u5b66\u5185\u5bb9\uff0c\u4f46\u662f\u5bf9\u4e8e\u4e2a\u4eba\u9605\u5386\u63d0\u5347\u6781\u4e3a\u91cd\u8981\uff08\u63a8\u8350\u5b8c\u6210\u6574\u4e2aSSM\u9636\u6bb5\u7684\u5b66\u4e60\u5e76\u4e14\u52a0\u4ee5\u5b9e\u6218\u4e4b\u540e\u518d\u6765\u770b\u6b64\u90e8\u5206\uff09\uff0c\u5982\u679c\u4f60\u8fd8\u662f\u89c9\u5f97\u81ea\u5df1\u80fd\u591f\u8ddf\u4e0a\u8282\u594f\u7ee7\u7eed\u6df1\u5165\u94bb\u7814\u5e95\u5c42\u539f\u7406\uff0c\u90a3\u4e48\u73b0\u5728\u5c31\u5f00\u59cb\u5427\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#beanbean","title":"Bean\u5de5\u5382\u4e0eBean\u5b9a\u4e49","text":"<p>\u5b9e\u9645\u4e0a\u6211\u4eec\u4e4b\u524d\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u79bb\u4e0d\u5f00\u4e00\u4e2a\u4e1c\u897f\uff0c\u90a3\u5c31\u662fIoC\u5bb9\u5668\uff0c\u90a3\u4e48\u5b83\u5230\u5e95\u662f\u5982\u4f55\u5b9e\u73b0\u5462\uff1f\u8fd9\u4e00\u90e8\u5206\u6211\u4eec\u5c06\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u9996\u5148\u6211\u4eec\u5927\u81f4\u4e86\u89e3\u4e00\u4e0bApplicationContext\u7684\u52a0\u8f7d\u6d41\u7a0b\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u6574\u4e2a\u8fc7\u7a0b\u6781\u4e3a\u590d\u6742\uff0c\u4e00\u53e5\u8bdd\u80af\u5b9a\u662f\u65e0\u6cd5\u89e3\u91ca\u7684\u3002\u7531\u4e8eSpring\u7684\u6e90\u7801\u975e\u5e38\u5e9e\u5927\uff0c\u56e0\u6b64\u6211\u4eec\u4e0d\u53ef\u80fd\u518d\u50cf\u4e86\u89e3\u5176\u4ed6\u6846\u67b6\u90a3\u6837\u76f4\u63a5\u81ea\u5e95\u5411\u4e0a\u9010\u884c\u5e72\u6e90\u7801\u4e86\uff08\u5404\u4f4d\u53ef\u4ee5\u81ea\u5df1\u70b9\u5f00\u770b\u770b\uff0c\u4ee3\u7801\u91cf\u975e\u5e38\u591a\uff09</p> <p></p> <p>\u6211\u4eec\u53ea\u80fd\u5bf9\u51e0\u4e2a\u5173\u952e\u90e8\u5206\u8fdb\u884c\u4ecb\u7ecd\uff0c\u5728\u4e86\u89e3\u8fd9\u4e9b\u5185\u5bb9\u4e4b\u540e\uff0c\u5b9e\u9645\u4e0a\u4e0d\u9700\u8981\u5b8c\u5168\u9605\u8bfb\u6240\u6709\u90e8\u5206\u7684\u6e90\u7801\u90fd\u53ef\u4ee5\u6709\u4e00\u4e2a\u5927\u81f4\u7684\u8ba4\u8bc6\u3002</p> <p>\u9996\u5148\uff0c\u5bb9\u5668\u65e2\u7136\u8981\u7ba1\u7406Bean\uff0c\u90a3\u4e48\u80af\u5b9a\u9700\u8981\u4e00\u4e2a\u5b8c\u5584\u7684\u7ba1\u7406\u673a\u5236\uff0c\u5b9e\u9645\u4e0a\uff0c\u5bf9Bean\u7684\u7ba1\u7406\u90fd\u662f\u4f9d\u9760BeanFactory\u5728\u8fdb\u884c\uff0c\u987e\u540d\u601d\u4e49BeanFactory\u5c31\u662f\u5bf9Bean\u8fdb\u884c\u751f\u4ea7\u548c\u7ba1\u7406\u7684\u5de5\u5382\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u81ea\u5df1\u521b\u5efa\u548c\u4f7f\u7528BeanFactory\u5bf9\u8c61\uff1a</p> <pre><code>public static void main(String[] args) {\n    BeanFactory factory = new DefaultListableBeanFactory();  //\u8fd9\u662fBeanFactory\u7684\u4e00\u4e2a\u9ed8\u8ba4\u5b9e\u73b0\u7c7b\n    System.out.println(\"\u83b7\u53d6Bean\u5bf9\u8c61\uff1a\"+factory.getBean(\"lbwnb\"));  //\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u627e\u5de5\u5382\u83b7\u53d6Bean\u5bf9\u8c61\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u627eBean\u5de5\u5382\u7d22\u8981\u5bf9\u8c61\uff0c\u53ea\u4e0d\u8fc7\u5728\u4e00\u5f00\u59cb\uff0c\u5de5\u5382\u5e76\u4e0d\u77e5\u9053\u81ea\u5df1\u9700\u8981\u751f\u4ea7\u4ec0\u4e48\uff0c\u53ef\u4ee5\u751f\u4ea7\u4ec0\u4e48\uff0c\u56e0\u6b64\u6211\u4eec\u76f4\u63a5\u7d22\u8981\u4e00\u4e2a\u5de5\u5382\u4e0d\u77e5\u9053\u7684Bean\u5bf9\u8c61\uff0c\u4f1a\u76f4\u63a5\u5f97\u5230\uff1a</p> <p></p> <p>\u6211\u4eec\u53ea\u6709\u544a\u8bc9\u5de5\u5382\u6211\u4eec\u8981\u751f\u4ea7\u4ec0\u4e48\uff0c\u600e\u4e48\u751f\u4ea7\uff0c\u5de5\u5382\u624d\u80fd\u5f00\u5de5\uff1a</p> <pre><code>public static void main(String[] args) {\n    DefaultListableBeanFactory factory = new DefaultListableBeanFactory();  //\u8fd9\u662fBeanFactory\u7684\u4e00\u4e2a\u9ed8\u8ba4\u5b9e\u73b0\u7c7b\n\n    BeanDefinition definition = BeanDefinitionBuilder   //\u4f7f\u7528BeanDefinitionBuilder\u5feb\u901f\u521b\u5efaBean\u5b9a\u4e49\n            .rootBeanDefinition(Student.class)   //Bean\u7684\u7c7b\u578b\n            .setScope(\"prototype\")    //\u8bbe\u7f6e\u4f5c\u7528\u57df\u4e3a\u539f\u578b\u6a21\u5f0f\n            .getBeanDefinition();     //\u751f\u6210\u6b64Bean\u5b9a\u4e49\n    factory.registerBeanDefinition(\"lbwnb\", definition);   //\u5411\u5de5\u5382\u6ce8\u518cBean\u6b64\u5b9a\u4e49\uff0c\u5e76\u8bbe\u5b9aBean\u7684\u540d\u79f0\n\n    System.out.println(factory.getBean(\"lbwnb\"));  //\u73b0\u5728\u5c31\u53ef\u4ee5\u62ff\u5230\u4e86\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u7684ApplicationContext\u4e2d\u5c31\u7ef4\u62a4\u4e86\u4e00\u4e2aAutowireCapableBeanFactory\u5bf9\u8c61\uff1a</p> <pre><code>public abstract class AbstractRefreshableApplicationContext extends AbstractApplicationContext {\n    @Nullable\n    private volatile DefaultListableBeanFactory beanFactory;   //\u9ed8\u8ba4\u6784\u9020\u540e\u5b58\u653e\u5728\u8fd9\u91cc\u7684\u662f\u4e00\u4e2aDefaultListableBeanFactory\u5bf9\u8c61\n\n  ...\n\n  @Override\n  public final ConfigurableListableBeanFactory getBeanFactory() {   //getBeanFactory\u5c31\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u4e0a\u9762\u7684\u5bf9\u8c61\u4e86\n     DefaultListableBeanFactory beanFactory = this.beanFactory;\n     if (beanFactory == null) {\n        throw new IllegalStateException(\"BeanFactory not initialized or already closed - \" +\n              \"call 'refresh' before accessing beans via the ApplicationContext\");\n     }\n     return beanFactory;\n  }\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e0b\uff1a</p> <pre><code>ApplicationContext context = new ClassPathXmlApplicationContext(\"application.xml\");\n//\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u83b7\u53d6\u6b64\u5bf9\u8c61\nSystem.out.println(context.getAutowireCapableBeanFactory());\n</code></pre> <p>\u6b63\u662f\u56e0\u4e3a\u8fd9\u6837\uff0cApplicationContext\u624d\u5177\u6709\u4e86\u7ba1\u7406\u548c\u751f\u4ea7Bean\u5bf9\u8c61\u7684\u80fd\u529b\u3002</p> <p>\u4e0d\u8fc7\uff0c\u6211\u4eec\u7684\u914d\u7f6e\u53ef\u80fd\u662fXML\u3001\u53ef\u80fd\u662f\u914d\u7f6e\u7c7b\uff0c\u90a3\u4e48Spring\u8981\u5982\u4f55\u8fdb\u884c\u89e3\u6790\uff0c\u5c06\u8fd9\u4e9b\u53d8\u6210\u5bf9\u5e94\u7684BeanDefinition\u5bf9\u8c61\u5462\uff1f\u4f7f\u7528BeanDefinitionReader\u5c31\u53ef\u4ee5\uff1a</p> <pre><code>public static void main(String[] args) {\n    DefaultListableBeanFactory factory = new DefaultListableBeanFactory();\n    //\u6bd4\u5982\u6211\u4eec\u8981\u8bfb\u53d6XML\u914d\u7f6e\uff0c\u6211\u4eec\u76f4\u63a5\u4f7f\u7528XmlBeanDefinitionReader\u5c31\u53ef\u4ee5\u5feb\u901f\u8fdb\u884c\u626b\u63cf\n    XmlBeanDefinitionReader reader = new XmlBeanDefinitionReader(factory);\n    //\u52a0\u8f7d\u6b64XML\u6587\u4ef6\u4e2d\u6240\u6709\u7684Bean\u5b9a\u4e49\u5230Bean\u5de5\u5382\u4e2d\n    reader.loadBeanDefinitions(new ClassPathResource(\"application.xml\"));\n\n    //\u53ef\u4ee5\u770b\u5230\u80fd\u6b63\u5e38\u751f\u4ea7\u6b64Bean\u7684\u5b9e\u4f8b\u5bf9\u8c61\n    System.out.println(factory.getBean(Student.class));\n}\n</code></pre> <p>\u56e0\u6b64\uff0c\u9488\u5bf9\u4e8e\u4e0d\u540c\u7c7b\u578b\u7684\u914d\u7f6e\u65b9\u5f0f\uff0cApplicationContext\u6709\u7740\u591a\u79cd\u5b9e\u73b0\uff0c\u5176\u4e2d\u5e38\u7528\u7684\u6709\uff1a</p> <ul> <li>ClassPathXmlApplicationContext\uff1a\u9002\u7528\u4e8e\u7c7b\u8def\u5f84\u4e0b\u7684XML\u914d\u7f6e\u6587\u4ef6\u3002</li> <li>FileSystemXmlApplicationContext\uff1a\u9002\u7528\u4e8e\u975e\u7c7b\u8def\u5f84\u4e0b\u7684XML\u914d\u7f6e\u6587\u4ef6\u3002</li> <li>AnnotationConfigApplicationContext\uff1a\u9002\u7528\u4e8e\u6ce8\u89e3\u914d\u7f6e\u5f62\u5f0f\u3002</li> </ul> <p>\u6bd4\u5982ClassPathXmlApplicationContext\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u5c31\u4f1a\u521b\u5efa\u4e00\u4e2a\u5bf9\u5e94\u7684XmlBeanDefinitionReader\u8fdb\u884c\u626b\u63cf\uff1a</p> <pre><code>@Override\nprotected void loadBeanDefinitions(DefaultListableBeanFactory beanFactory) throws BeansException, IOException {\n   // \u4e3a\u7ed9\u5b9a\u7684BeanFactory\u521b\u5efaXmlBeanDefinitionReader\u4fbf\u4e8e\u8bfb\u53d6XML\u4e2d\u7684Bean\u914d\u7f6e\n   XmlBeanDefinitionReader beanDefinitionReader = new XmlBeanDefinitionReader(beanFactory);\n\n   // \u5404\u79cd\u914d\u7f6e\uff0c\u5ffd\u7565\u6389\n   beanDefinitionReader.setEnvironment(this.getEnvironment());\n   ...\n   // \u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u76f4\u63a5\u5f00\u59cb\u52a0\u8f7dXML\u6587\u4ef6\u4e2d\u7684Bean\u5b9a\u4e49\n   loadBeanDefinitions(beanDefinitionReader);\n}\n</code></pre> <pre><code>protected void loadBeanDefinitions(XmlBeanDefinitionReader reader) throws BeansException, IOException {\n   Resource[] configResources = getConfigResources();   //\u5177\u4f53\u52a0\u8f7d\u8fc7\u7a0b\u6211\u5c31\u4e0d\u8be6\u7ec6\u4ecb\u7ecd\u4e86\n   if (configResources != null) {\n      reader.loadBeanDefinitions(configResources);\n   }\n   String[] configLocations = getConfigLocations();\n   if (configLocations != null) {\n      reader.loadBeanDefinitions(configLocations);\n   }\n}\n</code></pre> <p>\u73b0\u5728\uff0c\u6211\u4eec\u5c31\u5df2\u7ecf\u77e5\u9053\uff0cBean\u5b9e\u9645\u4e0a\u662f\u4e00\u5f00\u59cb\u901a\u8fc7BeanDefinitionReader\u8fdb\u884c\u626b\u63cf\uff0c\u7136\u540e\u5c06\u6240\u6709Bean\u4ee5BeanDefinition\u5bf9\u8c61\u7684\u5f62\u5f0f\u6ce8\u518c\u5230\u5bf9\u5e94\u7684BeanFactory\u4e2d\u8fdb\u884c\u96c6\u4e2d\u7ba1\u7406\uff0c\u800c\u6211\u4eec\u4f7f\u7528\u7684ApplicationContext\u5b9e\u9645\u4e0a\u5185\u90e8\u5c31\u6709\u4e00\u4e2aBeanFactory\u5728\u8fdb\u884cBean\u7ba1\u7406\uff0c\u8fd9\u6837\u5bb9\u5668\u624d\u62e5\u6709\u4e86\u6700\u57fa\u672c\u7684Bean\u7ba1\u7406\u529f\u80fd\u3002</p> <p>\u5f53\u7136\uff0cBeanFactory\u8fd8\u53ef\u4ee5\u5177\u6709\u7236\u5b50\u5173\u7cfb\uff0c\u5176\u4e2d\u6700\u5173\u952e\u7684\u4f5c\u7528\u5c31\u662f\u7ee7\u627f\u7236\u5bb9\u5668\u4e2d\u6240\u6709\u7684Bean\u5b9a\u4e49\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u521b\u5efa\u4e00\u4e2a\u65b0\u7684BeanFactory\u5e76\u4e14\u9ed8\u8ba4\u5177\u6709\u5176\u4ed6BeanFactory\u4e2d\u6240\u6709\u7684Bean\u5b9a\u4e49\u5916\u52a0\u4e00\u4e9b\u5176\u4ed6\u7684\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u91c7\u7528\u8fd9\u79cd\u5f62\u5f0f\uff0c\u8fd9\u662f\u5f88\u65b9\u4fbf\u7684\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u6765\u5c1d\u8bd5\u4e00\u4e0b\uff0c\u521b\u5efa\u4e24\u4e2a\u5de5\u5382\uff1a</p> <pre><code>public class Main {\n    public static void main(String[] args) {\n        DefaultListableBeanFactory factoryParent = new DefaultListableBeanFactory();\n        DefaultListableBeanFactory factoryChild = new DefaultListableBeanFactory();\n        //\u5728\u7236\u5de5\u5382\u4e2d\u6ce8\u518cA\n        factoryParent.registerBeanDefinition(\"a\", new RootBeanDefinition(A.class));\n        //\u5728\u5b50\u5de5\u5382\u4e2d\u6ce8\u518cB\u3001C\n        factoryChild.registerBeanDefinition(\"b\", new RootBeanDefinition(B.class));\n        factoryChild.registerBeanDefinition(\"c\", new RootBeanDefinition(C.class));\n        //\u6700\u540e\u8bbe\u5b9a\u5b50\u5de5\u5382\u7684\u7236\u5de5\u5382\n        factoryChild.setParentBeanFactory(factoryParent);\n    }\n\n    static class A{ }\n    static class B{ }\n    static class C{ }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u662f\u4e0d\u662f\u6211\u4eec\u60f3\u7684\u90a3\u6837\uff1a</p> <pre><code>System.out.println(factoryChild.getBean(A.class));  //\u5b50\u5de5\u5382\u4e0d\u4ec5\u80fd\u83b7\u53d6\u5230\u81ea\u5df1\u7684\uff0c\u4e5f\u53ef\u4ee5\u62ff\u5230\u7236\u5de5\u5382\u7684\nSystem.out.println(factoryChild.getBean(B.class));\nSystem.out.println(factoryChild.getBean(C.class));\n\nSystem.out.println(factoryParent.getBean(B.class));   //\u6ce8\u610f\u7236\u5de5\u5382\u4e0d\u80fd\u62ff\u5230\u5b50\u5de5\u5382\u7684\uff0c\u5c31\u50cf\u7c7b\u7684\u7ee7\u627f\u4e00\u6837\n</code></pre> <p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u5728\u4f7f\u7528ApplicationContext\u65f6\uff0c\u4e5f\u53ef\u4ee5\u8bbe\u5b9a\u8fd9\u6837\u7684\u7236\u5b50\u5173\u7cfb\uff0c\u6548\u679c\u76f8\u540c\uff1a</p> <pre><code>public static void main(String[] args) {\n    ApplicationContext contextParent = new ClassPathXmlApplicationContext(\"parent.xml\");\n    ApplicationContext contextChild = new ClassPathXmlApplicationContext(new String[]{\"child.xml\"}, contextParent);  //\u7b2c\u4e00\u4e2a\u53c2\u6570\u53ea\u80fd\u7528\u6570\u7ec4\uff0c\u5947\u602a\n}\n</code></pre> <p>\u5f53\u7136\uff0c\u9664\u4e86\u8fd9\u4e9b\u529f\u80fd\u4e4b\u5916\uff0cBeanFactory\u8fd8\u63d0\u4f9b\u4e86\u5f88\u591a\u5176\u4ed6\u7684\u7ba1\u7406Bean\u5b9a\u4e49\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982\u79fb\u9664Bean\u5b9a\u4e49\u3001\u62f7\u8d1dBean\u5b9a\u4e49\u3001\u9500\u6bc1\u5355\u4f8bBean\u5b9e\u4f8b\u5bf9\u8c61\u7b49\u529f\u80fd\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4e00\u4e00\u5217\u51fa\u4e86\uff0c\u5404\u4f4d\u5c0f\u4f19\u4f34\u81ea\u5df1\u8c03\u7528\u4e00\u4e0b\u6d4b\u8bd5\u5c31\u53ef\u4ee5\u4e86\uff0c\u5f88\u7b80\u5355\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#bean_2","title":"\u5355\u4f8bBean\u7684\u521b\u5efa\u4e0e\u5faa\u73af\u4f9d\u8d56","text":"<p>\u524d\u9762\u6211\u4eec\u8bb2\u89e3\u4e86\u914d\u7f6e\u7684Bean\u662f\u5982\u4f55\u88ab\u8bfb\u53d6\u5e76\u52a0\u8f7d\u5230\u5bb9\u5668\u4e2d\u7684\uff0c\u63a5\u7740\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0bBean\u5b9e\u4f8b\u5bf9\u8c61\u662f\u5982\u4f55\u88ab\u521b\u5efa\u5e76\u5f97\u5230\u7684\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u5982\u679c\u8981\u5f97\u5230\u4e00\u4e2aBean\u7684\u5b9e\u4f8b\u5f88\u7b80\u5355\uff0c\u901a\u8fc7<code>getBean</code>\u65b9\u6cd5\u5c31\u53ef\u4ee5\u76f4\u63a5\u62ff\u5230\u4e86\uff1a</p> <pre><code>ApplicationContext context = new ClassPathXmlApplicationContext(\"application.xml\");\nSystem.out.println(context.getBean(Student.class));   //\u901a\u8fc7\u6b64\u65b9\u6cd5\u5c31\u80fd\u5feb\u901f\u5f97\u5230\n</code></pre> <p>\u90a3\u4e48\uff0c\u4e00\u4e2aBean\u7684\u5b9e\u4f8b\u5bf9\u8c61\u5230\u5e95\u662f\u5982\u4f55\u521b\u5efa\u51fa\u6765\u7684\u5462\uff1f\u6211\u4eec\u8fd8\u8981\u7ee7\u7eed\u5bf9\u6211\u4eec\u4e4b\u524d\u8bb2\u89e3\u7684BeanFactory\u8fdb\u884c\u6df1\u5165\u4ecb\u7ecd\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u627e\u5230BeanFactory\u63a5\u53e3\u7684\u4e00\u4e2a\u62bd\u8c61\u5b9e\u73b0<code>AbstractBeanFactory</code>\u7c7b\uff0c\u5b83\u5b9e\u73b0\u4e86<code>getBean()</code>\u65b9\u6cd5\uff1a</p> <pre><code>public Object getBean(String name) throws BeansException {\n    //\u5957\u5a03\u5f00\u59cb\u4e86\uff0c\u505a\u597d\u51c6\u5907\n    return this.doGetBean(name, (Class)null, (Object[])null, false);\n}\n</code></pre> <p>\u90a3\u4e48\u6211\u4eec<code>doGetBean()</code>\u63a5\u7740\u6765\u770b\u65b9\u6cd5\u91cc\u9762\u5e72\u4e86\u4ec0\u4e48\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u6bd4\u8f83\u957f\uff0c\u6211\u4eec\u5206\u6bb5\u8fdb\u884c\u8bb2\u89e3\uff1a</p> <pre><code>protected &lt;T&gt; T doGetBean(String name, @Nullable Class&lt;T&gt; requiredType, @Nullable Object[] args, boolean typeCheckOnly) throws BeansException {\n    String beanName = this.transformedBeanName(name);   //\u867d\u7136\u8fd9\u91cc\u76f4\u63a5\u4f20\u7684\u5c31\u662fname\uff0c\u4f46\u662f\u4e07\u4e00\u662f\u522b\u540d\u5462\uff0c\u6240\u4ee5\u8fd8\u5f97\u8981\u89e3\u6790\u4e00\u4e0b\u53d8\u6210\u539f\u672c\u7684Bean\u540d\u5b57\n    Object sharedInstance = this.getSingleton(beanName);   //\u9996\u5148\u76f4\u63a5\u83b7\u53d6\u5355\u4f8bBean\u5bf9\u8c61\n    Object beanInstance;\n    if (sharedInstance != null &amp;&amp; args == null) {   //\u5224\u65ad\u662f\u5426\u6210\u529f\u83b7\u53d6\u5230\u5171\u4eab\u7684\u5355\u4f8b\u5bf9\u8c61\n    ...\n</code></pre> <p>\u56e0\u4e3a\u6240\u6709\u7684Bean\u9ed8\u8ba4\u90fd\u662f\u5355\u4f8b\u6a21\u5f0f\uff0c\u5bf9\u8c61\u53ea\u4f1a\u5b58\u5728\u4e00\u4e2a\uff0c\u56e0\u6b64\u5b83\u4f1a\u5148\u8c03\u7528\u7236\u7c7b\u7684<code>getSingleton()</code>\u65b9\u6cd5\u6765\u76f4\u63a5\u83b7\u53d6\u5355\u4f8b\u5bf9\u8c61\uff0c\u5982\u679c\u6709\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u62ff\u5230Bean\u7684\u5b9e\u4f8b\u3002\u5982\u679cBean\u4e0d\u662f\u5355\u4f8b\u6a21\u5f0f\uff0c\u90a3\u4e48\u4f1a\u8fdb\u5165else\u4ee3\u7801\u5757\u3002\u8fd9\u4e00\u90e8\u5206\u6211\u4eec\u5148\u6765\u770b\u5355\u4f8b\u6a21\u5f0f\u4e0b\u7684\u5904\u7406\uff0c\u5176\u5b9e\u903b\u8f91\u975e\u5e38\u7b80\u5355\uff1a</p> <pre><code>protected &lt;T&gt; T doGetBean(String name, @Nullable Class&lt;T&gt; requiredType, @Nullable Object[] args, boolean typeCheckOnly) throws BeansException {\n    ...\n    if (sharedInstance != null &amp;&amp; args == null) {\n        if (this.logger.isTraceEnabled()) {\n            //\u8fd9\u91cc\u4f1a\u5224\u65adBean\u662f\u5426\u4e3a\u6b63\u5728\u521b\u5efa\u72b6\u6001\uff0c\u4e3a\u4ec0\u4e48\u4f1a\u6709\u8fd9\u79cd\u72b6\u6001\u5462\uff1f\u6211\u4eec\u4f1a\u5728\u540e\u9762\u8fdb\u884c\u4ecb\u7ecd\n            if (this.isSingletonCurrentlyInCreation(beanName)) {\n                this.logger.trace(\"Returning eagerly cached instance of singleton bean '\" + beanName + \"' that is not fully initialized yet - a consequence of a circular reference\");\n            } else {\n                this.logger.trace(\"Returning cached instance of singleton bean '\" + beanName + \"'\");\n            }\n        }\n                //\u8fd9\u91ccgetObjectForBeanInstance\u4f1a\u8fdb\u884c\u6700\u7ec8\u5904\u7406\n        //\u56e0\u4e3aBean\u6709\u4e24\u4e2a\u7279\u6b8a\u7684\u7c7b\u578b\uff0c\u5de5\u5382Bena\u548c\u7a7aBean\uff0c\u6240\u4ee5\u8bf4\u9700\u8981\u5355\u72ec\u5904\u7406\n        //\u5982\u679c\u662f\u666e\u901aBean\u76f4\u63a5\u539f\u6837\u8fd4\u56debeanInstance\u63a5\u6536\u5230\u6700\u7ec8\u7ed3\u679c\n        beanInstance = this.getObjectForBeanInstance(sharedInstance, name, beanName, (RootBeanDefinition)null);\n    } else {\n       ...\n    }\n    //\u6700\u540e\u8fd8\u4f1a\u8fdb\u884c\u4e00\u6b21\u7c7b\u578b\u5224\u65ad\uff0c\u5982\u679c\u90fd\u6ca1\u95ee\u9898\uff0c\u76f4\u63a5\u8fd4\u56debeanInstance\u4f5c\u4e3a\u7ed3\u679c\uff0c\u6211\u4eec\u5c31\u5f97\u5230Bean\u7684\u5b9e\u4f8b\u5bf9\u8c61\u4e86\n    return this.adaptBeanInstance(name, beanInstance, requiredType);\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\u6574\u4e2a\u5355\u4f8bBean\u7684\u521b\u5efa\u8def\u7ebf\u8fd8\u662f\u5f88\u6e05\u6670\u7684\uff0c\u5e76\u6ca1\u6709\u4ec0\u4e48\u5f88\u96be\u7406\u89e3\u7684\u5730\u65b9\uff0c\u5728\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5176\u5b9e\u5c31\u662f\u7b80\u5355\u7684\u521b\u5efa\u5bf9\u8c61\u5b9e\u4f8b\u5e76\u8fd4\u56de\u5373\u53ef\u3002</p> <p>\u5176\u4e2d\u6700\u5173\u952e\u7684\u662f\u5b83\u5bf9\u4e8e\u5faa\u73af\u4f9d\u8d56\u7684\u5904\u7406\u3002\u6211\u4eec\u53d1\u73b0\uff0c\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u5f97\u5230\u5355\u4f8b\u5bf9\u8c61\u540e\uff0c\u4f1a\u6709\u4e00\u4e2a\u5f88\u7279\u6b8a\u7684\u5224\u65ad<code>isSingletonCurrentlyInCreation</code>\uff0c\u8fd9\u4e2a\u662f\u5e72\u561b\u7684\uff1f\u5bf9\u8c61\u4e0d\u5e94\u8be5\u76f4\u63a5\u521b\u5efa\u51fa\u6765\u5417\uff1f\u4e3a\u4ec0\u4e48\u4f1a\u6709\u8fd9\u79cd\u6b63\u5728\u521b\u5efa\u7684\u72b6\u6001\u5462\uff1f\u6211\u4eec\u6765\u63a2\u7a76\u4e00\u4e0b\u3002</p> <p>\u5f00\u59cb\u4e4b\u524d\u5148\u7ed9\u5927\u5bb6\u63d0\u4e2a\u95ee\u9898\uff1a</p> <p>\u73b0\u5728\u6709\u4e24\u4e2aBean\uff0cA\u548cB\u90fd\u662f\u4ee5\u539f\u578b\u6a21\u5f0f\u8fdb\u884c\u521b\u5efa\uff0c\u800cA\u4e2d\u9700\u8981\u6ce8\u5165B\uff0cB\u4e2d\u9700\u8981\u6ce8\u5165A\uff0c\u8fd9\u65f6\u5c31\u4f1a\u51fa\u73b0A\u8fd8\u672a\u521b\u5efa\u5b8c\u6210\uff0c\u5c31\u9700\u8981B\uff0c\u800cB\u8fd9\u65f6\u4e5f\u6ca1\u521b\u5efa\u5b8c\u6210\uff0c\u56e0\u4e3aB\u9700\u8981A\uff0c\u800cA\u7b49\u7740B\uff0cB\u53c8\u7b49\u7740A\uff0c\u8fd9\u6837\u5c31\u53ea\u80fd\u65e0\u9650\u5faa\u73af\u4e0b\u53bb\u4e86\uff08\u5c31\u50cf\u6b7b\u9501\u90a3\u79cd\u611f\u89c9\uff09\u6240\u4ee5\u5c31\u51fa\u73b0\u4e86\u5faa\u73af\u4f9d\u8d56\u7684\u95ee\u9898\uff08\u540c\u7406\uff0c\u4e00\u4e2a\u5bf9\u8c61\u6ce8\u5165\u81ea\u5df1\uff0c\u8fd8\u6709\u4e09\u4e2a\u5bf9\u8c61\u4e4b\u95f4\uff0c\u751a\u81f3\u591a\u4e2a\u5bf9\u8c61\u4e4b\u95f4\u4e5f\u4f1a\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\uff09</p> <p>\u4f46\u662f\uff0c\u5728\u5355\u4f8b\u6a21\u5f0f\u4e0b\uff0c\u7531\u4e8e\u6bcf\u4e2aBean\u53ea\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u53ea\u8981\u80fd\u591f\u5904\u7406\u597d\u5bf9\u8c61\u4e4b\u95f4\u7684\u5f15\u7528\u5173\u7cfb\uff0cSpring\u5b8c\u5168\u6709\u673a\u4f1a\u89e3\u51b3\u5355\u4f8b\u5bf9\u8c61\u5faa\u73af\u4f9d\u8d56\u7684\u95ee\u9898\u3002\u90a3\u4e48\u5355\u4f8b\u6a21\u5f0f\u4e0b\u662f\u5982\u4f55\u89e3\u51b3\u5faa\u73af\u4f9d\u8d56\u95ee\u9898\u7684\u5462\uff1f</p> <p></p> <p>\u6211\u4eec\u56de\u5230\u4e00\u5f00\u59cb\u7684<code>getSingleton()</code>\u65b9\u6cd5\u4e2d\uff0c\u7814\u7a76\u4e00\u4e0b\u5b83\u5230\u5e95\u662f\u5982\u4f55\u5904\u7406\u5faa\u73af\u4f9d\u8d56\u7684\uff0c\u5b83\u662f\u53ef\u4ee5\u81ea\u52a8\u89e3\u51b3\u5faa\u73af\u4f9d\u8d56\u95ee\u9898\u7684\uff1a</p> <pre><code>@Nullable\nprotected Object getSingleton(String beanName, boolean allowEarlyReference) {\n    Object singletonObject = this.singletonObjects.get(beanName);\n    //\u5148\u4ece\u7b2c\u4e00\u5c42\u5217\u8868\u4e2d\u62ffBean\u5b9e\u4f8b\uff0c\u62ff\u5230\u76f4\u63a5\u8fd4\u56de\n    if (singletonObject == null &amp;&amp; this.isSingletonCurrentlyInCreation(beanName)) {\n        //\u5982\u679c\u7b2c\u4e00\u5c42\u62ff\u4e0d\u5230\uff0c\u5e76\u4e14\u5df2\u7ecf\u8ba4\u5b9a\u4e3a\u5904\u4e8e\u5faa\u73af\u72b6\u6001\uff0c\u770b\u770b\u7b2c\u4e8c\u5c42\u6709\u6ca1\u6709\n        singletonObject = this.earlySingletonObjects.get(beanName);\n        //\u8981\u662f\u8fd8\u662f\u6ca1\u6709\uff0c\u7ee7\u7eed\u5f80\u4e0b\n        if (singletonObject == null &amp;&amp; allowEarlyReference) {\n            synchronized(this.singletonObjects) {\n                //\u52a0\u9501\u518d\u6267\u884c\u4e00\u6b21\u4e0a\u8ff0\u6d41\u7a0b\n                singletonObject = this.singletonObjects.get(beanName);\n                if (singletonObject == null) {\n                    singletonObject = this.earlySingletonObjects.get(beanName);\n                    if (singletonObject == null) {\n                        //\u4ecd\u7136\u6ca1\u6709\u83b7\u53d6\u5230\u5b9e\u4f8b\uff0c\u53ea\u80fd\u4ecesingletonFactory\u4e2d\u83b7\u53d6\u4e86\n                        ObjectFactory&lt;?&gt; singletonFactory = (ObjectFactory)this.singletonFactories.get(beanName);\n                        if (singletonFactory != null) {\n                            singletonObject = singletonFactory.getObject();\n                            //\u4e22\u8fdbearlySingletonObjects\u4e2d\uff0c\u4e0b\u6b21\u5c31\u53ef\u4ee5\u76f4\u63a5\u5728\u7b2c\u4e8c\u5c42\u62ff\u5230\u4e86\n                            this.earlySingletonObjects.put(beanName, singletonObject);\n                            this.singletonFactories.remove(beanName);\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    return singletonObject;\n}\n</code></pre> <p>\u770b\u8d77\u6765\u5f88\u590d\u6742\uff0c\u5b9e\u9645\u4e0a\u5b83\u4f7f\u7528\u4e86\u4e09\u7ea7\u7f13\u5b58\u7684\u65b9\u5f0f\u6765\u5904\u7406\u5faa\u73af\u4f9d\u8d56\u7684\u95ee\u9898\uff0c\u5305\u62ec\uff1a</p> <ul> <li>singletonObjects\uff0c\u7528\u4e8e\u4fdd\u5b58\u5b9e\u4f8b\u5316\u3001\u6ce8\u5165\u3001\u521d\u59cb\u5316\u5b8c\u6210\u7684 bean \u5b9e\u4f8b</li> <li>earlySingletonObjects\uff0c\u7528\u4e8e\u4fdd\u5b58\u5b9e\u4f8b\u5316\u5b8c\u6210\u7684 bean \u5b9e\u4f8b</li> <li>singletonFactories\uff0c\u5728\u521d\u59cb\u521b\u5efaBean\u5bf9\u8c61\u65f6\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a\u5bf9\u5e94\u7684\u5355\u4f8b\u5de5\u5382\u7528\u4e8e\u83b7\u53d6\u65e9\u671f\u5bf9\u8c61</li> </ul> <p>\u6211\u4eec\u5148\u6765\u753b\u4e00\u4e2a\u6d41\u7a0b\u56fe\u7406\u6e05\u6574\u4e2a\u8fc7\u7a0b\uff1a</p> <p></p> <p>\u6211\u4eec\u5728\u4e86\u89e3\u8fd9\u4e2a\u6d41\u7a0b\u4e4b\u524d\uff0c\u4e00\u5b9a\u8981\u5148\u660e\u786e\uff0c\u5355\u4f8bBean\u5bf9\u8c61\u7684\u83b7\u53d6\uff0c\u4f1a\u6709\u54ea\u4e9b\u7ed3\u679c\uff0c\u9996\u5148\u5c31\u662f\u5982\u679c\u6211\u4eec\u83b7\u53d6\u7684Bean\u538b\u6839\u5c31\u6ca1\u5728\u5de5\u5382\u4e2d\u6ce8\u518c\uff0c\u90a3\u5f97\u5230\u7684\u7ed3\u679c\u80af\u5b9a\u662fnull\uff1b\u5176\u6b21\uff0c\u5982\u679c\u6211\u4eec\u83b7\u53d6\u7684Bean\u5df2\u7ecf\u6ce8\u518c\u4e86\uff0c\u90a3\u4e48\u80af\u5b9a\u5c31\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u5355\u4f8b\u5bf9\u8c61\uff0c\u53ea\u662f\u4e0d\u6e05\u695a\u521b\u5efa\u5230\u54ea\u4e00\u4e2a\u9636\u6bb5\u4e86\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u6839\u636e\u4e0a\u9762\u7684\u6d41\u7a0b\u56fe\uff0c\u6765\u6a21\u62df\u4e00\u4e0bA\u548cB\u5faa\u73af\u4f9d\u8d56\u7684\u60c5\u51b5\uff1a</p> <p></p> <p>\u6709\u7684\u5c0f\u4f19\u4f34\u5c31\u4f1a\u6709\u7591\u95ee\u4e86\uff0c\u770b\u8d77\u6765\u4f3c\u4e4e\u4e24\u7ea7\u7f13\u5b58\u4e5f\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u554a\uff0c\u5e72\u561b\u641e\u4e09\u5c42\u800c\u4e14\u8fd8\u641e\u4e2a\u5bf9\u8c61\u5de5\u5382\uff1f\u8fd9\u4e0d\u662f\u591a\u6b64\u4e00\u4e3e\u5417\uff1f\u5b9e\u9645\u4e0a\u8fd9\u662f\u4e3a\u4e86\u6ee1\u8db3Bean\u7684\u751f\u547d\u5468\u671f\u800c\u505a\u7684\uff0c\u901a\u8fc7\u5de5\u5382\u83b7\u53d6\u65e9\u671f\u5bf9\u8c61\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>protected Object getEarlyBeanReference(String beanName, RootBeanDefinition mbd, Object bean) {\n    Object exposedObject = bean;\n    //\u8fd9\u91cc\u5f88\u5173\u952e\uff0c\u4f1a\u5bf9\u4e00\u4e9b\u7279\u522b\u7684BeanPostProcessor\u8fdb\u884c\u5904\u7406\uff0c\u6bd4\u5982AOP\u4ee3\u7406\u76f8\u5173\u7684\uff0c\u5982\u679c\u8fd9\u4e2aBean\u662f\u88abAOP\u4ee3\u7406\u7684\uff0c\u6211\u4eec\u9700\u8981\u5f97\u5230\u7684\u662f\u4e00\u4e2a\u7ecf\u8fc7AOP\u4ee3\u7406\u7684\u5bf9\u8c61\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u521b\u5efa\u51fa\u6765\u7684\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u9700\u8981BeanPostProcessor\u6765\u5b8c\u6210\uff08AOP\u4ea7\u751f\u4ee3\u7406\u5bf9\u8c61\u7684\u903b\u8f91\u662f\u5728\u5c5e\u6027\u586b\u5145\u4e4b\u540e\uff0c\u56e0\u6b64\u53ea\u80fd\u518d\u52a0\u4e00\u7ea7\u8fdb\u884c\u7f13\u51b2\uff09\n    if (!mbd.isSynthetic() &amp;&amp; hasInstantiationAwareBeanPostProcessors()) {\n        for (SmartInstantiationAwareBeanPostProcessor bp : getBeanPostProcessorCache().smartInstantiationAware) {\n            exposedObject = bp.getEarlyBeanReference(exposedObject, beanName);\n        }\n    }\n    return exposedObject;\n}\n</code></pre> <p>\u6211\u4eec\u4f1a\u5728\u540e\u9762\u7684\u90e8\u5206\u4e2d\u8be6\u7ec6\u4ecb\u7ecdBeanPostProcessor\u4ee5\u53caAOP\u7684\u5b9e\u73b0\u539f\u7406\uff0c\u5c4a\u65f6\u5404\u4f4d\u518d\u56de\u6765\u770b\u5c31\u4f1a\u660e\u767d\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#aop_4","title":"\u540e\u7f6e\u5904\u7406\u5668\u4e0eAOP","text":"<p>\u63a5\u7740\u6211\u4eec\u6765\u4ecb\u7ecd\u4e00\u4e0b<code>PostProcessor</code>\uff0c\u5b83\u5176\u5b9e\u662fSpring\u63d0\u4f9b\u7684\u4e00\u79cd\u540e\u7f6e\u5904\u7406\u673a\u5236\uff0c\u5b83\u53ef\u4ee5\u8ba9\u6211\u4eec\u80fd\u591f\u63d2\u624bBean\u3001BeanFactory\u3001BeanDefinition\u7684\u521b\u5efa\u8fc7\u7a0b\uff0c\u76f8\u5f53\u4e8e\u8fdb\u884c\u4e00\u4e2a\u6700\u7ec8\u7684\u5904\u7406\uff0c\u800c\u6700\u540e\u5f97\u5230\u7684\u7ed3\u679c\uff08\u6bd4\u5982Bean\u5b9e\u4f8b\u3001Bean\u5b9a\u4e49\u7b49\uff09\u5c31\u662f\u7ecf\u8fc7\u540e\u7f6e\u5904\u7406\u5668\u8fd4\u56de\u7684\u7ed3\u679c\uff0c\u5b83\u662f\u6574\u4e2a\u52a0\u8f7d\u8fc7\u7a0b\u7684\u6700\u540e\u4e00\u6b65\u3002</p> <p>\u800cAOP\u673a\u5236\u6b63\u662f\u901a\u8fc7\u5b83\u6765\u5b9e\u73b0\u7684\uff0c\u6211\u4eec\u9996\u5148\u6765\u8ba4\u8bc6\u4e00\u4e0b\u7b2c\u4e00\u4e2a\u63a5\u53e3<code>BeanPostProcessor</code>\uff0c\u5b83\u76f8\u5f53\u4e8eBean\u521d\u59cb\u5316\u7684\u4e00\u4e2a\u540e\u7f6e\u52a8\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5b9e\u73b0\u6b64\u63a5\u53e3\uff1a</p> <pre><code>//\u6ce8\u610f\u5b83\u540e\u7f6e\u5904\u7406\u5668\u4e5f\u8981\u8fdb\u884c\u6ce8\u518c\n@Component\npublic class TestBeanProcessor implements BeanPostProcessor {\n    @Override\n    public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {\n        System.out.println(beanName);  //\u6253\u5370bean\u7684\u540d\u79f0\n        return bean;\n    }\n\n    @Override\n    public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {\n        return BeanPostProcessor.super.postProcessBeforeInitialization(bean, beanName);\n    }\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u6b64\u63a5\u53e3\u4e2d\u5305\u62ec\u4e24\u4e2a\u65b9\u6cd5\uff0c\u4e00\u4e2a\u662f<code>postProcessAfterInitialization</code>\u7528\u4e8e\u5728Bean\u521d\u59cb\u5316\u4e4b\u540e\u8fdb\u884c\u5904\u7406\uff0c\u8fd8\u6709\u4e00\u4e2a<code>postProcessBeforeInitialization</code>\u7528\u4e8e\u5728Bean\u521d\u59cb\u5316\u4e4b\u524d\u8fdb\u884c\u5904\u7406\uff0c\u6ce8\u610f\u8fd9\u91cc\u7684\u521d\u59cb\u5316\u4e0d\u662f\u521b\u5efa\u5bf9\u8c61\uff0c\u800c\u662f\u8c03\u7528\u7c7b\u7684\u521d\u59cb\u5316\u65b9\u6cd5\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@Component\npublic class TestBeanProcessor implements BeanPostProcessor {\n    @Override\n    public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {\n        System.out.println(\"\u6211\u662f\u4e4b\u540e\uff1a\"+beanName);\n        return bean;   //\u8fd9\u91cc\u8fd4\u56de\u7684Bean\u76f8\u5f53\u4e8e\u6700\u7ec8\u7684\u7ed3\u679c\u4e86\uff0c\u6211\u4eec\u4f9d\u7136\u80fd\u591f\u63d2\u624b\u4fee\u6539\uff0c\u8fd9\u91cc\u8fd4\u56de\u4e4b\u540e\u662f\u4ec0\u4e48\u5c31\u662f\u4ec0\u4e48\u4e86\n    }\n\n    @Override\n    public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {\n        System.out.println(\"\u6211\u662f\u4e4b\u524d\uff1a\"+beanName);\n        return bean;   //\u8fd9\u91cc\u8fd4\u56de\u7684Bean\u4f1a\u4ea4\u7ed9\u4e0b\u4e00\u4e2a\u9636\u6bb5\uff0c\u4e5f\u5c31\u662f\u521d\u59cb\u5316\u65b9\u6cd5\n    }\n}\n</code></pre> <pre><code>@Component\npublic class TestServiceImpl implements TestService{\n\n    public TestServiceImpl(){\n        System.out.println(\"\u6211\u662f\u6784\u9020\u65b9\u6cd5\");\n    }\n\n    @PostConstruct\n    public void init(){\n        System.out.println(\"\u6211\u662f\u521d\u59cb\u5316\u65b9\u6cd5\");\n    }\n\n    TestMapper mapper;\n\n    @Autowired\n    public void setMapper(TestMapper mapper) {\n        System.out.println(\"\u6211\u662f\u4f9d\u8d56\u6ce8\u5165\");\n        this.mapper = mapper;\n    }\n\n    ...\n</code></pre> <p>\u800cTestServiceImpl\u7684\u52a0\u8f7d\u987a\u5e8f\u4e3a\uff1a</p> <pre><code>\u6211\u662f\u6784\u9020\u65b9\u6cd5\n\u6211\u662f\u4f9d\u8d56\u6ce8\u5165\n\u6211\u662f\u4e4b\u524d\uff1atestServiceImpl\n\u6211\u662f\u521d\u59cb\u5316\u65b9\u6cd5\n\u6211\u662f\u4e4b\u540e\uff1atestServiceImpl\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u518d\u6765\u603b\u7ed3\u4e00\u4e0b\u4e00\u4e2aBean\u7684\u52a0\u8f7d\u6d41\u7a0b\uff1a</p> <p>[Bean\u5b9a\u4e49]\u9996\u5148\u626b\u63cfBean\uff0c\u52a0\u8f7dBean\u5b9a\u4e49 -&gt; [\u4f9d\u8d56\u6ce8\u5165]\u6839\u636eBean\u5b9a\u4e49\u901a\u8fc7\u53cd\u5c04\u521b\u5efaBean\u5b9e\u4f8b -&gt; [\u4f9d\u8d56\u6ce8\u5165]\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165\uff08\u987a\u4fbf\u89e3\u51b3\u5faa\u73af\u4f9d\u8d56\u95ee\u9898\uff09-&gt; [\u521d\u59cb\u5316Bean]BeanPostProcessor\u7684\u521d\u59cb\u5316\u4e4b\u524d\u65b9\u6cd5 -&gt; [\u521d\u59cb\u5316Bean]Bean\u521d\u59cb\u5316\u65b9\u6cd5 -&gt; [\u521d\u59cb\u5316Bean]BeanPostProcessor\u7684\u521d\u59cb\u5316\u4e4b\u540e\u65b9\u6cd5 -&gt; [\u5b8c\u6210]\u6700\u7ec8\u5f97\u5230\u7684Bean\u52a0\u8f7d\u5b8c\u6210\u7684\u5b9e\u4f8b</p> <p>\u5229\u7528\u8fd9\u79cd\u673a\u5236\uff0c\u7406\u89e3Aop\u7684\u5b9e\u73b0\u8fc7\u7a0b\u5c31\u975e\u5e38\u7b80\u5355\u4e86\uff0cAOP\u5b9e\u9645\u4e0a\u4e5f\u662f\u901a\u8fc7\u8fd9\u79cd\u673a\u5236\u5b9e\u73b0\u7684\uff0c\u5b83\u7684\u5b9e\u73b0\u7c7b\u662f<code>AnnotationAwareAspectJAutoProxyCreator</code>\uff0c\u800c\u5b83\u5c31\u662f\u5728\u6700\u540e\u5bf9Bean\u8fdb\u884c\u4e86\u4ee3\u7406\uff0c\u56e0\u6b64\u6700\u540e\u6211\u4eec\u5f97\u5230\u7684\u7ed3\u679c\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u52a8\u6001\u4ee3\u7406\u7684\u5bf9\u8c61\uff08\u6709\u5173\u8be6\u7ec6\u5b9e\u73b0\u8fc7\u7a0b\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8fdb\u884c\u5217\u4e3e\u4e86\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u7ee7\u7eed\u6df1\u5165\uff09\u56e0\u6b64\uff0c\u5b9e\u9645\u4e0a\u4e4b\u524d\u8bbe\u8ba1\u7684\u4e09\u5c42\u7f13\u5b58\uff0c\u90fd\u662f\u7531\u4e8e\u9700\u8981\u5904\u7406AOP\u8bbe\u8ba1\u7684\uff0c\u56e0\u4e3a\u5728Bean\u521b\u5efa\u5f97\u5230\u6700\u7ec8\u5bf9\u8c61\u4e4b\u524d\uff0c\u5f88\u6709\u53ef\u80fd\u4f1a\u88abPostProcessor\u7ed9\u5077\u6881\u6362\u67f1\uff01</p> <p>\u90a3\u4e48\u80af\u5b9a\u6709\u4eba\u6709\u7591\u95ee\u4e86\uff0c\u8fd9\u4e2a\u7c7b\u6ca1\u6709\u88ab\u6ce8\u518c\u554a\uff0c\u90a3\u6309\u7406\u8bf4\u5b83\u4e0d\u5e94\u8be5\u53c2\u4e0e\u5230Bean\u7684\u521d\u59cb\u5316\u6d41\u7a0b\u4e2d\u7684\uff0c\u4e3a\u4ec0\u4e48\u5b83\u76f4\u63a5\u5c31\u88ab\u52a0\u8f7d\u4e86\u5462\uff1f</p> <p>\u8fd8\u8bb0\u5f97<code>@EnableAspectJAutoProxy</code>\u5417\uff1f\u6211\u4eec\u6765\u770b\u770b\u5b83\u662f\u5982\u4f55\u5b9a\u4e49\u5c31\u77e5\u9053\u4e86\uff1a</p> <pre><code>@Target({ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Import({AspectJAutoProxyRegistrar.class})\npublic @interface EnableAspectJAutoProxy {\n    boolean proxyTargetClass() default false;\n\n    boolean exposeProxy() default false;\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u5b83\u4f7f\u7528\u4e86<code>@Import</code>\u6765\u6ce8\u518c<code>AspectJAutoProxyRegistrar</code>\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7c7b\u53c8\u662f\u4ec0\u4e48\u5462\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\uff1a</p> <pre><code>class AspectJAutoProxyRegistrar implements ImportBeanDefinitionRegistrar {\n    AspectJAutoProxyRegistrar() {\n    }\n\n    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {\n        //\u6ce8\u518cAnnotationAwareAspectJAutoProxyCreator\u5230\u5bb9\u5668\u4e2d\n        AopConfigUtils.registerAspectJAnnotationAutoProxyCreatorIfNecessary(registry);\n        AnnotationAttributes enableAspectJAutoProxy = AnnotationConfigUtils.attributesFor(importingClassMetadata, EnableAspectJAutoProxy.class);\n        if (enableAspectJAutoProxy != null) {\n            if (enableAspectJAutoProxy.getBoolean(\"proxyTargetClass\")) {\n                AopConfigUtils.forceAutoProxyCreatorToUseClassProxying(registry);\n            }\n\n            if (enableAspectJAutoProxy.getBoolean(\"exposeProxy\")) {\n                AopConfigUtils.forceAutoProxyCreatorToExposeProxy(registry);\n            }\n        }\n\n    }\n}\n</code></pre> <p>\u5b83\u5b9e\u73b0\u4e86\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u4e5f\u662fSpring\u63d0\u4f9b\u7684\u4e00\u79cdBean\u52a0\u8f7d\u673a\u5236\uff0c\u5b83\u652f\u6301\u76f4\u63a5\u5411\u5bb9\u5668\u4e2d\u6dfb\u52a0Bean\u5b9a\u4e49\uff0c\u5bb9\u5668\u4e5f\u4f1a\u52a0\u8f7d\u8fd9\u4e2aBean\uff1a</p> <ul> <li>ImportBeanDefinitionRegistrar\u7c7b\u53ea\u80fd\u901a\u8fc7\u5176\u4ed6\u7c7b@Import\u7684\u65b9\u5f0f\u6765\u52a0\u8f7d\uff0c\u901a\u5e38\u662f\u542f\u52a8\u7c7b\u6216\u914d\u7f6e\u7c7b\u3002</li> <li>\u4f7f\u7528@Import\uff0c\u5982\u679c\u62ec\u53f7\u4e2d\u7684\u7c7b\u662fImportBeanDefinitionRegistrar\u7684\u5b9e\u73b0\u7c7b\uff0c\u5219\u4f1a\u8c03\u7528\u63a5\u53e3\u4e2d\u65b9\u6cd5\uff08\u4e00\u822c\u7528\u4e8e\u6ce8\u518cBean\uff09</li> <li>\u5b9e\u73b0\u8be5\u63a5\u53e3\u7684\u7c7b\u62e5\u6709\u6ce8\u518cbean\u7684\u80fd\u529b\u3002</li> </ul> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6b64\u63a5\u53e3\u63d0\u4f9b\u4e86\u4e00\u4e2a<code>BeanDefinitionRegistry</code>\u6b63\u662f\u7528\u4e8e\u6ce8\u518cBean\u7684\u5b9a\u4e49\u7684\u3002</p> <p>\u56e0\u6b64\uff0c\u5f53\u6211\u4eec\u6253\u4e0a\u4e86<code>@EnableAspectJAutoProxy</code>\u6ce8\u89e3\u4e4b\u540e\uff0c\u9996\u5148\u4f1a\u901a\u8fc7<code>@Import</code>\u52a0\u8f7dAspectJAutoProxyRegistrar\uff0c\u7136\u540e\u8c03\u7528\u5176<code>registerBeanDefinitions</code>\u65b9\u6cd5\uff0c\u7136\u540e\u4f7f\u7528\u5de5\u5177\u7c7b\u6ce8\u518cAnnotationAwareAspectJAutoProxyCreator\u5230\u5bb9\u5668\u4e2d\uff0c\u8fd9\u6837\u5728\u6bcf\u4e2aBean\u521b\u5efa\u4e4b\u540e\uff0c\u5982\u679c\u9700\u8981\u4f7f\u7528AOP\uff0c\u90a3\u4e48\u5c31\u4f1a\u901a\u8fc7AOP\u7684\u540e\u7f6e\u5904\u7406\u5668\u8fdb\u884c\u5904\u7406\uff0c\u6700\u540e\u8fd4\u56de\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\u3002</p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u7f16\u5199\u4e00\u4e2a\u81ea\u5df1\u7684ImportBeanDefinitionRegistrar\u5b9e\u73b0\uff0c\u9996\u5148\u7f16\u5199\u4e00\u4e2a\u6d4b\u8bd5Bean\uff1a</p> <pre><code>public class TestBean {\n\n    @PostConstruct\n    void init(){\n        System.out.println(\"\u6211\u88ab\u521d\u59cb\u5316\u4e86\uff01\");\n    }\n}\n</code></pre> <pre><code>public class TestBeanDefinitionRegistrar implements ImportBeanDefinitionRegistrar {\n\n    @Override\n    public void registerBeanDefinitions(AnnotationMetadata importingClassMetadata, BeanDefinitionRegistry registry) {\n        BeanDefinition definition = BeanDefinitionBuilder.rootBeanDefinition(Student.class).getBeanDefinition();\n        registry.registerBeanDefinition(\"lbwnb\", definition);\n    }\n}\n</code></pre> <p>\u89c2\u5bdf\u63a7\u5236\u53f0\u8f93\u51fa\uff0c\u6210\u529f\u52a0\u8f7dBean\u5b9e\u4f8b\u3002</p> <p>\u4e0e<code>BeanPostProcessor</code>\u5dee\u4e0d\u591a\u7684\u8fd8\u6709<code>BeanFactoryPostProcessor</code>\uff0c\u5b83\u548c\u524d\u8005\u4e00\u6837\uff0c\u4e5f\u662f\u7528\u4e8e\u6211\u4eec\u81ea\u5df1\u5904\u7406\u540e\u7f6e\u52a8\u4f5c\u7684\uff0c\u4e0d\u8fc7\u8fd9\u91cc\u662f\u7528\u4e8e\u5904\u7406BeanFactory\u52a0\u8f7d\u7684\u540e\u7f6e\u52a8\u4f5c\uff0c<code>BeanDefinitionRegistryPostProcessor</code>\u76f4\u63a5\u7ee7\u627f\u81ea<code>BeanFactoryPostProcessor</code>\uff0c\u5e76\u4e14\u8fd8\u6dfb\u52a0\u4e86\u65b0\u7684\u52a8\u4f5c<code>postProcessBeanDefinitionRegistry</code>\uff0c\u4f60\u53ef\u4ee5\u5728\u8fd9\u91cc\u52a8\u6001\u6dfb\u52a0Bean\u5b9a\u4e49\u6216\u662f\u4fee\u6539\u5df2\u7ecf\u5b58\u5728\u7684Bean\u5b9a\u4e49\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u76f4\u63a5\u6f14\u793a<code>BeanDefinitionRegistryPostProcessor</code>\u7684\u5b9e\u73b0\uff1a</p> <pre><code>@Component\npublic class TestDefinitionProcessor implements BeanDefinitionRegistryPostProcessor {\n    @Override\n    public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) throws BeansException {\n        System.out.println(\"\u6211\u662fBean\u5b9a\u4e49\u540e\u7f6e\u5904\u7406\uff01\");\n        BeanDefinition definition = BeanDefinitionBuilder.rootBeanDefinition(TestBean.class).getBeanDefinition();\n        registry.registerBeanDefinition(\"lbwnb\", definition);\n    }\n\n    @Override\n    public void postProcessBeanFactory(ConfigurableListableBeanFactory configurableListableBeanFactory) throws BeansException {\n        System.out.println(\"\u6211\u662fBean\u5de5\u5382\u540e\u7f6e\u5904\u7406\uff01\");\n    }\n}\n</code></pre> <p>\u5728\u8fd9\u91cc\u6ce8\u518cBean\u5b9a\u4e49\u5176\u5b9e\u548c\u4e4b\u524d\u90a3\u79cd\u65b9\u6cd5\u6548\u679c\u4e00\u6837\u3002</p> <p>\u6700\u540e\uff0c\u6211\u4eec\u518d\u5b8c\u5584\u4e00\u4e0bBean\u52a0\u8f7d\u6d41\u7a0b\uff08\u52a0\u7c97\u90e8\u5206\u662f\u65b0\u589e\u7684\uff09\uff1a</p> <p>[Bean\u5b9a\u4e49]\u9996\u5148\u626b\u63cfBean\uff0c\u52a0\u8f7dBean\u5b9a\u4e49 -&gt; [Bean\u5b9a\u4e49]Bean\u5b9a\u4e49\u548cBean\u5de5\u5382\u540e\u7f6e\u5904\u7406 -&gt; [\u4f9d\u8d56\u6ce8\u5165]\u6839\u636eBean\u5b9a\u4e49\u901a\u8fc7\u53cd\u5c04\u521b\u5efaBean\u5b9e\u4f8b -&gt; [\u4f9d\u8d56\u6ce8\u5165]\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165\uff08\u987a\u4fbf\u89e3\u51b3\u5faa\u73af\u4f9d\u8d56\u95ee\u9898\uff09-&gt; [\u521d\u59cb\u5316Bean]BeanPostProcessor\u7684\u521d\u59cb\u5316\u4e4b\u524d\u65b9\u6cd5 -&gt; [\u521d\u59cb\u5316Bean]Bean\u521d\u59cb\u5316\u65b9\u6cd5 -&gt; [\u521d\u59cb\u5316Bean]BeanPostProcessor\u7684\u521d\u59cb\u5316\u4e4b\u524d\u540e\u65b9\u6cd5 -&gt; [\u5b8c\u6210]\u6700\u7ec8\u5f97\u5230\u7684Bean\u52a0\u8f7d\u5b8c\u6210\u7684\u5b9e\u4f8b</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#_12","title":"\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u8be6\u89e3","text":"<p>\u524d\u9762\u6211\u4eec\u8be6\u7ec6\u4ecb\u7ecd\u4e86BeanFactory\u662f\u5982\u4f55\u5de5\u4f5c\u7684\uff0c\u63a5\u7740\u6211\u4eec\u6765\u7814\u7a76\u4e00\u4e0bApplicationContext\u7684\u5185\u90e8\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u771f\u6b63\u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u7684\u5c31\u662fApplicationContext\u7684\u5b9e\u73b0\uff0c\u90a3\u4e48\u5b83\u53c8\u662f\u5982\u4f55\u5de5\u4f5c\u7684\u5462\u3002</p> <pre><code>public interface ApplicationContext extends EnvironmentCapable, ListableBeanFactory, HierarchicalBeanFactory, MessageSource, ApplicationEventPublisher, ResourcePatternResolver {\n    @Nullable\n    String getId();\n    String getApplicationName();\n    String getDisplayName();\n    long getStartupDate();\n    @Nullable\n    ApplicationContext getParent();\n    AutowireCapableBeanFactory getAutowireCapableBeanFactory() throws IllegalStateException;\n}\n</code></pre> <p>\u5b83\u672c\u8eab\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u540c\u65f6\u96c6\u6210\u4e86\u591a\u79cd\u7c7b\u578b\u7684BeanFactory\u63a5\u53e3\uff0c\u8bf4\u660e\u5b83\u5e94\u8be5\u5177\u6709\u8fd9\u4e9bBeanFactory\u7684\u80fd\u529b\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u5728\u524d\u9762\u5df2\u7ecf\u63d0\u5230\u8fc7\uff0cApplicationContext\u662f\u4f9d\u9760\u5185\u90e8\u7ef4\u62a4\u7684BeanFactory\u5bf9\u8c61\u6765\u5b8c\u6210\u8fd9\u4e9b\u529f\u80fd\u7684\uff0c\u5e76\u4e0d\u662f\u5b83\u672c\u8eab\u5c31\u5b9e\u73b0\u4e86\u8fd9\u4e9b\u529f\u80fd\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5c31\u5148\u4ece\u6784\u9020\u65b9\u6cd5\u5f00\u59cb\u8d70\u8d77\uff0c\u4ee5\u6211\u4eec\u5e38\u7528\u7684AnnotationConfigApplicationContext\u4e3a\u4f8b\uff1a</p> <pre><code>public AnnotationConfigApplicationContext(Class&lt;?&gt;... componentClasses) {\n        this();                      //1. \u9996\u5148\u4f1a\u8c03\u7528\u81ea\u5df1\u7684\u65e0\u53c2\u6784\u9020\n        register(componentClasses);  //2. \u7136\u540e\u6ce8\u518c\u6211\u4eec\u4f20\u5165\u7684\u914d\u7f6e\u7c7b\n        refresh();                   //3. \u6700\u540e\u8fdb\u884c\u5237\u65b0\u64cd\u4f5c\uff08\u5173\u952e\uff09\n}\n</code></pre> <p>\u5148\u6765\u770b\u7b2c\u4e00\u6b65\uff1a</p> <pre><code>public GenericApplicationContext() {\n    //\u7236\u7c7b\u9996\u5148\u521d\u59cb\u5316\u5185\u90e8\u7ef4\u62a4\u7684BeanFactory\u5bf9\u8c61\n        this.beanFactory = new DefaultListableBeanFactory();\n}\n</code></pre> <pre><code>public AnnotationConfigApplicationContext() {\n        StartupStep createAnnotatedBeanDefReader = this.getApplicationStartup().start(\"spring.context.annotated-bean-reader.create\");\n    //\u521b\u5efaAnnotatedBeanDefinitionReader\u5bf9\u8c61\uff0c\u7528\u4e8e\u540e\u7eed\u5904\u7406 @Bean \u6ce8\u89e3\n        this.reader = new AnnotatedBeanDefinitionReader(this);\n        createAnnotatedBeanDefReader.end();\n    //\u521b\u5efaClassPathBeanDefinitionScanner\u5bf9\u8c61\uff0c\u7528\u4e8e\u626b\u63cf\u7c7b\u8def\u5f84\u4e0a\u7684Bean\n        this.scanner = new ClassPathBeanDefinitionScanner(this);\n}\n</code></pre> <p>\u8fd9\u6837\uff0cAnnotationConfigApplicationContext\u7684\u57fa\u672c\u5185\u5bb9\u5c31\u521d\u59cb\u5316\u597d\u4e86\uff0c\u4e0d\u8fc7\u8fd9\u91cc\u7ed3\u675f\u4e4b\u540e\u4f1a\u5c06ConfigurationClassPostProcessor\u540e\u7f6e\u5904\u7406\u5668\u52a0\u5165\u5230BeanFactory\u4e2d\uff0c\u5b83\u7ee7\u627f\u81eaBeanFactoryPostProcessor\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u4f1a\u4f1a\u5728BeanFactory\u521d\u59cb\u5316\u5b8c\u6210\u4e4b\u540e\u8fdb\u884c\u540e\u7f6e\u5904\u7406\uff1a</p> <pre><code>public AnnotatedBeanDefinitionReader(BeanDefinitionRegistry registry, Environment environment) {\n        Assert.notNull(registry, \"BeanDefinitionRegistry must not be null\");\n        Assert.notNull(environment, \"Environment must not be null\");\n        this.registry = registry;\n        this.conditionEvaluator = new ConditionEvaluator(registry, environment, null);\n    //\u8fd9\u91cc\u6ce8\u518c\u4e86\u6ce8\u89e3\u5904\u7406\u914d\u7f6e\u76f8\u5173\u7684\u540e\u7f6e\u5904\u7406\u5668\n        AnnotationConfigUtils.registerAnnotationConfigProcessors(this.registry);\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u540e\u7f6e\u5904\u7406\u5668\u7684\u4e3b\u8981\u76ee\u7684\u5c31\u662f\u4e3a\u4e86\u8bfb\u53d6\u914d\u7f6e\u7c7b\u4e2d\u7684\u5404\u79cdBean\u5b9a\u4e49\u4ee5\u53ca\u5176\u4ed6\u6ce8\u89e3\uff0c\u6bd4\u5982@Import\u3001@ComponentScan\u7b49\u3002</p> <p>\u540c\u65f6\u8fd9\u91cc\u4e5f\u4f1a\u6ce8\u518c\u4e00\u4e2aAutowiredAnnotationBeanPostProcessor\u540e\u7f6e\u5904\u7406\u5668\u5230BeanFactory\uff0c\u5b83\u7ee7\u627f\u81eaBeanPostProcessor\uff0c\u7528\u4e8e\u5904\u7406\u540e\u7eed\u751f\u6210\u7684Bean\u5bf9\u8c61\uff0c\u5176\u5b9e\u770b\u540d\u5b57\u5c31\u77e5\u9053\uff0c\u8fd9\u73a9\u610f\u5c31\u662f\u4e3a\u4e86\u5904\u7406@Autowire\u3001@Value\u8fd9\u79cd\u6ce8\u89e3\uff0c\u7528\u4e8e\u81ea\u52a8\u6ce8\u5165\uff0c\u8fd9\u91cc\u5c31\u4e0d\u6df1\u5165\u8bb2\u89e3\u5177\u4f53\u5b9e\u73b0\u4e86\u3002</p> <p>\u6240\u4ee5\uff0c\u7b2c\u4e00\u6b65\u7ed3\u675f\u4e4b\u540e\uff0c\u5c31\u4f1a\u6709\u8fd9\u4e24\u4e2a\u5173\u952e\u7684\u540e\u7f6e\u5904\u7406\u5668\u653e\u5728\u5bb9\u5668\u4e2d\uff1a</p> <p></p> <p>\u63a5\u7740\u662f\u7b2c\u4e8c\u6b65\uff0c\u6ce8\u518c\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>@Override\npublic void register(Class&lt;?&gt;... componentClasses) {\n        Assert.notEmpty(componentClasses, \"At least one component class must be specified\");\n        StartupStep registerComponentClass = this.getApplicationStartup().start(\"spring.context.component-classes.register\")\n                .tag(\"classes\", () -&gt; Arrays.toString(componentClasses));\n    //\u4f7f\u7528\u6211\u4eec\u4e0a\u9762\u521b\u5efa\u7684Reader\u6ce8\u518c\u914d\u7f6e\u7c7b\n        this.reader.register(componentClasses);\n        registerComponentClass.end();\n}\n</code></pre> <p>\u73b0\u5728\u914d\u7f6e\u7c7b\u5df2\u7ecf\u6210\u529f\u6ce8\u518c\u5230IoC\u5bb9\u5668\u4e2d\u4e86\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\u7b2c\u4e09\u6b65\uff0c\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u77e5\u7684\u4ec5\u4ec5\u662f\u6ce8\u518c\u4e86\u914d\u7f6e\u7c7b\u7684Bean\uff0c\u800c\u5237\u65b0\u64cd\u4f5c\u5c31\u662f\u914d\u7f6e\u6240\u6709Bean\u7684\u5173\u952e\u90e8\u5206\u4e86\uff0c\u5237\u65b0\u64cd\u4f5c\u662f\u5728 AbstractApplicationContext \u4e2d\u5b9e\u73b0\u7684\uff1a</p> <pre><code>@Override\npublic void refresh() throws BeansException, IllegalStateException {\n        synchronized (this.startupShutdownMonitor) {\n            StartupStep contextRefresh = this.applicationStartup.start(\"spring.context.refresh\");\n            // \u51c6\u5907\u5f53\u524d\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\uff0c\u8fdb\u884c\u5237\u65b0\u3001\u8bbe\u7f6e\u542f\u52a8\u4e8b\u4ef6\u548c\u6d3b\u52a8\u6807\u5fd7\u4ee5\u53ca\u6267\u884c\u5176\u4ed6\u521d\u59cb\u5316\n            prepareRefresh();\n            // \u8fd9\u4e2a\u65b9\u6cd5\u7531\u5b50\u7c7b\u5b9e\u73b0\uff0c\u5bf9\u5185\u90e8\u7ef4\u62a4\u7684BeanFactory\u8fdb\u884c\u5237\u65b0\u64cd\u4f5c\uff0c\u7136\u540e\u8fd4\u56de\u8fd9\u4e2aBeanFactory\n            ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();\n            // \u521d\u59cb\u5316\u914d\u7f6eBean\u5de5\u5382\uff0c\u6bd4\u5982\u4e00\u4e9b\u4f1a\u7528\u5230\u7684\u7c7b\u52a0\u8f7d\u5668\u548c\u540e\u7f6e\u5904\u7406\u5668\u3002\n            prepareBeanFactory(beanFactory);\n            try {\n                // \u7531\u5b50\u7c7b\u5b9e\u73b0\u5bf9BeanFactory\u7684\u5176\u4ed6\u540e\u7f6e\u5904\u7406\uff0c\u76ee\u524d\u6ca1\u6709\u770b\u5230\u6709\u5b9e\u73b0\n                postProcessBeanFactory(beanFactory);\n                StartupStep beanPostProcess = this.applicationStartup.start(\"spring.context.beans.post-process\");\n                // \u5b9e\u4f8b\u5316\u5e76\u8c03\u7528\u6240\u6709\u6ce8\u518c\u7684 BeanFactoryPostProcessor \u7c7b\u578b\u7684Bean\n        // \u8fd9\u4e00\u6b65\u4e2d\uff0c\u4e0a\u9762\u63d0\u5230\u7684BeanFactoryPostProcessor\u5c31\u5f00\u59cb\u5de5\u4f5c\u4e86\uff0c\u6bd4\u5982\u5305\u626b\u63cf\u3001\u89e3\u6790Bean\u914d\u7f6e\u7b49\n        // \u8fd9\u4e00\u6b65\u7ed3\u675f\u4e4b\u540e\uff0c\u5305\u626b\u63cf\u5230\u7684\u5176\u4ed6Bean\u5c31\u6ce8\u518c\u5230BeanFactory\u4e2d\u4e86\n                invokeBeanFactoryPostProcessors(beanFactory);\n                // \u5b9e\u4f8b\u5316\u5e76\u6ce8\u518c\u6240\u6709 BeanPostProcessor \u7c7b\u578b\u7684 Bean\uff0c\u4e0d\u6025\u7740\u6267\u884c\n                registerBeanPostProcessors(beanFactory);\n                beanPostProcess.end();\n                initMessageSource();\n                initApplicationEventMulticaster();\n                // \u4f9d\u7136\u662f\u63d0\u4f9b\u7ed9\u5b50\u7c7b\u5b9e\u73b0\u7684\uff0c\u76ee\u7684\u662f\u7528\u4e8e\u5904\u7406\u4e00\u4e9b\u5176\u4ed6\u6bd4\u8f83\u7279\u6b8a\u7684Bean\uff0c\u76ee\u524d\u4f3c\u4e4e\u4e5f\u6ca1\u770b\u5230\u6709\u5b9e\u73b0\n                onRefresh();\n                // \u6ce8\u518c\u6240\u6709\u7684\u76d1\u542c\u5668\n                registerListeners();\n                // \u5c06\u5269\u4f59\u6240\u6709\u975e\u61d2\u52a0\u8f7d\u5355\u4f8bBean\u5168\u90e8\u5b9e\u4f8b\u5316\n                finishBeanFactoryInitialization(beanFactory);\n                finishRefresh();\n            } catch (BeansException ex) {\n                ...\n                // \u53d1\u73b0\u5f02\u5e38\u76f4\u63a5\u9500\u6bc1\u6240\u6709Bean\n                destroyBeans();\n                // \u53d6\u6d88\u672c\u6b21\u5237\u65b0\u64cd\u4f5c\uff0c\u91cd\u7f6e\u6807\u8bb0\n                cancelRefresh(ex);\n                // \u7ee7\u7eed\u5f80\u4e0a\u629b\u5f02\u5e38\n                throw ex;\n            } finally {\n                resetCommonCaches();\n                contextRefresh.end();\n            }\n        }\n}\n</code></pre> <p>\u6240\u4ee5\uff0c\u73b0\u5728\u6d41\u7a0b\u5c31\u5f88\u6e05\u6670\u4e86\uff0c\u5b9e\u9645\u4e0a\u6700\u4e3b\u8981\u7684\u5c31\u662f<code>refresh</code>\u65b9\u6cd5\uff0c\u5b83\u4ece\u521d\u59cb\u5316\u5230\u5b9e\u4f8b\u5316\u6240\u6709\u7684Bean\u6574\u4e2a\u6d41\u7a0b\u90fd\u5df2\u7ecf\u5b8c\u6210\uff0c\u5728\u8fd9\u4e2a\u65b9\u6cd5\u7ed3\u675f\u4e4b\u540e\uff0c\u6574\u4e2aIoC\u5bb9\u5668\u57fa\u672c\u5c31\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u4e86\u3002</p> <p>\u6211\u4eec\u7ee7\u7eed\u6765\u7814\u7a76\u4e00\u4e0b<code>finishBeanFactoryInitialization</code>\u65b9\u6cd5\uff0c\u770b\u770b\u5b83\u662f\u600e\u4e48\u52a0\u8f7d\u6240\u6709Bean\u7684\uff1a</p> <pre><code>protected void finishBeanFactoryInitialization(ConfigurableListableBeanFactory beanFactory) {\n        ...\n        beanFactory.preInstantiateSingletons();   //\u5957\u5a03\n}\n</code></pre> <pre><code>    @Override\n    public void preInstantiateSingletons() throws BeansException {\n        ...\n    // \u5217\u51fa\u5168\u90e8bean\u540d\u79f0\n        List&lt;String&gt; beanNames = new ArrayList&lt;&gt;(this.beanDefinitionNames);\n        // \u5f00\u59cb\u521d\u59cb\u5316\u6240\u6709Bean\n        for (String beanName : beanNames) {\n      //\u5f97\u5230Bean\u5b9a\u4e49\n            RootBeanDefinition bd = getMergedLocalBeanDefinition(beanName);\n      //Bean\u4e0d\u80fd\u662f\u62bd\u8c61\u7c7b\u3001\u4e0d\u80fd\u662f\u975e\u5355\u4f8b\u6a21\u5f0f\u3001\u4e0d\u80fd\u662f\u61d2\u52a0\u8f7d\u7684\n            if (!bd.isAbstract() &amp;&amp; bd.isSingleton() &amp;&amp; !bd.isLazyInit()) {\n        //\u9488\u5bf9\u4e8eBean\u548cFactoryBean\u5206\u5f00\u8fdb\u884c\u5904\u7406\n                if (isFactoryBean(beanName)) {\n                    Object bean = getBean(FACTORY_BEAN_PREFIX + beanName);\n                    if (bean instanceof SmartFactoryBean&lt;?&gt; smartFactoryBean &amp;&amp; smartFactoryBean.isEagerInit()) {\n                        getBean(beanName);\n                    }\n                } else {\n                    getBean(beanName);  //\u6700\u540e\u90fd\u662f\u901a\u8fc7\u8c03\u7528getBean\u65b9\u6cd5\u6765\u521d\u59cb\u5316\u5b9e\u4f8b\uff0c\u8fd9\u91cc\u5c31\u8ddf\u6211\u4eec\u4e4b\u524d\u8bb2\u7684\u8fde\u8d77\u6765\u4e86\n                }\n            }\n        }\n\n        ...\n}\n</code></pre> <p>\u81f3\u6b64\uff0c\u5173\u4e8eSpring\u5bb9\u5668\u6838\u5fc3\u52a0\u8f7d\u6d41\u7a0b\uff0c\u6211\u4eec\u5c31\u63a2\u7a76\u5b8c\u6bd5\u4e86\uff0c\u5b9e\u9645 \u5355\u6613\u61c2\uff0c\u5c31\u662f\u4ee3\u7801\u91cf\u592a\u5927\u4e86\u3002\u5728\u540e\u7eed\u7684SpringBoot\u9636\u6bb5\uff0c\u6211\u4eec\u8fd8\u4f1a\u7ee7\u7eed\u6df1\u6316Spring\u7684\u67d0\u4e9b\u673a\u5236\u7684\u5177\u4f53\u5b9e\u73b0\u7ec6\u8282\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89Spring%E5%9F%BA%E7%A1%80/#mybatis_3","title":"Mybatis\u6574\u5408\u539f\u7406","text":"<p>\u901a\u8fc7\u4e4b\u524d\u7684\u4e86\u89e3\uff0c\u6211\u4eec\u518d\u6765\u770bMybatis\u7684<code>@MapperScan</code>\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u73b0\u5728\u7406\u89e3\u8d77\u6765\u5c31\u975e\u5e38\u7b80\u5355\u4e86\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6253\u5f00\u67e5\u770b\uff1a</p> <pre><code>@Retention(RetentionPolicy.RUNTIME)\n@Target({ElementType.TYPE})\n@Documented\n@Import({MapperScannerRegistrar.class})\n@Repeatable(MapperScans.class)\npublic @interface MapperScan {\n    String[] value() default {};\n\n    String[] basePackages() default {};\n    ...\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u548cAop\u4e00\u6837\uff0c\u5b83\u4e5f\u662f\u901a\u8fc7Registrar\u673a\u5236\uff0c\u901a\u8fc7<code>@Import</code>\u6765\u8fdb\u884cBean\u7684\u6ce8\u518c\uff0c\u6211\u4eec\u6765\u770b\u770b<code>MapperScannerRegistrar</code>\u662f\u4e2a\u4ec0\u4e48\u4e1c\u897f\uff0c\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>void registerBeanDefinitions(AnnotationMetadata annoMeta, AnnotationAttributes annoAttrs, BeanDefinitionRegistry registry, String beanName) {\n    BeanDefinitionBuilder builder = BeanDefinitionBuilder.genericBeanDefinition(MapperScannerConfigurer.class);\n    builder.addPropertyValue(\"processPropertyPlaceHolders\", true);\n    ...\n}\n</code></pre> <p>\u867d\u7136\u5f88\u957f\u5f88\u591a\uff0c\u4f46\u662f\u8fd9\u4e9b\u4ee3\u7801\u90fd\u662f\u5728\u6dfb\u52a0\u4e00\u4e9bBean\u5b9a\u4e49\u7684\u5c5e\u6027\uff0c\u800c\u6700\u5173\u952e\u7684\u5219\u662f\u6700\u4e0a\u65b9\u7684<code>MapperScannerConfigurer</code>\uff0cMybatis\u5c06\u5176Bean\u4fe1\u606f\u6ce8\u518c\u5230\u4e86\u5bb9\u5668\u4e2d\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7c7b\u53c8\u662f\u5e72\u561b\u7684\u5462\uff1f</p> <pre><code>public class MapperScannerConfigurer implements BeanDefinitionRegistryPostProcessor, InitializingBean, ApplicationContextAware, BeanNameAware {\n    private String basePackage;\n</code></pre> <p>\u5b83\u5b9e\u73b0\u4e86BeanDefinitionRegistryPostProcessor\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u4e3aBean\u4fe1\u606f\u52a0\u8f7d\u63d0\u4f9b\u4e86\u540e\u7f6e\u5904\u7406\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\u770b\u5b83\u5728Bean\u4fe1\u606f\u540e\u7f6e\u5904\u7406\u4e2d\u505a\u4e86\u4ec0\u4e48\uff1a</p> <pre><code>public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) {\n    if (this.processPropertyPlaceHolders) {\n        this.processPropertyPlaceHolders();\n    }\n\n    //\u521d\u59cb\u5316\u7c7b\u8def\u5f84Mapper\u626b\u63cf\u5668\uff0c\u5b83\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u5de5\u5177\u7c7b\uff0c\u53ef\u4ee5\u5feb\u901f\u626b\u63cf\u51fa\u6574\u4e2a\u5305\u4e0b\u7684\u7c7b\u5b9a\u4e49\u4fe1\u606f\n    //ClassPathMapperScanner\u662fMybatis\u81ea\u5df1\u5b9e\u73b0\u7684\u4e00\u4e2a\u626b\u63cf\u5668\uff0c\u4fee\u6539\u4e86\u4e00\u4e9b\u626b\u63cf\u89c4\u5219\n    ClassPathMapperScanner scanner = new ClassPathMapperScanner(registry);\n    scanner.setAddToConfig(this.addToConfig);\n    scanner.setAnnotationClass(this.annotationClass);\n    scanner.setMarkerInterface(this.markerInterface);\n    scanner.setSqlSessionFactory(this.sqlSessionFactory);\n    scanner.setSqlSessionTemplate(this.sqlSessionTemplate);\n    scanner.setSqlSessionFactoryBeanName(this.sqlSessionFactoryBeanName);\n    scanner.setSqlSessionTemplateBeanName(this.sqlSessionTemplateBeanName);\n    scanner.setResourceLoader(this.applicationContext);\n    scanner.setBeanNameGenerator(this.nameGenerator);\n    scanner.setMapperFactoryBeanClass(this.mapperFactoryBeanClass);\n    if (StringUtils.hasText(this.lazyInitialization)) {\n        scanner.setLazyInitialization(Boolean.valueOf(this.lazyInitialization));\n    }\n\n    if (StringUtils.hasText(this.defaultScope)) {\n        scanner.setDefaultScope(this.defaultScope);\n    }\n\n    //\u6dfb\u52a0\u8fc7\u6ee4\u5668\uff0c\u8fd9\u91cc\u4f1a\u914d\u7f6e\u4e3a\u6240\u6709\u7684\u63a5\u53e3\u90fd\u80fd\u88ab\u626b\u63cf\uff08\u56e0\u6b64\u5373\u4f7f\u4f60\u4e0d\u6dfb\u52a0@Mapper\u6ce8\u89e3\u90fd\u80fd\u591f\u88ab\u626b\u63cf\u5e76\u52a0\u8f7d\uff09\n    scanner.registerFilters();\n    //\u5f00\u59cb\u626b\u63cf\n    scanner.scan(StringUtils.tokenizeToStringArray(this.basePackage, \",; \\t\\n\"));\n}\n</code></pre> <p>\u5f00\u59cb\u626b\u63cf\u540e\uff0c\u4f1a\u8c03\u7528<code>doScan()</code>\u65b9\u6cd5\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\uff08\u8fd9\u662f<code>ClassPathMapperScanner</code>\u4e2d\u7684\u626b\u63cf\u65b9\u6cd5\uff09\uff1a</p> <pre><code>public Set&lt;BeanDefinitionHolder&gt; doScan(String... basePackages) {\n    Set&lt;BeanDefinitionHolder&gt; beanDefinitions = super.doScan(basePackages);\n    //\u9996\u5148\u4ece\u5305\u4e2d\u626b\u63cf\u6240\u6709\u7684Bean\u5b9a\u4e49\n    if (beanDefinitions.isEmpty()) {\n        LOGGER.warn(() -&gt; {\n            return \"No MyBatis mapper was found in '\" + Arrays.toString(basePackages) + \"' package. Please check your configuration.\";\n        });\n    } else {\n        //\u5904\u7406\u6240\u6709\u7684Bean\u5b9a\u4e49\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u751f\u6210\u5bf9\u5e94Mapper\u7684\u4ee3\u7406\u5bf9\u8c61\uff0c\u5e76\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d\n        this.processBeanDefinitions(beanDefinitions);\n    }\n\n    //\u6700\u540e\u8fd4\u56de\u6240\u6709\u7684Bean\u5b9a\u4e49\u96c6\u5408\n    return beanDefinitions;\n}\n</code></pre> <p>\u901a\u8fc7\u65ad\u70b9\u6211\u4eec\u53d1\u73b0\uff0c\u6700\u540e\u5904\u7406\u5f97\u5230\u7684Bean\u5b9a\u4e49\u53d1\u73b0\u6b64Bean\u662f\u4e00\u4e2aMapperFactoryBean\uff0c\u5b83\u4e0d\u540c\u4e8e\u666e\u901a\u7684Bean\uff0cFactoryBean\u76f8\u5f53\u4e8e\u4e3a\u666e\u901a\u7684Bean\u6dfb\u52a0\u4e86\u4e00\u5c42\u5916\u58f3\uff0c\u5b83\u5e76\u4e0d\u662f\u4f9d\u9760Spring\u76f4\u63a5\u901a\u8fc7\u53cd\u5c04\u521b\u5efa\uff0c\u800c\u662f\u4f7f\u7528\u63a5\u53e3\u4e2d\u7684\u65b9\u6cd5\uff1a</p> <pre><code>public interface FactoryBean&lt;T&gt; {\n    String OBJECT_TYPE_ATTRIBUTE = \"factoryBeanObjectType\";\n\n    @Nullable\n    T getObject() throws Exception;\n\n    @Nullable\n    Class&lt;?&gt; getObjectType();\n\n    default boolean isSingleton() {\n        return true;\n    }\n}\n</code></pre> <p>\u901a\u8fc7<code>getObject()</code>\u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230Bean\u7684\u5b9e\u4f8b\u4e86\u3002</p> <p>\u6ce8\u610f\u8fd9\u91cc\u4e00\u5b9a\u8981\u533a\u5206FactoryBean\u548cBeanFactory\u7684\u6982\u5ff5\uff1a</p> <ul> <li>BeanFactory\u662f\u4e2aFactory\uff0c\u4e5f\u5c31\u662f IOC \u5bb9\u5668\u6216\u5bf9\u8c61\u5de5\u5382\uff0c\u6240\u6709\u7684 Bean \u90fd\u662f\u7531 BeanFactory( \u4e5f\u5c31\u662f IOC \u5bb9\u5668 ) \u6765\u8fdb\u884c\u7ba1\u7406\u3002</li> <li>FactoryBean\u662f\u4e00\u4e2a\u80fd\u751f\u4ea7\u6216\u8005\u4fee\u9970\u751f\u6210\u5bf9\u8c61\u7684\u5de5\u5382Bean(\u672c\u8d28\u4e0a\u4e5f\u662f\u4e00\u4e2aBean)\uff0c\u53ef\u4ee5\u5728BeanFactory\uff08IOC\u5bb9\u5668\uff09\u4e2d\u88ab\u7ba1\u7406\uff0c\u6240\u4ee5\u5b83\u5e76\u4e0d\u662f\u4e00\u4e2a\u7b80\u5355\u7684Bean\u3002\u5f53\u4f7f\u7528\u5bb9\u5668\u4e2dfactory bean\u7684\u65f6\u5019\uff0c\u8be5\u5bb9\u5668\u4e0d\u4f1a\u8fd4\u56defactory bean\u672c\u8eab\uff0c\u800c\u662f\u8fd4\u56de\u5176\u751f\u6210\u7684\u5bf9\u8c61\u3002\u8981\u60f3\u83b7\u53d6FactoryBean\u7684\u5b9e\u73b0\u7c7b\u672c\u8eab\uff0c\u5f97\u5728getBean(String BeanName)\u4e2d\u7684BeanName\u4e4b\u524d\u52a0\u4e0a&amp;,\u5199\u6210getBean(String &amp;BeanName)\u3002</li> </ul> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u81ea\u5df1\u7f16\u5199\u4e00\u4e2a\u5b9e\u73b0\uff1a</p> <pre><code>@Component(\"test\")\npublic class TestFb implements FactoryBean&lt;Student&gt; {\n    @Override\n    public Student getObject() throws Exception {\n        System.out.println(\"\u83b7\u53d6\u4e86\u5b66\u751f\");\n        return new Student();\n    }\n\n    @Override\n    public Class&lt;?&gt; getObjectType() {\n        return Student.class;\n    }\n}\n</code></pre> <pre><code>public static void main(String[] args) {\n    log.info(\"\u9879\u76ee\u6b63\u5728\u542f\u52a8...\");\n    ApplicationContext context = new AnnotationConfigApplicationContext(TestConfiguration.class);\n    System.out.println(context.getBean(\"&amp;test\"));   //\u5f97\u5230FactoryBean\u672c\u8eab\uff08\u5f97\u52a0\u4e2a&amp;\u641e\u5f97\u50cfC\u8bed\u8a00\u6307\u9488\u4e00\u6837\uff09\n    System.out.println(context.getBean(\"test\"));   //\u5f97\u5230FactoryBean\u8c03\u7528getObject()\u4e4b\u540e\u7684\u7ed3\u679c\n}\n</code></pre> <p>\u56e0\u6b64\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u7684Mapper\u6700\u7ec8\u5c31\u4ee5FactoryBean\u7684\u5f62\u5f0f\uff0c\u88ab\u6ce8\u518c\u5230\u5bb9\u5668\u4e2d\u8fdb\u884c\u52a0\u8f7d\u4e86\uff1a</p> <pre><code>public T getObject() throws Exception {\n    return this.getSqlSession().getMapper(this.mapperInterface);\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6574\u4e2aMybatis\u7684<code>@MapperScan</code>\u7684\u539f\u7406\u5c31\u5168\u90e8\u89e3\u91ca\u5b8c\u6bd5\u4e86\u3002</p> <p>\u5728\u4e86\u89e3\u5b8c\u4e86Spring\u7684\u5e95\u5c42\u539f\u7406\u4e4b\u540e\uff0c\u6211\u4eec\u5176\u5b9e\u5df2\u7ecf\u5b8c\u5168\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u5b9e\u73b0\u539f\u7406\u6765\u624b\u5199\u4e00\u4e2aSpring\u6846\u67b6\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/","title":"SSM\u7b14\u8bb0\uff08\u4e09\uff09SpringSecurity\u57fa\u7840","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#springsecurity","title":"SpringSecurity","text":"<p>\u57fa\u4e8eSpring6\u7684\u91cd\u5236\u7248\uff0c\u622a\u6b62\u76ee\u524d\uff0c\u6700\u65b0\u7684\u7248\u672c\u662f6.1.1\u7248\u672c\u3002</p> <p>\u524d\u7f6e\u8bfe\u7a0b\uff1a\u300aSpring\u6838\u5fc3\u5185\u5bb9\u300b\u300aSpringMvc\u300b\u300aJavaWeb\u300b\u300aJava9-17\u65b0\u7279\u6027\u300b</p> <p>\u5b89\u5168\u662f\u5f00\u53d1\u8005\u6c38\u8fdc\u7ed5\u4e0d\u5f00\u7684\u8bdd\u9898\uff0c\u4e00\u4e2a\u4e0d\u5b89\u5168\u7684\u7f51\u7ad9\uff0c\u5f80\u5f80\u5b58\u5728\u7740\u5404\u79cd\u81f4\u547d\u6f0f\u6d1e\uff0c\u53ea\u8981\u88ab\u4e0d\u6cd5\u5206\u5b50\u7a0d\u52a0\u5229\u7528\uff0c\u5c31\u80fd\u76f4\u63a5\u51fb\u6e83\u6574\u4e2a\u7f51\u7ad9\uff0c\u751a\u81f3\u7834\u574f\u7f51\u7ad9\u5b9d\u8d35\u7684\u7528\u6237\u6570\u636e\u3002\u800c\u7528\u6237\u7684\u6388\u6743\u6821\u9a8c\uff0c\u5219\u662f\u7f51\u7ad9\u5b89\u5168\u7cfb\u7edf\u7684\u5178\u578b\u4ee3\u8868\uff0c\u8fd9\u4e5f\u662f\u7528\u6237\u8bbf\u95ee\u7f51\u7ad9\u7684\u7b2c\u4e00\u5173\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u66f4\u52a0\u5b89\u5168\u548c\u53ef\u9760\u7684\u6388\u6743\u6821\u9a8c\u6846\u67b6\uff0c\u624d\u80fd\u8ba9\u6211\u4eec\u7684\u7f51\u7ad9\u66f4\u52a0\u7a33\u5b9a\u3002</p> <p>SpringSecurity\u662f\u4e00\u4e2a\u57fa\u4e8eSpring\u5f00\u53d1\u7684\u975e\u5e38\u5f3a\u5927\u7684\u6743\u9650\u9a8c\u8bc1\u6846\u67b6\uff0c\u5176\u6838\u5fc3\u529f\u80fd\u5305\u62ec\uff1a</p> <ul> <li>\u8ba4\u8bc1 \uff08\u7528\u6237\u767b\u5f55\uff09</li> <li>\u6388\u6743 \uff08\u6b64\u7528\u6237\u80fd\u591f\u505a\u54ea\u4e9b\u4e8b\u60c5\uff09</li> <li>\u653b\u51fb\u9632\u62a4 \uff08\u9632\u6b62\u4f2a\u9020\u8eab\u4efd\u653b\u51fb\uff09</li> </ul> <p>\u672c\u7ae0\uff0c\u6211\u4eec\u4f1a\u4ece\u591a\u4e2a\u65b9\u9762\u5bf9\u6b64\u6846\u67b6\u8fdb\u884c\u4ecb\u7ecd\uff0c\u8ba9\u5404\u4f4d\u5c0f\u4f19\u4f34\u80fd\u591f\u5728\u81ea\u5df1\u7684\u9879\u76ee\u4e2d\u4f7f\u7528\u66f4\u52a0\u5b89\u5168\u548c\u53ef\u9760\u7684\u8eab\u4efd\u6821\u9a8c\u65b9\u6848\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_1","title":"\u7f51\u7edc\u5b89\u5168\u57fa\u7840","text":"<p>\u7f51\u7edc\u5b89\u5168\u662f\u5f53\u4eca\u4e92\u8054\u7f51\u65f6\u4ee3\u975e\u5e38\u91cd\u8981\u7684\u4e00\u4e2a\u8bae\u9898\u3002\u5728\u4fe1\u606f\u7206\u70b8\u7684\u4eca\u5929\uff0c\u7f51\u7edc\u5b89\u5168\u95ee\u9898\u9891\u9891\u53d1\u751f\uff0c\u7ed9\u4e2a\u4eba\u548c\u7ec4\u7ec7\u5e26\u6765\u4e86\u4e25\u91cd\u7684\u635f\u5931\u548c\u5a01\u80c1\uff0c\u968f\u7740\u6280\u672f\u7684\u53d1\u5c55\u548c\u4e92\u8054\u7f51\u7684\u666e\u53ca\uff0c\u6211\u4eec\u8d8a\u6765\u8d8a\u610f\u8bc6\u5230\u7f51\u7edc\u5b89\u5168\u5df2\u7ecf\u6210\u4e3a\u4e00\u4e2a\u5168\u7403\u6027\u7684\u6311\u6218\u3002\u672c\u90e8\u5206\uff0c\u6211\u4eec\u4f1a\u7ed9\u5404\u4f4d\u5c0f\u4f19\u4f34\u4ecb\u7ecd\u7f51\u7edc\u5b89\u5168\u7684\u76f8\u5173\u6982\u5ff5\uff0c\u4ee5\u53ca\u5e38\u89c1\u7684Web\u670d\u52a1\u5668\u653b\u51fb\u5f62\u5f0f\uff0c\u5982\u679c\u4f60\u5df2\u7ecf\u4e86\u89e3\u76f8\u5173\u5185\u5bb9\uff0c\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u672c\u677f\u5757\u3002</p> <p>\u5176\u4e2d\u6bd4\u8f83\u5178\u578b\u7684\u6848\u4f8b\u6709\u4ee5\u4e0b\u51e0\u4e2a\uff1a</p> <p></p> <p>\u57282017\u5e74\uff0c\u4e00\u6b3e\u540d\u53ebWannaCry\u7684\u52d2\u7d22\u8f6f\u4ef6\u5e2d\u5377\u5168\u7403\uff0c\u5bfc\u81f4\u5168\u7403\u5927\u91cf\u8ba1\u7b97\u673a\u53d7\u5230\u5f71\u54cd\uff0c\u5f97\u76ca\u4e8e\u5168\u7403\u7f51\u7edc\u7684\u53d1\u8fbe\uff0c\u8fd9\u6b3e\u75c5\u6bd2\u4ece\u5c0f\u89c4\u6a21\u5f88\u5feb\u53d1\u5c55\u81f3\u5168\u7403\u8303\u56f4\uff0c\u52d2\u7d22\u75c5\u6bd2\u662f\u81ea\u718a\u732b\u70e7\u9999\u4ee5\u6765\u5f71\u54cd\u529b\u6700\u5927\u7684\u75c5\u6bd2\u4e4b\u4e00\u3002</p> <p>WannaCry\uff08\u53c8\u53ebWanna Decryptor\uff09\uff0c\u4e00\u79cd\u201c\u8815\u866b\u5f0f\u201d\u7684\u52d2\u7d22\u75c5\u6bd2\u8f6f\u4ef6\uff0c\u5927\u5c0f3.3MB\uff0c\u7531\u4e0d\u6cd5\u5206\u5b50\u5229\u7528NSA\uff08National Security Agency\uff0c\u7f8e\u56fd\u56fd\u5bb6\u5b89\u5168\u5c40\uff09\u6cc4\u9732\u7684\u5371\u9669\u6f0f\u6d1e\u201cEternalBlue\u201d\uff08\u6c38\u6052\u4e4b\u84dd\uff09\u8fdb\u884c\u4f20\u64ad [1] \u3002\u52d2\u7d22\u75c5\u6bd2\u8086\u8650\uff0c\u4fe8\u7136\u662f\u4e00\u573a\u5168\u7403\u6027\u4e92\u8054\u7f51\u707e\u96be\uff0c\u7ed9\u5e7f\u5927\u7535\u8111\u7528\u6237\u9020\u6210\u4e86\u5de8\u5927\u635f\u5931\u3002\u6700\u65b0\u7edf\u8ba1\u6570\u636e\u663e\u793a\uff0c100\u591a\u4e2a\u56fd\u5bb6\u548c\u5730\u533a\u8d85\u8fc710\u4e07\u53f0\u7535\u8111\u906d\u5230\u4e86\u52d2\u7d22\u75c5\u6bd2\u653b\u51fb\u3001\u611f\u67d3\u3002 [2] \u52d2\u7d22\u75c5\u6bd2\u662f\u81ea\u718a\u732b\u70e7\u9999\u4ee5\u6765\u5f71\u54cd\u529b\u6700\u5927\u7684\u75c5\u6bd2\u4e4b\u4e00\u3002WannaCry\u52d2\u7d22\u75c5\u6bd2\u5168\u7403\u5927\u7206\u53d1\uff0c\u81f3\u5c11150\u4e2a\u56fd\u5bb6\u300130\u4e07\u540d\u7528\u6237\u4e2d\u62db\uff0c\u9020\u6210\u635f\u5931\u8fbe80\u4ebf\u7f8e\u5143\uff0c\u5df2\u7ecf\u5f71\u54cd\u5230\u91d1\u878d\uff0c\u80fd\u6e90\uff0c\u533b\u7597\u7b49\u4f17\u591a\u884c\u4e1a\uff0c\u9020\u6210\u4e25\u91cd\u7684\u5371\u673a\u7ba1\u7406\u95ee\u9898\u3002</p> <p></p> <p>\u9664\u4e86\u75c5\u6bd2\u5728\u7f51\u7edc\u4e0a\u4f20\u64ad\u5916\uff0c\u8fd8\u6709\u975e\u5e38\u6076\u5fc3\u7684DDOS\u653b\u51fb\uff0c\u8fd9\u79cd\u653b\u51fb\u65b9\u5f0f\u6210\u672c\u4f4e\uff0c\u6548\u7387\u9ad8\uff0c\u53ea\u8981\u6301\u7eed\u4e00\u6bb5\u65f6\u95f4\u5c31\u80fd\u5bfc\u81f4\u6ca1\u6709\u7279\u6b8a\u9632\u5fa1\u7684\u7f51\u7ad9\u65e0\u6cd5\u6b63\u5e38\u8fd0\u4f5c\uff1a</p> <p>2022\u5e744\u6708\uff0c\u90d1\u5dde\u8b66\u65b9\u63a5\u5230\u62a5\u8b66\u79f0\uff0c\u67d0\u653f\u5e9c\u7f51\u7ad9\u5e73\u53f0\u4e8e\u8fd1\u65e5\u906d\u53d7\u591a\u6b21DDoS\u653b\u51fb\uff0c\u5bfc\u81f4\u5e73\u53f0\u8bbf\u95ee\u91cf\u77ac\u95f4\u66b4\u589e\u591a\u500d\uff0c\u9020\u6210\u6570\u5341\u5bb6\u653f\u5e9c\u7f51\u7ad9\u548c\u653f\u52a1\u65b0\u5a92\u4f53\u8d26\u53f7\u65e0\u6cd5\u6b63\u5e38\u8bbf\u95ee\u3002\u63a5\u5230\u62a5\u8b66\u540e\uff0c\u90d1\u5dde\u8b66\u65b9\u7acb\u5373\u5f00\u5c55\u4fa6\u67e5\u8c03\u67e5\uff0c\u7b2c\u4e00\u65f6\u95f4\u9501\u5b9a\u72af\u7f6a\u5acc\u7591\u4eba\u5f20\u67d0\u67d0\uff0c\u4ec522\u5c0f\u65f6\u5c31\u5c06\u72af\u7f6a\u5acc\u7591\u4eba\u5f20\u67d0\u67d0\u6293\u6355\u5230\u6848\u3002</p> <p>\u7ecf\u5ba1\u67e5\uff0c\u5f20\u67d0\u67d0\u4e3a\u67d0\u533b\u9662\u7f51\u7edc\u5b89\u5168\u90e8\u6280\u672f\u7ef4\u62a4\u4eba\u5458\uff0c2022\u5e744\u67082\u65e5\uff0c\u5176\u4e2a\u4eba\u7f51\u7ad9\u88abDDoS\u653b\u51fb\uff0c\u5bfc\u81f4\u7f51\u7ad9\u65e0\u6cd5\u767b\u9646\u3002\u4e3a\u51cf\u5c11\u653b\u51fb\u5bf9\u5176\u4e2a\u4eba\u7f51\u7ad9\u7684\u5f71\u54cd\uff0c\u5f20\u67d0\u67d0\u79c1\u81ea\u5c06\u4e2a\u4eba\u7f51\u7ad9\u57df\u540d\u89e3\u6790\u5730\u5740\u53d8\u66f4\u4e3a\u67d0\u653f\u5e9c\u7f51\u7ad9\u5e73\u53f0\u5730\u5740\uff0c\u201c\u8f6c\u5ac1\u201d\u653b\u51fb\u6d41\u91cf\uff0c\u81f4\u4f7f\u8be5\u653f\u5e9c\u7f51\u7ad9\u5e73\u53f0\u88ab\u6076\u610f\u7f51\u7edc\u6d41\u91cf\u653b\u51fb\uff0c\u591a\u5bb6\u653f\u5e9c\u7f51\u7ad9\u3001\u653f\u52a1\u65b0\u5a92\u4f53\u8d26\u53f7\u4e0d\u80fd\u6b63\u5e38\u4f7f\u7528\u3002</p> <p>\u76ee\u524d\uff0c\u5f20\u67d0\u67d0\u56e0\u6d89\u5acc\u7834\u574f\u8ba1\u7b97\u673a\u4fe1\u606f\u7cfb\u7edf\u72af\u7f6a\u88ab\u516c\u5b89\u673a\u5173\u79fb\u9001\u8d77\u8bc9\uff0c\u6848\u4ef6\u6b63\u5728\u8fdb\u4e00\u6b65\u4fa6\u529e\u4e2d\u3002</p> <p></p> <p>\u4fe1\u606f\u6cc4\u9732\u4e5f\u662f\u975e\u5e38\u4e25\u91cd\u7684\u7f51\u7edc\u5b89\u5168\u95ee\u9898\uff0c\u6211\u4eec\u7684\u4e2a\u4eba\u4fe1\u606f\u662f\u6211\u4eec\u7684\u9690\u79c1\uff0c\u800c\u5728\u7f51\u7edc\u53d1\u8fbe\u7684\u4eca\u5929\uff0c\u5728\u5404\u5927APP\u4e0a\u586b\u5199\u7684\u4fe1\u606f\u5f88\u6709\u53ef\u80fd\u4f1a\u88ab\u7b2c\u4e09\u65b9\u83b7\u53d6\uff0c\u4ece\u4e2d\u8c0b\u53d6\u5229\u76ca\u3002</p> <p>\u4eca\u5e74\u65e9\u4e9b\u65f6\u5019\u4fbf\u5df2\u53d1\u73b0\u76f8\u5173\u5b89\u5168\u6f0f\u6d1e\u7684\u7f51\u7edc\u5b89\u5168\u4e13\u5bb6\u79f0\uff0c \u4e00\u4e2a\u5e38\u89c1\u6f0f\u6d1e\u5bfc\u81f4\u4e86\u8fd9\u573a\u6709\u8bb0\u5f55\u4ee5\u6765\u6700\u5927\u89c4\u6a21\u7684\u4e2a\u4eba\u6570\u636e\u6cc4\u9732\uff0c\u4e5f\u662f\u4e2d\u56fd\u6240\u906d\u9047\u6700\u5927\u89c4\u6a21\u7684\u7f51\u7edc\u5b89\u5168\u4e8b\u4ef6\uff0c\u9020\u6210\u6570\u636e\u88ab\u516c\u5f00\u5728\u4e92\u8054\u7f51\u4e0a\uff0c\u4f9b\u4eba\u53d6\u7528\u3002</p> <p>\u636e\u8fd9\u4e9b\u7f51\u7edc\u5b89\u5168\u4e13\u5bb6\u79f0\uff0c\u4e0a\u6d77\u8b66\u65b9\u7684\u8fd9\u4e9b\u8bb0\u5f55\u662f\u88ab\u5b89\u5168\u5b58\u50a8\u7684\uff0c\u5176\u4e2d\u5305\u542b\u4e2a\u4eba\u59d3\u540d\u3001\u8eab\u4efd\u8bc1\u53f7\u7801\u3001\u7535\u8bdd\u53f7\u7801\u4ee5\u53ca\u8b66\u60c5\u4fe1\u606f\uff0c\u6d89\u53ca\u8fd110\u4ebf\u4e2d\u56fd\u516c\u6c11\u7684\u6570\u636e\u3002\u4ed6\u4eec\u8bf4\uff0c\u4f46\u4e00\u4e2a\u7528\u4e8e\u7ba1\u7406\u548c\u8bbf\u95ee\u8be5\u6570\u636e\u5e93\u7684\u663e\u793a\u754c\u9762(dashboard)\u88ab\u8bbe\u7f6e\u5728\u4e00\u4e2a\u516c\u5f00\u7f51\u5740\u4e0a\uff0c\u6ca1\u6709\u52a0\u8bbe\u5bc6\u7801\uff0c\u4efb\u4f55\u6709\u76f8\u5bf9\u57fa\u672c\u6280\u672f\u77e5\u8bc6\u7684\u4eba\u90fd\u53ef\u4ee5\u8f7b\u677e\u8bbf\u95ee\u3001\u590d\u5236\u6216\u7a83\u53d6\u5e93\u4e2d\u7684\u6d77\u91cf\u4fe1\u606f\u3002</p> <p>\u6697\u7f51\u60c5\u62a5\u516c\u53f8Shadowbyte\u7684\u521b\u59cb\u4ebaVinny Troia\u8bf4\uff1a\u201c\u4ed6\u4eec\u628a\u8fd9\u4e48\u591a\u6570\u636e\u66b4\u9732\u5728\u5916\uff0c\u8fd9\u592a\u75af\u72c2\u4e86\u3002\u201d\u8fd9\u5bb6\u516c\u53f8\u4e13\u95e8\u5728\u7f51\u4e0a\u626b\u63cf\u641c\u5bfb\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u7684\u6570\u636e\u5e93\uff0c\u65e9\u5728\u4eca\u5e741\u6708\u626b\u63cf\u65f6\u53d1\u73b0\u4e86\u4e0a\u6d77\u8b66\u65b9\u7684\u8fd9\u4e2a\u6570\u636e\u5e93\u3002</p> <p>\u4e2a\u4eba\u4fe1\u606f\u6570\u636e\u4e00\u65e6\u6cc4\u9732\uff0c\u76f8\u5f53\u4e8e\u522b\u4eba\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u76f4\u63a5\u5b9a\u4f4d\u4f60\u7684\u4f4f\u5740\u3001\u7535\u8bdd\u53f7\u7801\u3001\u5404\u79cd\u793e\u4ea4\u8d26\u53f7\u3001\u8eab\u4efd\u8bc1\u4fe1\u606f\u751a\u81f3\u662f\u673a\u7968\u3001\u706b\u8f66\u7968\u3001\u9152\u5e97\u5f00\u623f\u4fe1\u606f\u7b49\uff0c\u505a\u7684\u518d\u7edd\u4e00\u5b9a\uff0c\u5982\u679c\u8fd9\u4e2a\u9152\u5e97\u88ab\u4eba\u5077\u5077\u653e\u4e86\u9488\u5b54\u6444\u50cf\u5934\uff0c\u751a\u81f3\u8fd8\u80fd\u6839\u636e\u8bb0\u5f55\u67e5\u5230\u4f60\u5f00\u623f\u89c6\u9891\uff0c\u8fd9\u4e9b\u4e8b\u60c5\u5149\u662f\u60f3\u60f3\u90fd\u53ef\u6015\uff0c\u8fd9\u7b49\u540c\u4e8e\u5728\u4e92\u8054\u7f51\u4e0a\u201c\u88f8\u5954\u201d\u3002</p> <p>\u7f51\u7edc\u5b89\u5168\u95ee\u9898\u975e\u540c\u5c0f\u53ef\uff0c\u800c\u6211\u4eec\u4f5c\u4e3a\u7f51\u7ad9\u7684\u5f00\u53d1\u8005\uff0c\u66f4\u5e94\u8be5\u9996\u5f53\u5176\u51b2\u89e3\u51b3\u8fd9\u4e9b\u6f5c\u5728\u95ee\u9898\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u4f1a\u4ecb\u7ecd\u51e0\u4e2a\u5e38\u89c1\u7684Web\u7f51\u7ad9\u653b\u51fb\u65b9\u5f0f\uff0c\u4ee5\u53ca\u5728\u540e\u7eed\u4f7f\u7528SpringSecurity\u65f6\u5982\u4f55\u53bb\u9632\u8303\u8fd9\u4e9b\u653b\u51fb\u884c\u4e3a\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_2","title":"\u6d4b\u8bd5\u73af\u5883\u642d\u5efa","text":"<p>\u4e3a\u4e86\u6d4b\u8bd5\u6211\u4eec\u4e4b\u524d\u7684\u7f51\u7ad9\u5b89\u5168\u6027\uff0c\u8fd9\u91cc\u6211\u4eec\u57fa\u4e8eMvc\u6846\u67b6\u91cd\u65b0\u642d\u5efa\u4e00\u4e2a\u91c7\u7528\u4e4b\u524d\u7684\u9a8c\u8bc1\u65b9\u5f0f\u7684\u7b80\u6613\u7f51\u7ad9\uff0c\u9996\u5148\u662f\u767b\u5f55\u754c\u9762\u90e8\u5206\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u767b\u5f55\u767d\u9a6c\u94f6\u884c&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;form action=\"login\" method=\"post\"&gt;\n    &lt;label&gt;\n      \u7528\u6237\u540d\uff1a\n      &lt;input name=\"username\" type=\"text\"&gt;\n    &lt;/label&gt;\n    &lt;label&gt;\n      \u5bc6\u7801\uff1a\n      &lt;input name=\"password\" type=\"password\"&gt;\n    &lt;/label&gt;\n    &lt;button type=\"submit\"&gt;\u767b\u5f55&lt;/button&gt;\n  &lt;/form&gt;\n  &lt;div th:if=\"${status}\"&gt;\u767b\u5f55\u5931\u8d25\uff0c\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\uff01&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u63a5\u7740\u662f\u767b\u5f55\u4e4b\u540e\u7684\u9996\u9875\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u767d\u9a6c\u94f6\u884c - \u9996\u9875&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u63a5\u7740\u662fController\u90e8\u5206\uff1a</p> <pre><code>@Controller\npublic class HelloController {\n    //\u5904\u7406\u767b\u5f55\u64cd\u4f5c\u5e76\u8df3\u8f6c\n    @PostMapping(\"/login\")\n    public String login(@RequestParam String username,\n                        @RequestParam String password,\n                        HttpSession session,\n                        Model model){\n        if(\"test\".equals(username) &amp;&amp; \"123456\".equals(password)) {\n            session.setAttribute(\"login\", true);\n            return \"redirect:/\";\n        } else {\n            model.addAttribute(\"status\", true);\n            return \"login\";\n        }\n    }\n\n    //\u5904\u7406\u9996\u9875\u6216\u662f\u767b\u5f55\u754c\u9762\u8df3\u8f6c\n    @GetMapping(\"/\")\n    public String index(HttpSession session){\n        if(session.getAttribute(\"login\") != null) {\n            return \"index\";\n        }else {\n            return \"login\";\n        }\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u7b80\u5355\u767b\u5f55\u4e86\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u5728\u9996\u9875\u52a0\u4e00\u4e2a\u8f6c\u8d26\u64cd\u4f5c\uff0c\u8981\u6c42\u586b\u5199\u8f6c\u8d26\u4eba\u8d26\u53f7\u540d\u79f0\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(\"/pay\")\npublic JSONObject pay(@RequestParam String account,\n                      HttpSession session){\n    JSONObject object = new JSONObject();\n    //\u767b\u5f55\u4e4b\u540e\u624d\u80fd\u8f6c\u8d26\n    if(session.getAttribute(\"login\") != null) {\n        System.out.println(\"\u8f6c\u8d26\u7ed9\"+account+\"\u6210\u529f\uff0c\u4ea4\u6613\u5df2\u5b8c\u6210\uff01\");\n        object.put(\"success\", true);\n    } else {\n        System.out.println(\"\u8f6c\u8d26\u7ed9\"+account+\"\u5931\u8d25\uff0c\u7528\u6237\u672a\u767b\u5f55\uff01\");\n        object.put(\"success\", false);\n    }\n    return object;\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728\u9875\u9762\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u7b80\u5355\u7684\u8f6c\u8d26\u64cd\u4f5c\u6309\u952e\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u767d\u9a6c\u94f6\u884c - \u9996\u9875&lt;/title&gt;\n    &lt;script src=\"https://unpkg.com/axios@1.1.2/dist/axios.min.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div&gt;\n        &lt;label&gt;\n            \u8f6c\u8d26\u8d26\u53f7\uff1a\n            &lt;input type=\"text\" id=\"account\"/&gt;\n        &lt;/label&gt;\n        &lt;button onclick=\"pay()\"&gt;\u7acb\u5373\u8f6c\u8d26&lt;/button&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n&lt;script&gt;\nfunction pay() {\n    const account = document.getElementById(\"account\").value\n    axios.post('/mvc/pay', { account: account }, {\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n        }\n    }).then(({data}) =&gt; {\n        if(data.success)\n            alert(\"\u8f6c\u8d26\u6210\u529f\")\n        else\n            alert(\"\u8f6c\u8d26\u5931\u8d25\")\n    })\n}\n&lt;/script&gt;\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u6210\u529f\u642d\u5efa\u597d\u7f51\u7edc\u5b89\u5168\u7684\u6d4b\u8bd5\u9879\u76ee\u4e86\uff0c\u5404\u4f4d\u5c0f\u4f19\u4f34\u8bf7\u5c06\u8fd9\u4e2a\u9879\u76ee\u8fdb\u884c\u4fdd\u5b58\uff0c\u540e\u9762\u9700\u8981\u91cd\u590d\u4f7f\u7528\u3002</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#csrf","title":"CSRF\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u653b\u51fb","text":"<p>CSRF\u662f\u6211\u4eec\u8981\u4ecb\u7ecd\u7684\u7b2c\u4e00\u79cd\u653b\u51fb\u5f62\u5f0f\uff0c\u8fd9\u79cd\u653b\u51fb\u65b9\u5f0f\u975e\u5e38\u597d\u7406\u89e3\u3002</p> <p></p> <p>\u6211\u4eec\u65f6\u5e38\u4f1a\u5728QQ\u4e0a\u6536\u5230\u522b\u4eba\u53d1\u9001\u7684\u9493\u9c7c\u7f51\u7ad9\u94fe\u63a5\uff0c\u53ea\u8981\u4f60\u5728\u4e0a\u9762\u767b\u9646\u4e86\u4f60\u7684QQ\u8d26\u53f7\uff0c\u90a3\u4e48\u4e0d\u51fa\u610f\u5916\uff0c\u4f60\u7684\u53f7\u5df2\u7ecf\u5728\u522b\u4eba\u624b\u4e2d\u4e86\u3002\u5b9e\u9645\u4e0a\u8fd9\u4e00\u7c7b\u7f51\u7ad9\u90fd\u5c5e\u4e8e\u6076\u610f\u7f51\u7ad9\uff0c\u4e13\u95e8\u7528\u4e8e\u76d7\u53d6\u4ed6\u4eba\u4fe1\u606f\uff0c\u6267\u884c\u975e\u6cd5\u64cd\u4f5c\uff0c\u751a\u81f3\u83b7\u53d6\u4ed6\u4eba\u8d26\u6237\u4e2d\u7684\u8d22\u4ea7\uff0c\u975e\u6cd5\u8f6c\u8d26\u7b49\u3002\u800c\u8fd9\u91cc\uff0c\u6211\u4eec\u9700\u8981\u4e86\u89e3\u4e00\u79cd\u6bd4\u8f83\u5bb9\u6613\u53d1\u751f\u7684\u6076\u610f\u64cd\u4f5c\uff0c\u4ece\u4e0d\u6cd5\u5206\u5b50\u7684\u89d2\u5ea6\u53bb\u4e86\u89e3\u6574\u4e2a\u6d41\u7a0b\u3002</p> <p>\u6211\u4eec\u5728JavaWeb\u9636\u6bb5\u5df2\u7ecf\u4e86\u89e3\u4e86Session\u548cCookie\u7684\u673a\u5236\uff0c\u5728\u4e00\u5f00\u59cb\u7684\u65f6\u5019\uff0c\u670d\u52a1\u7aef\u4f1a\u7ed9\u6d4f\u89c8\u5668\u4e00\u4e2a\u540d\u4e3aJSESSIONID\u7684Cookie\u4fe1\u606f\u4f5c\u4e3a\u4f1a\u8bdd\u7684\u552f\u4e00\u51ed\u636e\uff0c\u53ea\u8981\u7528\u6237\u643a\u5e26\u6b64Cookie\u8bbf\u95ee\u6211\u4eec\u7684\u7f51\u7ad9\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba4\u5b9a\u6b64\u4f1a\u8bdd\u5c5e\u4e8e\u54ea\u4e2a\u6d4f\u89c8\u5668\u7528\u6237\u3002\u56e0\u6b64\uff0c\u53ea\u8981\u6b64\u4f1a\u8bdd\u7684\u7528\u6237\u6267\u884c\u4e86\u767b\u5f55\u64cd\u4f5c\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u968f\u610f\u8bbf\u95ee\u4e2a\u4eba\u4fe1\u606f\u7b49\u5185\u5bb9\u3002</p> <p>\u6211\u4eec\u6765\u5c1d\u8bd5\u6a21\u62df\u4e00\u4e0b\u8fd9\u79cd\u64cd\u4f5c\uff0c\u6765\u7f16\u5199\u4e00\u4e2a\u9493\u9c7c\u7f51\u7ad9\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u5764\u5764\u7092\u7c89\u653e\u9e21\u7cbe\u89c6\u9891\u5728\u7ebf\u89c2\u770b&lt;/title&gt;\n    &lt;script src=\"https://unpkg.com/axios@1.1.2/dist/axios.min.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;iframe name=\"hiddenIframe\" hidden&gt;&lt;/iframe&gt;\n&lt;form action=\"http://localhost:8080/mvc/pay\" method=\"post\" target=\"hiddenIframe\"&gt;\n    &lt;input type=\"text\" name=\"account\" value=\"\u9ed1\u5ba2\" hidden&gt;\n    &lt;button type=\"submit\"&gt;\u70b9\u51fb\u4e0b\u8f7d\u5168\u5957\u89c6\u9891&lt;/button&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u8fd9\u4e2a\u9875\u9762\u5e76\u4e0d\u662f\u6211\u4eec\u5b98\u65b9\u63d0\u4f9b\u7684\u9875\u9762\uff0c\u800c\u662f\u4e0d\u6cd5\u5206\u5b50\u642d\u5efa\u7684\u6076\u610f\u7f51\u7ad9\u3002\u6211\u4eec\u53d1\u73b0\u6b64\u9875\u9762\u4e2d\u6709\u4e00\u4e2a\u8868\u5355\uff0c\u4f46\u662f\u8868\u5355\u4e2d\u7684\u8f93\u5165\u6846\u88ab\u9690\u85cf\u4e86\uff0c\u800c\u6211\u4eec\u770b\u5230\u7684\u53ea\u6709\u4e00\u4e2a\u6309\u94ae\uff0c\u6211\u4eec\u4e0d\u77e5\u9053\u8fd9\u662f\u4e00\u4e2a\u8868\u5355\uff0c\u4e5f\u4e0d\u77e5\u9053\u8868\u5355\u4f1a\u63d0\u4ea4\u7ed9\u90a3\u4e2a\u5730\u5740\uff0c\u8fd9\u65f6\u6574\u4e2a\u9875\u9762\u5c31\u975e\u5e38\u6709\u8ff7\u60d1\u6027\u4e86\u3002\u5982\u679c\u6211\u4eec\u70b9\u51fb\u6b64\u6309\u94ae\uff0c\u90a3\u4e48\u6574\u4e2a\u8868\u5355\u7684\u6570\u636e\u4f1a\u4ee5POST\u7684\u5f62\u5f0f\u53d1\u9001\u7ed9\u6211\u4eec\u7684\u670d\u52a1\u7aef\uff08\u4f1a\u643a\u5e26\u4e4b\u524d\u767b\u9646\u6211\u4eec\u7f51\u7ad9\u7684Cookie\u4fe1\u606f\uff09\uff0c\u4f46\u662f\u8fd9\u91cc\u5f88\u660e\u663e\u662f\u53e6\u4e00\u4e2a\u7f51\u7ad9\u8df3\u8f6c\uff0c\u901a\u8fc7\u8fd9\u6837\u7684\u65b9\u5f0f\uff0c\u6076\u610f\u7f51\u7ad9\u5c31\u6210\u529f\u5730\u5728\u6211\u4eec\u6beb\u4e0d\u77e5\u60c5\u7684\u60c5\u51b5\u4e0b\u5f15\u5bfc\u6211\u4eec\u6267\u884c\u4e86\u8f6c\u8d26\u64cd\u4f5c\uff0c\u5f53\u4f60\u53d1\u73b0\u4e0a\u5f53\u53d7\u9a97\u65f6\uff0c\u94b1\u5df2\u7ecf\u88ab\u8f6c\u8d70\u4e86\u3002</p> <p>\u6211\u4eec\u9996\u5148\u4f5c\u4e3a\u7528\u6237\uff0c\u5148\u5728\u6b63\u5e38\u7684\u7f51\u7ad9\u8fdb\u884c\u767b\u5f55\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u5047\u88c5\u81ea\u5df1\u4e0a\u5f53\uff0c\u8fdb\u5165\u5230\u6211\u4eec\u7684\u9493\u9c7c\u7f51\u7ad9\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u6beb\u4e0d\u77e5\u60c5\uff0c\u5982\u679c\u662f\u6b63\u5e38\u4eba\u601d\u7ef4\u7684\u8bdd\uff0c\u5c31\u4f1a\u76f4\u63a5\u70b9\u51fb\u4e0b\u8f7d\u5168\u5957\u89c6\u9891\uff0c\u606d\u559c\uff0c\u6b64\u65f6\u540e\u53f0\u5df2\u7ecf\u8f6c\u8d26\u6210\u529f\u4e86\uff0c\u7559\u4e0b\u4e00\u8138\u61f5\u903c\u7684\u4f60\uff1a</p> <p></p> <p>\u800c\u8fd9\u79cd\u6784\u5efa\u6076\u610f\u9875\u9762\uff0c\u5f15\u5bfc\u7528\u6237\u8bbf\u95ee\u5bf9\u5e94\u7f51\u7ad9\u6267\u884c\u64cd\u4f5c\u7684\u65b9\u5f0f\u79f0\u4e3a\uff1a\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\uff08CSRF\uff0cCross Site Request Forgery\uff09</p> <p>\u663e\u7136\uff0c\u6211\u4eec\u4e4b\u524d\u7f16\u5199\u7684\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u5c31\u5b58\u5728\u8fd9\u6837\u7684\u5b89\u5168\u6f0f\u6d1e\uff0c\u800cSpringSecurity\u5c31\u89e3\u51b3\u4e86\u8fd9\u6837\u7684\u95ee\u9898\u3002</p> <p>\u5f53\u7136\uff0c\u9664\u4e86\u901a\u8fc7\u6211\u4eec\u81ea\u5df1SpringSecurity\u4f7f\u7528\u53bb\u89e3\u51b3\u4e4b\u5916\uff0c\u968f\u7740\u73b0\u5728\u7684\u6d4f\u89c8\u5668\u4e0d\u65ad\u53d1\u5c55\uff0c\u5b89\u5168\u6027\u8d8a\u6765\u8d8a\u53d7\u5230\u91cd\u89c6\uff0c\u5f88\u591a\u6d4f\u89c8\u5668\u90fd\u6709SameSite\u4fdd\u62a4\u673a\u5236\uff0c\u5f53\u7528\u6237\u5728\u4e24\u4e2a\u4e0d\u540c\u57df\u540d\u7684\u7ad9\u70b9\u64cd\u4f5c\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bCookie\u5c31\u4f1a\u88ab\u81ea\u52a8\u5c4f\u853d\uff1a</p> <p></p> <p>SameSite\u662f\u4e00\u79cd\u5b89\u5168\u673a\u5236\uff0c\u65e8\u5728\u9632\u6b62\u8de8\u7ad9\u70b9\u8bf7\u6c42\u4f2a\u9020\uff08CSRF\uff09\u653b\u51fb\uff0c\u5b83\u901a\u8fc7\u9650\u5236\u7b2c\u4e09\u65b9Cookie\u7684\u4f7f\u7528\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u7684\u3002\u5728Chrome\u6d4f\u89c8\u5668\u4e2d\uff0cSameSite\u9ed8\u8ba4\u4e3aLax\uff0c\u8fd9\u610f\u5473\u7740\u7b2c\u4e09\u65b9Cookie\u53ea\u80fd\u5728\u7528\u6237\u5bfc\u822a\u5230\u4e0e\u539f\u59cb\u7ad9\u70b9\u76f8\u540c\u7684\u7ad9\u70b9\u65f6\u53d1\u9001\u3002\u8fd9\u540c\u6837\u5927\u5927\u63d0\u5347\u4e86\u7528\u6237\u7684\u5b89\u5168\u6027\uff0c\u8ba9\u9ed1\u5ba2\u5c11\u4e86\u8bb8\u591a\u53ef\u4e58\u4e4b\u673a\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u673a\u5236\u5bf9\u505a\u5b9e\u65bd\u7684\u540c\u5b66\uff08\u53ef\u80fd\uff09\u4e0d\u592a\u53cb\u597d\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#sfa","title":"SFA\u4f1a\u8bdd\u56fa\u5b9a\u653b\u51fb","text":"<p>\u8fd9\u540c\u6837\u662f\u5229\u7528Cookie\u4e2d\u76f8\u540c\u7684JSESSIONID\u8fdb\u884c\u7684\u653b\u51fb\uff0c\u4f1a\u8bdd\u56fa\u5b9a\u653b\u51fb\uff08Session fixation attack\uff09\u662f\u4e00\u79cd\u9488\u5bf9Web\u5e94\u7528\u7a0b\u5e8f\u7684\u5b89\u5168\u6f0f\u6d1e\u653b\u51fb\uff0c\u653b\u51fb\u8005\u5229\u7528\u8fd9\u79cd\u6f0f\u6d1e\uff0c\u5c06\u4e00\u4e2a\u6709\u6548\u7684\u4f1a\u8bddID\u5206\u914d\u7ed9\u7528\u6237\uff0c\u5e76\u8bf1\u4f7f\u7528\u6237\u5728\u8be5\u4f1a\u8bdd\u4e2d\u8fdb\u884c\u64cd\u4f5c\uff0c\u7136\u540e\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u4f1a\u8bddID\u83b7\u53d6\u7528\u6237\u7684\u6743\u9650\uff0c\u6216\u8005\u901a\u8fc7\u6b64\u4f1a\u8bdd\u7ee7\u7eed\u8fdb\u884c\u5176\u4ed6\u653b\u51fb\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u9ed1\u5ba2\u628a\u4ed6\u7684JSESSIONID\u76f4\u63a5\u7ed9\u4f60\uff0c\u4f60\u4e00\u65e6\u4f7f\u7528\u8fd9\u4e2aID\u767b\u5f55\uff0c\u90a3\u4e48\u5728\u540e\u7aef\u8fd9\u4e2aID\u5c31\u88ab\u8ba4\u5b9a\u4e3a\u5df2\u767b\u5f55\u72b6\u6001\uff0c\u90a3\u4e48\u4e5f\u5c31\u7b49\u540c\u4e8e\u4ed6\u76f4\u63a5\u8fdb\u5165\u4e86\u5df2\u767b\u5f55\u72b6\u6001\uff0c\u4ece\u800c\u76f4\u63a5\u8bbf\u95ee\u4f60\u8d26\u53f7\u7684\u4efb\u610f\u5185\u5bb9\uff0c\u6267\u884c\u4efb\u610f\u64cd\u4f5c\u3002</p> <p>\u653b\u51fb\u8005\u901a\u5e38\u4f7f\u7528\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u8fdb\u884c\u4f1a\u8bdd\u56fa\u5b9a\u653b\u51fb\uff1a</p> <ol> <li>\u4f1a\u8bdd\u4f20\u9012\uff1a\u653b\u51fb\u8005\u901a\u8fc7URL\u53c2\u6570\u3001\u8868\u5355\u9690\u85cf\u5b57\u6bb5\u3001cookie\u7b49\u65b9\u5f0f\u5c06\u4f1a\u8bddID\u4f20\u9012\u7ed9\u7528\u6237\u3002\u5f53\u7528\u6237\u4f7f\u7528\u8be5\u4f1a\u8bddID\u767b\u5f55\u65f6\uff0c\u653b\u51fb\u8005\u5c31\u80fd\u5229\u7528\u8be5\u4f1a\u8bddID\u83b7\u53d6\u7528\u6237\u7684\u6743\u9650\u3002</li> <li>\u4f1a\u8bdd\u52ab\u6301\uff1a\u653b\u51fb\u8005\u5229\u7528\u52ab\u6301\u7528\u6237\u4e0e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\u6d41\u91cf\uff0c\u83b7\u53d6\u5230\u7528\u6237\u7684\u4f1a\u8bddID\uff0c\u7136\u540e\u5229\u7528\u8be5\u4f1a\u8bddID\u5192\u5145\u7528\u6237\u8fdb\u884c\u64cd\u4f5c\u3002</li> <li>\u4f1a\u8bdd\u52ab\u6301\uff1a\u653b\u51fb\u8005\u4e8b\u5148\u83b7\u53d6\u5230\u4f1a\u8bddID\uff0c\u5e76\u5c06\u5176\u5206\u914d\u7ed9\u7528\u6237\uff0c\u4e4b\u540e\u901a\u8fc7\u5176\u4ed6\u65b9\u5f0f\u6b3a\u9a97\u7528\u6237\u767b\u5f55\u8be5\u4f1a\u8bdd\u3002\u8fd9\u6837\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u5229\u7528\u4f1a\u8bddID\u83b7\u53d6\u7528\u6237\u7684\u6743\u9650\u3002</li> </ol> <p>\u8fd9\u91cc\u6211\u4eec\u6765\u5c1d\u8bd5\u4e00\u4e0b\u7b2c\u4e00\u79cd\u65b9\u6848\uff0c\u8fd9\u91cc\u6211\u4eec\u9996\u5148\u7528\u53e6\u4e00\u4e2a\u6d4f\u89c8\u5668\u8bbf\u95ee\u76ee\u6807\u7f51\u7ad9\uff0c\u6b64\u65f6\u9700\u8981\u767b\u5f55\uff0c\u5f00\u59cb\u4e4b\u524d\u8bb0\u5f97\u5148\u6e05\u7406\u4e00\u4e0b\u4e24\u4e2a\u6d4f\u89c8\u5668\u7684\u7f13\u5b58\uff0c\u5426\u5219\u53ef\u80fd\u65e0\u6cd5\u751f\u6548\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u8bb0\u5f55\u4e0b\u8fd9\u4e2aJSESSIONID\uff0c\u7136\u540e\u5c06\u5176\u7f16\u5199\u5230\u6211\u4eec\u7684\u8bc8\u9a97\u7f51\u7ad9\u4e2d\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u6076\u610f\u811a\u672c\uff0c\u4f1a\u81ea\u52a8\u5c06\u5bf9\u5e94\u7528\u6237\u7684Cookie\u8fdb\u884c\u66ff\u6362\uff0c\u53d8\u6210\u6211\u4eec\u7684JSESSIONID\u503c\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u51a0\u5e0c\u54e5\u5168\u5957\u89c6\u9891&lt;/title&gt;\n    &lt;script src=\"https://unpkg.com/axios@1.1.2/dist/axios.min.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;script&gt;\n    //\u7b2c\u4e09\u65b9\u7f51\u7ad9\u6076\u610f\u811a\u672c\uff0c\u81ea\u52a8\u4fee\u6539Cookie\u4fe1\u606f\n    document.cookie = \"JSESSIONID=6AAF677EC2B630704A80D36311F08E01; path=/mvc; domain=localhost\"\n    //\u7136\u540e\u7ed9\u4f60\u5f04\u5230\u539f\u6765\u7684\u7f51\u7ad9\n    location.href = 'http://localhost:8080/mvc/'\n&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u8bbf\u95ee\u8fd9\u4e2a\u6076\u610f\u7f51\u7ad9\uff0c\u7136\u540e\u518d\u4f5c\u4e3a\u7528\u6237\uff0c\u53bb\u6b63\u5e38\u8bbf\u95ee\u76ee\u6807\u7f51\u7ad9\u8fdb\u884c\u767b\u5f55\u64cd\u4f5c\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6b64\u65f6\u7528\u6237\u7684\u6d4f\u89c8\u5668JSESSIONID\u503c\u4e3a\u521a\u521a\u6076\u610f\u7f51\u7ad9\u4f2a\u9020\u7684\u503c\uff0c\u73b0\u5728\u6211\u4eec\u6765\u8fdb\u884c\u767b\u5f55\u64cd\u4f5c\uff1a</p> <p></p> <p>\u6b64\u65f6\u6211\u4eec\u56de\u5230\u4e00\u5f00\u59cb\u7684\u6d4f\u89c8\u5668\uff0c\u5237\u65b0\u4e4b\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u6d4f\u89c8\u5668\u540c\u6837\u5df2\u7ecf\u767b\u5f55\u6210\u529f\u4e86\uff0c\u539f\u7406\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u76f8\u5f53\u4e8e\u8ba9\u7528\u6237\u76f4\u63a5\u5e2e\u6211\u4eec\u767b\u5f55\u4e86\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u7279\u522b\u5371\u9669\uff1f</p> <p>\u5f53\u7136\uff0c\u73b0\u5728\u7684\u6d4f\u89c8\u5668\u540c\u6837\u6709\u7740\u5bf9\u5e94\u7684\u4fdd\u62a4\u673a\u5236\uff0cTomcat\u53d1\u9001\u7684SESSIONID\u9ed8\u8ba4\u662f\u52fe\u9009\u4e86HttpOnly\u9009\u9879\u7684\uff0c\u4e00\u65e6\u88ab\u8bbe\u5b9a\u662f\u65e0\u6cd5\u88ab\u968f\u610f\u4fee\u6539\u7684\uff0c\u5f53\u7136\u524d\u63d0\u662f\u5148\u5f97\u6b63\u5e38\u8bbf\u95ee\u4e00\u6b21\u7f51\u7ad9\u624d\u884c\uff0c\u5426\u5219\u4ecd\u7136\u5b58\u5728\u5b89\u5168\u9690\u60a3\u3002</p> <p>HttpOnly\u662fCookie\u4e2d\u4e00\u4e2a\u5c5e\u6027\uff0c\u7528\u4e8e\u9632\u6b62\u5ba2\u6237\u7aef\u811a\u672c\u901a\u8fc7document.cookie\u5c5e\u6027\u8bbf\u95eeCookie\uff0c\u6709\u52a9\u4e8e\u4fdd\u62a4Cookie\u4e0d\u88ab\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u7a83\u53d6\u6216\u7be1\u6539\u3002\u4f46\u662f\uff0cHttpOnly\u7684\u5e94\u7528\u4ecd\u5b58\u5728\u5c40\u9650\u6027\uff0c\u4e00\u4e9b\u6d4f\u89c8\u5668\u53ef\u4ee5\u963b\u6b62\u5ba2\u6237\u7aef\u811a\u672c\u5bf9Cookie\u7684\u8bfb\u64cd\u4f5c\uff0c\u4f46\u5141\u8bb8\u5199\u64cd\u4f5c\uff1b\u6b64\u5916\u5927\u591a\u6570\u6d4f\u89c8\u5668\u4ecd\u5141\u8bb8\u901a\u8fc7XMLHTTP\u5bf9\u8c61\u8bfb\u53d6HTTP\u54cd\u5e94\u4e2d\u7684Set-Cookie\u5934\u3002</p> <p></p> <p>\u4e3a\u4e86\u5f7b\u5e95\u675c\u7edd\u8fd9\u4e2a\u95ee\u9898\uff0c\u767b\u5f55\u6210\u529f\u4e4b\u540e\u5e94\u8be5\u91cd\u65b0\u7ed9\u7528\u6237\u5206\u914d\u4e00\u4e2a\u65b0\u7684JSESSIONID\u624d\u884c\uff0c\u800c\u8fd9\u4e9b\u90fd\u7531SpringSecurity\u5e2e\u6211\u4eec\u5b9e\u73b0\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#xss","title":"XSS\u8de8\u7ad9\u811a\u672c\u653b\u51fb","text":"<p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u4e24\u79cd\u653b\u51fb\u65b9\u5f0f\uff0c\u4e0d\u8fc7\u90fd\u662f\u4ece\u5916\u90e8\u5e72\u6d89\uff0c\u5728\u5916\u90e8\u65e0\u6cd5\u5e72\u6d89\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4ece\u5185\u90e8\u51fb\u6e83\u7f51\u7ad9\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u9686\u91cd\u4ecb\u7ecdXSS\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u65b9\u5f0f\u3002</p> <p>XSS\uff08\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff09\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u7f51\u7edc\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u5728\u5408\u6cd5\u7f51\u7ad9\u4e2d\u6ce8\u5165\u6076\u610f\u811a\u672c\u4ee3\u7801\u6765\u653b\u51fb\u7528\u6237\u3002\u5f53\u7528\u6237\u8bbf\u95ee\u53d7\u5230\u6ce8\u5165\u653b\u51fb\u7684\u9875\u9762\u65f6\uff0c\u6076\u610f\u4ee3\u7801\u4f1a\u5728\u7528\u6237\u7684\u6d4f\u89c8\u5668\u4e2d\u6267\u884c\uff0c\u4ece\u800c\u5bfc\u81f4\u653b\u51fb\u8005\u80fd\u591f\u7a83\u53d6\u7528\u6237\u7684\u654f\u611f\u4fe1\u606f\u3001\u8bf1\u5bfc\u7528\u6237\u64cd\u4f5c\u3001\u751a\u81f3\u63a7\u5236\u7528\u6237\u7684\u8d26\u53f7\u3002</p> <p>XSS\u653b\u51fb\u5e38\u89c1\u7684\u65b9\u5f0f\u6709\u4e09\u79cd\uff1a</p> <ol> <li>\u5b58\u50a8\u578bXSS\u653b\u51fb\uff1a\u653b\u51fb\u8005\u5c06\u6076\u610f\u4ee3\u7801\u5b58\u50a8\u5230\u76ee\u6807\u7f51\u7ad9\u7684\u6570\u636e\u5e93\u4e2d\uff0c\u5f53\u5176\u4ed6\u7528\u6237\u8bbf\u95ee\u5305\u542b\u6076\u610f\u4ee3\u7801\u7684\u9875\u9762\u65f6\uff0c\u6076\u610f\u4ee3\u7801\u4f1a\u88ab\u6267\u884c\u3002</li> <li>\u53cd\u5c04\u578bXSS\u653b\u51fb\uff1a\u653b\u51fb\u8005\u5c06\u6076\u610f\u4ee3\u7801\u5d4c\u5165\u5230URL\u4e2d\uff0c\u5f53\u7528\u6237\u70b9\u51fb\u5305\u542b\u6076\u610f\u4ee3\u7801\u7684URL\u65f6\uff0c\u6076\u610f\u4ee3\u7801\u4f1a\u88ab\u6267\u884c\u3002</li> <li>DOM-based XSS\u653b\u51fb\uff1a\u653b\u51fb\u8005\u5229\u7528\u524d\u7aefJavaScript\u4ee3\u7801\u7684\u6f0f\u6d1e\uff0c\u901a\u8fc7\u4fee\u6539\u9875\u9762\u7684DOM\u7ed3\u6784\u6765\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002</li> </ol> <p>\u5728\u4e00\u4e9b\u793e\u4ea4\u7f51\u7ad9\u4e0a\uff0c\u7528\u6237\u53ef\u4ee5\u81ea\u7531\u53d1\u5e16\uff0c\u800c\u5e16\u5b50\u662f\u4ee5\u5bcc\u6587\u672c\u5f62\u5f0f\u8fdb\u884c\u7f16\u8f91\u548c\u4e0a\u4f20\u7684\uff0c\u53d1\u9001\u7ed9\u540e\u53f0\u7684\u5e16\u5b50\u5f80\u5f80\u662f\u76f4\u63a5\u4ee5HTML\u4ee3\u7801\u7684\u5f62\u5f0f\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u4f1a\u7ed9\u9ed1\u5ba2\u53ef\u4e58\u4e4b\u673a\u4e86\u3002</p> <p></p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u53d1\u5e16\u4f1a\u5411\u540e\u7aef\u4e0a\u4f20\u4ee5\u4e0b\u5185\u5bb9\uff0c\u8fd9\u4e9b\u662f\u7ecf\u8fc7\u8f6c\u6362\u5f97\u5230\u7684\u6b63\u5e38HTML\u4ee3\u7801\uff0c\u65b9\u4fbf\u540e\u7eed\u76f4\u63a5\u5c55\u793a\uff1a</p> <pre><code>&lt;div class=\"content ql-editor\"&gt;\n  &lt;p&gt;\n    &lt;strong&gt;\u8428\u8fbe\u7761\u89c9\u4e86\u5927\u6570\u636e&lt;/strong&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\u6492\u5927\u5927\u6492\u5927\u58f0\u5730&lt;/p&gt;\n&lt;/div&gt;\n</code></pre> <p>\u800c\u73b0\u5728\uff0c\u9ed1\u5ba2\u4e0d\u8d70\u5e38\u89c4\u7684\u65b9\u5f0f\u53d1\u5e16\uff0c\u800c\u662f\u53d1\u9001\u4ee5\u4e0b\u5185\u5bb9\u7ed9\u670d\u52a1\u7aef\uff1a</p> <pre><code>&lt;div class=\"content ql-editor\"&gt;\n  &lt;p \u03bfnl\u03bfad=\"alert('xss')\"&gt;\n    &lt;strong&gt;\u8428\u8fbe\u7761\u89c9\u4e86\u5927\u6570\u636e&lt;/strong&gt;\n  &lt;/p&gt;\n  &lt;p&gt;\u6492\u5927\u5927\u6492\u5927\u58f0\u5730&lt;/p&gt;\n&lt;/div&gt;\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230<code>p</code>\u6807\u7b7e\u4e0a\u6dfb\u52a0\u4e86\u4e00\u6bb5JS\u6076\u610f\u811a\u672c\uff0c\u9ed1\u5ba2\u53ef\u4ee5\u5229\u7528\u8fd9\u79cd\u7279\u6027\uff0c\u83b7\u53d6\u7528\u6237\u7684\u5404\u79cd\u4fe1\u606f\uff0c\u751a\u81f3\u76f4\u63a5\u53d1\u9001\u5230\u4ed6\u7684\u540e\u53f0\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u7684\u4e2a\u4eba\u4fe1\u606f\u5c31\u4ece\u7f51\u7ad9\u5185\u90e8\u88ab\u6cc4\u9732\u4e86\u3002</p> <p>XSS\u6f0f\u6d1e\u6700\u65e9\u88ab\u53d1\u73b0\u662f\u57281996\u5e74\uff0c\u7531\u4e8eJavaScript\u7684\u51fa\u73b0\uff0c\u5bfc\u81f4\u5728Web\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5b58\u5728\u4e86\u4e00\u4e9b\u5b89\u5168\u95ee\u9898\u3002\u57281997\u5e74\uff0c\u9ad8\u667a\u6587(Gareth Owen)\u4e5f\u5c31\u662f\u201cXSS\u4e4b\u7236\u201d\uff0c\u5728\u4ed6\u7684\u535a\u5ba2\u4e2d\u63cf\u8ff0\u4e86\u4e00\u79cd\u79f0\u4e3a\u201c\u811a\u672c\u6ce8\u5165\u201d(script injection)\u7684\u653b\u51fb\u6280\u672f\uff0c\u8fd9\u5c31\u662fXSS\u6f0f\u6d1e\u7684\u524d\u8eab\u3002\u4ece\u90a3\u65f6\u8d77\uff0cXSS\u6f0f\u6d1e\u4fbf\u6210\u4e3a\u4e86Web\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u4e00\u79cd\u5e38\u89c1\u5b89\u5168\u6f0f\u6d1e\u3002</p> <p></p> <p>\u8fd9\u79cd\u653b\u51fb\u4e00\u822c\u9700\u8981\u524d\u7aef\u914d\u5408\u540e\u7aef\u8fdb\u884c\u9632\u5fa1\uff0c\u6216\u8005\u540e\u7aef\u5bf9\u524d\u7aef\u53d1\u9001\u7684\u5185\u5bb9\u8fdb\u884c\u5b89\u5168\u626b\u63cf\u5e76\u5904\u7406\uff0c\u6709\u673a\u4f1a\u6211\u4eec\u4f1a\u5206\u4eab\u5982\u4f55\u9632\u8303\u6b64\u7c7b\u653b\u51fb\u3002</p> <p>\u5728\u4e86\u89e3\u8fd9\u4e48\u591a\u653b\u51fb\u65b9\u5f0f\u4e4b\u540e\uff0c\u60f3\u5fc5\u5404\u4f4d\u5c0f\u4f19\u4f34\u80af\u5b9a\u6709\u4e86\u4e00\u5b9a\u7684\u7f51\u7edc\u5b89\u5168\u610f\u8bc6\uff0c\u4e0d\u8fc7\u6211\u4eec\u5e76\u4e0d\u662f\u7f51\u7edc\u5b89\u5168\u4e13\u4e1a\u7684\u8bfe\u7a0b\uff0c\u81f3\u4e8e\u66f4\u591a\u7684\u653b\u51fb\u5f62\u5f0f\uff0c\u8fd8\u8bf7\u5404\u4f4d\u5c0f\u4f19\u4f34\u81ea\u884c\u4e86\u89e3\uff0c\u4ece\u4e0b\u4e00\u4e2a\u677f\u5757\u5f00\u59cb\uff0c\u6211\u4eec\u5c06\u4f1a\u6b63\u5f0f\u5f00\u59cbSpringSecurity\u6846\u67b6\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_3","title":"\u5f00\u53d1\u73af\u5883\u914d\u7f6e","text":"<p>\u6211\u4eec\u7ee7\u7eed\u4f7f\u7528\u4e4b\u524d\u7684\u6d4b\u8bd5\u9879\u76ee\u8fdb\u884c\u6559\u5b66\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u5bfc\u5165SpringSecurity\u7684\u76f8\u5173\u4f9d\u8d56\uff0c\u5b83\u4e0d\u4ec5\u4ec5\u662f\u4e00\u4e2a\u6a21\u5757\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u5bfc\u5165\u9700\u8981\u7684\u6a21\u5757\uff0c\u5e38\u7528\u7684\u662f\u4ee5\u4e0b\u4e24\u4e2a\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;\n    &lt;version&gt;6.1.1&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;\n    &lt;version&gt;6.1.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u914d\u7f6eSpringSecurity\uff0c\u4e0eMvc\u4e00\u6837\uff0c\u9700\u8981\u4e00\u4e2a\u521d\u59cb\u5316\u5668\uff1a</p> <pre><code>public class SecurityInitializer extends AbstractSecurityWebApplicationInitializer {\n    //\u4e0d\u7528\u91cd\u5199\u4efb\u4f55\u5185\u5bb9\n    //\u8fd9\u91cc\u5b9e\u9645\u4e0a\u4f1a\u81ea\u52a8\u6ce8\u518c\u4e00\u4e2aFilter\uff0cSpringSecurity\u5e95\u5c42\u5c31\u662f\u4f9d\u9760N\u4e2a\u8fc7\u6ee4\u5668\u5b9e\u73b0\u7684\uff0c\u6211\u4eec\u4e4b\u540e\u518d\u63a2\u8ba8\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u518d\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u7c7b\u7528\u4e8e\u914d\u7f6eSpringSecurity\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity   //\u5f00\u542fWebSecurity\u76f8\u5173\u529f\u80fd\npublic class SecurityConfiguration {\n\n}\n</code></pre> <p>\u63a5\u7740\u5728\u6839\u5bb9\u5668\u4e2d\u6dfb\u52a0\u6b64\u914d\u7f6e\u6587\u4ef6\u5373\u53ef\uff1a</p> <pre><code>@Override\nprotected Class&lt;?&gt;[] getRootConfigClasses() {\n    return new Class[]{MainConfiguration.class, SecurityConfiguration.class};\n}\n</code></pre> <p>\u8fd9\u6837\uff0cSpringSecurity\u7684\u914d\u7f6e\u5c31\u5b8c\u6210\u4e86\uff0c\u6211\u4eec\u518d\u6b21\u8fd0\u884c\u9879\u76ee\uff0c\u4f1a\u53d1\u73b0\u65e0\u6cd5\u8fdb\u5165\u7684\u6211\u4eec\u7684\u9875\u9762\u4e2d\uff0c\u65e0\u8bba\u6211\u4eec\u8bbf\u95ee\u54ea\u4e2a\u9875\u9762\uff0c\u90fd\u4f1a\u8fdb\u5165\u5230SpringSecurity\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u4e00\u4e2a\u9ed8\u8ba4\u767b\u5f55\u9875\u9762\uff0c\u4e4b\u540e\u6211\u4eec\u4f1a\u8bb2\u89e3\u5982\u4f55\u8fdb\u884c\u914d\u7f6e\u3002</p> <p></p> <p>\u81f3\u6b64\uff0c\u9879\u76ee\u73af\u5883\u642d\u5efa\u5b8c\u6210\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_4","title":"\u8ba4\u8bc1","text":"<p>\u8ba4\u8bc1\u662f\u6211\u4eec\u7f51\u7ad9\u7684\u7b2c\u4e00\u6b65\uff0c\u7528\u6237\u9700\u8981\u767b\u5f55\u4e4b\u540e\u624d\u80fd\u8fdb\u5165\uff0c\u8fd9\u4e00\u90e8\u5206\u6211\u4eec\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528SpringSecurity\u5b9e\u73b0\u7528\u6237\u767b\u5f55\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_5","title":"\u57fa\u4e8e\u5185\u5b58\u9a8c\u8bc1","text":"<p>\u9996\u5148\u6211\u4eec\u6765\u770b\u770b\u6700\u7b80\u5355\u7684\u57fa\u4e8e\u5185\u5b58\u7684\u914d\u7f6e\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u76f4\u63a5\u4ee5\u4ee3\u7801\u7684\u5f62\u5f0f\u914d\u7f6e\u6211\u4eec\u7f51\u7ad9\u7684\u7528\u6237\u548c\u5bc6\u7801\uff0c\u914d\u7f6e\u65b9\u5f0f\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u8981\u5728Security\u914d\u7f6e\u7c7b\u4e2d\u6ce8\u518c\u4e00\u4e2aBean\u5373\u53ef\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    @Bean   //UserDetailsService\u5c31\u662f\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u7684\u670d\u52a1\n    public UserDetailsService userDetailsService() {\n        //\u6bcf\u4e00\u4e2aUserDetails\u5c31\u4ee3\u8868\u4e00\u4e2a\u7528\u6237\u4fe1\u606f\uff0c\u5176\u4e2d\u5305\u542b\u7528\u6237\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u4ee5\u53ca\u89d2\u8272\n        UserDetails user = User.withDefaultPasswordEncoder()\n                .username(\"user\")\n                .password(\"password\")\n                .roles(\"USER\")  //\u89d2\u8272\u76ee\u524d\u6211\u4eec\u4e0d\u9700\u8981\u5173\u5fc3\uff0c\u968f\u4fbf\u5199\u5c31\u884c\uff0c\u540e\u9762\u4f1a\u4e13\u95e8\u8bb2\u89e3\n                .build();\n        UserDetails admin = User.withDefaultPasswordEncoder()\n                .username(\"admin\")\n                .password(\"password\")\n                .roles(\"ADMIN\", \"USER\")\n                .build();\n        return new InMemoryUserDetailsManager(user, admin); \n        //\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8e\u5185\u5b58\u7684\u7528\u6237\u4fe1\u606f\u7ba1\u7406\u5668\u4f5c\u4e3aUserDetailsService\n    }\n}\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u524d\u5f80\u767b\u5f55\u754c\u9762\uff0c\u8fdb\u884c\u767b\u5f55\u64cd\u4f5c\u4e86\uff1a</p> <p></p> <p>\u767b\u5f55\u6210\u529f\u540e\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5230\u6211\u4eec\u4e4b\u524d\u7684\u754c\u9762\u4e86\uff1a</p> <p></p> <p>\u5e76\u4e14\u4e3a\u4e86\u9632\u6b62\u6211\u4eec\u4e4b\u524d\u63d0\u5230\u7684\u4f1a\u8bdd\u56fa\u5b9a\u95ee\u9898\uff0c\u5728\u767b\u5f55\u4e4b\u540e\uff0cJSESSIONID\u4f1a\u5f97\u5230\u91cd\u65b0\u5206\u914d\uff1a</p> <p></p> <p>\u5f53\u6211\u4eec\u60f3\u8981\u9000\u51fa\u65f6\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\uff1ahttp://localhost:8080/mvc/logout \u5730\u5740\uff0c\u6211\u4eec\u4f1a\u8fdb\u5165\u5230\u4e00\u4e2a\u9000\u51fa\u767b\u5f55\u754c\u9762\uff1a</p> <p></p> <p>\u9000\u51fa\u767b\u5f55\u540e\u5c31\u9700\u8981\u91cd\u65b0\u767b\u5f55\u624d\u80fd\u8bbf\u95ee\u6211\u4eec\u7684\u7f51\u7ad9\u4e86\u3002</p> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u5728\u6709\u4e86SpringSecurity\u4e4b\u540e\uff0c\u6211\u4eec\u7f51\u7ad9\u7684\u767b\u5f55\u9a8c\u8bc1\u6a21\u5757\u76f8\u5f53\u4e8e\u76f4\u63a5\u88ab\u63a5\u7ba1\u4e86\uff0c\u56e0\u6b64\uff0c\u4ece\u73b0\u5728\u5f00\u59cb\uff0c\u6211\u4eec\u7684\u7f51\u7ad9\u4e0d\u9700\u8981\u518d\u81ea\u5df1\u7f16\u5199\u767b\u5f55\u6a21\u5757\u4e86\uff0c\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u53bb\u6389\uff0c\u53ea\u7559\u4e0b\u4e3b\u9875\u9762\uff1a</p> <pre><code>@Controller\npublic class HelloController {\n\n    //\u73b0\u5728\u6240\u6709\u63a5\u53e3\u4e0d\u9700\u8981\u4efb\u4f55\u9a8c\u8bc1\u4e86\uff0c\u56e0\u4e3aSecurity\u5df2\u7ecf\u5e2e\u6211\u4eec\u505a\u4e86\uff0c\u6ca1\u767b\u5f55\u662f\u6839\u672c\u8fdb\u4e0d\u6765\u7684\n    @GetMapping(\"/\")\n    public String index(){\n        return \"index\";\n    }\n\n    @ResponseBody\n    @PostMapping(\"/pay\")\n    public JSONObject pay(@RequestParam String account){\n        JSONObject object = new JSONObject();\n        System.out.println(\"\u8f6c\u8d26\u7ed9\"+account+\"\u6210\u529f\uff0c\u4ea4\u6613\u5df2\u5b8c\u6210\uff01\");\n        object.put(\"success\", true);\n        return object;\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u7684\u7f51\u7ad9\u5c31\u6210\u529f\u7528\u4e0a\u4e86\u66f4\u52a0\u5b89\u5168\u7684SpringSecurity\u6846\u67b6\u4e86\u3002\u7ec6\u5fc3\u7684\u5c0f\u4f19\u4f34\u53ef\u80fd\u53d1\u73b0\u4e86\uff0c\u6211\u4eec\u5728\u914d\u7f6e\u7528\u6237\u4fe1\u606f\u7684\u65f6\u5019\uff0c\u62a5\u4e86\u9ec4\u6807\uff0c\u5b9e\u9645\u4e0a\u8fd9\u79cd\u65b9\u5f0f\u5b58\u50a8\u5bc6\u7801\u5e76\u4e0d\u5b89\u5168\uff1a</p> <p></p> <p>\u8fd9\u662f\u56e0\u4e3aSpringSecurity\u7684\u5bc6\u7801\u6821\u9a8c\u4e0d\u63a8\u8350\u76f4\u63a5\u4f7f\u7528\u539f\u6587\u8fdb\u884c\u6bd4\u8f83\uff0c\u800c\u662f\u4f7f\u7528\u52a0\u5bc6\u7b97\u6cd5\u5c06\u5bc6\u7801\u8fdb\u884c\u52a0\u5bc6\uff08\u66f4\u51c6\u786e\u5730\u8bf4\u5e94\u8be5\u8fdb\u884cHash\u5904\u7406\uff0c\u6b64\u8fc7\u7a0b\u662f\u4e0d\u53ef\u9006\u7684\uff0c\u65e0\u6cd5\u89e3\u5bc6\uff09\uff0c\u6700\u540e\u5c06\u7528\u6237\u63d0\u4f9b\u7684\u5bc6\u7801\u4ee5\u540c\u6837\u7684\u65b9\u5f0f\u52a0\u5bc6\u540e\u4e0e\u5bc6\u6587\u8fdb\u884c\u6bd4\u8f83\u3002\u5bf9\u4e8e\u6211\u4eec\u6765\u8bf4\uff0c\u7528\u6237\u63d0\u4f9b\u7684\u5bc6\u7801\u5c5e\u4e8e\u9690\u79c1\u4fe1\u606f\uff0c\u76f4\u63a5\u660e\u6587\u5b58\u50a8\u5e76\u4e0d\u597d\uff0c\u800c\u4e14\u5982\u679c\u6570\u636e\u5e93\u5185\u5bb9\u88ab\u7a83\u53d6\uff0c\u90a3\u4e48\u6240\u6709\u7528\u6237\u7684\u5bc6\u7801\u5c06\u5168\u90e8\u6cc4\u9732\uff0c\u8fd9\u662f\u6211\u4eec\u4e0d\u5e0c\u671b\u770b\u5230\u7684\u7ed3\u679c\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u65e2\u80fd\u9690\u85cf\u7528\u6237\u5bc6\u7801\u4e5f\u80fd\u5b8c\u6210\u8ba4\u8bc1\u7684\u673a\u5236\uff0c\u800cHash\u5904\u7406\u5c31\u662f\u4e00\u79cd\u5f88\u597d\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u901a\u8fc7\u5c06\u7528\u6237\u7684\u5bc6\u7801\u8fdb\u884cHash\u503c\u8ba1\u7b97\uff0c\u8ba1\u7b97\u51fa\u6765\u7684\u7ed3\u679c\u4e00\u822c\u662f\u5355\u5411\u7684\uff0c\u65e0\u6cd5\u8fd8\u539f\u4e3a\u539f\u6587\uff0c\u5982\u679c\u9700\u8981\u9a8c\u8bc1\u662f\u5426\u4e0e\u6b64\u5bc6\u7801\u4e00\u81f4\uff0c\u90a3\u4e48\u9700\u8981\u4ee5\u540c\u6837\u7684\u65b9\u5f0f\u52a0\u5bc6\u518d\u6bd4\u8f83\u4e24\u4e2aHash\u503c\u662f\u5426\u4e00\u81f4\uff0c\u8fd9\u6837\u5c31\u5f88\u597d\u7684\u4fdd\u8bc1\u4e86\u7528\u6237\u5bc6\u7801\u7684\u5b89\u5168\u6027\u3002</p> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u5728\u914d\u7f6e\u7528\u6237\u4fe1\u606f\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b98\u65b9\u63d0\u4f9b\u7684BCrypt\u52a0\u5bc6\u5de5\u5177\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    //\u8fd9\u91cc\u5c06BCryptPasswordEncoder\u76f4\u63a5\u6ce8\u518c\u4e3aBean\uff0cSecurity\u4f1a\u81ea\u52a8\u8fdb\u884c\u9009\u62e9\n    @Bean\n    public PasswordEncoder passwordEncoder(){\n        return new BCryptPasswordEncoder();\n    }\n\n    @Bean\n    public UserDetailsService userDetailsService(PasswordEncoder encoder) {\n        UserDetails user = User\n                .withUsername(\"user\")\n                .password(encoder.encode(\"password\"))   //\u8fd9\u91cc\u5c06\u5bc6\u7801\u8fdb\u884c\u52a0\u5bc6\u540e\u5b58\u50a8\n                .roles(\"USER\")\n                .build();\n        System.out.println(encoder.encode(\"password\"));  //\u4e00\u4f1a\u89c2\u5bdf\u4e00\u4e0b\u52a0\u5bc6\u51fa\u6765\u4e4b\u540e\u7684\u5bc6\u7801\u957f\u5565\u6837\n        UserDetails admin = User\n                .withUsername(\"admin\")\n                .password(encoder.encode(\"password\"))   //\u8fd9\u91cc\u5c06\u5bc6\u7801\u8fdb\u884c\u52a0\u5bc6\u540e\u5b58\u50a8\n                .roles(\"ADMIN\", \"USER\")\n                .build();\n        return new InMemoryUserDetailsManager(user, admin);\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5b58\u50a8\u7684\u5bc6\u7801\u5c31\u662f\u66f4\u52a0\u5b89\u5168\u7684\u5bc6\u7801\u4e86\uff1a</p> <p></p> <p></p> <p>\u8fd9\u6837\uff0c\u4e00\u4e2a\u7b80\u5355\u7684\u6743\u9650\u6821\u9a8c\u5c31\u914d\u7f6e\u5b8c\u6210\u4e86\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u7528\u8d77\u6765\u8fd8\u662f\u633a\u7b80\u5355\u7684\uff1f</p> <p>\u4e0d\u8fc7\uff0c\u53ef\u80fd\u4f1a\u6709\u5c0f\u4f19\u4f34\u53d1\u73b0\uff0c\u6240\u6709\u7684POST\u8bf7\u6c42\u90fd\u88ab403\u4e86\uff1a</p> <p></p> <p>\u8fd9\u662f\u56e0\u4e3aSpringSecurity\u81ea\u5e26\u4e86csrf\u9632\u62a4\uff0c\u9700\u6c42\u6211\u4eec\u5728POST\u8bf7\u6c42\u4e2d\u643a\u5e26\u9875\u9762\u4e2d\u7684csrfToken\u624d\u53ef\u4ee5\uff0c\u5426\u5219\u4e00\u5f8b\u8fdb\u884c\u62e6\u622a\u64cd\u4f5c\uff0c\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u5d4c\u5165\u5230\u9875\u9762\u4e2d\uff0c\u968f\u4fbf\u627e\u4e00\u4e2a\u5730\u65b9\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>&lt;input type=\"text\" th:id=\"${_csrf.getParameterName()}\" th:value=\"${_csrf.token}\" hidden&gt;\n</code></pre> <p>\u63a5\u7740\u5728axios\u53d1\u8d77\u8bf7\u6c42\u65f6\uff0c\u643a\u5e26\u8fd9\u4e2ainput\u7684value\u503c\uff1a</p> <pre><code>function pay() {\n    const account = document.getElementById(\"account\").value\n    const csrf = document.getElementById(\"_csrf\").value\n    axios.post('/mvc/pay', {\n        account: account,\n        _csrf: csrf   //\u643a\u5e26\u6b64\u4fe1\u606f\u5373\u53ef\uff0c\u5426\u5219\u4f1a\u88ab\u62e6\u622a\n    }, {\n      ...\n</code></pre> <p>\u5982\u679c\u540e\u7eed\u5404\u4f4d\u5c0f\u4f19\u4f34\u9047\u5230\u90a3\u79cd\u9700\u8981\u518dform\u8868\u5355\u4e2d\u63d0\u4ea4\u7684\u60c5\u51b5\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u50cf\u4e0b\u9762\u8fd9\u6837\u7ed9\u585e\u5230\u8868\u5355\u91cc\uff1a</p> <pre><code>&lt;form action=\"/xxxx\" method=\"post\"&gt;\n    ...\n    &lt;input type=\"text\" th:name=\"${_csrf.getParameterName()}\" th:value=\"${_csrf.token}\" hidden&gt;\n    ...\n&lt;/form&gt;\n</code></pre> <p>\u5b9e\u9645\u4e0a\u73b0\u5728\u7684\u6d4f\u89c8\u5668\u5df2\u7ecf\u5f88\u5b89\u5168\u4e86\uff0c\u5b8c\u5168\u4e0d\u9700\u8981\u4f7f\u7528\u81ea\u5e26\u7684csrf\u9632\u62a4\uff0c\u540e\u9762\u6211\u4eec\u4f1a\u8bb2\u89e3\u5982\u4f55\u901a\u8fc7\u914d\u7f6e\u5173\u95edcsrf\u9632\u62a4\u3002\u8fd9\u91cc\u6e29\u99a8\u63d0\u9192\u4e00\u4e0b\uff0c\u5728\u540e\u7eed\u5404\u4f4d\u5c0f\u4f19\u4f34\u8ddf\u6211\u4eec\u7684\u5b9e\u6218\u9879\u76ee\u65f6\uff0c\u5982\u679c\u9047\u5230\u8bf8\u5982401\u3001403\u8fd9\u79cd\u9519\u8bef\u65f6\uff0c\u4f18\u5148\u67e5\u770b\u4f60\u7684SpringSecurity\u914d\u7f6e\u662f\u5426\u9519\u8bef\u3002</p> <p>\u4eceSpring Security 4.0\u5f00\u59cb\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u542f\u7528CSRF\u4fdd\u62a4\uff0c\u4ee5\u9632\u6b62CSRF\u653b\u51fb\u5e94\u7528\u7a0b\u5e8f\uff0cSpring Security CSRF\u4f1a\u9488\u5bf9PATCH\uff0cPOST\uff0cPUT\u548cDELETE\u65b9\u6cd5\u7684\u8bf7\u6c42\uff08\u4e0d\u4ec5\u4ec5\u53ea\u662f\u767b\u9646\u8bf7\u6c42\uff0c\u8fd9\u91cc\u6307\u7684\u662f\u4efb\u4f55\u8bf7\u6c42\u8def\u5f84\uff09\u8fdb\u884c\u9632\u62a4\uff0c\u800c\u8fd9\u91cc\u7684\u767b\u9646\u8868\u5355\u6b63\u597d\u662f\u4e00\u4e2aPOST\u7c7b\u578b\u7684\u8bf7\u6c42\u3002\u5728\u9ed8\u8ba4\u914d\u7f6e\u4e0b\uff0c\u65e0\u8bba\u662f\u5426\u767b\u9646\uff0c\u9875\u9762\u4e2d\u53ea\u8981\u53d1\u8d77\u4e86PATCH\uff0cPOST\uff0cPUT\u548cDELETE\u8bf7\u6c42\u4e00\u5b9a\u4f1a\u88ab\u62d2\u7edd\uff0c\u5e76\u8fd4\u56de403\u9519\u8bef\uff08\u6ce8\u610f\uff0c\u8fd9\u91cc\u662f\u4e2a\u7a76\u6781\u5927\u5751\uff0c\u8fd9\u4e2a\u6ca1\u6709\u4efb\u4f55\u63d0\u793a\uff0c\u76f4\u63a5403\uff0c\u56e0\u6b64\u5982\u679c\u4f60\u4e0d\u77e5\u9053\u7684\u8bdd\u6839\u672c\u4e0d\u6e05\u695a\u662f\u4ec0\u4e48\u95ee\u9898\uff0c\u5c31\u4e00\u76f4\u5361\u8fd9\u91cc\u4e86\uff09\uff0c\u9700\u8981\u5728\u8bf7\u6c42\u7684\u65f6\u5019\u52a0\u5165csrfToken\u624d\u884c\uff0c\u4e5f\u5c31\u662f\"83421936-b84b-44e3-be47-58bb2c14571a\"\uff0c\u6b63\u662fcsrfToken\uff0c\u5982\u679c\u63d0\u4ea4\u7684\u662f\u8868\u5355\u7c7b\u578b\u7684\u6570\u636e\uff0c\u90a3\u4e48\u8868\u5355\u4e2d\u5fc5\u987b\u5305\u542b\u6b64Token\u5b57\u7b26\u4e32\uff0c\u952e\u540d\u79f0\u4e3a\"_csrf\"\uff1b\u5982\u679c\u662fJSON\u6570\u636e\u683c\u5f0f\u53d1\u9001\u7684\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5728\u8bf7\u6c42\u5934\u4e2d\u5305\u542b\u6b64Token\u5b57\u7b26\u4e32\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_6","title":"\u57fa\u4e8e\u6570\u636e\u5e93\u9a8c\u8bc1","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b9e\u73b0\u4e86\u76f4\u63a5\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4f46\u662f\u5b9e\u9645\u9879\u76ee\u4e2d\u5f80\u5f80\u90fd\u662f\u5c06\u7528\u6237\u4fe1\u606f\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u90a3\u4e48\u5982\u4f55\u5c06\u5176\u8fde\u63a5\u5230\u6570\u636e\u5e93\uff0c\u901a\u8fc7\u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u7684\u7528\u6237\u4fe1\u606f\u6765\u8fdb\u884c\u7528\u6237\u767b\u5f55\u5462\uff1f</p> <p>\u5b98\u65b9\u9ed8\u8ba4\u63d0\u4f9b\u4e86\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u7684\u7528\u6237\u548c\u6743\u9650\u8868\u8bbe\u8ba1\uff0c\u6839\u672c\u4e0d\u9700\u8981\u6211\u4eec\u6765\u5efa\u8868\uff0c\u76f4\u63a5\u5728Navicat\u4e2d\u6267\u884c\u4ee5\u4e0b\u67e5\u8be2\uff1a</p> <pre><code>create table users(username varchar(50) not null primary key,password varchar(500) not null,enabled boolean not null);\ncreate table authorities (username varchar(50) not null,authority varchar(50) not null,constraint fk_authorities_users foreign key(username) references users(username));\ncreate unique index ix_auth_username on authorities (username,authority);\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6dfb\u52a0Mybatis\u548cMySQL\u76f8\u5173\u7684\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;\n    &lt;version&gt;3.5.13&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;\n    &lt;version&gt;3.0.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n    &lt;version&gt;8.0.31&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;\n    &lt;version&gt;6.0.10&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u7f16\u5199\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    @Bean PasswordEncoder passwordEncoder(){\n        return new BCryptPasswordEncoder();\n    }\n\n    @Bean\n    public DataSource dataSource(){\n        //\u6570\u636e\u6e90\u914d\u7f6e\n        return new PooledDataSource(\"com.mysql.cj.jdbc.Driver\",\n                \"jdbc:mysql://localhost:3306/test\", \"root\", \"123456\");\n    }\n\n    @Bean\n    public UserDetailsService userDetailsService(DataSource dataSource,\n                                                 PasswordEncoder encoder) {\n        JdbcUserDetailsManager manager = new JdbcUserDetailsManager(dataSource);\n        //\u4ec5\u9996\u6b21\u542f\u52a8\u65f6\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u7528\u4e8e\u6d4b\u8bd5\uff0c\u540e\u7eed\u65e0\u9700\u521b\u5efa\n            manager.createUser(User.withUsername(\"user\")\n                      .password(encoder.encode(\"password\")).roles(\"USER\").build());\n        return manager;\n    }\n}\n</code></pre> <p>\u542f\u52a8\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u4e24\u5f20\u8868\u4e2d\u5df2\u7ecf\u81ea\u52a8\u6dfb\u52a0\u597d\u5bf9\u5e94\u7684\u6570\u636e\u4e86\uff1a</p> <p></p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c1d\u8bd5\u8fdb\u884c\u767b\u5f55\uff0c\u4f7f\u7528\u65b9\u5f0f\u548c\u4e4b\u524d\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u5f53\u6211\u4eec\u4e0b\u6b21\u9700\u8981\u5feb\u901f\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u767b\u5f55\u7684\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u76f4\u63a5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u5c31\u80fd\u5feb\u901f\u5b8c\u6210\u4e86\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u7279\u522b\u65b9\u4fbf\u3002</p> <p>\u65e0\u8bba\u662f\u6211\u4eec\u4e0a\u8282\u8bfe\u8ba4\u8bc6\u7684InMemoryUserDetailsManager\u8fd8\u662f\u73b0\u5728\u8ba4\u8bc6\u7684JdbcUserDetailsManager\uff0c\u4ed6\u4eec\u90fd\u662f\u5b9e\u73b0\u81eaUserDetailsManager\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u4e2d\u6709\u7740\u4e00\u5957\u5b8c\u6574\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c\uff0c\u65b9\u4fbf\u6211\u4eec\u76f4\u63a5\u5bf9\u7528\u6237\u8fdb\u884c\u5904\u7406\uff1a</p> <pre><code>public interface UserDetailsManager extends UserDetailsService {\n\n  //\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7528\u6237\n    void createUser(UserDetails user);\n\n  //\u66f4\u65b0\u7528\u6237\u4fe1\u606f\n    void updateUser(UserDetails user);\n\n  //\u5220\u9664\u7528\u6237\n    void deleteUser(String username);\n\n  //\u4fee\u6539\u7528\u6237\u5bc6\u7801\n    void changePassword(String oldPassword, String newPassword);\n\n  //\u5224\u65ad\u662f\u5426\u5b58\u5728\u6307\u5b9a\u7528\u6237\n    boolean userExists(String username);\n}\n</code></pre> <p>\u901a\u8fc7\u4f7f\u7528UserDetailsManager\u5bf9\u8c61\uff0c\u6211\u4eec\u5c31\u80fd\u5feb\u901f\u6267\u884c\u7528\u6237\u76f8\u5173\u7684\u7ba1\u7406\u64cd\u4f5c\uff0c\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u7f51\u7ad9\u4e0a\u6dfb\u52a0\u4e00\u4e2a\u5feb\u901f\u91cd\u7f6e\u5bc6\u7801\u7684\u63a5\u53e3\uff0c\u9996\u5148\u9700\u8981\u914d\u7f6e\u4e00\u4e0bJdbcUserDetailsManager\uff0c\u4e3a\u5176\u6dfb\u52a0\u4e00\u4e2aAuthenticationManager\u7528\u4e8e\u539f\u5bc6\u7801\u7684\u6821\u9a8c\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    ...\n\n    //\u624b\u52a8\u521b\u5efa\u4e00\u4e2aAuthenticationManager\u7528\u4e8e\u5904\u7406\u5bc6\u7801\u6821\u9a8c\n    private AuthenticationManager authenticationManager(UserDetailsManager manager,\n                                                        PasswordEncoder encoder){\n        DaoAuthenticationProvider provider = new DaoAuthenticationProvider();\n        provider.setUserDetailsService(manager);\n        provider.setPasswordEncoder(encoder);\n        return new ProviderManager(provider);\n    }\n\n    @Bean\n    public UserDetailsManager userDetailsService(DataSource dataSource,\n                                                 PasswordEncoder encoder) throws Exception {\n        JdbcUserDetailsManager manager = new JdbcUserDetailsManager(dataSource);\n        //\u4e3aUserDetailsManager\u8bbe\u7f6eAuthenticationManager\u5373\u53ef\u5f00\u542f\u91cd\u7f6e\u5bc6\u7801\u7684\u65f6\u7684\u6821\u9a8c\n        manager.setAuthenticationManager(authenticationManager(manager, encoder));\n        return manager;\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u7f16\u5199\u4e00\u4e2a\u5feb\u901f\u91cd\u7f6e\u5bc6\u7801\u7684\u63a5\u53e3\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(\"/change-password\")\npublic JSONObject changePassword(@RequestParam String oldPassword,\n                                 @RequestParam String newPassword) {\n    manager.changePassword(oldPassword, encoder.encode(newPassword));\n    JSONObject object = new JSONObject();\n    object.put(\"success\", true);\n    return object;\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728\u4e3b\u754c\u9762\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u91cd\u7f6e\u5bc6\u7801\u7684\u64cd\u4f5c\uff1a</p> <pre><code>&lt;div&gt;\n    &lt;label&gt;\n        \u4fee\u6539\u5bc6\u7801\uff1a\n        &lt;input type=\"text\" id=\"oldPassword\" placeholder=\"\u65e7\u5bc6\u7801\"/&gt;\n        &lt;input type=\"text\" id=\"newPassword\" placeholder=\"\u65b0\u5bc6\u7801\"/&gt;\n    &lt;/label&gt;\n    &lt;button onclick=\"change()\"&gt;\u4fee\u6539\u5bc6\u7801&lt;/button&gt;\n&lt;/div&gt;\n</code></pre> <pre><code>function change() {\n    const oldPassword = document.getElementById(\"oldPassword\").value\n    const newPassword = document.getElementById(\"newPassword\").value\n    const csrf = document.getElementById(\"_csrf\").value\n    axios.post('/mvc/change-password', {\n        oldPassword: oldPassword,\n        newPassword: newPassword,\n        _csrf: csrf\n    }, {\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n        }\n    }).then(({data}) =&gt; {\n        alert(data.success ? \"\u5bc6\u7801\u4fee\u6539\u6210\u529f\" : \"\u5bc6\u7801\u4fee\u6539\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u539f\u5bc6\u7801\u662f\u5426\u6b63\u786e\")\n    })\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u9996\u9875\u8fdb\u884c\u4fee\u6539\u5bc6\u7801\u64cd\u4f5c\u4e86\uff1a</p> <p></p> <p>\u5f53\u7136\uff0c\u8fd9\u79cd\u65b9\u5f0f\u7684\u6743\u9650\u6821\u9a8c\u867d\u7136\u80fd\u591f\u76f4\u63a5\u4f7f\u7528\u6570\u636e\u5e93\uff0c\u4f46\u662f\u5b58\u5728\u4e00\u5b9a\u7684\u5c40\u9650\u6027\uff0c\u53ea\u9002\u5408\u5feb\u901f\u642d\u5efaDemo\u4f7f\u7528\uff0c\u4e0d\u9002\u5408\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e0b\u7f16\u5199\uff0c\u4e0b\u4e00\u8282\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u5b9e\u73b0\u81ea\u5b9a\u4e49\u9a8c\u8bc1\uff0c\u4ee5\u5e94\u5bf9\u5404\u79cd\u60c5\u51b5\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_7","title":"\u81ea\u5b9a\u4e49\u9a8c\u8bc1","text":"<p>\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u7684\u6570\u636e\u5e93\u53ef\u80fd\u5e76\u4e0d\u4f1a\u50cfSpringSecurity\u9ed8\u8ba4\u7684\u90a3\u6837\u8fdb\u884c\u8bbe\u8ba1\uff0c\u800c\u662f\u91c7\u7528\u81ea\u5b9a\u4e49\u7684\u8868\u7ed3\u6784\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0a\u9762\u4e24\u79cd\u65b9\u5f0f\u5c31\u5f88\u96be\u8fdb\u884c\u9a8c\u8bc1\u4e86\uff0c\u6b64\u65f6\u6211\u4eec\u5f97\u7f16\u5199\u81ea\u5b9a\u4e49\u9a8c\u8bc1\uff0c\u6765\u5e94\u5bf9\u5404\u79cd\u4efb\u610f\u53d8\u5316\u7684\u60c5\u51b5\u3002</p> <p>\u65e2\u7136\u9700\u8981\u81ea\u5b9a\u4e49\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u81ea\u884c\u5b9e\u73b0UserDetailsService\u6216\u662f\u529f\u80fd\u66f4\u5b8c\u5584\u7684UserDetailsManager\u63a5\u53e3\uff0c\u8fd9\u91cc\u4e3a\u4e86\u7b80\u5355\uff0c\u6211\u4eec\u76f4\u63a5\u9009\u62e9\u524d\u8005\u8fdb\u884c\u5b9e\u73b0\uff1a</p> <pre><code>@Service\npublic class AuthorizeService implements UserDetailsService {\n\n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n        return null;\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u9700\u8981\u53bb\u5b9e\u73b0\u8fd9\u4e2a<code>loadUserByUsername</code>\u65b9\u6cd5\uff0c\u8868\u793a\u5728\u9a8c\u8bc1\u7684\u65f6\u5019\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684\u65b9\u5f0f\uff0c\u6839\u636e\u7ed9\u5b9a\u7684\u7528\u6237\u540d\u67e5\u8be2\u7528\u6237\uff0c\u5e76\u5c01\u88c5\u4e3a<code>UserDetails</code>\u5bf9\u8c61\u8fd4\u56de\uff0c\u7136\u540e\u7531SpringSecurity\u5c06\u6211\u4eec\u8fd4\u56de\u7684\u5bf9\u8c61\u4e0e\u7528\u6237\u767b\u5f55\u7684\u4fe1\u606f\u8fdb\u884c\u6838\u9a8c\uff0c\u57fa\u672c\u6d41\u7a0b\u5b9e\u9645\u4e0a\u8ddf\u4e4b\u524d\u662f\u4e00\u6837\u7684\uff0c\u53ea\u662f\u73b0\u5728\u7531\u6211\u4eec\u81ea\u5df1\u6765\u63d0\u4f9b\u7528\u6237\u67e5\u8be2\u65b9\u5f0f\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u5728\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u7528\u6237\u8868\uff1a</p> <p></p> <p>\u968f\u4fbf\u63d2\u5165\u4e00\u70b9\u6570\u636e\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u81ea\u884c\u7f16\u5199\u5bf9\u5e94\u7684\u67e5\u8be2\u64cd\u4f5c\uff0c\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u5bf9\u5e94\u7684\u5b9e\u4f53\u7c7b\uff1a</p> <pre><code>@Data\npublic class Account {\n    int id;\n    String username;\n    String password;\n}\n</code></pre> <p>\u7136\u540e\u662f\u6839\u636e\u7528\u6237\u540d\u67e5\u8be2\u7528\u6237\u7684Mapper\u63a5\u53e3\uff1a</p> <pre><code>public interface UserMapper {\n    @Select(\"select * from user where username = #{username}\")\n    Account findUserByName(String username);\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u5728\u914d\u7f6e\u7c7b\u4e0a\u6dfb\u52a0\u76f8\u5e94\u7684\u5305\u626b\u63cf\uff1a</p> <pre><code>@EnableWebMvc\n@Configuration\n@ComponentScans({\n        @ComponentScan(\"com.example.controller\"),\n        @ComponentScan(\"com.example.service\")\n})\n@MapperScan(\"com.example.mapper\")\npublic class WebConfiguration implements WebMvcConfigurer {\n    ...\n}\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u6765\u5230Service\u8fd9\u8fb9\u8fdb\u884c\u4e00\u4e0b\u5b8c\u5584\uff0c\u4ece\u6570\u636e\u5e93\u4e2d\u8fdb\u884c\u67e5\u8be2\uff1a</p> <pre><code>@Service\npublic class AuthorizeService implements UserDetailsService {\n\n    @Resource\n    UserMapper mapper;\n\n    @Override\n    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n        Account account = mapper.findUserByName(username);\n        if(account == null)\n            throw new UsernameNotFoundException(\"\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\");\n        return User\n                .withUsername(username)\n                .password(account.getPassword())\n                .build();\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684\u65b9\u5f0f\u5b9e\u73b0\u4e86\u6570\u636e\u5e93\u4fe1\u606f\u67e5\u8be2\uff0c\u5e76\u5b8c\u6210\u7528\u6237\u767b\u5f55\u64cd\u4f5c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_8","title":"\u5176\u4ed6\u914d\u7f6e","text":"<p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u5982\u679c\u5c06SpringSecurity\u4f5c\u4e3a\u6211\u4eec\u7684\u767b\u5f55\u6821\u9a8c\u6846\u67b6\uff0c\u5e76\u4e14\u5b9e\u73b0\u4e86\u4e09\u79cd\u65b9\u5f0f\u7684\u6821\u9a8c\uff0c\u4f46\u662f\u5149\u662f\u8fd9\u6837\uff0c\u81ea\u7531\u5ea6\u8fd8\u8fdc\u8fdc\u4e0d\u591f\uff0c\u5728\u5b9e\u9645\u5f00\u53d1\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u8fd8\u4f1a\u9762\u5bf9\u5404\u79cd\u5404\u6837\u7684\u9700\u6c42\uff0c\u8fd9\u4e00\u90e8\u5206\u6211\u4eec\u63a5\u7740\u6765\u8fdb\u884c\u66f4\u52a0\u6df1\u5c42\u6b21\u7684\u914d\u7f6e\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_9","title":"\u81ea\u5b9a\u4e49\u767b\u5f55\u754c\u9762","text":"<p>\u867d\u7136SpringSecurity\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8fd8\u884c\u7684\u767b\u5f55\u754c\u9762\uff0c\u4f46\u662f\u5f88\u591a\u60c5\u51b5\u4e0b\u5f80\u5f80\u90fd\u662f\u6211\u4eec\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u767b\u5f55\u754c\u9762\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u8fdb\u884c\u66f4\u591a\u7684\u914d\u7f6e\u4e86\uff0c\u6211\u4eec\u8fd8\u662f\u4ee5\u4e4b\u524d\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u4f7f\u7528\u7684\u6a21\u7248\u4e3a\u4f8b\u3002</p> <p>\u4e0b\u8f7d\u597d\u6a21\u7248\u540e\uff0c\u6211\u4eec\u5c06\u5176\u4e2d\u7684\u4e24\u4e2a\u9875\u9762\u548c\u8d44\u6e90\u6587\u4ef6\u653e\u5230\u7c7b\u8def\u5f84\u4e0b\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u914d\u7f6e\u5bf9\u5e94\u9875\u9762\u7684Controller\u63a7\u5236\u5668\uff1a</p> <pre><code>@Controller\npublic class HelloController {\n    @GetMapping(\"/\")\n    public String index(){\n        return \"index\";\n    }\n\n    @GetMapping(\"/login\")\n    public String login(){\n        return \"login\";\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5728\u767b\u5f55\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5c55\u793a\u524d\u7aef\u6a21\u7248\u9875\u9762\u4e86\uff1a</p> <p></p> <p>\u4e0d\u8fc7\u73b0\u5728\u4f9d\u7136\u662f\u9ed8\u8ba4\u8fdb\u5165\u5230SpringSecurity\u9ed8\u8ba4\u7684\u767b\u5f55\u754c\u9762\uff0c\u73b0\u5728\u6211\u4eec\u6765\u914d\u7f6e\u81ea\u5b9a\u4e49\u7684\u767b\u5f55\u754c\u9762\uff0c\u5c06\u6211\u4eec\u7684\u524d\u7aef\u6a21\u7248\u4e2d\u7684\u767b\u5f55\u9875\u9762\u4f5c\u4e3aSpringSecurity\u7684\u9ed8\u8ba4\u767b\u5f55\u754c\u9762\u3002</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    ...\n\n        //\u5982\u679c\u4f60\u5b66\u4e60\u8fc7SpringSecurity 5.X\u7248\u672c\uff0c\u53ef\u80fd\u4f1a\u53d1\u73b0\u65b0\u7248\u672c\u7684\u914d\u7f6e\u65b9\u5f0f\u5b8c\u5168\u4e0d\u4e00\u6837\n    //\u65b0\u7248\u672c\u5168\u90e8\u91c7\u7528lambda\u5f62\u5f0f\u8fdb\u884c\u914d\u7f6e\uff0c\u65e0\u6cd5\u518d\u4f7f\u7528\u4e4b\u524d\u7684and()\u65b9\u6cd5\u8fdb\u884c\u8fde\u63a5\u4e86\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                //\u4ee5\u4e0b\u662f\u9a8c\u8bc1\u8bf7\u6c42\u62e6\u622a\u548c\u653e\u884c\u914d\u7f6e\n                .authorizeHttpRequests(auth -&gt; {\n                    auth.anyRequest().authenticated();    //\u5c06\u6240\u6709\u8bf7\u6c42\u5168\u90e8\u62e6\u622a\uff0c\u4e00\u5f8b\u9700\u8981\u9a8c\u8bc1\n                })\n                //\u4ee5\u4e0b\u662f\u8868\u5355\u767b\u5f55\u76f8\u5173\u914d\u7f6e\n                .formLogin(conf -&gt; {\n                    conf.loginPage(\"/login\");   //\u5c06\u767b\u5f55\u9875\u8bbe\u7f6e\u4e3a\u6211\u4eec\u81ea\u5df1\u7684\u767b\u5f55\u9875\u9762\n                    conf.loginProcessingUrl(\"/doLogin\"); //\u767b\u5f55\u8868\u5355\u63d0\u4ea4\u7684\u5730\u5740\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\n                    conf.defaultSuccessUrl(\"/\");   //\u767b\u5f55\u6210\u529f\u540e\u8df3\u8f6c\u7684\u9875\u9762\n                    conf.permitAll();    //\u5c06\u767b\u5f55\u76f8\u5173\u7684\u5730\u5740\u653e\u884c\uff0c\u5426\u5219\u672a\u767b\u5f55\u7684\u7528\u6237\u8fde\u767b\u5f55\u754c\u9762\u90fd\u8fdb\u4e0d\u53bb\n                    //\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u8868\u5355\u5b57\u6bb5\u540d\u79f0\uff0c\u4e0d\u8fc7\u9ed8\u8ba4\u5c31\u662f\u8fd9\u4e2a\uff0c\u53ef\u4ee5\u4e0d\u914d\u7f6e\uff0c\u9664\u975e\u6709\u7279\u6b8a\u9700\u6c42\n                    conf.usernameParameter(\"username\");\n                    conf.passwordParameter(\"password\");\n                })\n                .build();\n    }\n}\n</code></pre> <p>\u9700\u8981\u914d\u7f6e\u767b\u9646\u9875\u9762\u7684\u5730\u5740\u548c\u767b\u9646\u8bf7\u6c42\u53d1\u9001\u7684\u5730\u5740\uff0c\u8fd9\u91cc\u767b\u9646\u9875\u9762\u586b\u5199\u4e3a<code>/login</code>\uff0c\u767b\u9646\u8bf7\u6c42\u5730\u5740\u4e3a<code>/doLogin</code>\uff0c\u767b\u9646\u9875\u9762\u6211\u4eec\u521a\u521a\u5df2\u7ecf\u81ea\u5df1\u7f16\u5199Controller\u6765\u5b9e\u73b0\u4e86\uff0c\u767b\u9646\u8bf7\u6c42\u63d0\u4ea4\u5904\u7406\u7531SpringSecurity\u63d0\u4f9b\uff0c\u53ea\u9700\u8981\u5199\u8def\u5f84\u5c31\u53ef\u4ee5\u4e86\u3002\u73b0\u5728\u8bbf\u95ee\u6211\u4eec\u7684\u7f51\u7ad9\uff0c\u5c31\u53ef\u4ee5\u8fdb\u5165\u5230\u81ea\u5b9a\u4e49\u7684\u767b\u5f55\u754c\u9762\u4e86\uff1a</p> <p></p> <p>\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u7684\u9875\u9762\u53ea\u6709\u4e00\u4e2a\u7eaf\u6587\u672c\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728\u83b7\u53d6\u9759\u6001\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u6240\u6709\u7684\u9759\u6001\u8d44\u6e90\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e5f\u4f1a\u88ab\u62e6\u622a\uff0c\u56e0\u6b64\u5168\u90e8\u88ab302\u91cd\u5b9a\u5411\u5230\u767b\u5f55\u9875\u9762\uff0c\u8fd9\u663e\u7136\u662f\u4e0d\u5bf9\u7684\uff1a</p> <p></p> <p>\u56e0\u6b64\uff0c\u73b0\u5728\u6211\u4eec\u9700\u8981\u5c06\u6240\u6709\u7684\u9759\u6001\u8d44\u6e90\u4e5f\u7ed9\u653e\u884c\uff0c\u5426\u5219\u767b\u5f55\u754c\u9762\u90fd\u6ca1\u6cd5\u6b63\u5e38\u5c55\u793a\uff1a</p> <pre><code>.authorizeHttpRequests(auth -&gt; {\n      auth.requestMatchers(\"/static/**\").permitAll();   //\u5c06\u6240\u6709\u7684\u9759\u6001\u8d44\u6e90\u653e\u884c\uff0c\u4e00\u5b9a\u8981\u6dfb\u52a0\u5728\u5168\u90e8\u8bf7\u6c42\u62e6\u622a\u4e4b\u524d\n      auth.anyRequest().authenticated();    //\u5c06\u6240\u6709\u8bf7\u6c42\u5168\u90e8\u62e6\u622a\uff0c\u4e00\u5f8b\u9700\u8981\u9a8c\u8bc1\n})\n</code></pre> <p>\u518d\u6b21\u8bbf\u95ee\u6211\u4eec\u7684\u7f51\u7ad9\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u6b63\u5e38\u663e\u793a\u7684\u767b\u5f55\u754c\u9762\u4e86\uff1a</p> <p></p> <p>\u56e0\u6b64\uff0c\u5982\u679c\u5404\u4f4d\u5c0f\u4f19\u4f34\u540e\u7eed\u5728\u7f16\u5199\u9879\u76ee\u8fc7\u7a0b\u4e2d\u53d1\u73b0\u6709302\u7684\u60c5\u51b5\uff0c\u4e00\u5b9a\u8981\u5148\u68c0\u67e5\u662f\u5426\u56e0\u4e3a\u6ca1\u6709\u653e\u884c\u5bfc\u81f4\u88abSpringSecurity\u7ed9\u62e6\u622a\u4e86\uff0c\u522b\u518d\u9047\u5230302\u4e00\u8138\u61f5\u903c\u4e86\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u6765\u914d\u7f6e\u767b\u5f55\u64cd\u4f5c\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981\u914d\u7f6e\u4e00\u4e0b\u767b\u5f55\u7684\u5730\u5740\u548c\u767b\u5f55\u6309\u94ae\u5373\u53ef\uff0c\u5f53\u7136\uff0c\u8ddf\u4e4b\u524d\u4e00\u6837\uff0c\u8981\u628aCSRF\u7684\u8f93\u5165\u6846\u4e5f\u52a0\u4e0a\uff1a</p> <pre><code>&lt;form action=\"doLogin\" method=\"post\"&gt;\n        ...\n  &lt;input type=\"text\" name=\"username\" placeholder=\"Email Address\" class=\"ad-input\"&gt;\n  ...\n  &lt;input type=\"password\" name=\"password\" placeholder=\"Password\" class=\"ad-input\"&gt;\n  ...\n  &lt;input type=\"text\" th:name=\"${_csrf.getParameterName()}\" th:value=\"${_csrf.token}\" hidden&gt;\n  &lt;div class=\"ad-auth-btn\"&gt;\n     &lt;button type=\"submit\" class=\"ad-btn ad-login-member\"&gt;Login&lt;/button&gt;\n  &lt;/div&gt;\n    ...\n&lt;/form&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u5c1d\u8bd5\u8fdb\u884c\u767b\u5f55\u64cd\u4f5c\u4e86\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u6210\u529f\u5730\u767b\u5f55\u5230\u4e3b\u9875\u4e86\u3002</p> <p>\u9000\u51fa\u767b\u5f55\u4e5f\u662f\u540c\u6837\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7a0d\u5fae\u8fdb\u884c\u4e00\u4e0b\u914d\u7f6e\u5c31\u53ef\u4ee5\u5b9e\u73b0\uff0c\u6211\u4eec\u9996\u5148\u7ee7\u7eed\u5b8c\u5584\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    ...\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                ...\n                //\u4ee5\u4e0b\u662f\u9000\u51fa\u767b\u5f55\u76f8\u5173\u914d\u7f6e\n                .logout(conf -&gt; {\n                    conf.logoutUrl(\"/doLogout\");   //\u9000\u51fa\u767b\u5f55\u5730\u5740\uff0c\u8ddf\u4e0a\u9762\u4e00\u6837\u53ef\u81ea\u5b9a\u4e49\n                    conf.logoutSuccessUrl(\"/login\");  //\u9000\u51fa\u767b\u5f55\u6210\u529f\u540e\u8df3\u8f6c\u7684\u5730\u5740\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e3a\u767b\u5f55\u754c\u9762\n                    conf.permitAll();\n                })\n                .build();\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u7a0d\u5fae\u9b54\u6539\u4e00\u4e0b\u9875\u9762\u4e2d\u7684\u9000\u51fa\u767b\u5f55\u6309\u94ae\uff1a</p> <pre><code>&lt;li&gt;\n   &lt;form action=\"doLogout\" method=\"post\"&gt;\n        &lt;input type=\"text\" th:name=\"${_csrf.getParameterName()}\" th:value=\"${_csrf.token}\" hidden&gt;\n        &lt;button type=\"submit\"&gt;\n           &lt;i class=\"fas fa-sign-out-alt\"&gt;&lt;/i&gt; logout\n        &lt;/button&gt;\n   &lt;/form&gt;\n&lt;/li&gt;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u70b9\u51fb\u53f3\u4e0a\u89d2\u7684\u9000\u51fa\u6309\u94ae\u5c31\u53ef\u4ee5\u9000\u51fa\u4e86\uff1a</p> <p></p> <p>\u4e0d\u8fc7\uff0c\u53ef\u80fd\u4f1a\u6709\u5c0f\u4f19\u4f34\u89c9\u5f97\uff0c\u6211\u4eec\u73b0\u5728\u65e0\u8bba\u63d0\u4ea4\u4ec0\u4e48\u8bf7\u6c42\u90fd\u9700\u8981Csrf\u6821\u9a8c\uff0c\u6709\u4e9b\u592a\u9ebb\u70e6\u4e86\uff0c\u5b9e\u9645\u4e0a\u73b0\u5728\u6d4f\u89c8\u5668\u5df2\u7ecf\u5f88\u5b89\u5168\u4e86\uff0c\u6ca1\u5fc5\u8981\u9632\u5fa1\u5230\u8fd9\u79cd\u7a0b\u5ea6\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u914d\u7f6e\u4e2d\u5173\u95edcsrf\u6821\u9a8c\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    ...\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                ...\n                //\u4ee5\u4e0b\u662fcsrf\u76f8\u5173\u914d\u7f6e\n                .csrf(conf -&gt; {\n                    conf.disable();   //\u6b64\u65b9\u6cd5\u53ef\u4ee5\u76f4\u63a5\u5173\u95ed\u5168\u90e8\u7684csrf\u6821\u9a8c\uff0c\u4e00\u6b65\u5230\u4f4d\n                    conf.ignoringRequestMatchers(\"/xxx/**\");   //\u6b64\u65b9\u6cd5\u53ef\u4ee5\u6839\u636e\u60c5\u51b5\u5ffd\u7565\u67d0\u4e9b\u5730\u5740\u7684csrf\u6821\u9a8c\n                })\n                .build();\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u518d\u5f80\u9875\u9762\u4e2d\u5d4c\u5165CSRF\u76f8\u5173\u7684\u8f93\u5165\u6846\u4e86\uff0c\u53d1\u9001\u8bf7\u6c42\u65f6\u4e5f\u4e0d\u4f1a\u8fdb\u884c\u6821\u9a8c\uff0c\u81f3\u6b64\uff0c\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u7b80\u5355\u7684\u81ea\u5b9a\u4e49\u767b\u5f55\u754c\u9762\u914d\u7f6e\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_10","title":"\u8bb0\u4f4f\u6211\u529f\u80fd","text":"<p>\u6211\u4eec\u7684\u7f51\u7ad9\u8fd8\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u529f\u80fd\uff0c\u5c31\u662f\u8bb0\u4f4f\u6211\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u5728\u767b\u9646\u4e4b\u540e\u7684\u4e00\u6bb5\u65f6\u95f4\u5185\uff0c\u65e0\u9700\u518d\u6b21\u8f93\u5165\u8d26\u53f7\u548c\u5bc6\u7801\u8fdb\u884c\u767b\u9646\uff0c\u76f8\u5f53\u4e8e\u670d\u52a1\u7aef\u5df2\u7ecf\u8bb0\u4f4f\u5f53\u524d\u7528\u6237\uff0c\u518d\u6b21\u8bbf\u95ee\u65f6\u5c31\u53ef\u4ee5\u514d\u767b\u9646\u8fdb\u5165\uff0c\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u5e38\u7528\u7684\u529f\u80fd\u3002</p> <p>\u6211\u4eec\u4e4b\u524d\u5728JavaWeb\u9636\u6bb5\uff0c\u4f7f\u7528\u672c\u5730Cookie\u5b58\u50a8\u7684\u65b9\u5f0f\u5b9e\u73b0\u4e86\u8bb0\u4f4f\u6211\u529f\u80fd\uff0c\u4f46\u662f\u8fd9\u79cd\u65b9\u5f0f\u5e76\u4e0d\u5b89\u5168\uff0c\u540c\u65f6\u5728\u4ee3\u7801\u7f16\u5199\u4e0a\u4e5f\u6bd4\u8f83\u9ebb\u70e6\uff0c\u90a3\u4e48\u80fd\u5426\u6709\u4e00\u79cd\u66f4\u52a0\u9ad8\u6548\u7684\u8bb0\u4f4f\u6211\u529f\u80fd\u5b9e\u73b0\u5462\uff1f</p> <p>SpringSecurity\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u79cd\u4f18\u79c0\u7684\u5b9e\u73b0\uff0c\u5b83\u4e3a\u6bcf\u4e2a\u5df2\u7ecf\u767b\u9646\u7684\u6d4f\u89c8\u5668\u5206\u914d\u4e00\u4e2a\u643a\u5e26Token\u7684Cookie\uff0c\u5e76\u4e14\u6b64Cookie\u9ed8\u8ba4\u4f1a\u88ab\u4fdd\u755914\u5929\uff0c\u53ea\u8981\u6211\u4eec\u4e0d\u6e05\u7406\u6d4f\u89c8\u5668\u7684Cookie\uff0c\u90a3\u4e48\u4e0b\u6b21\u643a\u5e26\u6b64Cookie\u8bbf\u95ee\u670d\u52a1\u5668\u5c06\u65e0\u9700\u767b\u9646\uff0c\u76f4\u63a5\u7ee7\u7eed\u4f7f\u7528\u4e4b\u524d\u767b\u9646\u7684\u8eab\u4efd\uff0c\u8fd9\u6837\u663e\u7136\u6bd4\u6211\u4eec\u4e4b\u524d\u7684\u5199\u6cd5\u66f4\u52a0\u7b80\u4fbf\u3002\u5e76\u4e14\u6211\u4eec\u9700\u8981\u8fdb\u884c\u7b80\u5355\u914d\u7f6e\uff0c\u5373\u53ef\u5f00\u542f\u8bb0\u4f4f\u6211\u529f\u80fd\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    ...\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                ...\n                .rememberMe(conf -&gt; {\n                    conf.alwaysRemember(false);  //\u8fd9\u91cc\u4e0d\u8981\u5f00\u542f\u59cb\u7ec8\u8bb0\u4f4f\uff0c\u6211\u4eec\u9700\u8981\u914d\u7f6e\u4e3a\u7528\u6237\u81ea\u884c\u52fe\u9009\n                    conf.rememberMeParameter(\"remember-me\");   //\u8bb0\u4f4f\u6211\u8868\u5355\u5b57\u6bb5\uff0c\u9ed8\u8ba4\u5c31\u662f\u8fd9\u4e2a\uff0c\u53ef\u4ee5\u4e0d\u914d\u7f6e\n                    conf.rememberMeCookieName(\"xxxx\");  //\u8bb0\u4f4f\u6211\u8bbe\u7f6e\u7684Cookie\u540d\u5b57\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff0c\u4e0d\u8fc7\u6ca1\u5fc5\u8981\n                })\n                .build();\n    }\n}\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u9700\u8981\u4fee\u6539\u4e00\u4e0b\u524d\u7aef\u9875\u9762\u4e2d\u7684\u8868\u5355\uff0c\u5c06\u8bb0\u4f4f\u6211\u52fe\u9009\u6846\u4e5f\u4f5c\u4e3a\u8868\u5355\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u63d0\u4ea4\uff1a</p> <pre><code>&lt;div class=\"ad-checkbox\"&gt;\n    &lt;label&gt;\n        &lt;input type=\"checkbox\" name=\"remember-me\" class=\"ad-checkbox\"&gt;\n        &lt;span&gt;Remember Me&lt;/span&gt;\n    &lt;/label&gt;\n&lt;/div&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u5c1d\u8bd5\u52fe\u9009\u8bb0\u4f4f\u6211\u9009\u9879\u8fdb\u884c\u767b\u5f55\uff1a</p> <p></p> <p>\u6b64\u65f6\u63d0\u4ea4\u7684\u8868\u5355\u4e2d\u5c31\u5df2\u7ecf\u5305\u542b\u8bb0\u4f4f\u6211\u5b57\u6bb5\u4e86\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u670d\u52a1\u7aef\u8fd4\u56de\u7ed9\u6211\u4eec\u4e86\u4e00\u4e2a\u8bb0\u4f4f\u6211\u4e13\u5c5e\u7684Cookie\u4fe1\u606f\uff1a</p> <p></p> <p>\u8fd9\u4e2aCookie\u4fe1\u606f\u7684\u8fc7\u671f\u65f6\u95f4\u5e76\u4e0d\u662f\u4ec5\u4f1a\u8bdd\uff0c\u800c\u662f\u9ed8\u8ba4\u4fdd\u5b58\u4e00\u6bb5\u65f6\u95f4\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u5173\u95ed\u6d4f\u89c8\u5668\u540e\u4e0b\u6b21\u518d\u6b21\u8bbf\u95ee\u7f51\u7ad9\u65f6\uff0c\u5c31\u4e0d\u9700\u8981\u6211\u4eec\u518d\u6b21\u8fdb\u884c\u767b\u5f55\u64cd\u4f5c\u4e86\uff0c\u800c\u662f\u76f4\u63a5\u7ee7\u7eed\u4e0a\u4e00\u6b21\u7684\u767b\u5f55\u72b6\u6001\u3002</p> <p>\u5f53\u7136\uff0c\u7531\u4e8e\u8bb0\u4f4f\u6211\u4fe1\u606f\u662f\u5b58\u653e\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u670d\u52a1\u5668\u4e00\u76f4\u5904\u4e8e\u8fd0\u884c\u72b6\u6001\uff0c\u5982\u679c\u5173\u95ed\u670d\u52a1\u5668\u7684\u8bdd\uff0c\u8bb0\u4f4f\u6211\u4fe1\u606f\u4f1a\u5168\u90e8\u4e22\u5931\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u8bb0\u4f4f\u6211\u80fd\u591f\u4e00\u76f4\u6301\u4e45\u5316\u4fdd\u5b58\uff0c\u6211\u4eec\u5c31\u9700\u8981\u8fdb\u4e00\u6b65\u8fdb\u884c\u914d\u7f6e\u3002\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u57fa\u4e8eJDBC\u7684TokenRepository\u5b9e\u73b0\uff1a</p> <pre><code>@Bean\npublic PersistentTokenRepository tokenRepository(DataSource dataSource){\n    JdbcTokenRepositoryImpl repository = new JdbcTokenRepositoryImpl();\n    //\u5728\u542f\u52a8\u65f6\u81ea\u52a8\u5728\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u5b58\u50a8\u8bb0\u4f4f\u6211\u4fe1\u606f\u7684\u8868\uff0c\u4ec5\u7b2c\u4e00\u6b21\u9700\u8981\uff0c\u540e\u7eed\u4e0d\u9700\u8981\n    repository.setCreateTableOnStartup(true);\n    repository.setDataSource(dataSource);\n    return repository;\n}\n</code></pre> <p>\u7136\u540e\u6dfb\u52a0\u6b64\u4ed3\u5e93\uff1a</p> <pre><code>.rememberMe(conf -&gt; {\n     conf.rememberMeParameter(\"remember-me\");\n     conf.tokenRepository(repository);      //\u8bbe\u7f6e\u521a\u521a\u7684\u8bb0\u4f4f\u6211\u6301\u4e45\u5316\u5b58\u50a8\u5e93\n     conf.tokenValiditySeconds(3600 * 7);   //\u8bbe\u7f6e\u8bb0\u4f4f\u6211\u6709\u6548\u65f6\u95f4\u4e3a7\u5929\n})\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u6210\u529f\u914d\u7f6e\u4e86\u6570\u636e\u5e93\u6301\u4e45\u5316\u5b58\u50a8\u8bb0\u4f4f\u6211\u4fe1\u606f\uff0c\u5373\u4f7f\u6211\u4eec\u91cd\u542f\u670d\u52a1\u5668\u4e5f\u4e0d\u4f1a\u5bfc\u81f4\u6570\u636e\u4e22\u5931\u3002\u5f53\u6211\u4eec\u767b\u5f55\u4e4b\u540e\uff0c\u6570\u636e\u5e93\u4e2d\u4f1a\u81ea\u52a8\u8bb0\u5f55\u76f8\u5173\u7684\u4fe1\u606f\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u7f51\u7ad9\u7684\u767b\u5f55\u7cfb\u7edf\u5c31\u66f4\u52a0\u5b8c\u5584\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_11","title":"\u6388\u6743","text":"<p>\u7528\u6237\u767b\u5f55\u540e\uff0c\u53ef\u80fd\u4f1a\u6839\u636e\u7528\u6237\u5f53\u524d\u662f\u8eab\u4efd\u8fdb\u884c\u89d2\u8272\u5212\u5206\uff0c\u6bd4\u5982\u6211\u4eec\u6700\u5e38\u7528\u7684QQ\uff0c\u4e00\u4e2aQQ\u7fa4\u91cc\u9762\uff0c\u6709\u7fa4\u4e3b\u3001\u7ba1\u7406\u5458\u548c\u666e\u901a\u7fa4\u6210\u5458\u4e09\u79cd\u89d2\u8272\uff0c\u5176\u4e2d\u7fa4\u4e3b\u5177\u6709\u6700\u9ad8\u6743\u9650\uff0c\u7fa4\u4e3b\u53ef\u4ee5\u7ba1\u7406\u6574\u4e2a\u7fa4\u7684\u4efb\u4f55\u677f\u5757\uff0c\u5e76\u4e14\u5177\u6709\u89e3\u6563\u548c\u5347\u7ea7\u7fa4\u7684\u8d44\u683c\uff0c\u800c\u7ba1\u7406\u5458\u53ea\u6709\u7fa4\u4e3b\u7684\u4e00\u90e8\u5206\u6743\u9650\uff0c\u53ea\u80fd\u7528\u4e8e\u65e5\u5e38\u7ba1\u7406\uff0c\u666e\u901a\u7fa4\u6210\u5458\u5219\u53ea\u80fd\u8fdb\u884c\u6700\u57fa\u672c\u7684\u804a\u5929\u64cd\u4f5c\u3002</p> <p></p> <p>\u5bf9\u4e8e\u6211\u4eec\u6765\u8bf4\uff0c\u7528\u6237\u7684\u4e00\u4e2a\u64cd\u4f5c\u5b9e\u9645\u4e0a\u5c31\u662f\u5728\u8bbf\u95ee\u6211\u4eec\u63d0\u4f9b\u7684<code>\u63a5\u53e3</code>(\u7f16\u5199\u7684\u5bf9\u5e94\u8bbf\u95ee\u8def\u5f84\u7684Servlet\uff09\uff0c\u6bd4\u5982\u767b\u9646\uff0c\u5c31\u9700\u8981\u8c03\u7528<code>/login</code>\u63a5\u53e3\uff0c\u9000\u51fa\u767b\u9646\u5c31\u8981\u8c03\u7528/<code>logout</code>\u63a5\u53e3\uff0c\u800c\u6211\u4eec\u4e4b\u524d\u7684\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u4e2d\uff0c\u65b0\u589e\u56fe\u4e66\u3001\u5220\u9664\u56fe\u4e66\uff0c\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u6709\u7740\u5bf9\u5e94\u7684Servlet\u6765\u8fdb\u884c\u5904\u7406\u3002\u56e0\u6b64\uff0c\u4ece\u6211\u4eec\u5f00\u53d1\u8005\u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u51b3\u5b9a\u7528\u6237\u80fd\u5426\u4f7f\u7528\u67d0\u4e2a\u529f\u80fd\uff0c\u53ea\u9700\u8981\u51b3\u5b9a\u7528\u6237\u662f\u5426\u80fd\u591f\u8bbf\u95ee\u5bf9\u5e94\u7684Servlet\u5373\u53ef\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5927\u81f4\u50cf\u4e0b\u9762\u8fd9\u6837\u8fdb\u884c\u5212\u5206\uff1a</p> <ul> <li>\u7fa4\u4e3b\uff1a<code>/login</code>\u3001<code>/logout</code>\u3001<code>/chat</code>\u3001<code>/edit</code>\u3001<code>/delete</code>\u3001<code>/upgrade</code></li> <li>\u7ba1\u7406\u5458\uff1a<code>/login</code>\u3001<code>/logout</code>\u3001<code>/chat</code>\u3001<code>/edit</code></li> <li>\u666e\u901a\u7fa4\u6210\u5458\uff1a<code>/login</code>\u3001<code>/logout</code>\u3001<code>/chat</code></li> </ul> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u505a\u7684\u5c31\u662f\u6307\u5b9a\u54ea\u4e9b\u8bf7\u6c42\u53ef\u4ee5\u7531\u54ea\u4e9b\u7528\u6237\u53d1\u8d77\u3002</p> <p>SpringSecurity\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e24\u79cd\u6388\u6743\u65b9\u5f0f\uff1a</p> <ul> <li>\u57fa\u4e8e\u6743\u9650\u7684\u6388\u6743\uff1a\u53ea\u8981\u62e5\u6709\u67d0\u6743\u9650\u7684\u7528\u6237\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee\u67d0\u4e2a\u8def\u5f84\u3002</li> <li>\u57fa\u4e8e\u89d2\u8272\u7684\u6388\u6743\uff1a\u6839\u636e\u7528\u6237\u5c5e\u4e8e\u54ea\u4e2a\u89d2\u8272\u6765\u51b3\u5b9a\u662f\u5426\u53ef\u4ee5\u8bbf\u95ee\u67d0\u4e2a\u8def\u5f84\u3002</li> </ul> <p>\u4e24\u8005\u53ea\u662f\u6982\u5ff5\u4e0a\u7684\u4e0d\u540c\uff0c\u5b9e\u9645\u4e0a\u4f7f\u7528\u8d77\u6765\u6548\u679c\u5dee\u4e0d\u591a\u3002\u8fd9\u91cc\u6211\u4eec\u5c31\u5148\u6f14\u793a\u4ee5\u89d2\u8272\u65b9\u5f0f\u6765\u8fdb\u884c\u6388\u6743\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_12","title":"\u57fa\u4e8e\u89d2\u8272\u6388\u6743","text":"<p>\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u521b\u5efa\u4e24\u4e2a\u89d2\u8272\uff0c\u666e\u901a\u7528\u6237\u548c\u7ba1\u7406\u5458\uff0c\u666e\u901a\u7528\u6237\u53ea\u80fd\u8bbf\u95eeindex\u9875\u9762\uff0c\u800c\u7ba1\u7406\u5458\u53ef\u4ee5\u8bbf\u95ee\u4efb\u4f55\u9875\u9762\u3002</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u89d2\u8272\u8868\u8fdb\u884c\u4e00\u4e9b\u4fee\u6539\uff0c\u6dfb\u52a0\u4e00\u4e2a\u7528\u6237\u89d2\u8272\u5b57\u6bb5\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7528\u6237\uff0cTest\u7528\u6237\u7684\u89d2\u8272\u4e3auser\uff0c\u800cAdmin\u7528\u6237\u7684\u89d2\u8272\u4e3aadmin\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u914d\u7f6eSpringSecurity\uff0c\u51b3\u5b9a\u54ea\u4e9b\u89d2\u8272\u53ef\u4ee5\u8bbf\u95ee\u54ea\u4e9b\u9875\u9762\uff1a</p> <pre><code>.authorizeHttpRequests(auth -&gt; {\n    //\u9759\u6001\u8d44\u6e90\u4f9d\u7136\u5168\u90e8\u53ef\u4ee5\u8bbf\u95ee\n    auth.requestMatchers(\"/static/**\").permitAll();\n    //\u53ea\u6709\u5177\u6709\u4ee5\u4e0b\u89d2\u8272\u7684\u7528\u6237\u624d\u80fd\u8bbf\u95ee\u8def\u5f84\"/\"\n    auth.requestMatchers(\"/\").hasAnyRole(\"user\", \"admin\");\n    //\u5176\u4ed6\u6240\u6709\u8def\u5f84\u5fc5\u987b\u89d2\u8272\u4e3aadmin\u624d\u80fd\u8bbf\u95ee\n    auth.anyRequest().hasRole(\"admin\");\n})\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u9a8c\u8bc1\u903b\u8f91\uff0c\u6211\u4eec\u5728\u6570\u636e\u5e93\u4e2d\u7684\u7528\u6237\u8868\u4e0a\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u5b57\u6bb5\uff0c\u7528\u4e8e\u8868\u793a\u89d2\u8272\uff1a</p> <p></p> <p>\u4fee\u6539\u4e00\u4e0b\u5bf9\u5e94\u7684\u5b9e\u4f53\u7c7b\uff1a</p> <pre><code>@Data\npublic class Account {\n    int id;\n    String username;\n    String password;\n    String role;\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5728\u67e5\u8be2\u7528\u6237\u65f6\uff0c\u9700\u8981\u6dfb\u52a0\u5176\u5bf9\u5e94\u7684\u89d2\u8272\uff1a</p> <pre><code> @Override\npublic UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {\n    Account account = mapper.findUserByName(username);\n    if(account == null)\n        throw new UsernameNotFoundException(\"\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\");\n    return User\n            .withUsername(username)\n            .password(account.getPassword())\n            .roles(account.getRole())   //\u6dfb\u52a0\u89d2\u8272\uff0c\u4e00\u4e2a\u7528\u6237\u53ef\u4ee5\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u89d2\u8272\n            .build();\n}\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u4e86\uff0c\u6211\u4eec\u91cd\u542f\u670d\u52a1\u5668\u767b\u5f55\u770b\u770b\uff1a</p> <p></p> <p>\u76ee\u524d\u4f9d\u7136\u662f\u53ef\u4ee5\u6b63\u5e38\u767b\u5f55\u7684\uff0c\u4f46\u662f\u6211\u4eec\u968f\u4fbf\u8bbf\u95ee\u4e00\u4e2a\u5176\u4ed6\u7684\u9875\u9762\uff0c\u5c31\u4f1a\u88ab\u62e6\u622a\u5e76\u81ea\u52a8\u9000\u56de\u5230\u767b\u5f55\u754c\u9762\uff1a</p> <p></p> <p>\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u524d\u9762\u914d\u7f6e\u7684\u662fuser\u89d2\u8272\uff0c\u90a3\u4e48\u8fd9\u4e2a\u89d2\u8272\u53ea\u80fd\u8bbf\u95ee\u9996\u9875\uff0c\u5176\u4ed6\u7684\u90fd\u4e0d\u884c\uff0c\u6240\u4ee5\u5c31\u4f1a\u88ab\u81ea\u52a8\u62e6\u622a\u6389\u4e86\u3002\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5230\u6570\u636e\u5e93\u4e2d\u5bf9\u8fd9\u4e2a\u7528\u6237\u7684\u89d2\u8272\u8fdb\u884c\u4fee\u6539\uff0c\u770b\u770b\u4fee\u6539\u540e\u662f\u5426\u80fd\u591f\u8bbf\u95ee\u5230\u5176\u4ed6\u9875\u9762\uff1a</p> <p></p> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5176\u4ed6\u9875\u9762\u4e0d\u4f1a\u88ab\u62e6\u622a\u4e86\uff0c\u4e0d\u8fc7\u56e0\u4e3a\u6211\u4eec\u6ca1\u914d\u7f6e\u8fd9\u4e2a\u8def\u5f84\uff0c\u6240\u4ee5\u51fa\u6765\u7684\u662f404\u9875\u9762\u3002</p> <p>\u901a\u8fc7\u4f7f\u7528\u89d2\u8272\u63a7\u5236\u9875\u9762\u7684\u8bbf\u95ee\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba9\u67d0\u4e9b\u7528\u6237\u53ea\u80fd\u8bbf\u95ee\u90e8\u5206\u9875\u9762\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_13","title":"\u57fa\u4e8e\u6743\u9650\u6388\u6743","text":"<p>\u57fa\u4e8e\u6743\u9650\u7684\u6388\u6743\u4e0e\u89d2\u8272\u7c7b\u4f3c\uff0c\u9700\u8981\u4ee5<code>hasAnyAuthority</code>\u6216<code>hasAuthority</code>\u8fdb\u884c\u5224\u65ad\uff1a</p> <pre><code>.authorizeHttpRequests(auth -&gt; {\n    //\u9759\u6001\u8d44\u6e90\u4f9d\u7136\u5168\u90e8\u53ef\u4ee5\u8bbf\u95ee\n    auth.requestMatchers(\"/static/**\").permitAll();\n    //\u57fa\u4e8e\u6743\u9650\u548c\u57fa\u4e8e\u89d2\u8272\u5176\u5b9e\u5dee\u522b\u5e76\u4e0d\u5927\uff0c\u4f7f\u7528\u65b9\u5f0f\u662f\u76f8\u540c\u7684\n    auth.anyRequest().hasAnyAuthority(\"page:index\");\n})\n</code></pre> <p>\u5b9e\u9645\u4e0a\u6743\u9650\u8ddf\u89d2\u8272\u76f8\u6bd4\u53ea\u662f\u7c92\u5ea6\u66f4\u7ec6\uff0c\u7531\u4e8e\u4f7f\u7528\u65b9\u5f0f\u5dee\u4e0d\u591a\uff0c\u8fd9\u91cc\u4e0d\u591a\u505a\u9610\u8ff0\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_14","title":"\u4f7f\u7528\u6ce8\u89e3\u6743\u9650\u5224\u65ad","text":"<p>\u9664\u4e86\u76f4\u63a5\u914d\u7f6e\u4ee5\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u4ee5\u6ce8\u89e3\u5f62\u5f0f\u76f4\u63a5\u914d\u7f6e\uff0c\u9996\u5148\u9700\u8981\u5728\u914d\u7f6e\u7c7b\uff08\u6ce8\u610f\u8fd9\u91cc\u662f\u5728Mvc\u7684\u914d\u7f6e\u7c7b\u4e0a\u6dfb\u52a0\uff0c\u56e0\u4e3a\u8fd9\u91cc\u53ea\u9488\u5bf9Controller\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6240\u6709\u7684Controller\u662f\u7531Mvc\u914d\u7f6e\u7c7b\u8fdb\u884c\u6ce8\u518c\u7684\uff0c\u5982\u679c\u9700\u8981\u4e3aService\u6216\u5176\u4ed6Bean\u4e5f\u542f\u7528\u6743\u9650\u5224\u65ad\uff0c\u5219\u9700\u8981\u5728Security\u7684\u914d\u7f6e\u7c7b\u4e0a\u6dfb\u52a0\uff09\u4e0a\u5f00\u542f\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\n@EnableMethodSecurity   //\u5f00\u542f\u65b9\u6cd5\u5b89\u5168\u6821\u9a8c\npublic class SecurityConfiguration {\n    ...\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u6211\u4eec\u60f3\u8981\u8fdb\u884c\u6743\u9650\u6821\u9a8c\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u6ce8\u89e3\u4e86\uff1a</p> <pre><code>@Controller\npublic class HelloController {\n    @PreAuthorize(\"hasRole('user')\")  //\u76f4\u63a5\u4f7f\u7528hasRole\u65b9\u6cd5\u5224\u65ad\u662f\u5426\u5305\u542b\u67d0\u4e2a\u89d2\u8272\n    @GetMapping(\"/\")\n    public String index(){\n        return \"index\";\n    }\n\n    ...\n}\n</code></pre> <p>\u901a\u8fc7\u6dfb\u52a0<code>@PreAuthorize</code>\u6ce8\u89e3\uff0c\u5728\u6267\u884c\u4e4b\u524d\u5224\u65ad\u5224\u65ad\u6743\u9650\uff0c\u5982\u679c\u6ca1\u6709\u5bf9\u5e94\u7684\u6743\u9650\u6216\u662f\u5bf9\u5e94\u7684\u89d2\u8272\uff0c\u5c06\u65e0\u6cd5\u8bbf\u95ee\u9875\u9762\u3002</p> <p>\u8fd9\u91cc\u5176\u5b9e\u662f\u4f7f\u7528\u7684\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u8bb2\u89e3\u7684SpEL\u8868\u8fbe\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u8fd9\u91cc\u4f7f\u7528\u6743\u9650\u5224\u65ad\u76f8\u5173\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u6709\u5fd8\u8bb0SpEL\u5982\u4f55\u4f7f\u7528\u7684\u53ef\u4ee5\u56de\u987e\u6211\u4eec\u7684Spring6\u6838\u5fc3\u7bc7\u3002\u6240\u6709\u53ef\u4ee5\u8fdb\u884c\u6743\u9650\u5224\u65ad\u7684\u65b9\u6cd5\u5728<code>SecurityExpressionRoot</code>\u7c7b\u4e2d\u6709\u5b9a\u4e49\uff0c\u5404\u4f4d\u5c0f\u4f19\u4f34\u53ef\u4ee5\u81ea\u884c\u524d\u5f80\u67e5\u770b\u3002</p> <p>\u540c\u6837\u7684\u8fd8\u6709<code>@PostAuthorize</code>\u6ce8\u89e3\uff0c\u4f46\u662f\u5b83\u662f\u5728\u65b9\u6cd5\u6267\u884c\u4e4b\u540e\u518d\u8fdb\u884c\u62e6\u622a\uff1a</p> <pre><code>@PostAuthorize(\"hasRole('user')\")\n@RequestMapping(\"/\")\npublic String index(){\n    System.out.println(\"\u6267\u884c\u4e86\");\n    return \"index\";\n}\n</code></pre> <p>\u9664\u4e86Controller\u4ee5\u5916\uff0c\u53ea\u8981\u662f\u7531Spring\u7ba1\u7406\u7684Bean\u90fd\u53ef\u4ee5\u4f7f\u7528\u6ce8\u89e3\u5f62\u5f0f\u6765\u63a7\u5236\u6743\u9650\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u4efb\u610f\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u8fd9\u4e2a\u6ce8\u89e3\uff0c\u53ea\u8981\u4e0d\u5177\u5907\u8868\u8fbe\u5f0f\u4e2d\u6307\u5b9a\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u90a3\u4e48\u5c31\u65e0\u6cd5\u6267\u884c\u65b9\u6cd5\u5e76\u4e14\u4f1a\u8fd4\u56de403\u9875\u9762\u3002</p> <pre><code>@Service\npublic class UserService {\n\n    @PreAuthorize(\"hasAnyRole('user')\")\n    public void test(){\n        System.out.println(\"\u6210\u529f\u6267\u884c\");\n    }\n}\n</code></pre> <p>\u4e0e\u5177\u6709\u76f8\u540c\u529f\u80fd\u7684\u8fd8\u6709<code>@Secured</code>\u4f46\u662f\u5b83\u4e0d\u652f\u6301SpEL\u8868\u8fbe\u5f0f\u7684\u6743\u9650\u8868\u793a\u5f62\u5f0f\uff0c\u5e76\u4e14\u9700\u8981\u6dfb\u52a0\"ROLE_\"\u524d\u7f00\uff0c\u8fd9\u91cc\u5c31\u4e0d\u505a\u6f14\u793a\u4e86\u3002</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528<code>@PreFilter</code>\u548c<code>@PostFilter</code>\u5bf9\u96c6\u5408\u7c7b\u578b\u7684\u53c2\u6570\u6216\u8fd4\u56de\u503c\u8fdb\u884c\u8fc7\u6ee4\u3002</p> <p>\u6bd4\u5982\uff1a</p> <pre><code>@PreFilter(\"filterObject.equals('lbwnb')\")   //filterObject\u4ee3\u8868\u96c6\u5408\u4e2d\u6bcf\u4e2a\u5143\u7d20\uff0c\u53ea\u8981\u6ee1\u8db3\u6761\u4ef6\u7684\u5143\u7d20\u624d\u4f1a\u7559\u4e0b\npublic void test(List&lt;String&gt; list){\n    System.out.println(\"\u6210\u529f\u6267\u884c\"+list);\n}\n</code></pre> <pre><code>@RequestMapping(\"/\")\npublic String index(){\n    List&lt;String&gt; list = new LinkedList&lt;&gt;();\n    list.add(\"lbwnb\");\n    list.add(\"yyds\");\n    service.test(list);\n    return \"index\";\n}\n</code></pre> <p>\u4e0e<code>@PreFilter</code>\u7c7b\u4f3c\u7684<code>@PostFilter</code>\u8fd9\u91cc\u5c31\u4e0d\u505a\u6f14\u793a\u4e86\uff0c\u5b83\u7528\u4e8e\u5904\u7406\u8fd4\u56de\u503c\uff0c\u4f7f\u7528\u65b9\u6cd5\u662f\u4e00\u6837\u7684\u3002</p> <p>\u5f53\u6709\u591a\u4e2a\u96c6\u5408\u65f6\uff0c\u9700\u8981\u4f7f\u7528<code>filterTarget</code>\u8fdb\u884c\u6307\u5b9a\uff1a</p> <pre><code>@PreFilter(value = \"filterObject.equals('lbwnb')\", filterTarget = \"list2\")\npublic void test(List&lt;String&gt; list, List&lt;String&gt; list2){\n    System.out.println(\"\u6210\u529f\u6267\u884c\"+list);\n}\n</code></pre> <p>\u81f3\u6b64\uff0c\u6709\u5173Security\u7684\u57fa\u672c\u529f\u80fd\uff0c\u6211\u4eec\u5c31\u5168\u90e8\u4ecb\u7ecd\u5b8c\u6bd5\u4e86\uff0c\u5728\u540e\u9762\u7684SpringBoot\u9636\u6bb5\uff0c\u6211\u4eec\u8fd8\u4f1a\u7ee7\u7eed\u6df1\u5165\u4f7f\u7528\u6b64\u6846\u67b6\uff0c\u5b9e\u73b0\u66f4\u591a\u9ad8\u7ea7\u7684\u529f\u80fd\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_15","title":"\u5185\u90e8\u673a\u5236\u63a2\u7a76","text":"<p>\u6ce8\u610f\uff1a\u672c\u5c0f\u8282\u5185\u5bb9\u4f5c\u4e3a\u9009\u5b66\u5185\u5bb9\uff0c\u4f46\u662f\u96be\u5ea6\u6bd4\u524d\u4e24\u7ae0\u7684\u6e90\u7801\u90e8\u5206\u7b80\u5355\u5f97\u591a\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_16","title":"\u6388\u6743\u6821\u9a8c\u6d41\u7a0b","text":"<p>\u6700\u540e\u6211\u4eec\u518d\u6765\u804a\u4e00\u4e0bSpringSecurity\u7684\u5b9e\u73b0\u539f\u7406\uff0c\u5b83\u672c\u8d28\u4e0a\u662f\u4f9d\u9760N\u4e2aFilter\u5b9e\u73b0\u7684\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u5b8c\u6574\u7684\u8fc7\u6ee4\u94fe\uff08\u6ce8\u610f\u8fd9\u91cc\u662f\u8fc7\u6ee4\u5668\uff0c\u4e0d\u662f\u62e6\u622a\u5668\uff09</p> <p>\u6211\u4eec\u5c31\u4ece<code>AbstractSecurityWebApplicationInitializer</code>\u5f00\u59cb\u4e0b\u624b\uff0c\u6211\u4eec\u6765\u770b\u770b\u5b83\u914d\u7f6e\u4e86\u4ec0\u4e48\uff1a</p> <pre><code>//\u6b64\u65b9\u6cd5\u4f1a\u5728\u542f\u52a8\u65f6\u88ab\u8c03\u7528\npublic final void onStartup(ServletContext servletContext) {\n    this.beforeSpringSecurityFilterChain(servletContext);\n    if (this.configurationClasses != null) {\n        AnnotationConfigWebApplicationContext rootAppContext = new AnnotationConfigWebApplicationContext();\n        rootAppContext.register(this.configurationClasses);\n        servletContext.addListener(new ContextLoaderListener(rootAppContext));\n    }\n\n    if (this.enableHttpSessionEventPublisher()) {\n        servletContext.addListener(\"org.springframework.security.web.session.HttpSessionEventPublisher\");\n    }\n\n    servletContext.setSessionTrackingModes(this.getSessionTrackingModes());\n    //\u91cd\u70b9\u5728\u8fd9\u91cc\uff0c\u8fd9\u91cc\u63d2\u5165\u4e86\u5173\u952e\u7684FilterChain\n    this.insertSpringSecurityFilterChain(servletContext);\n    this.afterSpringSecurityFilterChain(servletContext);\n}\n</code></pre> <pre><code>private void insertSpringSecurityFilterChain(ServletContext servletContext) {\n    String filterName = \"springSecurityFilterChain\";\n    //\u521b\u5efa\u4e86\u4e00\u4e2aDelegatingFilterProxy\u5bf9\u8c61\uff0c\u5b83\u672c\u8d28\u4e0a\u4e5f\u662f\u4e00\u4e2aFilter\uff0c\u4f46\u662f\u662f\u591a\u4e2aFilter\u7684\u96c6\u5408\n    DelegatingFilterProxy springSecurityFilterChain = new DelegatingFilterProxy(filterName);\n    String contextAttribute = this.getWebApplicationContextAttribute();\n    if (contextAttribute != null) {\n        springSecurityFilterChain.setContextAttribute(contextAttribute);\n    }\n        //\u901a\u8fc7ServletContext\u6ce8\u518cDelegatingFilterProxy\u8fd9\u4e2aFilter\n    this.registerFilter(servletContext, true, filterName, springSecurityFilterChain);\n}\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u770b\uff0c<code>DelegatingFilterProxy</code>\u5728\u505a\u4ec0\u4e48\uff1a</p> <pre><code>//\u8fd9\u4e2a\u662f\u521d\u59cb\u5316\u65b9\u6cd5\uff0c\u5b83\u7531GenericFilterBean\uff08\u7236\u7c7b\uff09\u5b9a\u4e49\uff0c\u5728afterPropertiesSet\u65b9\u6cd5\u4e2d\u88ab\u8c03\u7528\nprotected void initFilterBean() throws ServletException {\n    synchronized(this.delegateMonitor) {\n        if (this.delegate == null) {\n            if (this.targetBeanName == null) {\n                this.targetBeanName = this.getFilterName();\n            }\n\n            WebApplicationContext wac = this.findWebApplicationContext();\n            if (wac != null) {\n                //\u8010\u5fc3\u70b9\uff0c\u5957\u5a03\u5f88\u6b63\u5e38\n                this.delegate = this.initDelegate(wac);\n            }\n        }\n\n    }\n}\n</code></pre> <pre><code>protected Filter initDelegate(WebApplicationContext wac) throws ServletException {\n    String targetBeanName = this.getTargetBeanName();\n    Assert.state(targetBeanName != null, \"No target bean name set\");\n    //\u8fd9\u91cc\u901a\u8fc7WebApplicationContext\u83b7\u53d6\u4e86\u4e00\u4e2aBean\n    Filter delegate = (Filter)wac.getBean(targetBeanName, Filter.class);\n    if (this.isTargetFilterLifecycle()) {\n        delegate.init(this.getFilterConfig());\n    }\n\n    //\u8fd4\u56deFilter\n    return delegate;\n}\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u65ad\u70b9\u6765\u67e5\u770b\u5230\u5e95\u83b7\u53d6\u5230\u4e86\u4ec0\u4e48Bean\u3002</p> <p>\u901a\u8fc7\u65ad\u70b9\u8c03\u8bd5\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u91cc\u653e\u56de\u7684\u5bf9\u8c61\u662f\u4e00\u4e2aFilterChainProxy\u7c7b\u578b\u7684\uff0c\u5e76\u4e14\u8c03\u7528\u4e86\u5b83\u7684\u521d\u59cb\u5316\u65b9\u6cd5\u3002</p> <p>\u6211\u4eec\u5012\u56de\u53bb\u770b\uff0c\u5f53Filter\u8fd4\u56de\u4e4b\u540e\uff0c<code>DelegatingFilterProxy</code>\u7684\u4e00\u4e2a\u6210\u5458\u53d8\u91cf<code>delegate</code>\u88ab\u8d4b\u503c\u4e3a\u5f97\u5230\u7684Filter\uff0c\u4e5f\u5c31\u662fFilterChainProxy\u5bf9\u8c61\uff0c\u63a5\u7740\u6211\u4eec\u6765\u770b\u770b\uff0c<code>DelegatingFilterProxy</code>\u662f\u5982\u4f55\u6267\u884cdoFilter\u65b9\u6cd5\u7684\u3002</p> <pre><code>public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n    Filter delegateToUse = this.delegate;\n    if (delegateToUse == null) {\n        //\u975e\u6b63\u5e38\u60c5\u51b5\uff0c\u8fd9\u91cc\u7701\u7565...\n    }\n        //\u8fd9\u91cc\u624d\u662f\u771f\u6b63\u7684\u8c03\u7528\uff0c\u522b\u5fd8\u4e86delegateToUse\u5c31\u662f\u521d\u59cb\u5316\u7684FilterChainProxy\u5bf9\u8c61\n    this.invokeDelegate(delegateToUse, request, response, filterChain);\n}\n</code></pre> <pre><code>protected void invokeDelegate(Filter delegate, ServletRequest request, ServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n  //\u6700\u540e\u5b9e\u9645\u4e0a\u8c03\u7528\u7684\u662fFilterChainProxy\u7684doFilter\u65b9\u6cd5\n    delegate.doFilter(request, response, filterChain);\n}\n</code></pre> <p>\u6240\u4ee5\u6211\u4eec\u63a5\u7740\u6765\u770b\uff0c<code>FilterChainProxy</code>\u7684doFilter\u65b9\u6cd5\u53c8\u5728\u5e72\u4ec0\u4e48\uff1a</p> <pre><code>public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\n    boolean clearContext = request.getAttribute(FILTER_APPLIED) == null;\n    if (!clearContext) {\n        //\u771f\u6b63\u7684\u8fc7\u6ee4\u5728\u8fd9\u91cc\u6267\u884c\n        this.doFilterInternal(request, response, chain);\n    } else {\n        //...\n    }\n}\n</code></pre> <p></p> <pre><code>private void doFilterInternal(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\n    FirewalledRequest firewallRequest = this.firewall.getFirewalledRequest((HttpServletRequest)request);\n    HttpServletResponse firewallResponse = this.firewall.getFirewalledResponse((HttpServletResponse)response);\n    //\u8fd9\u91cc\u83b7\u53d6\u4e86\u4e00\u4e2aFilter\u5217\u8868\uff0c\u5b9e\u9645\u4e0aSpringSecurity\u5c31\u662f\u7531N\u4e2a\u8fc7\u6ee4\u5668\u5b9e\u73b0\u7684\uff0c\u8fd9\u91cc\u83b7\u53d6\u7684\u90fd\u662fSpringSecurity\u63d0\u4f9b\u7684\u8fc7\u6ee4\u5668\n    //\u4f46\u662f\u8bf7\u6ce8\u610f\uff0c\u7ecf\u8fc7\u6211\u4eec\u4e4b\u524d\u7684\u5206\u6790\uff0c\u5b9e\u9645\u4e0a\u771f\u6b63\u6ce8\u518c\u7684Filter\u53ea\u6709DelegatingFilterProxy\n    //\u800c\u8fd9\u91cc\u7684Filter\u5217\u8868\u4e2d\u7684\u6240\u6709Filter\u5e76\u6ca1\u6709\u88ab\u6ce8\u518c\uff0c\u800c\u662f\u5728\u8fd9\u91cc\u8fdb\u884c\u5185\u90e8\u8c03\u7528\n    List&lt;Filter&gt; filters = this.getFilters((HttpServletRequest)firewallRequest);\n    //\u53ea\u8981Filter\u5217\u8868\u4e0d\u662f\u7a7a\uff0c\u5c31\u4f9d\u6b21\u6267\u884c\u5185\u7f6e\u7684Filter\n    if (filters != null &amp;&amp; filters.size() != 0) {\n        if (logger.isDebugEnabled()) {\n            logger.debug(LogMessage.of(() -&gt; {\n                return \"Securing \" + requestLine(firewallRequest);\n            }));\n        }\n                //\u8fd9\u91cc\u521b\u5efa\u4e00\u4e2a\u865a\u62df\u7684\u8fc7\u6ee4\u94fe\uff0c\u8fc7\u6ee4\u6d41\u7a0b\u662f\u7531SpringSecurity\u81ea\u5df1\u5b9e\u73b0\u7684\n        FilterChainProxy.VirtualFilterChain virtualFilterChain = new FilterChainProxy.VirtualFilterChain(firewallRequest, chain, filters);\n        //\u8c03\u7528\u865a\u62df\u8fc7\u6ee4\u94fe\u7684doFilter\n        virtualFilterChain.doFilter(firewallRequest, firewallResponse);\n    } else {\n        if (logger.isTraceEnabled()) {\n            logger.trace(LogMessage.of(() -&gt; {\n                return \"No security for \" + requestLine(firewallRequest);\n            }));\n        }\n\n        firewallRequest.reset();\n        chain.doFilter(firewallRequest, firewallResponse);\n    }\n}\n</code></pre> <p>\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u865a\u62df\u8fc7\u6ee4\u94fe\u7684doFilter\u662f\u600e\u4e48\u5904\u7406\u7684\uff1a</p> <pre><code>//\u770b\u4f3c\u6ca1\u6709\u4efb\u4f55\u5faa\u73af\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u5faa\u73af\uff0c\u662f\u4e00\u4e2a\u9012\u5f52\u8c03\u7528\npublic void doFilter(ServletRequest request, ServletResponse response) throws IOException, ServletException {\n    //\u5224\u65ad\u662f\u5426\u5df2\u7ecf\u901a\u8fc7\u5168\u90e8\u7684\u5185\u7f6e\u8fc7\u6ee4\u5668\uff0c\u5b9a\u4f4d\u662f\u5426\u7b49\u4e8e\u5f53\u524d\u5927\u5c0f\n    if (this.currentPosition == this.size) {\n        if (FilterChainProxy.logger.isDebugEnabled()) {\n            FilterChainProxy.logger.debug(LogMessage.of(() -&gt; {\n                return \"Secured \" + FilterChainProxy.requestLine(this.firewalledRequest);\n            }));\n        }\n\n        this.firewalledRequest.reset();\n        //\u6240\u6709\u7684\u5185\u7f6e\u8fc7\u6ee4\u5668\u5df2\u7ecf\u5b8c\u6210\uff0c\u6309\u7167\u6b63\u5e38\u6d41\u7a0b\u8d70DelegatingFilterProxy\u7684\u4e0b\u4e00\u4e2aFilter\n        //\u4e5f\u5c31\u662f\u8bf4\u8fd9\u91cc\u4e4b\u540e\u5c31\u4e0eDelegatingFilterProxy\u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\u4e86\uff0c\u8be5\u8d70\u5176\u4ed6\u8fc7\u6ee4\u5668\u5c31\u8d70\u5176\u4ed6\u5730\u65b9\u914d\u7f6e\u7684\u8fc7\u6ee4\u5668\uff0cSpringSecurity\u7684\u8fc7\u6ee4\u64cd\u4f5c\u5df2\u7ecf\u7ed3\u675f\n        this.originalChain.doFilter(request, response);\n    } else {\n        //\u5b9a\u4f4d\u81ea\u589e\n        ++this.currentPosition;\n        //\u83b7\u53d6\u5f53\u524d\u5b9a\u4f4d\u7684Filter\n        Filter nextFilter = (Filter)this.additionalFilters.get(this.currentPosition - 1);\n        if (FilterChainProxy.logger.isTraceEnabled()) {\n            FilterChainProxy.logger.trace(LogMessage.format(\"Invoking %s (%d/%d)\", nextFilter.getClass().getSimpleName(), this.currentPosition, this.size));\n        }\n                //\u6267\u884c\u5185\u90e8\u8fc7\u6ee4\u5668\u7684doFilter\u65b9\u6cd5\uff0c\u4f20\u5165\u5f53\u524d\u5bf9\u8c61\u672c\u8eab\u4f5c\u4e3aFilter\uff0c\u6267\u884c\u5982\u679c\u6210\u529f\uff0c\u90a3\u4e48\u4e00\u5b9a\u4f1a\u518d\u6b21\u8c03\u7528\u5f53\u524d\u5bf9\u8c61\u7684doFilter\u65b9\u6cd5\n        //\u53ef\u80fd\u6700\u4e0d\u7406\u89e3\u7684\u5c31\u662f\u8fd9\u91cc\uff0c\u6267\u884c\u7684\u96be\u9053\u4e0d\u662f\u5185\u90e8\u5176\u4ed6Filter\u7684doFilter\u65b9\u6cd5\u5417\uff0c\u600e\u4e48\u4f1a\u8ba9\u5f53\u524d\u5bf9\u8c61\u7684doFilter\u65b9\u6cd5\u9012\u5f52\u8c03\u7528\u5462\uff1f\n        //\u6ca1\u5173\u7cfb\uff0c\u4e0b\u9762\u6211\u4eec\u63a5\u7740\u4e86\u89e3\u4e86\u5176\u4e2d\u4e00\u4e2a\u5185\u90e8\u8fc7\u6ee4\u5668\u5c31\u660e\u767d\u4e86\n        nextFilter.doFilter(request, response, this);\n    }\n}\n</code></pre> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u5dee\u4e0d\u591a\u5df2\u7ecf\u4e86\u89e3\u4e86\u6574\u4e2aSpringSecurity\u7684\u5b9e\u73b0\u673a\u5236\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u968f\u4fbf\u770b\u4e00\u4e2a\u5185\u90e8\u7684\u8fc7\u6ee4\u5668\u5728\u505a\u4ec0\u4e48\u3002</p> <p>\u6bd4\u5982\u7528\u4e8e\u5904\u7406\u767b\u9646\u7684\u8fc7\u6ee4\u5668<code>UsernamePasswordAuthenticationFilter</code>\uff0c\u5b83\u7ee7\u627f\u81ea<code>AbstractAuthenticationProcessingFilter</code>\uff0c\u6211\u4eec\u6765\u770b\u770b\u5b83\u662f\u600e\u4e48\u8fdb\u884c\u8fc7\u6ee4\u7684\uff1a</p> <pre><code>public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {\n    this.doFilter((HttpServletRequest)request, (HttpServletResponse)response, chain);\n}\n\nprivate void doFilter(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws IOException, ServletException {\n    //\u5982\u679c\u4e0d\u662f\u767b\u9646\u8bf7\u6c42\uff0c\u90a3\u4e48\u6839\u672c\u4e0d\u4f1a\u7406\u8fd9\u4e2a\u8bf7\u6c42\n    if (!this.requiresAuthentication(request, response)) {\n        //\u76f4\u63a5\u8c03\u7528\u4f20\u5165\u7684FilterChain\u7684doFilter\u65b9\u6cd5\n        //\u800c\u8fd9\u91cc\u4f20\u5165\u7684\u6b63\u597d\u662fVirtualFilterChain\u5bf9\u8c61\n        //\u8fd9\u4e0b\u77e5\u9053\u4e3a\u4ec0\u4e48\u4e0a\u9762\u8bf4\u662f\u9012\u5f52\u4e86\u5427\n        chain.doFilter(request, response);\n    } else {\n        //\u5982\u679c\u662f\u767b\u9646\u8bf7\u6c42\uff0c\u90a3\u4e48\u4f1a\u6267\u884c\u767b\u9646\u8bf7\u6c42\u7684\u76f8\u5173\u903b\u8f91\uff0c\u6ce8\u610f\u6267\u884c\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4efb\u4f55\u95ee\u9898\u90fd\u4f1a\u629b\u51fa\u5f02\u5e38\n        //\u6bd4\u5982\u7528\u6237\u540d\u548c\u5bc6\u7801\u9519\u8bef\uff0c\u6211\u4eec\u4e4b\u524d\u4e5f\u5df2\u7ecf\u6d4b\u8bd5\u8fc7\u4e86\uff0c\u4f1a\u5f97\u5230\u4e00\u4e2aBadCredentialsException\n        try {\n            //\u8fdb\u884c\u8ba4\u8bc1\n            Authentication authenticationResult = this.attemptAuthentication(request, response);\n            if (authenticationResult == null) {\n                return;\n            }\n\n            this.sessionStrategy.onAuthentication(authenticationResult, request, response);\n            if (this.continueChainBeforeSuccessfulAuthentication) {\n                chain.doFilter(request, response);\n            }\n\n            //\u5982\u679c\u4e00\u8def\u7eff\u706f\uff0c\u6ca1\u6709\u62a5\u9519\uff0c\u90a3\u4e48\u9a8c\u8bc1\u6210\u529f\uff0c\u6267\u884csuccessfulAuthentication\n            this.successfulAuthentication(request, response, chain, authenticationResult);\n        } catch (InternalAuthenticationServiceException var5) {\n            this.logger.error(\"An internal error occurred while trying to authenticate the user.\", var5);\n            //\u9a8c\u8bc1\u5931\u8d25\uff0c\u4f1a\u6267\u884cunsuccessfulAuthentication\n            this.unsuccessfulAuthentication(request, response, var5);\n        } catch (AuthenticationException var6) {\n            this.unsuccessfulAuthentication(request, response, var6);\n        }\n\n    }\n}\n</code></pre> <p>\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770bsuccessfulAuthentication\u548cunsuccessfulAuthentication\u5206\u522b\u505a\u4e86\u4ec0\u4e48\uff1a</p> <pre><code>protected void successfulAuthentication(HttpServletRequest request, HttpServletResponse response, FilterChain chain, Authentication authResult) throws IOException, ServletException {\n    //\u5411SecurityContextHolder\u6dfb\u52a0\u8ba4\u8bc1\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7SecurityContextHolder\u5bf9\u8c61\u83b7\u53d6\u5f53\u524d\u767b\u9646\u7684\u7528\u6237\n    SecurityContextHolder.getContext().setAuthentication(authResult);\n    if (this.logger.isDebugEnabled()) {\n        this.logger.debug(LogMessage.format(\"Set SecurityContextHolder to %s\", authResult));\n    }\n\n    //\u8bb0\u4f4f\u6211\u5b9e\u73b0\n    this.rememberMeServices.loginSuccess(request, response, authResult);\n    if (this.eventPublisher != null) {\n        this.eventPublisher.publishEvent(new InteractiveAuthenticationSuccessEvent(authResult, this.getClass()));\n    }\n\n    //\u8c03\u7528\u9ed8\u8ba4\u7684\u6216\u662f\u6211\u4eec\u81ea\u5df1\u5b9a\u4e49\u7684AuthenticationSuccessHandler\u7684onAuthenticationSuccess\u65b9\u6cd5\n    //\u8fd9\u4e2a\u6839\u636e\u6211\u4eec\u914d\u7f6e\u6587\u4ef6\u51b3\u5b9a\n    //\u5230\u8fd9\u91cc\u5176\u5b9e\u9875\u9762\u5c31\u5df2\u7ecf\u76f4\u63a5\u8df3\u8f6c\u4e86\n    this.successHandler.onAuthenticationSuccess(request, response, authResult);\n}\n\nprotected void unsuccessfulAuthentication(HttpServletRequest request, HttpServletResponse response, AuthenticationException failed) throws IOException, ServletException {\n    //\u767b\u9646\u5931\u8d25\u4f1a\u76f4\u63a5\u6e05\u7406\u6389SecurityContextHolder\u4e2d\u7684\u8ba4\u8bc1\u4fe1\u606f\n    SecurityContextHolder.clearContext();\n    this.logger.trace(\"Failed to process authentication request\", failed);\n    this.logger.trace(\"Cleared SecurityContextHolder\");\n    this.logger.trace(\"Handling authentication failure\");\n    //\u767b\u9646\u5931\u8d25\u7684\u8bb0\u4f4f\u6211\u5904\u7406\n    this.rememberMeServices.loginFail(request, response);\n    //\u540c\u4e0a\uff0c\u8c03\u7528\u9ed8\u8ba4\u6216\u662f\u6211\u4eec\u81ea\u5df1\u5b9a\u4e49\u7684AuthenticationFailureHandler\n    this.failureHandler.onAuthenticationFailure(request, response, failed);\n}\n</code></pre> <p>\u4e86\u89e3\u4e86\u6574\u4e2a\u7528\u6237\u9a8c\u8bc1\u5b9e\u73b0\u6d41\u7a0b\uff0c\u5176\u5b9e\u5176\u5b83\u7684\u8fc7\u6ee4\u5668\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u4e5f\u5c31\u5f88\u5bb9\u6613\u8054\u60f3\u5230\u4e86\uff0cSpringSecurity\u7684\u8fc7\u6ee4\u5668\u4ece\u67d0\u79cd\u610f\u4e49\u4e0a\u6765\u8bf4\uff0c\u66f4\u50cf\u662f\u4e00\u4e2a\u5904\u7406\u4e1a\u52a1\u7684Servlet\uff0c\u5b83\u505a\u7684\u4e8b\u60c5\u4e0d\u50cf\u662f\u62e6\u622a\uff0c\u66f4\u50cf\u662f\u5b8c\u6210\u81ea\u5df1\u5bf9\u5e94\u7684\u804c\u8d23\uff0c\u53ea\u4e0d\u8fc7\u662f\u4f7f\u7528\u4e86\u8fc7\u6ee4\u5668\u673a\u5236\u8fdb\u884c\u5b9e\u73b0\u7f62\u4e86\uff0c\u4ece\u800c\u5c06\u6240\u6709\u7684\u9a8c\u8bc1\u63d0\u524d\u5230\u8fdb\u5165Controller\u4e4b\u524d\u3002</p> <p>\u6700\u540e\u9644\u4e0a\u5b8c\u6574\u7684\u8fc7\u6ee4\u5668\u6e05\u5355\uff0c\u8fd9\u91cc\u5217\u51fa14\u4e2a\u5e38\u89c1\u7684\u5185\u90e8\u8fc7\u6ee4\u5668\uff1a</p> \u8fc7\u6ee4\u5668\u540d\u79f0 \u804c\u8d23 DisableEncodeUrlFilter \u7981\u6b62 HttpServletResponse \u5bf9 URL \u8fdb\u884c\u7f16\u7801\uff0c\u4ee5\u9632\u6b62\u5728 URL \u4e2d\u5305\u542b Session ID\uff0c\u6b64\u7c7b URL \u4e0d\u88ab\u89c6\u4e3a URL\uff0c\u56e0\u4e3a\u4f1a\u8bdd ID \u53ef\u80fd\u4f1a\u5728 HTTP \u8bbf\u95ee\u65e5\u5fd7\u7b49\u5185\u5bb9\u4e2d\u6cc4\u9732\u3002 WebAsyncManagerIntegrationFilter \u5b9e\u73b0\u4e86\u5bf9SecurityContext\u4e0eWebAsyncManager\u7684\u96c6\u6210\uff0c\u4f7f Controller \u4e2d\u80fd\u591f\u7ebf\u7a0b\u5b89\u5168\u5730\u83b7\u53d6\u5230\u7528\u6237\u4e0a\u4e0b\u6587\u8ba4\u8bc1\u4fe1\u606f\u3002 SecurityContextHolderFilter \u901a\u8fc7HttpSessionSecurityContextRepository\u63a5\u53e3\u4eceSession\u4e2d\u8bfb\u53d6SecurityContext\u6216\u662f\u76f4\u63a5\u521b\u5efa\u65b0\u7684\uff0c\u7136\u540e\u5b58\u5165\u5230SecurityContextHolder\u4e2d\uff0c\u6700\u540e\u8bf7\u6c42\u7ed3\u675f\u65f6\u4f1a\u8fdb\u884c\u6e05\u7406\u3002 HeaderWriterFilter \u7ed9HTTP\u54cd\u5e94\u6dfb\u52a0\u4e00\u4e9bHeader\u5c5e\u6027\uff0c\u5982\uff1aX-Frame-Options\u3001X-XSS-Protection\u3001X-Content-Type-Options\u7b49\u3002 CsrfFilter \u9488\u5bf9Csrf\u76f8\u5173\u6821\u9a8c\u3002 LogoutFilter \u5bf9\u9000\u51fa\u767b\u5f55\u7684\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\uff0c\u6267\u884c\u767b\u51fa\u64cd\u4f5c\u3002 UsernamePasswordAuthenticationFilter \u5bf9\u767b\u5f55\u7684\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\uff0c\u6267\u884c\u767b\u5f55\u64cd\u4f5c\u3002 ConcurrentSessionFilter \u68c0\u67e5SessionRegistry\u4fdd\u5b58\u7684Session\u4fe1\u606f\u662f\u5426\u8fc7\u671f\u3002 RequestCacheAwareFilter \u7f13\u5b58Request\u8bf7\u6c42\uff0c\u53ef\u4ee5\u7528\u4e8e\u6062\u590d\u56e0\u767b\u5f55\u800c\u6253\u65ad\u7684\u8bf7\u6c42\u3002 SecurityContextHolderAwareRequestFilter \u5bf9ServletRequest\u8fdb\u884c\u8fdb\u4e00\u6b65\u5305\u88c5\uff0c\u8ba9Request\u5177\u6709\u66f4\u52a0\u4e30\u5bcc\u7684\u5185\u5bb9\u3002 RememberMeAuthenticationFilter \u9488\u5bf9\u4e8e\u8bb0\u4f4f\u6211Cookie\u8fdb\u884c\u6821\u9a8c\u3002 AnonymousAuthenticationFilter \u672a\u9a8c\u8bc1\u6210\u529f\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u533f\u540d\u767b\u5f55\u64cd\u4f5c\u3002 SessionManagementFilter Session\u7ba1\u7406\u76f8\u5173\u3002 ExceptionTranslationFilter \u5f02\u5e38\u8f6c\u6362\u5904\u7406\uff0c\u6bd4\u5982\u6700\u5e38\u89c1\u7684AccessDenied\u4e4b\u7c7b\u7684\u3002 <p>\u5404\u4f4d\u5c0f\u4f19\u4f34\u611f\u5174\u8da3\u7684\u8bdd\u53ef\u4ee5\u81ea\u884c\u4e86\u89e3\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_17","title":"\u5b89\u5168\u4e0a\u4e0b\u6587","text":"<p>\u7528\u6237\u767b\u5f55\u4e4b\u540e\uff0c\u600e\u4e48\u83b7\u53d6\u5f53\u524d\u5df2\u7ecf\u767b\u5f55\u7528\u6237\u7684\u4fe1\u606f\u5462\uff1f\u901a\u8fc7\u4f7f\u7528SecurityContextHolder\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u5f97\u5230SecurityContext\u5bf9\u8c61\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528SecurityContext\u5bf9\u8c61\u6765\u83b7\u53d6\u5f53\u524d\u7684\u8ba4\u8bc1\u4fe1\u606f\uff1a</p> <pre><code>@RequestMapping(\"/index\")\n    public String index(){\n        SecurityContext context = SecurityContextHolder.getContext();\n        Authentication authentication = context.getAuthentication();\n        User user = (User) authentication.getPrincipal();\n        System.out.println(user.getUsername());\n        System.out.println(user.getAuthorities());\n        return \"index\";\n    }\n</code></pre> <p>\u901a\u8fc7SecurityContext\u6211\u4eec\u5c31\u53ef\u4ee5\u5feb\u901f\u83b7\u53d6\u5f53\u524d\u7528\u6237\u7684\u540d\u79f0\u548c\u6388\u6743\u4fe1\u606f\u7b49\uff1a</p> <p></p> <p>\u9664\u4e86\u8fd9\u79cd\u65b9\u5f0f\u4ee5\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u76f4\u63a5\u4eceSession\u4e2d\u83b7\u53d6\uff1a</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(@SessionAttribute(\"SPRING_SECURITY_CONTEXT\") SecurityContext context){\n    Authentication authentication = context.getAuthentication();\n    User user = (User) authentication.getPrincipal();\n    System.out.println(user.getUsername());\n    System.out.println(user.getAuthorities());\n    return \"index\";\n}\n</code></pre> <p>\u6ce8\u610fSecurityContextHolder\u662f\u6709\u4e00\u5b9a\u7684\u5b58\u50a8\u7b56\u7565\u7684\uff0cSecurityContextHolder\u4e2d\u7684SecurityContext\u5bf9\u8c61\u4f1a\u5728\u4e00\u5f00\u59cb\u8bf7\u6c42\u5230\u6765\u65f6\u88ab\u8bbe\u5b9a\uff0c\u81f3\u4e8e\u5b58\u50a8\u65b9\u5f0f\u5176\u5b9e\u662f\u7531\u5b58\u50a8\u7b56\u7565\u51b3\u5b9a\u7684\uff0c\u5982\u679c\u6211\u4eec\u8fd9\u6837\u7f16\u5199\uff0c\u90a3\u4e48\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u65e0\u6cd5\u83b7\u53d6\u5230\u8ba4\u8bc1\u4fe1\u606f\u7684\uff1a</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(){\n    new Thread(() -&gt; {   //\u521b\u5efa\u4e00\u4e2a\u5b50\u7ebf\u7a0b\u53bb\u83b7\u53d6\n        SecurityContext context = SecurityContextHolder.getContext();\n        Authentication authentication = context.getAuthentication();\n        User user = (User) authentication.getPrincipal();   //NPE\n        System.out.println(user.getUsername());\n        System.out.println(user.getAuthorities()); \n    }).start();\n    return \"index\";\n}\n</code></pre> <p>\u8fd9\u662f\u56e0\u4e3aSecurityContextHolder\u7684\u5b58\u50a8\u7b56\u7565\u9ed8\u8ba4\u662f<code>MODE_THREADLOCAL</code>\uff0c\u5b83\u662f\u57fa\u4e8eThreadLocal\u5b9e\u73b0\u7684\uff0c<code>getContext()</code>\u65b9\u6cd5\u672c\u8d28\u4e0a\u8c03\u7528\u7684\u662f\u5bf9\u5e94\u7684\u5b58\u50a8\u7b56\u7565\u5b9e\u73b0\u7684\u65b9\u6cd5\uff1a</p> <pre><code>public static SecurityContext getContext() {\n    return strategy.getContext();\n}\n</code></pre> <p>SecurityContextHolderStrategy\u6709\u4e09\u4e2a\u5b9e\u73b0\u7c7b\uff1a</p> <ul> <li>GlobalSecurityContextHolderStrategy\uff1a\u5168\u5c40\u6a21\u5f0f\uff0c\u4e0d\u5e38\u7528</li> <li>ThreadLocalSecurityContextHolderStrategy\uff1a\u57fa\u4e8eThreadLocal\u5b9e\u73b0\uff0c\u7ebf\u7a0b\u5185\u53ef\u89c1</li> <li>InheritableThreadLocalSecurityContextHolderStrategy\uff1a\u57fa\u4e8eInheritableThreadLocal\u5b9e\u73b0\uff0c\u7ebf\u7a0b\u548c\u5b50\u7ebf\u7a0b\u53ef\u89c1</li> </ul> <p>\u56e0\u6b64\uff0c\u5982\u679c\u4e0a\u8ff0\u60c5\u51b5\u9700\u8981\u5728\u5b50\u7ebf\u7a0b\u4e2d\u83b7\u53d6\uff0c\u90a3\u4e48\u9700\u8981\u4fee\u6539SecurityContextHolder\u7684\u5b58\u50a8\u7b56\u7565\uff0c\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u8bbe\u7f6e\uff1a</p> <pre><code>@PostConstruct\npublic void init(){\n    SecurityContextHolder.setStrategyName(SecurityContextHolder.MODE_INHERITABLETHREADLOCAL);\n}\n</code></pre> <p>\u8fd9\u6837\u5728\u5b50\u7ebf\u7a0b\u4e2d\u4e5f\u53ef\u4ee5\u83b7\u53d6\u8ba4\u8bc1\u4fe1\u606f\u4e86\u3002</p> <p>\u56e0\u4e3a\u7528\u6237\u7684\u9a8c\u8bc1\u4fe1\u606f\u662f\u57fa\u4e8eSecurityContext\u8fdb\u884c\u5224\u65ad\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539SecurityContext\u7684\u5185\u5bb9\uff0c\u6765\u624b\u52a8\u4e3a\u7528\u6237\u8fdb\u884c\u767b\u9646\uff1a</p> <pre><code>@RequestMapping(\"/auth\")\n@ResponseBody\npublic String auth(){\n    SecurityContext context = SecurityContextHolder.getContext();  //\u83b7\u53d6SecurityContext\u5bf9\u8c61\uff08\u5f53\u524d\u4f1a\u8bdd\u80af\u5b9a\u662f\u6ca1\u6709\u767b\u9646\u7684\uff09\n    UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(\"Test\", null,\n            AuthorityUtils.commaSeparatedStringToAuthorityList(\"ROLE_user\"));  //\u624b\u52a8\u521b\u5efa\u4e00\u4e2aUsernamePasswordAuthenticationToken\u5bf9\u8c61\uff0c\u4e5f\u5c31\u662f\u7528\u6237\u7684\u8ba4\u8bc1\u4fe1\u606f\uff0c\u89d2\u8272\u9700\u8981\u6dfb\u52a0ROLE_\u524d\u7f00\uff0c\u6743\u9650\u76f4\u63a5\u5199\n    context.setAuthentication(token);  //\u624b\u52a8\u4e3aSecurityContext\u8bbe\u5b9a\u8ba4\u8bc1\u4fe1\u606f\n    return \"Login success\uff01\";\n}\n</code></pre> <p>\u5728\u672a\u767b\u9646\u7684\u60c5\u51b5\u4e0b\uff0c\u8bbf\u95ee\u6b64\u5730\u5740\u5c06\u76f4\u63a5\u8fdb\u884c\u624b\u52a8\u767b\u9646\uff0c\u518d\u6b21\u8bbf\u95ee<code>/index</code>\u9875\u9762\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\uff0c\u8bf4\u660e\u624b\u52a8\u8bbe\u7f6e\u8ba4\u8bc1\u4fe1\u606f\u6210\u529f\u3002</p> <p>\u7591\u60d1\uff1aSecurityContext\u8fd9\u73a9\u610f\u4e0d\u662f\u9ed8\u8ba4\u7ebf\u7a0b\u72ec\u5360\u5417\uff0c\u90a3\u6bcf\u6b21\u8bf7\u6c42\u90fd\u662f\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\uff0c\u6309\u7406\u8bf4\u4e0a\u4e00\u6b21\u7684SecurityContext\u5bf9\u8c61\u5e94\u8be5\u6ca1\u4e86\u624d\u5bf9\u554a\uff0c\u4e3a\u4ec0\u4e48\u518d\u6b21\u8bf7\u6c42\u4f9d\u7136\u80fd\u591f\u7ee7\u7eed\u4f7f\u7528\u4e0a\u4e00\u6b21SecurityContext\u4e2d\u7684\u8ba4\u8bc1\u4fe1\u606f\u5462\uff1f</p> <p>SecurityContext\u7684\u751f\u547d\u5468\u671f\uff1a\u8bf7\u6c42\u5230\u6765\u65f6\u4eceSession\u4e2d\u53d6\u51fa\uff0c\u653e\u5165SecurityContextHolder\u4e2d\uff0c\u8bf7\u6c42\u7ed3\u675f\u65f6\u4eceSecurityContextHolder\u53d6\u51fa\uff0c\u5e76\u653e\u5230Session\u4e2d\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u4f9d\u9760Session\u6765\u5b58\u50a8\u7684\uff0c\u4e00\u65e6\u4f1a\u8bdd\u8fc7\u671f\u9a8c\u8bc1\u4fe1\u606f\u4e5f\u8ddf\u7740\u6d88\u5931\u3002</p> <p>\u4e0b\u4e00\u8282\u6211\u4eec\u5c06\u8be6\u7ec6\u8ba8\u8bba\u5b83\u7684\u5b9e\u73b0\u8fc7\u7a0b\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_18","title":"\u5b89\u5168\u4e0a\u4e0b\u6587\u6301\u4e45\u5316\u8fc7\u6ee4\u5668","text":"<p>SecurityContextHolderFilter\u4e5f\u662f\u5185\u7f6e\u7684Filter\uff0c\u5b83\u5c31\u662f\u4e13\u95e8\u7528\u4e8e\u5904\u7406SecurityContext\u7684\uff0c\u8fd9\u91cc\u5148\u8bf4\u4e00\u4e0b\u5927\u81f4\u6d41\u7a0b\uff0c\u4ee5\u4fbf\u6211\u4eec\u540e\u7eed\u66f4\u52a0\u65b9\u4fbf\u5730\u7406\u89e3\uff1a</p> <p>\u5f53\u8fc7\u6ee4\u5668\u94fe\u6267\u884c\u5230SecurityContextHolderFilter\u65f6\uff0c\u5b83\u4f1a\u4eceHttpSession\u4e2d\u628aSecurityContext\u5bf9\u8c61\u53d6\u51fa\u6765\uff08\u662f\u5b58\u5728Session\u4e2d\u7684\uff0c\u8ddf\u968f\u4f1a\u8bdd\u7684\u6d88\u5931\u800c\u6d88\u5931\uff09\uff0c\u7136\u540e\u653e\u5165SecurityContextHolder\u5bf9\u8c61\u4e2d\u3002\u8bf7\u6c42\u7ed3\u675f\u540e\uff0c\u518d\u628aSecurityContext\u5b58\u5165HttpSession\u4e2d\uff0c\u5e76\u6e05\u9664SecurityContextHolder\u5185\u7684SecurityContext\u5bf9\u8c61\u3002</p> <p>\u6211\u4eec\u8fd8\u662f\u76f4\u63a5\u8fdb\u5165\u5230\u6e90\u7801\u4e2d\uff1a</p> <pre><code>    @Override\n    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)\n            throws IOException, ServletException {\n    //\u5f00\u59cb\u5957\u5a03\n        doFilter((HttpServletRequest) request, (HttpServletResponse) response, chain);\n    }\n\n    private void doFilter(HttpServletRequest request, HttpServletResponse response, FilterChain chain)\n            throws ServletException, IOException {\n    //\u9632\u6b62\u91cd\u590d\u7684\u5b89\u5168\u8bf7\u6c42\uff0c\u4e0d\u9700\u8981\u5173\u5fc3\uff0c\u4e00\u822c\u662f\u76f4\u63a5\u8d70\u4e0b\u9762\n        if (request.getAttribute(FILTER_APPLIED) != null) {\n            chain.doFilter(request, response);\n            return;\n        }\n        request.setAttribute(FILTER_APPLIED, Boolean.TRUE);\n    //\u8fd9\u91cc\u901a\u8fc7SecurityContextRepository\u7684loadDeferredContext\u83b7\u53d6\u5230SecurityContext\u5bf9\u8c61\u7684Supplier\n        Supplier&lt;SecurityContext&gt; deferredContext = this.securityContextRepository.loadDeferredContext(request);\n        ...\n    }\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b<code>loadDeferredContext</code>\u7684\u5b9e\u73b0\u7ec6\u8282\uff0c\u5176\u4e2dSecurityContextRepository\u7684\u5b9e\u73b0\u7c7b\u662fDelegatingSecurityContextRepository\u7c7b\uff0c\u8fd9\u4e2a\u7c7b\u4e2d\u7ef4\u62a4\u4e86\u591a\u4e2aSecurityContextRepository\u5b9e\u73b0\u7c7b\uff0c\u800c\u5176\u672c\u8eab\u5e76\u6ca1\u6709\u5b9e\u73b0<code>loadDeferredContext</code>\u65b9\u6cd5\uff0c\u800c\u662f\u9760\u5185\u90e8\u7ef4\u62a4\u7684\u5176\u4ed6SecurityContextRepository\u5b9e\u73b0\u7c7b\u6765\u5b8c\u6210\uff1a</p> <pre><code>    @Override\n    public DeferredSecurityContext loadDeferredContext(HttpServletRequest request) {\n    //DeferredSecurityContext\u662f\u4e00\u4e2a\u652f\u6301\u5ef6\u65f6\u751f\u6210\u7684SecurityContext\uff0c\u672c\u8d28\u662f\u4e00\u4e2aSecurityContext\u7684Supplier\n        DeferredSecurityContext deferredSecurityContext = null;\n    //\u904d\u5386\u5185\u90e8\u7ef4\u62a4\u7684\u5176\u4ed6SecurityContextRepository\u5b9e\u73b0\uff0c\u4e00\u822c\u5305\u542b\u4ee5\u4e0b\u4e24\u4e2a\uff1a\n    //1. HttpSessionSecurityContextRepository\n    //2. RequestAttributeSecurityContextRepository\n        for (SecurityContextRepository delegate : this.delegates) {\n      //\u8fd9\u4e2aif-else\u8bed\u53e5\u5176\u5b9e\u4e3a\u4e86\u6dfb\u52a0\u591a\u4e2aSecurityContextRepository\u63d0\u4f9b\u7684SecurityContext\u5e76\u5c06\u5176\u7ec4\u6210\u4e00\u4e2a\u94fe\u72b6\u7ed3\u6784\u7684DelegatingDeferredSecurityContext\uff08\u81f3\u4e8e\u4e3a\u4ec0\u4e48\uff0c\u6211\u4eec\u63a5\u7740\u5f80\u4e0b\u770b\uff09\n            if (deferredSecurityContext == null) {\n                deferredSecurityContext = delegate.loadDeferredContext(request);\n            }\n            else {\n                DeferredSecurityContext next = delegate.loadDeferredContext(request);\n                deferredSecurityContext = new DelegatingDeferredSecurityContext(deferredSecurityContext, next);\n            }\n        }\n        return deferredSecurityContext;\n    }\n</code></pre> <p>\u9996\u5148\u6211\u4eec\u6765\u770b\u7b2c\u4e00\u4e2aHttpSessionSecurityContextRepository\uff0c\u5b83\u662f\u7b2c\u4e00\u4e2a\u88ab\u904d\u5386\u7684\u5b9e\u73b0\uff1a</p> <pre><code>    @Override\n    public DeferredSecurityContext loadDeferredContext(HttpServletRequest request) {\n        Supplier&lt;SecurityContext&gt; supplier = () -&gt; readSecurityContextFromSession(request.getSession(false));  //\u4eceSession\u4e2d\u53d6\u51faSecurityContext\n        return new SupplierDeferredSecurityContext(supplier, this.securityContextHolderStrategy);\n    }\n\n    public static final String SPRING_SECURITY_CONTEXT_KEY = \"SPRING_SECURITY_CONTEXT\";\n    private String springSecurityContextKey = SPRING_SECURITY_CONTEXT_KEY;\n\n    private SecurityContext readSecurityContextFromSession(HttpSession httpSession) {\n        ...\n    //\u5b9e\u9645\u4e0a\u8fd9\u91cc\u5c31\u662f\u4eceSession\u4e2d\u901a\u8fc7\u952e\u201cSPRING_SECURITY_CONTEXT\u201d\u53d6\u51fa\u7684SecurityContext\n    //\u8ddf\u6211\u4eec\u4e0a\u4e00\u8282\u4f7f\u7528\u7684\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u8fd9\u4e0b\u5c31\u5f88\u6e05\u6670\u4e86\n    //\u5982\u679c\u7528\u6237\u6ca1\u6709\u767b\u5f55\u9a8c\u8bc1\uff0c\u90a3\u4e48\u8fd9\u91cc\u83b7\u53d6\u5230\u7684SecurityContext\u5c31\u662fnull\u4e86\n        Object contextFromSession = httpSession.getAttribute(this.springSecurityContextKey);\n        ...\n        return (SecurityContext) contextFromSession;\n    }\n</code></pre> <p>\u6700\u540e\u8fd4\u56de\u56de\u53bb\u7684\u662f\u4e00\u4e2aSupplierDeferredSecurityContext\u5bf9\u8c61\uff1a</p> <pre><code>final class SupplierDeferredSecurityContext implements DeferredSecurityContext {\n\n    private static final Log logger = LogFactory.getLog(SupplierDeferredSecurityContext.class);\n\n    private final Supplier&lt;SecurityContext&gt; supplier;\n\n    private final SecurityContextHolderStrategy strategy;\n\n    private SecurityContext securityContext;\n\n    private boolean missingContext;\n\n    SupplierDeferredSecurityContext(Supplier&lt;SecurityContext&gt; supplier, SecurityContextHolderStrategy strategy) {\n        this.supplier = supplier;\n        this.strategy = strategy;\n    }\n\n    @Override\n    public SecurityContext get() {\n    //\u5728\u83b7\u53d6SecurityContext\u65f6\u4f1a\u8fdb\u884c\u4e00\u6b21\u521d\u59cb\u5316\n        init();\n        return this.securityContext;\n    }\n\n    @Override\n    public boolean isGenerated() {\n        init();\n    //\u521d\u59cb\u5316\u540e\u5224\u65ad\u662f\u5426\u4e3a\u672a\u767b\u5f55\u7684SecurityContext\n        return this.missingContext;\n    }\n\n    private void init() {\n    //\u5982\u679csecurityContext\u4e0d\u4e3anull\u8868\u793a\u5df2\u7ecf\u521d\u59cb\u5316\u8fc7\u4e86\n        if (this.securityContext != null) {\n            return;\n        }\n        //\u76f4\u63a5\u901a\u8fc7supplier\u83b7\u53d6securityContext\u5bf9\u8c61\n        this.securityContext = this.supplier.get();\n    //\u5982\u679csecurityContext\u5bf9\u8c61\u4e3anull\uff0c\u90a3\u4e48\u5c31\u6807\u8bb0missingContext\n        this.missingContext = (this.securityContext == null);\n        if (this.missingContext) {\n      //\u5f53missingContext\u4e3a\u771f\u65f6\uff0c\u8bf4\u660e\u6ca1\u6709securityContext\uff08\u4e00\u822c\u662f\u672a\u767b\u5f55\u7684\u60c5\u51b5\uff09\n      //\u90a3\u4e48\u5c31\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684securityContext\uff0c\u4e0d\u5305\u542b\u4efb\u4f55\u8ba4\u8bc1\u4fe1\u606f\n            this.securityContext = this.strategy.createEmptyContext();\n      //\u65e5\u5fd7\u65e0\u89c6\u5c31\u597d\n            if (logger.isTraceEnabled()) {\n                logger.trace(LogMessage.format(\"Created %s\", this.securityContext));\n            }\n        }\n    }\n\n}\n</code></pre> <p>\u63a5\u7740\u662f\u7b2c\u4e8c\u4e2a\u88ab\u904d\u5386\u7684\u5b9e\u73b0RequestAttributeSecurityContextRepository\u7c7b\uff1a</p> <pre><code>    @Override\n    public DeferredSecurityContext loadDeferredContext(HttpServletRequest request) {\n        Supplier&lt;SecurityContext&gt; supplier = () -&gt; getContext(request);\n    //\u540c\u6837\u662f\u8fd4\u56deSupplierDeferredSecurityContext\u5bf9\u8c61\n        return new SupplierDeferredSecurityContext(supplier, this.securityContextHolderStrategy);\n    }\n\n    private SecurityContext getContext(HttpServletRequest request) {\n    //\u901a\u8fc7HttpServletRequest\u7684Attribute\u83b7\u53d6SecurityContext\n    //\u7531\u4e8e\u4e00\u822c\u60c5\u51b5\u4e0b\u6ca1\u6709\u8bbe\u5b9a\u8fc7\uff0c\u56e0\u6b64\u5f97\u5230\u7684\u5c31\u662fnull\n        return (SecurityContext) request.getAttribute(this.requestAttributeName);\n    }\n</code></pre> <p>\u6700\u540e\uff0c\u4e24\u4e2aSecurityContext\u5c31\u4f1a\u4ee5\u94fe\u5f0f\u5b58\u653e\u5728DelegatingDeferredSecurityContext\u5bf9\u8c61\u4e2d\uff0c\u4e00\u5e76\u8fd4\u56de\u4e86\uff0c\u5b83\u7684\u5185\u90e8\u957f\u8fd9\u6837\uff1a</p> <pre><code>static final class DelegatingDeferredSecurityContext implements DeferredSecurityContext {\n\n        private final DeferredSecurityContext previous;\n\n        private final DeferredSecurityContext next;\n\n        DelegatingDeferredSecurityContext(DeferredSecurityContext previous, DeferredSecurityContext next) {\n            this.previous = previous;\n            this.next = next;\n        }\n\n        @Override\n        public SecurityContext get() {\n      //\u5728\u83b7\u53d6SecurityContext\u65f6\uff0c\u4f1a\u9996\u5148\u4ece\u6700\u524d\u9762\u7684\u5f00\u59cb\u83b7\u53d6\n            SecurityContext securityContext = this.previous.get();\n      //\u5982\u679c\u6700\u524d\u9762\u7684SecurityContext\u662f\u5df2\u767b\u5f55\u7684\uff0c\u90a3\u4e48\u76f4\u63a5\u8fd4\u56de\u8fd9\u4e2aSecurityContext\n            if (!this.previous.isGenerated()) {\n                return securityContext;\n            }\n      //\u5426\u5219\u7ee7\u7eed\u770b\u540e\u9762\u7684\uff0c\u4e5f\u8bb8\u540e\u9762\u7684\u4f1a\u6709\u5df2\u767b\u5f55\u7684\uff08\u5b9e\u5728\u6ca1\u6709\u5c31\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u7a7a\u7684SecurityContext\u4e86\uff09\n            return this.next.get();\n        }\n\n        @Override\n        public boolean isGenerated() {\n            return this.previous.isGenerated() &amp;&amp; this.next.isGenerated();\n        }\n}\n</code></pre> <p>\u515c\u4e86\u8fd9\u4e48\u5927\u4e00\u5708\uff0c\u73b0\u5728\u56de\u5230\u4e00\u5f00\u59cb\u7684Filter\u4e2d\uff1a</p> <pre><code>    private void doFilter(HttpServletRequest request, HttpServletResponse response, FilterChain chain)\n            throws ServletException, IOException {\n        ...\n    Supplier&lt;SecurityContext&gt; deferredContext = this.securityContextRepository.loadDeferredContext(request);\n    //\u62ff\u5230\u6700\u7ec8\u7684SecurityContext\u7684Supplier\u540e\uff0c\u7ee7\u7eed\u4e0b\u9762\u7684\u8bed\u53e5\n        try {\n      //\u5411securityContextHolderStrategy\u4e2d\u8bbe\u7f6e\u6211\u4eec\u4e0a\u9762\u5f97\u5230\u7684DeferredSecurityContext\n            this.securityContextHolderStrategy.setDeferredContext(deferredContext);\n      //\u8bf7\u6c42\u524d\u7684\u4efb\u52a1\u5df2\u5b8c\u6210\uff0c\u7ee7\u7eed\u5176\u4ed6\u8fc7\u6ee4\u5668\u4e86\n            chain.doFilter(request, response);\n        }\n        finally {\n      //\u8bf7\u6c42\u7ed3\u675f\u540e\uff0c\u6e05\u7406\u6389securityContextHolderStrategy\u4e2d\u7684DeferredSecurityContext\n            this.securityContextHolderStrategy.clearContext();\n            request.removeAttribute(FILTER_APPLIED);\n        }\n    }\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u518d\u6765\u770b\u4e00\u4e0b\u6211\u4eec\u4e4b\u524d\u901a\u8fc7SecurityContextHolder\u662f\u5982\u4f55\u83b7\u53d6\u5230SecurityContext\u7684\uff1a</p> <pre><code>public class SecurityContextHolder {\n    ...\n  private static String strategyName = System.getProperty(SYSTEM_PROPERTY);\n    private static SecurityContextHolderStrategy strategy;\n    private static int initializeCount = 0;\n\n    static {\n    //\u7c7b\u52a0\u8f7d\u65f6\u4f1a\u8fdb\u884c\u4e00\u6b21\u521d\u59cb\u5316\n        initialize();\n    }\n\n    private static void initialize() {\n    //\u521d\u59cb\u5316\u4f1a\u5c06\u5bf9\u5e94\u7684SecurityContextHolderStrategy\u5bf9\u8c61\u7ed9\u521b\u5efa\n        initializeStrategy();\n        initializeCount++;\n    }\n\n  //\u521d\u59cb\u5316SecurityContextHolderStrategy\u5bf9\u8c61\n    private static void initializeStrategy() {\n        ...\n        // \u5c1d\u8bd5\u52a0\u8f7d\u7cfb\u7edf\u914d\u7f6e\u4e2d\u8bbe\u5b9a\u7684Strategy\u5b9e\u73b0\u7c7b\uff0c\u9ed8\u8ba4\u662fMODE_THREADLOCAL\n        try {\n            Class&lt;?&gt; clazz = Class.forName(strategyName);\n            Constructor&lt;?&gt; customStrategy = clazz.getConstructor();\n      // \u8fd9\u91cc\u76f4\u63a5\u6839\u636e\u914d\u7f6e\u4e2d\u7684\u7c7b\u540d\uff0c\u7528\u53cd\u5c04\u6012\u8279\u4e00\u4e2a\u5bf9\u8c61\u51fa\u6765\n            strategy = (SecurityContextHolderStrategy) customStrategy.newInstance();\n        }\n        catch (Exception ex) {\n            ReflectionUtils.handleReflectionException(ex);\n        }\n    }\n\n    //\u6e05\u9664Context\u4e2d\u7684\u5185\u5bb9\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u6e05\u7406SecurityContextHolderStrategy\u4e2d\u7684\u5185\u5bb9\n    public static void clearContext() {\n        strategy.clearContext();\n    }\n\n    //\u83b7\u53d6SecurityContext\u5bf9\u8c61\n    public static SecurityContext getContext() {\n    //\u83b7\u53d6SecurityContext\u5b9e\u9645\u4e0a\u4e5f\u662f\u901a\u8fc7SecurityContextHolderStrategy\u6839\u636e\u7b56\u7565\u6765\u83b7\u53d6\n        return strategy.getContext();\n    }\n\n  ...\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0aSecurityContextHolder\u83b7\u53d6SecurityContext\u5bf9\u8c61\uff0c\u5c31\u662f\u901a\u8fc7SecurityContextHolderStrategy\u6839\u636e\u7b56\u7565\u6765\u83b7\u53d6\uff0c\u6211\u4eec\u76f4\u63a5\u6765\u770bSecurityContextHolderStrategy\u7684\u5b9e\u73b0\u7c7b\uff1a</p> <pre><code>final class ThreadLocalSecurityContextHolderStrategy implements SecurityContextHolderStrategy {\n\n  //\u5185\u90e8\u7ef4\u62a4\u4e00\u4e2aThreadLocal\u5bf9\u8c61\uff0c\u6309\u7ebf\u7a0b\u5b58\u50a8\u5bf9\u5e94\u7684DeferredSecurityContext\n    private static final ThreadLocal&lt;Supplier&lt;SecurityContext&gt;&gt; contextHolder = new ThreadLocal&lt;&gt;();\n\n    @Override\n    public void clearContext() {\n    //\u6e05\u7406\u5b9e\u9645\u4e0a\u662f\u76f4\u63a5\u6e05\u7406\u6389ThreadLocal\u4e2d\u5b58\u7684\u5bf9\u8c61\n        contextHolder.remove();\n    }\n\n    @Override\n    public SecurityContext getContext() {\n    //\u83b7\u53d6\u4e5f\u5f88\u7b80\u5355\uff0c\u76f4\u63a5\u901a\u8fc7Supplier\u62ff\u5230\u9700\u8981\u7684SecurityContext\u5bf9\u8c61\n        return getDeferredContext().get();\n    }\n\n    @Override\n    public Supplier&lt;SecurityContext&gt; getDeferredContext() {\n        Supplier&lt;SecurityContext&gt; result = contextHolder.get();\n    //\u5982\u679c\u5b58\u50a8\u7684DeferredSecurityContext\u4e3anull\uff0c\u8fd9\u91cc\u4e34\u65f6\u521b\u5efa\u4e00\u4e2a\u7a7a\u7684SecurityContext\u5e76\u4fdd\u5b58\n        if (result == null) {\n            SecurityContext context = createEmptyContext();\n            result = () -&gt; context;\n            contextHolder.set(result);\n        }\n        return result;\n    }\n\n    ...\n\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6574\u4e2a\u6d41\u7a0b\u5176\u5b9e\u5c31\u5f88\u6e05\u695a\u4e86\uff0c\u9879\u76ee\u542f\u52a8\u65f6\uff0cSecurityContextHolder\u4f1a\u81ea\u52a8\u6839\u636e\u914d\u7f6e\u521b\u5efa\u5bf9\u5e94\u7684SecurityContextHolderStrategy\u5bf9\u8c61\u3002\u5f53\u6211\u4eec\u7684\u8bf7\u6c42\u5230\u6765\u4e4b\u540e\uff0c\u9996\u5148\u4f1a\u7ecf\u8fc7SecurityContextHolderFilter\uff0c\u7136\u540e\u5728\u8fd9\u4e2a\u9636\u6bb5\uff0c\u901a\u8fc7SecurityContextRepository\u6765\u5c06\u4e0d\u540c\u5730\u65b9\u5b58\u50a8\uff08\u4e00\u822c\u662fSession\u4e2d\u5b58\u50a8\uff09\u7684SecurityContext\u5bf9\u8c61\u53d6\u51fa\u5e76\u5c01\u88c5\u4e3aDefferdSecurityContext\uff0c\u7136\u540e\u5c06\u5176\u6dfb\u52a0\u5230\u4e00\u5f00\u59cb\u521b\u5efa\u597d\u7684SecurityContextHolderStrategy\u5bf9\u8c61\u4e2d\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u7684Controller\u5728\u5904\u7406\u65f6\u5c31\u80fd\u76f4\u63a5\u4eceSecurityContextHolder\u53d6\u51faSecurityContext\u5bf9\u8c61\u4e86\uff0c\u6700\u540e\u5728\u5904\u7406\u7ed3\u675f\u8fd4\u56de\u54cd\u5e94\u65f6\uff0cSecurityContextHolderFilter\u4e5f\u4f1a\u5c06SecurityContextHolderStrategy\u5b58\u50a8\u7684DefferdSecurityContext\u6e05\u9664\u6389\uff0c\u81f3\u6b64\uff0c\u4e00\u4e2a\u5b8c\u6574\u6d41\u7a0b\u7ed3\u675f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89SpringSecurity%E5%9F%BA%E7%A1%80/#_19","title":"\u5b9e\u6218\uff1a\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf","text":"<p>\u5728\u4e86\u89e3\u4e86SpringSecurity\u7684\u5927\u90e8\u5206\u529f\u80fd\u540e\uff0c\u6211\u4eec\u5c31\u6765\u5c06\u6574\u4e2a\u7f51\u7ad9\u7684\u5185\u5bb9\u8fdb\u884c\u5b8c\u5584\uff0c\u767b\u9646\u76ee\u524d\u5df2\u7ecf\u5b9e\u73b0\u4e86\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\uff1a</p> <ul> <li>\u6ce8\u518c\u529f\u80fd\uff08\u4ec5\u9488\u5bf9\u4e8e\u5b66\u751f\uff09</li> <li>\u89d2\u8272\u5206\u4e3a\u540c\u5b66\u548c\u7ba1\u7406\u5458</li> <li>\u7ba1\u7406\u5458\u8d1f\u8d23\u4e0a\u67b6\u3001\u5220\u9664\u3001\u66f4\u65b0\u4e66\u7c4d\uff0c\u67e5\u770b\u6240\u6709\u540c\u5b66\u7684\u501f\u9605\u5217\u8868</li> <li>\u540c\u5b66\u53ef\u4ee5\u501f\u9605\u548c\u5f52\u8fd8\u4e66\u7c4d\uff0c\u4ee5\u53ca\u67e5\u770b\u81ea\u5df1\u7684\u501f\u9605\u5217\u8868</li> </ul> <p>\u73b0\u5728\u6211\u4eec\u5c31\u6765\u4ece\u5934\u7f16\u5199\u4e00\u4e2a\u57fa\u4e8eSSM\u7684\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u5427\uff01</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/","title":"SpringMVC\u57fa\u7840","text":"<p>\u8fdb\u5165\u4e4b\u524d\uff1a\u300aSpring\u6838\u5fc3\u5185\u5bb9\u300b\u300aJavaWeb\u300b\u300aJDK9-17\u65b0\u7279\u6027\u7bc7\u300b</p> <p>\u5728\u524d\u9762\u5b66\u4e60\u5b8cSpring\u6846\u67b6\u6280\u672f\u4e4b\u540e\uff0c\u5dee\u4e0d\u591a\u4f1a\u51fa\u73b0\u4e24\u6279\u4eba\uff1a\u4e00\u6279\u662f\u542c\u5f97\u4e91\u91cc\u96fe\u91cc\uff0c\u4f9d\u7136\u4e0d\u660e\u767d\u8fd9\u4e2a\u4e1c\u897f\u662f\u5e72\u561b\u7684\uff1b\u8fd8\u6709\u4e00\u6279\u5c31\u662f\u5dee\u4e0d\u591a\u7406\u89e3\u4e86\u6838\u5fc3\u601d\u60f3\uff0c\u4f46\u662f\u4e0d\u77e5\u9053\u8fd9\u4e9b\u4e1c\u897f\u8be5\u5982\u4f55\u53bb\u53d1\u6325\u5b83\u7684\u4f5c\u7528\u3002\u4e0d\u8fc7\u6ca1\u6709\u5173\u7cfb\uff0c\u5728SpringMVC\u9636\u6bb5\uff0c\u4f60\u4e00\u5b9a\u80fd\u9010\u6e10\u591f\u4f53\u4f1a\u5230Spring\u6846\u67b6\u4e3a\u6211\u4eec\u5e26\u6765\u7684\u4fbf\u6377\u4e4b\u5904\u3002</p> <p>\u6b64\u9636\u6bb5\uff0c\u6211\u4eec\u5c06\u518d\u6b21\u56de\u5230Tomcat\u7684Web\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4e2d\uff0c\u53bb\u611f\u53d7Spring\u6846\u67b6\u4e3a\u6211\u4eec\u5e26\u6765\u7684\u5de8\u5927\u4fbf\u6377\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#mvc","title":"MVC\u7406\u8bba\u57fa\u7840","text":"<p>\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u7ed9\u5927\u5bb6\u8bb2\u89e3\u4e86\u4e09\u5c42\u67b6\u6784\uff0c\u5305\u62ec\uff1a</p> <p></p> <p>\u6bcf\u4e00\u5c42\u90fd\u6709\u7740\u5404\u81ea\u7684\u804c\u8d23\uff0c\u5176\u4e2d\u6700\u5173\u952e\u7684\u5f53\u5c5e\u8868\u793a\u5c42\uff0c\u56e0\u4e3a\u5b83\u76f8\u5f53\u4e8e\u5c31\u662f\u76f4\u63a5\u4e0e\u7528\u6237\u7684\u6d4f\u89c8\u5668\u6253\u4ea4\u9053\u7684\u4e00\u5c42\uff0c\u5e76\u4e14\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u4f1a\u7ecf\u8fc7\u5b83\u8fdb\u884c\u89e3\u6790\uff0c\u7136\u540e\u518d\u544a\u77e5\u4e1a\u52a1\u5c42\u8fdb\u884c\u5904\u7406\uff0c\u4efb\u4f55\u9875\u9762\u7684\u8fd4\u56de\u548c\u6570\u636e\u586b\u5145\u4e5f\u5168\u9760\u8868\u793a\u5c42\u6765\u5b8c\u6210\uff0c\u56e0\u6b64\u5b83\u5b9e\u9645\u4e0a\u662f\u6574\u4e2a\u4e09\u5c42\u67b6\u6784\u4e2d\u6700\u5173\u952e\u7684\u4e00\u5c42\uff0c\u800c\u5728\u4e4b\u524d\u7684\u5b9e\u6218\u5f00\u53d1\u4e2d\uff0c\u6211\u4eec\u7f16\u5199\u4e86\u5927\u91cf\u7684Servlet\uff08\u4e5f\u5c31\u662f\u8868\u793a\u5c42\u5b9e\u73b0\uff09\u6765\u5904\u7406\u6765\u81ea\u6d4f\u89c8\u5668\u7684\u5404\u79cd\u8bf7\u6c42\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u4ec5\u4ec5\u662f\u51e0\u4e2a\u5f88\u5c0f\u7684\u529f\u80fd\uff0c\u4ee5\u53ca\u51e0\u4e2a\u5f88\u57fa\u672c\u7684\u9875\u9762\uff0c\u6211\u4eec\u90fd\u8981\u7f16\u5199\u5c06\u8fd1\u5341\u4e2aServlet\uff0c\u5982\u679c\u662f\u66f4\u52a0\u5927\u578b\u7684\u7f51\u7ad9\u7cfb\u7edf\uff0c\u6bd4\u5982\u6dd8\u5b9d\u3001B\u7ad9\uff0c\u5149\u662f\u4e00\u4e2a\u9875\u9762\u4e2d\u53ef\u80fd\u5c31\u5305\u542b\u4e86\u51e0\u5341\u751a\u81f3\u4e0a\u767e\u4e2a\u529f\u80fd\uff0c\u60f3\u60f3\u90a3\u6837\u7684\u8bdd\u5199\u8d77\u6765\u5f97\u591a\u6050\u6016\u3002</p> <p>\u56e0\u6b64\uff0cSpringMVC\u6b63\u662f\u4e3a\u4e86\u89e3\u51b3\u8fd9\u79cd\u95ee\u9898\u800c\u751f\u7684\uff0c\u5b83\u662f\u4e00\u4e2a\u975e\u5e38\u4f18\u79c0\u7684\u8868\u793a\u5c42\u6846\u67b6\uff0c\u91c7\u7528MVC\u601d\u60f3\u8bbe\u8ba1\u5b9e\u73b0\u3002</p> <p>MVC\u8be6\u7ec6\u89e3\u91ca\u5982\u4e0b\uff1a</p> <ul> <li>M\u662f\u6307\u4e1a\u52a1\u6a21\u578b\uff08Model\uff09\uff1a\u901a\u4fd7\u7684\u8bb2\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u7528\u4e8e\u5c01\u88c5\u6570\u636e\u4f20\u9012\u7684\u5b9e\u4f53\u7c7b\u3002</li> <li>V\u662f\u6307\u7528\u6237\u754c\u9762\uff08View\uff09\uff1a\u4e00\u822c\u6307\u7684\u662f\u524d\u7aef\u9875\u9762\u3002</li> <li>C\u5219\u662f\u63a7\u5236\u5668\uff08Controller\uff09\uff1a\u63a7\u5236\u5668\u5c31\u76f8\u5f53\u4e8eServlet\u7684\u57fa\u672c\u529f\u80fd\uff0c\u5904\u7406\u8bf7\u6c42\uff0c\u8fd4\u56de\u54cd\u5e94\u3002</li> </ul> <p></p> <p>SpringMVC\u6b63\u662f\u5e0c\u671b\u8fd9\u4e09\u8005\u4e4b\u95f4\u8fdb\u884c\u89e3\u8026\uff0c\u5b9e\u73b0\u5404\u5e72\u5404\u7684\uff0c\u66f4\u52a0\u7cbe\u7ec6\u5730\u5212\u5206\u5bf9\u5e94\u7684\u804c\u8d23\u3002\u6700\u540e\u518d\u5c06View\u548cModel\u8fdb\u884c\u6e32\u67d3\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u9875\u9762\u5e76\u8fd4\u56de\u7ed9\u524d\u7aef\uff08\u5c31\u50cf\u4e4b\u524d\u4f7f\u7528Thymeleaf\u90a3\u6837\uff0c\u628a\u5b9e\u4f53\u6570\u636e\u5bf9\u8c61\u548c\u524d\u7aef\u9875\u9762\u90fd\u7ed9\u5230Thymeleaf\uff0c\u7136\u540e\u5b83\u4f1a\u5c06\u5176\u8fdb\u884c\u6574\u5408\u6e32\u67d3\u5f97\u5230\u6700\u7ec8\u6709\u6570\u636e\u7684\u9875\u9762\uff0c\u800c\u672c\u6559\u7a0b\u4e5f\u4f1a\u4f7f\u7528Thymeleaf\u4f5c\u4e3a\u89c6\u56fe\u89e3\u6790\u5668\u8fdb\u884c\u8bb2\u89e3\uff09</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#_1","title":"\u914d\u7f6e\u73af\u5883\u5e76\u642d\u5efa\u9879\u76ee","text":"<p>\u8fd9\u91cc\u6211\u4eec\u7ee7\u7eed\u4f7f\u7528\u4e4b\u524d\u7684Tomcat10\u670d\u52a1\u5668\uff0cSpring6\u4e4b\u540e\u8981\u6c42\u5fc5\u987b\u4f7f\u7528Tomcat10\u6216\u66f4\u9ad8\u7248\u672c\uff0c\u8ddf\u4e4b\u524d\u4e00\u6837\uff0c\u6211\u4eec\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684JakartaEE\u9879\u76ee\u3002</p> <p></p> <p>\u521b\u5efa\u5b8c\u6210\u540e\u4f1a\u81ea\u52a8\u751f\u6210\u76f8\u5173\u6587\u4ef6\uff0c\u4f46\u662f\u8fd8\u662f\u8bf7\u6ce8\u610f\u68c0\u67e5\u8fd0\u884c\u914d\u7f6e\u4e2d\u7684URL\u548c\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u540d\u79f0\u662f\u5426\u4e00\u81f4\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#xml","title":"\u4f20\u7edfXML\u914d\u7f6e\u5f62\u5f0f","text":"<p>SpringMvc\u9879\u76ee\u4f9d\u7136\u652f\u6301\u591a\u79cd\u914d\u7f6e\u5f62\u5f0f\uff0c\u8fd9\u91cc\u6211\u4eec\u9996\u5148\u8bb2\u89e3\u6700\u4f20\u7edf\u7684XML\u914d\u7f6e\u5f62\u5f0f\u3002</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u6dfb\u52a0Mvc\u76f8\u5173\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;\n    &lt;version&gt;6.0.10&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u914d\u7f6e\u4e00\u4e0bweb.xml\uff0c\u5c06DispatcherServlet\u66ff\u6362\u6389Tomcat\u81ea\u5e26\u7684Servlet\uff0c\u8fd9\u91ccurl-pattern\u9700\u8981\u5199\u4e3a<code>/</code>\uff0c\u5373\u53ef\u5b8c\u6210\u66ff\u6362\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app xmlns=\"https://jakarta.ee/xml/ns/jakartaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd\"\n         version=\"5.0\"&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;mvc&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;mvc&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;/&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n</code></pre> <p>\u63a5\u7740\u9700\u8981\u4e3a\u6574\u4e2aWeb\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u4e00\u4e2aSpring\u4e0a\u4e0b\u6587\u73af\u5883\uff08\u4e5f\u5c31\u662f\u5bb9\u5668\uff09\uff0c\u56e0\u4e3aSpringMVC\u662f\u57fa\u4e8eSpring\u5f00\u53d1\u7684\uff0c\u5b83\u76f4\u63a5\u5229\u7528Spring\u63d0\u4f9b\u7684\u5bb9\u5668\u6765\u5b9e\u73b0\u5404\u79cd\u529f\u80fd\uff0c\u90a3\u4e48\u7b2c\u4e00\u6b65\u4f9d\u7136\u8ddf\u4e4b\u524d\u4e00\u6837\uff0c\u9700\u8981\u7f16\u5199\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n&lt;/beans&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u4e3aDispatcherServlet\u914d\u7f6e\u4e00\u4e9b\u521d\u59cb\u5316\u53c2\u6570\u6765\u6307\u5b9a\u521a\u521a\u521b\u5efa\u7684\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>&lt;servlet&gt;\n    &lt;servlet-name&gt;mvc&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;init-param&gt;\n        &lt;!--     \u6307\u5b9a\u6211\u4eec\u521a\u521a\u521b\u5efa\u5728\u7c7b\u8def\u5f84\u4e0b\u7684XML\u914d\u7f6e\u6587\u4ef6       --&gt;\n        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n        &lt;param-value&gt;classpath:application.xml&lt;/param-value&gt;\n    &lt;/init-param&gt;\n&lt;/servlet&gt;\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u57fa\u672c\u7684\u914d\u7f6e\uff0c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u6765\u6d4b\u8bd5\u4e00\u4e0b\u662f\u5426\u914d\u7f6e\u6b63\u786e\uff0c\u6211\u4eec\u5220\u9664\u9879\u76ee\u81ea\u5e26\u7684Servlet\u7c7b\uff0c\u521b\u5efa\u4e00\u4e2aMvc\u4e2d\u4f7f\u7528\u7684Controller\u7c7b\uff0c\u73b0\u5728\u8fd8\u6ca1\u5b66\u6ca1\u5173\u7cfb\uff0c\u8ddf\u7740\u5199\u5c31\u884c\u4e86\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u662f\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <pre><code>@Controller\npublic class HelloController {\n    @ResponseBody\n    @RequestMapping(\"/\")\n    public String hello(){\n        return \"HelloWorld!\";\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5c06\u8fd9\u4e2a\u7c7b\u6ce8\u518c\u4e3aBean\u624d\u80fd\u6b63\u5e38\u4f7f\u7528\uff0c\u6211\u4eec\u6765\u7f16\u5199\u4e00\u4e0bSpring\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u914d\u7f6e\u5305\u626b\u63cf\uff0cXML\u4e0b\u7684\u5305\u626b\u63cf\u9700\u8981\u8fd9\u6837\u5f00\u542f\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xmlns:context=\"http://www.springframework.org/schema/context\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd\"&gt;\n    &lt;!-- \u9700\u8981\u5148\u5f15\u5165context\u547d\u540d\u7a7a\u95f4\uff0c\u7136\u540e\u76f4\u63a5\u914d\u7f6ebase-package\u5c5e\u6027\u5c31\u53ef\u4ee5\u4e86 --&gt;\n    &lt;context:component-scan base-package=\"com.example\"/&gt;\n&lt;/beans&gt;\n</code></pre> <p>\u5982\u679c\u53ef\u4ee5\u6210\u529f\u5728\u6d4f\u89c8\u5668\u4e2d\u51fa\u73b0HelloWorld\u5219\u8bf4\u660e\u914d\u7f6e\u6210\u529f\uff1a</p> <p></p> <p>\u806a\u660e\u7684\u5c0f\u4f19\u4f34\u53ef\u80fd\u5df2\u7ecf\u53d1\u73b0\u4e86\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u4e0a\u9762\u7f16\u5199\u7684Controller\u5c31\u662f\u8d1f\u8d23Servlet\u57fa\u672c\u529f\u80fd\u7684\uff0c\u6bd4\u5982\u8fd9\u91cc\u6211\u4eec\u8fd4\u56de\u7684\u662fHelloWorld\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u8bbf\u95ee\u8fd9\u4e2a\u5730\u5740\u7684\u65f6\u5019\uff0c\u7684\u5230\u7684\u5c31\u662f\u8fd9\u91cc\u8fd4\u56de\u7684\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u770b\u5230\u5199\u6cd5\u975e\u5e38\u7b80\u6d01\uff0c\u81f3\u4e8e\u8fd9\u662f\u600e\u4e48\u505a\u5230\u7684\u7684\uff0c\u600e\u4e48\u4f7f\u7528\uff0c\u6211\u4eec\u4f1a\u5728\u672c\u7ae0\u8fdb\u884c\u8be6\u7ec6\u4ecb\u7ecd\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#_2","title":"\u5168\u6ce8\u89e3\u914d\u7f6e\u5f62\u5f0f","text":"<p>\u5982\u679c\u4f60\u5e0c\u671b\u5b8c\u5b8c\u5168\u5168\u4e22\u5f03\u914d\u7f6e\u6587\u4ef6\uff0c\u4f7f\u7528\u7eaf\u6ce8\u89e3\u5f00\u53d1\uff0c\u53ef\u4ee5\u76f4\u63a5\u6dfb\u52a0\u4e00\u4e2a\u7c7b\uff0cTomcat\u4f1a\u5728\u7c7b\u8def\u5f84\u4e2d\u67e5\u627e\u5b9e\u73b0ServletContainerInitializer \u63a5\u53e3\u7684\u7c7b\uff0c\u5982\u679c\u53d1\u73b0\u7684\u8bdd\uff0c\u5c31\u7528\u5b83\u6765\u914d\u7f6eServlet\u5bb9\u5668\uff0cSpring\u63d0\u4f9b\u4e86\u8fd9\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b SpringServletContainerInitializer , \u901a\u8fc7@HandlesTypes(WebApplicationInitializer.class)\u8bbe\u7f6e\uff0c\u8fd9\u4e2a\u7c7b\u53cd\u8fc7\u6765\u4f1a\u67e5\u627e\u5b9e\u73b0WebApplicationInitializer \u7684\u7c7b\uff0c\u5e76\u5c06\u914d\u7f6e\u7684\u4efb\u52a1\u4ea4\u7ed9\u4ed6\u4eec\u6765\u5b8c\u6210\uff0c\u56e0\u6b64\u76f4\u63a5\u5b9e\u73b0\u63a5\u53e3\u5373\u53ef\uff1a</p> <pre><code>public class MainInitializer extends AbstractAnnotationConfigDispatcherServletInitializer {\n\n    @Override\n    protected Class&lt;?&gt;[] getRootConfigClasses() {\n        return new Class[]{WebConfiguration.class};   //\u57fa\u672c\u7684Spring\u914d\u7f6e\u7c7b\uff0c\u4e00\u822c\u7528\u4e8e\u4e1a\u52a1\u5c42\u914d\u7f6e\n    }\n\n    @Override\n    protected Class&lt;?&gt;[] getServletConfigClasses() {\n        return new Class[0];  //\u914d\u7f6eDispatcherServlet\u7684\u914d\u7f6e\u7c7b\u3001\u4e3b\u8981\u7528\u4e8eController\u7b49\u914d\u7f6e\uff0c\u8fd9\u91cc\u4e3a\u4e86\u6559\u5b66\u7b80\u5355\uff0c\u5c31\u4e0d\u5206\u8fd9\u4e48\u8be6\u7ec6\u4e86\uff0c\u53ea\u4f7f\u7528\u4e0a\u9762\u7684\u57fa\u672c\u914d\u7f6e\u7c7b\n    }\n\n    @Override\n    protected String[] getServletMappings() {\n        return new String[]{\"/\"};    //\u5339\u914d\u8def\u5f84\uff0c\u4e0e\u4e0a\u9762\u4e00\u81f4\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u518d\u914d\u7f6e\u7c7b\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u5fc5\u8981\u7684\u6ce8\u89e3\uff1a</p> <pre><code>@Configuration\n@EnableWebMvc   //\u5feb\u901f\u914d\u7f6eSpringMvc\u6ce8\u89e3\uff0c\u5982\u679c\u4e0d\u6dfb\u52a0\u6b64\u6ce8\u89e3\u4f1a\u5bfc\u81f4\u540e\u7eed\u65e0\u6cd5\u901a\u8fc7\u5b9e\u73b0WebMvcConfigurer\u63a5\u53e3\u8fdb\u884c\u81ea\u5b9a\u4e49\u914d\u7f6e\n@ComponentScan(\"com.example.controller\")\npublic class WebConfiguration {\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u540c\u6837\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\uff1a</p> <p></p> <p>\u4e4b\u540e\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u5c31\u7edf\u4e00\u4f7f\u7528\u5168\u6ce8\u89e3\u5f62\u5f0f\u7f16\u5199\u3002</p> <p>\u5982\u679c\u65e5\u5fd7\u79d1\u6280\u6709\u62a5\u9519\u65e0\u6cd5\u663e\u793aMvc\u76f8\u5173\u7684\u65e5\u5fd7\uff0c\u8bf7\u6dfb\u52a0\u4ee5\u4e0b\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n      &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;\n      &lt;version&gt;1.7.33&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n      &lt;artifactId&gt;slf4j-jdk14&lt;/artifactId&gt;\n      &lt;version&gt;1.7.33&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6dfb\u52a0\u540e\u5c31\u53ef\u4ee5\u6b63\u5e38\u6253\u5370\u65e5\u5fd7\u4e86\uff1a</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#controller","title":"Controller\u63a7\u5236\u5668","text":"<p>\u6709\u4e86SpringMVC\u4e4b\u540e\uff0c\u6211\u4eec\u4e0d\u5fc5\u518d\u50cf\u4e4b\u524d\u90a3\u6837\u4e00\u4e2a\u8bf7\u6c42\u5730\u5740\u521b\u5efa\u4e00\u4e2aServlet\u4e86\uff0c\u5b83\u4f7f\u7528<code>DispatcherServlet</code>\u66ff\u4ee3Tomcat\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u9ed8\u8ba4\u7684\u9759\u6001\u8d44\u6e90Servlet\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u73b0\u5728\u6240\u6709\u7684\u8bf7\u6c42\uff08\u9664\u4e86jsp\uff0c\u56e0\u4e3aTomcat\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2ajsp\u7684Servlet\uff09\u90fd\u4f1a\u7ecf\u8fc7<code>DispatcherServlet</code>\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u90a3\u4e48<code>DispatcherServlet</code>\u4f1a\u5e2e\u52a9\u6211\u4eec\u505a\u4ec0\u4e48\u5462\uff1f</p> <p></p> <p>\u6839\u636e\u56fe\u7247\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\uff0c\u6211\u4eec\u7684\u8bf7\u6c42\u5230\u8fbeTomcat\u670d\u52a1\u5668\u4e4b\u540e\uff0c\u4f1a\u4ea4\u7ed9\u5f53\u524d\u7684Web\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u5904\u7406\uff0c\u800cSpringMVC\u4f7f\u7528<code>DispatcherServlet</code>\u6765\u5904\u7406\u6240\u6709\u7684\u8bf7\u6c42\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u88ab\u4f5c\u4e3a\u4e00\u4e2a\u7edf\u4e00\u7684\u8bbf\u95ee\u70b9\uff0c\u6240\u6709\u7684\u8bf7\u6c42\u5168\u90e8\u7531\u5b83\u6765\u8fdb\u884c\u8c03\u5ea6\u3002</p> <p>\u5f53\u4e00\u4e2a\u8bf7\u6c42\u7ecf\u8fc7<code>DispatcherServlet</code>\u4e4b\u540e\uff0c\u4f1a\u5148\u8d70<code>HandlerMapping</code>\uff0c\u5b83\u4f1a\u5c06\u8bf7\u6c42\u6620\u5c04\u4e3a<code>HandlerExecutionChain</code>\uff0c\u4f9d\u6b21\u7ecf\u8fc7<code>HandlerInterceptor</code>\u6709\u70b9\u7c7b\u4f3c\u4e8e\u4e4b\u524d\u6211\u4eec\u6240\u5b66\u7684\u8fc7\u6ee4\u5668\uff0c\u4e0d\u8fc7\u5728SpringMVC\u4e2d\u6211\u4eec\u4f7f\u7528\u7684\u662f\u62e6\u622a\u5668\uff0c\u7136\u540e\u518d\u4ea4\u7ed9<code>HandlerAdapter</code>\uff0c\u6839\u636e\u8bf7\u6c42\u7684\u8def\u5f84\u9009\u62e9\u5408\u9002\u7684\u63a7\u5236\u5668\u8fdb\u884c\u5904\u7406\uff0c\u63a7\u5236\u5668\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a<code>ModelAndView</code>\u5bf9\u8c61\uff0c\u5305\u62ec\u6570\u636e\u6a21\u578b\u548c\u89c6\u56fe\uff0c\u901a\u4fd7\u7684\u8bb2\u5c31\u662f\u9875\u9762\u4e2d\u6570\u636e\u548c\u9875\u9762\u672c\u8eab\uff08\u53ea\u5305\u542b\u89c6\u56fe\u540d\u79f0\u5373\u53ef\uff09\u3002</p> <p>\u8fd4\u56de<code>ModelAndView</code>\u4e4b\u540e\uff0c\u4f1a\u4ea4\u7ed9<code>ViewResolver</code>\uff08\u89c6\u56fe\u89e3\u6790\u5668\uff09\u8fdb\u884c\u5904\u7406\uff0c\u89c6\u56fe\u89e3\u6790\u5668\u4f1a\u5bf9\u6574\u4e2a\u89c6\u56fe\u9875\u9762\u8fdb\u884c\u89e3\u6790\uff0cSpringMVC\u81ea\u5e26\u4e86\u4e00\u4e9b\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u4f46\u662f\u53ea\u9002\u7528\u4e8eJSP\u9875\u9762\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u50cf\u4e4b\u524d\u4e00\u6837\u4f7f\u7528Thymeleaf\u4f5c\u4e3a\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u6839\u636e\u7ed9\u5b9a\u7684\u89c6\u56fe\u540d\u79f0\uff0c\u76f4\u63a5\u8bfb\u53d6HTML\u7f16\u5199\u7684\u9875\u9762\uff0c\u89e3\u6790\u4e3a\u4e00\u4e2a\u771f\u6b63\u7684View\u3002</p> <p>\u89e3\u6790\u5b8c\u6210\u540e\uff0c\u5c31\u9700\u8981\u5c06\u9875\u9762\u4e2d\u7684\u6570\u636e\u5168\u90e8\u6e32\u67d3\u5230View\u4e2d\uff0c\u6700\u540e\u8fd4\u56de\u7ed9<code>DispatcherServlet</code>\u4e00\u4e2a\u5305\u542b\u6240\u6709\u6570\u636e\u7684\u6210\u5f62\u9875\u9762\uff0c\u518d\u54cd\u5e94\u7ed9\u6d4f\u89c8\u5668\uff0c\u5b8c\u6210\u6574\u4e2a\u8fc7\u7a0b\u3002</p> <p>\u56e0\u6b64\uff0c\u5b9e\u9645\u4e0a\u6574\u4e2a\u8fc7\u7a0b\u6211\u4eec\u53ea\u9700\u8981\u7f16\u5199\u5bf9\u5e94\u8bf7\u6c42\u8def\u5f84\u7684\u7684Controller\u4ee5\u53ca\u914d\u7f6e\u597d\u6211\u4eec\u9700\u8981\u7684ViewResolver\u5373\u53ef\uff0c\u4e4b\u540e\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8865\u5145\u6dfb\u52a0\u62e6\u622a\u5668\uff0c\u800c\u5176\u4ed6\u7684\u6d41\u7a0b\u5df2\u7ecf\u7531SpringMVC\u5e2e\u52a9\u6211\u4eec\u5b8c\u6210\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#_3","title":"\u914d\u7f6e\u89c6\u56fe\u89e3\u6790\u5668\u548c\u63a7\u5236\u5668","text":"<p>\u9996\u5148\u6211\u4eec\u9700\u8981\u5b9e\u73b0\u6700\u57fa\u672c\u7684\u9875\u9762\u89e3\u6790\u5e76\u8fd4\u56de\uff0c\u7b2c\u4e00\u6b65\u5c31\u662f\u914d\u7f6e\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528Thymeleaf\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u5bfc\u5165\u9700\u8981\u7684\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.thymeleaf&lt;/groupId&gt;\n    &lt;artifactId&gt;thymeleaf-spring6&lt;/artifactId&gt;\n    &lt;version&gt;3.1.1.RELEASE&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u914d\u7f6e\u89c6\u56fe\u89e3\u6790\u5668\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5c06\u5bf9\u5e94\u7684<code>ViewResolver</code>\u6ce8\u518c\u4e3aBean\u5373\u53ef\uff0c\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u5728\u914d\u7f6e\u7c7b\u4e2d\u7f16\u5199\uff1a</p> <pre><code>@Configuration\n@EnableWebMvc\n@ComponentScan(\"com.example.controller\")\npublic class WebConfiguration {\n    //\u6211\u4eec\u9700\u8981\u4f7f\u7528ThymeleafViewResolver\u4f5c\u4e3a\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u5e76\u89e3\u6790\u6211\u4eec\u7684HTML\u9875\u9762\n    @Bean\n    public ThymeleafViewResolver thymeleafViewResolver(SpringTemplateEngine springTemplateEngine){\n        ThymeleafViewResolver resolver = new ThymeleafViewResolver();\n        resolver.setOrder(1);   //\u53ef\u4ee5\u5b58\u5728\u591a\u4e2a\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u5e76\u4e14\u53ef\u4ee5\u4e3a\u4ed6\u4eec\u8bbe\u5b9a\u89e3\u6790\u987a\u5e8f\n        resolver.setCharacterEncoding(\"UTF-8\");   //\u7f16\u7801\u683c\u5f0f\u662f\u91cd\u4e2d\u4e4b\u91cd\n        resolver.setTemplateEngine(springTemplateEngine);   //\u548c\u4e4b\u524dJavaWeb\u9636\u6bb5\u4e00\u6837\uff0c\u9700\u8981\u4f7f\u7528\u6a21\u677f\u5f15\u64ce\u8fdb\u884c\u89e3\u6790\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e5f\u9700\u8981\u8bbe\u5b9a\u4e00\u4e0b\u6a21\u677f\u5f15\u64ce\n        return resolver;\n    }\n\n    //\u914d\u7f6e\u6a21\u677f\u89e3\u6790\u5668\n    @Bean\n    public SpringResourceTemplateResolver templateResolver(){\n        SpringResourceTemplateResolver resolver = new SpringResourceTemplateResolver();\n        resolver.setSuffix(\".html\");   //\u9700\u8981\u89e3\u6790\u7684\u540e\u7f00\u540d\u79f0\n        resolver.setPrefix(\"classpath:/\");   //\u9700\u8981\u89e3\u6790\u7684HTML\u9875\u9762\u6587\u4ef6\u5b58\u653e\u7684\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u662fwebapp\u76ee\u5f55\u4e0b\uff0c\u5982\u679c\u662f\u7c7b\u8def\u5f84\u4e0b\u9700\u8981\u6dfb\u52a0classpath:\u524d\u7f00\n        return resolver;\n    }\n\n    //\u914d\u7f6e\u6a21\u677f\u5f15\u64ceBean\n    @Bean\n    public SpringTemplateEngine springTemplateEngine(ITemplateResolver resolver){\n        SpringTemplateEngine engine = new SpringTemplateEngine();\n        engine.setTemplateResolver(resolver);   //\u6a21\u677f\u89e3\u6790\u5668\uff0c\u9ed8\u8ba4\u5373\u53ef\n        return engine;\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u89c6\u56fe\u89e3\u6790\u5668\u7684\u914d\u7f6e\uff0c\u6211\u4eec\u63a5\u7740\u6765\u521b\u5efa\u4e00\u4e2aController\uff0c\u521b\u5efaController\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u9700\u5728\u4e00\u4e2a\u7c7b\u4e0a\u6dfb\u52a0\u4e00\u4e2a<code>@Controller</code>\u6ce8\u89e3\u5373\u53ef\uff0c\u5b83\u4f1a\u88abSpring\u626b\u63cf\u5e76\u81ea\u52a8\u6ce8\u518c\u4e3aController\u7c7b\u578b\u7684Bean\uff0c\u7136\u540e\u6211\u4eec\u53ea\u9700\u8981\u5728\u7c7b\u4e2d\u7f16\u5199\u65b9\u6cd5\u7528\u4e8e\u5904\u7406\u5bf9\u5e94\u5730\u5740\u7684\u8bf7\u6c42\u5373\u53ef\uff1a</p> <pre><code>@Controller   //\u76f4\u63a5\u6dfb\u52a0\u6ce8\u89e3\u5373\u53ef\npublic class HelloController {\n\n    @RequestMapping(\"/index\")   //\u76f4\u63a5\u586b\u5199\u8bbf\u95ee\u8def\u5f84\n    public ModelAndView index(){\n        return new ModelAndView(\"index\");  //\u8fd4\u56deModelAndView\u5bf9\u8c61\uff0c\u8fd9\u91cc\u586b\u5165\u4e86\u89c6\u56fe\u7684\u540d\u79f0\n        //\u8fd4\u56de\u540e\u4f1a\u7ecf\u8fc7\u89c6\u56fe\u89e3\u6790\u5668\u8fdb\u884c\u5904\u7406\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728\u7c7b\u8def\u5f84\u6839\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u7b80\u5355html\u6587\u4ef6\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u6d4b\u8bd5&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;p&gt;\u6b22\u8fce\u6765\u5230GayHub\u5168\u7403\u6700\u5927\u540c\u6027\u4ea4\u53cb\u7f51\u7ad9&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u6253\u5f00\u6d4f\u89c8\u5668\u4e4b\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u6211\u4eec\u7684HTML\u9875\u9762\u4e86\uff1a</p> <p></p> <p>\u6211\u4eec\u5728\u4e4b\u524d\uff0c\u4f7f\u7528Thymeleaf\u89e3\u6790\u540e\u7aef\u7684\u4e00\u4e9b\u6570\u636e\u65f6\uff0c\u9700\u8981\u901a\u8fc7Context\u8fdb\u884c\u4f20\u9012\uff0c\u800c\u4f7f\u7528SpringMvc\u540e\uff0c\u6570\u636e\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5411Model\u6a21\u578b\u5c42\u8fdb\u884c\u63d0\u4f9b\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(){\n    ModelAndView modelAndView = new ModelAndView(\"index\");\n    modelAndView.getModel().put(\"name\", \"\u554a\u8fd9\");   //\u5c06name\u4f20\u9012\u7ed9Model\n    return modelAndView;\n}\n</code></pre> <p>\u8fd9\u6837Thymeleaf\u5c31\u80fd\u6536\u5230\u6211\u4eec\u4f20\u9012\u7684\u6570\u636e\u8fdb\u884c\u89e3\u6790\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\" xmlns:th=\"http://www.thymeleaf.org\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;script src=\"static/test.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    HelloWorld\uff01\n    &lt;div th:text=\"${name}\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u5f53\u7136\uff0c\u4e3a\u4e86\u7b80\u4fbf\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56deView\u540d\u79f0\uff0cSpringMVC\u4f1a\u5c06\u5176\u81ea\u52a8\u5305\u88c5\u4e3aModelAndView\u5bf9\u8c61\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic String index(){\n    return \"index\";\n}\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5355\u72ec\u6dfb\u52a0\u4e00\u4e2aModel\u4f5c\u4e3a\u5f62\u53c2\u8fdb\u884c\u8bbe\u7f6e\uff0cSpringMVC\u901a\u8fc7\u4f9d\u8d56\u6ce8\u5165\u4f1a\u81ea\u52a8\u5e2e\u52a9\u6211\u4eec\u4f20\u9012\u5b9e\u4f8b\u5bf9\u8c61\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic String index(Model model){  //\u8fd9\u91cc\u4e0d\u4ec5\u4ec5\u53ef\u4ee5\u662fModel\uff0c\u8fd8\u53ef\u4ee5\u662fMap\u3001ModelMap\n    model.addAttribute(\"name\", \"yyds\");\n    return \"index\";\n}\n</code></pre> <p>\u6709\u4e86Spring\u6846\u67b6\u7684\u52a0\u6301\uff0c\u76f8\u6bd4\u6211\u4eec\u4e4b\u524d\u7f16\u5199\u7684Web\u5e94\u7528\u7a0b\u5e8f\uff0c\u7b80\u76f4\u65b9\u4fbf\u4e86\u4e00\u4e2a\u5c42\u6b21\uff0c\u4f60\u5c31\u8bf4\u4f60\u7231\u4e0d\u7231\u5427\uff0c\u4f60\u7231\u4e0d\u7231\u3002</p> <p>\u6ce8\u610f\uff0c\u4e00\u5b9a\u8981\u4fdd\u8bc1\u89c6\u56fe\u540d\u79f0\u4e0b\u9762\u51fa\u73b0\u6a2a\u7ebf\u5e76\u4e14\u6309\u4f4fCtrl\u53ef\u4ee5\u8df3\u8f6c\uff0c\u914d\u7f6e\u624d\u662f\u6b63\u786e\u7684\uff08\u6700\u65b0\u7248IDEA\uff09</p> <p>\u6211\u4eec\u7684\u9875\u9762\u4e2d\u53ef\u80fd\u8fd8\u4f1a\u5305\u542b\u4e00\u4e9b\u9759\u6001\u8d44\u6e90\uff0c\u6bd4\u5982js\u3001css\uff0c\u56e0\u6b64\u8fd9\u91cc\u6211\u4eec\u8fd8\u9700\u8981\u914d\u7f6e\u4e00\u4e0b\uff0c\u8ba9\u9759\u6001\u8d44\u6e90\u901a\u8fc7Tomcat\u63d0\u4f9b\u7684\u9ed8\u8ba4Servlet\u8fdb\u884c\u89e3\u6790\uff0c\u6211\u4eec\u9700\u8981\u8ba9\u914d\u7f6e\u7c7b\u5b9e\u73b0\u4e00\u4e0b<code>WebMvcConfigurer</code>\u63a5\u53e3\uff0c\u8fd9\u6837\u5728Web\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u65f6\uff0c\u4f1a\u6839\u636e\u6211\u4eec\u91cd\u5199\u65b9\u6cd5\u91cc\u9762\u7684\u5185\u5bb9\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u914d\u7f6e\uff1a</p> <pre><code>@Override\npublic void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {\n    configurer.enable();   //\u5f00\u542f\u9ed8\u8ba4\u7684Servlet\n}\n\n@Override\npublic void addResourceHandlers(ResourceHandlerRegistry registry) {\n    registry.addResourceHandler(\"/static/**\").addResourceLocations(\"/static/\");\n    //\u914d\u7f6e\u9759\u6001\u8d44\u6e90\u7684\u8bbf\u95ee\u8def\u5f84\n}\n</code></pre> <p>\u6211\u4eec\u7f16\u5199\u4e00\u4e0b\u524d\u7aef\u5185\u5bb9\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\" xmlns:th=\"http://www.thymeleaf.org\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u6d4b\u8bd5&lt;/title&gt;\n    &lt;!-- \u5f15\u7528\u9759\u6001\u8d44\u6e90\uff0c\u8fd9\u91cc\u4f7f\u7528Thymeleaf\u7684\u7f51\u5740\u94fe\u63a5\u8868\u8fbe\u5f0f\uff0cThymeleaf\u4f1a\u81ea\u52a8\u6dfb\u52a0web\u5e94\u7528\u7a0b\u5e8f\u7684\u540d\u79f0\u5230\u94fe\u63a5\u524d\u9762 --&gt;\n    &lt;script th:src=\"@{/static/test.js}\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;p&gt;\u6b22\u8fce\u6765\u5230GayHub\u5168\u7403\u6700\u5927\u540c\u6027\u4ea4\u53cb\u7f51\u7ad9&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u521b\u5efa<code>test.js</code>\u5e76\u7f16\u5199\u5982\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>window.alert(\"\u6b22\u8fce\u6765\u5230GayHub\u5168\u7403\u6700\u5927\u540c\u6027\u4ea4\u53cb\u7f51\u7ad9\")\n</code></pre> <p>\u6700\u540e\u8bbf\u95ee\u9875\u9762\uff0c\u9875\u9762\u5728\u52a0\u8f7d\u65f6\u5c31\u4f1a\u663e\u793a\u4e00\u4e2a\u5f39\u7a97\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u6700\u57fa\u672c\u7684\u9875\u9762\u914d\u7f6e\u3002\u76f8\u6bd4\u4e4b\u524d\u7684\u65b9\u5f0f\uff0c\u8fd9\u6837\u5c31\u7b80\u5355\u5f88\u591a\u4e86\uff0c\u76f4\u63a5\u907f\u514d\u4e86\u7f16\u5199\u5927\u91cf\u7684Servlet\u6765\u5904\u7406\u8bf7\u6c42\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#requestmapping","title":"@RequestMapping\u8be6\u89e3","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u5982\u4f55\u521b\u5efa\u4e00\u4e2a\u63a7\u5236\u5668\u6765\u5904\u7406\u6211\u4eec\u7684\u8bf7\u6c42\uff0c\u63a5\u7740\u6211\u4eec\u53ea\u9700\u8981\u5728\u63a7\u5236\u5668\u6dfb\u52a0\u4e00\u4e2a\u65b9\u6cd5\u7528\u4e8e\u5904\u7406\u5bf9\u5e94\u7684\u8bf7\u6c42\u5373\u53ef\uff0c\u4e4b\u524d\u6211\u4eec\u9700\u8981\u5b8c\u6574\u5730\u7f16\u5199\u4e00\u4e2aServlet\u6765\u5b9e\u73b0\uff0c\u800c\u73b0\u5728\u6211\u4eec\u53ea\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a<code>@RequestMapping</code>\u5373\u53ef\u5b9e\u73b0\uff0c\u5176\u5b9e\u4ece\u5b83\u7684\u540d\u5b57\u6211\u4eec\u4e5f\u80fd\u5f97\u77e5\uff0c\u6b64\u6ce8\u89e3\u5c31\u662f\u5c06\u8bf7\u6c42\u548c\u5904\u7406\u8bf7\u6c42\u7684\u65b9\u6cd5\u5efa\u7acb\u4e00\u4e2a\u6620\u5c04\u5173\u7cfb\uff0c\u5f53\u6536\u5230\u8bf7\u6c42\u65f6\u5c31\u53ef\u4ee5\u6839\u636e\u6620\u5c04\u5173\u7cfb\u8c03\u7528\u5bf9\u5e94\u7684\u8bf7\u6c42\u5904\u7406\u65b9\u6cd5\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6765\u5148\u804a\u804a<code>@RequestMapping</code>\u5427\uff0c\u6ce8\u89e3\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>@Mapping\npublic @interface RequestMapping {\n    String name() default \"\";\n\n    @AliasFor(\"path\")\n    String[] value() default {};\n\n    @AliasFor(\"value\")\n    String[] path() default {};\n\n    RequestMethod[] method() default {};\n\n    String[] params() default {};\n\n    String[] headers() default {};\n\n    String[] consumes() default {};\n\n    String[] produces() default {};\n}\n</code></pre> <p>\u5176\u4e2d\u6700\u5173\u952e\u7684\u662fpath\u5c5e\u6027\uff08\u7b49\u4ef7\u4e8evalue\uff09\uff0c\u5b83\u51b3\u5b9a\u4e86\u5f53\u524d\u65b9\u6cd5\u5904\u7406\u7684\u8bf7\u6c42\u8def\u5f84\uff0c\u6ce8\u610f\u8def\u5f84\u5fc5\u987b\u5168\u5c40\u552f\u4e00\uff0c\u4efb\u4f55\u8def\u5f84\u53ea\u80fd\u6709\u4e00\u4e2a\u65b9\u6cd5\u8fdb\u884c\u5904\u7406\uff0c\u5b83\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u4e5f\u5c31\u662f\u8bf4\u6b64\u65b9\u6cd5\u4e0d\u4ec5\u4ec5\u53ef\u4ee5\u53ea\u7528\u4e8e\u5904\u7406\u67d0\u4e00\u4e2a\u8bf7\u6c42\u8def\u5f84\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u5904\u7406\u591a\u4e2a\u8bf7\u6c42\u8def\u5f84\uff1a</p> <pre><code>@RequestMapping({\"/index\", \"/test\"})\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u8bbf\u95ee/index\u6216\u662f/test\u90fd\u4f1a\u7ecf\u8fc7\u6b64\u65b9\u6cd5\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5c06<code>@RequestMapping</code>\u6dfb\u52a0\u5230\u7c7b\u540d\u4e0a\uff0c\u8868\u793a\u4e3a\u6b64\u7c7b\u4e2d\u7684\u6240\u6709\u8bf7\u6c42\u6620\u5c04\u6dfb\u52a0\u4e00\u4e2a\u8def\u5f84\u524d\u7f00\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@Controller\n@RequestMapping(\"/yyds\")\npublic class MainController {\n\n    @RequestMapping({\"/index\", \"/test\"})\n    public ModelAndView index(){\n        return new ModelAndView(\"index\");\n    }\n}\n</code></pre> <p>\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u9700\u8981\u8bbf\u95ee<code>/yyds/index</code>\u6216\u662f<code>/yyds/test</code>\u624d\u53ef\u4ee5\u5f97\u5230\u6b64\u9875\u9762\u3002\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728IDEA\u4e0b\u65b9\u7684\u7aef\u70b9\u677f\u5757\u4e2d\u67e5\u770b\u5f53\u524dWeb\u5e94\u7528\u7a0b\u5e8f\u5b9a\u4e49\u7684\u6240\u6709\u8bf7\u6c42\u6620\u5c04\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7IDEA\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u5185\u7f6eWeb\u5ba2\u6237\u7aef\u76f4\u63a5\u8bbf\u95ee\u67d0\u4e2a\u8def\u5f84\u3002</p> <p>\u8def\u5f84\u8fd8\u652f\u6301\u4f7f\u7528\u901a\u914d\u7b26\u8fdb\u884c\u5339\u914d\uff1a</p> <ul> <li>?\uff1a\u8868\u793a\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff0c\u6bd4\u5982<code>@RequestMapping(\"/index/x?\")</code>\u53ef\u4ee5\u5339\u914d/index/xa\u3001/index/xb\u7b49\u7b49\u3002</li> <li>*\uff1a\u8868\u793a\u4efb\u610f0-n\u4e2a\u5b57\u7b26\uff0c\u6bd4\u5982<code>@RequestMapping(\"/index/*\")</code>\u53ef\u4ee5\u5339\u914d/index/lbwnb\u3001/index/yyds\u7b49\u3002</li> <li>**\uff1a\u8868\u793a\u5f53\u524d\u76ee\u5f55\u6216\u57fa\u4e8e\u5f53\u524d\u76ee\u5f55\u7684\u591a\u7ea7\u76ee\u5f55\uff0c\u6bd4\u5982<code>@RequestMapping(\"/index/**\")</code>\u53ef\u4ee5\u5339\u914d/index\u3001/index/xxx\u7b49\u3002</li> </ul> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u4e0b\u4e00\u4e2amethod\u5c5e\u6027\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5b83\u5c31\u662f\u8bf7\u6c42\u7684\u65b9\u6cd5\u7c7b\u578b\uff0c\u6211\u4eec\u53ef\u4ee5\u9650\u5b9a\u8bf7\u6c42\u65b9\u5f0f\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", method = RequestMethod.POST)\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5982\u679c\u76f4\u63a5\u4f7f\u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u6b64\u9875\u9762\uff0c\u4f1a\u663e\u793a405\u65b9\u6cd5\u4e0d\u652f\u6301\uff0c\u56e0\u4e3a\u6d4f\u89c8\u5668\u9ed8\u8ba4\u662f\u76f4\u63a5\u4f7f\u7528GET\u65b9\u6cd5\u83b7\u53d6\u9875\u9762\uff0c\u800c\u6211\u4eec\u8fd9\u91cc\u6307\u5b9a\u4e3aPOST\u65b9\u6cd5\u8bbf\u95ee\u6b64\u5730\u5740\uff0c\u6240\u4ee5\u8bbf\u95ee\u5931\u8d25\uff0c\u6211\u4eec\u73b0\u5728\u518d\u53bb\u7aef\u70b9\u4e2d\u7528POST\u65b9\u5f0f\u53bb\u8bbf\u95ee\uff0c\u6210\u529f\u5f97\u5230\u9875\u9762\u3002</p> <p></p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u884d\u751f\u6ce8\u89e3\u76f4\u63a5\u8bbe\u5b9a\u4e3a\u6307\u5b9a\u7c7b\u578b\u7684\u8bf7\u6c42\u6620\u5c04\uff1a</p> <pre><code>@PostMapping(value = \"/index\")\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u8fd9\u91cc\u4f7f\u7528\u4e86<code>@PostMapping</code>\u76f4\u63a5\u6307\u5b9a\u4e3aPOST\u8bf7\u6c42\u7c7b\u578b\u7684\u8bf7\u6c42\u6620\u5c04\uff0c\u540c\u6837\u7684\uff0c\u8fd8\u6709<code>@GetMapping</code>\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9a\u4e3aGET\u8bf7\u6c42\u65b9\u5f0f\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e\u4e86\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>params</code>\u5c5e\u6027\u6765\u6307\u5b9a\u8bf7\u6c42\u5fc5\u987b\u643a\u5e26\u54ea\u4e9b\u8bf7\u6c42\u53c2\u6570\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", params = {\"username\", \"password\"})\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6bd4\u5982\u8fd9\u91cc\u6211\u4eec\u8981\u6c42\u8bf7\u6c42\u4e2d\u5fc5\u987b\u643a\u5e26<code>username</code>\u548c<code>password</code>\u5c5e\u6027\uff0c\u5426\u5219\u65e0\u6cd5\u8bbf\u95ee\u3002\u5b83\u8fd8\u652f\u6301\u8868\u8fbe\u5f0f\uff0c\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u7f16\u5199\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", params = {\"!username\", \"password\"})\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u5728username\u4e4b\u524d\u6dfb\u52a0\u4e00\u4e2a\u611f\u53f9\u53f7\u8868\u793a\u8bf7\u6c42\u7684\u4e0d\u5141\u8bb8\u643a\u5e26\u6b64\u53c2\u6570\uff0c\u5426\u5219\u65e0\u6cd5\u8bbf\u95ee\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u8bbe\u5b9a\u4e00\u4e2a\u56fa\u5b9a\u503c\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", params = {\"username!=test\", \"password=123\"})\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u8bf7\u6c42\u53c2\u6570username\u4e0d\u5141\u8bb8\u4e3atest\uff0c\u5e76\u4e14password\u5fc5\u987b\u4e3a123\uff0c\u5426\u5219\u65e0\u6cd5\u8bbf\u95ee\u3002</p> <p><code>header</code>\u5c5e\u6027\u7528\u6cd5\u4e0e<code>params</code>\u4e00\u81f4\uff0c\u4f46\u662f\u5b83\u8981\u6c42\u7684\u662f\u8bf7\u6c42\u5934\u4e2d\u9700\u8981\u643a\u5e26\u4ec0\u4e48\u5185\u5bb9\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", headers = \"!Connection\")\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u90a3\u4e48\uff0c\u5982\u679c\u8bf7\u6c42\u5934\u4e2d\u643a\u5e26\u4e86<code>Connection</code>\u5c5e\u6027\uff0c\u5c06\u65e0\u6cd5\u8bbf\u95ee\u3002\u5176\u4ed6\u4e24\u4e2a\u5c5e\u6027\uff1a</p> <ul> <li>consumes\uff1a \u6307\u5b9a\u5904\u7406\u8bf7\u6c42\u7684\u63d0\u4ea4\u5185\u5bb9\u7c7b\u578b\uff08Content-Type\uff09\uff0c\u4f8b\u5982application/json, text/html;</li> <li>produces:  \u6307\u5b9a\u8fd4\u56de\u7684\u5185\u5bb9\u7c7b\u578b\uff0c\u4ec5\u5f53request\u8bf7\u6c42\u5934\u4e2d\u7684(Accept)\u7c7b\u578b\u4e2d\u5305\u542b\u8be5\u6307\u5b9a\u7c7b\u578b\u624d\u8fd4\u56de\uff1b</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#requestparamrequestheader","title":"@RequestParam\u548c@RequestHeader\u8be6\u89e3","text":"<p>\u6211\u4eec\u63a5\u7740\u6765\u770b\uff0c\u5982\u4f55\u83b7\u53d6\u5230\u8bf7\u6c42\u4e2d\u7684\u53c2\u6570\u3002</p> <p>\u6211\u4eec\u53ea\u9700\u8981\u4e3a\u65b9\u6cd5\u6dfb\u52a0\u4e00\u4e2a\u5f62\u5f0f\u53c2\u6570\uff0c\u5e76\u5728\u5f62\u5f0f\u53c2\u6570\u524d\u9762\u6dfb\u52a0<code>@RequestParam</code>\u6ce8\u89e3\u5373\u53ef\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(@RequestParam(\"username\") String username){\n    System.out.println(\"\u63a5\u53d7\u5230\u8bf7\u6c42\u53c2\u6570\uff1a\"+username);\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6211\u4eec\u9700\u8981\u5728<code>@RequestParam</code>\u4e2d\u586b\u5199\u53c2\u6570\u540d\u79f0\uff0c\u53c2\u6570\u7684\u503c\u4f1a\u81ea\u52a8\u4f20\u9012\u7ed9\u5f62\u5f0f\u53c2\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u65b9\u6cd5\u4e2d\u4f7f\u7528\uff0c\u6ce8\u610f\uff0c\u5982\u679c\u53c2\u6570\u540d\u79f0\u4e0e\u5f62\u5f0f\u53c2\u6570\u540d\u79f0\u76f8\u540c\uff0c\u5373\u4f7f\u4e0d\u6dfb\u52a0<code>@RequestParam</code>\u4e5f\u80fd\u83b7\u53d6\u5230\u53c2\u6570\u503c\u3002</p> <p>\u4e00\u65e6\u6dfb\u52a0<code>@RequestParam</code>\uff0c\u90a3\u4e48\u6b64\u8bf7\u6c42\u5fc5\u987b\u643a\u5e26\u6307\u5b9a\u53c2\u6570\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06require\u5c5e\u6027\u8bbe\u5b9a\u4e3afalse\u6765\u5c06\u5c5e\u6027\u8bbe\u5b9a\u4e3a\u975e\u5fc5\u987b\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(@RequestParam(value = \"username\", required = false) String username){\n    System.out.println(\"\u63a5\u53d7\u5230\u8bf7\u6c42\u53c2\u6570\uff1a\"+username);\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u76f4\u63a5\u8bbe\u5b9a\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u5f53\u8bf7\u6c42\u53c2\u6570\u7f3a\u5931\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u9ed8\u8ba4\u503c\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(@RequestParam(value = \"username\", required = false, defaultValue = \"\u4f1e\u5175\u4e00\u53f7\") String username){\n    System.out.println(\"\u63a5\u53d7\u5230\u8bf7\u6c42\u53c2\u6570\uff1a\"+username);\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u5982\u679c\u9700\u8981\u4f7f\u7528Servlet\u539f\u672c\u7684\u4e00\u4e9b\u7c7b\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(HttpServletRequest request){\n    System.out.println(\"\u63a5\u53d7\u5230\u8bf7\u6c42\u53c2\u6570\uff1a\"+request.getParameterMap().keySet());\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u76f4\u63a5\u6dfb\u52a0<code>HttpServletRequest</code>\u4e3a\u5f62\u5f0f\u53c2\u6570\u5373\u53ef\uff0cSpringMVC\u4f1a\u81ea\u52a8\u4f20\u9012\u8be5\u8bf7\u6c42\u539f\u672c\u7684<code>HttpServletRequest</code>\u5bf9\u8c61\uff0c\u540c\u7406\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6dfb\u52a0<code>HttpServletResponse</code>\u4f5c\u4e3a\u5f62\u5f0f\u53c2\u6570\uff0c\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u5c06HttpSession\u4e5f\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(HttpSession session){\n    System.out.println(session.getAttribute(\"test\"));\n    session.setAttribute(\"test\", \"\u9e21\u4f60\u592a\u7f8e\");\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u76f4\u63a5\u5c06\u8bf7\u6c42\u53c2\u6570\u4f20\u9012\u7ed9\u4e00\u4e2a\u5b9e\u4f53\u7c7b\uff1a</p> <pre><code>@Data\npublic class User {\n    String username;\n    String password;\n}\n</code></pre> <p>\u6ce8\u610f\u5fc5\u987b\u643a\u5e26set\u65b9\u6cd5\u6216\u662f\u6784\u9020\u65b9\u6cd5\u4e2d\u5305\u542b\u6240\u6709\u53c2\u6570\uff0c\u8bf7\u6c42\u53c2\u6570\u4f1a\u81ea\u52a8\u6839\u636e\u7c7b\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\u8fdb\u884c\u5339\u914d\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(User user){\n    System.out.println(\"\u83b7\u53d6\u5230cookie\u503c\u4e3a\uff1a\"+user);\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p><code>@RequestHeader</code>\u4e0e<code>@RequestParam</code>\u7528\u6cd5\u4e00\u81f4\uff0c\u4e0d\u8fc7\u5b83\u662f\u7528\u4e8e\u83b7\u53d6\u8bf7\u6c42\u5934\u53c2\u6570\u7684\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u6f14\u793a\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#cookievaluesessionattrbutie","title":"@CookieValue\u548c@SessionAttrbutie","text":"<p>\u901a\u8fc7\u4f7f\u7528<code>@CookieValue</code>\u6ce8\u89e3\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5feb\u901f\u83b7\u53d6\u8bf7\u6c42\u643a\u5e26\u7684Cookie\u4fe1\u606f\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(HttpServletResponse response,\n                          @CookieValue(value = \"test\", required = false) String test){\n    System.out.println(\"\u83b7\u53d6\u5230cookie\u503c\u4e3a\uff1a\"+test);\n    response.addCookie(new Cookie(\"test\", \"lbwnb\"));\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u540c\u6837\u7684\uff0cSession\u4e5f\u80fd\u4f7f\u7528\u6ce8\u89e3\u5feb\u901f\u83b7\u53d6\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(@SessionAttribute(value = \"test\", required = false) String test,\n                          HttpSession session){\n    session.setAttribute(\"test\", \"xxxx\");\n    System.out.println(test);\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u53ef\u4ee5\u53d1\u73b0\uff0c\u901a\u8fc7\u4f7f\u7528SpringMVC\u6846\u67b6\uff0c\u6574\u4e2aWeb\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u53d1\u53d8\u5f97\u975e\u5e38\u7b80\u5355\uff0c\u5927\u90e8\u5206\u529f\u80fd\u53ea\u9700\u8981\u4e00\u4e2a\u6ce8\u89e3\u5c31\u53ef\u4ee5\u641e\u5b9a\u4e86\uff0c\u6b63\u662f\u5f97\u76ca\u4e8eSpring\u6846\u67b6\uff0cSpringMVC\u624d\u80fd\u5927\u663e\u8eab\u624b\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#_4","title":"\u91cd\u5b9a\u5411\u548c\u8bf7\u6c42\u8f6c\u53d1","text":"<p>\u91cd\u5b9a\u5411\u548c\u8bf7\u6c42\u8f6c\u53d1\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u89c6\u56fe\u540d\u79f0\u524d\u9762\u6dfb\u52a0\u4e00\u4e2a\u524d\u7f00\u5373\u53ef\uff0c\u6bd4\u5982\u91cd\u5b9a\u5411\uff1a</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(){\n    return \"redirect:home\";\n}\n\n@RequestMapping(\"/home\")\npublic String home(){\n    return \"home\";\n}\n</code></pre> <p>\u901a\u8fc7\u6dfb\u52a0<code>redirect:</code>\u524d\u7f00\uff0c\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u5b9e\u73b0\u91cd\u5b9a\u5411\uff0c\u90a3\u4e48\u8bf7\u6c42\u8f6c\u53d1\u5462\uff0c\u5176\u5b9e\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u4f7f\u7528<code>forward:</code>\u524d\u7f00\u8868\u793a\u8f6c\u53d1\u7ed9\u5176\u4ed6\u8bf7\u6c42\u6620\u5c04\uff1a</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(){\n    return \"forward:home\";\n}\n\n@RequestMapping(\"/home\")\npublic String home(){\n    return \"home\";\n}\n</code></pre> <p>\u4f7f\u7528SpringMVC\uff0c\u53ea\u9700\u8981\u4e00\u4e2a\u524d\u7f00\u5c31\u53ef\u4ee5\u5b9e\u73b0\u91cd\u5b9a\u5411\u548c\u8bf7\u6c42\u8f6c\u53d1\uff0c\u975e\u5e38\u65b9\u4fbf\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#beanweb","title":"Bean\u7684Web\u4f5c\u7528\u57df","text":"<p>\u5728\u5b66\u4e60Spring\u65f6\u6211\u4eec\u8bb2\u89e3\u4e86Bean\u7684\u4f5c\u7528\u57df\uff0c\u5305\u62ec<code>singleton</code>\u548c<code>prototype</code>\uff0cBean\u5206\u522b\u4f1a\u4ee5\u5355\u4f8b\u548c\u591a\u4f8b\u6a21\u5f0f\u8fdb\u884c\u521b\u5efa\uff0c\u800c\u5728SpringMVC\u4e2d\uff0c\u5b83\u7684\u4f5c\u7528\u57df\u88ab\u7ee7\u7eed\u7ec6\u5206\uff1a</p> <ul> <li>request\uff1a\u5bf9\u4e8e\u6bcf\u6b21HTTP\u8bf7\u6c42\uff0c\u4f7f\u7528request\u4f5c\u7528\u57df\u5b9a\u4e49\u7684Bean\u90fd\u5c06\u4ea7\u751f\u4e00\u4e2a\u65b0\u5b9e\u4f8b\uff0c\u8bf7\u6c42\u7ed3\u675f\u540eBean\u4e5f\u6d88\u5931\u3002</li> <li>session\uff1a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u4f7f\u7528session\u4f5c\u7528\u57df\u5b9a\u4e49\u7684Bean\u90fd\u5c06\u4ea7\u751f\u4e00\u4e2a\u65b0\u5b9e\u4f8b\uff0c\u4f1a\u8bdd\u8fc7\u671f\u540eBean\u4e5f\u6d88\u5931\u3002</li> <li>global session\uff1a\u4e0d\u5e38\u7528\uff0c\u4e0d\u505a\u8bb2\u89e3\u3002</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7c7b\u6765\u8bd5\u8bd5\u770b\uff1a</p> <pre><code>public class TestBean {\n\n}\n</code></pre> <p>\u63a5\u7740\u5c06\u5176\u6ce8\u518c\u4e3aBean\uff0c\u6ce8\u610f\u8fd9\u91cc\u9700\u8981\u6dfb\u52a0<code>@RequestScope</code>\u6216\u662f<code>@SessionScope</code>\u8868\u793a\u6b64Bean\u7684Web\u4f5c\u7528\u57df\uff1a</p> <pre><code>@Bean\n@RequestScope\npublic TestBean testBean(){\n    return new TestBean();\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5c06\u5176\u81ea\u52a8\u6ce8\u5165\u5230Controller\u4e2d\uff1a</p> <pre><code>@Controller\npublic class MainController {\n\n    @Resource\n    TestBean bean;\n\n    @RequestMapping(value = \"/index\")\n    public ModelAndView index(){\n        System.out.println(bean);\n        return new ModelAndView(\"index\");\n    }\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u6b21\u53d1\u8d77\u5f97\u5230\u7684Bean\u5b9e\u4f8b\u90fd\u4e0d\u540c\uff0c\u63a5\u7740\u6211\u4eec\u5c06\u5176\u4f5c\u7528\u57df\u4fee\u6539\u4e3a<code>@SessionScope</code>\uff0c\u8fd9\u6837\u4f5c\u7528\u57df\u5c31\u4e0a\u5347\u5230Session\uff0c\u53ea\u8981\u6e05\u7406\u6d4f\u89c8\u5668\u7684Cookie\uff0c\u90a3\u4e48\u90fd\u4f1a\u88ab\u8ba4\u4e3a\u662f\u540c\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u53ea\u8981\u662f\u540c\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u90a3\u4e48Bean\u5b9e\u4f8b\u59cb\u7ec8\u4e0d\u53d8\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u5b83\u4e5f\u662f\u901a\u8fc7\u4ee3\u7406\u5b9e\u73b0\u7684\uff0c\u6211\u4eec\u8c03\u7528Bean\u4e2d\u7684\u65b9\u6cd5\u4f1a\u88ab\u8f6c\u53d1\u5230\u771f\u6b63\u7684Bean\u5bf9\u8c61\u53bb\u6267\u884c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#restful","title":"RestFul\u98ce\u683c","text":"<p>\u4e2d\u6587\u91ca\u4e49\u4e3a\u201c\u8868\u73b0\u5c42\u72b6\u6001\u8f6c\u6362\u201d\uff08\u540d\u5b57\u633a\u9ad8\u5927\u4e0a\u7684\uff09\uff0c\u5b83\u4e0d\u662f\u4e00\u79cd\u6807\u51c6\uff0c\u800c\u662f\u4e00\u79cd\u8bbe\u8ba1\u98ce\u683c\u3002\u5b83\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u5145\u5206\u5e76\u6b63\u786e\u5229\u7528HTTP\u534f\u8bae\u7684\u7279\u6027\uff0c\u89c4\u8303\u8d44\u6e90\u83b7\u53d6\u7684URI\u8def\u5f84\u3002\u901a\u4fd7\u7684\u8bb2\uff0cRESTful\u98ce\u683c\u7684\u8bbe\u8ba1\u5141\u8bb8\u5c06\u53c2\u6570\u901a\u8fc7URL\u62fc\u63a5\u4f20\u5230\u670d\u52a1\u7aef\uff0c\u76ee\u7684\u662f\u8ba9URL\u770b\u8d77\u6765\u66f4\u7b80\u6d01\u5b9e\u7528\uff0c\u5e76\u4e14\u6211\u4eec\u53ef\u4ee5\u5145\u5206\u4f7f\u7528\u591a\u79cdHTTP\u8bf7\u6c42\u65b9\u5f0f\uff08POST/GET/PUT/DELETE\uff09\uff0c\u6765\u6267\u884c\u76f8\u540c\u8bf7\u6c42\u5730\u5740\u7684\u4e0d\u540c\u7c7b\u578b\u64cd\u4f5c\u3002</p> <p>\u56e0\u6b64\uff0c\u8fd9\u79cd\u98ce\u683c\u7684\u8fde\u63a5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u4ece\u8bf7\u6c42\u8def\u5f84\u4e2d\u8bfb\u53d6\u53c2\u6570\uff0c\u6bd4\u5982\uff1a</p> <pre><code>http://localhost:8080/mvc/index/123456\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06index\u7684\u4e0b\u4e00\u7ea7\u8def\u5f84\u4f5c\u4e3a\u8bf7\u6c42\u53c2\u6570\u8fdb\u884c\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u8bf4\u73b0\u5728\u7684\u8bf7\u6c42\u53c2\u6570\u5305\u542b\u5728\u4e86\u8bf7\u6c42\u8def\u5f84\u4e2d\uff1a</p> <pre><code>@RequestMapping(\"/index/{str}\")\npublic String index(@PathVariable String str) {\n    System.out.println(str);\n    return \"index\";\n}\n</code></pre> <p>\u6ce8\u610f\u8bf7\u6c42\u8def\u5f84\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u6dfb\u52a0\u7c7b\u4f3c\u5360\u4f4d\u7b26\u4e00\u6837\u7684\u4fe1\u606f\uff0c\u8fd9\u6837\u5360\u4f4d\u7b26\u4f4d\u7f6e\u7684\u6240\u6709\u5185\u5bb9\u90fd\u4f1a\u88ab\u4f5c\u4e3a\u8bf7\u6c42\u53c2\u6570\uff0c\u800c\u65b9\u6cd5\u7684\u5f62\u53c2\u5217\u8868\u4e2d\u5fc5\u987b\u5305\u62ec\u4e00\u4e2a\u4e0e\u5360\u4f4d\u7b26\u540c\u540d\u7684\u5e76\u4e14\u6dfb\u52a0\u4e86<code>@PathVariable</code>\u6ce8\u89e3\u7684\u53c2\u6570\uff0c\u6216\u662f\u7531<code>@PathVariable</code>\u6ce8\u89e3\u6307\u5b9a\u4e3a\u5360\u4f4d\u7b26\u540d\u79f0\uff1a</p> <pre><code>@RequestMapping(\"/index/{str}\")\npublic String index(@PathVariable(\"str\") String text){\n    System.out.println(text);\n    return \"index\";\n}\n</code></pre> <p>\u5982\u679c\u6ca1\u6709\u914d\u7f6e\u6b63\u786e\uff0c\u65b9\u6cd5\u540d\u79f0\u4e0a\u4f1a\u51fa\u73b0\u9ec4\u7ebf\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u4e0d\u540c\u529f\u80fd\u8fdb\u884c\u5212\u5206\uff1a</p> <ul> <li>POST http://localhost:8080/mvc/index -  \u6dfb\u52a0\u7528\u6237\u4fe1\u606f\uff0c\u643a\u5e26\u8868\u5355\u6570\u636e</li> <li>GET http://localhost:8080/mvc/index/{id} -  \u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff0cid\u76f4\u63a5\u653e\u5728\u8bf7\u6c42\u8def\u5f84\u4e2d</li> <li>PUT http://localhost:8080/mvc/index -  \u4fee\u6539\u7528\u6237\u4fe1\u606f\uff0c\u643a\u5e26\u8868\u5355\u6570\u636e</li> <li>DELETE http://localhost:8080/mvc/index/{id} -  \u5220\u9664\u7528\u6237\u4fe1\u606f\uff0cid\u76f4\u63a5\u653e\u5728\u8bf7\u6c42\u8def\u5f84\u4e2d</li> </ul> <p>\u6211\u4eec\u5206\u522b\u7f16\u5199\u56db\u4e2a\u8bf7\u6c42\u6620\u5c04\uff1a</p> <pre><code>@Controller\npublic class MainController {\n\n    @RequestMapping(value = \"/index/{id}\", method = RequestMethod.GET)\n    public String get(@PathVariable(\"id\") String text){\n        System.out.println(\"\u83b7\u53d6\u7528\u6237\uff1a\"+text);\n        return \"index\";\n    }\n\n    @RequestMapping(value = \"/index\", method = RequestMethod.POST)\n    public String post(String username){\n        System.out.println(\"\u6dfb\u52a0\u7528\u6237\uff1a\"+username);\n        return \"index\";\n    }\n\n    @RequestMapping(value = \"/index/{id}\", method = RequestMethod.DELETE)\n    public String delete(@PathVariable(\"id\") String text){\n        System.out.println(\"\u5220\u9664\u7528\u6237\uff1a\"+text);\n        return \"index\";\n    }\n\n    @RequestMapping(value = \"/index\", method = RequestMethod.PUT)\n    public String put(String username){\n        System.out.println(\"\u4fee\u6539\u7528\u6237\uff1a\"+username);\n        return \"index\";\n    }\n}\n</code></pre> <p>\u8fd9\u53ea\u662f\u4e00\u79cd\u8bbe\u8ba1\u98ce\u683c\u800c\u5df2\uff0c\u5404\u4f4d\u5c0f\u4f19\u4f34\u4e86\u89e3\u5373\u53ef\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#interceptor","title":"Interceptor\u62e6\u622a\u5668","text":"<p>\u62e6\u622a\u5668\u662f\u6574\u4e2aSpringMVC\u7684\u4e00\u4e2a\u91cd\u8981\u5185\u5bb9\uff0c\u62e6\u622a\u5668\u4e0e\u8fc7\u6ee4\u5668\u7c7b\u4f3c\uff0c\u90fd\u662f\u7528\u4e8e\u62e6\u622a\u4e00\u4e9b\u975e\u6cd5\u8bf7\u6c42\uff0c\u4f46\u662f\u6211\u4eec\u4e4b\u524d\u8bb2\u89e3\u7684\u8fc7\u6ee4\u5668\u662f\u4f5c\u7528\u4e8eServlet\u4e4b\u524d\uff0c\u53ea\u6709\u7ecf\u8fc7\u5c42\u5c42\u7684\u8fc7\u6ee4\u5668\u624d\u53ef\u4ee5\u6210\u529f\u5230\u8fbeServlet\uff0c\u800c\u62e6\u622a\u5668\u5e76\u4e0d\u662f\u5728Servlet\u4e4b\u524d\uff0c\u5b83\u5728Servlet\u4e0eRequestMapping\u4e4b\u95f4\uff0c\u76f8\u5f53\u4e8eDispatcherServlet\u5728\u5c06\u8bf7\u6c42\u4ea4\u7ed9\u5bf9\u5e94Controller\u4e2d\u7684\u65b9\u6cd5\u4e4b\u524d\u8fdb\u884c\u62e6\u622a\u5904\u7406\uff0c\u5b83\u53ea\u4f1a\u62e6\u622a\u6240\u6709Controller\u4e2d\u5b9a\u4e49\u7684\u8bf7\u6c42\u6620\u5c04\u5bf9\u5e94\u7684\u8bf7\u6c42\uff08\u4e0d\u4f1a\u62e6\u622a\u9759\u6001\u8d44\u6e90\uff09\uff0c\u8fd9\u91cc\u4e00\u5b9a\u8981\u533a\u5206\u4e24\u8005\u7684\u4e0d\u540c\u3002</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#_5","title":"\u521b\u5efa\u62e6\u622a\u5668","text":"<p>\u521b\u5efa\u4e00\u4e2a\u62e6\u622a\u5668\u6211\u4eec\u9700\u8981\u5b9e\u73b0\u4e00\u4e2a<code>HandlerInterceptor</code>\u63a5\u53e3\uff1a</p> <pre><code>public class MainInterceptor implements HandlerInterceptor {\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        System.out.println(\"\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\");\n        return true;   //\u53ea\u6709\u8fd4\u56detrue\u624d\u4f1a\u7ee7\u7eed\uff0c\u5426\u5219\u76f4\u63a5\u7ed3\u675f\n    }\n\n    @Override\n    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {\n        System.out.println(\"\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\");\n    }\n\n    @Override\n    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {\n        //\u5728DispatcherServlet\u5b8c\u5168\u5904\u7406\u5b8c\u8bf7\u6c42\u540e\u88ab\u8c03\u7528\n        System.out.println(\"\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\");\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u7c7b\u4e2d\u8fdb\u884c\u6ce8\u518c\uff1a</p> <pre><code>@Override\npublic void addInterceptors(InterceptorRegistry registry) {\n    registry.addInterceptor(new MainInterceptor())\n      .addPathPatterns(\"/**\")    //\u6dfb\u52a0\u62e6\u622a\u5668\u7684\u5339\u914d\u8def\u5f84\uff0c\u53ea\u8981\u5339\u914d\u4e00\u5f8b\u62e6\u622a\n      .excludePathPatterns(\"/home\");   //\u62e6\u622a\u5668\u4e0d\u8fdb\u884c\u62e6\u622a\u7684\u8def\u5f84\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95eeindex\u9875\u9762\uff0c\u62e6\u622a\u5668\u5df2\u7ecf\u751f\u6548\u3002</p> <p>\u5f97\u5230\u6574\u7406\u62e6\u622a\u5668\u7684\u6267\u884c\u987a\u5e8f\uff1a</p> <pre><code>\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n\u6211\u662f\u5904\u7406\uff01\n\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\n\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\n</code></pre> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5904\u7406\u524d\u548c\u5904\u7406\u540e\uff0c\u5305\u542b\u4e86\u771f\u6b63\u7684\u8bf7\u6c42\u6620\u5c04\u7684\u5904\u7406\uff0c\u5728\u6574\u4e2a\u6d41\u7a0b\u7ed3\u675f\u540e\u8fd8\u6267\u884c\u4e86\u4e00\u6b21<code>afterCompletion</code>\u65b9\u6cd5\uff0c\u5176\u5b9e\u6574\u4e2a\u8fc7\u7a0b\u4e0e\u6211\u4eec\u4e4b\u524d\u6240\u8ba4\u8bc6\u7684Filter\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u5728\u5904\u7406\u524d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8fd4\u56detrue\u6216\u662ffalse\u8868\u793a\u662f\u5426\u88ab\u62e6\u622a\u5373\u53ef\uff0c\u800c\u4e0d\u662f\u518d\u53bb\u4f7f\u7528FilterChain\u8fdb\u884c\u5411\u4e0b\u4f20\u9012\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u5c31\u6765\u770b\u770b\uff0c\u5982\u679c\u5904\u7406\u524d\u8fd4\u56defalse\uff0c\u4f1a\u600e\u4e48\u6837\uff1a</p> <pre><code>\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n</code></pre> <p>\u901a\u8fc7\u7ed3\u679c\u53d1\u73b0\u4e00\u65e6\u8fd4\u56defalse\uff0c\u4e4b\u540e\u7684\u6240\u6709\u6d41\u7a0b\u5168\u90e8\u53d6\u6d88\uff0c\u90a3\u4e48\u5982\u679c\u662f\u5728\u5904\u7406\u4e2d\u53d1\u751f\u5f02\u5e38\u4e86\u5462\uff1f</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(){\n    System.out.println(\"\u6211\u662f\u5904\u7406\uff01\");\n    if(true) throw new RuntimeException(\"\");\n    return \"index\";\n}\n</code></pre> <p>\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n\u6211\u662f\u5904\u7406\uff01\n\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u5982\u679c\u5904\u7406\u8fc7\u7a0b\u4e2d\u629b\u51fa\u5f02\u5e38\uff0c\u90a3\u4e48\u4e45\u4e0d\u4f1a\u6267\u884c\u5904\u7406\u540e<code>postHandle</code>\u65b9\u6cd5\uff0c\u4f46\u662f\u4f1a\u6267\u884c<code>afterCompletion</code>\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6b64\u65b9\u6cd5\u4e2d\u83b7\u53d6\u5230\u629b\u51fa\u7684\u5f02\u5e38\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#_6","title":"\u591a\u7ea7\u62e6\u622a\u5668","text":"<p>\u524d\u9762\u4ecb\u7ecd\u4e86\u4ec5\u4ec5\u53ea\u6709\u4e00\u4e2a\u62e6\u622a\u5668\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\u5982\u679c\u5b58\u5728\u591a\u4e2a\u62e6\u622a\u5668\u4f1a\u5982\u4f55\u6267\u884c\uff0c\u6211\u4eec\u4ee5\u540c\u6837\u7684\u65b9\u5f0f\u521b\u5efa\u4e8c\u53f7\u62e6\u622a\u5668\uff1a</p> <pre><code>public class SubInterceptor implements HandlerInterceptor {\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        System.out.println(\"\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\");\n        return true;\n    }\n\n    @Override\n    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {\n        System.out.println(\"\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\");\n    }\n\n    @Override\n    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {\n        System.out.println(\"\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\");\n    }\n}\n</code></pre> <p>\u6ce8\u518c\u4e8c\u53f7\u62e6\u622a\u5668\uff1a</p> <pre><code>@Override\npublic void addInterceptors(InterceptorRegistry registry) {\n    //\u4e00\u53f7\u62e6\u622a\u5668\n    registry.addInterceptor(new MainInterceptor()).addPathPatterns(\"/**\").excludePathPatterns(\"/home\");\n    //\u4e8c\u53f7\u62e6\u622a\u5668\n    registry.addInterceptor(new SubInterceptor()).addPathPatterns(\"/**\");\n}\n</code></pre> <p>\u6ce8\u610f\u62e6\u622a\u987a\u5e8f\u5c31\u662f\u6ce8\u518c\u7684\u987a\u5e8f\uff0c\u56e0\u6b64\u62e6\u622a\u5668\u4f1a\u6839\u636e\u6ce8\u518c\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\uff0c\u6211\u4eec\u53ef\u4ee5\u6253\u5f00\u6d4f\u89c8\u5668\u8fd0\u884c\u4e00\u6b21\uff1a</p> <pre><code>\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n\u6211\u662f\u5904\u7406\uff01\n\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\n\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\n\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\n\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\n</code></pre> <p>\u548c\u591a\u7ea7Filter\u76f8\u540c\uff0c\u5728\u5904\u7406\u4e4b\u524d\uff0c\u662f\u6309\u7167\u987a\u5e8f\u4ece\u524d\u5411\u540e\u8fdb\u884c\u62e6\u622a\u7684\uff0c\u4f46\u662f\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u5c31\u6309\u7167\u5012\u5e8f\u6267\u884c\u5904\u7406\u540e\u65b9\u6cd5\uff0c\u800c\u5b8c\u6210\u540e\u662f\u5728\u6240\u6709\u7684<code>postHandle</code>\u6267\u884c\u4e4b\u540e\u518d\u540c\u6837\u7684\u4ee5\u5012\u5e8f\u65b9\u5f0f\u6267\u884c\u3002</p> <p>\u90a3\u4e48\u5982\u679c\u8fd9\u65f6\u4e00\u53f7\u62e6\u622a\u5668\u5728\u5904\u7406\u524d\u5c31\u8fd4\u56de\u4e86false\u5462\uff1f</p> <pre><code>@Override\npublic boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n    System.out.println(\"\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\");\n    return false;\n}\n</code></pre> <p>\u5f97\u5230\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u4e0e\u5355\u4e2a\u62e6\u622a\u5668\u7684\u60c5\u51b5\u4e00\u6837\uff0c\u4e00\u65e6\u62e6\u622a\u5668\u8fd4\u56defalse\uff0c\u90a3\u4e48\u4e4b\u540e\u65e0\u8bba\u6709\u65e0\u62e6\u622a\u5668\uff0c\u90fd\u4e0d\u518d\u7ee7\u7eed\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#_7","title":"\u5f02\u5e38\u5904\u7406","text":"<p>\u5f53\u6211\u4eec\u7684\u8bf7\u6c42\u6620\u5c04\u65b9\u6cd5\u4e2d\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u4f1a\u76f4\u63a5\u5c55\u793a\u5728\u524d\u7aef\u9875\u9762\uff0c\u8fd9\u662f\u56e0\u4e3aSpringMVC\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u9ed8\u8ba4\u7684\u5f02\u5e38\u5904\u7406\u9875\u9762\uff0c\u5f53\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u6211\u4eec\u7684\u8bf7\u6c42\u4f1a\u88ab\u76f4\u63a5\u8f6c\u4ea4\u7ed9\u4e13\u95e8\u7528\u4e8e\u5f02\u5e38\u5904\u7406\u7684\u63a7\u5236\u5668\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2a\u5f02\u5e38\u5904\u7406\u63a7\u5236\u5668\uff0c\u4e00\u65e6\u51fa\u73b0\u6307\u5b9a\u5f02\u5e38\uff0c\u5c31\u4f1a\u8f6c\u63a5\u5230\u6b64\u63a7\u5236\u5668\u6267\u884c\uff1a</p> <pre><code>@ControllerAdvice\npublic class ErrorController {\n\n    @ExceptionHandler(Exception.class)\n    public String error(Exception e, Model model){  //\u53ef\u4ee5\u76f4\u63a5\u6dfb\u52a0\u5f62\u53c2\u6765\u83b7\u53d6\u5f02\u5e38\n        e.printStackTrace();\n        model.addAttribute(\"e\", e);\n        return \"500\";\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u7f16\u5199\u4e00\u4e2a\u4e13\u95e8\u663e\u793a\u5f02\u5e38\u7684\u9875\u9762\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  500 - \u670d\u52a1\u5668\u51fa\u73b0\u4e86\u4e00\u4e2a\u5185\u90e8\u9519\u8befQAQ\n  &lt;div th:text=\"${e}\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u63a5\u7740\u4fee\u6539\uff1a</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(){\n    System.out.println(\"\u6211\u662f\u5904\u7406\uff01\");\n    if(true) throw new RuntimeException(\"\u60a8\u7684\u6c2a\u91d1\u529b\u5ea6\u4e0d\u8db3\uff0c\u65e0\u6cd5\u8bbf\u95ee\uff01\");\n    return \"index\";\n}\n</code></pre> <p>\u8bbf\u95ee\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u63a7\u5236\u53f0\u4f1a\u8f93\u51fa\u5f02\u5e38\u4fe1\u606f\uff0c\u540c\u65f6\u9875\u9762\u4e5f\u662f\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u4e00\u4e2a\u9875\u9762\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#jsonaxios","title":"JSON\u6570\u636e\u683c\u5f0f\u4e0eAxios\u8bf7\u6c42","text":"<p>JSON (JavaScript Object Notation, JS \u5bf9\u8c61\u7b80\u8c31) \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684\u6570\u636e\u4ea4\u6362\u683c\u5f0f\u3002</p> <p>\u6211\u4eec\u73b0\u5728\u63a8\u5d07\u7684\u662f\u524d\u540e\u7aef\u5206\u79bb\u7684\u5f00\u53d1\u6a21\u5f0f\uff0c\u800c\u4e0d\u662f\u6240\u6709\u7684\u5185\u5bb9\u5168\u90e8\u4ea4\u7ed9\u540e\u7aef\u6e32\u67d3\u518d\u53d1\u9001\u7ed9\u6d4f\u89c8\u5668\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6574\u4e2aWeb\u9875\u9762\u7684\u5185\u5bb9\u5728\u4e00\u5f00\u59cb\u5c31\u7f16\u5199\u5b8c\u6210\u4e86\uff0c\u800c\u5176\u4e2d\u7684\u6570\u636e\u7531\u524d\u7aef\u6267\u884cJS\u4ee3\u7801\u6765\u5411\u670d\u52a1\u5668\u52a8\u6001\u83b7\u53d6\uff0c\u518d\u5230\u524d\u7aef\u8fdb\u884c\u6e32\u67d3\uff08\u586b\u5145\uff09\uff0c\u8fd9\u6837\u53ef\u4ee5\u5927\u5e45\u5ea6\u51cf\u5c11\u540e\u7aef\u7684\u538b\u529b\uff0c\u5e76\u4e14\u540e\u7aef\u53ea\u9700\u8981\u4f20\u8f93\u5173\u952e\u6570\u636e\u5373\u53ef\uff08\u5728\u5373\u5c06\u5230\u6765\u7684SpringBoot\u9636\u6bb5\uff0c\u6211\u4eec\u5c06\u5b8c\u5168\u91c7\u7528\u524d\u540e\u7aef\u5206\u79bb\u7684\u5f00\u53d1\u6a21\u5f0f\uff09</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#json","title":"JSON\u6570\u636e\u683c\u5f0f","text":"<p>\u65e2\u7136\u8981\u5b9e\u73b0\u524d\u540e\u7aef\u5206\u79bb\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5fc5\u987b\u7ea6\u5b9a\u4e00\u79cd\u66f4\u52a0\u9ad8\u6548\u7684\u6570\u636e\u4f20\u8f93\u6a21\u5f0f\uff0c\u6765\u5411\u524d\u7aef\u9875\u9762\u4f20\u8f93\u540e\u7aef\u63d0\u4f9b\u7684\u6570\u636e\u3002\u56e0\u6b64JSON\u6a2a\u7a7a\u51fa\u4e16\uff0c\u5b83\u975e\u5e38\u5bb9\u6613\u7406\u89e3\uff0c\u5e76\u4e14\u4e0e\u524d\u7aef\u7684\u517c\u5bb9\u6027\u6781\u597d\uff0c\u56e0\u6b64\u73b0\u5728\u6bd4\u8f83\u4e3b\u6d41\u7684\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u5219\u662f\u901a\u8fc7JSON\u683c\u5f0f\u627f\u8f7d\u7684\u3002</p> <p>\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u6570\u636e\u957f\u8fd9\u6837\uff0c\u4ee5\u5b66\u751f\u5bf9\u8c61\u4e3a\u4f8b\uff1a</p> <pre><code>{\"name\": \"\u6770\u54e5\", \"age\": 18}\n</code></pre> <p>\u591a\u4e2a\u5b66\u751f\u53ef\u4ee5\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u8868\u793a\uff1a</p> <pre><code>[{\"name\": \"\u6770\u54e5\", \"age\": 18}, {\"name\": \"\u963f\u4f1f\", \"age\": 18}]\n</code></pre> <p>\u5d4c\u5957\u5173\u7cfb\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a</p> <pre><code>{\"studentList\": [{\"name\": \"\u6770\u54e5\", \"age\": 18}, {\"name\": \"\u963f\u4f1f\", \"age\": 18}], \"count\": 2}\n</code></pre> <p>\u5b83\u76f4\u63a5\u5305\u62ec\u4e86\u5c5e\u6027\u7684\u540d\u79f0\u548c\u5c5e\u6027\u7684\u503c\uff0c\u4e0eJavaScript\u7684\u5bf9\u8c61\u6781\u4e3a\u76f8\u4f3c\uff0c\u5b83\u5230\u8fbe\u524d\u7aef\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8f6c\u6362\u4e3a\u5bf9\u8c61\uff0c\u4ee5\u5bf9\u8c61\u7684\u5f62\u5f0f\u8fdb\u884c\u64cd\u4f5c\u548c\u5185\u5bb9\u7684\u8bfb\u53d6\uff0c\u76f8\u5f53\u4e8e\u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u8868\u793a\u4e86\u4e00\u4e2aJS\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u63a7\u5236\u53f0\u7a97\u53e3\u4e2d\u6d4b\u8bd5\uff1a</p> <pre><code>let obj = JSON.parse('{\"studentList\": [{\"name\": \"\u6770\u54e5\", \"age\": 18}, {\"name\": \"\u963f\u4f1f\", \"age\": 18}], \"count\": 2}')\n//\u5c06JSON\u683c\u5f0f\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3aJS\u5bf9\u8c61\nobj.studentList[0].name   //\u76f4\u63a5\u8bbf\u95ee\u7b2c\u4e00\u4e2a\u5b66\u751f\u7684\u540d\u79f0\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06JS\u5bf9\u8c61\u8f6c\u6362\u4e3aJSON\u5b57\u7b26\u4e32\uff1a</p> <pre><code>JSON.stringify(obj)\n</code></pre> <p>\u6211\u4eec\u540e\u7aef\u5c31\u53ef\u4ee5\u4ee5JSON\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u5411\u524d\u7aef\u8fd4\u56de\u6570\u636e\uff0c\u8fd9\u6837\u524d\u7aef\u5728\u62ff\u5230\u6570\u636e\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5feb\u901f\u83b7\u53d6\uff0c\u975e\u5e38\u65b9\u4fbf\u3002</p> <p>\u90a3\u4e48\u540e\u7aef\u5982\u4f55\u5feb\u901f\u521b\u5efa\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u6570\u636e\u5462\uff1f\u6211\u4eec\u9996\u5148\u9700\u8981\u5bfc\u5165\u4ee5\u4e0b\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n      &lt;groupId&gt;com.alibaba.fastjson2&lt;/groupId&gt;\n      &lt;artifactId&gt;fastjson2&lt;/artifactId&gt;\n      &lt;version&gt;2.0.34&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>JSON\u89e3\u6790\u6846\u67b6\u6709\u5f88\u591a\u79cd\uff0c\u6bd4\u8f83\u5e38\u7528\u7684\u662fJackson\u548cFastJSON\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u963f\u91cc\u5df4\u5df4\u7684FastJSON\u8fdb\u884c\u89e3\u6790\uff0c\u8fd9\u662f\u76ee\u524d\u53f7\u79f0\u6700\u5feb\u7684JSON\u89e3\u6790\u6846\u67b6\uff0c\u5e76\u4e14\u73b0\u5728\u5df2\u7ecf\u5f3a\u52bf\u63a8\u51faFastJSON 2\u7248\u672c\u3002</p> <p>\u9996\u5148\u8981\u4ecb\u7ecd\u7684\u662fJSONObject\uff0c\u5b83\u548cMap\u7684\u4f7f\u7528\u65b9\u6cd5\u4e00\u6837\uff0c\u5e76\u4e14\u662f\u6709\u5e8f\u7684\uff08\u5b9e\u73b0\u4e86LinkedHashMap\u63a5\u53e3\uff09\uff0c\u6bd4\u5982\u6211\u4eec\u5411\u5176\u4e2d\u5b58\u653e\u51e0\u4e2a\u6570\u636e\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic String index(){\n    JSONObject object = new JSONObject();\n    object.put(\"name\", \"\u6770\u54e5\");\n    object.put(\"age\", 18);\n    System.out.println(object.toJSONString());   //\u4ee5JSON\u683c\u5f0f\u8f93\u51faJSONObject\u5b57\u7b26\u4e32\n    return \"index\";\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u5f97\u5230\u7684\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>{\"name\": \"\u6770\u54e5\", \"age\": 18}\n</code></pre> <p>\u5b9e\u9645\u4e0aJSONObject\u5c31\u662f\u5bf9JSON\u6570\u636e\u7684\u4e00\u79cd\u5bf9\u8c61\u8868\u793a\u3002\u540c\u6837\u7684\u8fd8\u6709JSONArray\uff0c\u5b83\u8868\u793a\u4e00\u4e2a\u6570\u7ec4\uff0c\u7528\u6cd5\u548cList\u4e00\u6837\uff0c\u6570\u7ec4\u4e2d\u53ef\u4ee5\u5d4c\u5957\u5176\u4ed6\u7684JSONObject\u6216\u662fJSONArray\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic String index(){\n    JSONObject object = new JSONObject();\n    object.put(\"name\", \"\u6770\u54e5\");\n    object.put(\"age\", 18);\n    JSONArray array = new JSONArray();\n    array.add(object);\n    System.out.println(array.toJSONString());\n    return \"index\";\n}\n</code></pre> <p>\u5f97\u5230\u7684\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>[{\"name\": \"\u6770\u54e5\", \"age\": 18}]\n</code></pre> <p>\u5f53\u51fa\u73b0\u5faa\u73af\u5f15\u7528\u65f6\uff0c\u4f1a\u6309\u7167\u4ee5\u4e0b\u8bed\u6cd5\u6765\u89e3\u6790\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u4e5f\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f53\u7c7b\uff0c\u5c06\u5b9e\u4f53\u7c7b\u8f6c\u6362\u4e3aJSON\u683c\u5f0f\u7684\u6570\u636e\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", produces = \"application/json\")\n@ResponseBody\npublic String data(){\n    Student student = new Student();\n    student.setName(\"\u6770\u54e5\");\n    student.setAge(18);\n    return JSON.toJSONString(student);\n}\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u4fee\u6539\u4e86<code>produces</code>\u7684\u503c\uff0c\u5c06\u8fd4\u56de\u7684\u5185\u5bb9\u7c7b\u578b\u8bbe\u5b9a\u4e3a<code>application/json</code>\uff0c\u8868\u793a\u670d\u52a1\u5668\u7aef\u8fd4\u56de\u4e86\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u6570\u636e\uff08\u5f53\u7136\u4e0d\u8bbe\u7f6e\u4e5f\u884c\uff0c\u4e5f\u80fd\u5c55\u793a\uff0c\u8fd9\u6837\u662f\u4e3a\u4e86\u89c4\u8303\uff09\u7136\u540e\u6211\u4eec\u5728\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u4e00\u4e2a<code>@ResponseBody</code>\u8868\u793a\u65b9\u6cd5\u8fd4\u56de\uff08\u4e5f\u53ef\u4ee5\u5728\u7c7b\u4e0a\u6dfb\u52a0<code>@RestController</code>\u8868\u793a\u6b64Controller\u9ed8\u8ba4\u8fd4\u56de\u7684\u662f\u5b57\u7b26\u4e32\u6570\u636e\uff09\u7684\u7ed3\u679c\u4e0d\u662f\u89c6\u56fe\u540d\u79f0\u800c\u662f\u76f4\u63a5\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f5c\u4e3a\u9875\u9762\u6570\u636e\uff0c\u8fd9\u6837\uff0c\u8fd4\u56de\u7ed9\u6d4f\u89c8\u5668\u7684\u5c31\u662f\u6211\u4eec\u76f4\u63a5\u8fd4\u56de\u7684\u5b57\u7b26\u4e32\u5185\u5bb9\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u4f7f\u7528JSON\u5de5\u5177\u7c7b\u5c06\u5176\u8f6c\u6362\u4e3aJSON\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\uff0c\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u5f97\u5230JSON\u683c\u5f0f\u6570\u636e\u3002</p> <p>SpringMVC\u975e\u5e38\u667a\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\u7c7b\u578b\uff0c\u5b83\u4f1a\u88ab\u81ea\u52a8\u8f6c\u6362\u4e3aJSON\u5b57\u7b26\u4e32\u683c\u5f0f\uff1a</p> <pre><code>@RequestMapping(value = \"/data\", produces = \"application/json\")\n@ResponseBody\npublic Student data(){\n    Student student = new Student();\n    student.setName(\"\u6770\u54e5\");\n    student.setAge(18);\n    return student;\n}\n</code></pre> <p>\u6ce8\u610f\u9700\u8981\u5728\u914d\u7f6e\u7c7b\u4e2d\u6dfb\u52a0\u4e00\u4e0bFastJSON\u8f6c\u6362\u5668\uff0c\u8fd9\u91cc\u9700\u8981\u5148\u6dfb\u52a0\u4e00\u4e2a\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.fastjson2&lt;/groupId&gt;\n    &lt;artifactId&gt;fastjson2-extension-spring6&lt;/artifactId&gt;\n    &lt;version&gt;2.0.34&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7136\u540e\u7f16\u5199\u914d\u7f6e\uff1a</p> <pre><code>@Override\npublic void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) {\n    converters.add(new FastJsonHttpMessageConverter());\n}\n</code></pre> <p>\u518d\u6b21\u5c1d\u8bd5\uff0c\u5185\u5bb9\u5c31\u4f1a\u81ea\u52a8\u8f6c\u6362\u4e3aJSON\u683c\u5f0f\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#axios","title":"Axios\u5f02\u6b65\u8bf7\u6c42","text":"<p>\u524d\u9762\u6211\u4eec\u8bb2\u89e3\u4e86\u5982\u4f55\u5411\u6d4f\u89c8\u5668\u53d1\u9001\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u6570\u636e\uff0c\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u6765\u770b\u770b\u5982\u4f55\u5411\u670d\u52a1\u5668\u8bf7\u6c42\u6570\u636e\u3002</p> <p></p> <p>\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u53c8\u8981\u56de\u5230\u524d\u7aef\u76f8\u5173\u5185\u5bb9\u7684\u4ecb\u7ecd\u4e2d\uff0c\u5f53\u7136\uff0c\u6211\u4eec\u4f9d\u7136\u662f\u4ec5\u505a\u4e86\u89e3\uff0c\u5e76\u4e0d\u9700\u8981\u8be6\u7ec6\u5b66\u4e60\u524d\u7aef\u9879\u76ee\u5f00\u53d1\u77e5\u8bc6\u3002</p> <p>\u524d\u7aef\u4e3a\u4ec0\u4e48\u9700\u8981\u7528\u5230\u5f02\u6b65\u8bf7\u6c42\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684\u7f51\u9875\u662f\u52a8\u6001\u7684\uff08\u8fd9\u91cc\u7684\u52a8\u6001\u4e0d\u662f\u6307\u6709\u52a8\u753b\u6548\u679c\uff0c\u800c\u662f\u80fd\u591f\u5b9e\u65f6\u66f4\u65b0\u5185\u5bb9\uff09\u6bd4\u5982\u6211\u4eec\u70b9\u51fb\u4e00\u4e2a\u6309\u94ae\u4f1a\u5f39\u51fa\u65b0\u7684\u5185\u5bb9\u3001\u6216\u662f\u8df3\u8f6c\u5230\u65b0\u7684\u9875\u9762\u3001\u66f4\u65b0\u9875\u9762\u4e2d\u7684\u6570\u636e\u7b49\u7b49\uff0c\u8fd9\u4e9b\u90fd\u9700\u8981\u901a\u8fc7JS\u5b8c\u6210\u5f02\u6b65\u8bf7\u6c42\u6765\u5b9e\u73b0\u3002</p> <p>\u524d\u7aef\u5f02\u6b65\u8bf7\u6c42\u6307\u7684\u662f\u5728\u524d\u7aef\u4e2d\u53d1\u9001\u8bf7\u6c42\u81f3\u670d\u52a1\u5668\u6216\u5176\u4ed6\u8d44\u6e90\uff0c\u5e76\u4e14\u4e0d\u963b\u585e\u7528\u6237\u754c\u9762\u6216\u5176\u4ed6\u64cd\u4f5c\u3002\u5728\u4f20\u7edf\u7684\u540c\u6b65\u8bf7\u6c42\u4e2d\uff0c\u5f53\u53d1\u9001\u8bf7\u6c42\u65f6\uff0c\u6d4f\u89c8\u5668\u4f1a\u7b49\u5f85\u670d\u52a1\u5668\u54cd\u5e94\uff0c\u671f\u95f4\u7528\u6237\u65e0\u6cd5\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c\u3002\u800c\u5f02\u6b65\u8bf7\u6c42\u901a\u8fc7\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u540e\u53f0\uff0c\u5728\u7b49\u5f85\u54cd\u5e94\u7684\u540c\u65f6\uff0c\u5141\u8bb8\u7528\u6237\u7ee7\u7eed\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c\u3002\u8fd9\u79cd\u673a\u5236\u80fd\u591f\u63d0\u5347\u7528\u6237\u4f53\u9a8c\uff0c\u5e76\u4e14\u5141\u8bb8\u9875\u9762\u8fdb\u884c\u5b9e\u65f6\u66f4\u65b0\u3002\u5e38\u89c1\u7684\u524d\u7aef\u5f02\u6b65\u8bf7\u6c42\u65b9\u5f0f\u5305\u62ec\u4f7f\u7528XMLHttpRequest\u5bf9\u8c61\u3001Fetch API\u3001\u4ee5\u53ca\u4f7f\u7528jQuery\u5e93\u4e2d\u7684AJAX\u65b9\u6cd5\uff0c\u4ee5\u53ca\u76ee\u524d\u6700\u5e38\u7528\u7684Axios\u6846\u67b6\u7b49\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u540e\u7aef\u6709\u4e00\u4e2a\u9700\u8981\u5b9e\u65f6\u5237\u65b0\u7684\u6570\u636e\uff08\u968f\u65f6\u95f4\u800c\u53d8\u5316\uff09\u73b0\u5728\u9700\u8981\u518d\u524d\u7aef\u5b9e\u65f6\u66f4\u65b0\u5c55\u793a\uff0c\u8fd9\u91cc\u6211\u4eec\u4ee5axios\u6846\u67b6\u7684\u7b80\u5355\u4f7f\u7528\u4e3a\u4f8b\u5b50\uff0c\u5e26\u5404\u4f4d\u5c0f\u4f19\u4f34\u4f53\u9a8c\u5982\u4f55\u53d1\u8d77\u5f02\u6b65\u8bf7\u6c42\u5e76\u66f4\u65b0\u6211\u4eec\u9875\u9762\u4e2d\u7684\u6570\u636e\u3002</p> <p>\u9996\u5148\u662f\u524d\u7aef\u9875\u9762\uff0c\u76f4\u63a5\u6284\u4f5c\u4e1a\u5c31\u884c\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u6d4b\u8bd5&lt;/title&gt;\n    &lt;script src=\"https://unpkg.com/axios@1.1.2/dist/axios.min.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;p&gt;\u6b22\u8fce\u6765\u5230GayHub\u5168\u7403\u6700\u5927\u540c\u6027\u4ea4\u53cb\u7f51\u7ad9&lt;/p&gt;\n  &lt;p&gt;\u7528\u6237\u540d: &lt;span id=\"username\"&gt;&lt;/span&gt;&lt;/p&gt;\n  &lt;p&gt;\u5bc6\u7801: &lt;span id=\"password\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u4f7f\u7528axios\u6846\u67b6\u76f4\u63a5\u5bf9\u540e\u7aef\u8bf7\u6c42JSON\u6570\u636e\uff1a</p> <pre><code>&lt;script&gt;\n    function getInfo() {\n        axios.get('/mvc/test').then(({data}) =&gt; {\n            document.getElementById('username').innerText = data.username\n            document.getElementById('password').innerText = data.password\n        })\n    }\n&lt;/script&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u4ece\u670d\u52a1\u7aef\u83b7\u53d6\u6570\u636e\u5e76\u66f4\u65b0\u5230\u9875\u9762\u4e2d\uff0c\u524d\u7aef\u5f00\u53d1\u8005\u5229\u7528JS\u53d1\u8d77\u5f02\u6b65\u8bf7\u6c42\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5404\u79cd\u5404\u6837\u7684\u6548\u679c\uff0c\u800c\u6211\u4eec\u540e\u7aef\u5f00\u53d1\u8005\u53ea\u9700\u8981\u5173\u5fc3\u63a5\u53e3\u8fd4\u56de\u6b63\u786e\u7684\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u5c31\u5df2\u7ecf\u6709\u524d\u540e\u7aef\u5206\u79bb\u5f00\u53d1\u7684\u96cf\u5f62\u4e86\uff08\u5b9e\u9645\u4e0a\u4e4b\u524d\uff0c\u6211\u4eec\u5728JavaWeb\u9636\u6bb5\u4f7f\u7528XHR\u8bf7\u6c42\u4e5f\u6f14\u793a\u8fc7\uff0c\u4e0d\u8fc7\u5f53\u65f6\u662f\u7eaf\u7cb9\u7684\u6570\u636e\uff09</p> <p>\u90a3\u4e48\u6211\u4eec\u63a5\u7740\u6765\u770b\uff0c\u5982\u4f55\u5411\u670d\u52a1\u7aef\u53d1\u9001\u4e00\u4e2aJS\u5bf9\u8c61\u6570\u636e\u5e76\u8fdb\u884c\u89e3\u6790\uff0c\u8fd9\u91cc\u4ee5\u7b80\u5355\u7684\u767b\u5f55\u4e3a\u4f8b\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u6d4b\u8bd5&lt;/title&gt;\n    &lt;script src=\"https://unpkg.com/axios@1.1.2/dist/axios.min.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;p&gt;\u6b22\u8fce\u6765\u5230GayHub\u5168\u7403\u6700\u5927\u540c\u6027\u4ea4\u53cb\u7f51\u7ad9&lt;/p&gt;\n  &lt;button onclick=\"login()\"&gt;\u7acb\u5373\u767b\u5f55&lt;/button&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u8fd9\u91cc\u4f9d\u7136\u4f7f\u7528axios\u53d1\u9001POST\u8bf7\u6c42\uff1a</p> <pre><code>&lt;script&gt;\n    function login() {\n        axios.post('/mvc/test', {\n            username: 'test',\n            password: '123456'\n        }, {\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n        }).then(({data}) =&gt; {\n            if(data.success) {\n                alert('\u767b\u5f55\u6210\u529f')\n            } else {\n                alert('\u767b\u5f55\u5931\u8d25')\n            }\n        })\n    }\n&lt;/script&gt;\n</code></pre> <p>\u670d\u52a1\u5668\u7aef\u53ea\u9700\u8981\u5728\u8bf7\u6c42\u53c2\u6570\u4f4d\u7f6e\u6dfb\u52a0\u4e00\u4e2a\u5bf9\u8c61\u63a5\u6536\u5373\u53ef\uff08\u548c\u524d\u9762\u662f\u4e00\u6837\u7684\uff0c\u56e0\u4e3a\u8fd9\u91cc\u4e5f\u662f\u63d0\u4ea4\u7684\u8868\u5355\u6570\u636e\uff09\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(value = \"/test\", produces = \"application/json\")\npublic String hello(String username, String password){\n    boolean success = \"test\".equals(user.getUsername()) &amp;&amp; \"123456\".equals(user.getPassword());\n    JSONObject object = new JSONObject();\n    object.put(\"success\", success);\n    return object.toString();\n}\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06js\u5bf9\u8c61\u8f6c\u6362\u4e3aJSON\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u8f93\uff0c\u8fd9\u91cc\u9700\u8981\u4f7f\u7528ajax\u65b9\u6cd5\u6765\u5904\u7406\uff1a</p> <pre><code>&lt;script&gt;\n    function login() {\n        axios.post('/mvc/test', {\n            username: 'test',\n            password: '123456'\n        }).then(({data}) =&gt; {\n            if(data.success) {\n                alert('\u767b\u5f55\u6210\u529f')\n            } else {\n                alert('\u767b\u5f55\u5931\u8d25')\n            }\n        })\n    }\n&lt;/script&gt;\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u9700\u8981\u8bfb\u53d6\u524d\u7aef\u53d1\u9001\u7ed9\u6211\u4eec\u7684JSON\u683c\u5f0f\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u6dfb\u52a0<code>@RequestBody</code>\u6ce8\u89e3\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(value = \"/test\", produces = \"application/json\")\npublic String hello(@RequestBody User user){\n    boolean success = \"test\".equals(user.getUsername()) &amp;&amp; \"123456\".equals(user.getPassword());\n    JSONObject object = new JSONObject();\n    object.put(\"success\", success);\n    return object.toString();\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u524d\u540e\u7aef\u4f7f\u7528JSON\u5b57\u7b26\u4e32\u8fdb\u884c\u901a\u4fe1\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#_8","title":"\u5b9e\u73b0\u6587\u4ef6\u4e0a\u4f20\u548c\u4e0b\u8f7d","text":"<p>\u5229\u7528SpringMVC\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u677e\u5730\u5b9e\u73b0\u6587\u4ef6\u4e0a\u4f20\u548c\u4e0b\u8f7d\uff0c\u6211\u4eec\u9700\u8981\u5728MainInitializer\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5\uff1a</p> <pre><code>public class MainInitializer extends AbstractAnnotationConfigDispatcherServletInitializer {\n\n    ...\n\n    @Override\n    protected void customizeRegistration(ServletRegistration.Dynamic registration) {\n        // \u76f4\u63a5\u901a\u8fc7registration\u914d\u7f6eMultipart\u76f8\u5173\u914d\u7f6e\uff0c\u5fc5\u987b\u914d\u7f6e\u4e34\u65f6\u4e0a\u4f20\u8def\u5f84\uff0c\u5efa\u8bae\u9009\u62e9\u65b9\u4fbf\u6253\u5f00\u7684\n        // \u540c\u6837\u53ef\u4ee5\u8bbe\u7f6e\u5176\u4ed6\u5c5e\u6027\uff1amaxFileSize, maxRequestSize, fileSizeThreshold\n        registration.setMultipartConfig(new MultipartConfigElement(\"/Users/nagocoler/Download\"));\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u76f4\u63a5\u7f16\u5199Controller\u5373\u53ef\uff1a</p> <pre><code>@RequestMapping(value = \"/upload\", method = RequestMethod.POST)\n@ResponseBody\npublic String upload(@RequestParam MultipartFile file) throws IOException {\n    File fileObj = new File(\"test.png\");\n    file.transferTo(fileObj);\n    System.out.println(\"\u7528\u6237\u4e0a\u4f20\u7684\u6587\u4ef6\u5df2\u4fdd\u5b58\u5230\uff1a\"+fileObj.getAbsolutePath());\n    return \"\u6587\u4ef6\u4e0a\u4f20\u6210\u529f\uff01\";\n}\n</code></pre> <p>\u6700\u540e\u5728\u524d\u7aef\u6dfb\u52a0\u4e00\u4e2a\u6587\u4ef6\u7684\u4e0a\u4f20\u70b9\uff1a</p> <pre><code>&lt;div&gt;\n    &lt;form action=\"upload\" method=\"post\" enctype=\"multipart/form-data\"&gt;\n        &lt;input type=\"file\" name=\"file\"&gt;\n        &lt;input type=\"submit\"&gt;\n    &lt;/form&gt;\n&lt;/div&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u70b9\u51fb\u63d0\u4ea4\u4e4b\u540e\uff0c\u6587\u4ef6\u5c31\u4f1a\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u4e86\u3002</p> <p>\u4e0b\u8f7d\u5176\u5b9e\u548c\u6211\u4eec\u4e4b\u524d\u7684\u5199\u6cd5\u5927\u81f4\u4e00\u6837\uff0c\u76f4\u63a5\u4f7f\u7528HttpServletResponse\uff0c\u5e76\u5411\u8f93\u51fa\u6d41\u4e2d\u4f20\u8f93\u6570\u636e\u5373\u53ef\u3002</p> <pre><code>@RequestMapping(value = \"/download\", method = RequestMethod.GET)\n@ResponseBody\npublic void download(HttpServletResponse response){\n    response.setContentType(\"multipart/form-data\");\n    try(OutputStream stream = response.getOutputStream();\n        InputStream inputStream = new FileInputStream(\"test.png\")){\n        IOUtils.copy(inputStream, stream);\n    }catch (IOException e){\n        e.printStackTrace();\n    }\n}\n</code></pre> <p>\u5728\u524d\u7aef\u9875\u9762\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u4e0b\u8f7d\u70b9\uff1a</p> <pre><code>&lt;a href=\"download\" download=\"test.png\"&gt;\u4e0b\u8f7d\u6700\u65b0\u8d44\u6e90&lt;/a&gt;\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SSM%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89SpringMvc%E5%9F%BA%E7%A1%80/#dispatcherservlet","title":"\u89e3\u8bfbDispatcherServlet\u6e90\u7801","text":"<p>\u6ce8\u610f\uff1a\u672c\u90e8\u5206\u4f5c\u4e3a\u9009\u5b66\u5185\u5bb9\uff01</p> <p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5173\u4e8eSpringMVC\u7684\u76f8\u5173\u5185\u5bb9\u5c31\u5b66\u4e60\u5f97\u5dee\u4e0d\u591a\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u5728\u6700\u540e\u8fd8\u662f\u9700\u8981\u6df1\u5165\u4e86\u89e3\u4e00\u4e0bDispatcherServlet\u5e95\u5c42\u662f\u5982\u4f55\u8fdb\u884c\u8c03\u5ea6\u7684\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u4f1a\u4ece\u6e90\u7801\u89d2\u5ea6\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u627e\u5230<code>DispatcherServlet</code>\u7684\u6700\u9876\u5c42<code>HttpServletBean</code>\uff0c\u5728\u8fd9\u91cc\u76f4\u63a5\u7ee7\u627f\u7684<code>HttpServlet</code>\uff0c\u90a3\u4e48\u6211\u4eec\u9996\u5148\u6765\u770b\u4e00\u4e0b\uff0c\u5b83\u5728\u521d\u59cb\u5316\u65b9\u6cd5\u4e2d\u505a\u4e86\u4ec0\u4e48\uff1a</p> <pre><code>public final void init() throws ServletException {\n    //\u8bfb\u53d6\u914d\u7f6e\u53c2\u6570\uff0c\u5e76\u8fdb\u884c\u914d\u7f6e\n    PropertyValues pvs = new HttpServletBean.ServletConfigPropertyValues(this.getServletConfig(), this.requiredProperties);\n    if (!pvs.isEmpty()) {\n        try {\n            BeanWrapper bw = PropertyAccessorFactory.forBeanPropertyAccess(this);\n            ResourceLoader resourceLoader = new ServletContextResourceLoader(this.getServletContext());\n            bw.registerCustomEditor(Resource.class, new ResourceEditor(resourceLoader, this.getEnvironment()));\n            this.initBeanWrapper(bw);\n            bw.setPropertyValues(pvs, true);\n        } catch (BeansException var4) {\n            if (this.logger.isErrorEnabled()) {\n                this.logger.error(\"Failed to set bean properties on servlet '\" + this.getServletName() + \"'\", var4);\n            }\n\n            throw var4;\n        }\n    }\n        //\u6b64\u521d\u59cb\u5316\u9636\u6bb5\u7531\u5b50\u7c7b\u5b9e\u73b0\uff0c\n    this.initServletBean();\n}\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b<code>initServletBean()</code>\u65b9\u6cd5\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u5b83\u662f\u5728\u5b50\u7c7b<code>FrameworkServlet</code>\u4e2d\u5b9a\u4e49\u7684\uff1a</p> <pre><code>protected final void initServletBean() throws ServletException {\n    this.getServletContext().log(\"Initializing Spring \" + this.getClass().getSimpleName() + \" '\" + this.getServletName() + \"'\");\n    if (this.logger.isInfoEnabled()) {\n        this.logger.info(\"Initializing Servlet '\" + this.getServletName() + \"'\");\n    }\n\n    long startTime = System.currentTimeMillis();\n\n    try {\n        //\u6ce8\u610f\uff1a\u6211\u4eec\u5728\u4e00\u5f00\u59cb\u8bf4\u4e86SpringMVC\u6709\u4e24\u4e2a\u5bb9\u5668\uff0c\u4e00\u4e2a\u662fWeb\u5bb9\u5668\u4e00\u4e2a\u662f\u6839\u5bb9\u5668\n        //Web\u5bb9\u5668\u53ea\u8d1f\u8d23Controller\u7b49\u8868\u73b0\u5c42\u5185\u5bb9\n        //\u6839\u5bb9\u5668\u5c31\u662fSpring\u5bb9\u5668\uff0c\u5b83\u8d1f\u8d23Service\u3001Dao\u7b49\uff0c\u5e76\u4e14\u5b83\u662fWeb\u5bb9\u5668\u7684\u7236\u5bb9\u5668\u3002\n        //\u521d\u59cb\u5316WebApplicationContext\uff0c\u8fd9\u4e2a\u9636\u6bb5\u4f1a\u4e3a\u6839\u5bb9\u5668\u548cWeb\u5bb9\u5668\u8fdb\u884c\u7236\u5b50\u5173\u7cfb\u5efa\u7acb\n        this.webApplicationContext = this.initWebApplicationContext();\n        this.initFrameworkServlet();\n    } catch (RuntimeException | ServletException var4) {\n      //...\u4ee5\u4e0b\u5185\u5bb9\u5168\u662f\u6253\u5370\u65e5\u5fd7\n}\n</code></pre> <p></p> <p>\u6211\u4eec\u6765\u770b\u770b<code>initWebApplicationContext</code>\u662f\u5982\u4f55\u8fdb\u884c\u521d\u59cb\u5316\u7684\uff1a</p> <pre><code>protected WebApplicationContext initWebApplicationContext() {\n    //\u8fd9\u91cc\u83b7\u53d6\u7684\u662f\u6839\u5bb9\u5668\uff0c\u4e00\u822c\u7528\u4e8e\u914d\u7f6eService\u3001\u6570\u636e\u6e90\u7b49\n    WebApplicationContext rootContext = WebApplicationContextUtils.getWebApplicationContext(this.getServletContext());\n    WebApplicationContext wac = null;\n    if (this.webApplicationContext != null) {\n        //\u5982\u679cwebApplicationContext\u5728\u4e4b\u524d\u5df2\u7ecf\u5b58\u5728\uff0c\u5219\u76f4\u63a5\u7ed9\u5230wac\n        wac = this.webApplicationContext;\n        if (wac instanceof ConfigurableWebApplicationContext) {\n            ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext)wac;\n            if (!cwac.isActive()) {\n                if (cwac.getParent() == null) {\n                    //\u8bbe\u5b9a\u6839\u5bb9\u5668\u4e3aWeb\u5bb9\u5668\u7684\u7236\u5bb9\u5668\n                    cwac.setParent(rootContext);\n                }\n\n                this.configureAndRefreshWebApplicationContext(cwac);\n            }\n        }\n    }\n\n    if (wac == null) {\n        //\u5982\u679cwebApplicationContext\u662f\u7a7a\uff0c\u90a3\u4e48\u5c31\u4eceServletContext\u627e\u4e00\u4e0b\u6709\u6ca1\u6709\u521d\u59cb\u5316\u4e0a\u4e0b\u6587\n        wac = this.findWebApplicationContext();\n    }\n\n    if (wac == null) {\n        //\u5982\u679c\u8fd8\u662f\u627e\u4e0d\u5230\uff0c\u76f4\u63a5\u521b\u4e2a\u65b0\u7684\uff0c\u5e76\u76f4\u63a5\u5c06\u6839\u5bb9\u5668\u4f5c\u4e3a\u7236\u5bb9\u5668\n        wac = this.createWebApplicationContext(rootContext);\n    }\n\n    if (!this.refreshEventReceived) {\n        synchronized(this.onRefreshMonitor) {\n            //\u6b64\u65b9\u6cd5\u7531DispatcherServlet\u5b9e\u73b0\n            this.onRefresh(wac);\n        }\n    }\n\n    if (this.publishContext) {\n        String attrName = this.getServletContextAttributeName();\n        //\u628aWeb\u5bb9\u5668\u4e22\u8fdbServletContext\n        this.getServletContext().setAttribute(attrName, wac);\n    }\n\n    return wac;\n}\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u6765\u770bDispatcherServlet\u4e2d\u5b9e\u73b0\u7684<code>onRefresh()</code>\u65b9\u6cd5\uff1a</p> <pre><code>@Override\nprotected void onRefresh(ApplicationContext context) {\n    initStrategies(context);\n}\n\nprotected void initStrategies(ApplicationContext context) {\n    //\u521d\u59cb\u5316\u5404\u79cd\u89e3\u6790\u5668\n    initMultipartResolver(context);\n    initLocaleResolver(context);\n    initThemeResolver(context);\n    //\u5728\u5bb9\u5668\u4e2d\u67e5\u627e\u6240\u6709\u7684HandlerMapping\uff0c\u653e\u5165\u96c6\u5408\u4e2d\n    //HandlerMapping\u4fdd\u5b58\u4e86\u6240\u6709\u7684\u8bf7\u6c42\u6620\u5c04\u4fe1\u606f\uff08Controller\u4e2d\u5b9a\u4e49\u7684\uff09\uff0c\u5b83\u53ef\u4ee5\u6839\u636e\u8bf7\u6c42\u627e\u5230\u5904\u7406\u5668Handler\uff0c\u4f46\u5e76\u4e0d\u662f\u7b80\u5355\u7684\u8fd4\u56de\u5904\u7406\u5668\uff0c\u800c\u662f\u5c06\u5904\u7406\u5668\u548c\u62e6\u622a\u5668\u5c01\u88c5\uff0c\u5f62\u6210\u4e00\u4e2a\u5904\u7406\u5668\u6267\u884c\u94fe\uff08\u7c7b\u4f3c\u4e8e\u4e4b\u524d\u7684Filter\uff09\n    initHandlerMappings(context);\n    //\u5728\u5bb9\u5668\u4e2d\u67e5\u627e\u6240\u6709\u7684HandlerAdapter\uff0c\u5b83\u7528\u4e8e\u5904\u7406\u8bf7\u6c42\u5e76\u8fd4\u56deModelAndView\u5bf9\u8c61\n    //\u9ed8\u8ba4\u6709\u4e09\u79cd\u5b9e\u73b0HttpRequestHandlerAdapter\uff0cSimpleControllerHandlerAdapter\u548cAnnotationMethodHandlerAdapter\n    //\u5f53HandlerMapping\u627e\u5230\u5904\u7406\u8bf7\u6c42\u7684Controller\u4e4b\u540e\uff0c\u4f1a\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684HandlerAdapter\u5904\u7406\u8bf7\u6c42\n    //\u6bd4\u5982\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u662f\u6ce8\u89e3\u65b9\u5f0f\u914d\u7f6eController\uff0c\u73b0\u5728\u6709\u4e00\u4e2a\u8bf7\u6c42\u643a\u5e26\u4e86\u4e00\u4e2a\u53c2\u6570\uff0c\u90a3\u4e48HandlerAdapter\u4f1a\u5bf9\u8bf7\u6c42\u7684\u6570\u636e\u8fdb\u884c\u89e3\u6790\uff0c\u5e76\u4f20\u5165\u65b9\u6cd5\u4f5c\u4e3a\u5b9e\u53c2\uff0c\u6700\u540e\u6839\u636e\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u5c06\u5176\u5c01\u88c5\u4e3aModelAndView\u5bf9\u8c61\n    initHandlerAdapters(context);\n    //\u5176\u4ed6\u7684\u5185\u5bb9\n    initHandlerExceptionResolvers(context);\n    initRequestToViewNameTranslator(context);\n    initViewResolvers(context);\n    initFlashMapManager(context);\n}\n</code></pre> <p>DispatcherServlet\u521d\u59cb\u5316\u8fc7\u7a0b\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u63a5\u7740\u6765\u770bDispatcherServlet\u662f\u5982\u4f55\u8fdb\u884c\u8c03\u5ea6\u7684\uff0c\u9996\u5148\u6211\u4eec\u7684\u8bf7\u6c42\u80af\u5b9a\u4f1a\u7ecf\u8fc7<code>HttpServlet</code>\uff0c\u7136\u540e\u5176\u4ea4\u7ed9\u5bf9\u5e94\u7684doGet\u3001doPost\u7b49\u65b9\u6cd5\u8fdb\u884c\u5904\u7406\uff0c\u800c\u5728<code>FrameworkServlet</code>\u4e2d\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u88ab\u91cd\u5199\uff0c\u5e76\u4e14\u4f7f\u7528<code>processRequest</code>\u6765\u8fdb\u884c\u5904\u7406\uff1a</p> <pre><code>protected final void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n    this.processRequest(request, response);\n}\n\nprotected final void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n    this.processRequest(request, response);\n}\n</code></pre> <p>\u6211\u4eec\u6765\u770b\u770b<code>processRequest</code>\u505a\u4e86\u4ec0\u4e48\uff1a</p> <pre><code>protected final void processRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {\n    //\u524d\u671f\u51c6\u5907\u5de5\u4f5c\n    long startTime = System.currentTimeMillis();\n    Throwable failureCause = null;\n    LocaleContext previousLocaleContext = LocaleContextHolder.getLocaleContext();\n    LocaleContext localeContext = this.buildLocaleContext(request);\n    RequestAttributes previousAttributes = RequestContextHolder.getRequestAttributes();\n    ServletRequestAttributes requestAttributes = this.buildRequestAttributes(request, response, previousAttributes);\n    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);\n    asyncManager.registerCallableInterceptor(FrameworkServlet.class.getName(), new FrameworkServlet.RequestBindingInterceptor());\n    this.initContextHolders(request, localeContext, requestAttributes);\n\n    try {\n        //\u91cd\u70b9\u5728\u8fd9\u91cc\uff0c\u8fd9\u91cc\u8fdb\u884c\u4e86Service\u7684\u6267\u884c\uff0c\u4e0d\u8fc7\u662f\u5728DispatcherServlet\u4e2d\u5b9a\u4e49\u7684\n        this.doService(request, response);\n    } catch (IOException | ServletException var16) {\n        //...\n}\n</code></pre> <p>\u8bf7\u5404\u4f4d\u4e00\u5b9a\u8981\u8010\u5fc3\uff0c\u8fd9\u4e9b\u5927\u578b\u6846\u67b6\u7684\u5e95\u5c42\u4e00\u822c\u90fd\u662f\u5c42\u5c42\u5957\u5a03\uff0c\u56e0\u4e3a\u8fd9\u6837\u5199\u8d77\u6765\u5c42\u6b21\u4f1a\u66f4\u52a0\u6e05\u6670\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770b<code>DispatcherServlet</code>\u4e2d\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1a</p> <pre><code>protected void doService(HttpServletRequest request, HttpServletResponse response) throws Exception {\n   //...\n    try {\n        //\u91cd\u70b9\u5728\u8fd9\u91cc\uff0c\u8fd9\u624d\u662f\u6574\u4e2a\u5904\u7406\u8fc7\u7a0b\u4e2d\u6700\u6838\u5fc3\u7684\u90e8\u5206\n        this.doDispatch(request, response);\n    } finally {\n        //...\n}\n</code></pre> <p>\u7ec8\u4e8e\u627e\u5230\u6700\u6838\u5fc3\u7684\u90e8\u5206\u4e86\uff1a</p> <pre><code>protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception {\n    HttpServletRequest processedRequest = request;\n    HandlerExecutionChain mappedHandler = null;\n    boolean multipartRequestParsed = false;\n    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);\n\n    try {\n        try {\n            ModelAndView mv = null;\n            Object dispatchException = null;\n\n            try {\n                processedRequest = this.checkMultipart(request);\n                multipartRequestParsed = processedRequest != request;\n                //\u5728HandlerMapping\u96c6\u5408\u4e2d\u5bfb\u627e\u53ef\u4ee5\u5904\u7406\u5f53\u524d\u8bf7\u6c42\u7684HandlerMapping\n                mappedHandler = this.getHandler(processedRequest);\n                if (mappedHandler == null) {\n                    this.noHandlerFound(processedRequest, response);\n                    //\u627e\u4e0d\u5230HandlerMapping\u5219\u65e0\u6cd5\u8fdb\u884c\u5904\u7406\n                    return;\n                }\n\n                //\u6839\u636eHandlerMapping\u63d0\u4f9b\u7684\u4fe1\u606f\uff0c\u627e\u5230\u53ef\u4ee5\u5904\u7406\u7684HandlerAdapter\n                HandlerAdapter ha = this.getHandlerAdapter(mappedHandler.getHandler());\n                String method = request.getMethod();\n                boolean isGet = HttpMethod.GET.matches(method);\n                if (isGet || HttpMethod.HEAD.matches(method)) {\n                    long lastModified = ha.getLastModified(request, mappedHandler.getHandler());\n                    if ((new ServletWebRequest(request, response)).checkNotModified(lastModified) &amp;&amp; isGet) {\n                        return;\n                    }\n                }\n\n                //\u6267\u884c\u6240\u6709\u62e6\u622a\u5668\u7684preHandle()\u65b9\u6cd5\n                if (!mappedHandler.applyPreHandle(processedRequest, response)) {\n                    return;\n                }\n\n                //\u4f7f\u7528HandlerAdapter\u8fdb\u884c\u5904\u7406\uff08\u6211\u4eec\u7f16\u5199\u7684\u8bf7\u6c42\u6620\u5c04\u65b9\u6cd5\u5728\u8fd9\u4e2a\u4f4d\u7f6e\u624d\u771f\u6b63\u5730\u6267\u884c\u4e86\uff09\n                //HandlerAdapter\u4f1a\u5e2e\u52a9\u6211\u4eec\u5c06\u8bf7\u6c42\u7684\u6570\u636e\u8fdb\u884c\u5904\u7406\uff0c\u518d\u6765\u8c03\u7528\u6211\u4eec\u7f16\u5199\u7684\u8bf7\u6c42\u6620\u5c04\u65b9\u6cd5\n                //\u6700\u540eHandlerAdapter\u4f1a\u5c06\u7ed3\u679c\u5c01\u88c5\u4e3aModelAndView\u8fd4\u56de\u7ed9mv\n                mv = ha.handle(processedRequest, response, mappedHandler.getHandler());\n                if (asyncManager.isConcurrentHandlingStarted()) {\n                    return;\n                }\n\n                this.applyDefaultViewName(processedRequest, mv);\n                //\u6267\u884c\u6240\u6709\u62e6\u622a\u5668\u7684postHandle()\u65b9\u6cd5\n                mappedHandler.applyPostHandle(processedRequest, response, mv);\n            } catch (Exception var20) {\n                dispatchException = var20;\n            } catch (Throwable var21) {\n                dispatchException = new NestedServletException(\"Handler dispatch failed\", var21);\n            }\n\n            //\u6700\u540e\u5904\u7406\u7ed3\u679c\uff0c\u5bf9\u89c6\u56fe\u8fdb\u884c\u6e32\u67d3\u7b49\uff0c\u5982\u679c\u629b\u51fa\u5f02\u5e38\u4f1a\u51fa\u73b0\u9519\u8bef\u9875\u9762\n            this.processDispatchResult(processedRequest, response, mappedHandler, mv, (Exception)dispatchException);\n        } catch (Exception var22) {\n            this.triggerAfterCompletion(processedRequest, response, mappedHandler, var22);\n        } catch (Throwable var23) {\n            this.triggerAfterCompletion(processedRequest, response, mappedHandler, new NestedServletException(\"Handler processing failed\", var23));\n        }\n\n    } finally {\n        if (asyncManager.isConcurrentHandlingStarted()) {\n            if (mappedHandler != null) {\n                mappedHandler.applyAfterConcurrentHandlingStarted(processedRequest, response);\n            }\n        } else if (multipartRequestParsed) {\n            this.cleanupMultipart(processedRequest);\n        }\n\n    }\n}\n</code></pre> <p>\u6240\u4ee5\uff0c\u6839\u636e\u4ee5\u4e0a\u6e90\u7801\u5206\u6790\u5f97\u51fa\u6700\u7ec8\u7684\u6d41\u7a0b\u56fe\uff1a</p> <p></p> <p>\u867d\u7136\u5b8c\u6210\u672c\u7ae0\u5b66\u4e60\u540e\uff0c\u6211\u4eec\u5df2\u7ecf\u57fa\u672c\u80fd\u591f\u57fa\u4e8eSpring\u53bb\u91cd\u65b0\u7f16\u5199\u4e00\u4e2a\u66f4\u52a0\u9ad8\u7ea7\u7684\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u4e86\uff0c\u4f46\u662f\u767b\u9646\u9a8c\u8bc1\u590d\u6742\u7684\u95ee\u9898\u4f9d\u7136\u6ca1\u6709\u89e3\u51b3\uff0c\u5982\u679c\u6211\u4eec\u4f9d\u7136\u6309\u7167\u4e4b\u524d\u7684\u65b9\u5f0f\u7f16\u5199\u767b\u9646\u9a8c\u8bc1\uff0c\u663e\u7136\u592a\u8fc7\u7b80\u5355\uff0c\u5b83\u4ec5\u4ec5\u53ea\u662f\u4e00\u4e2a\u767b\u9646\uff0c\u4f46\u662f\u6ca1\u6709\u4efb\u4f55\u7684\u6743\u9650\u5212\u5206\u6216\u662f\u52a0\u5bc6\u5904\u7406\uff0c\u6211\u4eec\u9700\u8981\u66f4\u52a0\u9ad8\u7ea7\u7684\u6743\u9650\u6821\u9a8c\u6846\u67b6\u6765\u5e2e\u52a9\u6211\u4eec\u5b9e\u73b0\u767b\u9646\u64cd\u4f5c\uff0c\u4e0b\u4e00\u7ae0\uff0c\u6211\u4eec\u4f1a\u8be6\u7ec6\u8bb2\u89e3\u5982\u4f55\u4f7f\u7528\u66f4\u52a0\u9ad8\u7ea7\u7684SpringSecurity\u6846\u67b6\u6765\u8fdb\u884c\u6743\u9650\u9a8c\u8bc1\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/","title":"SpringMVC","text":"<p>MVC\u67b6\u6784</p> <p>)</p> <p>MVC\u8be6\u7ec6\u89e3\u91ca\u5982\u4e0b\uff1a</p> <ul> <li>M\u662f\u6307\u4e1a\u52a1\u6a21\u578b\uff08Model\uff09\uff1a\u901a\u4fd7\u7684\u8bb2\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u7528\u4e8e\u5c01\u88c5\u6570\u636e\u4f20\u9012\u7684\u5b9e\u4f53\u7c7b\u3002</li> <li>V\u662f\u6307\u7528\u6237\u754c\u9762\uff08View\uff09\uff1a\u4e00\u822c\u6307\u7684\u662f\u524d\u7aef\u9875\u9762\u3002</li> <li>C\u5219\u662f\u63a7\u5236\u5668\uff08Controller\uff09\uff1a\u63a7\u5236\u5668\u5c31\u76f8\u5f53\u4e8eServlet\u7684\u57fa\u672c\u529f\u80fd\uff0c\u5904\u7406\u8bf7\u6c42\uff0c\u8fd4\u56de\u54cd\u5e94\u3002</li> </ul> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_1","title":"\u73af\u5883\u914d\u7f6e","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#xml","title":"xml\u6587\u4ef6\u914d\u7f6e","text":"<p>pom.xml</p> <pre><code>&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;  \n    &lt;version&gt;6.0.11&lt;/version&gt;  \n&lt;/dependency&gt;\n</code></pre> <p>\u521d\u59cb\u7ed3\u6784: <pre><code>src\n.\n\u251c\u2500\u2500 main\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 java\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 com\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 example\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u2514\u2500\u2500 springmvc\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0             \u2514\u2500\u2500 HelloServlet.java\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 resources\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 webapp\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 index.jsp\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 WEB-INF\n\u2502\u00a0\u00a0         \u2514\u2500\u2500 web.xml\n\u2514\u2500\u2500 test\n    \u251c\u2500\u2500 java\n    \u2514\u2500\u2500 resources\n</code></pre></p> <p>\u4fee\u6539web.xml, \u5c06DispatcherServlet\u66ff\u6362\u6389Tomcat\u81ea\u5e26\u7684Servlet\uff0c\u8fd9\u91ccurl-pattern\u9700\u8981\u5199\u4e3a<code>/</code>\uff0c\u5373\u53ef\u5b8c\u6210\u66ff\u6362</p> <p>src/main/webapp/WEB-INF/web.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app xmlns=\"https://jakarta.ee/xml/ns/jakartaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd\"\n         version=\"5.0\"&gt;\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;mvc&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;/servlet&gt;\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;mvc&lt;/servlet-name&gt; &lt;!-- \u540d\u5b57\u8981\u76f8\u540c --&gt;\n        &lt;url-pattern&gt;/&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n</code></pre> <p>\u63a5\u7740\u9700\u8981\u4e3a\u6574\u4e2aWeb\u5e94\u7528\u7a0b\u5e8f\u914d\u7f6e\u4e00\u4e2aSpring\u4e0a\u4e0b\u6587\u73af\u5883\uff08\u4e5f\u5c31\u662f\u5bb9\u5668\uff09\uff0c\u56e0\u4e3aSpringMVC\u662f\u57fa\u4e8eSpring\u5f00\u53d1\u7684\uff0c\u5b83\u76f4\u63a5\u5229\u7528Spring\u63d0\u4f9b\u7684\u5bb9\u5668\u6765\u5b9e\u73b0\u5404\u79cd\u529f\u80fd\uff0c\u90a3\u4e48\u7b2c\u4e00\u6b65\u4f9d\u7136\u8ddf\u4e4b\u524d\u4e00\u6837\uff0c\u9700\u8981\u7f16\u5199\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff1a</p> <p>main/resources/\u914d\u7f6e\u6587\u4ef6.xml <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n&lt;/beans&gt;\n</code></pre></p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u4e3aDispatcherServlet\u914d\u7f6e\u4e00\u4e9b\u521d\u59cb\u5316\u53c2\u6570\u6765\u6307\u5b9a\u521a\u521a\u521b\u5efa\u7684\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>&lt;servlet&gt;\n    &lt;servlet-name&gt;mvc&lt;/servlet-name&gt;\n    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n    &lt;init-param&gt;\n        &lt;!--     \u6307\u5b9a\u6211\u4eec\u521a\u521a\u521b\u5efa\u5728\u7c7b\u8def\u5f84\u4e0b\u7684XML\u914d\u7f6e\u6587\u4ef6       --&gt;\n        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n        &lt;param-value&gt;classpath:\u914d\u7f6e\u6587\u4ef6.xml&lt;/param-value&gt;\n    &lt;/init-param&gt;\n&lt;/servlet&gt;\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u57fa\u672c\u7684\u914d\u7f6e\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#controller","title":"\u521b\u5efa\u4e00\u4e2aController\u7c7b","text":"<p>src/main/java/org/example/controller/MainController.java</p> <pre><code>@Controller\npublic class MainController {\n    @ResponseBody\n    @RequestMapping(\"/\")\n    public String hello(){\n        return \"HelloWorld!\";\n    }\n}\n</code></pre> <p>\u5c06\u8fd9\u4e2a\u7c7b\u6ce8\u518c\u4e3aBean</p> <p>src/main/resources/spring.xml</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xmlns:context=\"http://www.springframework.org/schema/context\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd\"&gt;\n    &lt;!-- \u9700\u8981\u5148\u5f15\u5165context\u547d\u540d\u7a7a\u95f4\uff0c\u7136\u540e\u76f4\u63a5\u914d\u7f6ebase-package\u5c5e\u6027\u5c31\u53ef\u4ee5\u4e86 --&gt;\n    &lt;context:component-scan base-package=\"com.example\"/&gt;\n&lt;/beans&gt;\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_2","title":"\u5168\u6ce8\u89e3\u914d\u7f6e","text":"<p>pom.xml</p> <pre><code>&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;  \n    &lt;version&gt;6.0.11&lt;/version&gt;  \n&lt;/dependency&gt;\n</code></pre> <p>\u7ed3\u6784\uff1a <pre><code>.\n\u251c\u2500\u2500 main\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 java\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 com\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0     \u2514\u2500\u2500 example\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u251c\u2500\u2500 config\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u251c\u2500\u2500 MainInitializer.java\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u2502\u00a0\u00a0 \u2514\u2500\u2500 WebConfiguration.java\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0         \u2514\u2500\u2500 controller\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0             \u2514\u2500\u2500 HelloController.java\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 resources\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 webapp\n\u2514\u2500\u2500 test\n    \u251c\u2500\u2500 java\n    \u2514\u2500\u2500 resources\n</code></pre></p> <p>src/main/java/com/example/config/MainInitializer.java</p> <pre><code>public class MainInitializer extends AbstractAnnotationConfigDispatcherServletInitializer {\n\n    @Override\n    protected Class&lt;?&gt;[] getRootConfigClasses() {\n        return new Class[]{WebConfiguration.class};   //\u57fa\u672c\u7684Spring\u914d\u7f6e\u7c7b\uff0c\u4e00\u822c\u7528\u4e8e\u4e1a\u52a1\u5c42\u914d\u7f6e\n    }\n\n    @Override\n    protected Class&lt;?&gt;[] getServletConfigClasses() {\n        return new Class[0];  //\u914d\u7f6eDispatcherServlet\u7684\u914d\u7f6e\u7c7b\u3001\u4e3b\u8981\u7528\u4e8eController\u7b49\u914d\u7f6e\uff0c\u8fd9\u91cc\u4e3a\u4e86\u6559\u5b66\u7b80\u5355\uff0c\u5c31\u4e0d\u5206\u8fd9\u4e48\u8be6\u7ec6\u4e86\uff0c\u53ea\u4f7f\u7528\u4e0a\u9762\u7684\u57fa\u672c\u914d\u7f6e\u7c7b\n    }\n\n    @Override\n    protected String[] getServletMappings() {\n        return new String[]{\"/\"};    //\u5339\u914d\u8def\u5f84\uff0c\u4e0e\u4e0a\u9762\u4e00\u81f4\n    }\n}\n</code></pre> <p>src/main/java/com/example/config/WebConfiguration.java</p> <pre><code>@Configuration\n@EnableWebMvc   //\u5feb\u901f\u914d\u7f6eSpringMvc\u6ce8\u89e3\uff0c\u5982\u679c\u4e0d\u6dfb\u52a0\u6b64\u6ce8\u89e3\u4f1a\u5bfc\u81f4\u540e\u7eed\u65e0\u6cd5\u901a\u8fc7\u5b9e\u73b0WebMvcConfigurer\u63a5\u53e3\u8fdb\u884c\u81ea\u5b9a\u4e49\u914d\u7f6e\n@ComponentScan(\"com.example.controller\")\npublic class WebConfiguration implements WebMvcConfigurer{\n\n\n}\n</code></pre> <p>src/main/java/com/example/controller/HelloController.java</p> <pre><code>@Controller\npublic class HelloController {\n    @ResponseBody\n    @RequestMapping(\"/\")\n    public String hello() {\n        return \"Hello, World!\";\n    }\n}\n</code></pre> <p>\u6709\u4e86SpringMVC\u4e4b\u540e\uff0c\u6211\u4eec\u4e0d\u5fc5\u518d\u50cf\u4e4b\u524d\u90a3\u6837\u4e00\u4e2a\u8bf7\u6c42\u5730\u5740\u521b\u5efa\u4e00\u4e2aServlet\u4e86\uff0c\u5b83\u4f7f\u7528<code>DispatcherServlet</code>\u66ff\u4ee3Tomcat\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u9ed8\u8ba4\u7684\u9759\u6001\u8d44\u6e90Servlet\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u73b0\u5728\u6240\u6709\u7684\u8bf7\u6c42\uff08\u9664\u4e86jsp\uff0c\u56e0\u4e3aTomcat\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2ajsp\u7684Servlet\uff09\u90fd\u4f1a\u7ecf\u8fc7<code>DispatcherServlet</code>\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u90a3\u4e48<code>DispatcherServlet</code>\u4f1a\u5e2e\u52a9\u6211\u4eec\u505a\u4ec0\u4e48\u5462\uff1f</p> <p></p> <p>\u6839\u636e\u56fe\u7247\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\uff0c\u6211\u4eec\u7684\u8bf7\u6c42\u5230\u8fbeTomcat\u670d\u52a1\u5668\u4e4b\u540e\uff0c\u4f1a\u4ea4\u7ed9\u5f53\u524d\u7684Web\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u5904\u7406\uff0c\u800cSpringMVC\u4f7f\u7528<code>DispatcherServlet</code>\u6765\u5904\u7406\u6240\u6709\u7684\u8bf7\u6c42\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u88ab\u4f5c\u4e3a\u4e00\u4e2a\u7edf\u4e00\u7684\u8bbf\u95ee\u70b9\uff0c\u6240\u6709\u7684\u8bf7\u6c42\u5168\u90e8\u7531\u5b83\u6765\u8fdb\u884c\u8c03\u5ea6\u3002</p> <p>\u5f53\u4e00\u4e2a\u8bf7\u6c42\u7ecf\u8fc7<code>DispatcherServlet</code>\u4e4b\u540e\uff0c\u4f1a\u5148\u8d70<code>HandlerMapping</code>\uff0c\u5b83\u4f1a\u5c06\u8bf7\u6c42\u6620\u5c04\u4e3a<code>HandlerExecutionChain</code>\uff0c\u4f9d\u6b21\u7ecf\u8fc7<code>HandlerInterceptor</code>\u6709\u70b9\u7c7b\u4f3c\u4e8e\u4e4b\u524d\u6211\u4eec\u6240\u5b66\u7684\u8fc7\u6ee4\u5668\uff0c\u4e0d\u8fc7\u5728SpringMVC\u4e2d\u6211\u4eec\u4f7f\u7528\u7684\u662f\u62e6\u622a\u5668\uff0c\u7136\u540e\u518d\u4ea4\u7ed9<code>HandlerAdapter</code>\uff0c\u6839\u636e\u8bf7\u6c42\u7684\u8def\u5f84\u9009\u62e9\u5408\u9002\u7684\u63a7\u5236\u5668\u8fdb\u884c\u5904\u7406\uff0c\u63a7\u5236\u5668\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a<code>ModelAndView</code>\u5bf9\u8c61\uff0c\u5305\u62ec\u6570\u636e\u6a21\u578b\u548c\u89c6\u56fe\uff0c\u901a\u4fd7\u7684\u8bb2\u5c31\u662f\u9875\u9762\u4e2d\u6570\u636e\u548c\u9875\u9762\u672c\u8eab\uff08\u53ea\u5305\u542b\u89c6\u56fe\u540d\u79f0\u5373\u53ef\uff09\u3002</p> <p>\u8fd4\u56de<code>ModelAndView</code>\u4e4b\u540e\uff0c\u4f1a\u4ea4\u7ed9<code>ViewResolver</code>\uff08\u89c6\u56fe\u89e3\u6790\u5668\uff09\u8fdb\u884c\u5904\u7406\uff0c\u89c6\u56fe\u89e3\u6790\u5668\u4f1a\u5bf9\u6574\u4e2a\u89c6\u56fe\u9875\u9762\u8fdb\u884c\u89e3\u6790\uff0cSpringMVC\u81ea\u5e26\u4e86\u4e00\u4e9b\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u4f46\u662f\u53ea\u9002\u7528\u4e8eJSP\u9875\u9762\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u50cf\u4e4b\u524d\u4e00\u6837\u4f7f\u7528Thymeleaf\u4f5c\u4e3a\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u6839\u636e\u7ed9\u5b9a\u7684\u89c6\u56fe\u540d\u79f0\uff0c\u76f4\u63a5\u8bfb\u53d6HTML\u7f16\u5199\u7684\u9875\u9762\uff0c\u89e3\u6790\u4e3a\u4e00\u4e2a\u771f\u6b63\u7684View\u3002</p> <p>\u89e3\u6790\u5b8c\u6210\u540e\uff0c\u5c31\u9700\u8981\u5c06\u9875\u9762\u4e2d\u7684\u6570\u636e\u5168\u90e8\u6e32\u67d3\u5230View\u4e2d\uff0c\u6700\u540e\u8fd4\u56de\u7ed9<code>DispatcherServlet</code>\u4e00\u4e2a\u5305\u542b\u6240\u6709\u6570\u636e\u7684\u6210\u5f62\u9875\u9762\uff0c\u518d\u54cd\u5e94\u7ed9\u6d4f\u89c8\u5668\uff0c\u5b8c\u6210\u6574\u4e2a\u8fc7\u7a0b\u3002</p> <p>\u56e0\u6b64\uff0c\u5b9e\u9645\u4e0a\u6574\u4e2a\u8fc7\u7a0b\u6211\u4eec\u53ea\u9700\u8981\u7f16\u5199\u5bf9\u5e94\u8bf7\u6c42\u8def\u5f84\u7684\u7684Controller\u4ee5\u53ca\u914d\u7f6e\u597d\u6211\u4eec\u9700\u8981\u7684ViewResolver\u5373\u53ef\uff0c\u4e4b\u540e\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u8865\u5145\u6dfb\u52a0\u62e6\u622a\u5668\uff0c\u800c\u5176\u4ed6\u7684\u6d41\u7a0b\u5df2\u7ecf\u7531SpringMVC\u5e2e\u52a9\u6211\u4eec\u5b8c\u6210\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_3","title":"\u89c6\u56fe\u89e3\u6790\u5668\u914d\u7f6e","text":"<p>\u4f9d\u8d56</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u5b9e\u73b0\u6700\u57fa\u672c\u7684\u9875\u9762\u89e3\u6790\u5e76\u8fd4\u56de\uff0c\u7b2c\u4e00\u6b65\u5c31\u662f\u914d\u7f6e\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528Thymeleaf\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u5bfc\u5165\u9700\u8981\u7684\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.thymeleaf&lt;/groupId&gt;\n    &lt;artifactId&gt;thymeleaf-spring6&lt;/artifactId&gt;\n    &lt;version&gt;3.1.1.RELEASE&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u4fee\u6539\uff1asrc/main/java/com/example/config/WebConfiguration.java</p> <pre><code>@Configuration\n@EnableWebMvc\n@ComponentScan(\"com.example.controller\")\npublic class WebConfiguration implements WebMvcConfigurer{\n    //\u6211\u4eec\u9700\u8981\u4f7f\u7528ThymeleafViewResolver\u4f5c\u4e3a\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u5e76\u89e3\u6790\u6211\u4eec\u7684HTML\u9875\u9762\n    @Bean\n    public ThymeleafViewResolver thymeleafViewResolver(SpringTemplateEngine springTemplateEngine){\n        ThymeleafViewResolver resolver = new ThymeleafViewResolver();\n        resolver.setOrder(1);   //\u53ef\u4ee5\u5b58\u5728\u591a\u4e2a\u89c6\u56fe\u89e3\u6790\u5668\uff0c\u5e76\u4e14\u53ef\u4ee5\u4e3a\u4ed6\u4eec\u8bbe\u5b9a\u89e3\u6790\u987a\u5e8f\n        resolver.setCharacterEncoding(\"UTF-8\");   //\u7f16\u7801\u683c\u5f0f\u662f\u91cd\u4e2d\u4e4b\u91cd\n        resolver.setTemplateEngine(springTemplateEngine);   //\u548c\u4e4b\u524dJavaWeb\u9636\u6bb5\u4e00\u6837\uff0c\u9700\u8981\u4f7f\u7528\u6a21\u677f\u5f15\u64ce\u8fdb\u884c\u89e3\u6790\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e5f\u9700\u8981\u8bbe\u5b9a\u4e00\u4e0b\u6a21\u677f\u5f15\u64ce\n        return resolver;\n    }\n\n    //\u914d\u7f6e\u6a21\u677f\u89e3\u6790\u5668\n    @Bean\n    public SpringResourceTemplateResolver templateResolver(){\n        SpringResourceTemplateResolver resolver = new SpringResourceTemplateResolver();\n        resolver.setSuffix(\".html\");   //\u9700\u8981\u89e3\u6790\u7684\u540e\u7f00\u540d\u79f0\n        resolver.setPrefix(\"classpath:\");   //\u9700\u8981\u89e3\u6790\u7684HTML\u9875\u9762\u6587\u4ef6\u5b58\u653e\u7684\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u662fwebapp\u76ee\u5f55\u4e0b\uff0c\u5982\u679c\u662f\u7c7b\u8def\u5f84\u4e0b\u9700\u8981\u6dfb\u52a0classpath:\u524d\u7f00\n        return resolver;\n    }\n\n    //\u914d\u7f6e\u6a21\u677f\u5f15\u64ceBean\n    @Bean\n    public SpringTemplateEngine springTemplateEngine(ITemplateResolver resolver){\n        SpringTemplateEngine engine = new SpringTemplateEngine();\n        engine.setTemplateResolver(resolver);   //\u6a21\u677f\u89e3\u6790\u5668\uff0c\u9ed8\u8ba4\u5373\u53ef\n        return engine;\n    }\n\n    @Override\n    public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) {\n        converters.add(new FastJsonHttpMessageConverter());\n    }\n}\n</code></pre> <p>\u521b\u5efaController</p> <p>src/main/java/com/example/controller/HelloController.java</p> <pre><code>@Controller //\u76f4\u63a5\u6dfb\u52a0\u6ce8\u89e3\u5373\u53ef\npublic class HelloController {\n    @ResponseBody\n    @RequestMapping(\"/\") //\u76f4\u63a5\u586b\u5199\u8bbf\u95ee\u8def\u5f84\n    public ModelAndView hello() {\n        return new ModelAndView(\"index\"); //\u8fd4\u56deModelAndView\u5bf9\u8c61\uff0c\u8fd9\u91cc\u586b\u5165\u4e86\u89c6\u56fe\u7684\u540d\u79f0\n        //\u8fd4\u56de\u540e\u4f1a\u7ecf\u8fc7\u89c6\u56fe\u89e3\u6790\u5668\u8fdb\u884c\u5904\u7406\n    }\n}\n</code></pre> <p>index.html</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;p&gt;This is a test page&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u6211\u4eec\u5728\u4e4b\u524d\uff0c\u4f7f\u7528Thymeleaf\u89e3\u6790\u540e\u7aef\u7684\u4e00\u4e9b\u6570\u636e\u65f6\uff0c\u9700\u8981\u901a\u8fc7Context\u8fdb\u884c\u4f20\u9012\uff0c\u800c\u4f7f\u7528SpringMvc\u540e\uff0c\u6570\u636e\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5411Model\u6a21\u578b\u5c42\u8fdb\u884c\u63d0\u4f9b\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(){\n    ModelAndView modelAndView = new ModelAndView(\"index\");\n    modelAndView.getModel().put(\"name\", \"\u554a\u8fd9\");   //\u5c06name\u4f20\u9012\u7ed9Model\n    return modelAndView;\n}\n</code></pre> <p>\u8fd9\u6837Thymeleaf\u5c31\u80fd\u6536\u5230\u6211\u4eec\u4f20\u9012\u7684\u6570\u636e\u8fdb\u884c\u89e3\u6790\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\" xmlns:th=\"http://www.thymeleaf.org\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;script src=\"static/test.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    HelloWorld\uff01\n    &lt;div th:text=\"${name}\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u5f53\u7136\uff0c\u4e3a\u4e86\u7b80\u4fbf\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56deView\u540d\u79f0\uff0cSpringMVC\u4f1a\u5c06\u5176\u81ea\u52a8\u5305\u88c5\u4e3aModelAndView\u5bf9\u8c61\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic String index(){\n    return \"index\";\n}\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5355\u72ec\u6dfb\u52a0\u4e00\u4e2aModel\u4f5c\u4e3a\u5f62\u53c2\u8fdb\u884c\u8bbe\u7f6e\uff0cSpringMVC\u901a\u8fc7\u4f9d\u8d56\u6ce8\u5165\u4f1a\u81ea\u52a8\u5e2e\u52a9\u6211\u4eec\u4f20\u9012\u5b9e\u4f8b\u5bf9\u8c61\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic String index(Model model){  //\u8fd9\u91cc\u4e0d\u4ec5\u4ec5\u53ef\u4ee5\u662fModel\uff0c\u8fd8\u53ef\u4ee5\u662fMap\u3001ModelMap\n    model.addAttribute(\"name\", \"yyds\");\n    return \"index\";\n}\n</code></pre> <p>\u914d\u7f6e\u89c6\u56fe\u89e3\u6790\u5668\u548c\u63a7\u5236\u5668</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_4","title":"\u6838\u5fc3\u5185\u5bb9","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#requestmapping","title":"@RequestMapping","text":"<pre><code>@Controller \npublic class HelloController {\n    @ResponseBody\n    @RequestMapping(\"/\",\"/hello\",\"test\") //\u8def\u5f84\u5fc5\u987b\u5168\u5c40\u552f\u4e00\uff0c\u4e0d\u80fd\u91cd\u590d\n    public ModelAndView hello() {\n        return new ModelAndView(\"index\"); \n    }\n\n}\n</code></pre> <p>\u8def\u5f84\u8fd8\u652f\u6301\u4f7f\u7528\u901a\u914d\u7b26\u8fdb\u884c\u5339\u914d</p> <p>/text/a? ==&gt;  /test/a /test/aa /test/ab /test/x* /test/*  </p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_5","title":"\u9650\u5b9a\u8bf7\u6c42\u65b9\u5f0f","text":"<pre><code>@RequestMapping(value = \"/index\", method = RequestMethod.POST)\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u884d\u751f\u6ce8\u89e3\u76f4\u63a5\u8bbe\u5b9a\u4e3a\u6307\u5b9a\u7c7b\u578b\u7684\u8bf7\u6c42\u6620\u5c04\uff1a</p> <p>@PostMapping @GetMapping</p> <pre><code>@PostMapping(value = \"/index\")\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>params</code>\u5c5e\u6027\u6765\u6307\u5b9a\u8bf7\u6c42\u5fc5\u987b\u643a\u5e26\u54ea\u4e9b\u8bf7\u6c42\u53c2\u6570\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", params = {\"username\", \"password\"})\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6bd4\u5982\u8fd9\u91cc\u6211\u4eec\u8981\u6c42\u8bf7\u6c42\u4e2d\u5fc5\u987b\u643a\u5e26<code>username</code>\u548c<code>password</code>\u5c5e\u6027\uff0c\u5426\u5219\u65e0\u6cd5\u8bbf\u95ee\u3002\u5b83\u8fd8\u652f\u6301\u8868\u8fbe\u5f0f\uff0c\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u7f16\u5199\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", params = {\"!username\", \"password\"})\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u5728username\u4e4b\u524d\u6dfb\u52a0\u4e00\u4e2a\u611f\u53f9\u53f7\u8868\u793a\u8bf7\u6c42\u7684\u4e0d\u5141\u8bb8\u643a\u5e26\u6b64\u53c2\u6570\uff0c\u5426\u5219\u65e0\u6cd5\u8bbf\u95ee\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u8bbe\u5b9a\u4e00\u4e2a\u56fa\u5b9a\u503c\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", params = {\"username!=test\", \"password=123\"})\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u8bf7\u6c42\u53c2\u6570username\u4e0d\u5141\u8bb8\u4e3atest\uff0c\u5e76\u4e14password\u5fc5\u987b\u4e3a123\uff0c\u5426\u5219\u65e0\u6cd5\u8bbf\u95ee\u3002</p> <p><code>header</code>\u5c5e\u6027\u7528\u6cd5\u4e0e<code>params</code>\u4e00\u81f4\uff0c\u4f46\u662f\u5b83\u8981\u6c42\u7684\u662f\u8bf7\u6c42\u5934\u4e2d\u9700\u8981\u643a\u5e26\u4ec0\u4e48\u5185\u5bb9\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", headers = \"!Connection\")\npublic ModelAndView index(){\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u90a3\u4e48\uff0c\u5982\u679c\u8bf7\u6c42\u5934\u4e2d\u643a\u5e26\u4e86<code>Connection</code>\u5c5e\u6027\uff0c\u5c06\u65e0\u6cd5\u8bbf\u95ee\u3002\u5176\u4ed6\u4e24\u4e2a\u5c5e\u6027\uff1a</p> <ul> <li>consumes\uff1a \u6307\u5b9a\u5904\u7406\u8bf7\u6c42\u7684\u63d0\u4ea4\u5185\u5bb9\u7c7b\u578b\uff08Content-Type\uff09\uff0c\u4f8b\u5982application/json, text/html;</li> <li>produces:  \u6307\u5b9a\u8fd4\u56de\u7684\u5185\u5bb9\u7c7b\u578b\uff0c\u4ec5\u5f53request\u8bf7\u6c42\u5934\u4e2d\u7684(Accept)\u7c7b\u578b\u4e2d\u5305\u542b\u8be5\u6307\u5b9a\u7c7b\u578b\u624d\u8fd4\u56de\uff1b</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_6","title":"\u8bf7\u6c42\u53c2\u6570\u83b7\u53d6","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#requestparamrequestheader","title":"@RequestParam\u3001@RequestHeader","text":"<p>\u6211\u4eec\u53ea\u9700\u8981\u4e3a\u65b9\u6cd5\u6dfb\u52a0\u4e00\u4e2a\u5f62\u5f0f\u53c2\u6570\uff0c\u5e76\u5728\u5f62\u5f0f\u53c2\u6570\u524d\u9762\u6dfb\u52a0<code>@RequestParam</code>\u6ce8\u89e3\u5373\u53ef\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(@RequestParam(\"username\") String username){\n    System.out.println(\"\u63a5\u53d7\u5230\u8bf7\u6c42\u53c2\u6570\uff1a\"+username);\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6211\u4eec\u9700\u8981\u5728<code>@RequestParam</code>\u4e2d\u586b\u5199\u53c2\u6570\u540d\u79f0\uff0c\u53c2\u6570\u7684\u503c\u4f1a\u81ea\u52a8\u4f20\u9012\u7ed9\u5f62\u5f0f\u53c2\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u65b9\u6cd5\u4e2d\u4f7f\u7528\uff0c\u6ce8\u610f\uff0c\u5982\u679c\u53c2\u6570\u540d\u79f0\u4e0e\u5f62\u5f0f\u53c2\u6570\u540d\u79f0\u76f8\u540c\uff0c\u5373\u4f7f\u4e0d\u6dfb\u52a0<code>@RequestParam</code>\u4e5f\u80fd\u83b7\u53d6\u5230\u53c2\u6570\u503c\u3002</p> <p>\u4e00\u65e6\u6dfb\u52a0<code>@RequestParam</code>\uff0c\u90a3\u4e48\u6b64\u8bf7\u6c42\u5fc5\u987b\u643a\u5e26\u6307\u5b9a\u53c2\u6570\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06require\u5c5e\u6027\u8bbe\u5b9a\u4e3afalse\u6765\u5c06\u5c5e\u6027\u8bbe\u5b9a\u4e3a\u975e\u5fc5\u987b\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(@RequestParam(value = \"username\", required = false) String username){\n    System.out.println(\"\u63a5\u53d7\u5230\u8bf7\u6c42\u53c2\u6570\uff1a\"+username);\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u76f4\u63a5\u8bbe\u5b9a\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u5f53\u8bf7\u6c42\u53c2\u6570\u7f3a\u5931\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u9ed8\u8ba4\u503c\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(@RequestParam(value = \"username\", required = false, defaultValue = \"\u4f1e\u5175\u4e00\u53f7\") String username){\n    System.out.println(\"\u63a5\u53d7\u5230\u8bf7\u6c42\u53c2\u6570\uff1a\"+username);\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u5982\u679c\u9700\u8981\u4f7f\u7528Servlet\u539f\u672c\u7684\u4e00\u4e9b\u7c7b\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(HttpServletRequest request){\n    System.out.println(\"\u63a5\u53d7\u5230\u8bf7\u6c42\u53c2\u6570\uff1a\"+request.getParameterMap().keySet());\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u76f4\u63a5\u6dfb\u52a0<code>HttpServletRequest</code>\u4e3a\u5f62\u5f0f\u53c2\u6570\u5373\u53ef\uff0cSpringMVC\u4f1a\u81ea\u52a8\u4f20\u9012\u8be5\u8bf7\u6c42\u539f\u672c\u7684<code>HttpServletRequest</code>\u5bf9\u8c61\uff0c\u540c\u7406\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6dfb\u52a0<code>HttpServletResponse</code>\u4f5c\u4e3a\u5f62\u5f0f\u53c2\u6570\uff0c\u751a\u81f3\u53ef\u4ee5\u76f4\u63a5\u5c06HttpSession\u4e5f\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(HttpSession session){\n    System.out.println(session.getAttribute(\"test\"));\n    session.setAttribute(\"test\", \"\u9e21\u4f60\u592a\u7f8e\");\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u76f4\u63a5\u5c06\u8bf7\u6c42\u53c2\u6570\u4f20\u9012\u7ed9\u4e00\u4e2a\u5b9e\u4f53\u7c7b\uff1a</p> <pre><code>@Data\npublic class User {\n    String username;\n    String password;\n}\n</code></pre> <p>\u6ce8\u610f\u5fc5\u987b\u643a\u5e26set\u65b9\u6cd5\u6216\u662f\u6784\u9020\u65b9\u6cd5\u4e2d\u5305\u542b\u6240\u6709\u53c2\u6570\uff0c\u8bf7\u6c42\u53c2\u6570\u4f1a\u81ea\u52a8\u6839\u636e\u7c7b\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\u8fdb\u884c\u5339\u914d\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(User user){\n    System.out.println(\"\u83b7\u53d6\u5230cookie\u503c\u4e3a\uff1a\"+user);\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p><code>@RequestHeader</code>\u4e0e<code>@RequestParam</code>\u7528\u6cd5\u4e00\u81f4\uff0c\u4e0d\u8fc7\u5b83\u662f\u7528\u4e8e\u83b7\u53d6\u8bf7\u6c42\u5934\u53c2\u6570\u7684\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u6f14\u793a\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#cookievaluesessionattrbutie","title":"@CookieValue\u3001@SessionAttrbutie","text":"<p>\u901a\u8fc7\u4f7f\u7528<code>@CookieValue</code>\u6ce8\u89e3\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5feb\u901f\u83b7\u53d6\u8bf7\u6c42\u643a\u5e26\u7684Cookie\u4fe1\u606f\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(HttpServletResponse response,\n                          @CookieValue(value = \"test\", required = false) String test){\n    System.out.println(\"\u83b7\u53d6\u5230cookie\u503c\u4e3a\uff1a\"+test);\n    response.addCookie(new Cookie(\"test\", \"lbwnb\"));\n    return new ModelAndView(\"index\");\n}\n</code></pre> <p>\u540c\u6837\u7684\uff0cSession\u4e5f\u80fd\u4f7f\u7528\u6ce8\u89e3\u5feb\u901f\u83b7\u53d6\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic ModelAndView index(@SessionAttribute(value = \"test\", required = false) String test,\n                          HttpSession session){\n    session.setAttribute(\"test\", \"xxxx\");\n    System.out.println(test);\n    return new ModelAndView(\"index\");\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_7","title":"\u91cd\u5b9a\u5411\u548c\u8bf7\u6c42\u8f6c\u53d1","text":"<p>\u91cd\u5b9a\u5411\u548c\u8bf7\u6c42\u8f6c\u53d1\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u89c6\u56fe\u540d\u79f0\u524d\u9762\u6dfb\u52a0\u4e00\u4e2a\u524d\u7f00\u5373\u53ef\uff0c\u6bd4\u5982\u91cd\u5b9a\u5411\uff1a</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(){\n    return \"redirect:home\";\n}\n\n@RequestMapping(\"/home\")\npublic String home(){\n    return \"home\";\n}\n</code></pre> <p>\u901a\u8fc7\u6dfb\u52a0<code>redirect:</code>\u524d\u7f00\uff0c\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u5b9e\u73b0\u91cd\u5b9a\u5411\uff0c\u90a3\u4e48\u8bf7\u6c42\u8f6c\u53d1\u5462\uff0c\u5176\u5b9e\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u4f7f\u7528<code>forward:</code>\u524d\u7f00\u8868\u793a\u8f6c\u53d1\u7ed9\u5176\u4ed6\u8bf7\u6c42\u6620\u5c04\uff1a</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(){\n    return \"forward:home\";\n}\n\n@RequestMapping(\"/home\")\npublic String home(){\n    return \"home\";\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#beanweb","title":"Bean\u7684Web\u4f5c\u7528\u57df","text":"<p>\u5728\u5b66\u4e60Spring\u65f6\u6211\u4eec\u8bb2\u89e3\u4e86Bean\u7684\u4f5c\u7528\u57df\uff0c\u5305\u62ec<code>singleton</code>\u548c<code>prototype</code>\uff0cBean\u5206\u522b\u4f1a\u4ee5\u5355\u4f8b\u548c\u591a\u4f8b\u6a21\u5f0f\u8fdb\u884c\u521b\u5efa\uff0c\u800c\u5728SpringMVC\u4e2d\uff0c\u5b83\u7684\u4f5c\u7528\u57df\u88ab\u7ee7\u7eed\u7ec6\u5206\uff1a</p> <ul> <li>request\uff1a\u5bf9\u4e8e\u6bcf\u6b21HTTP\u8bf7\u6c42\uff0c\u4f7f\u7528request\u4f5c\u7528\u57df\u5b9a\u4e49\u7684Bean\u90fd\u5c06\u4ea7\u751f\u4e00\u4e2a\u65b0\u5b9e\u4f8b\uff0c\u8bf7\u6c42\u7ed3\u675f\u540eBean\u4e5f\u6d88\u5931\u3002</li> <li>session\uff1a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u4f7f\u7528session\u4f5c\u7528\u57df\u5b9a\u4e49\u7684Bean\u90fd\u5c06\u4ea7\u751f\u4e00\u4e2a\u65b0\u5b9e\u4f8b\uff0c\u4f1a\u8bdd\u8fc7\u671f\u540eBean\u4e5f\u6d88\u5931\u3002</li> <li>global session\uff1a\u4e0d\u5e38\u7528\uff0c\u4e0d\u505a\u8bb2\u89e3\u3002</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7c7b\u6765\u8bd5\u8bd5\u770b\uff1a</p> <pre><code>public class TestBean {\n\n}\n</code></pre> <p>\u63a5\u7740\u5c06\u5176\u6ce8\u518c\u4e3aBean\uff0c\u6ce8\u610f\u8fd9\u91cc\u9700\u8981\u6dfb\u52a0<code>@RequestScope</code>\u6216\u662f<code>@SessionScope</code>\u8868\u793a\u6b64Bean\u7684Web\u4f5c\u7528\u57df\uff1a</p> <pre><code>@Bean\n@RequestScope // or `@SessionScope`\npublic TestBean testBean(){\n    return new TestBean();\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5c06\u5176\u81ea\u52a8\u6ce8\u5165\u5230Controller\u4e2d\uff1a</p> <pre><code>@Controller\npublic class MainController {\n\n    @Resource\n    TestBean bean;\n\n    @RequestMapping(value = \"/index\")\n    public ModelAndView index(){\n        System.out.println(bean);\n        return new ModelAndView(\"index\");\n    }\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u6b21\u53d1\u8d77\u5f97\u5230\u7684Bean\u5b9e\u4f8b\u90fd\u4e0d\u540c\uff0c\u63a5\u7740\u6211\u4eec\u5c06\u5176\u4f5c\u7528\u57df\u4fee\u6539\u4e3a<code>@SessionScope</code>\uff0c\u8fd9\u6837\u4f5c\u7528\u57df\u5c31\u4e0a\u5347\u5230Session\uff0c\u53ea\u8981\u6e05\u7406\u6d4f\u89c8\u5668\u7684Cookie\uff0c\u90a3\u4e48\u90fd\u4f1a\u88ab\u8ba4\u4e3a\u662f\u540c\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u53ea\u8981\u662f\u540c\u4e00\u4e2a\u4f1a\u8bdd\uff0c\u90a3\u4e48Bean\u5b9e\u4f8b\u59cb\u7ec8\u4e0d\u53d8\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u5b83\u4e5f\u662f\u901a\u8fc7\u4ee3\u7406\u5b9e\u73b0\u7684\uff0c\u6211\u4eec\u8c03\u7528Bean\u4e2d\u7684\u65b9\u6cd5\u4f1a\u88ab\u8f6c\u53d1\u5230\u771f\u6b63\u7684Bean\u5bf9\u8c61\u53bb\u6267\u884c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#restful","title":"Restful \u98ce\u683c","text":"<p>\u8fd9\u79cd\u98ce\u683c\u7684\u8fde\u63a5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u4ece\u8bf7\u6c42\u8def\u5f84\u4e2d\u8bfb\u53d6\u53c2\u6570\uff0c\u6bd4\u5982\uff1a</p> <pre><code>http://localhost:8080/mvc/index/123456\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06index\u7684\u4e0b\u4e00\u7ea7\u8def\u5f84\u4f5c\u4e3a\u8bf7\u6c42\u53c2\u6570\u8fdb\u884c\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u8bf4\u73b0\u5728\u7684\u8bf7\u6c42\u53c2\u6570\u5305\u542b\u5728\u4e86\u8bf7\u6c42\u8def\u5f84\u4e2d\uff1a</p> <pre><code>@RequestMapping(\"/index/{str}\")\npublic String index(@PathVariable String str) {\n    System.out.println(str);\n    return \"index\";\n}\n</code></pre> <p>\u6ce8\u610f\u8bf7\u6c42\u8def\u5f84\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u6dfb\u52a0\u7c7b\u4f3c\u5360\u4f4d\u7b26\u4e00\u6837\u7684\u4fe1\u606f\uff0c\u8fd9\u6837\u5360\u4f4d\u7b26\u4f4d\u7f6e\u7684\u6240\u6709\u5185\u5bb9\u90fd\u4f1a\u88ab\u4f5c\u4e3a\u8bf7\u6c42\u53c2\u6570\uff0c\u800c\u65b9\u6cd5\u7684\u5f62\u53c2\u5217\u8868\u4e2d\u5fc5\u987b\u5305\u62ec\u4e00\u4e2a\u4e0e\u5360\u4f4d\u7b26\u540c\u540d\u7684\u5e76\u4e14\u6dfb\u52a0\u4e86<code>@PathVariable</code>\u6ce8\u89e3\u7684\u53c2\u6570\uff0c\u6216\u662f\u7531<code>@PathVariable</code>\u6ce8\u89e3\u6307\u5b9a\u4e3a\u5360\u4f4d\u7b26\u540d\u79f0\uff1a</p> <pre><code>@RequestMapping(\"/index/{str}\")\npublic String index(@PathVariable(\"str\") String text){\n    System.out.println(text);\n    return \"index\";\n}\n</code></pre> <p>\u5982\u679c\u6ca1\u6709\u914d\u7f6e\u6b63\u786e\uff0c\u65b9\u6cd5\u540d\u79f0\u4e0a\u4f1a\u51fa\u73b0\u9ec4\u7ebf\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u4e0d\u540c\u529f\u80fd\u8fdb\u884c\u5212\u5206\uff1a</p> <ul> <li>POST http://localhost:8080/mvc/index -  \u6dfb\u52a0\u7528\u6237\u4fe1\u606f\uff0c\u643a\u5e26\u8868\u5355\u6570\u636e</li> <li>GET http://localhost:8080/mvc/index/{id} -  \u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff0cid\u76f4\u63a5\u653e\u5728\u8bf7\u6c42\u8def\u5f84\u4e2d</li> <li>PUT http://localhost:8080/mvc/index -  \u4fee\u6539\u7528\u6237\u4fe1\u606f\uff0c\u643a\u5e26\u8868\u5355\u6570\u636e</li> <li>DELETE http://localhost:8080/mvc/index/{id} -  \u5220\u9664\u7528\u6237\u4fe1\u606f\uff0cid\u76f4\u63a5\u653e\u5728\u8bf7\u6c42\u8def\u5f84\u4e2d</li> </ul> <p>\u6211\u4eec\u5206\u522b\u7f16\u5199\u56db\u4e2a\u8bf7\u6c42\u6620\u5c04\uff1a</p> <pre><code>@Controller\npublic class MainController {\n\n    @RequestMapping(value = \"/index/{id}\", method = RequestMethod.GET)\n    public String get(@PathVariable(\"id\") String text){\n        System.out.println(\"\u83b7\u53d6\u7528\u6237\uff1a\"+text);\n        return \"index\";\n    }\n\n    @RequestMapping(value = \"/index\", method = RequestMethod.POST)\n    public String post(String username){\n        System.out.println(\"\u6dfb\u52a0\u7528\u6237\uff1a\"+username);\n        return \"index\";\n    }\n\n    @RequestMapping(value = \"/index/{id}\", method = RequestMethod.DELETE)\n    public String delete(@PathVariable(\"id\") String text){\n        System.out.println(\"\u5220\u9664\u7528\u6237\uff1a\"+text);\n        return \"index\";\n    }\n\n    @RequestMapping(value = \"/index\", method = RequestMethod.PUT)\n    public String put(String username){\n        System.out.println(\"\u4fee\u6539\u7528\u6237\uff1a\"+username);\n        return \"index\";\n    }\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#interceptor","title":"Interceptor\u62e6\u622a\u5668","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_8","title":"\u521b\u5efa\u62e6\u622a\u5668","text":"<p>\u521b\u5efa\u4e00\u4e2a\u62e6\u622a\u5668\u6211\u4eec\u9700\u8981\u5b9e\u73b0\u4e00\u4e2a<code>HandlerInterceptor</code>\u63a5\u53e3\uff1a</p> <pre><code>public class MainInterceptor implements HandlerInterceptor {\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        System.out.println(\"\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\");\n        return true;   //\u53ea\u6709\u8fd4\u56detrue\u624d\u4f1a\u7ee7\u7eed\uff0c\u5426\u5219\u76f4\u63a5\u7ed3\u675f\n    }\n\n    @Override\n    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {\n        System.out.println(\"\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\");\n    }\n\n    @Override\n    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {\n        //\u5728DispatcherServlet\u5b8c\u5168\u5904\u7406\u5b8c\u8bf7\u6c42\u540e\u88ab\u8c03\u7528\n        System.out.println(\"\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\");\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u7c7b\uff08\u4e4b\u524d\u7684WebConfiguration\uff09\u4e2d\u8fdb\u884c\u6ce8\u518c\uff1a</p> <pre><code>@Override\npublic void addInterceptors(InterceptorRegistry registry) {\n    registry.addInterceptor(new MainInterceptor())\n      .addPathPatterns(\"/**\")    //\u6dfb\u52a0\u62e6\u622a\u5668\u7684\u5339\u914d\u8def\u5f84\uff0c\u53ea\u8981\u5339\u914d\u4e00\u5f8b\u62e6\u622a\n      .excludePathPatterns(\"/home\");   //\u62e6\u622a\u5668\u4e0d\u8fdb\u884c\u62e6\u622a\u7684\u8def\u5f84\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5728\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95eeindex\u9875\u9762\uff0c\u62e6\u622a\u5668\u5df2\u7ecf\u751f\u6548\u3002</p> <p>\u5f97\u5230\u6574\u7406\u62e6\u622a\u5668\u7684\u6267\u884c\u987a\u5e8f\uff1a</p> <pre><code>\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n\u6211\u662f\u5904\u7406\uff01\n\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\n\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\n</code></pre> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5904\u7406\u524d\u548c\u5904\u7406\u540e\uff0c\u5305\u542b\u4e86\u771f\u6b63\u7684\u8bf7\u6c42\u6620\u5c04\u7684\u5904\u7406\uff0c\u5728\u6574\u4e2a\u6d41\u7a0b\u7ed3\u675f\u540e\u8fd8\u6267\u884c\u4e86\u4e00\u6b21<code>afterCompletion</code>\u65b9\u6cd5\uff0c\u5176\u5b9e\u6574\u4e2a\u8fc7\u7a0b\u4e0e\u6211\u4eec\u4e4b\u524d\u6240\u8ba4\u8bc6\u7684Filter\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u5728\u5904\u7406\u524d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8fd4\u56detrue\u6216\u662ffalse\u8868\u793a\u662f\u5426\u88ab\u62e6\u622a\u5373\u53ef\uff0c\u800c\u4e0d\u662f\u518d\u53bb\u4f7f\u7528FilterChain\u8fdb\u884c\u5411\u4e0b\u4f20\u9012\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u5c31\u6765\u770b\u770b\uff0c\u5982\u679c\u5904\u7406\u524d\u8fd4\u56defalse\uff0c\u4f1a\u600e\u4e48\u6837\uff1a</p> <pre><code>\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n</code></pre> <p>\u901a\u8fc7\u7ed3\u679c\u53d1\u73b0\u4e00\u65e6\u8fd4\u56defalse\uff0c\u4e4b\u540e\u7684\u6240\u6709\u6d41\u7a0b\u5168\u90e8\u53d6\u6d88\uff0c\u90a3\u4e48\u5982\u679c\u662f\u5728\u5904\u7406\u4e2d\u53d1\u751f\u5f02\u5e38\u4e86\u5462\uff1f</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(){\n    System.out.println(\"\u6211\u662f\u5904\u7406\uff01\");\n    if(true) throw new RuntimeException(\"\");\n    return \"index\";\n}\n</code></pre> <p>\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n\u6211\u662f\u5904\u7406\uff01\n\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u5982\u679c\u5904\u7406\u8fc7\u7a0b\u4e2d\u629b\u51fa\u5f02\u5e38\uff0c\u90a3\u4e48\u4e45\u4e0d\u4f1a\u6267\u884c\u5904\u7406\u540e<code>postHandle</code>\u65b9\u6cd5\uff0c\u4f46\u662f\u4f1a\u6267\u884c<code>afterCompletion</code>\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6b64\u65b9\u6cd5\u4e2d\u83b7\u53d6\u5230\u629b\u51fa\u7684\u5f02\u5e38\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_9","title":"\u591a\u7ea7\u62e6\u622a\u5668","text":"<p>\u524d\u9762\u4ecb\u7ecd\u4e86\u4ec5\u4ec5\u53ea\u6709\u4e00\u4e2a\u62e6\u622a\u5668\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\u5982\u679c\u5b58\u5728\u591a\u4e2a\u62e6\u622a\u5668\u4f1a\u5982\u4f55\u6267\u884c\uff0c\u6211\u4eec\u4ee5\u540c\u6837\u7684\u65b9\u5f0f\u521b\u5efa\u4e8c\u53f7\u62e6\u622a\u5668\uff1a</p> <pre><code>public class SubInterceptor implements HandlerInterceptor {\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n        System.out.println(\"\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\");\n        return true;\n    }\n\n    @Override\n    public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception {\n        System.out.println(\"\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\");\n    }\n\n    @Override\n    public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception {\n        System.out.println(\"\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\");\n    }\n}\n</code></pre> <p>\u6ce8\u518c\u4e8c\u53f7\u62e6\u622a\u5668\uff1a</p> <pre><code>@Override\npublic void addInterceptors(InterceptorRegistry registry) {\n    //\u4e00\u53f7\u62e6\u622a\u5668\n    registry.addInterceptor(new MainInterceptor()).addPathPatterns(\"/**\").excludePathPatterns(\"/home\");\n    //\u4e8c\u53f7\u62e6\u622a\u5668\n    registry.addInterceptor(new SubInterceptor()).addPathPatterns(\"/**\");\n}\n</code></pre> <p>\u6ce8\u610f\u62e6\u622a\u987a\u5e8f\u5c31\u662f\u6ce8\u518c\u7684\u987a\u5e8f\uff0c\u56e0\u6b64\u62e6\u622a\u5668\u4f1a\u6839\u636e\u6ce8\u518c\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\uff0c\u6211\u4eec\u53ef\u4ee5\u6253\u5f00\u6d4f\u89c8\u5668\u8fd0\u884c\u4e00\u6b21\uff1a</p> <pre><code>\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n\u6211\u662f\u5904\u7406\uff01\n\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\n\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u540e\uff01\n\u4e8c\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\n\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5b8c\u6210\u4e4b\u540e\uff01\n</code></pre> <p>\u548c\u591a\u7ea7Filter\u76f8\u540c\uff0c\u5728\u5904\u7406\u4e4b\u524d\uff0c\u662f\u6309\u7167\u987a\u5e8f\u4ece\u524d\u5411\u540e\u8fdb\u884c\u62e6\u622a\u7684\uff0c\u4f46\u662f\u5904\u7406\u5b8c\u6210\u4e4b\u540e\uff0c\u5c31\u6309\u7167\u5012\u5e8f\u6267\u884c\u5904\u7406\u540e\u65b9\u6cd5\uff0c\u800c\u5b8c\u6210\u540e\u662f\u5728\u6240\u6709\u7684<code>postHandle</code>\u6267\u884c\u4e4b\u540e\u518d\u540c\u6837\u7684\u4ee5\u5012\u5e8f\u65b9\u5f0f\u6267\u884c\u3002</p> <p>\u90a3\u4e48\u5982\u679c\u8fd9\u65f6\u4e00\u53f7\u62e6\u622a\u5668\u5728\u5904\u7406\u524d\u5c31\u8fd4\u56de\u4e86false\u5462\uff1f</p> <pre><code>@Override\npublic boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n    System.out.println(\"\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\");\n    return false;\n}\n</code></pre> <p>\u5f97\u5230\u7ed3\u679c\u5982\u4e0b\uff1a</p> <pre><code>\u4e00\u53f7\u62e6\u622a\u5668\uff1a\u6211\u662f\u5904\u7406\u4e4b\u524d\uff01\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u4e0e\u5355\u4e2a\u62e6\u622a\u5668\u7684\u60c5\u51b5\u4e00\u6837\uff0c\u4e00\u65e6\u62e6\u622a\u5668\u8fd4\u56defalse\uff0c\u90a3\u4e48\u4e4b\u540e\u65e0\u8bba\u6709\u65e0\u62e6\u622a\u5668\uff0c\u90fd\u4e0d\u518d\u7ee7\u7eed\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_10","title":"\u5f02\u5e38\u5904\u7406","text":"<p>\u5f53\u6211\u4eec\u7684\u8bf7\u6c42\u6620\u5c04\u65b9\u6cd5\u4e2d\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u4f1a\u76f4\u63a5\u5c55\u793a\u5728\u524d\u7aef\u9875\u9762\uff0c\u8fd9\u662f\u56e0\u4e3aSpringMVC\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u9ed8\u8ba4\u7684\u5f02\u5e38\u5904\u7406\u9875\u9762\uff0c\u5f53\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u6211\u4eec\u7684\u8bf7\u6c42\u4f1a\u88ab\u76f4\u63a5\u8f6c\u4ea4\u7ed9\u4e13\u95e8\u7528\u4e8e\u5f02\u5e38\u5904\u7406\u7684\u63a7\u5236\u5668\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e00\u4e2a\u5f02\u5e38\u5904\u7406\u63a7\u5236\u5668\uff0c\u4e00\u65e6\u51fa\u73b0\u6307\u5b9a\u5f02\u5e38\uff0c\u5c31\u4f1a\u8f6c\u63a5\u5230\u6b64\u63a7\u5236\u5668\u6267\u884c\uff1a</p> <pre><code>@ControllerAdvice\npublic class ErrorController {\n\n    @ExceptionHandler(Exception.class)\n    public String error(Exception e, Model model){  //\u53ef\u4ee5\u76f4\u63a5\u6dfb\u52a0\u5f62\u53c2\u6765\u83b7\u53d6\u5f02\u5e38\n        e.printStackTrace();\n        model.addAttribute(\"e\", e);\n        return \"500\";\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u7f16\u5199\u4e00\u4e2a\u4e13\u95e8\u663e\u793a\u5f02\u5e38\u7684\u9875\u9762\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  500 - \u670d\u52a1\u5668\u51fa\u73b0\u4e86\u4e00\u4e2a\u5185\u90e8\u9519\u8befQAQ\n  &lt;div th:text=\"${e}\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u63a5\u7740\u4fee\u6539\uff1a</p> <pre><code>@RequestMapping(\"/index\")\npublic String index(){\n    System.out.println(\"\u6211\u662f\u5904\u7406\uff01\");\n    if(true) throw new RuntimeException(\"\u9519\u8bef\uff0c\u65e0\u6cd5\u8bbf\u95ee\uff01\");\n    return \"error\";\n}\n</code></pre> <p>\u8bbf\u95ee\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u63a7\u5236\u53f0\u4f1a\u8f93\u51fa\u5f02\u5e38\u4fe1\u606f\uff0c\u540c\u65f6\u9875\u9762\u4e5f\u662f\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u4e00\u4e2a\u9875\u9762\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#jsonaxios","title":"JSON\u6570\u636e\u683c\u5f0f\u4e0eAxios\u8bf7\u6c42","text":"<p>JSON (JavaScript Object Notation, JS \u5bf9\u8c61\u7b80\u8c31) \u662f\u4e00\u79cd\u8f7b\u91cf\u7ea7\u7684\u6570\u636e\u4ea4\u6362\u683c\u5f0f\u3002</p> <p>\u6211\u4eec\u73b0\u5728\u63a8\u5d07\u7684\u662f\u524d\u540e\u7aef\u5206\u79bb\u7684\u5f00\u53d1\u6a21\u5f0f\uff0c\u800c\u4e0d\u662f\u6240\u6709\u7684\u5185\u5bb9\u5168\u90e8\u4ea4\u7ed9\u540e\u7aef\u6e32\u67d3\u518d\u53d1\u9001\u7ed9\u6d4f\u89c8\u5668\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6574\u4e2aWeb\u9875\u9762\u7684\u5185\u5bb9\u5728\u4e00\u5f00\u59cb\u5c31\u7f16\u5199\u5b8c\u6210\u4e86\uff0c\u800c\u5176\u4e2d\u7684\u6570\u636e\u7531\u524d\u7aef\u6267\u884cJS\u4ee3\u7801\u6765\u5411\u670d\u52a1\u5668\u52a8\u6001\u83b7\u53d6\uff0c\u518d\u5230\u524d\u7aef\u8fdb\u884c\u6e32\u67d3\uff08\u586b\u5145\uff09\uff0c\u8fd9\u6837\u53ef\u4ee5\u5927\u5e45\u5ea6\u51cf\u5c11\u540e\u7aef\u7684\u538b\u529b\uff0c\u5e76\u4e14\u540e\u7aef\u53ea\u9700\u8981\u4f20\u8f93\u5173\u952e\u6570\u636e\u5373\u53ef\uff08\u5728\u5373\u5c06\u5230\u6765\u7684SpringBoot\u9636\u6bb5\uff0c\u6211\u4eec\u5c06\u5b8c\u5168\u91c7\u7528\u524d\u540e\u7aef\u5206\u79bb\u7684\u5f00\u53d1\u6a21\u5f0f\uff09</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#json","title":"JSON\u6570\u636e\u683c\u5f0f","text":"<p>\u65e2\u7136\u8981\u5b9e\u73b0\u524d\u540e\u7aef\u5206\u79bb\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5fc5\u987b\u7ea6\u5b9a\u4e00\u79cd\u66f4\u52a0\u9ad8\u6548\u7684\u6570\u636e\u4f20\u8f93\u6a21\u5f0f\uff0c\u6765\u5411\u524d\u7aef\u9875\u9762\u4f20\u8f93\u540e\u7aef\u63d0\u4f9b\u7684\u6570\u636e\u3002\u56e0\u6b64JSON\u6a2a\u7a7a\u51fa\u4e16\uff0c\u5b83\u975e\u5e38\u5bb9\u6613\u7406\u89e3\uff0c\u5e76\u4e14\u4e0e\u524d\u7aef\u7684\u517c\u5bb9\u6027\u6781\u597d\uff0c\u56e0\u6b64\u73b0\u5728\u6bd4\u8f83\u4e3b\u6d41\u7684\u6570\u636e\u4f20\u8f93\u65b9\u5f0f\u5219\u662f\u901a\u8fc7JSON\u683c\u5f0f\u627f\u8f7d\u7684\u3002</p> <p>\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u6570\u636e\u957f\u8fd9\u6837\uff0c\u4ee5\u5b66\u751f\u5bf9\u8c61\u4e3a\u4f8b\uff1a</p> <pre><code>{\"name\": \"\u6770\u54e5\", \"age\": 18}\n</code></pre> <p>\u591a\u4e2a\u5b66\u751f\u53ef\u4ee5\u4ee5\u6570\u7ec4\u7684\u5f62\u5f0f\u8868\u793a\uff1a</p> <pre><code>[{\"name\": \"\u6770\u54e5\", \"age\": 18}, {\"name\": \"\u963f\u4f1f\", \"age\": 18}]\n</code></pre> <p>\u5d4c\u5957\u5173\u7cfb\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a</p> <pre><code>{\"studentList\": [{\"name\": \"\u6770\u54e5\", \"age\": 18}, {\"name\": \"\u963f\u4f1f\", \"age\": 18}], \"count\": 2}\n</code></pre> <p>\u5b83\u76f4\u63a5\u5305\u62ec\u4e86\u5c5e\u6027\u7684\u540d\u79f0\u548c\u5c5e\u6027\u7684\u503c\uff0c\u4e0eJavaScript\u7684\u5bf9\u8c61\u6781\u4e3a\u76f8\u4f3c\uff0c\u5b83\u5230\u8fbe\u524d\u7aef\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8f6c\u6362\u4e3a\u5bf9\u8c61\uff0c\u4ee5\u5bf9\u8c61\u7684\u5f62\u5f0f\u8fdb\u884c\u64cd\u4f5c\u548c\u5185\u5bb9\u7684\u8bfb\u53d6\uff0c\u76f8\u5f53\u4e8e\u4ee5\u5b57\u7b26\u4e32\u5f62\u5f0f\u8868\u793a\u4e86\u4e00\u4e2aJS\u5bf9\u8c61\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u63a7\u5236\u53f0\u7a97\u53e3\u4e2d\u6d4b\u8bd5\uff1a</p> <pre><code>let obj = JSON.parse('{\"studentList\": [{\"name\": \"\u6770\u54e5\", \"age\": 18}, {\"name\": \"\u963f\u4f1f\", \"age\": 18}], \"count\": 2}')\n//\u5c06JSON\u683c\u5f0f\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3aJS\u5bf9\u8c61\nobj.studentList[0].name   //\u76f4\u63a5\u8bbf\u95ee\u7b2c\u4e00\u4e2a\u5b66\u751f\u7684\u540d\u79f0\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06JS\u5bf9\u8c61\u8f6c\u6362\u4e3aJSON\u5b57\u7b26\u4e32\uff1a</p> <pre><code>JSON.stringify(obj)\n</code></pre> <p>\u6211\u4eec\u540e\u7aef\u5c31\u53ef\u4ee5\u4ee5JSON\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u5411\u524d\u7aef\u8fd4\u56de\u6570\u636e\uff0c\u8fd9\u6837\u524d\u7aef\u5728\u62ff\u5230\u6570\u636e\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5feb\u901f\u83b7\u53d6\uff0c\u975e\u5e38\u65b9\u4fbf\u3002</p> <p>\u90a3\u4e48\u540e\u7aef\u5982\u4f55\u5feb\u901f\u521b\u5efa\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u6570\u636e\u5462\uff1f\u6211\u4eec\u9996\u5148\u9700\u8981\u5bfc\u5165\u4ee5\u4e0b\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n      &lt;groupId&gt;com.alibaba.fastjson2&lt;/groupId&gt;\n      &lt;artifactId&gt;fastjson2&lt;/artifactId&gt;\n      &lt;version&gt;2.0.34&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>JSON\u89e3\u6790\u6846\u67b6\u6709\u5f88\u591a\u79cd\uff0c\u6bd4\u8f83\u5e38\u7528\u7684\u662fJackson\u548cFastJSON\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u963f\u91cc\u5df4\u5df4\u7684FastJSON\u8fdb\u884c\u89e3\u6790\uff0c\u8fd9\u662f\u76ee\u524d\u53f7\u79f0\u6700\u5feb\u7684JSON\u89e3\u6790\u6846\u67b6\uff0c\u5e76\u4e14\u73b0\u5728\u5df2\u7ecf\u5f3a\u52bf\u63a8\u51faFastJSON 2\u7248\u672c\u3002</p> <p>\u9996\u5148\u8981\u4ecb\u7ecd\u7684\u662fJSONObject\uff0c\u5b83\u548cMap\u7684\u4f7f\u7528\u65b9\u6cd5\u4e00\u6837\uff0c\u5e76\u4e14\u662f\u6709\u5e8f\u7684\uff08\u5b9e\u73b0\u4e86LinkedHashMap\u63a5\u53e3\uff09\uff0c\u6bd4\u5982\u6211\u4eec\u5411\u5176\u4e2d\u5b58\u653e\u51e0\u4e2a\u6570\u636e\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic String index(){\n    JSONObject object = new JSONObject();\n    object.put(\"name\", \"\u6770\u54e5\");\n    object.put(\"age\", 18);\n    System.out.println(object.toJSONString());   //\u4ee5JSON\u683c\u5f0f\u8f93\u51faJSONObject\u5b57\u7b26\u4e32\n    return \"index\";\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u5f97\u5230\u7684\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>{\"name\": \"\u6770\u54e5\", \"age\": 18}\n</code></pre> <p>\u5b9e\u9645\u4e0aJSONObject\u5c31\u662f\u5bf9JSON\u6570\u636e\u7684\u4e00\u79cd\u5bf9\u8c61\u8868\u793a\u3002\u540c\u6837\u7684\u8fd8\u6709JSONArray\uff0c\u5b83\u8868\u793a\u4e00\u4e2a\u6570\u7ec4\uff0c\u7528\u6cd5\u548cList\u4e00\u6837\uff0c\u6570\u7ec4\u4e2d\u53ef\u4ee5\u5d4c\u5957\u5176\u4ed6\u7684JSONObject\u6216\u662fJSONArray\uff1a</p> <pre><code>@RequestMapping(value = \"/index\")\npublic String index(){\n    JSONObject object = new JSONObject();\n    object.put(\"name\", \"\u6770\u54e5\");\n    object.put(\"age\", 18);\n    JSONArray array = new JSONArray();\n    array.add(object);\n    System.out.println(array.toJSONString());\n    return \"index\";\n}\n</code></pre> <p>\u5f97\u5230\u7684\u7ed3\u679c\u4e3a\uff1a</p> <pre><code>[{\"name\": \"\u6770\u54e5\", \"age\": 18}]\n</code></pre> <p>\u5f53\u51fa\u73b0\u5faa\u73af\u5f15\u7528\u65f6\uff0c\u4f1a\u6309\u7167\u4ee5\u4e0b\u8bed\u6cd5\u6765\u89e3\u6790\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u4e5f\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f53\u7c7b\uff0c\u5c06\u5b9e\u4f53\u7c7b\u8f6c\u6362\u4e3aJSON\u683c\u5f0f\u7684\u6570\u636e\uff1a</p> <pre><code>@RequestMapping(value = \"/index\", produces = \"application/json\")\n@ResponseBody\npublic String data(){\n    Student student = new Student();\n    student.setName(\"\u6770\u54e5\");\n    student.setAge(18);\n    return JSON.toJSONString(student);\n}\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u4fee\u6539\u4e86<code>produces</code>\u7684\u503c\uff0c\u5c06\u8fd4\u56de\u7684\u5185\u5bb9\u7c7b\u578b\u8bbe\u5b9a\u4e3a<code>application/json</code>\uff0c\u8868\u793a\u670d\u52a1\u5668\u7aef\u8fd4\u56de\u4e86\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u6570\u636e\uff08\u5f53\u7136\u4e0d\u8bbe\u7f6e\u4e5f\u884c\uff0c\u4e5f\u80fd\u5c55\u793a\uff0c\u8fd9\u6837\u662f\u4e3a\u4e86\u89c4\u8303\uff09\u7136\u540e\u6211\u4eec\u5728\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u4e00\u4e2a<code>@ResponseBody</code>\u8868\u793a\u65b9\u6cd5\u8fd4\u56de\uff08\u4e5f\u53ef\u4ee5\u5728\u7c7b\u4e0a\u6dfb\u52a0<code>@RestController</code>\u8868\u793a\u6b64Controller\u9ed8\u8ba4\u8fd4\u56de\u7684\u662f\u5b57\u7b26\u4e32\u6570\u636e\uff09\u7684\u7ed3\u679c\u4e0d\u662f\u89c6\u56fe\u540d\u79f0\u800c\u662f\u76f4\u63a5\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f5c\u4e3a\u9875\u9762\u6570\u636e\uff0c\u8fd9\u6837\uff0c\u8fd4\u56de\u7ed9\u6d4f\u89c8\u5668\u7684\u5c31\u662f\u6211\u4eec\u76f4\u63a5\u8fd4\u56de\u7684\u5b57\u7b26\u4e32\u5185\u5bb9\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u4f7f\u7528JSON\u5de5\u5177\u7c7b\u5c06\u5176\u8f6c\u6362\u4e3aJSON\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\uff0c\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u5f97\u5230JSON\u683c\u5f0f\u6570\u636e\u3002</p> <p>SpringMVC\u975e\u5e38\u667a\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61\u7c7b\u578b\uff0c\u5b83\u4f1a\u88ab\u81ea\u52a8\u8f6c\u6362\u4e3aJSON\u5b57\u7b26\u4e32\u683c\u5f0f\uff1a</p> <pre><code>@RequestMapping(value = \"/data\", produces = \"application/json\")\n@ResponseBody\npublic Student data(){\n    Student student = new Student();\n    student.setName(\"\u6770\u54e5\");\n    student.setAge(18);\n    return student;\n}\n</code></pre> <p>\u6ce8\u610f\u9700\u8981\u5728\u914d\u7f6e\u7c7b\u4e2d\u6dfb\u52a0\u4e00\u4e0bFastJSON\u8f6c\u6362\u5668\uff0c\u8fd9\u91cc\u9700\u8981\u5148\u6dfb\u52a0\u4e00\u4e2a\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.fastjson2&lt;/groupId&gt;\n    &lt;artifactId&gt;fastjson2-extension-spring6&lt;/artifactId&gt;\n    &lt;version&gt;2.0.34&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7136\u540e\u7f16\u5199\u914d\u7f6e\uff1a</p> <pre><code>@Override\npublic void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) {\n    converters.add(new FastJsonHttpMessageConverter());\n}\n</code></pre> <p>\u518d\u6b21\u5c1d\u8bd5\uff0c\u5185\u5bb9\u5c31\u4f1a\u81ea\u52a8\u8f6c\u6362\u4e3aJSON\u683c\u5f0f\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#axios","title":"Axios\u5f02\u6b65\u8bf7\u6c42","text":"<p>\u524d\u9762\u6211\u4eec\u8bb2\u89e3\u4e86\u5982\u4f55\u5411\u6d4f\u89c8\u5668\u53d1\u9001\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u6570\u636e\uff0c\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u6765\u770b\u770b\u5982\u4f55\u5411\u670d\u52a1\u5668\u8bf7\u6c42\u6570\u636e\u3002</p> <p></p> <p>\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u53c8\u8981\u56de\u5230\u524d\u7aef\u76f8\u5173\u5185\u5bb9\u7684\u4ecb\u7ecd\u4e2d\uff0c\u5f53\u7136\uff0c\u6211\u4eec\u4f9d\u7136\u662f\u4ec5\u505a\u4e86\u89e3\uff0c\u5e76\u4e0d\u9700\u8981\u8be6\u7ec6\u5b66\u4e60\u524d\u7aef\u9879\u76ee\u5f00\u53d1\u77e5\u8bc6\u3002</p> <p>\u524d\u7aef\u4e3a\u4ec0\u4e48\u9700\u8981\u7528\u5230\u5f02\u6b65\u8bf7\u6c42\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u7684\u7f51\u9875\u662f\u52a8\u6001\u7684\uff08\u8fd9\u91cc\u7684\u52a8\u6001\u4e0d\u662f\u6307\u6709\u52a8\u753b\u6548\u679c\uff0c\u800c\u662f\u80fd\u591f\u5b9e\u65f6\u66f4\u65b0\u5185\u5bb9\uff09\u6bd4\u5982\u6211\u4eec\u70b9\u51fb\u4e00\u4e2a\u6309\u94ae\u4f1a\u5f39\u51fa\u65b0\u7684\u5185\u5bb9\u3001\u6216\u662f\u8df3\u8f6c\u5230\u65b0\u7684\u9875\u9762\u3001\u66f4\u65b0\u9875\u9762\u4e2d\u7684\u6570\u636e\u7b49\u7b49\uff0c\u8fd9\u4e9b\u90fd\u9700\u8981\u901a\u8fc7JS\u5b8c\u6210\u5f02\u6b65\u8bf7\u6c42\u6765\u5b9e\u73b0\u3002</p> <p>\u524d\u7aef\u5f02\u6b65\u8bf7\u6c42\u6307\u7684\u662f\u5728\u524d\u7aef\u4e2d\u53d1\u9001\u8bf7\u6c42\u81f3\u670d\u52a1\u5668\u6216\u5176\u4ed6\u8d44\u6e90\uff0c\u5e76\u4e14\u4e0d\u963b\u585e\u7528\u6237\u754c\u9762\u6216\u5176\u4ed6\u64cd\u4f5c\u3002\u5728\u4f20\u7edf\u7684\u540c\u6b65\u8bf7\u6c42\u4e2d\uff0c\u5f53\u53d1\u9001\u8bf7\u6c42\u65f6\uff0c\u6d4f\u89c8\u5668\u4f1a\u7b49\u5f85\u670d\u52a1\u5668\u54cd\u5e94\uff0c\u671f\u95f4\u7528\u6237\u65e0\u6cd5\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c\u3002\u800c\u5f02\u6b65\u8bf7\u6c42\u901a\u8fc7\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u540e\u53f0\uff0c\u5728\u7b49\u5f85\u54cd\u5e94\u7684\u540c\u65f6\uff0c\u5141\u8bb8\u7528\u6237\u7ee7\u7eed\u8fdb\u884c\u5176\u4ed6\u64cd\u4f5c\u3002\u8fd9\u79cd\u673a\u5236\u80fd\u591f\u63d0\u5347\u7528\u6237\u4f53\u9a8c\uff0c\u5e76\u4e14\u5141\u8bb8\u9875\u9762\u8fdb\u884c\u5b9e\u65f6\u66f4\u65b0\u3002\u5e38\u89c1\u7684\u524d\u7aef\u5f02\u6b65\u8bf7\u6c42\u65b9\u5f0f\u5305\u62ec\u4f7f\u7528XMLHttpRequest\u5bf9\u8c61\u3001Fetch API\u3001\u4ee5\u53ca\u4f7f\u7528jQuery\u5e93\u4e2d\u7684AJAX\u65b9\u6cd5\uff0c\u4ee5\u53ca\u76ee\u524d\u6700\u5e38\u7528\u7684Axios\u6846\u67b6\u7b49\u3002</p> <p>\u5047\u8bbe\u6211\u4eec\u540e\u7aef\u6709\u4e00\u4e2a\u9700\u8981\u5b9e\u65f6\u5237\u65b0\u7684\u6570\u636e\uff08\u968f\u65f6\u95f4\u800c\u53d8\u5316\uff09\u73b0\u5728\u9700\u8981\u518d\u524d\u7aef\u5b9e\u65f6\u66f4\u65b0\u5c55\u793a\uff0c\u8fd9\u91cc\u6211\u4eec\u4ee5axios\u6846\u67b6\u7684\u7b80\u5355\u4f7f\u7528\u4e3a\u4f8b\u5b50\uff0c\u5e26\u5404\u4f4d\u5c0f\u4f19\u4f34\u4f53\u9a8c\u5982\u4f55\u53d1\u8d77\u5f02\u6b65\u8bf7\u6c42\u5e76\u66f4\u65b0\u6211\u4eec\u9875\u9762\u4e2d\u7684\u6570\u636e\u3002</p> <p>\u9996\u5148\u662f\u524d\u7aef\u9875\u9762\uff0c\u76f4\u63a5\u6284\u4f5c\u4e1a\u5c31\u884c\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u6d4b\u8bd5&lt;/title&gt;\n    &lt;script src=\"https://unpkg.com/axios@1.1.2/dist/axios.min.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;p&gt;\u6b22\u8fce\u6765\u5230GayHub\u5168\u7403\u6700\u5927\u540c\u6027\u4ea4\u53cb\u7f51\u7ad9&lt;/p&gt;\n  &lt;p&gt;\u7528\u6237\u540d: &lt;span id=\"username\"&gt;&lt;/span&gt;&lt;/p&gt;\n  &lt;p&gt;\u5bc6\u7801: &lt;span id=\"password\"&gt;&lt;/span&gt;&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u4f7f\u7528axios\u6846\u67b6\u76f4\u63a5\u5bf9\u540e\u7aef\u8bf7\u6c42JSON\u6570\u636e\uff1a</p> <pre><code>&lt;script&gt;\n    function getInfo() {\n        axios.get('/mvc/test').then(({data}) =&gt; {\n            document.getElementById('username').innerText = data.username\n            document.getElementById('password').innerText = data.password\n        })\n    }\n&lt;/script&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u4ece\u670d\u52a1\u7aef\u83b7\u53d6\u6570\u636e\u5e76\u66f4\u65b0\u5230\u9875\u9762\u4e2d\uff0c\u524d\u7aef\u5f00\u53d1\u8005\u5229\u7528JS\u53d1\u8d77\u5f02\u6b65\u8bf7\u6c42\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5404\u79cd\u5404\u6837\u7684\u6548\u679c\uff0c\u800c\u6211\u4eec\u540e\u7aef\u5f00\u53d1\u8005\u53ea\u9700\u8981\u5173\u5fc3\u63a5\u53e3\u8fd4\u56de\u6b63\u786e\u7684\u6570\u636e\u5373\u53ef\uff0c\u8fd9\u5c31\u5df2\u7ecf\u6709\u524d\u540e\u7aef\u5206\u79bb\u5f00\u53d1\u7684\u96cf\u5f62\u4e86\uff08\u5b9e\u9645\u4e0a\u4e4b\u524d\uff0c\u6211\u4eec\u5728JavaWeb\u9636\u6bb5\u4f7f\u7528XHR\u8bf7\u6c42\u4e5f\u6f14\u793a\u8fc7\uff0c\u4e0d\u8fc7\u5f53\u65f6\u662f\u7eaf\u7cb9\u7684\u6570\u636e\uff09</p> <p>\u90a3\u4e48\u6211\u4eec\u63a5\u7740\u6765\u770b\uff0c\u5982\u4f55\u5411\u670d\u52a1\u7aef\u53d1\u9001\u4e00\u4e2aJS\u5bf9\u8c61\u6570\u636e\u5e76\u8fdb\u884c\u89e3\u6790\uff0c\u8fd9\u91cc\u4ee5\u7b80\u5355\u7684\u767b\u5f55\u4e3a\u4f8b\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u6d4b\u8bd5&lt;/title&gt;\n    &lt;script src=\"https://unpkg.com/axios@1.1.2/dist/axios.min.js\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;p&gt;\u6b22\u8fce\u6765\u5230GayHub\u5168\u7403\u6700\u5927\u540c\u6027\u4ea4\u53cb\u7f51\u7ad9&lt;/p&gt;\n  &lt;button onclick=\"login()\"&gt;\u7acb\u5373\u767b\u5f55&lt;/button&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u8fd9\u91cc\u4f9d\u7136\u4f7f\u7528axios\u53d1\u9001POST\u8bf7\u6c42\uff1a</p> <pre><code>&lt;script&gt;\n    function login() {\n        axios.post('/mvc/test', {\n            username: 'test',\n            password: '123456'\n        }, {\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n        }).then(({data}) =&gt; {\n            if(data.success) {\n                alert('\u767b\u5f55\u6210\u529f')\n            } else {\n                alert('\u767b\u5f55\u5931\u8d25')\n            }\n        })\n    }\n&lt;/script&gt;\n</code></pre> <p>\u670d\u52a1\u5668\u7aef\u53ea\u9700\u8981\u5728\u8bf7\u6c42\u53c2\u6570\u4f4d\u7f6e\u6dfb\u52a0\u4e00\u4e2a\u5bf9\u8c61\u63a5\u6536\u5373\u53ef\uff08\u548c\u524d\u9762\u662f\u4e00\u6837\u7684\uff0c\u56e0\u4e3a\u8fd9\u91cc\u4e5f\u662f\u63d0\u4ea4\u7684\u8868\u5355\u6570\u636e\uff09\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(value = \"/test\", produces = \"application/json\")\npublic String hello(String username, String password){\n    boolean success = \"test\".equals(user.getUsername()) &amp;&amp; \"123456\".equals(user.getPassword());\n    JSONObject object = new JSONObject();\n    object.put(\"success\", success);\n    return object.toString();\n}\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06js\u5bf9\u8c61\u8f6c\u6362\u4e3aJSON\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u8f93\uff0c\u8fd9\u91cc\u9700\u8981\u4f7f\u7528ajax\u65b9\u6cd5\u6765\u5904\u7406\uff1a</p> <pre><code>&lt;script&gt;\n    function login() {\n        axios.post('/mvc/test', {\n            username: 'test',\n            password: '123456'\n        }).then(({data}) =&gt; {\n            if(data.success) {\n                alert('\u767b\u5f55\u6210\u529f')\n            } else {\n                alert('\u767b\u5f55\u5931\u8d25')\n            }\n        })\n    }\n&lt;/script&gt;\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u9700\u8981\u8bfb\u53d6\u524d\u7aef\u53d1\u9001\u7ed9\u6211\u4eec\u7684JSON\u683c\u5f0f\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u6dfb\u52a0<code>@RequestBody</code>\u6ce8\u89e3\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(value = \"/test\", produces = \"application/json\")\npublic String hello(@RequestBody User user){\n    boolean success = \"test\".equals(user.getUsername()) &amp;&amp; \"123456\".equals(user.getPassword());\n    JSONObject object = new JSONObject();\n    object.put(\"success\", success);\n    return object.toString();\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u524d\u540e\u7aef\u4f7f\u7528JSON\u5b57\u7b26\u4e32\u8fdb\u884c\u901a\u4fe1\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringMVC/#_11","title":"\u5b9e\u73b0\u6587\u4ef6\u4e0a\u4f20\u548c\u4e0b\u8f7d","text":"<p>\u5229\u7528SpringMVC\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u677e\u5730\u5b9e\u73b0\u6587\u4ef6\u4e0a\u4f20\u548c\u4e0b\u8f7d\uff0c\u6211\u4eec\u9700\u8981\u5728MainInitializer\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u65b9\u6cd5\uff1a</p> <pre><code>public class MainInitializer extends AbstractAnnotationConfigDispatcherServletInitializer {\n\n    ...\n\n    @Override\n    protected void customizeRegistration(ServletRegistration.Dynamic registration) {\n        // \u76f4\u63a5\u901a\u8fc7registration\u914d\u7f6eMultipart\u76f8\u5173\u914d\u7f6e\uff0c\u5fc5\u987b\u914d\u7f6e\u4e34\u65f6\u4e0a\u4f20\u8def\u5f84\uff0c\u5efa\u8bae\u9009\u62e9\u65b9\u4fbf\u6253\u5f00\u7684\n        // \u540c\u6837\u53ef\u4ee5\u8bbe\u7f6e\u5176\u4ed6\u5c5e\u6027\uff1amaxFileSize, maxRequestSize, fileSizeThreshold\n        registration.setMultipartConfig(new MultipartConfigElement(\"/Users/nagocoler/Download\"));\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u76f4\u63a5\u7f16\u5199Controller\u5373\u53ef\uff1a</p> <pre><code>@RequestMapping(value = \"/upload\", method = RequestMethod.POST)\n@ResponseBody\npublic String upload(@RequestParam MultipartFile file) throws IOException {\n    File fileObj = new File(\"test.png\");\n    file.transferTo(fileObj);\n    System.out.println(\"\u7528\u6237\u4e0a\u4f20\u7684\u6587\u4ef6\u5df2\u4fdd\u5b58\u5230\uff1a\"+fileObj.getAbsolutePath());\n    return \"\u6587\u4ef6\u4e0a\u4f20\u6210\u529f\uff01\";\n}\n</code></pre> <p>\u6700\u540e\u5728\u524d\u7aef\u6dfb\u52a0\u4e00\u4e2a\u6587\u4ef6\u7684\u4e0a\u4f20\u70b9\uff1a</p> <pre><code>&lt;div&gt;\n    &lt;form action=\"upload\" method=\"post\" enctype=\"multipart/form-data\"&gt;\n        &lt;input type=\"file\" name=\"file\"&gt;\n        &lt;input type=\"submit\"&gt;\n    &lt;/form&gt;\n&lt;/div&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u70b9\u51fb\u63d0\u4ea4\u4e4b\u540e\uff0c\u6587\u4ef6\u5c31\u4f1a\u4e0a\u4f20\u5230\u670d\u52a1\u5668\u4e86\u3002</p> <p>\u4e0b\u8f7d\u5176\u5b9e\u548c\u6211\u4eec\u4e4b\u524d\u7684\u5199\u6cd5\u5927\u81f4\u4e00\u6837\uff0c\u76f4\u63a5\u4f7f\u7528HttpServletResponse\uff0c\u5e76\u5411\u8f93\u51fa\u6d41\u4e2d\u4f20\u8f93\u6570\u636e\u5373\u53ef\u3002</p> <pre><code>@RequestMapping(value = \"/download\", method = RequestMethod.GET)\n@ResponseBody\npublic void download(HttpServletResponse response){\n    response.setContentType(\"multipart/form-data\");\n    try(OutputStream stream = response.getOutputStream();\n        InputStream inputStream = new FileInputStream(\"test.png\")){\n        IOUtils.copy(inputStream, stream);\n    }catch (IOException e){\n        e.printStackTrace();\n    }\n}\n</code></pre> <p>\u5728\u524d\u7aef\u9875\u9762\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u4e0b\u8f7d\u70b9\uff1a</p> <pre><code>&lt;a href=\"download\" download=\"test.png\"&gt;\u4e0b\u8f7d\u6700\u65b0\u8d44\u6e90&lt;/a&gt;\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringSecurity/","title":"SpringSecurity","text":"<p>pom.xml</p> <pre><code>&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;  \n    &lt;version&gt;6.0.11&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;org.thymeleaf&lt;/groupId&gt;  \n    &lt;artifactId&gt;thymeleaf-spring6&lt;/artifactId&gt;  \n    &lt;version&gt;3.1.1.RELEASE&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;com.alibaba.fastjson2&lt;/groupId&gt;  \n    &lt;artifactId&gt;fastjson2&lt;/artifactId&gt;  \n    &lt;version&gt;2.0.37&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;com.alibaba.fastjson2&lt;/groupId&gt;  \n    &lt;artifactId&gt;fastjson2-extension-spring6&lt;/artifactId&gt;  \n    &lt;version&gt;2.0.37&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n\n&lt;dependency&gt;  \n    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;  \n    &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;  \n    &lt;version&gt;2.0.5&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;  \n    &lt;artifactId&gt;slf4j-jdk14&lt;/artifactId&gt;  \n    &lt;version&gt;2.0.5&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;  \n    &lt;artifactId&gt;lombok&lt;/artifactId&gt;  \n    &lt;version&gt;1.18.28&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt;  \n    &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt;  \n    &lt;version&gt;2.1.1&lt;/version&gt;  \n&lt;/dependency&gt;\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringSecurity/#springsecurity_1","title":"SpringSecurity\u914d\u7f6e","text":"<p>pom.xml <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;\n    &lt;version&gt;6.1.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;\n    &lt;version&gt;6.1.2&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre></p> <p>src/main/java/com/example/init/SecurityInitializer.java</p> <pre><code>public class SecurityInitializer extends AbstractSecurityWebApplicationInitializer {\n    //\u4e0d\u7528\u91cd\u5199\u4efb\u4f55\u5185\u5bb9\n    //\u8fd9\u91cc\u5b9e\u9645\u4e0a\u4f1a\u81ea\u52a8\u6ce8\u518c\u4e00\u4e2aFilter\uff0cSpringSecurity\u5e95\u5c42\u5c31\u662f\u4f9d\u9760N\u4e2a\u8fc7\u6ee4\u5668\u5b9e\u73b0\u7684\n}\n</code></pre> <p>src/main/java/com/example/config/SpringSecurityConfiguration.java <pre><code>@Configuration  \n@EnableWebSecurity   //\u5f00\u542fWebSecurity\u76f8\u5173\u529f\u80fd  \npublic class SpringSecurityConfiguration {  \n\n}\n</code></pre></p> <p>\u5728MainInitializer\u4e2d\u6dfb\u52a0<code>SecurityConfiguration.class</code></p> <pre><code>    @Override\n    protected Class&lt;?&gt;[] getRootConfigClasses() {\n        return new Class[]{WebConfiguration.class, SecurityConfiguration.class};   \n    }\n</code></pre> <p>\u518d\u6b21\u8fd0\u884c\u9879\u76ee\uff0c\u4f1a\u53d1\u73b0\u65e0\u6cd5\u8fdb\u5165\u7684\u6211\u4eec\u7684\u9875\u9762\u4e2d\uff0c\u65e0\u8bba\u6211\u4eec\u8bbf\u95ee\u54ea\u4e2a\u9875\u9762\uff0c\u90fd\u4f1a\u8fdb\u5165\u5230SpringSecurity\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u4e00\u4e2a\u9ed8\u8ba4\u767b\u5f55\u9875\u9762\uff0c\u4e4b\u540e\u6211\u4eec\u4f1a\u8bb2\u89e3\u5982\u4f55\u8fdb\u884c\u914d\u7f6e\u3002</p> <p></p> <p>\u81f3\u6b64\uff0c\u9879\u76ee\u73af\u5883\u642d\u5efa\u5b8c\u6210\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringSecurity/#_1","title":"\u8ba4\u8bc1","text":"<pre><code>@Configuration  \n@EnableWebSecurity   //\u5f00\u542fWebSecurity\u76f8\u5173\u529f\u80fd  \npublic class SecurityConfiguration {  \n\n    @Bean  \n    public UserDetailsService userDetailsService() {   //\u6dfb\u52a0\u7528\u6237\u4fe1\u606f\n        UserDetails user = User  \n                .withDefaultPasswordEncoder()  \n                .username(\"user\")  \n                .password(\"654321\")  \n                .build();  \n\n\n        UserDetails admin = User  \n                .withDefaultPasswordEncoder()  \n                .username(\"admin\")  \n                .password(\"123456\")  \n                .build();  \n        return new InMemoryUserDetailsManager(user,admin);  \n    }  \n}\n</code></pre> <p>\u5bc6\u7801\u52a0\u5bc6 <pre><code>    //\u8fd9\u91cc\u5c06BCryptPasswordEncoder\u76f4\u63a5\u6ce8\u518c\u4e3aBean\uff0cSecurity\u4f1a\u81ea\u52a8\u8fdb\u884c\u9009\u62e9\n    @Bean\n    public PasswordEncoder passwordEncoder(){\n        return new BCryptPasswordEncoder();\n    }\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/SpringSecurity/#_2","title":"\u57fa\u4e8e\u6570\u636e\u5e93\u9a8c\u8bc1","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b9e\u73b0\u4e86\u76f4\u63a5\u8ba4\u8bc1\u7684\u65b9\u5f0f\uff0c\u4f46\u662f\u5b9e\u9645\u9879\u76ee\u4e2d\u5f80\u5f80\u90fd\u662f\u5c06\u7528\u6237\u4fe1\u606f\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u90a3\u4e48\u5982\u4f55\u5c06\u5176\u8fde\u63a5\u5230\u6570\u636e\u5e93\uff0c\u901a\u8fc7\u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u7684\u7528\u6237\u4fe1\u606f\u6765\u8fdb\u884c\u7528\u6237\u767b\u5f55\u5462\uff1f</p> <p>\u5b98\u65b9\u9ed8\u8ba4\u63d0\u4f9b\u4e86\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u7684\u7528\u6237\u548c\u6743\u9650\u8868\u8bbe\u8ba1\uff0c\u6839\u672c\u4e0d\u9700\u8981\u6211\u4eec\u6765\u5efa\u8868\uff0c\u76f4\u63a5\u5728Navicat\u4e2d\u6267\u884c\u4ee5\u4e0b\u67e5\u8be2\uff1a</p> <pre><code>create table users(username varchar(50) not null primary key,password varchar(500) not null,enabled boolean not null);\ncreate table authorities (username varchar(50) not null,authority varchar(50) not null,constraint fk_authorities_users foreign key(username) references users(username));\ncreate unique index ix_auth_username on authorities (username,authority);\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6dfb\u52a0Mybatis\u548cMySQL\u76f8\u5173\u7684\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;\n    &lt;version&gt;3.5.13&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;\n    &lt;version&gt;3.0.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n    &lt;version&gt;8.0.31&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;\n    &lt;version&gt;6.0.10&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u7f16\u5199\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    @Bean PasswordEncoder passwordEncoder(){\n        return new BCryptPasswordEncoder();\n    }\n\n    @Bean\n    public DataSource dataSource(){\n        //\u6570\u636e\u6e90\u914d\u7f6e\n        return new PooledDataSource(\"com.mysql.cj.jdbc.Driver\",\n                \"jdbc:mysql://localhost:3306/test\", \"root\", \"123456\");\n    }\n\n    @Bean\n    public UserDetailsService userDetailsService(DataSource dataSource,\n                                                 PasswordEncoder encoder) {\n        JdbcUserDetailsManager manager = new JdbcUserDetailsManager(dataSource);\n        //\u4ec5\u9996\u6b21\u542f\u52a8\u65f6\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u7528\u4e8e\u6d4b\u8bd5\uff0c\u540e\u7eed\u65e0\u9700\u521b\u5efa\n            manager.createUser(User.withUsername(\"user\")\n                      .password(encoder.encode(\"password\")).roles(\"USER\").build());\n        return manager;\n    }\n}\n</code></pre> <p>\u542f\u52a8\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u4e24\u5f20\u8868\u4e2d\u5df2\u7ecf\u81ea\u52a8\u6dfb\u52a0\u597d\u5bf9\u5e94\u7684\u6570\u636e\u4e86\uff1a</p> <p></p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c1d\u8bd5\u8fdb\u884c\u767b\u5f55\uff0c\u4f7f\u7528\u65b9\u5f0f\u548c\u4e4b\u524d\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u5f53\u6211\u4eec\u4e0b\u6b21\u9700\u8981\u5feb\u901f\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u767b\u5f55\u7684\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u76f4\u63a5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u5c31\u80fd\u5feb\u901f\u5b8c\u6210\u4e86\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u7279\u522b\u65b9\u4fbf\u3002</p> <p>\u65e0\u8bba\u662f\u6211\u4eec\u4e0a\u8282\u8bfe\u8ba4\u8bc6\u7684InMemoryUserDetailsManager\u8fd8\u662f\u73b0\u5728\u8ba4\u8bc6\u7684JdbcUserDetailsManager\uff0c\u4ed6\u4eec\u90fd\u662f\u5b9e\u73b0\u81eaUserDetailsManager\u63a5\u53e3\uff0c\u8fd9\u4e2a\u63a5\u53e3\u4e2d\u6709\u7740\u4e00\u5957\u5b8c\u6574\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c\uff0c\u65b9\u4fbf\u6211\u4eec\u76f4\u63a5\u5bf9\u7528\u6237\u8fdb\u884c\u5904\u7406\uff1a</p> <pre><code>public interface UserDetailsManager extends UserDetailsService {\n\n  //\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7528\u6237\n    void createUser(UserDetails user);\n\n  //\u66f4\u65b0\u7528\u6237\u4fe1\u606f\n    void updateUser(UserDetails user);\n\n  //\u5220\u9664\u7528\u6237\n    void deleteUser(String username);\n\n  //\u4fee\u6539\u7528\u6237\u5bc6\u7801\n    void changePassword(String oldPassword, String newPassword);\n\n  //\u5224\u65ad\u662f\u5426\u5b58\u5728\u6307\u5b9a\u7528\u6237\n    boolean userExists(String username);\n}\n</code></pre> <p>\u901a\u8fc7\u4f7f\u7528UserDetailsManager\u5bf9\u8c61\uff0c\u6211\u4eec\u5c31\u80fd\u5feb\u901f\u6267\u884c\u7528\u6237\u76f8\u5173\u7684\u7ba1\u7406\u64cd\u4f5c\uff0c\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u7f51\u7ad9\u4e0a\u6dfb\u52a0\u4e00\u4e2a\u5feb\u901f\u91cd\u7f6e\u5bc6\u7801\u7684\u63a5\u53e3\uff0c\u9996\u5148\u9700\u8981\u914d\u7f6e\u4e00\u4e0bJdbcUserDetailsManager\uff0c\u4e3a\u5176\u6dfb\u52a0\u4e00\u4e2aAuthenticationManager\u7528\u4e8e\u539f\u5bc6\u7801\u7684\u6821\u9a8c\uff1a</p> <pre><code>@Configuration\n@EnableWebSecurity\npublic class SecurityConfiguration {\n\n    ...\n\n    //\u624b\u52a8\u521b\u5efa\u4e00\u4e2aAuthenticationManager\u7528\u4e8e\u5904\u7406\u5bc6\u7801\u6821\u9a8c\n    private AuthenticationManager authenticationManager(UserDetailsManager manager,\n                                                        PasswordEncoder encoder){\n        DaoAuthenticationProvider provider = new DaoAuthenticationProvider();\n        provider.setUserDetailsService(manager);\n        provider.setPasswordEncoder(encoder);\n        return new ProviderManager(provider);\n    }\n\n    @Bean\n    public UserDetailsManager userDetailsService(DataSource dataSource,\n                                                 PasswordEncoder encoder) throws Exception {\n        JdbcUserDetailsManager manager = new JdbcUserDetailsManager(dataSource);\n        //\u4e3aUserDetailsManager\u8bbe\u7f6eAuthenticationManager\u5373\u53ef\u5f00\u542f\u91cd\u7f6e\u5bc6\u7801\u7684\u65f6\u7684\u6821\u9a8c\n        manager.setAuthenticationManager(authenticationManager(manager, encoder));\n        return manager;\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u7f16\u5199\u4e00\u4e2a\u5feb\u901f\u91cd\u7f6e\u5bc6\u7801\u7684\u63a5\u53e3\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(\"/change-password\")\npublic JSONObject changePassword(@RequestParam String oldPassword,\n                                 @RequestParam String newPassword) {\n    manager.changePassword(oldPassword, encoder.encode(newPassword));\n    JSONObject object = new JSONObject();\n    object.put(\"success\", true);\n    return object;\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728\u4e3b\u754c\u9762\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u91cd\u7f6e\u5bc6\u7801\u7684\u64cd\u4f5c\uff1a</p> <pre><code>&lt;div&gt;\n    &lt;label&gt;\n        \u4fee\u6539\u5bc6\u7801\uff1a\n        &lt;input type=\"text\" id=\"oldPassword\" placeholder=\"\u65e7\u5bc6\u7801\"/&gt;\n        &lt;input type=\"text\" id=\"newPassword\" placeholder=\"\u65b0\u5bc6\u7801\"/&gt;\n    &lt;/label&gt;\n    &lt;button onclick=\"change()\"&gt;\u4fee\u6539\u5bc6\u7801&lt;/button&gt;\n&lt;/div&gt;\n</code></pre> <pre><code>function change() {\n    const oldPassword = document.getElementById(\"oldPassword\").value\n    const newPassword = document.getElementById(\"newPassword\").value\n    const csrf = document.getElementById(\"_csrf\").value\n    axios.post('/mvc/change-password', {\n        oldPassword: oldPassword,\n        newPassword: newPassword,\n        _csrf: csrf\n    }, {\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n        }\n    }).then(({data}) =&gt; {\n        alert(data.success ? \"\u5bc6\u7801\u4fee\u6539\u6210\u529f\" : \"\u5bc6\u7801\u4fee\u6539\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u539f\u5bc6\u7801\u662f\u5426\u6b63\u786e\")\n    })\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u9996\u9875\u8fdb\u884c\u4fee\u6539\u5bc6\u7801\u64cd\u4f5c\u4e86</p> <p>\u5f53\u7136\uff0c\u8fd9\u79cd\u65b9\u5f0f\u7684\u6743\u9650\u6821\u9a8c\u867d\u7136\u80fd\u591f\u76f4\u63a5\u4f7f\u7528\u6570\u636e\u5e93\uff0c\u4f46\u662f\u5b58\u5728\u4e00\u5b9a\u7684\u5c40\u9650\u6027\uff0c\u53ea\u9002\u5408\u5feb\u901f\u642d\u5efaDemo\u4f7f\u7528\uff0c\u4e0d\u9002\u5408\u5b9e\u9645\u751f\u4ea7\u73af\u5883\u4e0b\u7f16\u5199\uff0c\u4e0b\u4e00\u8282\u6211\u4eec\u5c06\u4ecb\u7ecd\u5982\u4f55\u5b9e\u73b0\u81ea\u5b9a\u4e49\u9a8c\u8bc1\uff0c\u4ee5\u5e94\u5bf9\u5404\u79cd\u60c5\u51b5\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/","title":"Spring","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#bean","title":"Bean\u7684\u6ce8\u518c\u548c\u914d\u7f6e","text":"<p>java\u4ee3\u7801 <pre><code>public class Main {\n    public static void main(String[] args) {\n        ApplicationContext context = new ClassPathXmlApplicationContext(\"application.xml\"); // \u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\n         // Bean\u7684\u6ce8\u518c\u4e0e\u914d\u7f6e\n         Student student  = context.getBean(Student.class); // \u901a\u8fc7class\u83b7\u5f97\u7c7b \u4f1a\u81ea\u52a8\u9009\u62e9\n         Student student = (Student) context.getBean(\"stu\"); // \u901a\u8fc7bean\u7684name\u83b7\u5f97\u7c7b\n         student.hello();\n    }\n}\n</code></pre></p> <p>xml\u914d\u7f6e\u6587\u4ef6 <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n\n    &lt;bean name=\"stu\" class=\"org.example.entity.Student\"/&gt; // \u586b\u5199\u7c7b\u7684\u4f4d\u7f6e\n    &lt;!--\n    &lt;bean name=\"stu\" class=\"org.example.entity.Student\" scope=\"prototype\"/&gt; // \u539f\u578b\u6a21\u5f0f\n    &lt;bean name=\"stu\" class=\"org.example.entity.Student\" lazy-init=\"true\"/&gt;  // \u61d2\u52a0\u8f7d\n    &lt;bean name=\"stu\" class=\"org.example.entity.Student\" depends-on=\"a\"/&gt;    // \u4f9d\u8d56a\n    --&gt;\n    &lt;bean name=\"a\" class=\"org.example.service.AService\"/&gt; &lt;!-- \u6ce8\u518cAService --&gt;\n    &lt;alias name=\"a\" alias=\"aaa\"/&gt;                         &lt;!-- \u522b\u540d --&gt;\n&lt;/beans&gt;\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#_1","title":"\u4f9d\u8d56\u6ce8\u5165","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\uff0c\u6f14\u793a\u5982\u4f55\u5728Spring XML\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165\uff1a</p> <ol> <li>\u521b\u5efa\u4e00\u4e2aJava\u7c7b\uff0c\u4f5c\u4e3a\u9700\u8981\u6ce8\u5165\u7684\u4f9d\u8d56\u5bf9\u8c61\uff0c\u4f8b\u5982\uff1a</li> </ol> <pre><code>public class MyDependency {\n    public void doSomething() {\n        System.out.println(\"MyDependency is doing something\");\n    }\n}\n</code></pre> <pre><code>@ToString\npublic class Student {\n    String name;\n    Teacher1 teacher;\n    private  List&lt;String&gt; list;\n    public void setList(List&lt;String&gt; list) {\n        this.list = list;\n    }\n//    public Student(Teacher1 teacher, String name) {\n//        this.teacher = teacher;\n//        this.name = name;\n//    }\n//\n//    public Student(Teacher1 teacher) {\n//        this.teacher=teacher;\n//    }\n//\n//    public Student(String name) {\n//        this.name = name;\n//    }\n//    public void setName(String name) {\n//        this.name = name;\n//    }\n//\n//    public void setTeacher(Teacher1 teacher) {\n//        this.teacher = teacher;\n//    }\n}\n</code></pre> <ol> <li>\u521b\u5efa\u4e00\u4e2aSpring XML\u914d\u7f6e\u6587\u4ef6\uff0c\u4f8b\u5982\uff0c\u540d\u4e3a\"applicationContext.xml\"\uff0c\u5e76\u5728\u5176\u4e2d\u5b9a\u4e49bean\u548c\u4f9d\u8d56\u6ce8\u5165\uff0c\u4f8b\u5982\uff1a</li> </ol> <p>\u901a\u8fc7\u4f7f\u7528\u4f9d\u8d56\u6ce8\u5165\uff0c\u53ef\u4ee5\u5c06\u5bf9\u8c61\u7684\u521b\u5efa\u548c\u4f9d\u8d56\u5173\u7cfb\u7684\u914d\u7f6e\u4ece\u4ee3\u7801\u4e2d\u62bd\u79bb\u51fa\u6765\uff0c\u8f6c\u79fb\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u7ba1\u7406 \u5373\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u7f6e\u5bf9\u8c61\u7684\u521d\u59cb\u503c</p> <pre><code>&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n                           http://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n\n    &lt;bean id=\"myDependency\" class=\"com.example.MyDependency\"/&gt;\n\n    &lt;bean id=\"myBean\" class=\"com.example.MyBean\"&gt;\n        &lt;property name=\"dependency\" ref=\"myDependency\"/&gt; &lt;!-- \u4f9d\u8d56myDependency --&gt;\n    &lt;/bean&gt;\n\n\n\n    &lt;bean name=\"artTeacher\" class=\"org.example.entity.ArtTeacher\"/&gt;\n    &lt;bean name=\"stu\" class=\"org.example.entity.Student\"&gt;\n    &lt;!--&lt;property name=\"name\" value=\"\u5c0f\u660e\"/&gt;--&gt;\n    &lt;!--&lt;property name=\"teacher\" ref=\"artTeacher\"/&gt;  //\u5f53stu\u4f7f\u7528teacher\u65f6\uff0c\u4f1a\u901a\u8fc7set\u51fd\u6570\u6ce8\u5165artTeacher--&gt;\n    &lt;!--&lt;constructor-arg name=\"teacher\" ref=\"artTeacher\"/&gt;--&gt;\n    &lt;!--&lt;constructor-arg name=\"name\" value=\"\u5c0f\u660e\" type=\"java.lang.String\"/&gt;   // \u901a\u8fc7\u6784\u9020\u51fd\u6570\u6ce8\u5165\uff0c \u5f53\u6709\u4e24\u4e2a\u4e0d\u540c\u7684\u6784\u9020\u51fd\u6570\u65f6\uff0c\u80fd\u591f\u81ea\u52a8\u9009\u62e9 --&gt;\n        &lt;property name=\"list\"&gt;\n            &lt;list&gt;\n                &lt;value&gt;aaa&lt;/value&gt; &lt;!-- \u6ce8\u5165\u5217\u8868\u5230\u6784\u9020\u51fd\u6570\u4e2d --&gt;\n                &lt;value&gt;bbb&lt;/value&gt;\n                &lt;value&gt;ccc&lt;/value&gt;\n            &lt;/list&gt;\n        &lt;/property&gt;\n    &lt;/bean&gt;\n\n&lt;/beans&gt;\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a\"myDependency\"\u7684bean\uff0c\u5b83\u7684\u7c7b\u662f\"com.example.MyDependency\"\u3002\u7136\u540e\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a\"myBean\"\u7684bean\uff0c\u5b83\u7684\u7c7b\u662f\"com.example.MyBean\"\u3002\u5728\"myBean\"\u7684\u5b9a\u4e49\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\"property\"\u5143\u7d20\u6765\u6ce8\u5165\"myDependency\"\u4f5c\u4e3a\u4f9d\u8d56\u3002</p> <ol> <li>\u521b\u5efa\u4e00\u4e2aJava\u7c7b\uff0c\u8868\u793a\u9700\u8981\u4f9d\u8d56\u6ce8\u5165\u7684\u5bf9\u8c61\uff0c\u4f8b\u5982\uff1a</li> </ol> <pre><code>public class MyBean {\n    private MyDependency dependency;\n\n    public void setDependency(MyDependency dependency) {\n        this.dependency = dependency;\n    }\n\n    public void doSomethingWithDependency() {\n        dependency.doSomething();\n    }\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\"dependency\"\u5c5e\u6027\uff0c\u5e76\u63d0\u4f9b\u4e86\u4e00\u4e2a\"setDependency\"\u65b9\u6cd5\uff0c\u7528\u4e8e\u6ce8\u5165\u4f9d\u8d56\u5bf9\u8c61\u3002\u6211\u4eec\u8fd8\u5b9a\u4e49\u4e86\u4e00\u4e2a\"doSomethingWithDependency\"\u65b9\u6cd5\uff0c\u7528\u4e8e\u5728\u9700\u8981\u65f6\u4f7f\u7528\u4f9d\u8d56\u5bf9\u8c61\u3002</p> <ol> <li>\u521b\u5efa\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u5165\u53e3\u7c7b\uff0c\u5e76\u4f7f\u7528Spring\u6846\u67b6\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\u5e76\u83b7\u53d6bean\uff0c\u4f8b\u5982\uff1a</li> </ol> <pre><code>import org.springframework.context.ApplicationContext;\nimport org.springframework.context.support.ClassPathXmlApplicationContext;\n\npublic class MyApp {\n    public static void main(String[] args) {\n        ApplicationContext context = new ClassPathXmlApplicationContext(\"applicationContext.xml\");\n\n        MyBean myBean = (MyBean) context.getBean(\"myBean\");\n        myBean.doSomethingWithDependency();\n    }\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\"ClassPathXmlApplicationContext\"\u7c7b\u52a0\u8f7d\"applicationContext.xml\"\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528\"getBean\"\u65b9\u6cd5\u83b7\u53d6\u540d\u4e3a\"myBean\"\u7684bean\u3002\u7136\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u8be5bean\u8c03\u7528\u76f8\u5173\u65b9\u6cd5\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#_2","title":"\u81ea\u52a8\u88c5\u914d","text":"<p>\u624b\u52a8\u88c5\u914d</p> <pre><code>    &lt;bean name=\"teacher\" class=\"org.example.entity.ArtTeacher\"/&gt;\n    &lt;bean name=\"student\" class=\"org.example.entity.Student\"&gt;\n        &lt;property name=\"teacher\" ref=\"teacher\"/&gt;\n    &lt;/bean&gt;\n</code></pre> <p>\u81ea\u52a8\u88c5\u914d</p> <pre><code>    &lt;bean name=\"teacher\" class=\"org.example.entity.ArtTeacher\"/&gt;\n    &lt;bean name=\"student\" class=\"org.example.entity.Student\" autowire=\"byType\"/&gt;\n                                                            &lt;!-- byNanme --&gt;\n</code></pre> <p>byName\u7684\u60c5\u51b5</p> <pre><code>    &lt;bean name=\"program\" class=\"org.example.entity.ProgramTeacher\"/&gt;\n    &lt;bean name=\"art\" class=\"org.example.entity.ArtTeacher\"/&gt;\n    &lt;bean name=\"student\" class=\"org.example.entity.Student\" autowire=\"byName\" /&gt;\n</code></pre> <pre><code>@ToString\npublic class Student {\n    String name;\n    Teacher1 teacher;\n\n    public void setArt(Teacher1 teacher) { // \u6839\u636esetxxx\u51b3\u5b9a\u81ea\u52a8\u88c5\u914dxxx\n        this.teacher = teacher;\n    }\n\n    public void setProgram(Teacher1 teacher) { // \u5982\u679c\u5b58\u5728\u8be5\u51fd\u6570\u5219\u88c5\u914d\u8fd9\u4e2a\uff0c\u65e0\u6cd5\u901a\u8fc7\u6dfb\u52a0autowire-candidate=\"false\"\u6216\u8005primary\u907f\u514d\uff0c\u603b\u662f\u9009\u62e9\u6700\u540e\u51fa\u73b0\u7684set\u51fd\u6570\n        this.teacher =teacher;\n    }\n}\n</code></pre> <p><code>autowire = 'constructor'</code>\u81ea\u52a8\u88c5\u914d\u6784\u9020\u51fd\u6570</p> <p>\u907f\u514d\u81ea\u52a8\u88c5\u914d</p> <pre><code>    &lt;bean name=\"art\" class=\"org.example.entity.ArtTeacher\"/&gt;\n    &lt;bean name=\"program\" class=\"org.example.entity.ProgramTeacher\" autowire-candidate=\"false\"/&gt;\n    &lt;bean name=\"student\" class=\"org.example.entity.Student\" autowire=\"byType\" /&gt;\n</code></pre> <pre><code>@ToString\npublic class Student {\n    String name;\n    Teacher1 teacher;\n\n    public void setArt(Teacher1 teacher) {\n        this.teacher = teacher;\n    }\n\n    public void setProgram(Teacher1 teacher) {\n        this.teacher =teacher;\n    }\n}\n</code></pre> <p>\u8f93\u51fa <pre><code>Student(name=null, teacher=org.example.entity.ArtTeacher@6ff29830)\n</code></pre></p> <p>\u4f18\u5148\u9009\u62e9 <pre><code>    &lt;bean name=\"art\" class=\"org.example.entity.ArtTeacher\" primary=\"true\"/&gt;\n    &lt;bean name=\"program\" class=\"org.example.entity.ProgramTeacher\"/&gt;\n    &lt;bean name=\"student\" class=\"org.example.entity.Student\" autowire=\"byName\" /&gt;\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#_3","title":"\u751f\u547d\u5468\u671f\u548c\u7ee7\u627f","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#_4","title":"\u751f\u547d\u5468\u671f","text":"<p>\u9664\u4e86\u4fee\u6539\u6784\u9020\u65b9\u6cd5\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4e3aBean\u6307\u5b9a\u521d\u59cb\u5316\u65b9\u6cd5\u548c\u9500\u6bc1\u65b9\u6cd5\uff0c\u4ee5\u4fbf\u5728\u5bf9\u8c61\u521b\u5efa\u548c\u88ab\u9500\u6bc1\u65f6\u6267\u884c\u4e00\u4e9b\u5176\u4ed6\u7684\u4efb\u52a1\uff1a</p> <pre><code>public void init(){\n    System.out.println(\"\u6211\u662f\u5bf9\u8c61\u521d\u59cb\u5316\u65f6\u8981\u505a\u7684\u4e8b\u60c5\uff01\");    \n}\n\npublic void destroy(){\n    System.out.println(\"\u6211\u662f\u5bf9\u8c61\u9500\u6bc1\u65f6\u8981\u505a\u7684\u4e8b\u60c5\uff01\");\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>init-method</code>\u548c<code>destroy-method</code>\u6765\u6307\u5b9a\uff1a</p> <pre><code>&lt;bean name=\"student\" class=\"com.test.bean.Student\" init-method=\"init\" destroy-method=\"destroy\"/&gt;\n</code></pre> <p>\u90a3\u4e48\u4ec0\u4e48\u65f6\u5019\u662f\u521d\u59cb\u5316\uff0c\u4ec0\u4e48\u65f6\u5019\u53c8\u662f\u9500\u6bc1\u5462\uff1f</p> <pre><code>//\u5f53\u5bb9\u5668\u521b\u5efa\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0bBean\u90fd\u662f\u5355\u4f8b\u7684\uff0c\u90a3\u4e48\u90fd\u4f1a\u5728\u4e00\u5f00\u59cb\u5c31\u52a0\u8f7d\u597d\uff0c\u5bf9\u8c61\u6784\u9020\u5b8c\u6210\u540e\uff0c\u4f1a\u6267\u884cinit-method\nClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(\"test.xml\");\n//\u6211\u4eec\u53ef\u4ee5\u8c03\u7528close\u65b9\u6cd5\u5173\u95ed\u5bb9\u5668\uff0c\u6b64\u65f6\u5bb9\u5668\u5185\u5b58\u653e\u7684Bean\u4e5f\u4f1a\u88ab\u4e00\u8d77\u9500\u6bc1\uff0c\u4f1a\u6267\u884cdestroy-method\ncontext.close();\n</code></pre> <pre><code>public class Main {\n    public static void main(String[] args) {\n        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(\"application.xml\"); // \u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\n\n        Student student = context.getBean(Student.class);\n        System.out.println(student);\n\n        context.close();\n\n    }\n}\n</code></pre> <p>\u52a0\u8f7d\u65f6init\uff0c \u5355\u4f8b\u6a21\u5f0f\u4e0b\uff0c\u9500\u6bc1\u65f6destroy</p> <p>\u6240\u4ee5\uff0c\u6700\u540e\u7684\u7ed3\u679c\u4e3a\uff1a <pre><code>\u6211\u662f\u5bf9\u8c61\u521d\u59cb\u5316\u65f6\u8981\u505a\u7684\u4e8b\u60c5\uff01\nStudent()\n\u6211\u662f\u5bf9\u8c61\u9500\u6bc1\u65f6\u8981\u505a\u7684\u4e8b\u60c5\uff01\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#_5","title":"\u7ee7\u627f","text":"<p>Bean\u4e4b\u95f4\u4e5f\u662f\u5177\u5907\u7ee7\u627f\u5173\u7cfb\u7684\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u91cc\u7684\u7ee7\u627f\u5e76\u4e0d\u662f\u7c7b\u7684\u7ee7\u627f\uff0c\u800c\u662f\u5c5e\u6027\u7684\u7ee7\u627f\uff0c\u6bd4\u5982\uff1a</p> <pre><code>public class SportStudent {\n    private String name;\n\n    public void setName(String name) {\n        this.name = name;\n    }\n}\n</code></pre> <pre><code>public class ArtStudent {\n    private String name;\n\n    public void setName(String name) {\n        this.name = name;\n    }\n}\n</code></pre> <p>\u5982\u679c\u65b0\u7684Bean\u548c\u4e4b\u524d\u7684Bean\u5c5e\u6027\u4e00\u6837\uff0c\u4f46\u5c5e\u6027\u592a\u591a\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u914d\u7f6eBean\u4e4b\u95f4\u7684\u7ee7\u627f\u5173\u7cfb\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9SportStudent\u8fd9\u4e2aBean\u76f4\u63a5\u7ee7\u627fArtStudent\u8fd9\u4e2aBean\u914d\u7f6e\u7684\u5c5e\u6027\uff1a</p> <pre><code>&lt;bean class=\"com.test.bean.SportStudent\" parent=\"artStudent\"/&gt;\n</code></pre> <p>\u8fd9\u6837\uff0c\u5728ArtStudent Bean\u4e2d\u914d\u7f6e\u7684\u5c5e\u6027\uff0c\u4f1a\u76f4\u63a5\u7ee7\u627f\u7ed9SportStudent Bean\uff08\u6ce8\u610f\uff0c\u6240\u6709\u914d\u7f6e\u7684\u5c5e\u6027\uff0c\u5728\u5b50Bean\u4e2d\u5fc5\u987b\u4e5f\u8981\u5b58\u5728\uff0c\u5e76\u4e14\u53ef\u4ee5\u8fdb\u884c\u6ce8\u5165\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u9519\u8bef\uff09\u5f53\u7136\uff0c\u5982\u679c\u5b50\u7c7b\u4e2d\u67d0\u4e9b\u5c5e\u6027\u6bd4\u8f83\u7279\u6b8a\uff0c\u4e5f\u53ef\u4ee5\u5728\u7ee7\u627f\u7684\u57fa\u7840\u4e0a\u5355\u72ec\u914d\u7f6e\uff1a</p> <pre><code>&lt;bean name=\"artStudent\" class=\"com.test.bean.ArtStudent\" abstract=\"true\"&gt;\n    &lt;property name=\"name\" value=\"\u5c0f\u660e\"/&gt;\n    &lt;property name=\"id\" value=\"1\"/&gt;\n&lt;/bean&gt;\n&lt;bean class=\"com.test.bean.SportStudent\" parent=\"artStudent\"&gt;\n    &lt;property name=\"id\" value=\"2\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u53ea\u662f\u5e0c\u671b\u67d0\u4e00\u4e2aBean\u4ec5\u4f5c\u4e3a\u4e00\u4e2a\u914d\u7f6e\u6a21\u7248\u4f9b\u5176\u4ed6Bean\u7ee7\u627f\u4f7f\u7528\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u914d\u7f6e\u4e3aabstract\uff0c\u8fd9\u6837\uff0c\u5bb9\u5668\u5c31\u4e0d\u4f1a\u521b\u5efa\u8fd9\u4e2aBean\u7684\u5bf9\u8c61\u4e86\uff1a</p> <pre><code>&lt;bean name=\"artStudent\" class=\"com.test.bean.ArtStudent\" abstract=\"true\"&gt;\n    &lt;property name=\"name\" value=\"\u5c0f\u660e\"/&gt;\n&lt;/bean&gt;\n&lt;bean class=\"com.test.bean.SportStudent\" parent=\"artStudent\"/&gt;\n</code></pre> <p>\u6ce8\u610f\uff0c\u4e00\u65e6\u58f0\u660e\u4e3a\u62bd\u8c61Bean\uff0c\u90a3\u4e48\u5c31\u65e0\u6cd5\u901a\u8fc7\u5bb9\u5668\u83b7\u53d6\u5230\u5176\u5b9e\u4f8b\u5316\u5bf9\u8c61\u4e86\u3002</p> <p></p> <p>\u4e0d\u8fc7Bean\u7684\u7ee7\u627f\u4f7f\u7528\u9891\u7387\u4e0d\u662f\u5f88\u9ad8\uff0c\u4e86\u89e3\u5c31\u884c\u3002</p> <p>\u8fd9\u91cc\u6700\u540e\u518d\u63d0\u4e00\u4e0b\uff0c\u6211\u4eec\u524d\u9762\u5df2\u7ecf\u5b66\u4e60\u4e86\u5404\u79cd\u5404\u6837\u7684Bean\u914d\u7f6e\u5c5e\u6027\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u6574\u4e2a\u4e0a\u4e0b\u6587\u4e2d\u6240\u6709\u7684Bean\u90fd\u91c7\u7528\u67d0\u79cd\u914d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6700\u5916\u5c42\u7684beans\u6807\u7b7e\u4e2d\u8fdb\u884c\u9ed8\u8ba4\u914d\u7f6e\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u5373\u4f7fBean\u6ca1\u6709\u914d\u7f6e\u67d0\u9879\u5c5e\u6027\uff0c\u4f46\u662f\u53ea\u8981\u5728\u6700\u5916\u5c42\u7f16\u5199\u4e86\u9ed8\u8ba4\u914d\u7f6e\uff0c\u90a3\u4e48\u540c\u6837\u4f1a\u751f\u6548\uff0c\u9664\u975eBean\u81ea\u5df1\u8fdb\u884c\u914d\u7f6e\u8986\u76d6\u6389\u9ed8\u8ba4\u914d\u7f6e\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#bean_1","title":"\u5de5\u5382\u6a21\u5f0f\u548c\u5de5\u5382Bean","text":"<pre><code>public class Student {\n    Student() {\n        System.out.println(\"\u6211\u88ab\u6784\u9020\u4e86\");\n    }\n}\n</code></pre> <pre><code>public class StudentFactory {\n    public static Student getStudent(){\n        System.out.println(\"\u6b22\u8fce\u5149\u4e34\u7535\u5b50\u5382\");\n        return new Student();\n    }\n}\n</code></pre> <p>\u6b64\u65f6Student\u6709\u4e00\u4e2a\u5de5\u5382\uff0c\u6211\u4eec\u6b63\u5e38\u60c5\u51b5\u4e0b\u9700\u8981\u4f7f\u7528\u5de5\u5382\u624d\u53ef\u4ee5\u5f97\u5230Student\u5bf9\u8c61\uff0c\u73b0\u5728\u6211\u4eec\u5e0c\u671bSpring\u4e5f\u8fd9\u6837\u505a\uff0c\u4e0d\u8981\u76f4\u63a5\u53bb\u53cd\u5c04\u641e\u6784\u9020\u65b9\u6cd5\u521b\u5efa\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7factory-method\u8fdb\u884c\u6307\u5b9a\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        https://www.springframework.org/schema/beans/spring-beans.xsd\"&gt;\n\n    &lt;bean class=\"org.example.entity.StudentFactory\" factory-method=\"getStudent\" /&gt;\n\n&lt;/beans&gt;\n</code></pre> <pre><code>public class Main {\n    public static void main(String[] args) {\n        ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext(\"application.xml\"); // \u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\n\n        System.out.println(context.getBean(Student.class));\n\n    }\n}\n</code></pre> <p>output <pre><code>\u6b22\u8fce\u5149\u4e34\u7535\u5b50\u5382\n\u6211\u88ab\u6784\u9020\u4e86\norg.example.entity.Student@4e08711f\n</code></pre></p> <p>\u5f53\u6211\u4eec\u91c7\u7528\u5de5\u5382\u6a21\u5f0f\u540e\uff0c\u6211\u4eec\u5c31\u65e0\u6cd5\u518d\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u5bf9Bean\u8fdb\u884c\u4f9d\u8d56\u6ce8\u5165\u7b49\u64cd\u4f5c\u4e86\uff0c\u800c\u662f\u53ea\u80fd\u5728\u5de5\u5382\u65b9\u6cd5\u4e2d\u5b8c\u6210\uff0c\u8fd9\u4f3c\u4e4e\u4e0eSpring\u7684\u8bbe\u8ba1\u7406\u5ff5\u80cc\u9053\u800c\u9a70\uff1f</p> <p>\u5f53\u7136\uff0c\u53ef\u80fd\u67d0\u4e9b\u5de5\u5382\u7c7b\u9700\u8981\u6784\u9020\u51fa\u5bf9\u8c61\u4e4b\u540e\u624d\u80fd\u4f7f\u7528\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u67d0\u4e2a\u5de5\u5382\u7c7b\u76f4\u63a5\u6ce8\u518c\u4e3a\u5de5\u5382Bean\uff1a</p> <pre><code>public class StudentFactory {\n    public Student getStudent(){\n        System.out.println(\"\u6b22\u8fce\u5149\u4e34\u7535\u5b50\u5382\");\n        return new Student();\n    }\n}\n</code></pre> <p>\u73b0\u5728\u9700\u8981StudentFactory\u5bf9\u8c61\u624d\u53ef\u4ee5\u83b7\u53d6\u5230Student\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u53ea\u80fd\u5148\u5c06\u5176\u6ce8\u518c\u4e3aBean\u4e86\uff1a</p> <pre><code>&lt;bean name=\"studentFactory\" class=\"com.test.bean.StudentFactory\"/&gt;\n</code></pre> <p>\u50cf\u8fd9\u6837\u5c06\u5de5\u5382\u7c7b\u6ce8\u518c\u4e3aBean\uff0c\u6211\u4eec\u79f0\u5176\u4e3a\u5de5\u5382Bean\uff0c\u7136\u540e\u518d\u4f7f\u7528<code>factory-bean</code>\u6765\u6307\u5b9aBean\u7684\u5de5\u5382Bean\uff1a</p> <pre><code>&lt;bean factory-bean=\"studentFactory\" factory-method=\"getStudent\"/&gt;\n</code></pre> <p>\u6ce8\u610f\uff0c\u4f7f\u7528factory-bean\u4e4b\u540e\uff0c\u4e0d\u518d\u8981\u6c42\u6307\u5b9aclass\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e86</p> <p>\u5982\u679c\u6211\u4eec\u60f3\u83b7\u53d6\u5de5\u5382Bean\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684Bean\uff0c\u53ef\u4ee5\u76f4\u63a5\u8f93\u5165\u5de5\u5382Bean\u7684\u540d\u79f0\uff0c\u8fd9\u6837\u4e0d\u4f1a\u5f97\u5230\u5de5\u5382Bean\u7684\u5b9e\u4f8b\uff0c\u800c\u662f\u5de5\u5382Bean\u751f\u4ea7\u7684Bean\u7684\u5b9e\u4f8b\uff1a</p> <pre><code>Student bean = (Student) context.getBean(\"studentFactory\");\n</code></pre> <p>\u5f53\u7136\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u83b7\u53d6\u5de5\u5382\u7c7b\u7684\u5b9e\u4f8b\uff0c\u53ef\u4ee5\u5728\u540d\u79f0\u524d\u9762\u6dfb\u52a0<code>&amp;</code>\u7b26\u53f7\uff1a</p> <pre><code>StudentFactory bean = (StudentFactory) context.getBean(\"&amp;studentFactory\");\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#_6","title":"\u4f7f\u7528\u6ce8\u89e3\u5f00\u53d1","text":"<p>\u4e0d\u518d\u9700\u8981xml\u914d\u7f6e\u6587\u4ef6</p> <p>\u65b0\u5efa\u4e00\u4e2a\u914d\u7f6e\u7c7b</p> <pre><code>@Configuration  \npublic class MainConfiguration {  \n}\n</code></pre> <p>\u4fee\u6539Main\u7c7b\u4e3a\uff1a <pre><code>public class Main {  \n    public static void main(String[] args) {  \n        ApplicationContext context = new AnnotationConfigApplicationContext(MainConfiguration.class); // \u52a0\u8f7d\u914d\u7f6e\u7c7b  \n        System.out.println(context.getBean(Student.class));  \n    }  \n}\n</code></pre></p> <p>\u65b0\u589eBean\uff1a \u5728\u914d\u7f6e\u7c7b\u4e2d\u6dfb\u52a0</p> <pre><code>@Configuration\npublic class MainConfiguration {\n    @Bean\n    public Student student(){ // \u6dfb\u52a0Student Bean\n        return new Student();\n    }\n//    @Bean(\"test\")\n//    @Lazy(true)\n//    @Scope(\"prototype\")\n//    public Student student(){\n//        return new Student();\n//    }\n}\n</code></pre> <p>\uff0c\u521d\u59cb\u5316\u65b9\u6cd5\u548c\u6467\u6bc1\u65b9\u6cd5\u3001\u81ea\u52a8\u88c5\u914d\u53ef\u4ee5\u76f4\u63a5\u5728@Bean\u6ce8\u89e3\u4e2d\u8fdb\u884c\u914d\u7f6e\uff1a</p> <pre><code>@Bean(name = \"\", initMethod = \"\", destroyMethod = \"\", autowireCandidate = false)\npublic Student student(){\n    return new Student();\n}\n</code></pre> <p>\u5176\u6b21\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u5176\u4ed6\u7684\u6ce8\u89e3\u6765\u914d\u7f6e\u5176\u4ed6\u5c5e\u6027\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@Bean\n@Lazy(true)     //\u5bf9\u5e94lazy-init\u5c5e\u6027\n@Scope(\"prototype\")    //\u5bf9\u5e94scope\u5c5e\u6027\n@DependsOn(\"teacher\")    //\u5bf9\u5e94depends-on\u5c5e\u6027\npublic Student student(){\n    return new Student();\n}\n</code></pre> <p>\u5bf9\u4e8e\u90a3\u4e9b\u6211\u4eec\u9700\u8981\u901a\u8fc7\u6784\u9020\u65b9\u6cd5\u6216\u662fSetter\u5b8c\u6210\u4f9d\u8d56\u6ce8\u5165\u7684Bean\uff0c\u6bd4\u5982\uff1a</p> <pre><code>&lt;bean name=\"teacher\" class=\"com.test.bean.ProgramTeacher\"/&gt;\n&lt;bean name=\"student\" class=\"com.test.bean.Student\"&gt;\n    &lt;property name=\"teacher\" ref=\"teacher\"/&gt;\n&lt;/bean&gt;\n</code></pre> <p>\u50cf\u8fd9\u79cd\u9700\u8981\u5f15\u5165\u5176\u4ed6Bean\u8fdb\u884c\u7684\u6ce8\u5165\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u4f5c\u4e3a\u5f62\u5f0f\u53c2\u6570\u653e\u5230\u65b9\u6cd5\u4e2d\uff1a</p> <pre><code>@Configuration\npublic class MainConfiguration {\n    @Bean\n    public Teacher teacher(){\n        return new Teacher();\n    }\n\n    @Bean\n    public Student student(Teacher teacher){\n        return new Student(teacher);\n    }\n}\n</code></pre> <p>\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u65c1\u8fb9\u5df2\u7ecf\u51fa\u73b0\u56fe\u6807\u4e86\uff1a</p> <p></p> <p>\u8fd0\u884c\u7a0b\u5e8f\u4e4b\u540e\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u6837\u786e\u5b9e\u53ef\u4ee5\u76f4\u63a5\u5f97\u5230\u5bf9\u5e94\u7684Bean\u5e76\u4f7f\u7528\u3002</p> <p>\u53ea\u4e0d\u8fc7\uff0c\u9664\u4e86\u8fd9\u79cd\u57fa\u4e8e\u6784\u9020\u5668\u6216\u662fSetter\u7684\u4f9d\u8d56\u6ce8\u5165\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5230Bean\u5bf9\u5e94\u7684\u7c7b\u4e2d\u4f7f\u7528\u81ea\u52a8\u88c5\u914d\uff1a</p> <pre><code>public class Student {\n    @Autowired   //\u4f7f\u7528\u6b64\u6ce8\u89e3\u6765\u8fdb\u884c\u81ea\u52a8\u88c5\u914d\uff0c\u7531IoC\u5bb9\u5668\u81ea\u52a8\u4e3a\u5176\u8d4b\u503c\n    private Teacher teacher;\n}\n</code></pre> <p>\u73b0\u5728\uff0c\u6211\u4eec\u751a\u81f3\u8fde\u6784\u9020\u65b9\u6cd5\u548cSetter\u90fd\u4e0d\u9700\u8981\u53bb\u7f16\u5199\u4e86\uff0c\u5c31\u80fd\u76f4\u63a5\u5b8c\u6210\u81ea\u52a8\u88c5\u914d\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u6bd4\u90a3\u5806\u914d\u7f6e\u65b9\u4fbf\u591a\u4e86\uff1f</p> <p>\u5f53\u7136\uff0c@Autowired\u5e76\u4e0d\u662f\u53ea\u80fd\u7528\u4e8e\u5b57\u6bb5\uff0c\u5bf9\u4e8e\u6784\u9020\u65b9\u6cd5\u6216\u662fSetter\uff0c\u5b83\u540c\u6837\u53ef\u4ee5\uff1a</p> <pre><code>public class Student {\n    private Teacher teacher;\n\n    @Autowired\n    public void setTeacher(Teacher teacher) {\n        this.teacher = teacher;\n    }\n}\n</code></pre> <p>@Autowired\u9ed8\u8ba4\u91c7\u7528byType\u7684\u65b9\u5f0f\u8fdb\u884c\u81ea\u52a8\u88c5\u914d\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f1a\u4f7f\u7528\u7c7b\u578b\u8fdb\u884c\u914d\uff0c\u90a3\u4e48\u8981\u662f\u51fa\u73b0\u4e86\u591a\u4e2a\u76f8\u540c\u7c7b\u578b\u7684Bean\uff0c\u5982\u679c\u6211\u4eec\u60f3\u8981\u6307\u5b9a\u4f7f\u7528\u5176\u4e2d\u7684\u67d0\u4e00\u4e2a\u8be5\u600e\u4e48\u529e\u5462\uff1f</p> <pre><code>@Bean(\"a\")\npublic Teacher teacherA(){\n    return new Teacher();\n}\n\n@Bean(\"b\")\npublic Teacher teacherB(){\n    return new Teacher();\n}\n</code></pre> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u914d\u5408@Qualifier\u8fdb\u884c\u540d\u79f0\u5339\u914d\uff1a</p> <pre><code>public class Student {\n    @Autowired\n    @Qualifier(\"a\")   //\u5339\u914d\u540d\u79f0\u4e3aa\u7684Teacher\u7c7b\u578b\u7684Bean\n    private Teacher teacher;\n}\n</code></pre> <p>\u8fd8\u6709@PostConstruct\u548c@PreDestroy\uff0c\u5b83\u4eec\u6548\u679c\u548cinit-method\u548cdestroy-method\u662f\u4e00\u6837\u7684\uff1a</p> <pre><code>@PostConstruct\npublic void init(){\n    System.out.println(\"\u6211\u662f\u521d\u59cb\u5316\u65b9\u6cd5\");\n}\n\n@PreDestroy\npublic void destroy(){\n    System.out.println(\"\u6211\u662f\u9500\u6bc1\u65b9\u6cd5\");\n}\n</code></pre> <p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u4f7f\u7528@Bean\u6765\u6ce8\u518cBean\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u53ea\u662f\u7b80\u5355\u5c06\u4e00\u4e2a\u7c7b\u4f5c\u4e3aBean\u7684\u8bdd\uff0c\u8fd9\u6837\u5199\u8fd8\u662f\u4e0d\u592a\u65b9\u4fbf\uff0c\u56e0\u4e3a\u90fd\u662f\u56fa\u5b9a\u6a21\u5f0f\uff0c\u5c31\u662f\u5355\u7eaf\u7684new\u4e00\u4e2a\u5bf9\u8c61\u51fa\u6765\uff0c\u80fd\u4e0d\u80fd\u50cf\u4e4b\u524d\u4e00\u6837\uff0c\u8ba9\u5bb9\u5668\u81ea\u5df1\u53cd\u5c04\u83b7\u53d6\u6784\u9020\u65b9\u6cd5\u53bb\u751f\u6210\u8fd9\u4e2a\u5bf9\u8c61\u5462\uff1f</p> <p>\u80af\u5b9a\u662f\u53ef\u4ee5\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u9700\u8981\u6ce8\u518c\u4e3aBean\u7684\u7c7b\u4e0a\u6dfb\u52a0<code>@Component</code>\u6ce8\u89e3\u6765\u5c06\u4e00\u4e2a\u7c7b\u8fdb\u884c\u6ce8\u518c\uff08\u73b0\u5728\u6700\u5e38\u7528\u7684\u65b9\u5f0f\uff09\uff0c\u4e0d\u8fc7\u8981\u5b9e\u73b0\u8fd9\u6837\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u81ea\u52a8\u626b\u63cf\u6765\u544a\u8bc9Spring\uff0c\u5b83\u9700\u8981\u5728\u54ea\u4e9b\u5305\u4e2d\u67e5\u627e\u6211\u4eec\u63d0\u4f9b\u7684<code>@Component</code>\u58f0\u660e\u7684Bean\u3002</p> <pre><code>@Component(\"lbwnb\")   //\u540c\u6837\u53ef\u4ee5\u81ea\u5df1\u8d77\u540d\u5b57\npublic class Student {\n\n}\n</code></pre> <p>\u8981\u6ce8\u518c\u8fd9\u4e2a\u7c7b\u7684Bean\uff0c\u53ea\u9700\u8981\u6dfb\u52a0@Component\u5373\u53ef\uff0c\u7136\u540e\u914d\u7f6e\u4e00\u4e0b\u5305\u626b\u63cf\uff1a</p> <pre><code>@Configuration\n@ComponentScan(\"com.test.bean\")   //\u5305\u626b\u63cf\uff0c\u8fd9\u6837Spring\u5c31\u4f1a\u53bb\u626b\u63cf\u5bf9\u5e94\u5305\u4e0b\u6240\u6709\u7684\u7c7b\npublic class MainConfiguration {\n\n}\n</code></pre> <pre><code>@Configuration\n@ComponentScans({\n    @ComponentScan(\"path.to.A\")\n    @ComponentScan(\"path.to.B\")\n})   //\u5305\u626b\u63cf\uff0c\u8fd9\u6837Spring\u5c31\u4f1a\u53bb\u626b\u63cf\u5bf9\u5e94\u5305\u4e0b\u6240\u6709\u7684\u7c7b\npublic class MainConfiguration {\n\n}\n</code></pre> <p>Spring\u5728\u626b\u63cf\u5bf9\u5e94\u5305\u4e0b\u6240\u6709\u7684\u7c7b\u65f6\uff0c\u4f1a\u81ea\u52a8\u5c06\u90a3\u4e9b\u6dfb\u52a0\u4e86@Component\u7684\u7c7b\u6ce8\u518c\u4e3aBean\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u5f88\u65b9\u4fbf\uff1f\u53ea\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u53ea\u9002\u7528\u4e8e\u6211\u4eec\u81ea\u5df1\u7f16\u5199\u7c7b\u7684\u60c5\u51b5\uff0c\u5982\u679c\u662f\u7b2c\u4e09\u65b9\u5305\u63d0\u4f9b\u7684\u7c7b\uff0c\u53ea\u80fd\u4f7f\u7528\u524d\u8005\u5b8c\u6210\u6ce8\u518c\uff0c\u5e76\u4e14\u8fd9\u79cd\u65b9\u5f0f\u5e76\u4e0d\u662f\u90a3\u4e48\u7684\u7075\u6d3b\u3002</p> <p>\u4e0d\u8fc7\uff0c\u65e0\u8bba\u662f\u901a\u8fc7@Bean\u8fd8\u662f@Component\u5f62\u5f0f\u6ce8\u518c\u7684Bean\uff0cSpring\u90fd\u4f1a\u4e3a\u5176\u6dfb\u52a0\u4e00\u4e2a\u9ed8\u8ba4\u7684name\u5c5e\u6027\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@Component\npublic class Student {\n}\n</code></pre> <p>\u5b83\u7684\u9ed8\u8ba4\u540d\u79f0\u751f\u4ea7\u89c4\u5219\u4f9d\u7136\u662f\u7c7b\u540d\u5e76\u6309\u7167\u9996\u5b57\u6bcd\u5c0f\u5199\u7684\u9a7c\u5cf0\u547d\u540d\u6cd5\u6765\u7684\uff0c\u6240\u4ee5\u8bf4\u5bf9\u5e94\u7684\u5c31\u662fstudent\uff1a</p> <pre><code>Student student = (Student) context.getBean(\"student\");   //\u8fd9\u6837\u540c\u6837\u53ef\u4ee5\u83b7\u53d6\u5230\nSystem.out.println(student);\n</code></pre> <p>\u540c\u6837\u7684\uff0c\u5982\u679c\u662f\u901a\u8fc7@Bean\u6ce8\u518c\u7684\uff0c\u9ed8\u8ba4\u540d\u79f0\u662f\u5bf9\u5e94\u7684\u65b9\u6cd5\u540d\u79f0\uff1a</p> <pre><code>@Bean\npublic Student artStudent(){\n    return new Student();\n}\n</code></pre> <pre><code>Student student = (Student) context.getBean(\"artStudent\");\nSystem.out.println(student);\n</code></pre> <p>\u76f8\u6bd4\u4f20\u7edf\u7684XML\u914d\u7f6e\u65b9\u5f0f\uff0c\u6ce8\u89e3\u5f62\u5f0f\u7684\u914d\u7f6e\u786e\u5b9e\u80fd\u591f\u51cf\u5c11\u6211\u4eec\u5f88\u591a\u5de5\u4f5c\u91cf\u3002\u5e76\u4e14\uff0c\u5bf9\u4e8e\u8fd9\u79cd\u4f7f\u7528<code>@Component</code>\u6ce8\u518c\u7684Bean\uff0c\u5982\u679c\u5176\u6784\u9020\u65b9\u6cd5\u4e0d\u662f\u9ed8\u8ba4\u65e0\u53c2\u6784\u9020\uff0c\u90a3\u4e48\u9ed8\u8ba4\u4f1a\u5bf9\u5176\u6bcf\u4e00\u4e2a\u53c2\u6570\u90fd\u8fdb\u884c\u81ea\u52a8\u6ce8\u5165\uff1a</p> <pre><code>@Component\npublic class Student {\n    Teacher teacher;\n    public Student(Teacher teacher){   //\u5982\u679c\u6709Teacher\u7c7b\u578b\u7684Bean\uff0c\u90a3\u4e48\u8fd9\u91cc\u7684\u53c2\u6570\u4f1a\u88ab\u81ea\u52a8\u6ce8\u5165\n        this.teacher = teacher;\n    }\n}\n</code></pre> <p>\u6700\u540e\uff0c\u5bf9\u4e8e\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u5de5\u5382\u6a21\u5f0f\uff0cSpring\u4e5f\u63d0\u4f9b\u4e86\u63a5\u53e3\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5b9e\u73b0\u63a5\u53e3\u8868\u793a\u8fd9\u4e2aBean\u662f\u4e00\u4e2a\u5de5\u5382Bean\uff1a</p> <pre><code>@Component\npublic class StudentFactory implements FactoryBean&lt;Student&gt; {\n    @Override\n    public Student getObject() {   //\u751f\u4ea7\u7684Bean\u5bf9\u8c61\n        return new Student();\n    }\n\n    @Override\n    public Class&lt;?&gt; getObjectType() {   //\u751f\u4ea7\u7684Bean\u7c7b\u578b\n        return Student.class;\n    }\n\n    @Override\n    public boolean isSingleton() {   //\u751f\u4ea7\u7684Bean\u662f\u5426\u91c7\u7528\u5355\u4f8b\u6a21\u5f0f\n        return false;\n    }\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\u8ddf\u6211\u4eec\u4e4b\u524d\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u7f16\u5199\u662f\u4e00\u6837\u7684\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u8bf4\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#todo","title":"\u9ad8\u7ea7\u7528\u6cd5 TODO","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#spel","title":"SpEL\u8868\u8fbe\u5f0f","text":"<p>SSM\u7b14\u8bb0\uff08\u4e00\uff09Spring\u57fa\u7840#SpringEL\u8868\u8fbe\u5f0f</p> <p>Spring Expression Language (SpEL) \u662f\u4e00\u79cd\u5f3a\u5927\u7684\u8868\u8fbe\u5f0f\u8bed\u8a00\uff0c\u7528\u4e8e\u5728 Spring \u6846\u67b6\u4e2d\u5904\u7406\u548c\u8bc4\u4f30\u8868\u8fbe\u5f0f\u3002SpEL \u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u8ba1\u7b97\u8868\u8fbe\u5f0f\uff0c\u5e76\u5c06\u5176\u5e94\u7528\u4e8e Spring \u5e94\u7528\u7a0b\u5e8f\u7684\u4e0d\u540c\u65b9\u9762\uff0c\u4f8b\u5982\u5c5e\u6027\u6ce8\u5165\u3001XML \u914d\u7f6e\u3001\u6ce8\u89e3\u3001AOP \u7b49\u3002</p> <p>SpEL\u7684\u4f5c\u7528\u5305\u62ec\uff1a</p> <ol> <li> <p>\u5c5e\u6027\u503c\u7684\u5f15\u7528\uff1aSpEL\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u4e8eJavaScript\u6216Python\u7684\u70b9\u53f7\u8bed\u6cd5\u6765\u5f15\u7528\u5bf9\u8c61\u7684\u5c5e\u6027\u3002\u8fd9\u5141\u8bb8\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u52a8\u6001\u5f15\u7528\u5c5e\u6027\u503c\u3002</p> </li> <li> <p>\u65b9\u6cd5\u8c03\u7528\uff1aSpEL\u53ef\u4ee5\u8c03\u7528\u5bf9\u8c61\u7684\u65b9\u6cd5\uff0c\u5305\u62ec\u9759\u6001\u65b9\u6cd5\u548c\u5b9e\u4f8b\u65b9\u6cd5\u3002</p> </li> <li> <p>\u7b97\u672f\u548c\u903b\u8f91\u8fd0\u7b97\uff1aSpEL\u652f\u6301\u5404\u79cd\u7b97\u672f\u548c\u903b\u8f91\u8fd0\u7b97\u7b26\uff0c\u4f8b\u5982\u52a0\u6cd5\u3001\u51cf\u6cd5\u3001\u4e58\u6cd5\u3001\u9664\u6cd5\u3001\u53d6\u6a21\u3001\u903b\u8f91\u4e0e\u3001\u903b\u8f91\u6216\u7b49\u3002</p> </li> <li> <p>\u6761\u4ef6\u5224\u65ad\u548c\u4e09\u5143\u8fd0\u7b97\u7b26\uff1aSpEL\u53ef\u4ee5\u4f7f\u7528\u6761\u4ef6\u5224\u65ad\u8bed\u53e5\uff0c\u4f8b\u5982if-else\u8bed\u53e5\u548c\u4e09\u5143\u8fd0\u7b97\u7b26\u3002</p> </li> <li> <p>\u96c6\u5408\u548c\u6570\u7ec4\u7684\u64cd\u4f5c\uff1aSpEL\u53ef\u4ee5\u5bf9\u96c6\u5408\u548c\u6570\u7ec4\u8fdb\u884c\u64cd\u4f5c\uff0c\u4f8b\u5982\u83b7\u53d6\u96c6\u5408\u7684\u957f\u5ea6\u3001\u83b7\u53d6\u6570\u7ec4\u7684\u5143\u7d20\u7b49\u3002</p> </li> <li> <p>\u7c7b\u578b\u8f6c\u6362\uff1aSpEL\u53ef\u4ee5\u5728\u8868\u8fbe\u5f0f\u4e2d\u6267\u884c\u7c7b\u578b\u8f6c\u6362\uff0c\u4f8b\u5982\u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u6570\u5b57\u3001\u5c06\u5bf9\u8c61\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u7b49\u3002</p> </li> <li> <p>\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff1aSpEL\u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u8fdb\u884c\u6a21\u5f0f\u5339\u914d\u3002</p> </li> <li> <p>Bean\u5f15\u7528\u548c\u5c5e\u6027\u8d4b\u503c\uff1aSpEL\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u5f15\u7528\u548c\u64cd\u4f5cSpring\u5bb9\u5668\u4e2d\u7684Bean\uff0c\u5305\u62ec\u83b7\u53d6Bean\u7684\u5c5e\u6027\u503c\u548c\u7ed9Bean\u7684\u5c5e\u6027\u8d4b\u503c\u3002</p> </li> </ol> <p>SpEL \u652f\u6301\u4e00\u7cfb\u5217\u8868\u8fbe\u5f0f\u64cd\u4f5c\u7b26\u548c\u51fd\u6570\uff0c\u53ef\u4ee5\u7528\u4e8e\u8bbf\u95ee\u5bf9\u8c61\u5c5e\u6027\u3001\u8c03\u7528\u65b9\u6cd5\u3001\u8fdb\u884c\u6570\u5b66\u8ba1\u7b97\u3001\u903b\u8f91\u5224\u65ad\u7b49\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684 SpEL \u8868\u8fbe\u5f0f\u793a\u4f8b\uff1a</p> <ol> <li> <p>\u8bbf\u95ee\u5bf9\u8c61\u5c5e\u6027\uff1a</p> <pre><code>#{person.name}  // \u83b7\u53d6 person \u5bf9\u8c61\u7684 name \u5c5e\u6027\n#{person.address.city}  // \u83b7\u53d6 person \u5bf9\u8c61\u7684 address \u5c5e\u6027\u7684 city \u5c5e\u6027\n</code></pre> </li> <li> <p>\u8c03\u7528\u5bf9\u8c61\u65b9\u6cd5\uff1a</p> <pre><code>#{person.getName()}  // \u8c03\u7528 person \u5bf9\u8c61\u7684 getName() \u65b9\u6cd5\n#{person.getAddress().getCity()}  // \u8c03\u7528 person \u5bf9\u8c61\u7684 getAddress() \u65b9\u6cd5\u7684 getCity() \u65b9\u6cd5\n</code></pre> </li> <li> <p>\u6570\u5b66\u8ba1\u7b97\uff1a</p> <pre><code>#{2 + 3}  // \u52a0\u6cd5\n#{10 - 5}  // \u51cf\u6cd5\n#{2 * 4}  // \u4e58\u6cd5\n#{10 / 2}  // \u9664\u6cd5\n</code></pre> </li> <li> <p>\u903b\u8f91\u5224\u65ad\uff1a</p> <pre><code>#{age &gt; 18}  // \u5224\u65ad age \u662f\u5426\u5927\u4e8e 18\n#{person.age &gt;= 20 &amp;&amp; person.age &lt;= 30}  // \u5224\u65ad person.age \u662f\u5426\u5728 20 \u5230 30 \u4e4b\u95f4\n</code></pre> </li> <li> <p>\u6761\u4ef6\u8868\u8fbe\u5f0f\uff1a</p> <pre><code>#{person.age &gt; 18 ? '\u6210\u5e74' : '\u672a\u6210\u5e74'}  // \u5224\u65ad person.age \u662f\u5426\u5927\u4e8e 18\uff0c\u8fd4\u56de\u4e0d\u540c\u7684\u6587\u672c\n</code></pre> </li> </ol> <p>\u4ee5\u4e0a\u53ea\u662f\u4e00\u4e9b SpEL \u8868\u8fbe\u5f0f\u7684\u793a\u4f8b\uff0cSpEL \u8fd8\u63d0\u4f9b\u4e86\u66f4\u591a\u529f\u80fd\u548c\u8bed\u6cd5\uff0c\u7528\u4e8e\u5904\u7406\u66f4\u590d\u6742\u7684\u8868\u8fbe\u5f0f\u548c\u903b\u8f91\u3002\u5728 Spring \u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u53ef\u4ee5\u5728 XML \u914d\u7f6e\u6587\u4ef6\u3001\u6ce8\u89e3\u4e2d\u6216\u901a\u8fc7\u7f16\u7a0b\u65b9\u5f0f\u4f7f\u7528 SpEL \u8868\u8fbe\u5f0f\u3002</p> <p>\u4f7f\u7528Spring\u7684SpEL\u7684\u4e00\u4e9b\u5e38\u89c1\u7528\u6cd5\uff1a</p> <ol> <li>\u8bc4\u4f30\u7b80\u5355\u8868\u8fbe\u5f0f\uff1a SpEL\u53ef\u4ee5\u7528\u6765\u8bc4\u4f30\u7b80\u5355\u7684\u8868\u8fbe\u5f0f\uff0c\u4f8b\u5982\u7b97\u672f\u8868\u8fbe\u5f0f\u3001\u5b57\u7b26\u4e32\u62fc\u63a5\u7b49\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528SpEL\u7684\u89e3\u6790\u5668\u6765\u8bc4\u4f30\u8fd9\u4e9b\u8868\u8fbe\u5f0f\u3002</li> </ol> <pre><code>ExpressionParser parser = new SpelExpressionParser();\nExpression expression = parser.parseExpression(\"2 + 3\");\nint sum = (Integer) expression.getValue();\nSystem.out.println(sum); // \u8f93\u51fa\uff1a5\n\nexpression = parser.parseExpression(\"'Hello' + ' World'\");\nString message = (String) expression.getValue();\nSystem.out.println(message); // \u8f93\u51fa\uff1aHello World\n</code></pre> <ol> <li>\u8bbf\u95ee\u5bf9\u8c61\u5c5e\u6027\uff1a SpEL\u53ef\u4ee5\u8bbf\u95eeJava\u5bf9\u8c61\u7684\u5c5e\u6027\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\".\"\u64cd\u4f5c\u7b26\u6765\u8bbf\u95ee\u5bf9\u8c61\u7684\u5c5e\u6027\u3002</li> </ol> <pre><code>public class Person {\n    private String name;\n    // getters and setters...\n}\n\nPerson person = new Person();\nperson.setName(\"John\");\n\nExpressionParser parser = new SpelExpressionParser();\nExpression expression = parser.parseExpression(\"name\");\nString name = (String) expression.getValue(person);\nSystem.out.println(name); // \u8f93\u51fa\uff1aJohn\n</code></pre> <ol> <li>\u8c03\u7528\u5bf9\u8c61\u65b9\u6cd5\uff1a SpEL\u53ef\u4ee5\u8c03\u7528Java\u5bf9\u8c61\u7684\u65b9\u6cd5\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\".\"\u64cd\u4f5c\u7b26\u6765\u8c03\u7528\u5bf9\u8c61\u7684\u65b9\u6cd5\u3002</li> </ol> <pre><code>public class Calculator {\n    public int add(int a, int b) {\n        return a + b;\n    }\n}\n\nCalculator calculator = new Calculator();\n\nExpressionParser parser = new SpelExpressionParser();\nExpression expression = parser.parseExpression(\"add(2, 3)\");\nint sum = (Integer) expression.getValue(calculator);\nSystem.out.println(sum); // \u8f93\u51fa\uff1a5\n</code></pre> <ol> <li>\u4f7f\u7528\u6761\u4ef6\u548c\u903b\u8f91\u8fd0\u7b97\u7b26\uff1a SpEL\u652f\u6301\u6761\u4ef6\u548c\u903b\u8f91\u8fd0\u7b97\u7b26\uff0c\u53ef\u4ee5\u7528\u4e8e\u6761\u4ef6\u5224\u65ad\u548c\u903b\u8f91\u64cd\u4f5c\u3002</li> </ol> <pre><code>ExpressionParser parser = new SpelExpressionParser();\nExpression expression = parser.parseExpression(\"age &gt; 18 &amp;&amp; gender == 'male'\");\nboolean result = (Boolean) expression.getValue(person);\nSystem.out.println(result); // \u8f93\u51fa\uff1atrue\n</code></pre> <ol> <li>\u4f7f\u7528\u96c6\u5408\u64cd\u4f5c\u7b26\uff1a SpEL\u652f\u6301\u96c6\u5408\u64cd\u4f5c\u7b26\uff0c\u53ef\u4ee5\u7528\u4e8e\u5bf9\u96c6\u5408\u6216\u6570\u7ec4\u8fdb\u884c\u8fc7\u6ee4\u3001\u6620\u5c04\u548c\u6295\u5f71\u7b49\u64cd\u4f5c\u3002</li> </ol> <pre><code>// \u5047\u8bbe\u6709\u4e00\u4e2a\u5305\u542bPerson\u5bf9\u8c61\u7684List\nList&lt;Person&gt; people = new ArrayList&lt;&gt;();\npeople.add(new Person(\"John\", 25));\npeople.add(new Person(\"Alice\", 30));\npeople.add(new Person(\"Bob\", 35));\n\nExpressionParser parser = new SpelExpressionParser();\nExpression expression = parser.parseExpression(\"name.toUpperCase()\");\nList&lt;String&gt; names = (List&lt;String&gt;) expression.getValue(people);\nSystem.out.println(names); // \u8f93\u51fa\uff1a[JOHN, ALICE, BOB]\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/spring/#junit","title":"\u96c6\u6210JUnit\u6d4b\u8bd5","text":"<p>pom.xml</p> <pre><code>        &lt;dependency&gt;\n            &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;\n            &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;\n            &lt;version&gt;5.9.3&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-test&lt;/artifactId&gt;\n            &lt;version&gt;6.0.11&lt;/version&gt;\n        &lt;/dependency&gt;\n</code></pre> <p>test/java/MainTest.java</p> <pre><code>@ExtendWith(SpringExtension.class)\n@ContextConfiguration(classes = MainConfiguration.class)\npublic class MainTest {\n\n    @Autowired\n    TestService service;\n\n    @Test\n    public void test() {\n        service.test();\n        System.out.println(\"\u6211\u662f\u6d4b\u8bd5\");\n    }\n\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/Spring/%E5%9B%BE%E4%B9%A6%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/","title":"\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf","text":"<p>pom.xml</p> <pre><code>&lt;dependency&gt;  \n    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;  \n    &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;  \n    &lt;version&gt;1.7.33&lt;/version&gt;  \n&lt;/dependency&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;  \n    &lt;artifactId&gt;slf4j-jdk14&lt;/artifactId&gt;  \n    &lt;version&gt;1.7.33&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-context&lt;/artifactId&gt;  \n    &lt;version&gt;6.0.10&lt;/version&gt;  \n&lt;/dependency&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;  \n    &lt;version&gt;6.0.10&lt;/version&gt;  \n&lt;/dependency&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-security-web&lt;/artifactId&gt;  \n    &lt;version&gt;6.1.1&lt;/version&gt;  \n&lt;/dependency&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-security-config&lt;/artifactId&gt;  \n    &lt;version&gt;6.1.1&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;  \n    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;  \n    &lt;version&gt;3.5.13&lt;/version&gt;  \n&lt;/dependency&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;com.mysql&lt;/groupId&gt;  \n    &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;  \n    &lt;version&gt;8.0.33&lt;/version&gt;  \n&lt;/dependency&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;  \n    &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;  \n    &lt;version&gt;3.0.2&lt;/version&gt;  \n&lt;/dependency&gt;  \n&lt;dependency&gt;  \n    &lt;groupId&gt;org.springframework&lt;/groupId&gt;  \n    &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;  \n    &lt;version&gt;6.0.10&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;  \n    &lt;artifactId&gt;lombok&lt;/artifactId&gt;  \n    &lt;version&gt;1.18.28&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;org.thymeleaf&lt;/groupId&gt;  \n    &lt;artifactId&gt;thymeleaf-spring6&lt;/artifactId&gt;  \n    &lt;version&gt;3.1.1.RELEASE&lt;/version&gt;  \n&lt;/dependency&gt;  \n\n&lt;dependency&gt;  \n    &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt;  \n    &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt;  \n    &lt;version&gt;2.1.1&lt;/version&gt;  \n&lt;/dependency&gt;\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/","title":"SpringBoot","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/#_1","title":"\u7f51\u7edc\u8bf7\u6c42","text":"<p>\u5728Spring Boot\u4e2d\uff0c<code>@RestController</code> \u548c <code>@Controller</code> \u6ce8\u89e3\u7684\u533a\u522b\u5728\u4e8e\u5b83\u4eec\u5904\u7406 HTTP \u8bf7\u6c42\u7684\u65b9\u5f0f\u4e0d\u540c\u3002</p> <p><code>@RestController</code> \u4f1a\u5c06\u5904\u7406\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u76f4\u63a5\u8f6c\u6362\u6210 JSON \u6216 XML \u683c\u5f0f\uff0c\u5e76\u5c06\u5176\u54cd\u5e94\u7ed9\u5ba2\u6237\u7aef\u3002\u8fd9\u610f\u5473\u7740\u5f53\u4f60\u4f7f\u7528 <code>@RestController</code> \u6ce8\u89e3\u65f6\uff0c\u4f60\u4e0d\u9700\u8981\u6bcf\u4e2a\u65b9\u6cd5\u4e0a\u90fd\u52a0\u4e0a <code>@ResponseBody</code> \u6ce8\u89e3\u3002</p> <p>\u4f8b\u5982\uff0c\u5f53\u4f60\u4f7f\u7528 <code>@RestController</code> \u6ce8\u89e3\u65f6\uff0c\u4e00\u4e2a\u5904\u7406 GET \u8bf7\u6c42\u7684\u65b9\u6cd5\u53ef\u4ee5\u8fd9\u6837\u5199\uff1a</p> <pre><code>@RestController\npublic class MyRestController {\n\n    @GetMapping(\"/hello\")\n    public String sayHello() {\n        return \"Hello World!\";\n    }\n}\n</code></pre> <p>\u7136\u800c\uff0c\u5982\u679c\u4f60\u4f7f\u7528 <code>@Controller</code> \u6ce8\u89e3\uff0c\u4f60\u9700\u8981\u4f7f\u7528 <code>@ResponseBody</code> \u6ce8\u89e3\u6765\u544a\u8bc9 Spring MVC \u5c06\u5904\u7406\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u8f6c\u6362\u6210 JSON \u6216 XML \u683c\u5f0f\u3002</p> <p>\u4f8b\u5982\uff0c\u5f53\u4f60\u4f7f\u7528 <code>@Controller</code> \u6ce8\u89e3\u65f6\uff0c\u4e00\u4e2a\u5904\u7406 GET \u8bf7\u6c42\u7684\u65b9\u6cd5\u53ef\u4ee5\u8fd9\u6837\u5199\uff1a</p> <pre><code>@Controller\npublic class MyController {\n\n    @GetMapping(\"/hello\")\n    @ResponseBody\n    public String sayHello() {\n        return \"Hello World!\";\n    }\n}\n</code></pre> <p>\u5176\u4ed6\u5199\u6cd5</p> <pre><code>@Controller\n@RequestMapping(\"/user\")\npublic class UserController {\n\n    @GetMapping(\"/list\")\n    public String listUsers() {\n    }\n\n    @GetMapping(\"/details\")\n    public String userDetails() {\n    }\n}\n\n\u8fd9\u6837listUsers()\u65b9\u6cd5\u5c31\u53ea\u4f1a\u62e6\u622a\u5230/user/list\u8def\u5f84\u4e0b\u7684GET\u8bf7\u6c42\uff0cuserDetails()\u65b9\u6cd5\u5c31\u53ea\u4f1a\u62e6\u622a\u5230/user/details\u8def\u5f84\u4e0b\u7684GET\u8bf7\u6c42\u3002\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/#get","title":"GET\u8bf7\u6c42","text":"<pre><code>@CrossOrigin\n@RestController\npublic class HelloController {\n    @GetMapping (\"/hello\")\n    public String hello(@RequestParam(value = \"name\") String name) { // value -&gt; \u524d\u7aef\u53d1\u9001\u7684\u8868\u5355\u6570\u636e\n        return String.format(\"Hello %s!\",name);\n    }\n}\n</code></pre> <pre><code>@CrossOrigin // \u5904\u7406\u8de8\u57df\u95ee\u9898\n@RestController\npublic class UserController {\n\n    @Autowired\n    UserService userService;\n\n    @GetMapping(value = \"/{id}\") //\u4ece\u8def\u5f84\u83b7\u53d6\u503c\n    public ResponseVo&lt;User&gt; getUserById(@PathVariable int id) { // \u6b64\u5904\u7684 User \u5fc5\u987b\u6709getter\u548csetter\u65b9\u6cd5\n        User user = userService.getUserById(id);\n        System.out.println(user);\n        if (user != null) {\n            System.out.println(\"Success\");\n            return ResponseVo.success(user); // springboot \u81ea\u5e26\u7684 jackjson \u4f1a\u5c06\u81ea\u52a8\u5176\u8f6c\u5316\u4e3ajson\u6570\u636e\n        } else {\n            System.out.println(\"Failed\");\n\n            return ResponseVo.failure();\n        }\n    }\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/#post","title":"POST\u8bf7\u6c42","text":"<pre><code>@CrossOrigin\n@RestController\npublic class HelloController {\n    @PostMapping (\"/hello\")\n    public String hello(@RequestBody String name) { // springboot\u4f1a\u5bf9\u4f20\u5165\u7684\u6570\u636e\u8fdb\u884c\u89e3\u6790\n        return String.format(\"Hello %s!\",name);\n    }\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/#mabatis-plus","title":"Mabatis Plus","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/#_2","title":"\u57fa\u672c\u4f7f\u7528","text":"<p>\u6dfb\u52a0\u4f9d\u8d56</p> <pre><code>&lt;dependency&gt;\n     &lt;groupId&gt;com.baomidou&lt;/groupId&gt;\n     &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;\n     &lt;version&gt;3.5.3.1&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n     &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n     &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n     &lt;version&gt;8.0.33&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u914d\u7f6e\u6570\u636e\u6e90</p> <pre><code>spring:\n  datasource:\n    url: jdbc:mysql://localhost:3306/test\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.cj.jdbc.Driver\n</code></pre> <p>entity/User.java</p> <pre><code>@Data  \n@TableName(\"user\")  \npublic class User {  \n    @TableId(type = IdType.AUTO)  \n    int id;  \n    @TableField(\"name\")  \n    String name;  \n    @TableField(\"email\")  \n    String email;  \n    @TableField(\"password\")  \n    String password;  \n}\n</code></pre> <p>mapper/UserMapper.java</p> <pre><code>@Mapper\npublic interface UserMapper extends BaseMapper&lt;User&gt; { // BaseMapper \u662f Mybatis-plus \u4e2d\u7684\n    // \u4e0d\u9700\u8981\u5199\u4efb\u4f55\u65b9\u6cd5\uff0cMyBatis-Plus \u4f1a\u81ea\u52a8\u521b\u5efa\u57fa\u672c\u7684 CRUD \u64cd\u4f5c\n}\n</code></pre> <p>MySpringBootApplicationTests.java</p> <pre><code>@SpringBootTest  \nclass MySpringBootApplicationTests {  \n    @Resource  \n    UserMapper mapper;  \n\n\n    @Test  \n    void contextLoad() {  \n        User user = new User();  \n        user.setEmail(\"123123\");  \n        user.setName(\"asdfasdf\");  \n        mapper.insert(user);  \n    }  \n\n\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/#_3","title":"\u6761\u4ef6\u6784\u9020\u5668","text":"<p>\u6761\u4ef6\u6784\u9020\u5668 | MyBatis-Plus</p> <p>\u6761\u4ef6\u6784\u9020\u5668</p> <pre><code>@Test\nvoid contextLoads() {\n    QueryWrapper&lt;User&gt; wrapper = new QueryWrapper&lt;&gt;();    //\u590d\u6742\u67e5\u8be2\u53ef\u4ee5\u4f7f\u7528QueryWrapper\u6765\u5b8c\u6210\n    wrapper\n            .select(\"id\", \"name\", \"email\", \"password\")    //\u53ef\u4ee5\u81ea\u5b9a\u4e49\u9009\u62e9\u54ea\u4e9b\u5b57\u6bb5\n            .ge(\"id\", 2)                //\u9009\u62e9\u5224\u65adid\u5927\u4e8e\u7b49\u4e8e1\u7684\u6240\u6709\u6570\u636e\n            .orderByDesc(\"id\");   //\u6839\u636eid\u5b57\u6bb5\u8fdb\u884c\u964d\u5e8f\u6392\u5e8f\n    System.out.println(mapper.selectList(wrapper));   //Mapper\u540c\u6837\u652f\u6301\u4f7f\u7528QueryWrapper\u8fdb\u884c\u67e5\u8be2\n}\n</code></pre> <p>\u901a\u8fc7\u4f7f\u7528\u4e0a\u9762\u7684QueryWrapper\u5bf9\u8c61\u8fdb\u884c\u67e5\u8be2\uff0c\u4e5f\u5c31\u7b49\u4ef7\u4e8e\u4e0b\u9762\u7684SQL\u8bed\u53e5\uff1a</p> <pre><code>select id,name,email,password from user where id &gt;= 2 order by id desc\n</code></pre> <p>\u6709\u4e9b\u65f6\u5019\u6211\u4eec\u9047\u5230\u9700\u8981\u6279\u5904\u7406\u7684\u60c5\u51b5\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6279\u5904\u7406\u64cd\u4f5c\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    //\u652f\u6301\u6279\u5904\u7406\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u4e00\u6b21\u6027\u5220\u9664\u591a\u4e2a\u6307\u5b9aID\u7684\u7528\u6237\n    int count = mapper.deleteBatchIds(List.of(1, 3));\n    System.out.println(count);\n}\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5feb\u901f\u8fdb\u884c\u5206\u9875\u67e5\u8be2\u64cd\u4f5c\uff0c\u4e0d\u8fc7\u5728\u6267\u884c\u524d\u6211\u4eec\u9700\u8981\u5148\u914d\u7f6e\u4e00\u4e0b\uff1a</p> <pre><code>@Configuration\npublic class MybatisConfiguration {\n    @Bean\n    public MybatisPlusInterceptor paginationInterceptor() {\n        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();\n        //\u6dfb\u52a0\u5206\u9875\u62e6\u622a\u5668\u5230MybatisPlusInterceptor\u4e2d\n        interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));\n        return interceptor;\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u4f7f\u7528\u5206\u9875\u529f\u80fd\u4e86\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    //\u8fd9\u91cc\u6211\u4eec\u5c06\u7528\u6237\u8868\u52062\u9875\uff0c\u5e76\u83b7\u53d6\u7b2c\u4e00\u9875\u7684\u6570\u636e\n    Page&lt;User&gt; page = mapper.selectPage(Page.of(1, 2), Wrappers.emptyWrapper());\n    System.out.println(page.getRecords());   //\u83b7\u53d6\u5206\u9875\u4e4b\u540e\u7684\u6570\u636e\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/#_4","title":"\u4ee3\u7801\u751f\u6210","text":"<pre><code>&lt;!--- Mybatis plus \u7684\u4f9d\u8d56\uff0c \u4ee5\u53ca\u4ee5\u4e0b\u7684\u4f9d\u8d56--&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;\n    &lt;version&gt;3.5.3.1&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;  \n    &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;  \n    &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt;  \n    &lt;version&gt;2.3&lt;/version&gt;  \n&lt;/dependency&gt;\n</code></pre> <pre><code>import javax.sql.DataSource;  \n\n@SpringBootTest  \nclass TestApplicationTests {  \n    @Autowired  \n    DataSource dataSource;  \n\n    @Test  \n    void contextLoads() {  \n        FastAutoGenerator  \n                //\u9996\u5148\u4f7f\u7528create\u6765\u914d\u7f6e\u6570\u636e\u5e93\u94fe\u63a5\u4fe1\u606f  \n                .create(new DataSourceConfig.Builder(dataSource))  \n                .globalConfig(builder -&gt; {  \n                    builder.author(\"Piako\");  \n                    builder.commentDate(\"2023-09-24\");  \n                    builder.outputDir(\"src/main/java\");  \n                })  \n                .packageConfig(builder -&gt;  \n                    builder.parent(\"com.example.test\")  \n                )                .strategyConfig(builder -&gt; {  \n                    builder.mapperBuilder()  \n                            .mapperAnnotation(Mapper.class)  // \u9700\u8981\u5bfc\u5165ibatis\u7684\u5305\n                            .build();  \n                })  \n                .execute();  \n    }  \n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/#_5","title":"\u524d\u540e\u7aef\u5206\u79bb","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot/#_6","title":"\u8fd4\u56de\u54cd\u5e94\u6570\u636e","text":"<p>\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u6765\u88c5\u8f7d\u54cd\u5e94\u6570\u636e:</p> <pre><code>public class RestBean&lt;T&gt; {  \n    int code;  \n    T data;  \n    String message;  \n\n    private RestBean(int code, T data,String message) {  \n        this.code = code;  \n        this.data = data;  \n        this.message = message;  \n    }  \n\n    public static &lt;T&gt; RestBean&lt;T&gt; success(T data) {  \n        return new RestBean&lt;&gt;(200,data,\"\u83b7\u53d6\u6210\u529f\");  \n    }  \n\n\n    public static &lt;T&gt; RestBean&lt;T&gt; failure(int code, String message) {  \n        return new RestBean&lt;&gt;(code,null,message);  \n    }  \n\n    public String asJsonString() {  \n        return JSONObject  \n                .from(this, JSONWriter.Feature.WriteNulls)  \n                .toString();  \n    }  \n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/","title":"SpringBoot\u7b14\u8bb0\uff08\u4e00\uff09\u6838\u5fc3\u5185\u5bb9","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#springboot","title":"\u8d70\u8fdbSpringBoot\u4e00\u7ad9\u5f0f\u5f00\u53d1","text":"<p>\u524d\u7f6e\u8bfe\u7a0b\uff1a\u300aSpring6\u6838\u5fc3\u5185\u5bb9\u300b\u300aSpringMvc6\u300b\u300aSpringSecurity6\u300b\u300aJava-9-17\u65b0\u7279\u6027\u7bc7\u300b</p> <p>\u63d0\u9192\uff1a\u6709\u4e9b\u5c0f\u4f19\u4f34\u597d\u5947\u80fd\u4e0d\u80fd\u4e0d\u5b66SSM\u76f4\u63a5SpringBoot\uff0c\u8fd9\u91cc\u58f0\u660e\u4e00\u4e0b\uff0cSpringBoot\u53ea\u662f\u7528\u4e8e\u5feb\u901f\u521b\u5efaSSM\u9879\u76ee\u7684\u811a\u624b\u67b6\uff0c\u5c31\u50cf\u662f\u4e2a\u5916\u58f3\u4e00\u6837\uff0c\u79bb\u5f00\u4e86SSM\u6838\u5fc3\u5185\u5bb9\u5c31\u662f\u4e2a\u7a7a\u58f3\uff0c\u4e0d\u8981\u672c\u672b\u5012\u7f6e\u4e86\u3002</p> <p>Spring Boot\u8ba9\u60a8\u53ef\u4ee5\u8f7b\u677e\u5730\u521b\u5efa\u72ec\u7acb\u7684\u3001\u751f\u4ea7\u7ea7\u522b\u7684Spring\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u201c\u76f4\u63a5\u8fd0\u884c\u201d\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u3002SpringBoot\u4e3a\u5927\u91cf\u7684\u7b2c\u4e09\u65b9\u5e93\u6dfb\u52a0\u4e86\u652f\u6301\uff0c\u80fd\u591f\u505a\u5230\u5f00\u7bb1\u5373\u7528\uff0c\u7b80\u5316\u5927\u91cf\u7e41\u7410\u914d\u7f6e\uff0c\u7528\u6700\u5c11\u7684\u914d\u7f6e\u5feb\u901f\u6784\u5efa\u4f60\u60f3\u8981\u7684\u9879\u76ee\u3002\u57282023\u5e74\uff0cSpringBoot\u8fce\u6765\u4e86\u5b83\u7684\u7b2c\u4e09\u4e2a\u5927\u7248\u672c\uff0c\u968f\u7740SpringBoot 3\u7684\u6b63\u5f0f\u53d1\u5e03\uff0c\u6574\u4e2a\u751f\u6001\u4e5f\u8fce\u6765\u4e86\u4e00\u6b21\u91cd\u5927\u9769\u65b0\u3002</p> <p>\u76ee\u524d\u7684\u6700\u65b0\u7248\u672c\u4ee5\u53ca\u5bf9\u5e94\u7684\u7ef4\u62a4\u60c5\u51b5\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u66fe\u7ecf\u7684SpringBoot 2.5\u7248\u672c\u5c06\u4f1a\u57282023\u5e748\u6708\u5e95\u7ec8\u6b62\u5546\u4e1a\u652f\u6301\uff0c\u5c4a\u65f6\u5c06\u4e0d\u4f1a\u518d\u5bf9\u8fd9\u7c7b\u65e7\u7248\u672c\u8fdb\u884c\u4efb\u4f55\u7ef4\u62a4\uff0c\u56e0\u6b64\uff0c\u5c06\u6211\u4eec\u7684\u8001\u7248\u672cSpringBoot\u9879\u76ee\u8fdb\u884c\u5347\u7ea7\u5df2\u7ecf\u8feb\u5728\u7709\u776b\uff0c\u76ee\u524d\u6700\u5f3a\u76843.1\u6b63\u5f0f\u7248\u4f1a\u7ef4\u62a4\u52302025\u5e74\u4e2d\u65ec\u3002</p> <p>\u57283.X\u4e4b\u540e\u7684\u53d8\u5316\u76f8\u6bd42.X\u53ef\u4ee5\u8bf4\u662f\u76f8\u5f53\u5927\uff0c\u5c24\u5176\u662f\u5176\u751f\u6001\u4e0b\u7684SpringSecurity\u6846\u67b6\uff0c\u65e7\u7248\u672c\u9879\u76ee\u5728\u5347\u7ea7\u4e4b\u540eAPI\u5df2\u7ecf\u5b8c\u5168\u53d1\u751f\u6539\u53d8\uff1b\u4ee5\u53ca\u5185\u7f6eTomcat\u670d\u52a1\u5668\u7684\u5347\u7ea7\uff0cServlet\u4e5f\u5347\u7ea7\u52305\u4ee5\u4e0a\uff0c\u4ece<code>javax</code>\u5168\u65b0\u5347\u7ea7\u5230<code>jakarta</code>\u65b0\u5305\u540d\uff1b\u5305\u62ec\u57283.X\u5f97\u5230\u7684\u5927\u91cf\u65b0\u7279\u6027\uff0c\u5982\u652f\u6301GraalVM\u6253\u5305\u672c\u5730\u955c\u50cf\u8fd0\u884c\u7b49\uff1b\u5e76\u4e14Java\u7248\u672c\u4e5f\u5f3a\u5236\u8981\u6c42\u4e3a17\u7248\u672c\u3002\u8fc1\u79fb\u5230\u65b0\u7248\u672c\u4e0d\u4ec5\u53ef\u4ee5\u4eab\u53d7\u5230\u514d\u8d39\u7ef4\u62a4\u652f\u6301\uff0c\u4e5f\u53ef\u4ee5\u611f\u53d7Java17\u5e26\u6765\u7684\u5168\u65b0\u4f53\u9a8c\u3002</p> <p>\u4ecb\u7ecd\u4e86\u8fd9\u4e48\u591a\uff0c\u6211\u4eec\u9996\u5148\u8fd8\u662f\u6765\u770b\u770bSpringBoot\u529f\u80fd\u6709\u54ea\u4e9b\uff1a</p> <ul> <li>\u80fd\u591f\u521b\u5efa\u72ec\u7acb\u7684Spring\u5e94\u7528\u7a0b\u5e8f</li> <li>\u5185\u5d4cTomcat\u3001Jetty\u6216Undertow\u670d\u52a1\u5668\uff08\u65e0\u9700\u5355\u72ec\u90e8\u7f72WAR\u5305\uff0c\u6253\u5305\u6210Jar\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u53ef\u4ee5\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\uff09</li> <li>\u63d0\u4f9b\u4e00\u7ad9\u5f0f\u7684\u201cstarter\u201d\u4f9d\u8d56\u9879\uff0c\u4ee5\u7b80\u5316Maven\u914d\u7f6e\uff08\u9700\u8981\u6574\u5408\u4ec0\u4e48\u6846\u67b6\uff0c\u76f4\u63a5\u5bfc\u5bf9\u5e94\u6846\u67b6\u7684starter\u4f9d\u8d56\uff09</li> <li>\u5c3d\u53ef\u80fd\u81ea\u52a8\u914d\u7f6eSpring\u548c\u7b2c\u4e09\u65b9\u5e93\uff08\u9664\u975e\u7279\u6b8a\u60c5\u51b5\uff0c\u5426\u5219\u51e0\u4e4e\u4e0d\u9700\u8981\u8fdb\u884c\u4efb\u4f55\u914d\u7f6e\uff09</li> <li>\u63d0\u4f9b\u751f\u4ea7\u73af\u5883\u4e0b\u76f8\u5173\u529f\u80fd\uff0c\u5982\u6307\u6807\u3001\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u548c\u5916\u90e8\u5316\u914d\u7f6e</li> <li>\u6ca1\u6709\u4efb\u4f55\u4ee3\u7801\u751f\u6210\uff0c\u4e5f\u4e0d\u9700\u8981\u4efb\u4f55XML\u914d\u7f6e\uff08XML\u662f\u4ec0\u4e48\uff0c\u597d\u5403\u5417\uff09</li> </ul> <p>SpringBoot\u662f\u73b0\u5728\u6700\u4e3b\u6d41\u7684\u5f00\u53d1\u6846\u67b6\uff0c\u56fd\u5185\u7684\u516c\u53f8\u57fa\u672c\u90fd\u5728\u4f7f\u7528\uff0c\u4e5f\u662f\u6211\u4eec\u51fa\u53bb\u627e\u5de5\u4f5c\u4e00\u5b9a\u8981\u4f1a\u7684\u6846\u67b6\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u7ad9\u5f0f\u7684\u5f00\u53d1\u4f53\u9a8c\uff0c\u80fd\u591f\u5927\u5e45\u5ea6\u63d0\u9ad8\u6211\u4eec\u7684\u5f00\u53d1\u6548\u7387\u3002</p> <p></p> <p>\u5728SSM\u9636\u6bb5\uff0c\u5f53\u6211\u4eec\u9700\u8981\u642d\u5efa\u4e00\u4e2a\u57fa\u4e8eSpring\u5168\u5bb6\u6876\u7684Web\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u6211\u4eec\u4e0d\u5f97\u4e0d\u505a\u5927\u91cf\u7684\u4f9d\u8d56\u5bfc\u5165\u548c\u6846\u67b6\u6574\u5408\u76f8\u5173\u7684Bean\u5b9a\u4e49\uff0c\u5149\u662f\u6574\u5408\u6846\u67b6\u5c31\u82b1\u8d39\u4e86\u6211\u4eec\u5927\u91cf\u7684\u65f6\u95f4\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u6211\u4eec\u53d1\u73b0\uff0c\u6574\u5408\u6846\u67b6\u5176\u5b9e\u57fa\u672c\u90fd\u662f\u4e00\u4e9b\u56fa\u5b9a\u6d41\u7a0b\uff0c\u6211\u4eec\u6bcf\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Web\u5e94\u7528\u7a0b\u5e8f\uff0c\u57fa\u672c\u90fd\u4f1a\u4f7f\u7528\u540c\u6837\u7684\u65b9\u5f0f\u53bb\u6574\u5408\u6846\u67b6\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u5c06\u4e00\u4e9b\u91cd\u590d\u7684\u914d\u7f6e\u4f5c\u4e3a\u7ea6\u5b9a\uff0c\u53ea\u8981\u6846\u67b6\u9075\u5b88\u8fd9\u4e2a\u7ea6\u5b9a\uff0c\u4e3a\u6211\u4eec\u63d0\u4f9b\u9ed8\u8ba4\u7684\u914d\u7f6e\u5c31\u597d\uff0c\u8fd9\u6837\u5c31\u4e0d\u7528\u6211\u4eec\u518d\u53bb\u914d\u7f6e\u4e86\uff0c\u7ea6\u5b9a\u4f18\u4e8e\u914d\u7f6e\uff01</p> <p>\u800cSpringBoot\u6b63\u662f\u5c06\u8fd9\u4e9b\u8fc7\u7a0b\u5927\u5e45\u5ea6\u8fdb\u884c\u4e86\u7b80\u5316\uff0c\u5b83\u53ef\u4ee5\u81ea\u52a8\u8fdb\u884c\u914d\u7f6e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bfc\u5165\u5bf9\u5e94\u7684\u542f\u52a8\u5668\uff08starter\uff09\u4f9d\u8d56\u5373\u53ef\u3002</p> <p>\u5b8c\u6210\u672c\u9636\u6bb5\u7684\u5b66\u4e60\uff0c\u57fa\u672c\u80fd\u591f\u80dc\u4efb\u90e8\u5206\u7f51\u7ad9\u7cfb\u7edf\u7684\u540e\u7aef\u5f00\u53d1\u5de5\u4f5c\uff0c\u4e5f\u5efa\u8bae\u540c\u5b66\u4eec\u5b66\u4e60\u5b8cSpringBoot\u4e4b\u540e\u5bfb\u627e\u5408\u9002\u7684\u961f\u53cb\u53bb\u53c2\u52a0\u8ba1\u7b97\u673a\u76f8\u5173\u7684\u9ad8\u6821\u7ade\u8d5b\uff0c\u8fd9\u91cc\u6709\u4e00\u4e9b\u63a8\u8350\uff1a</p> <p>\u9879\u76ee\u7c7b\uff1a</p> <p>\u5efa\u8bae\uff1a\u6309\u7167\u76ee\u524d\u56fd\u5185\u7684\u73af\u5883\uff0c\u9879\u76ee\u7c7b\u7ade\u8d5b\u5e76\u4e0d\u4f1a\u6ce8\u91cd\u4f60\u7f16\u7801\u6c34\u5e73\u6709\u591a\u725b\uff0c\u4e5f\u4e0d\u4f1a\u6ce8\u91cd\u4f60\u7684\u9879\u76ee\u7528\u5230\u4e86\u591a\u725b\u7684\u6280\u672f\uff0c\u8fd9\u4e9b\u8bc4\u59d4\u8001\u5e08\u6280\u672f\u600e\u4e48\u6837\u6211\u4e0d\u591a\u8bf4\uff0c\u4ed6\u4eec\u53ea\u4f1a\u5728\u4e4e\u4f60\u9879\u76ee\u5236\u4f5c\u7684\u529f\u80fd\u600e\u4e48\u6837\uff0c\u5c55\u793a\u6548\u679c\u600e\u4e48\u6837\uff0c\u6709\u6ca1\u6709\u4ec0\u4e48\u521b\u65b0\u70b9\uff0c\u81f3\u4e8e\u5176\u4ed6\u7684\uff0c\u54ea\u6015\u4ee3\u7801\u5199\u6210\u4e00\u5768\u5c4e\u90fd\u4e0d\u4f1a\u7ba1\u4f60\u3002\u5e76\u4e14\u9879\u76ee\u6700\u597d\u662f\u6709\u4e13\u5229\u8bc1\u4e66\u6216\u8005\u8f6f\u8457\uff0c\u5c24\u5176\u662f\u4f01\u4e1a\u5408\u4f5c\u9879\u76ee\uff0c\u5df2\u7ecf\u6295\u5165\u751f\u4ea7\u7684\uff0c\u7279\u522b\u5403\u9999\u3002\u5982\u679c\u4f60\u662f\u767d\u624b\u8d77\u5bb6\u7684\u9879\u76ee\uff0c\u5373\u4f7f\u4f60\u518d\u52aa\u529b\u5730\u53bb\u505a\uff0c\u4e5f\u4e0d\u53ef\u80fd\u6253\u5f97\u8fc7\u4eba\u5bb6\u5f3a\u5927\u7684\u9879\u76ee\u80cc\u666f\u3002</p> \u6bd4\u8d5b\u540d\u79f0 \u96be\u5ea6 \u542b\u91d1\u91cf \u5907\u6ce8 \u521b\u65b0\u521b\u4e1a\u5927\u8d5b \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u8fd9\u6bd4\u8d5b\u6ca1\u70b9\u80cc\u666f\u5f88\u96be\uff0c\u6700\u597d\u662f\u4e13\u5229\u9879\u76ee\u6216\u662f\u4f01\u4e1a\u5408\u4f5c\u9879\u76ee \u6311\u6218\u676f \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u7f51\u4f20\u8fd9\u662fPPT\u5927\u8d5b\uff0c\u4e0d\u77e5\u771f\u5b9e\u6027\u5982\u4f55 \u4e2d\u56fd\u5927\u5b66\u751f\u8ba1\u7b97\u673a\u8bbe\u8ba1\u5927\u8d5b \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u8fd9\u4e2a\u6bd4\u8d5b\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u597d\u62ff\u5956\uff0c\u9879\u76ee\u4e00\u5b9a\u8981\u6709\u4eae\u70b9 <p>\u7b97\u6cd5\u7c7b\uff1a</p> <p>\u5efa\u8bae\uff1a\u8fd9\u79cd\u7ade\u8d5b\u8d8a\u65e9\u5f00\u59cb\u57f9\u517b\u8d8a\u597d\uff0c\u56e0\u4e3a\u8981\u80cc\u5f88\u591a\u7684\u9898\u677f\u548c\u7b97\u6cd5\uff0c\u5f88\u591a\u4eba\u90fd\u662f\u521d\u4e2d\u6216\u8005\u9ad8\u4e2d\u5c31\u5f00\u59cb\u6253\u7ade\u8d5b\u4e86\uff0c\u50cf\u56e2\u961f\u7c7b\u578b\u7684\u7ade\u8d5b\uff0c\u5982\u679c\u81ea\u5df1\u6bd4\u8f83\u83dc\uff0c\u5c31\u53bb\u627e\u5927\u4f6c\u62b1\u5927\u817f\u5427\uff0c\u5341\u4e2a\u81ed\u76ae\u5320\u90fd\u9876\u4e0d\u4e86\u8bf8\u845b\u4eae\uff1b\u4e2a\u4eba\u7c7b\u578b\u7684\u7ade\u8d5b\u4e5f\u8981\u591a\u5237\u529b\u6263\uff0c\u591a\u80cc\u7b97\u6cd5\u9898\uff0c\u4e34\u65f6\u62b1\u4f5b\u811a\u4e5f\u662f\u6ca1\u6709\u7528\u7684\u3002</p> \u6bd4\u8d5b\u540d\u79f0 \u96be\u5ea6 \u542b\u91d1\u91cf \u5907\u6ce8 \u84dd\u6865\u676f \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u84dd\u6865\u676f\u5efa\u8bae\u53c2\u52a0\u524d\u7aef/Java\u7ec4\uff0c\u7a0d\u5fae\u7b80\u5355\u4e00\u70b9\uff0c\u53bbC++\u5c31\u662f\u627e\u6b7b CCPC \u5929\u68af\u8d5b \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u4e0d\u591a\u8bf4 ICPC ACM \u5927\u5b66\u751f\u7a0b\u5e8f\u8bbe\u8ba1\u7ade\u8d5b \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f\u2b50\ufe0f \u8fd9\u4e2a\u96be\u5ea6\u975e\u5e38\u5927\uff0c\u6700\u597d\u662f\u6709\u5927\u4f6c\u5e26\uff0c\u9760\u81ea\u5df1\u6162\u6162\u53bb\u5b66\u5f88\u96be <p>\u6253\u7ade\u8d5b\u7684\u8fc7\u7a0b\u662f\u5f88\u8f9b\u82e6\u7684\uff0c\u4ed8\u51fa\u5f88\u6709\u53ef\u80fd\u6ca1\u6709\u56de\u62a5\uff0c\u5f88\u591a\u7ade\u8d5b\u6ca1\u6709\u7edd\u5bf9\u7684\u516c\u5e73\uff0c\u591a\u591a\u5c11\u5c11\u6709\u4e00\u4e9b\u5229\u76ca\u5173\u7cfb\u5728\u91cc\u9762\uff0c\u4f46\u662f\u591a\u53c2\u52a0\u4e00\u4e9b\u7ade\u8d5b\u54ea\u6015\u6ca1\u6709\u5f97\u5956\uff0c\u8fd8\u662f\u53ef\u4ee5\u6536\u83b7\u5230\u5f88\u591a\u7684\uff0c\u5982\u679c\u4f60\u901a\u8fc7\u8fd9\u4e9b\u6bd4\u8d5b\u5b66\u5230\u4e86\u5f88\u591a\uff0c\u5b9e\u9645\u4e0a\u5f97\u4e0d\u5f97\u5956\u5df2\u7ecf\u4e0d\u91cd\u8981\u4e86\uff0c\u81ea\u5df1\u5185\u5fc3\u7684\u5f3a\u5927\u7684\u624d\u662f\u771f\u6b63\u7684\u5f3a\u5927\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_1","title":"\u5feb\u901f\u4e0a\u624b","text":"<p>\u8981\u611f\u53d7SpringBoot\u5e26\u6765\u7684\u5feb\u901f\u5f00\u53d1\u4f53\u9a8c\uff0c\u6211\u4eec\u5c31\u4ece\u521b\u5efa\u4e00\u4e2a\u9879\u76ee\u5f00\u59cb\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_2","title":"\u6781\u901f\u521b\u5efa\u9879\u76ee","text":"<p>\u5728\u8fc7\u53bb\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2aSSM\u9879\u76ee\uff0c\u9700\u8981\u5148\u5bfc\u5165\u5404\u79cd\u4f9d\u8d56\uff0c\u8fdb\u884c\u5927\u91cf\u7684\u914d\u7f6e\uff0c\u800c\u73b0\u5728\uff0c\u6709\u4e86SpringBoot\uff0c\u6211\u4eec\u53ef\u4ee5\u4eab\u53d7\u8d85\u5feb\u7684\u9879\u76ee\u521b\u5efa\u4f53\u9a8c\uff0c\u53ea\u9700\u8981\u524d\u5f80\u5b98\u7f51\u8fdb\u884c\u5c11\u91cf\u914d\u7f6e\u5c31\u80fd\u5feb\u901f\u4e3a\u4f60\u751f\u6210\u4e00\u4e2aSpringBoot\u9879\u76ee\u6a21\u7248\uff1ahttps://start.spring.io/</p> <p></p> <p>\u4e0d\u8fc7\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0cIDEA\u5df2\u7ecf\u5c06\u8fd9\u4e2a\u5de5\u5177\u96c6\u6210\u5230\u5185\u90e8\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728IDEA\u4e2d\u8fdb\u884c\u521b\u5efa\uff0c\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u9996\u5148\u5728\u65b0\u5efa\u9879\u76ee\u9636\u6bb5\uff0c\u9009\u62e9 Spring Initializr \u7c7b\u578b\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u914d\u7f6e\u9879\u76ee\u7684\u8bed\u8a00\uff0c\u5e76\u4e14\u9009\u62e9\u9879\u76ee\u9700\u8981\u4f7f\u7528\u7684\u6a21\u5757\uff0c\u8fd9\u91cc\u6211\u4eec\u7b80\u5355\u9009\u62e9\u4e24\u4e2a\u4f9d\u8d56\uff1a</p> <p></p> <p>\u5982\u679c\u4e00\u5f00\u59cb\u4e0d\u6e05\u695a\u81ea\u5df1\u9700\u8981\u54ea\u4e9b\u6a21\u5757\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u540e\u7eed\u81ea\u5df1\u624b\u52a8\u6dfb\u52a0\u5bf9\u5e94\u6a21\u5757\u7684starter\u4f9d\u8d56\uff0c\u4f7f\u7528\u975e\u5e38\u7b80\u5355\u3002</p> <p>\u9879\u76ee\u81ea\u52a8\u751f\u6210\u4e4b\u540e\uff0c\u53ef\u4ee5\u770b\u5230Spring\u76f8\u5173\u7684\u4f9d\u8d56\u5df2\u7ecf\u5168\u90e8\u81ea\u52a8\u5bfc\u5165\uff1a</p> <p></p> <p>\u5e76\u4e14\u4e5f\u81ea\u52a8\u4e3a\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u4e3b\u7c7b\u7528\u4e8e\u8fd0\u884c\u6211\u4eec\u7684SpringBoot\u9879\u76ee\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u4e00\u952e\u542f\u52a8\u6211\u4eec\u7684SpringBoot\u9879\u76ee\uff1a</p> <p></p> <p>\u53ea\u4e0d\u8fc7\u7531\u4e8e\u6211\u4eec\u6ca1\u6709\u6dfb\u52a0\u4efb\u4f55\u6709\u7528\u7684\u6a21\u5757\uff0c\u4e5f\u6ca1\u6709\u7f16\u5199\u4ec0\u4e48\u64cd\u4f5c\uff0c\u56e0\u6b64\u542f\u52a8\u4e4b\u540e\u9879\u76ee\u5c31\u76f4\u63a5\u505c\u6b62\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_3","title":"\u5e38\u7528\u6a21\u5757\u5feb\u901f\u6574\u5408","text":"<p>\u524d\u9762\u6211\u4eec\u8bf4\u4e86\uff0cSpringBoot\u7684\u6838\u5fc3\u601d\u60f3\u5c31\u662f\u7ea6\u5b9a\u5927\u4e8e\u914d\u7f6e\uff0c\u80fd\u5728\u4e00\u5f00\u59cb\u9ed8\u8ba4\u7684\u5c31\u76f4\u63a5\u9ed8\u8ba4\uff0c\u4e0d\u7528\u6211\u4eec\u81ea\u5df1\u6765\u8fdb\u884c\u914d\u7f6e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u914d\u7f6e\u67d0\u4e9b\u7279\u6b8a\u7684\u90e8\u5206\u5373\u53ef\uff0c\u8fd9\u4e00\u90e8\u5206\u6211\u4eec\u5c31\u6765\u8be6\u7ec6\u4f53\u9a8c\u4e00\u4e0b\u3002</p> <p>\u6211\u4eec\u6765\u5c1d\u8bd5\u5c06\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u8fc7\u7684\u6a21\u5757\u8fdb\u884c\u4e00\u4e0b\u5feb\u901f\u6574\u5408\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u4e00\u5f00\u59cb\u7684\u65f6\u5019\uff0c\u6211\u4eec\u6ca1\u6709\u52fe\u9009\u5176\u4ed6\u7684\u4f9d\u8d56\uff0c\u56e0\u6b64\u8fd9\u91cc\u53ea\u5bfc\u5165\u4e86\u6700\u57fa\u672c\u7684<code>spring-boot-starter</code>\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n     &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6240\u6709\u7684SpringBoot\u4f9d\u8d56\u90fd\u662f\u4ee5starter\u7684\u5f62\u5f0f\u547d\u540d\u7684\uff0c\u4e4b\u540e\u6211\u4eec\u9700\u8981\u5bfc\u5165\u5176\u4ed6\u6a21\u5757\u4e5f\u662f\u5bfc\u5165<code>spring-boot-starter-xxxx</code>\u8fd9\u79cd\u540d\u79f0\u683c\u5f0f\u7684\u4f9d\u8d56\u3002</p> <p>\u9996\u5148\u6211\u4eec\u8fd8\u662f\u4eceSpringMvc\u76f8\u5173\u4f9d\u8d56\u5f00\u59cb\u3002SpringBoot\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5305\u542b\u5185\u7f6eTomcat\u670d\u52a1\u5668\u7684Web\u6a21\u5757\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bfc\u5165\u4f9d\u8d56\u5c31\u80fd\u76f4\u63a5\u8fd0\u884c\u670d\u52a1\u5668\uff1a</p> <pre><code>&lt;dependency&gt;\n     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n     &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6211\u4eec\u4e0d\u9700\u8981\u8fdb\u884c\u4efb\u4f55\u914d\u7f6e\uff0c\u76f4\u63a5\u70b9\u51fb\u542f\u52a8\uff1a</p> <p></p> <p>\u5b83\u771f\u7684\u505a\u5230\u4e86\u5f00\u7bb1\u5373\u7528\uff0c\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u8fd9\u4e2a\u7f51\u7ad9\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6210\u529f\u54cd\u5e94\u4e86404\u9875\u9762\uff0c\u76f8\u6bd4\u4e4b\u524d\u7684\u5927\u91cf\u914d\u7f6e\uff0c\u53ef\u4ee5\u8bf4\u65b9\u4fbf\u4e86\u5f88\u591a\uff0c\u6211\u4eec\u5230\u76ee\u524d\u4e3a\u6b62\u4ec5\u4ec5\u662f\u5bfc\u5165\u4e86\u4e00\u4e2a\u4f9d\u8d56\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u76f4\u63a5\u542f\u52a8\u6211\u4eec\u7684Web\u670d\u52a1\u5668\u5e76\u6b63\u5e38\u8bbf\u95ee\u3002</p> <p>SpringBoot\u652f\u6301\u81ea\u52a8\u5305\u626b\u63cf\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u7f16\u5199\u4efb\u4f55\u914d\u7f6e\uff0c\u76f4\u63a5\u5728\u4efb\u610f\u8def\u5f84\uff08\u4f46\u662f\u4e0d\u80fd\u8dd1\u5230\u4e3b\u7c7b\u6240\u5728\u5305\u5916\u9762\u53bb\u4e86\uff09\u4e0b\u521b\u5efa\u7684\u7ec4\u4ef6\uff08\u5982Controller\u3001Service\u3001Component\u3001Configuration\u7b49\uff09\u90fd\u53ef\u4ee5\u751f\u6548\uff0c\u6bd4\u5982\u6211\u4eec\u8fd9\u91cc\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7684Controller\u8bd5\u8bd5\u770b\uff1a</p> <pre><code>@Controller\npublic class TestController {\n\n    @ResponseBody\n    @GetMapping(\"/\")\n    public String index(){\n        return \"Hello World\";\n    }\n}\n</code></pre> <p>\u91cd\u542f\u4e4b\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u76f4\u63a5\u5c31\u80fd\u8bbf\u95ee\u5230\uff0c\u800c\u8fd9\u671f\u95f4\u6211\u4eec\u53ea\u662f\u521b\u5efa\u4e86\u5bf9\u5e94\u7684Controller\u5374\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u914d\u7f6e\uff0c\u8fd9\u771f\u7684\u592a\u65b9\u4fbf\u4e86\uff1a</p> <p></p> <p>\u5305\u62ec\u4e00\u4e2a\u5bf9\u8c61\u73b0\u5728\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4ee5JSON\u5f62\u5f0f\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u65e0\u9700\u4efb\u4f55\u914d\u7f6e\uff1a</p> <pre><code>@Data\npublic class Student {\n    int sid;\n    String name;\n    String sex;\n}\n</code></pre> <pre><code>@ResponseBody\n@GetMapping(\"/\")\npublic Student index(){\n    Student student = new Student();\n    student.setName(\"\u5c0f\u660e\");\n    student.setSex(\"\u7537\");\n    student.setSid(10);\n    return student;\n}\n</code></pre> <p></p> <p>\u6700\u540e\u6d4f\u89c8\u5668\u80fd\u591f\u76f4\u63a5\u5f97\u5230<code>application/json</code>\u7684\u54cd\u5e94\u6570\u636e\uff0c\u5c31\u662f\u8fd9\u4e48\u65b9\u4fbf\uff0c\u8fd9\u90fd\u5f97\u5f52\u529f\u4e8eSpringBoot\u5bf9\u5e94\u7684start\u5e2e\u52a9\u6211\u4eec\u81ea\u52a8\u5c06\u5904\u7406JSON\u6570\u636e\u7684Converter\u8fdb\u884c\u4e86\u914d\u7f6e\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u518d\u5355\u72ec\u53bb\u914d\u7f6eConverter\u4e86\u3002\u4e0d\u8fc7SpringBoot\u5b98\u65b9\u9ed8\u8ba4\u4f7f\u7528\u7684\u662f<code>Jackson</code>\u548c<code>Gson</code> \u7684HttpMessageConverter\u6765\u8fdb\u884c\u914d\u7f6e\uff0c\u4e0d\u662f\u6211\u4eec\u4e4b\u524d\u6559\u7a0b\u4e2d\u4f7f\u7528\u7684FastJSON\u6846\u67b6\u3002</p> <p>\u6211\u4eec\u6700\u540e\u6765\u770b\u770b\u8fd9\u4e2aStart\u5305\u542b\u4e86\u54ea\u4e9b\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n      &lt;version&gt;3.1.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-starter-json&lt;/artifactId&gt;\n      &lt;version&gt;3.1.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n      &lt;version&gt;3.1.1&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-web&lt;/artifactId&gt;\n      &lt;version&gt;6.0.10&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt;\n      &lt;version&gt;6.0.10&lt;/version&gt;\n      &lt;scope&gt;compile&lt;/scope&gt;\n    &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n</code></pre> <p>\u91cc\u9762\u5305\u542b\u4e86\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li>spring-boot-starter  \u57fa\u7840\u4f9d\u8d56starter</li> <li>spring-boot-starter-json  \u914d\u7f6eJSON\u8f6c\u6362\u7684starter</li> <li>spring-boot-starter-tomcat   \u5185\u7f6eTomcat\u670d\u52a1\u5668</li> <li>spring-web\u3001spring-webmvc    \u4e0d\u7528\u591a\u8bf4\u4e86\u5427\uff0c\u4e4b\u524d\u5df2\u7ecf\u8bb2\u8fc7\u4e86</li> </ul> <p>\u5982\u679c\u9700\u8981\u50cf\u4e4b\u524d\u4e00\u6837\u6dfb\u52a0WebMvc\u7684\u914d\u7f6e\u7c7b\uff0c\u65b9\u6cd5\u662f\u4e00\u6837\u7684\uff0c\u76f4\u63a5\u521b\u5efa\u5373\u53ef\uff1a</p> <pre><code>//\u53ea\u9700\u8981\u6dfb\u52a0Configuration\u7528\u4e8e\u6ce8\u518c\u914d\u7f6e\u7c7b\uff0c\u4e0d\u9700\u8981\u5176\u4ed6\u4efb\u4f55\u6ce8\u89e3\uff0c\u5df2\u7ecf\u81ea\u52a8\u914d\u7f6e\u597d\u4e86\n@Configuration\npublic class WebConfiguration implements WebMvcConfigurer {\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        registry.addInterceptor(new HandlerInterceptor() {\n            @Override\n            public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {\n                return HandlerInterceptor.super.preHandle(request, response, handler);\n            }\n        });\n    }\n}\n</code></pre> <p>\u6211\u4eec\u5728SSM\u9636\u6bb5\u7f16\u5199\u7684\u5927\u91cf\u914d\u7f6e\uff0c\u5230\u73b0\u5728\u5df2\u7ecf\u5f7b\u5e95\u4e0d\u9700\u8981\u4e86\u3002</p> <p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u6765\u770b\u770bSpringSecurity\u6846\u67b6\u5982\u4f55\u8fdb\u884c\u6574\u5408\uff0c\u4e5f\u662f\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u9700\u8981\u76f4\u63a5\u5bfc\u5165\u5373\u53ef\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u5bfc\u5165\u5b8c\u6210\u540e\uff0c\u518d\u6b21\u8bbf\u95ee\u7f51\u7ad9\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u719f\u6089\u7684\u767b\u5f55\u754c\u9762\u4e86\uff1a</p> <p></p> <p>\u6211\u4eec\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u914d\u7f6e\uff0c\u800c\u662f\u5bf9\u5e94\u7684Starter\u5e2e\u52a9\u6211\u4eec\u5b8c\u6210\u4e86\u9ed8\u8ba4\u7684\u914d\u7f6e\uff0c\u5e76\u4e14\u5728\u542f\u52a8\u65f6\uff0c\u5c31\u5df2\u7ecf\u5e2e\u52a9\u6211\u4eec\u914d\u7f6e\u4e86\u4e00\u4e2a\u968f\u673a\u5bc6\u7801\u7684\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u767b\u5f55\u4f7f\u7528\uff1a</p> <p></p> <p>\u5bc6\u7801\u76f4\u63a5\u5c55\u793a\u5728\u542f\u52a8\u65e5\u5fd7\u4e2d\uff0c\u800c\u9ed8\u8ba4\u7528\u6237\u540d\u79f0\u4e3a<code>user</code>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u767b\u5f55\uff1a</p> <p></p> <p>\u540c\u6837\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u914d\u7f6e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6dfb\u52a0\u5bf9\u5e94\u7684starter\u5c31\u80fd\u505a\u5230\u5f00\u7bb1\u5373\u7528\uff0c\u5e76\u4e14\u5185\u7f6e\u4e00\u5957\u9ed8\u8ba4\u914d\u7f6e\uff0c\u81ea\u52a8\u5e2e\u52a9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u7528\u6237\uff0c\u65b9\u4fbf\u6211\u4eec\u5feb\u901f\u642d\u5efa\u9879\u76ee\uff0c\u540c\u6837\u7684\uff0c\u5982\u679c\u8981\u8fdb\u884c\u989d\u5916\u914d\u7f6e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u76f4\u63a5\u6dfb\u52a0\u914d\u7f6e\u7c7b\u5373\u53ef\uff1a</p> <pre><code>//\u4f9d\u7136\u53ea\u9700\u8981Configuration\u6ce8\u89e3\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u5176\u4ed6\u914d\u7f6e\n@Configuration\npublic class SecurityConfiguration {\n\n    //\u914d\u7f6e\u65b9\u5f0f\u8ddf\u4e4b\u524dSSM\u9636\u6bb5\u662f\u4e00\u6837\u7684\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                .authorizeHttpRequests(auth -&gt; {\n                    auth.anyRequest().authenticated();\n                })\n                .formLogin(conf -&gt; {\n                    conf.loginPage(\"/login\");\n                    conf.loginProcessingUrl(\"/doLogin\");\n                    conf.defaultSuccessUrl(\"/\");\n                    conf.permitAll();\n                })\n                .build();\n    }\n}\n</code></pre> <p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5feb\u901f\u6574\u5408\u4e4b\u524d\u4f7f\u7528\u7684\u6a21\u7248\u5f15\u64ce\uff0c\u6bd4\u5982Thymeleaf\u6846\u67b6\uff0c\u76f4\u63a5\u4e0a\u5bf9\u5e94\u7684Starter\u5373\u53ef\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u5728<code>resources</code>\u76ee\u5f55\u4e0b\u521b\u5efa\u4e24\u4e2a\u76ee\u5f55\uff1a</p> <p></p> <p>\u8fd9\u4e24\u4e2a\u76ee\u5f55\u662f\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u9700\u8981\u7684\uff0c\u540d\u5b57\u5fc5\u987b\u662f\u8fd9\u4e2a\uff1a</p> <ul> <li><code>templates</code> - \u6240\u6709\u6a21\u7248\u6587\u4ef6\u90fd\u5b58\u653e\u5728\u8fd9\u91cc</li> <li><code>static</code> - \u6240\u6709\u9759\u6001\u8d44\u6e90\u90fd\u5b58\u653e\u5728\u8fd9\u91cc</li> </ul> <p>\u6211\u4eec\u53ea\u9700\u8981\u6309\u7167\u4e0a\u9762\u7684\u6837\u5b50\u653e\u5165\u6211\u4eec\u4e4b\u524d\u7684\u524d\u7aef\u6a21\u7248\uff0c\u5c31\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u6a21\u7248\u5f15\u64ce\u4e86\uff0c\u540c\u6837\u4e0d\u9700\u8981\u8fdb\u5165\u4efb\u4f55\u7684\u914d\u7f6e\uff0c\u5f53\u7136\uff0c\u5982\u679c\u5404\u4f4d\u5c0f\u4f19\u4f34\u89c9\u5f97\u4e0d\u65b9\u4fbf\uff0c\u6211\u4eec\u540e\u7eed\u4e5f\u53ef\u4ee5\u8fdb\u884c\u4fee\u6539\u3002</p> <p>\u6211\u4eec\u4e0d\u9700\u8981\u5728controller\u4e2d\u5199\u4efb\u4f55\u5185\u5bb9\uff0c\u5b83\u9ed8\u8ba4\u4f1a\u5c06index.html\u4f5c\u4e3a\u9996\u9875\u6587\u4ef6\uff0c\u6211\u4eec\u76f4\u63a5\u8bbf\u95ee\u670d\u52a1\u5668\u5730\u5740\u5c31\u80fd\u5c55\u793a\u9996\u9875\u4e86\uff1a</p> <pre><code>@Controller\npublic class TestController {\n        //\u4ec0\u4e48\u90fd\u4e0d\u7528\u5199\n}\n</code></pre> <p></p> <p>\u8fd9\u90fd\u662f\u5f97\u76ca\u4e8e\u7ea6\u5b9a\u5927\u4e8e\u914d\u7f6e\u7684\u601d\u60f3\uff0c\u5f00\u7bb1\u5373\u7528\u7684\u611f\u89c9\u5c31\u662f\u8fd9\u4e48\u8212\u670d\uff0c\u4e0d\u8fc7\u80af\u5b9a\u6709\u5c0f\u4f19\u4f34\u597d\u5947\u90a3\u73b0\u5728\u8981\u600e\u4e48\u624d\u80fd\u50cf\u4e4b\u524d\u4e00\u6837\u81ea\u5df1\u5199\u5462\uff0c\u8fd9\u4e2a\u80af\u5b9a\u8fd8\u662f\u8ddf\u4e4b\u524d\u4e00\u6837\u7684\u5457\uff0c\u8be5\u600e\u4e48\u5199\u5c31\u600e\u4e48\u5199\u3002</p> <p>\u6211\u4eec\u6700\u540e\u518d\u6765\u770b\u770bMybatis\u5982\u4f55\u8fdb\u884c\u6574\u5408\uff0c\u540c\u6837\u53ea\u9700\u8981\u4e00\u4e2astarter\u5373\u53ef\uff0c\u8fd9\u91cc\u987a\u4fbf\u628aMySQL\u7684\u9a71\u52a8\u52a0\u4e0a\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;\n    &lt;version&gt;3.0.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n    &lt;scope&gt;runtime&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6ce8\u610f\u8fd9\u91cc\u7684<code>mybatis-spring-boot-starter</code>\u7248\u672c\u9700\u8981\u6211\u4eec\u81ea\u5df1\u6307\u5b9a\uff0c\u56e0\u4e3a\u5b83\u6ca1\u6709\u88ab\u7236\u5de5\u7a0b\u9ed8\u8ba4\u7ba1\u7406\u3002</p> <p></p> <p>\u542f\u52a8\u670d\u52a1\u5668\u65f6\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u91cc\u51fa\u73b0\u4e86\u95ee\u9898\uff0c\u5bfc\u81f4\u65e0\u6cd5\u542f\u52a8\u3002\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u914d\u7f6e\u6570\u636e\u6e90\u5bfc\u81f4\u7684\uff0c\u867d\u7136SpringBoot\u91c7\u7528\u7ea6\u5b9a\u5927\u4e8e\u914d\u7f6e\u7684\u601d\u60f3\uff0c\u4f46\u662f\u6570\u636e\u5e93\u4fe1\u606f\u53ea\u6709\u6211\u4eec\u81ea\u5df1\u6e05\u695a\uff0c\u800c\u4e14\u53d8\u5316\u591a\u6837\uff0c\u6839\u672c\u6ca1\u6709\u529e\u6cd5\u63d0\u524d\u5b8c\u6210\u7ea6\u5b9a\uff0c\u6240\u4ee5\u8bf4\u8fd9\u91cc\u6211\u4eec\u8fd8\u662f\u9700\u8981\u518d\u914d\u7f6e\u6587\u4ef6\u4e2d\u7f16\u5199\uff0c\u81f3\u4e8e\u5982\u4f55\u7f16\u5199\u914d\u7f6e\u6587\u4ef6\u6211\u4eec\u4f1a\u5728\u4e0b\u4e00\u8282\u4e2d\u8fdb\u884c\u8bb2\u89e3\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_4","title":"\u81ea\u5b9a\u4e49\u8fd0\u884c\u5668","text":"<p>\u5728\u9879\u76ee\u4e2d\uff0c\u53ef\u80fd\u4f1a\u9047\u5230\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a\u6211\u4eec\u9700\u8981\u5728\u9879\u76ee\u542f\u52a8\u5b8c\u6210\u4e4b\u540e\uff0c\u7d27\u63a5\u7740\u6267\u884c\u4e00\u6bb5\u4ee3\u7801\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u7f16\u5199\u81ea\u5b9a\u4e49\u7684ApplicationRunner\u6765\u89e3\u51b3\uff0c\u5b83\u4f1a\u5728\u9879\u76ee\u542f\u52a8\u5b8c\u6210\u540e\u6267\u884c\uff1a</p> <pre><code>@Component\npublic class TestRunner implements ApplicationRunner {\n    @Override\n    public void run(ApplicationArguments args) throws Exception {\n        System.out.println(\"\u6211\u662f\u81ea\u5b9a\u4e49\u6267\u884c\uff01\");\n    }\n}\n</code></pre> <p>\u5f53\u7136\u4e5f\u53ef\u4ee5\u4f7f\u7528CommandLineRunner\uff0c\u5b83\u4e5f\u652f\u6301\u4f7f\u7528@Order\u6216\u662f\u5b9e\u73b0Ordered\u63a5\u53e3\u6765\u652f\u6301\u4f18\u5148\u7ea7\u6267\u884c\u3002</p> <p>\u8fd9\u4e2a\u529f\u80fd\u6bd4\u8f83\u7b80\u5355\uff0c\u4e0d\u591a\u505a\u4ecb\u7ecd\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_5","title":"\u914d\u7f6e\u6587\u4ef6\u4ecb\u7ecd","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u4f53\u9a8c\u4e86SpringBoot\u5e26\u6765\u7684\u5feb\u6377\u5f00\u53d1\u4f53\u9a8c\uff0c\u4e0d\u8fc7\u6211\u4eec\u53d1\u73b0\u6709\u4e9b\u4e1c\u897f\u8fd8\u662f\u9700\u8981\u6211\u4eec\u81ea\u5df1\u6765\u7f16\u5199\u914d\u7f6e\u624d\u53ef\u4ee5\uff0c\u4e0d\u7136SpringBoot\u9879\u76ee\u65e0\u6cd5\u6b63\u5e38\u542f\u52a8\uff0c\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u7f16\u5199\u914d\u7f6e\u3002\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728<code>application.properties</code>\u4e2d\u8fdb\u884c\u914d\u7f6e\u7f16\u5199\uff0c\u5b83\u662f\u6574\u4e2aSpringBoot\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6bd4\u5982\u8981\u4fee\u6539\u670d\u52a1\u5668\u7684\u9ed8\u8ba4\u7aef\u53e3\uff1a</p> <p></p> <p>\u8fd9\u4e9b\u914d\u7f6e\u5176\u5b9e\u90fd\u662f\u5404\u79cdStarter\u63d0\u4f9b\u7684\uff0c\u90e8\u5206\u914d\u7f6e\u5728Starter\u4e2d\u5177\u6709\u9ed8\u8ba4\u503c\uff0c\u6211\u4eec\u5373\u4f7f\u4e0d\u914d\u7f6e\u4e5f\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u503c\uff0c\u6bd4\u5982\u8fd9\u91cc\u76848080\u5c31\u662f\u6211\u4eec\u670d\u52a1\u5668\u7684\u9ed8\u8ba4\u7aef\u53e3\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u624b\u52a8\u4fee\u6539\u5b83\uff0c\u6765\u53d8\u6210\u6211\u4eec\u9700\u8981\u7684\u3002</p> <p>\u9664\u4e86\u914d\u7f6e\u5df2\u7ecf\u5b58\u5728\u7684\u9009\u9879\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6dfb\u52a0\u81ea\u5b9a\u4e49\u7684\u914d\u7f6e\uff0c\u6765\u65b9\u4fbf\u6211\u4eec\u7a0b\u5e8f\u4e2d\u4f7f\u7528\uff0c\u6bd4\u5982\u6211\u4eec\u8fd9\u91cc\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u6570\u636e\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u7a0b\u5e8f\u4e2d\u901a\u8fc7<code>@Value</code>\u6765\u8bbf\u95ee\u5230\uff08\u8ddf\u6211\u4eec\u4e4b\u524dSpring\u57fa\u7840\u7bc7\u8bb2\u7684\u662f\u4e00\u6837\u7684\uff09</p> <pre><code>@Controller\npublic class TestController {\n    @Value(\"${test.data}\")\n    int data;   //\u76f4\u63a5\u4ece\u914d\u7f6e\u4e2d\u53bb\u53d6\n}\n</code></pre> <p>\u914d\u7f6e\u6587\u4ef6\u9664\u4e86\u4f7f\u7528<code>properties</code>\u683c\u5f0f\u4ee5\u5916\uff0c\u8fd8\u6709\u4e00\u79cd\u53eb\u505a<code>yaml</code>\u683c\u5f0f\uff0c\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>\u4e00\u7ea7\u76ee\u5f55:\n    \u4e8c\u7ea7\u76ee\u5f55:\n      \u4e09\u7ea7\u76ee\u5f551: \u503c\n      \u4e09\u7ea7\u76ee\u5f552: \u503c\n      \u4e09\u7ea7\u76ee\u5f55List: \n      - \u5143\u7d201\n      - \u5143\u7d202\n      - \u5143\u7d203\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u6bcf\u4e00\u7ea7\u76ee\u5f55\u90fd\u662f\u901a\u8fc7\u7f29\u8fdb\uff08\u4e0d\u80fd\u4f7f\u7528Tab\uff0c\u53ea\u80fd\u4f7f\u7528\u7a7a\u683c\uff09\u533a\u5206\uff0c\u5e76\u4e14\u952e\u548c\u503c\u4e4b\u95f4\u9700\u8981\u6dfb\u52a0\u5192\u53f7+\u7a7a\u683c\u6765\u8868\u793a\u3002</p> <p>SpringBoot\u4e5f\u652f\u6301\u8fd9\u79cd\u683c\u5f0f\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06<code>application.properties</code>\u4fee\u6539\u4e3a<code>application.yml</code>\u6216\u662f<code>application.yaml</code>\u6765\u4f7f\u7528YAML\u8bed\u6cd5\u7f16\u5199\u914d\u7f6e\uff1a</p> <pre><code>server:\n  port: 80\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u6765\u5c1d\u8bd5\u4e3a\u4e4b\u524d\u7684\u6570\u636e\u6e90\u8fdb\u884c\u4e00\u4e0b\u914d\u7f6e\uff0c\u8fd9\u6837\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u6211\u4eec\u7684\u670d\u52a1\u5668\uff1a</p> <pre><code>spring:\n  datasource:\n    url: jdbc:mysql://localhost:3306/test\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.cj.jdbc.Driver\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6b63\u5e38\u542f\u52a8\u670d\u52a1\u5668\u4e86\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u63a5\u7eed\u6765\u6d4b\u8bd5\u4e00\u4e0bMyBatis\u7684\u914d\u7f6e\uff0c\u60f3\u8981\u5728SpringBoot\u4e2d\u4f7f\u7528Mybatis\u4e5f\u5f88\u7b80\u5355\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u4efb\u4f55\u914d\u7f6e\uff0c\u6211\u4eec\u76f4\u63a5\u7f16\u5199Mapper\u5373\u53ef\uff0c\u8fd9\u91cc\u6211\u4eec\u968f\u4fbf\u521b\u5efa\u4e00\u4e2a\u8868\u8bd5\u8bd5\u770b\uff1a</p> <p></p> <pre><code>@Data\npublic class User {\n    int id;\n    String name;\n    String email;\n    String password;\n}\n</code></pre> <p>\u6ce8\u610f\uff0c\u5728SpringBoot\u6574\u5408\u4e4b\u540e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u76f4\u63a5\u5728\u914d\u7f6e\u7c7b\u4e0a\u6dfb\u52a0<code>@MapperScan</code>\u6ce8\u89e3\u5373\u53ef\uff0c\u8ddf\u6211\u4eec\u4e4b\u524d\u7684\u4f7f\u7528\u65b9\u6cd5\u662f\u4e00\u6837\u7684\uff1a</p> <pre><code>@Configuration\n@MapperScan(\"com.example.mapper\")\npublic class WebConfiguration implements WebMvcConfigurer {\n  ...\n</code></pre> <p>\u4e0d\u8fc7\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4e3a\u9700\u8981\u6ce8\u518c\u4e3aMapper\u7684\u63a5\u53e3\u6dfb\u52a0<code>@Mapper</code>\u6ce8\u89e3\uff0c\u6765\u8868\u793a\u8fd9\u4e2a\u63a5\u53e3\u4f5c\u4e3aMapper\u4f7f\u7528\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u5373\u4f7f\u4e0d\u914d\u7f6eMapperScan\u4e5f\u80fd\u76f4\u63a5\u6ce8\u518c\u4e3aMapper\u6b63\u5e38\u4f7f\u7528\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u7279\u522b\u65b9\u4fbf\uff1f</p> <pre><code>@Mapper\npublic interface UserMapper {\n    @Select(\"select * from user where id = #{id}\")\n    User findUserById(int id);\n}\n</code></pre> <pre><code>@ResponseBody\n@GetMapping(\"/test\")\npublic User test(){\n        return mapper.findUserById(1);\n}\n</code></pre> <p>\u8bbf\u95ee\u63a5\u53e3\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <p></p> <p>\u6700\u540e\uff0c\u6211\u4eec\u518d\u6765\u4ecb\u7ecd\u4e00\u4e0b\u5e38\u89c1\u7684\u914d\u7f6e\u9879\uff0c\u6bd4\u5982SpringSecurity\u548cSpringBootMvc\u914d\u7f6e\uff1a</p> <pre><code>spring:  \n  #  Spring Mvc\u76f8\u5173\u914d\u7f6e\n  mvc:\n    static-path-pattern: /static/**   #\u9759\u6001\u8d44\u6e90\u89e3\u6790\u5730\u5740\n  # Spring Security \u76f8\u5173\u914d\u7f6e\n  security:\n    filter:\n      order: -100 #Spring Security \u8fc7\u6ee4\u5668\u4f18\u5148\u7ea7\n    user:\n      name: 'admin'   #\u9ed8\u8ba4\u767b\u5f55\u7528\u6237\u540d\n      password: '123456'   #\u9ed8\u8ba4\u767b\u5f55\u5bc6\u7801\n      roles:    #\u9ed8\u8ba4\u7528\u6237\u7684\u89d2\u8272\n        - admin\n        - user\n</code></pre> <p>\u66f4\u591a\u7684\u914d\u7f6e\u6211\u4eec\u53ef\u4ee5\u5728\u540e\u7eed\u7684\u5b66\u4e60\u4e2d\u7ee7\u7eed\u8ba4\u8bc6\uff0c\u8fd9\u4e9b\u914d\u7f6e\u5176\u5b9e\u90fd\u662f\u7531Starter\u63d0\u4f9b\u7684\uff0c\u786e\u5b9e\u6781\u5927\u7a0b\u5ea6\u7b80\u5316\u4e86\u6211\u4eec\u5bf9\u4e8e\u6846\u67b6\u7684\u4f7f\u7528\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_6","title":"\u8f7b\u677e\u6253\u5305\u8fd0\u884c","text":"<p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u4e00\u4e2aSpringBoot\u5982\u4f55\u5feb\u6377\u6574\u5408\u5176\u4ed6\u6846\u67b6\u4ee5\u53ca\u8fdb\u884c\u914d\u7f6e\u7f16\u5199\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\u5982\u4f55\u6253\u5305\u6211\u4eec\u7684SpringBoot\u9879\u76ee\u4f7f\u5176\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\uff0cSpringBoot\u63d0\u4f9b\u4e86\u4e00\u4e2a\u975e\u5e38\u4fbf\u6377\u7684\u6253\u5305\u63d2\u4ef6\uff0c\u80fd\u591f\u76f4\u63a5\u5c06\u6211\u4eec\u7684\u9879\u76ee\u6253\u5305\u6210\u4e00\u4e2ajar\u5305\uff0c\u7136\u540e\u4f7f\u7528java\u547d\u4ee4\u76f4\u63a5\u8fd0\u884c\uff0c\u6211\u4eec\u76f4\u63a5\u70b9\u51fbMaven\u4e2d\u7684\uff1a</p> <p></p> <p>\u70b9\u51fb\u4e4b\u540e\u9879\u76ee\u4f1a\u81ea\u52a8\u6253\u5305\u6784\u5efa\uff1a</p> <p></p> <p>\u6253\u5305\u5b8c\u6210\u4e4b\u540e\uff0c\u4f1a\u5728target\u76ee\u5f55\u4e0b\u51fa\u73b0\u4e00\u4e2a\u6253\u5305\u597d\u7684jar\u6587\u4ef6\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u5728CMD\u4e2d\u8fdb\u5165\u5230target\u76ee\u5f55\uff0c\u7136\u540e\u8f93\u5165\uff1a</p> <pre><code>java -jar demo-0.0.1-SNAPSHOT.jar\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u4e86\uff1a</p> <p></p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u7684SpringBoot\u9879\u76ee\u5c31\u53ef\u4ee5\u5feb\u901f\u90e8\u7f72\u5230\u4efb\u4f55\u8ba1\u7b97\u673a\u4e86\uff0c\u53ea\u8981\u80fd\u591f\u5b89\u88c5JRE\u73af\u5883\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7\u547d\u4ee4\u4e00\u952e\u8fd0\u884c\u3002</p> <p>\u5f53\u7136\uff0c\u53ef\u80fd\u4e5f\u4f1a\u6709\u5c0f\u4f19\u4f34\u597d\u5947\uff0c\u600e\u4e48\u624d\u80fd\u50cf\u4e4b\u524d\u4e00\u6837\u5728\u6211\u4eec\u7684Tomcat\u670d\u52a1\u5668\u4e2d\u8fd0\u884c\u5462\uff1f\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u5176\u6253\u5305\u4e3aWar\u5305\u7684\u5f62\u5f0f\u90e8\u7f72\u5230\u6211\u4eec\u81ea\u5df1\u73af\u5883\u4e2d\u7684Tomcat\u670d\u52a1\u5668\u6216\u662f\u5176\u4ed6\u4efb\u4f55\u652f\u6301Servlet\u7684\u670d\u52a1\u5668\u4e2d\uff0c\u4f46\u662f\u8fd9\u79cd\u505a\u6cd5\u76f8\u5bf9\u6bd4\u8f83\u590d\u6742\uff0c\u4e0d\u592a\u63a8\u8350\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u884c\u9879\u76ee\u90e8\u7f72\uff0c\u4e0d\u8fc7\u6211\u4eec\u8fd9\u91cc\u8fd8\u662f\u4ecb\u7ecd\u4e00\u4e0b\u3002</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u6392\u9664\u6389<code>spring-boot-starter-web</code>\u4e2d\u81ea\u5e26\u7684Tomcat\u670d\u52a1\u5668\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n       &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n       &lt;exclusions&gt;\n          &lt;exclusion&gt;\n             &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n             &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n          &lt;/exclusion&gt;\n       &lt;/exclusions&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7136\u540e\u81ea\u884c\u6dfb\u52a0Servlet\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n   &lt;groupId&gt;jakarta.servlet&lt;/groupId&gt;\n   &lt;artifactId&gt;jakarta.servlet-api&lt;/artifactId&gt;\n   &lt;scope&gt;provided&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6700\u540e\u5c06\u6253\u5305\u65b9\u5f0f\u4fee\u6539\u4e3awar\u5305\uff1a</p> <pre><code>&lt;packaging&gt;war&lt;/packaging&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u4fee\u6539\u4e3b\u7c7b\uff0c\u5c06\u5176\u7ee7\u627fSpringBoot\u9700\u8981\u7684Initializer\uff08\u53c8\u56de\u5230SSM\u9636\u6bb5\u90a3\u70e6\u4eba\u7684\u914d\u7f6e\u4e86\uff0c\u6240\u4ee5\u8bf4\u4e00\u70b9\u4e0d\u63a8\u8350\u8fd9\u79cd\u90e8\u7f72\u65b9\u5f0f\uff09</p> <pre><code>@SpringBootApplication\npublic class DemoApplication extends SpringBootServletInitializer {  //\u7ee7\u627f\u4e13\u7528\u7684\u521d\u59cb\u5316\u5668\n    public static void main(String[] args) {\n        SpringApplication.run(DemoApplication.class, args);\n    }\n\n    //\u91cd\u5199configure\u65b9\u6cd5\uff0c\u5b8c\u6210\u542f\u52a8\u7c7b\u914d\u7f6e\n    @Override\n    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {\n        return builder.sources(DemoApplication.class);\n    }\n}\n</code></pre> <p>\u6700\u540e\uff0c\u6211\u4eec\u518d\u6b21\u8fd0\u884cMaven \u7684package\u6307\u4ee4\u5c31\u53ef\u4ee5\u6253\u5305\u4e3awar\u5305\u4e86\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u90e8\u7f72\u5230Tomcat\u670d\u52a1\u5668\u4e2d\uff08\u5982\u4f55\u90e8\u7f72\u5df2\u7ecf\u5728JavaWeb\u7bc7\u4ecb\u7ecd\u8fc7\u4e86\uff09</p> <p></p> <p>\u63a5\u7740\u542f\u52a8\u670d\u52a1\u5668\u5c31\u80fd\u6b63\u5e38\u8bbf\u95ee\u4e86\uff1a</p> <p></p> <p></p> <p>\u5982\u679c\u5404\u4f4d\u5c0f\u4f19\u4f34\u9700\u8981\u5728IDEA\u4e2d\u8fdb\u884c\u8c03\u8bd5\u8fd0\u884c\uff0c\u6211\u4eec\u9700\u8981\u50cf\u4e4b\u524d\u4e00\u6837\u914d\u7f6e\u4e00\u4e2aTomcat\u8fd0\u884c\u73af\u5883\uff1a</p> <p></p> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u8ddf\u4e4b\u524d\u4e00\u6837\u4f7f\u7528\u5916\u90e8Tomcat\u670d\u52a1\u5668\u4e86\uff1a</p> <p></p> <p>\u6700\u540e\uff0c\u6211\u4eec\u9700\u8981\u7279\u522b\u4ecb\u7ecd\u4e00\u4e0b\u65b0\u7684\u7279\u6027\uff0c\u5728SpringBoot3\u4e4b\u540e\uff0c\u7279\u522b\u5bf9GraalVM\u8fdb\u884c\u4e86\u652f\u6301\uff1a</p> <p>GraalVM \u662f\u4e00\u79cd\u901a\u7528\u7684\u865a\u62df\u673a\uff0c\u6700\u521d\u7531 Oracle \u5f00\u53d1\u3002\u5b83\u652f\u6301\u591a\u79cd\u7f16\u7a0b\u8bed\u8a00\uff08\u4f8b\u5982 Java\u3001JavaScript\u3001Python \u7b49\uff09\uff0c\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u5e76\u63d0\u4f9b\u9ad8\u6027\u80fd\u548c\u4f4e\u5185\u5b58\u6d88\u8017\u3002</p> <p>GraalVM\u7684\u6838\u5fc3\u662f\u4e00\u4e2a\u5373\u65f6\u7f16\u8bd1\u5668\uff0c\u5b83\u80fd\u591f\u5c06\u5404\u79cd\u8bed\u8a00\u7684\u4ee3\u7801\u76f4\u63a5\u7f16\u8bd1\u6210\u672c\u5730\u673a\u5668\u7801\uff0c\u4ee5\u83b7\u5f97\u66f4\u9ad8\u7684\u6027\u80fd\u3002\u6b64\u5916\uff0cGraalVM \u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f3a\u5927\u7684\u8fd0\u884c\u65f6\u73af\u5883\uff0c\u5305\u62ec\u5783\u573e\u56de\u6536\u5668\u3001\u5373\u65f6\u7f16\u8bd1\u5668\u3001\u7ebf\u7a0b\u7ba1\u7406\u5668\u7b49\uff0c\u53ef\u4ee5\u63d0\u4f9b\u66f4\u597d\u7684\u6027\u80fd\u548c\u53ef\u6269\u5c55\u6027\u3002</p> <p>GraalVM \u7684\u4e00\u4e2a\u91cd\u8981\u7279\u6027\u662f\u5b83\u7684\u8de8\u8bed\u8a00\u4e92\u64cd\u4f5c\u6027\u3002GraalVM \u53ef\u4ee5\u4f7f\u4e0d\u540c\u8bed\u8a00\u4e4b\u95f4\u7684\u4e92\u64cd\u4f5c\u66f4\u52a0\u5bb9\u6613\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u5728 Java \u4ee3\u7801\u4e2d\u76f4\u63a5\u8c03\u7528 JavaScript \u51fd\u6570\uff0c\u6216\u8005\u5728 JavaScript \u4ee3\u7801\u4e2d\u76f4\u63a5\u8c03\u7528 Java \u7c7b\u3002\u8fd9\u4f7f\u5f97\u5728\u4e0d\u540c\u8bed\u8a00\u4e4b\u95f4\u5171\u4eab\u548c\u590d\u7528\u4ee3\u7801\u53d8\u5f97\u66f4\u52a0\u5bb9\u6613\u3002</p> <p>\u603b\u7684\u6765\u8bf4\uff0cGraalVM \u662f\u4e00\u4e2a\u5f00\u521b\u6027\u7684\u6280\u672f\uff0c\u53ef\u4ee5\u63d0\u4f9b\u51fa\u8272\u7684\u6027\u80fd\u548c\u7075\u6d3b\u6027\uff0c\u540c\u65f6\u4e5f\u4e3a\u591a\u8bed\u8a00\u5f00\u53d1\u63d0\u4f9b\u4e86\u66f4\u597d\u7684\u652f\u6301\u3002\u5b83\u662f\u4e00\u4e2a\u975e\u5e38\u6709\u6f5c\u529b\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u7528\u4e8e\u6784\u5efa\u9ad8\u6548\u7684\u5e94\u7528\u7a0b\u5e8f\u548c\u89e3\u51b3\u65b9\u6848\u3002</p> <p></p> <p>\u7b80\u800c\u8a00\u4e4b\uff0c\u6211\u4eec\u7684SpringBoot\u9879\u76ee\u9664\u4e86\u6253\u5305\u4e3a\u4f20\u7edf\u7684Jar\u5305\u57fa\u4e8eJVM\u8fd0\u884c\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u5176\u76f4\u63a5\u7f16\u8bd1\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u539f\u751f\u7684\u7a0b\u5e8f\u6765\u8fdb\u884c\u4f7f\u7528\uff08\u8fd9\u6837\u4f1a\u5927\u5e45\u63d0\u5347\u7a0b\u5e8f\u7684\u8fd0\u884c\u6548\u7387\uff0c\u4f46\u662f\u7531\u4e8e\u7f16\u8bd1\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u539f\u751f\u7a0b\u5e8f\uff0c\u8fd9\u5c06\u65e0\u6cd5\u652f\u6301\u8de8\u5e73\u53f0\uff09</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u5b89\u88c5GraalVM\u7684\u73af\u5883\u624d\u53ef\u4ee5\uff0c\u8fd9\u8ddf\u5b89\u88c5\u666e\u901aJDK\u7684\u64cd\u4f5c\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/graalvm/graalvm-ce-builds/releases/tag/jdk-17.0.7</p> <p></p> <p>\u4e0b\u8f7d\u597d\u5bf9\u5e94\u7cfb\u7edf\u67b6\u6784\u7684GraalVM\u73af\u5883\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5b89\u88c5\u90e8\u7f72\u4e86\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u4e3aGraalVM\u914d\u7f6e\u73af\u5883\u53d8\u91cf\uff0c\u5c06GRAALVM_HOME\u4f5c\u4e3a\u73af\u5883\u53d8\u91cf\u6307\u5411\u4f60\u7684\u5b89\u88c5\u76ee\u5f55\u7684bin\u76ee\u5f55\u4e0b\uff0c\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u8fdb\u884c\u6253\u5305\u4e86\uff08\u6ce8\u610f\uff0cSpringBoot\u9879\u76ee\u5fc5\u987b\u5728\u521b\u5efa\u7684\u65f6\u5019\u6dfb\u52a0\u4e86Native\u652f\u6301\u624d\u53ef\u4ee5\uff0c\u5426\u5219\u65e0\u6cd5\u6b63\u5e38\u6253\u5305\uff09</p> <p>\u6ce8\u610f\uff0c\u4e00\u5b9a\u8981\u5c06<code>GRAALVM_HOME</code>\u914d\u7f6e\u5230\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u5426\u5219\u4f1a\u62a5\u9519\uff1a</p> <p></p> <p>\u4e00\u5207\u65e0\u8bef\u540e\uff0c\u6211\u4eec\u76f4\u63a5\u5728IDEA\u4e2d\u6216\u662f\u547d\u4ee4\u884c\u4e2d\u8f93\u5165\uff1a</p> <pre><code>mvn -Pnative -DskipTests native:compile\n</code></pre> <p>\u63a5\u7740\u4f1a\u81ea\u52a8\u5b89\u88c5<code>native-image</code>\u7ec4\u4ef6\uff0c\u7136\u540e\u8fdb\u884c\u672c\u5730\u955c\u50cf\u7684\u7f16\u8bd1\uff08\u5efa\u8bae\u6302\u68af\uff0c\u4e0d\u7136\u5361\u4e00\u5929\u90fd\u4e0b\u4e0d\u52a8\uff09</p> <p></p> <p>\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u6bd4\u8f83\u6d88\u8017\u8d44\u6e90\uff0c\u5efa\u8baeCPU\u9009\u62e96\u6838\u53ca\u4ee5\u4e0a\uff0c\u4e0d\u7136\u901f\u5ea6\u4f1a\u5f88\u6162\uff0c\u7f16\u8bd1\u5b8c\u6210\u4e4b\u540e\u5982\u4e0b\u56fe\uff1a</p> <p></p> <p>\u8fd9\u6837\u4e00\u4e2a\u7cfb\u7edf\u539f\u751f\u7684SpringBoot\u9879\u76ee\u5c31\u6253\u5305\u597d\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u8fd9\u4e2a\u7a0b\u5e8f\uff1a</p> <p></p> <p>\u4e0d\u8fc7\u7531\u4e8eMybatis\u76ee\u524d\u4e0d\u652f\u6301Native-Image\uff0c\u6240\u4ee5\u53ea\u80fd\u671f\u5f85\u6709\u671d\u4e00\u65e5\u8fd9\u4e9b\u6846\u67b6\u90fd\u80fd\u591f\u5b8c\u6574\u652f\u6301\u539f\u751f\u955c\u50cf\uff0c\u8ba9\u6211\u4eec\u7684\u7a0b\u5e8f\u8fd0\u884c\u6548\u7387\u66f4\u4e0a\u4e00\u5c42\u697c\u3002</p> <p>\u81f3\u6b64\uff0c\u5173\u4e8eSpringBoot\u7684\u5feb\u901f\u4e0a\u624b\u6559\u7a0b\u5c31\u5168\u90e8\u7ed3\u675f\u4e86\uff0c\u5176\u5b9e\u53ea\u8981SSM\u9636\u6bb5\u5b66\u7684\u624e\u5b9e\uff0c\u5230\u4e86Boot\u9636\u6bb5\u4e4b\u540e\u4e5f\u662f\u8f7b\u8f7b\u677e\u677e\uff0c\u4e0b\u4e00\u90e8\u5206\u6211\u4eec\u5c06\u9686\u91cd\u4ecb\u7ecd\u4e00\u4e0bSpringBoot\u7684\u65e5\u5fd7\u6a21\u5757\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_7","title":"\u65e5\u5fd7\u7cfb\u7edf\u4ecb\u7ecd","text":"<p>SpringBoot\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u65e5\u5fd7\u7cfb\u7edf\uff0c\u5b83\u51e0\u4e4e\u662f\u5f00\u7bb1\u5373\u7528\u7684\u3002\u6211\u4eec\u5728\u4e4b\u524d\u5b66\u4e60SSM\u65f6\uff0c\u5982\u679c\u4e0d\u914d\u7f6e\u65e5\u5fd7\uff0c\u5c31\u4f1a\u62a5\u9519\uff0c\u4f46\u662f\u5230\u4e86SpringBoot\u9636\u6bb5\u4e4b\u540e\u4f3c\u4e4e\u8fd9\u4e2a\u95ee\u9898\u5c31\u4e0d\u89c1\u4e86\uff0c\u65e5\u5fd7\u6253\u5370\u5f97\u4e5f\u975e\u5e38\u7edf\u4e00\uff0c\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_8","title":"\u65e5\u5fd7\u95e8\u9762\u548c\u65e5\u5fd7\u5b9e\u73b0","text":"<p>\u6211\u4eec\u9996\u5148\u8981\u533a\u5206\u4e00\u4e0b\uff0c\u4ec0\u4e48\u662f\u65e5\u5fd7\u95e8\u9762\uff08Facade\uff09\u4ec0\u4e48\u662f\u65e5\u5fd7\u5b9e\u73b0\uff0c\u6211\u4eec\u4e4b\u524d\u5b66\u4e60\u7684JUL\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u79cd\u65e5\u5fd7\u5b9e\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528JUL\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u65e5\u5fd7\u6846\u67b6\u6765\u89c4\u8303\u5316\u6253\u5370\u65e5\u5fd7\u3002</p> <p>\u800c\u65e5\u5fd7\u95e8\u9762\uff0c\u5982Slf4j\uff0c\u662f\u628a\u4e0d\u540c\u7684\u65e5\u5fd7\u7cfb\u7edf\u7684\u5b9e\u73b0\u8fdb\u884c\u4e86\u5177\u4f53\u7684\u62bd\u8c61\u5316\uff0c\u53ea\u63d0\u4f9b\u4e86\u7edf\u4e00\u7684\u65e5\u5fd7\u4f7f\u7528\u63a5\u53e3\uff0c\u4f7f\u7528\u65f6\u53ea\u9700\u8981\u6309\u7167\u5176\u63d0\u4f9b\u7684\u63a5\u53e3\u65b9\u6cd5\u8fdb\u884c\u8c03\u7528\u5373\u53ef\uff0c\u7531\u4e8e\u5b83\u53ea\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u5e76\u4e0d\u662f\u4e00\u4e2a\u5177\u4f53\u7684\u53ef\u4ee5\u76f4\u63a5\u5355\u72ec\u4f7f\u7528\u7684\u65e5\u5fd7\u6846\u67b6\uff0c\u6240\u4ee5\u6700\u7ec8\u65e5\u5fd7\u7684\u683c\u5f0f\u3001\u8bb0\u5f55\u7ea7\u522b\u3001\u8f93\u51fa\u65b9\u5f0f\u7b49\u90fd\u8981\u901a\u8fc7\u63a5\u53e3\u7ed1\u5b9a\u7684\u5177\u4f53\u7684\u65e5\u5fd7\u7cfb\u7edf\u6765\u5b9e\u73b0\uff0c\u8fd9\u4e9b\u5177\u4f53\u7684\u65e5\u5fd7\u7cfb\u7edf\u5c31\u6709log4j\u3001logback\u3001java.util.logging\u7b49\uff0c\u5b83\u4eec\u624d\u5b9e\u73b0\u4e86\u5177\u4f53\u7684\u65e5\u5fd7\u7cfb\u7edf\u7684\u529f\u80fd\u3002</p> <p>\u65e5\u5fd7\u95e8\u9762\u548c\u65e5\u5fd7\u5b9e\u73b0\u5c31\u50cfJDBC\u548c\u6570\u636e\u5e93\u9a71\u52a8\u4e00\u6837\uff0c\u4e00\u4e2a\u662f\u753b\u5927\u997c\u7684\uff0c\u4e00\u4e2a\u662f\u771f\u7684\u53bb\u505a\u997c\u7684\u3002</p> <p></p> <p>\u4f46\u662f\u73b0\u5728\u6709\u4e00\u4e2a\u95ee\u9898\u5c31\u662f\uff0c\u4e0d\u540c\u7684\u6846\u67b6\u53ef\u80fd\u4f7f\u7528\u4e86\u4e0d\u540c\u7684\u65e5\u5fd7\u6846\u67b6\uff0c\u5982\u679c\u8fd9\u4e2a\u65f6\u5019\u51fa\u73b0\u4f17\u591a\u65e5\u5fd7\u6846\u67b6\u5e76\u5b58\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u73b0\u5728\u5e0c\u671b\u7684\u662f\u6240\u6709\u7684\u6846\u67b6\u4e00\u5f8b\u4f7f\u7528\u65e5\u5fd7\u95e8\u9762\uff08Slf4j\uff09\u8fdb\u884c\u65e5\u5fd7\u6253\u5370\uff0c\u8fd9\u65f6\u8be5\u600e\u4e48\u53bb\u89e3\u51b3\uff1f\u6211\u4eec\u4e0d\u53ef\u80fd\u5c06\u5176\u4ed6\u6846\u67b6\u4f9d\u8d56\u7684\u65e5\u5fd7\u6846\u67b6\u66ff\u6362\u6389\uff0c\u76f4\u63a5\u66f4\u6362\u4e3aSlf4j\u5427\uff0c\u8fd9\u6837\u663e\u7136\u4e0d\u73b0\u5b9e\u3002</p> <p>\u8fd9\u65f6\uff0c\u53ef\u4ee5\u91c7\u53d6\u7c7b\u4f3c\u4e8e\u5077\u6881\u6362\u67f1\u7684\u505a\u6cd5\uff0c\u53ea\u4fdd\u7559\u4e0d\u540c\u65e5\u5fd7\u6846\u67b6\u7684\u63a5\u53e3\u548c\u7c7b\u5b9a\u4e49\u7b49\u5173\u952e\u4fe1\u606f\uff0c\u800c\u5c06\u5b9e\u73b0\u5168\u90e8\u5b9a\u5411\u4e3aSlf4j\u8c03\u7528\u3002\u76f8\u5f53\u4e8e\u6709\u7740\u548c\u539f\u6709\u65e5\u5fd7\u6846\u67b6\u4e00\u6837\u7684\u5916\u58f3\uff0c\u5bf9\u4e8e\u5176\u4ed6\u6846\u67b6\u6765\u8bf4\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u5bf9\u5e94\u7684\u7c7b\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u5177\u4f53\u5982\u4f55\u6267\u884c\uff0c\u771f\u6b63\u7684\u5185\u5fc3\u5df2\u7ecf\u662fSlf4j\u7684\u4e86\u3002</p> <p></p> <p>\u6240\u4ee5\uff0cSpringBoot\u4e3a\u4e86\u7edf\u4e00\u65e5\u5fd7\u6846\u67b6\u7684\u4f7f\u7528\uff0c\u505a\u4e86\u8fd9\u4e9b\u4e8b\u60c5\uff1a</p> <ul> <li>\u76f4\u63a5\u5c06\u5176\u4ed6\u4f9d\u8d56\u4ee5\u524d\u7684\u65e5\u5fd7\u6846\u67b6\u5254\u9664</li> <li>\u5bfc\u5165\u5bf9\u5e94\u65e5\u5fd7\u6846\u67b6\u7684Slf4j\u4e2d\u95f4\u5305</li> <li>\u5bfc\u5165\u81ea\u5df1\u5b98\u65b9\u6307\u5b9a\u7684\u65e5\u5fd7\u5b9e\u73b0\uff0c\u5e76\u4f5c\u4e3aSlf4j\u7684\u65e5\u5fd7\u5b9e\u73b0\u5c42</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_9","title":"\u6253\u5370\u9879\u76ee\u65e5\u5fd7\u4fe1\u606f","text":"<p>SpringBoot\u4f7f\u7528\u7684\u662fSlf4j\u4f5c\u4e3a\u65e5\u5fd7\u95e8\u9762\uff0cLogback\uff08Logback \u662flog4j \u6846\u67b6\u7684\u4f5c\u8005\u5f00\u53d1\u7684\u65b0\u4e00\u4ee3\u65e5\u5fd7\u6846\u67b6\uff0c\u5b83\u6548\u7387\u66f4\u9ad8\u3001\u80fd\u591f\u9002\u5e94\u8bf8\u591a\u7684\u8fd0\u884c\u73af\u5883\uff0c\u540c\u65f6\u5929\u7136\u652f\u6301SLF4J\uff09\u4f5c\u4e3a\u65e5\u5fd7\u5b9e\u73b0\uff0c\u5bf9\u5e94\u7684\u4f9d\u8d56\u4e3a\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6b64\u4f9d\u8d56\u5df2\u7ecf\u88ab\u5305\u542b\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u5982\u679c\u9700\u8981\u6253\u5370\u65e5\u5fd7\uff0c\u53ef\u4ee5\u50cf\u8fd9\u6837\uff1a</p> <pre><code>@ResponseBody\n@GetMapping(\"/test\")\npublic User test(){\n    Logger logger = LoggerFactory.getLogger(TestController.class); // \u5bfc\u5165org.slf4j\n    logger.info(\"\u7528\u6237\u8bbf\u95ee\u4e86\u4e00\u6b21\u6d4b\u8bd5\u6570\u636e\");\n    return mapper.findUserById(1);\n}\n</code></pre> <p>\u56e0\u4e3a\u6211\u4eec\u4f7f\u7528\u4e86Lombok\uff0c\u6240\u4ee5\u76f4\u63a5\u4e00\u4e2a\u6ce8\u89e3\u4e5f\u53ef\u4ee5\u641e\u5b9a\u54e6\uff1a</p> <pre><code>@Slf4j\n@Controller\npublic class MainController {\n\n    @ResponseBody\n        @GetMapping(\"/test\")\n    public User test(){\n            log.info(\"\u7528\u6237\u8bbf\u95ee\u4e86\u4e00\u6b21\u6d4b\u8bd5\u6570\u636e\");\n            return mapper.findUserById(1);\n        }\n\n    ...\n</code></pre> <p>\u65e5\u5fd7\u7ea7\u522b\u4ece\u4f4e\u5230\u9ad8\u5206\u4e3aTRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL\uff0cSpringBoot\u9ed8\u8ba4\u53ea\u4f1a\u6253\u5370INFO\u4ee5\u4e0a\u7ea7\u522b\u7684\u4fe1\u606f\uff0c\u6548\u679c\u5982\u4e0b\uff0c\u4e5f\u662f\u4f7f\u7528\u540c\u6837\u7684\u683c\u5f0f\u6253\u5370\u5728\u63a7\u5236\u53f0\u7684\uff1a</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#logback","title":"\u914d\u7f6eLogback\u65e5\u5fd7","text":"<p>Logback\u5b98\u7f51\uff1ahttps://logback.qos.ch</p> <p>\u548cJUL\u4e00\u6837\uff0cLogback\u4e5f\u80fd\u5b9e\u73b0\u5b9a\u5236\u5316\uff0c\u6211\u4eec\u53ef\u4ee5\u7f16\u5199\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff0cSpringBoot\u63a8\u8350\u5c06\u914d\u7f6e\u6587\u4ef6\u540d\u79f0\u547d\u540d\u4e3a<code>logback-spring.xml</code>\u8868\u793a\u8fd9\u662fSpringBoot\u4e0bLogback\u4e13\u7528\u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u4f7f\u7528SpringBoot \u7684\u9ad8\u7ea7Pro\ufb01le\u529f\u80fd\uff0c\u5b83\u7684\u5185\u5bb9\u7c7b\u4f3c\u4e8e\u8fd9\u6837\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration&gt;\n    &lt;!-- \u914d\u7f6e --&gt;\n&lt;/configuration&gt;\n</code></pre> <p>\u6700\u5916\u5c42\u7531<code>configuration</code>\u5305\u88f9\uff0c\u4e00\u65e6\u7f16\u5199\uff0c\u90a3\u4e48\u5c31\u4f1a\u66ff\u6362\u9ed8\u8ba4\u7684\u914d\u7f6e\uff0c\u6240\u4ee5\u5982\u679c\u5185\u90e8\u4ec0\u4e48\u90fd\u4e0d\u5199\u7684\u8bdd\uff0c\u90a3\u4e48\u4f1a\u5bfc\u81f4\u6211\u4eec\u7684SpringBoot\u9879\u76ee\u6ca1\u6709\u914d\u7f6e\u4efb\u4f55\u65e5\u5fd7\u8f93\u51fa\u65b9\u5f0f\uff0c\u63a7\u5236\u53f0\u4e5f\u4e0d\u4f1a\u6253\u5370\u65e5\u5fd7\u3002</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u5982\u4f55\u914d\u7f6e\u4e00\u4e2a\u63a7\u5236\u53f0\u65e5\u5fd7\u6253\u5370\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5bfc\u5165\u5e76\u4f7f\u7528SpringBoot\u4e3a\u6211\u4eec\u9884\u8bbe\u597d\u7684\u65e5\u5fd7\u683c\u5f0f\uff0c\u5728<code>org/springframework/boot/logging/logback/defaults.xml</code>\u4e2d\u5df2\u7ecf\u5e2e\u6211\u4eec\u628a\u65e5\u5fd7\u7684\u8f93\u51fa\u683c\u5f0f\u5b9a\u4e49\u597d\u4e86\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8bbe\u7f6e\u5bf9\u5e94\u7684<code>appender</code>\u5373\u53ef\uff1a</p> <pre><code>&lt;included&gt;\n   &lt;conversionRule conversionWord=\"clr\" converterClass=\"org.springframework.boot.logging.logback.ColorConverter\" /&gt;\n   &lt;conversionRule conversionWord=\"wex\" converterClass=\"org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter\" /&gt;\n   &lt;conversionRule conversionWord=\"wEx\" converterClass=\"org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter\" /&gt;\n\n   &lt;property name=\"CONSOLE_LOG_PATTERN\" value=\"${CONSOLE_LOG_PATTERN:-%clr(%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}\"/&gt;\n   &lt;property name=\"CONSOLE_LOG_CHARSET\" value=\"${CONSOLE_LOG_CHARSET:-${file.encoding:-UTF-8}}\"/&gt;\n   &lt;property name=\"FILE_LOG_PATTERN\" value=\"${FILE_LOG_PATTERN:-%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}} ${LOG_LEVEL_PATTERN:-%5p} ${PID:- } --- [%t] %-40.40logger{39} : %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}\"/&gt;\n   &lt;property name=\"FILE_LOG_CHARSET\" value=\"${FILE_LOG_CHARSET:-${file.encoding:-UTF-8}}\"/&gt;\n\n   &lt;logger name=\"org.apache.catalina.startup.DigesterFactory\" level=\"ERROR\"/&gt;\n   &lt;logger name=\"org.apache.catalina.util.LifecycleBase\" level=\"ERROR\"/&gt;\n   &lt;logger name=\"org.apache.coyote.http11.Http11NioProtocol\" level=\"WARN\"/&gt;\n   &lt;logger name=\"org.apache.sshd.common.util.SecurityUtils\" level=\"WARN\"/&gt;\n   &lt;logger name=\"org.apache.tomcat.util.net.NioSelectorPool\" level=\"WARN\"/&gt;\n   &lt;logger name=\"org.eclipse.jetty.util.component.AbstractLifeCycle\" level=\"ERROR\"/&gt;\n   &lt;logger name=\"org.hibernate.validator.internal.util.Version\" level=\"WARN\"/&gt;\n   &lt;logger name=\"org.springframework.boot.actuate.endpoint.jmx\" level=\"WARN\"/&gt;\n&lt;/included&gt;\n</code></pre> <p>\u5bfc\u5165\u540e\uff0c\u6211\u4eec\u5229\u7528\u9884\u8bbe\u7684\u65e5\u5fd7\u683c\u5f0f\u521b\u5efa\u4e00\u4e2a\u63a7\u5236\u53f0\u65e5\u5fd7\u6253\u5370\uff1a</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;configuration&gt;\n    &lt;!--  \u5bfc\u5165\u5176\u4ed6\u914d\u7f6e\u6587\u4ef6\uff0c\u4f5c\u4e3a\u9884\u8bbe  --&gt;\n    &lt;include resource=\"org/springframework/boot/logging/logback/defaults.xml\" /&gt;\n\n    &lt;!--  Appender\u4f5c\u4e3a\u65e5\u5fd7\u6253\u5370\u5668\u914d\u7f6e\uff0c\u8fd9\u91cc\u547d\u540d\u968f\u610f  --&gt;\n    &lt;!--  ch.qos.logback.core.ConsoleAppender\u662f\u4e13\u7528\u4e8e\u63a7\u5236\u53f0\u7684Appender  --&gt;\n    &lt;appender name=\"CONSOLE\" class=\"ch.qos.logback.core.ConsoleAppender\"&gt;\n        &lt;encoder&gt;\n            &lt;pattern&gt;${CONSOLE_LOG_PATTERN}&lt;/pattern&gt;\n            &lt;charset&gt;${CONSOLE_LOG_CHARSET}&lt;/charset&gt;\n        &lt;/encoder&gt;\n    &lt;/appender&gt;\n\n    &lt;!--  \u6307\u5b9a\u65e5\u5fd7\u8f93\u51fa\u7ea7\u522b\uff0c\u4ee5\u53ca\u542f\u7528\u7684Appender\uff0c\u8fd9\u91cc\u5c31\u4f7f\u7528\u4e86\u6211\u4eec\u4e0a\u9762\u7684ConsoleAppender  --&gt;\n    &lt;root level=\"INFO\"&gt;\n        &lt;appender-ref ref=\"CONSOLE\"/&gt;\n    &lt;/root&gt;\n&lt;/configuration&gt;\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u63a7\u5236\u53f0\u5df2\u7ecf\u53ef\u4ee5\u6b63\u5e38\u6253\u5370\u65e5\u5fd7\u4fe1\u606f\u4e86\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u5f00\u542f\u6587\u4ef6\u6253\u5370\uff0c\u6211\u4eec\u53ea\u9700\u8981\u914d\u7f6e\u4e00\u4e2a\u5bf9\u5e94\u7684Appender\u5373\u53ef\uff1a</p> <pre><code>&lt;!--  ch.qos.logback.core.rolling.RollingFileAppender\u7528\u4e8e\u6587\u4ef6\u65e5\u5fd7\u8bb0\u5f55\uff0c\u5b83\u652f\u6301\u6eda\u52a8  --&gt;\n&lt;appender name=\"FILE\" class=\"ch.qos.logback.core.rolling.RollingFileAppender\"&gt;\n    &lt;encoder&gt;\n        &lt;pattern&gt;${FILE_LOG_PATTERN}&lt;/pattern&gt;\n        &lt;charset&gt;${FILE_LOG_CHARSET}&lt;/charset&gt;\n    &lt;/encoder&gt;\n    &lt;!--  \u81ea\u5b9a\u4e49\u6eda\u52a8\u7b56\u7565\uff0c\u9632\u6b62\u65e5\u5fd7\u6587\u4ef6\u65e0\u9650\u53d8\u5927\uff0c\u4e5f\u5c31\u662f\u65e5\u5fd7\u6587\u4ef6\u5199\u5230\u4ec0\u4e48\u65f6\u5019\u4e3a\u6b62\uff0c\u91cd\u65b0\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u65e5\u5fd7\u6587\u4ef6\u5f00\u59cb\u5199  --&gt;\n    &lt;rollingPolicy class=\"ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy\"&gt;\n        &lt;!--  \u6587\u4ef6\u4fdd\u5b58\u4f4d\u7f6e\u4ee5\u53ca\u6587\u4ef6\u547d\u540d\u89c4\u5219\uff0c\u8fd9\u91cc\u7528\u5230\u4e86%d{yyyy-MM-dd}\u8868\u793a\u5f53\u524d\u65e5\u671f\uff0c%i\u8868\u793a\u8fd9\u4e00\u5929\u7684\u7b2cN\u4e2a\u65e5\u5fd7  --&gt;\n        &lt;FileNamePattern&gt;log/%d{yyyy-MM-dd}-spring-%i.log&lt;/FileNamePattern&gt;\n        &lt;!--  \u5230\u671f\u81ea\u52a8\u6e05\u7406\u65e5\u5fd7\u6587\u4ef6  --&gt;\n        &lt;cleanHistoryOnStart&gt;true&lt;/cleanHistoryOnStart&gt;\n        &lt;!--  \u6700\u5927\u65e5\u5fd7\u4fdd\u7559\u65f6\u95f4  --&gt;\n        &lt;maxHistory&gt;7&lt;/maxHistory&gt;\n        &lt;!--  \u6700\u5927\u5355\u4e2a\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f  --&gt;\n        &lt;maxFileSize&gt;10MB&lt;/maxFileSize&gt;\n    &lt;/rollingPolicy&gt;\n&lt;/appender&gt;\n\n&lt;!--  \u6307\u5b9a\u65e5\u5fd7\u8f93\u51fa\u7ea7\u522b\uff0c\u4ee5\u53ca\u542f\u7528\u7684Appender\uff0c\u8fd9\u91cc\u5c31\u4f7f\u7528\u4e86\u6211\u4eec\u4e0a\u9762\u7684ConsoleAppender  --&gt;\n&lt;root level=\"INFO\"&gt;\n    &lt;appender-ref ref=\"CONSOLE\"/&gt;\n    &lt;appender-ref ref=\"FILE\"/&gt;\n&lt;/root&gt;\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u65e5\u5fd7\u6587\u4ef6\u4e5f\u80fd\u81ea\u52a8\u751f\u6210\u4e86\u3002</p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u9b54\u6539\u5b98\u65b9\u63d0\u4f9b\u7684\u65e5\u5fd7\u683c\u5f0f\uff0c\u5b98\u65b9\u6587\u6863\uff1ahttps://logback.qos.ch/manual/layouts.html</p> <p>\u8fd9\u91cc\u9700\u8981\u63d0\u53ca\u7684\u662fMDC\u673a\u5236\uff0cLogback\u5185\u7f6e\u7684\u65e5\u5fd7\u5b57\u6bb5\u8fd8\u662f\u6bd4\u8f83\u5c11\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u6253\u5370\u6709\u5173\u4e1a\u52a1\u7684\u66f4\u591a\u7684\u5185\u5bb9\uff0c\u5305\u62ec\u81ea\u5b9a\u4e49\u7684\u4e00\u4e9b\u6570\u636e\uff0c\u9700\u8981\u501f\u52a9logback MDC\u673a\u5236\uff0cMDC\u4e3a\u201cMapped Diagnostic Context\u201d\uff08\u6620\u5c04\u8bca\u65ad\u4e0a\u4e0b\u6587\uff09\uff0c\u5373\u5c06\u4e00\u4e9b\u8fd0\u884c\u65f6\u7684\u4e0a\u4e0b\u6587\u6570\u636e\u901a\u8fc7logback\u6253\u5370\u51fa\u6765\uff1b\u6b64\u65f6\u6211\u4eec\u9700\u8981\u501f\u52a9org.sl4j.MDC\u7c7b\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u9700\u8981\u8bb0\u5f55\u662f\u54ea\u4e2a\u7528\u6237\u8bbf\u95ee\u6211\u4eec\u7f51\u7ad9\u7684\u65e5\u5fd7\uff0c\u53ea\u8981\u662f\u6b64\u7528\u6237\u8bbf\u95ee\u6211\u4eec\u7f51\u7ad9\uff0c\u90fd\u4f1a\u5728\u65e5\u5fd7\u4e2d\u643a\u5e26\u8be5\u7528\u6237\u7684ID\uff0c\u6211\u4eec\u5e0c\u671b\u6bcf\u6761\u65e5\u5fd7\u4e2d\u90fd\u643a\u5e26\u8fd9\u6837\u4e00\u6bb5\u4fe1\u606f\u6587\u672c\uff0c\u800c\u5b98\u65b9\u63d0\u4f9b\u7684\u5b57\u6bb5\u65e0\u6cd5\u5b9e\u73b0\u6b64\u529f\u80fd\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u4f7f\u7528MDC\u673a\u5236\uff1a</p> <pre><code>@ResponseBody\n@GetMapping(\"/test\")\npublic User test(HttpServletRequest request){\n   MDC.put(\"reqId\", request.getSession().getId());\n   log.info(\"\u7528\u6237\u8bbf\u95ee\u4e86\u4e00\u6b21\u6d4b\u8bd5\u6570\u636e\");\n   return mapper.findUserById(1);\n}\n</code></pre> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5411\u65e5\u5fd7\u4e2d\u4f20\u5165\u81ea\u5b9a\u4e49\u53c2\u6570\u4e86\uff0c\u6211\u4eec\u65e5\u5fd7\u4e2d\u6dfb\u52a0\u8fd9\u6837\u4e00\u4e2a\u5360\u4f4d\u7b26<code>%X{\u952e\u503c}</code>\uff0c\u540d\u5b57\u4fdd\u6301\u4e00\u81f4\uff1a</p> <pre><code>%clr([%X{reqId}]){faint} \n</code></pre> <p>\u8fd9\u6837\u5f53\u6211\u4eec\u5411MDC\u4e2d\u6dfb\u52a0\u4fe1\u606f\u540e\uff0c\u53ea\u8981\u662f\u5f53\u524d\u7ebf\u7a0b\uff08\u672c\u8d28\u662fThreadLocal\u5b9e\u73b0\uff09\u4e0b\u8f93\u51fa\u7684\u65e5\u5fd7\uff0c\u90fd\u4f1a\u81ea\u52a8\u66ff\u6362\u5360\u4f4d\u7b26\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#banner","title":"\u81ea\u5b9a\u4e49Banner\u5c55\u793a","text":"<p>\u6211\u4eec\u5728\u4e4b\u524d\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0aBanner\u90e8\u5206\u548c\u65e5\u5fd7\u90e8\u5206\u662f\u72ec\u7acb\u7684\uff0cSpringBoot\u542f\u52a8\u540e\uff0c\u4f1a\u5148\u6253\u5370Banner\u90e8\u5206\uff0c\u90a3\u4e48\u8fd9\u4e2aBanner\u90e8\u5206\u662f\u5426\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5462\uff1f\u7b54\u6848\u662f\u53ef\u4ee5\u7684\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6765\u914d\u7f6e\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a<code>banner.txt</code>\u7684\u6587\u672c\u6587\u6863\uff0c\u5185\u5bb9\u968f\u4fbf\u4f60\uff1a</p> <pre><code>//                          _ooOoo_                               //\n//                         o8888888o                              //\n//                         88\" . \"88                              //\n//                         (| ^_^ |)                              //\n//                         O\\  =  /O                              //\n//                      ____/`---'\\____                           //\n//                    .'  \\\\|     |//  `.                         //\n//                   /  \\\\|||  :  |||//  \\                        //\n//                  /  _||||| -:- |||||-  \\                       //\n//                  |   | \\\\\\  -  /// |   |                       //\n//                  | \\_|  ''\\---/''  |   |                       //\n//                  \\  .-\\__  `-`  ___/-. /                       //\n//                ___`. .'  /--.--\\  `. . ___                     //\n//              .\"\" '&lt;  `.___\\_&lt;|&gt;_/___.'  &gt;'\"\".                  //\n//            | | :  `- \\`.;`\\ _ /`;.`/ - ` : | |                 //\n//            \\  \\ `-.   \\_ __\\ /__ _/   .-` /  /                 //\n//      ========`-.____`-.___\\_____/___.-`____.-'========         //\n//                           `=---='                              //\n//      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^        //\n//             \u4f5b\u7956\u4fdd\u4f51          \u6c38\u65e0BUG         \u6c38\u4e0d\u4fee\u6539             //\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebf\u751f\u6210\u7f51\u7ad9\u8fdb\u884c\u751f\u6210\u81ea\u5df1\u7684\u4e2a\u6027Banner\uff1ahttps://www.bootschool.net/ascii</p> <p>\u6211\u4eec\u751a\u81f3\u8fd8\u53ef\u4ee5\u4f7f\u7528\u989c\u8272\u4ee3\u7801\u6765\u4e3a\u6587\u672c\u5207\u6362\u989c\u8272\uff1a</p> <pre><code>${AnsiColor.BRIGHT_GREEN}  //\u7eff\u8272\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u83b7\u53d6\u4e00\u4e9b\u5e38\u7528\u7684\u53d8\u91cf\u4fe1\u606f\uff1a</p> <pre><code>${AnsiColor.YELLOW} \u5f53\u524d Spring Boot \u7248\u672c\uff1a${spring-boot.version}\n</code></pre> <p>\u524d\u9762\u5fd8\u4e86\uff0c\u540e\u9762\u5fd8\u4e86\uff0c\u72e0\u72e0\u8d5a\u4e00\u7b14\uff01</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_10","title":"\u591a\u73af\u5883\u914d\u7f6e","text":"<p>\u5728\u65e5\u5e38\u5f00\u53d1\u4e2d\uff0c\u6211\u4eec\u9879\u76ee\u4f1a\u6709\u591a\u4e2a\u73af\u5883\u3002\u4f8b\u5982\u5f00\u53d1\u73af\u5883\uff08develop\uff09\u4e5f\u5c31\u662f\u6211\u4eec\u7814\u53d1\u8fc7\u7a0b\u4e2d\u75af\u72c2\u6572\u4ee3\u7801\u4feeBUG\u9636\u6bb5\uff0c\u751f\u4ea7\u73af\u5883\uff08production \uff09\u9879\u76ee\u5f00\u53d1\u5f97\u5dee\u4e0d\u591a\u4e86\uff0c\u53ef\u4ee5\u653e\u5728\u670d\u52a1\u5668\u4e0a\u8dd1\u4e86\u3002\u4e0d\u540c\u7684\u73af\u5883\u4e0b\uff0c\u53ef\u80fd\u6211\u4eec\u7684\u914d\u7f6e\u6587\u4ef6\u4e5f\u5b58\u5728\u4e0d\u540c\uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u53ef\u80fd\u5207\u6362\u73af\u5883\u7684\u65f6\u5019\u53c8\u53bb\u91cd\u65b0\u5199\u4e00\u6b21\u914d\u7f6e\u6587\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u591a\u4e2a\u73af\u5883\u7684\u914d\u7f6e\u6587\u4ef6\u63d0\u524d\u5199\u597d\uff0c\u8fdb\u884c\u81ea\u7531\u5207\u6362\u3002</p> <p>\u7531\u4e8eSpringBoot\u53ea\u4f1a\u8bfb\u53d6<code>application.properties</code>\u6216\u662f<code>application.yml</code>\u6587\u4ef6\uff0c\u90a3\u4e48\u600e\u4e48\u624d\u80fd\u5b9e\u73b0\u81ea\u7531\u5207\u6362\u5462\uff1fSpringBoot\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u6307\u5b9a\uff1a</p> <pre><code>spring:\n  profiles:\n    active: dev\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5206\u522b\u521b\u5efa\u4e24\u4e2a\u73af\u5883\u7684\u914d\u7f6e\u6587\u4ef6\uff0c<code>application-dev.yml</code>\u548c<code>application-prod.yml</code>\u5206\u522b\u8868\u793a\u5f00\u53d1\u73af\u5883\u548c\u751f\u4ea7\u73af\u5883\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u6bd4\u5982\u5f00\u53d1\u73af\u5883\u6211\u4eec\u4f7f\u7528\u7684\u670d\u52a1\u5668\u7aef\u53e3\u4e3a8080\uff0c\u800c\u751f\u4ea7\u73af\u5883\u4e0b\u53ef\u80fd\u5c31\u9700\u8981\u8bbe\u7f6e\u4e3a80\u6216\u662f443\u7aef\u53e3\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u4e0d\u540c\u73af\u5883\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u533a\u5206\uff1a</p> <pre><code>server:\n  port: 8080\n</code></pre> <pre><code>server:\n  port: 80\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u7075\u6d3b\u5207\u6362\u751f\u4ea7\u73af\u5883\u548c\u5f00\u53d1\u73af\u5883\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u4e86\u3002</p> <p>SpringBoot\u81ea\u5e26\u7684Logback\u65e5\u5fd7\u7cfb\u7edf\u4e5f\u662f\u652f\u6301\u591a\u73af\u5883\u914d\u7f6e\u7684\uff0c\u6bd4\u5982\u6211\u4eec\u60f3\u5728\u5f00\u53d1\u73af\u5883\u4e0b\u8f93\u51fa\u65e5\u5fd7\u5230\u63a7\u5236\u53f0\uff0c\u800c\u751f\u4ea7\u73af\u5883\u4e0b\u53ea\u9700\u8981\u8f93\u51fa\u5230\u6587\u4ef6\u5373\u53ef\uff0c\u8fd9\u65f6\u5c31\u9700\u8981\u8fdb\u884c\u73af\u5883\u914d\u7f6e\uff1a</p> <pre><code>&lt;springProfile name=\"dev\"&gt;\n    &lt;root level=\"INFO\"&gt;\n        &lt;appender-ref ref=\"CONSOLE\"/&gt;\n        &lt;appender-ref ref=\"FILE\"/&gt;\n    &lt;/root&gt;\n&lt;/springProfile&gt;\n\n&lt;springProfile name=\"prod\"&gt;\n    &lt;root level=\"INFO\"&gt;\n        &lt;appender-ref ref=\"FILE\"/&gt;\n    &lt;/root&gt;\n&lt;/springProfile&gt;\n</code></pre> <p>\u6ce8\u610f<code>springProfile</code>\u662f\u533a\u5206\u5927\u5c0f\u5199\u7684\uff01</p> <p>\u90a3\u5982\u679c\u6211\u4eec\u5e0c\u671b\u751f\u4ea7\u73af\u5883\u4e2d\u4e0d\u8981\u6253\u5305\u5f00\u53d1\u73af\u5883\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u5462\uff0c\u6211\u4eec\u76ee\u524d\u867d\u7136\u53ef\u4ee5\u5207\u6362\u5f00\u53d1\u73af\u5883\uff0c\u4f46\u662f\u6253\u5305\u7684\u65f6\u5019\u4f9d\u7136\u662f\u6240\u6709\u914d\u7f6e\u6587\u4ef6\u5168\u90e8\u6253\u5305\uff0c\u8fd9\u6837\u603b\u611f\u89c9\u8fd8\u6b20\u7f3a\u4e00\u70b9\u5b8c\u7f8e\uff0c\u56e0\u6b64\uff0c\u6253\u5305\u7684\u95ee\u9898\u5c31\u53ea\u80fd\u627eMaven\u89e3\u51b3\u4e86\uff0cMaven\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u591a\u73af\u5883\uff1a</p> <pre><code>&lt;!--\u5206\u522b\u8bbe\u7f6e\u5f00\u53d1\uff0c\u751f\u4ea7\u73af\u5883--&gt;\n&lt;profiles&gt;\n    &lt;!-- \u5f00\u53d1\u73af\u5883 --&gt;\n    &lt;profile&gt;\n        &lt;id&gt;dev&lt;/id&gt;\n        &lt;activation&gt;\n            &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;\n        &lt;/activation&gt;\n        &lt;properties&gt;\n            &lt;environment&gt;dev&lt;/environment&gt;\n        &lt;/properties&gt;\n    &lt;/profile&gt;\n    &lt;!-- \u751f\u4ea7\u73af\u5883 --&gt;\n    &lt;profile&gt;\n        &lt;id&gt;prod&lt;/id&gt;\n        &lt;activation&gt;\n            &lt;activeByDefault&gt;false&lt;/activeByDefault&gt;\n        &lt;/activation&gt;\n        &lt;properties&gt;\n            &lt;environment&gt;prod&lt;/environment&gt;\n        &lt;/properties&gt;\n    &lt;/profile&gt;\n&lt;/profiles&gt;\n</code></pre> <p>\u63a5\u7740\uff0c\u6211\u4eec\u9700\u8981\u6839\u636e\u73af\u5883\u7684\u4e0d\u540c\uff0c\u6392\u9664\u5176\u4ed6\u73af\u5883\u7684\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>&lt;resources&gt;\n&lt;!--\u6392\u9664\u914d\u7f6e\u6587\u4ef6--&gt;\n    &lt;resource&gt;\n        &lt;directory&gt;src/main/resources&lt;/directory&gt;\n        &lt;!--\u5148\u6392\u9664\u6240\u6709\u7684\u914d\u7f6e\u6587\u4ef6--&gt;\n        &lt;excludes&gt;\n            &lt;!--\u4f7f\u7528\u901a\u914d\u7b26\uff0c\u5f53\u7136\u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2aexclude\u6807\u7b7e\u8fdb\u884c\u6392\u9664--&gt;\n            &lt;exclude&gt;application*.yml&lt;/exclude&gt;\n        &lt;/excludes&gt;\n    &lt;/resource&gt;\n\n    &lt;!--\u6839\u636e\u6fc0\u6d3b\u6761\u4ef6\u5f15\u5165\u6253\u5305\u6240\u9700\u7684\u914d\u7f6e\u548c\u6587\u4ef6--&gt;\n    &lt;resource&gt;\n        &lt;directory&gt;src/main/resources&lt;/directory&gt;\n        &lt;!--\u5f15\u5165\u6240\u9700\u73af\u5883\u7684\u914d\u7f6e\u6587\u4ef6--&gt;\n        &lt;filtering&gt;true&lt;/filtering&gt;\n        &lt;includes&gt;\n            &lt;include&gt;application.yml&lt;/include&gt;\n            &lt;!--\u6839\u636emaven\u9009\u62e9\u73af\u5883\u5bfc\u5165\u914d\u7f6e\u6587\u4ef6--&gt;\n            &lt;include&gt;application-${environment}.yml&lt;/include&gt;\n        &lt;/includes&gt;\n    &lt;/resource&gt;\n&lt;/resources&gt;\n</code></pre> <p>\u63a5\u7740\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06Maven\u4e2d\u7684<code>environment</code>\u5c5e\u6027\uff0c\u4f20\u9012\u7ed9SpringBoot\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5728\u6784\u5efa\u65f6\u66ff\u6362\u4e3a\u5bf9\u5e94\u7684\u503c\uff1a</p> <pre><code>spring:\n  profiles:\n    active: '@environment@'  #\u6ce8\u610fYAML\u914d\u7f6e\u6587\u4ef6\u9700\u8981\u52a0\u5355\u5f15\u53f7\uff0c\u5426\u5219\u4f1a\u62a5\u9519\n</code></pre> <p>\u8fd9\u6837\uff0c\u6839\u636e\u6211\u4eecMaven\u73af\u5883\u7684\u5207\u6362\uff0cSpringBoot\u7684\u914d\u7f6e\u6587\u4ef6\u4e5f\u4f1a\u8fdb\u884c\u5bf9\u5e94\u7684\u5207\u6362\u3002</p> <p>\u6700\u540e\u6211\u4eec\u6253\u5f00Maven\u680f\u76ee\uff0c\u5c31\u53ef\u4ee5\u81ea\u7531\u5207\u6362\u4e86\uff0c\u76f4\u63a5\u52fe\u9009\u5373\u53ef\uff0c\u6ce8\u610f\u5207\u6362\u73af\u5883\u4e4b\u540e\u8981\u91cd\u65b0\u52a0\u8f7d\u4e00\u4e0bMaven\u9879\u76ee\uff0c\u4e0d\u7136\u4e0d\u4f1a\u751f\u6548\uff01</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_11","title":"\u5e38\u7528\u6846\u67b6\u4ecb\u7ecd","text":"<p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86SpringBoot\u9879\u76ee\u7684\u57fa\u672c\u642d\u5efa\uff0c\u76f8\u4fe1\u5404\u4f4d\u5c0f\u4f19\u4f34\u5df2\u7ecf\u4f53\u9a8c\u5230SpringBoot 3\u5e26\u6765\u7684\u8d85\u5f3a\u4fbf\u6377\u6027\u4e86\uff0c\u4e0d\u8fc7\u5149\u9760\u8fd9\u4e9b\u8fd8\u4e0d\u591f\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u4e86\u89e3\u66f4\u591a\u6846\u67b6\u6765\u4e30\u5bcc\u6211\u4eec\u7684\u7f51\u7ad9\uff0c\u901a\u8fc7\u4e86\u89e3\u5176\u4ed6\u7684SpringBoot\u6574\u5408\u6846\u67b6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u6211\u4eec\u81ea\u5df1\u7684Web\u670d\u52a1\u5668\u4e0a\u5b9e\u73b0\u66f4\u591a\u66f4\u9ad8\u7ea7\u7684\u529f\u80fd\uff0c\u540c\u65f6\u4e5f\u662f\u4e3a\u4e86\u7ed9\u6211\u4eec\u540e\u7eed\u5b66\u4e60\u524d\u540e\u7aef\u5206\u79bb\u9879\u76ee\u505a\u51c6\u5907\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_12","title":"\u90ae\u4ef6\u53d1\u9001\u6a21\u5757","text":"<p>\u90fd\u4ec0\u4e48\u5e74\u4ee3\u4e86\uff0c\u8fd8\u5728\u53d1\u4f20\u7edf\u90ae\u4ef6\uff0c\u6211\u4eec\u6765\u770b\u770b\u7535\u5b50\u90ae\u4ef6\u3002</p> <p>\u6211\u4eec\u5728\u6ce8\u518c\u5f88\u591a\u7684\u7f51\u7ad9\u65f6\uff0c\u90fd\u4f1a\u9047\u5230\u90ae\u4ef6\u6216\u662f\u624b\u673a\u53f7\u9a8c\u8bc1\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7\u4f60\u7684\u90ae\u7bb1\u6216\u662f\u624b\u673a\u77ed\u4fe1\u53bb\u63a5\u53d7\u7f51\u7ad9\u53d1\u7ed9\u4f60\u7684\u6ce8\u518c\u9a8c\u8bc1\u4fe1\u606f\uff0c\u586b\u5199\u9a8c\u8bc1\u7801\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5b8c\u6210\u6ce8\u518c\u4e86\uff0c\u540c\u65f6\uff0c\u7f51\u7ad9\u4e5f\u4f1a\u7ed1\u5b9a\u4f60\u7684\u624b\u673a\u53f7\u6216\u662f\u90ae\u7bb1\u3002</p> <p>\u90a3\u4e48\uff0c\u50cf\u8fd9\u6837\u7684\u529f\u80fd\uff0c\u6211\u4eec\u5982\u4f55\u5b9e\u73b0\u5462\uff1fSpringBoot\u5df2\u7ecf\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u5c01\u88c5\u597d\u7684\u90ae\u4ef6\u6a21\u5757\u4f7f\u7528\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u5728\u5b66\u4e60\u90ae\u4ef6\u53d1\u9001\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5148\u4e86\u89e3\u4e00\u4e0b\u4ec0\u4e48\u662f\u7535\u5b50\u90ae\u4ef6\u3002</p> <p>\u7535\u5b50\u90ae\u4ef6\u4e5f\u662f\u4e00\u79cd\u901a\u4fe1\u65b9\u5f0f\uff0c\u662f\u4e92\u8054\u7f51\u5e94\u7528\u6700\u5e7f\u7684\u670d\u52a1\u3002\u901a\u8fc7\u7f51\u7edc\u7684\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\uff0c\u7528\u6237\u53ef\u4ee5\u4ee5\u975e\u5e38\u4f4e\u5ec9\u7684\u4ef7\u683c\uff08\u4e0d\u7ba1\u53d1\u9001\u5230\u54ea\u91cc\uff0c\u90fd\u53ea\u9700\u8d1f\u62c5\u7f51\u8d39\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u628a\u4fe1\u606f\u53d1\u9001\u5230\u5bf9\u65b9\u670d\u52a1\u5668\u800c\u5df2\uff09\u3001\u975e\u5e38\u5feb\u901f\u7684\u65b9\u5f0f\uff0c\u4e0e\u4e16\u754c\u4e0a\u4efb\u4f55\u4e00\u4e2a\u5730\u65b9\u7684\u7535\u5b50\u90ae\u7bb1\u7528\u6237\u8054\u7cfb\u3002</p> <p>\u867d\u8bf4\u65b9\u4fbf\u5012\u662f\u65b9\u4fbf\uff0c\u867d\u7136\u662f\u66fe\u7ecf\u7684\u9738\u4e3b\uff0c\u4e0d\u8fc7\u73b0\u5728\u8fd9\u4e2a\u65f6\u4ee3\uff0cQQ\u5fae\u4fe1\u6a2a\u884c\uff0c\u624b\u673a\u77ed\u4fe1\u548c\u7535\u5b50\u90ae\u7bb1\u8c8c\u4f3c\u5c31\u53ea\u5269\u6536\u9a8c\u8bc1\u7801\u8fd9\u4e00\u4e2a\u529f\u80fd\u4e86\u3002</p> <p>\u8981\u5728Internet\u4e0a\u63d0\u4f9b\u7535\u5b50\u90ae\u4ef6\u529f\u80fd\uff0c\u5fc5\u987b\u6709\u4e13\u95e8\u7684\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u5668\u3002\u4f8b\u5982\u73b0\u5728Internet\u5f88\u591a\u63d0\u4f9b\u90ae\u4ef6\u670d\u52a1\u7684\u5382\u5546\uff1a\u65b0\u6d6a\u3001\u641c\u72d0\u3001163\u3001QQ\u90ae\u7bb1\u7b49\uff0c\u4ed6\u4eec\u90fd\u6709\u81ea\u5df1\u7684\u90ae\u4ef6\u670d\u52a1\u5668\u3002\u8fd9\u4e9b\u670d\u52a1\u5668\u7c7b\u4f3c\u4e8e\u73b0\u5b9e\u751f\u6d3b\u4e2d\u7684\u90ae\u5c40\uff0c\u5b83\u4e3b\u8981\u8d1f\u8d23\u63a5\u6536\u7528\u6237\u6295\u9012\u8fc7\u6765\u7684\u90ae\u4ef6\uff0c\u5e76\u628a\u90ae\u4ef6\u6295\u9012\u5230\u90ae\u4ef6\u63a5\u6536\u8005\u7684\u7535\u5b50\u90ae\u7bb1\u4e2d\u3002</p> <p>\u6240\u6709\u7684\u7528\u6237\u90fd\u53ef\u4ee5\u5728\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u5668\u4e0a\u7533\u8bf7\u4e00\u4e2a\u8d26\u53f7\u7528\u4e8e\u90ae\u4ef6\u53d1\u9001\u548c\u63a5\u6536\uff0c\u90a3\u4e48\u90ae\u4ef6\u662f\u4ee5\u4ec0\u4e48\u6837\u7684\u683c\u5f0f\u53d1\u9001\u7684\u5462\uff1f\u5b9e\u9645\u4e0a\u548cHttp\u4e00\u6837\uff0c\u90ae\u4ef6\u53d1\u9001\u4e5f\u6709\u81ea\u5df1\u7684\u534f\u8bae\uff0c\u4e5f\u5c31\u662f\u7ea6\u5b9a\u90ae\u4ef6\u6570\u636e\u957f\u5565\u6837\u4ee5\u53ca\u5982\u4f55\u901a\u4fe1\u3002</p> <p></p> <p>\u6bd4\u8f83\u5e38\u7528\u7684\u534f\u8bae\u6709\u4e24\u79cd\uff1a</p> <ol> <li>SMTP\u534f\u8bae\uff08\u4e3b\u8981\u7528\u4e8e\u53d1\u9001\u90ae\u4ef6 Simple Mail Transfer Protocol\uff09</li> <li>POP3\u534f\u8bae\uff08\u4e3b\u8981\u7528\u4e8e\u63a5\u6536\u90ae\u4ef6 Post Office Protocol 3\uff09</li> </ol> <p>\u6574\u4e2a\u53d1\u9001/\u63a5\u6536\u6d41\u7a0b\u5927\u81f4\u5982\u4e0b\uff1a</p> <p></p> <p>\u5b9e\u9645\u4e0a\u6bcf\u4e2a\u90ae\u7bb1\u670d\u52a1\u5668\u90fd\u6709\u4e00\u4e2asmtp\u53d1\u9001\u670d\u52a1\u5668\u548cpop3\u63a5\u6536\u670d\u52a1\u5668\uff0c\u6bd4\u5982\u8981\u4eceQQ\u90ae\u7bb1\u53d1\u9001\u90ae\u4ef6\u5230163\u90ae\u7bb1\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7QQ\u90ae\u7bb1\u5ba2\u6237\u7aef\u544a\u77e5QQ\u90ae\u7bb1\u7684smtp\u670d\u52a1\u5668\u6211\u4eec\u9700\u8981\u53d1\u9001\u90ae\u4ef6\uff0c\u4ee5\u53ca\u90ae\u4ef6\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u7136\u540eQQ\u90ae\u7bb1\u7684smtp\u670d\u52a1\u5668\u5c31\u4f1a\u5e2e\u52a9\u6211\u4eec\u53d1\u9001\u5230163\u90ae\u7bb1\u7684pop3\u670d\u52a1\u5668\u4e0a\uff0c163\u90ae\u7bb1\u4f1a\u901a\u8fc7163\u90ae\u7bb1\u5ba2\u6237\u7aef\u544a\u77e5\u5bf9\u5e94\u7528\u6237\u6536\u5230\u4e00\u5c01\u65b0\u90ae\u4ef6\u3002</p> <p>\u800c\u6211\u4eec\u5982\u679c\u60f3\u8981\u5b9e\u73b0\u7ed9\u522b\u4eba\u53d1\u9001\u90ae\u4ef6\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u8fde\u63a5\u5230\u5bf9\u5e94\u7535\u5b50\u90ae\u7bb1\u7684smtp\u670d\u52a1\u5668\u4e0a\uff0c\u5e76\u544a\u77e5\u5176\u6211\u4eec\u8981\u53d1\u9001\u90ae\u4ef6\u3002\u800cSpringBoot\u5df2\u7ecf\u5e2e\u52a9\u6211\u4eec\u5c06\u6700\u57fa\u672c\u7684\u5e95\u5c42\u901a\u4fe1\u5168\u90e8\u5b9e\u73b0\u4e86\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5173\u5fc3smtp\u670d\u52a1\u5668\u7684\u5730\u5740\u4ee5\u53ca\u6211\u4eec\u8981\u53d1\u9001\u7684\u90ae\u4ef6\u957f\u5565\u6837\u5373\u53ef\u3002</p> <p>\u8fd9\u91cc\u4ee5163\u90ae\u7bb1 https://mail.163.com \u4e3a\u4f8b\uff0c\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u544a\u8bc9SpringBootMail\u6211\u4eec\u7684smtp\u670d\u52a1\u5668\u7684\u5730\u5740\u4ee5\u53ca\u4f60\u7684\u90ae\u7bb1\u8d26\u53f7\u548c\u5bc6\u7801\uff0c\u9996\u5148\u6211\u4eec\u8981\u53bb\u8bbe\u7f6e\u4e2d\u5f00\u542fsmtp/pop3\u670d\u52a1\u624d\u53ef\u4ee5\uff0c\u5f00\u542f\u540e\u4f1a\u5f97\u5230\u4e00\u4e2a\u968f\u673a\u751f\u6210\u7684\u5bc6\u94a5\uff0c\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u7684\u5bc6\u7801\u3002</p> <pre><code>spring:\n  mail:\n      # 163\u90ae\u7bb1\u7684\u5730\u5740\u4e3asmtp.163.com\uff0c\u76f4\u63a5\u586b\u5199\u5373\u53ef\n    host: smtp.163.com\n    # \u4f60\u7533\u8bf7\u7684163\u90ae\u7bb1\n    username: javastudy111@163.com\n    # \u6ce8\u610f\u5bc6\u7801\u662f\u5728\u5f00\u542fsmtp/pop3\u65f6\u81ea\u52a8\u751f\u6210\u7684\uff0c\u8bb0\u5f97\u4fdd\u5b58\u4e00\u4e0b\uff0c\u4e0d\u7136\u5c31\u627e\u4e0d\u5230\u4e86\n    password: AZJTOAWZESLMHTNI\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u63a5\u7740\u6211\u4eec\u6765\u8fdb\u884c\u4e00\u4e0b\u6d4b\u8bd5\uff1a</p> <pre><code>@SpringBootTest\nclass SpringBootTestApplicationTests {\n\n      //JavaMailSender\u662f\u4e13\u95e8\u7528\u4e8e\u53d1\u9001\u90ae\u4ef6\u7684\u5bf9\u8c61\uff0c\u81ea\u52a8\u914d\u7f6e\u7c7b\u5df2\u7ecf\u63d0\u4f9b\u4e86Bean\n    @Autowired\n    JavaMailSender sender;\n\n    @Test\n    void contextLoads() {\n          //SimpleMailMessage\u662f\u4e00\u4e2a\u6bd4\u8f83\u7b80\u6613\u7684\u90ae\u4ef6\u5c01\u88c5\uff0c\u652f\u6301\u8bbe\u7f6e\u4e00\u4e9b\u6bd4\u8f83\u7b80\u5355\u5185\u5bb9\n        SimpleMailMessage message = new SimpleMailMessage();\n          //\u8bbe\u7f6e\u90ae\u4ef6\u6807\u9898\n        message.setSubject(\"\u3010\u7535\u5b50\u79d1\u6280\u5927\u5b66\u6559\u52a1\u5904\u3011\u5173\u4e8e\u8fd1\u671f\u5b66\u6821\u5bf9\u60a8\u7684\u5904\u5206\u51b3\u5b9a\");\n          //\u8bbe\u7f6e\u90ae\u4ef6\u5185\u5bb9\n        message.setText(\"XXX\u540c\u5b66\u60a8\u597d\uff0c\u7ecf\u76d1\u63a7\u548c\u6559\u52a1\u5de1\u67e5\u53d1\u73b0\uff0c\u60a8\u8fd1\u671f\u5b58\u5728\u65f7\u8bfe\u3001\u8fdf\u5230\u3001\u65e9\u9000\u3001\u4e0a\u8bfe\u5237\u6296\u97f3\u884c\u4e3a\uff0c\" +\n                \"\u73b0\u5df2\u901a\u77e5\u76f8\u5173\u8f85\u5bfc\u5458\uff0c\u8bf7\u624b\u51995000\u5b57\u4e66\u9762\u68c0\u8ba8\uff0c\u5e76\u57282022\u5e744\u67081\u65e517\u70b9\u524d\u4ea4\u5230\u8f85\u5bfc\u5458\u529e\u516c\u5ba4\u3002\");\n          //\u8bbe\u7f6e\u90ae\u4ef6\u53d1\u9001\u7ed9\u8c01\uff0c\u53ef\u4ee5\u591a\u4e2a\uff0c\u8fd9\u91cc\u5c31\u53d1\u7ed9\u4f60\u7684QQ\u90ae\u7bb1\n        message.setTo(\"\u4f60\u7684QQ\u53f7@qq.com\");\n          //\u90ae\u4ef6\u53d1\u9001\u8005\uff0c\u8fd9\u91cc\u8981\u4e0e\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u4fdd\u6301\u4e00\u81f4\n        message.setFrom(\"javastudy111@163.com\");\n          //OK\uff0c\u4e07\u4e8b\u4ff1\u5907\u53ea\u6b20\u53d1\u9001\n        sender.send(message);\n    }\n\n}\n</code></pre> <p>\u5982\u679c\u9700\u8981\u6dfb\u52a0\u9644\u4ef6\u7b49\u66f4\u591a\u529f\u80fd\uff0c\u53ef\u4ee5\u4f7f\u7528MimeMessageHelper\u6765\u5e2e\u52a9\u6211\u4eec\u5b8c\u6210\uff1a</p> <pre><code>@Test\nvoid contextLoads() throws MessagingException {\n      //\u521b\u5efa\u4e00\u4e2aMimeMessage\n    MimeMessage message = sender.createMimeMessage();\n      //\u4f7f\u7528MimeMessageHelper\u6765\u5e2e\u6211\u4eec\u4fee\u6539MimeMessage\u4e2d\u7684\u4fe1\u606f\n    MimeMessageHelper helper = new MimeMessageHelper(message, true);\n    helper.setSubject(\"Test\");\n    helper.setText(\"lbwnb\");\n    helper.setTo(\"\u4f60\u7684QQ\u53f7@qq.com\");\n    helper.setFrom(\"javastudy111@163.com\");\n      //\u53d1\u9001\u4fee\u6539\u597d\u7684MimeMessage\n    sender.send(message);\n}\n</code></pre> <p>\u6700\u540e\uff0c\u6211\u4eec\u6765\u5c1d\u8bd5\u4e3a\u6211\u4eec\u7684\u7f51\u7ad9\u5b9e\u73b0\u4e00\u4e2a\u90ae\u4ef6\u6ce8\u518c\u529f\u80fd\uff0c\u9996\u5148\u660e\u786e\u9a8c\u8bc1\u6d41\u7a0b\uff1a\u8bf7\u6c42\u9a8c\u8bc1\u7801 -&gt; \u751f\u6210\u9a8c\u8bc1\u7801\uff08\u4e34\u65f6\u6709\u6548\uff0c\u6ce8\u610f\u8bbe\u5b9a\u8fc7\u671f\u65f6\u95f4\uff09 -&gt; \u7528\u6237\u8f93\u5165\u9a8c\u8bc1\u7801\u5e76\u586b\u5199\u6ce8\u518c\u4fe1\u606f -&gt; \u9a8c\u8bc1\u901a\u8fc7\u6ce8\u518c\u6210\u529f\uff01</p> <p>\u63a5\u7740\u6211\u4eec\u5c31\u6765\u7740\u624b\u5199\u4e00\u4e0b\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_13","title":"\u63a5\u53e3\u89c4\u5219\u6821\u9a8c","text":"<p>\u901a\u5e38\u6211\u4eec\u5728\u4f7f\u7528SpringMvc\u6846\u67b6\u7f16\u5199\u63a5\u53e3\u65f6\uff0c\u5f88\u6709\u53ef\u80fd\u7528\u6237\u53d1\u9001\u7684\u6570\u636e\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0c\u6bd4\u5982\u4e0b\u9762\u8fd9\u4e2a\u63a5\u53e3\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(\"/submit\")\npublic String submit(String username,\n                     String password){\n    System.out.println(username.substring(3));\n    System.out.println(password.substring(2, 10));\n    return \"\u8bf7\u6c42\u6210\u529f!\";\n}\n</code></pre> <p>\u8fd9\u4e2a\u63a5\u53e3\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u5c06\u7528\u6237\u540d\u548c\u5bc6\u7801\u5206\u5272\u7136\u540e\u6253\u5370\uff0c\u5728\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u56e0\u4e3a\u7528\u6237\u540d\u957f\u5ea6\u89c4\u5b9a\u4e0d\u5c0f\u4e8e5\uff0c\u5982\u679c\u7528\u6237\u53d1\u9001\u7684\u6570\u636e\u662f\u6ca1\u6709\u95ee\u9898\u7684\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u6b63\u5e38\u8fd0\u884c\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u6240\u5e0c\u671b\u7684\u60c5\u51b5\uff0c\u4f46\u662f\u5982\u679c\u7528\u6237\u53d1\u9001\u7684\u6570\u636e\u5e76\u4e0d\u662f\u6309\u7167\u89c4\u5b9a\u7684\uff0c\u90a3\u4e48\u5c31\u4f1a\u76f4\u63a5\u62a5\u9519\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5728\u8bf7\u6c42\u8fdb\u6765\u4e4b\u524d\u8fdb\u884c\u6821\u9a8c\u4e86\uff0c\u6700\u7b80\u5355\u7684\u529e\u6cd5\u5c31\u662f\u5224\u65ad\u4e00\u4e0b\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(\"/submit\")\npublic String submit(String username,\n                     String password){\n    if(username.length() &gt; 3 &amp;&amp; password.length() &gt; 10) {\n        System.out.println(username.substring(3));\n        System.out.println(password.substring(2, 10));\n        return \"\u8bf7\u6c42\u6210\u529f!\";\n    } else {\n        return \"\u8bf7\u6c42\u5931\u8d25\";\n    }\n}\n</code></pre> <p>\u867d\u7136\u8fd9\u6837\u5c31\u80fd\u76f4\u63a5\u89e3\u51b3\u95ee\u9898\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u7684\u6bcf\u4e00\u4e2a\u63a5\u53e3\u90fd\u9700\u8981\u8fd9\u6837\u53bb\u8fdb\u884c\u914d\u7f6e\uff0c\u90a3\u4e48\u662f\u4e0d\u662f\u592a\u9ebb\u70e6\u4e86\u4e00\u70b9\uff1fSpringBoot\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5f88\u65b9\u4fbf\u7684\u63a5\u53e3\u6821\u9a8c\u6846\u67b6\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6ce8\u89e3\u5b8c\u6210\u5168\u90e8\u63a5\u53e3\u7684\u6821\u9a8c\uff1a</p> <pre><code>@Slf4j\n@Validated   //\u9996\u5148\u5728Controller\u4e0a\u5f00\u542f\u63a5\u53e3\u6821\u9a8c\n@Controller\npublic class TestController {\n\n    ...\n\n    @ResponseBody\n    @PostMapping(\"/submit\")\n    public String submit(@Length(min = 3) String username,  //\u4f7f\u7528@Length\u6ce8\u89e3\u4e00\u6b65\u5230\u4f4d\n                         @Length(min = 10) String password){\n        System.out.println(username.substring(3));\n        System.out.println(password.substring(2, 10));\n        return \"\u8bf7\u6c42\u6210\u529f!\";\n    }\n}\n</code></pre> <p>\u73b0\u5728\uff0c\u6211\u4eec\u7684\u63a5\u53e3\u6821\u9a8c\u5c31\u53ef\u4ee5\u5feb\u901f\u8fdb\u884c\u914d\u7f6e\u4e86\uff0c\u4e00\u4e2a\u63a5\u53e3\u5c31\u80fd\u641e\u5b9a\uff1a</p> <p></p> <p>\u4e0d\u8fc7\u8fd9\u6837\u4f9d\u7136\u4f1a\u629b\u51fa\u4e00\u4e2a\u5f02\u5e38\uff0c\u5bf9\u7528\u6237\u4e0d\u592a\u53cb\u597d\uff0c\u6211\u4eec\u53ef\u4ee5\u7a0d\u5fae\u5904\u7406\u4e00\u4e0b\uff0c\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e4b\u524d\u5728SSM\u9636\u6bb5\u4e2d\u5b66\u4e60\u7684\u5f02\u5e38\u5904\u7406Controller\u6765\u81ea\u884c\u5904\u7406\u8fd9\u7c7b\u5f02\u5e38\uff1a</p> <pre><code>@ControllerAdvice\npublic class ValidationController {\n\n    @ResponseBody\n    @ExceptionHandler(ConstraintViolationException.class)\n    public String error(ValidationException e){\n        return e.getMessage();   //\u51fa\u73b0\u5f02\u5e38\u76f4\u63a5\u8fd4\u56de\u6d88\u606f\n    }\n}\n</code></pre> <p></p> <p>\u9664\u4e86@Length\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u7684\u63a5\u53e3\u6765\u5b9e\u73b0\u5404\u79cd\u6570\u636e\u6821\u9a8c\uff1a</p> \u9a8c\u8bc1\u6ce8\u89e3 \u9a8c\u8bc1\u7684\u6570\u636e\u7c7b\u578b \u8bf4\u660e @AssertFalse Boolean,boolean \u503c\u5fc5\u987b\u662ffalse @AssertTrue Boolean,boolean \u503c\u5fc5\u987b\u662ftrue @NotNull \u4efb\u610f\u7c7b\u578b \u503c\u4e0d\u80fd\u662fnull @Null \u4efb\u610f\u7c7b\u578b \u503c\u5fc5\u987b\u662fnull @Min BigDecimal\u3001BigInteger\u3001byte\u3001short\u3001int\u3001long\u3001double \u4ee5\u53ca\u4efb\u4f55Number\u6216CharSequence\u5b50\u7c7b\u578b \u5927\u4e8e\u7b49\u4e8e@Min\u6307\u5b9a\u7684\u503c @Max \u540c\u4e0a \u5c0f\u4e8e\u7b49\u4e8e@Max\u6307\u5b9a\u7684\u503c @DecimalMin \u540c\u4e0a \u5927\u4e8e\u7b49\u4e8e@DecimalMin\u6307\u5b9a\u7684\u503c\uff08\u8d85\u9ad8\u7cbe\u5ea6\uff09 @DecimalMax \u540c\u4e0a \u5c0f\u4e8e\u7b49\u4e8e@DecimalMax\u6307\u5b9a\u7684\u503c\uff08\u8d85\u9ad8\u7cbe\u5ea6\uff09 @Digits \u540c\u4e0a \u9650\u5236\u6574\u6570\u4f4d\u6570\u548c\u5c0f\u6570\u4f4d\u6570\u4e0a\u9650 @Size \u5b57\u7b26\u4e32\u3001Collection\u3001Map\u3001\u6570\u7ec4\u7b49 \u957f\u5ea6\u5728\u6307\u5b9a\u533a\u95f4\u4e4b\u5185\uff0c\u5982\u5b57\u7b26\u4e32\u957f\u5ea6\u3001\u96c6\u5408\u5927\u5c0f\u7b49 @Past \u5982 java.util.Date, java.util.Calendar \u7b49\u65e5\u671f\u7c7b\u578b \u503c\u5fc5\u987b\u6bd4\u5f53\u524d\u65f6\u95f4\u65e9 @Future \u540c\u4e0a \u503c\u5fc5\u987b\u6bd4\u5f53\u524d\u65f6\u95f4\u665a @NotBlank CharSequence\u53ca\u5176\u5b50\u7c7b \u503c\u4e0d\u4e3a\u7a7a\uff0c\u5728\u6bd4\u8f83\u65f6\u4f1a\u53bb\u9664\u5b57\u7b26\u4e32\u7684\u9996\u4f4d\u7a7a\u683c @Length CharSequence\u53ca\u5176\u5b50\u7c7b \u5b57\u7b26\u4e32\u957f\u5ea6\u5728\u6307\u5b9a\u533a\u95f4\u5185 @NotEmpty CharSequence\u53ca\u5176\u5b50\u7c7b\u3001Collection\u3001Map\u3001\u6570\u7ec4 \u503c\u4e0d\u4e3anull\u4e14\u957f\u5ea6\u4e0d\u4e3a\u7a7a\uff08\u5b57\u7b26\u4e32\u957f\u5ea6\u4e0d\u4e3a0\uff0c\u96c6\u5408\u5927\u5c0f\u4e0d\u4e3a0\uff09 @Range BigDecimal\u3001BigInteger\u3001CharSequence\u3001byte\u3001short\u3001int\u3001long \u4ee5\u53ca\u539f\u5b50\u7c7b\u578b\u548c\u5305\u88c5\u7c7b\u578b \u503c\u5728\u6307\u5b9a\u533a\u95f4\u5185 @Email CharSequence\u53ca\u5176\u5b50\u7c7b \u503c\u5fc5\u987b\u662f\u90ae\u4ef6\u683c\u5f0f @Pattern CharSequence\u53ca\u5176\u5b50\u7c7b \u503c\u9700\u8981\u4e0e\u6307\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d @Valid \u4efb\u4f55\u975e\u539f\u5b50\u7c7b\u578b \u7528\u4e8e\u9a8c\u8bc1\u5bf9\u8c61\u5c5e\u6027 <p>\u867d\u7136\u8fd9\u6837\u5df2\u7ecf\u5f88\u65b9\u4fbf\u4e86\uff0c\u4f46\u662f\u5728\u9047\u5230\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u4f9d\u7136\u4e0d\u592a\u65b9\u4fbf\uff0c\u6bd4\u5982\uff1a</p> <pre><code>@Data\npublic class Account {\n    String username;\n    String password;\n}\n</code></pre> <pre><code>@ResponseBody\n@PostMapping(\"/submit\")\npublic String submit(Account account){   //\u76f4\u63a5\u4f7f\u7528\u5bf9\u8c61\u63a5\u6536\n    System.out.println(account.getUsername().substring(3));\n    System.out.println(account.getPassword().substring(2, 10));\n    return \"\u8bf7\u6c42\u6210\u529f!\";\n}\n</code></pre> <p>\u6b64\u65f6\u63a5\u53e3\u662f\u4ee5\u5bf9\u8c61\u5f62\u5f0f\u63a5\u6536\u524d\u7aef\u53d1\u9001\u7684\u8868\u5355\u6570\u636e\u7684\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u6ca1\u529e\u6cd5\u5411\u4e0a\u9762\u4e00\u6837\u7f16\u5199\u5bf9\u5e94\u7684\u6821\u9a8c\u89c4\u5219\u4e86\uff0c\u90a3\u4e48\u73b0\u5728\u53c8\u8be5\u600e\u4e48\u505a\u5462\uff1f</p> <p>\u5bf9\u5e94\u5bf9\u8c61\u7c7b\u578b\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u8fdb\u884c\u9a8c\u8bc1\uff0c\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <pre><code>@ResponseBody\n@PostMapping(\"/submit\")  //\u5728\u53c2\u6570\u4e0a\u6dfb\u52a0@Valid\u6ce8\u89e3\u8868\u793a\u9700\u8981\u9a8c\u8bc1\npublic String submit(@Valid Account account){\n    System.out.println(account.getUsername().substring(3));\n    System.out.println(account.getPassword().substring(2, 10));\n    return \"\u8bf7\u6c42\u6210\u529f!\";\n}\n</code></pre> <pre><code>@Data\npublic class Account {\n    @Length(min = 3)   //\u53ea\u9700\u8981\u5728\u5bf9\u5e94\u7684\u5b57\u6bb5\u4e0a\u6dfb\u52a0\u6821\u9a8c\u7684\u6ce8\u89e3\u5373\u53ef\n    String username;\n    @Length(min = 10)\n    String password;\n}\n</code></pre> <p>\u8fd9\u6837\u5f53\u53d7\u5230\u8bf7\u6c42\u65f6\uff0c\u5c31\u4f1a\u5bf9\u5bf9\u8c61\u4e2d\u7684\u5b57\u6bb5\u8fdb\u884c\u6821\u9a8c\u4e86\uff0c\u8fd9\u91cc\u6211\u4eec\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0bValidationController\u7684\u9519\u8bef\u5904\u7406\uff0c\u5bf9\u4e8e\u5b9e\u4f53\u7c7b\u63a5\u6536\u53c2\u6570\u7684\u9a8c\u8bc1\uff0c\u4f1a\u629b\u51faMethodArgumentNotValidException\u5f02\u5e38\uff0c\u8fd9\u91cc\u4e5f\u8fdb\u884c\u4e00\u4e0b\u5904\u7406\uff1a</p> <pre><code>@ResponseBody\n@ExceptionHandler({ConstraintViolationException.class, MethodArgumentNotValidException.class})\npublic String error(Exception e){\n    if(e instanceof ConstraintViolationException exception) {\n        return exception.getMessage();\n    } else if(e instanceof MethodArgumentNotValidException exception){\n        if (exception.getFieldError() == null) return \"\u672a\u77e5\u9519\u8bef\";\n        return exception.getFieldError().getDefaultMessage();\n    }\n    return \"\u672a\u77e5\u9519\u8bef\";\n}\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u6b63\u786e\u8fd4\u56de\u5bf9\u5e94\u7684\u9519\u8bef\u4fe1\u606f\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_14","title":"\u63a5\u53e3\u6587\u6863\u751f\u6210\uff08\u9009\u5b66\uff09","text":"<p>\u5728\u540e\u7eed\u5b66\u4e60\u524d\u540e\u7aef\u5206\u79bb\u5f00\u53d1\u4e2d\uff0c\u524d\u7aef\u73b0\u5728\u7531\u4e13\u4e1a\u7684\u4eba\u6765\u505a\uff0c\u800c\u6211\u4eec\u5f80\u5f80\u53ea\u9700\u8981\u5173\u5fc3\u540e\u7aef\u63d0\u4f9b\u4ec0\u4e48\u63a5\u53e3\u7ed9\u524d\u7aef\u4eba\u5458\u8c03\u7528\uff0c\u6211\u4eec\u7684\u5de5\u4f5c\u88ab\u8fdb\u4e00\u6b65\u7ec6\u5206\u4e86\uff0c\u8fd9\u4e2a\u65f6\u5019\u4e3a\u524d\u7aef\u5f00\u53d1\u4eba\u5458\u63d0\u4f9b\u4e00\u4e2a\u53ef\u4ee5\u53c2\u8003\u7684\u6587\u6863\u662f\u5f88\u6709\u5fc5\u8981\u7684\u3002</p> <p>\u4f46\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u6587\u6863\uff0c\u6211\u4eec\u4e5f\u4e0d\u53ef\u80fd\u5355\u72ec\u5199\u4e00\u4e2a\u9879\u76ee\u53bb\u8fdb\u884c\u7ef4\u62a4\uff0c\u5e76\u4e14\u968f\u7740\u6211\u4eec\u7684\u540e\u7aef\u9879\u76ee\u4e0d\u65ad\u66f4\u65b0\uff0c\u6587\u6863\u4e5f\u9700\u8981\u8ddf\u968f\u66f4\u65b0\uff0c\u8fd9\u663e\u7136\u662f\u5f88\u9ebb\u70e6\u7684\u4e00\u4ef6\u4e8b\u60c5\uff0c\u90a3\u4e48\u6709\u6ca1\u6709\u4e00\u79cd\u6bd4\u8f83\u597d\u7684\u89e3\u51b3\u65b9\u6848\u5462\uff1f</p> <p>\u5f53\u7136\u6709\uff0c\u90a3\u5c31\u662f\u4e1d\u889c\u54e5\uff1aSwagger</p> <p>Swagger\u7684\u4e3b\u8981\u529f\u80fd\u5982\u4e0b\uff1a</p> <ul> <li>\u652f\u6301 API \u81ea\u52a8\u751f\u6210\u540c\u6b65\u7684\u5728\u7ebf\u6587\u6863\uff1a\u4f7f\u7528 Swagger \u540e\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u4ee3\u7801\u751f\u6210\u6587\u6863\uff0c\u4e0d\u518d\u9700\u8981\u81ea\u5df1\u624b\u52a8\u7f16\u5199\u63a5\u53e3\u6587\u6863\u4e86\uff0c\u5bf9\u7a0b\u5e8f\u5458\u6765\u8bf4\u975e\u5e38\u65b9\u4fbf\uff0c\u53ef\u4ee5\u8282\u7ea6\u5199\u6587\u6863\u7684\u65f6\u95f4\u53bb\u5b66\u4e60\u65b0\u6280\u672f\u3002</li> <li>\u63d0\u4f9b Web \u9875\u9762\u5728\u7ebf\u6d4b\u8bd5 API\uff1a\u5149\u6709\u6587\u6863\u8fd8\u4e0d\u591f\uff0cSwagger \u751f\u6210\u7684\u6587\u6863\u8fd8\u652f\u6301\u5728\u7ebf\u6d4b\u8bd5\u3002\u53c2\u6570\u548c\u683c\u5f0f\u90fd\u5b9a\u597d\u4e86\uff0c\u76f4\u63a5\u5728\u754c\u9762\u4e0a\u8f93\u5165\u53c2\u6570\u5bf9\u5e94\u7684\u503c\u5373\u53ef\u5728\u7ebf\u6d4b\u8bd5\u63a5\u53e3\u3002</li> </ul> <p>\u7ed3\u5408Spring\u6846\u67b6\uff08Spring-doc\uff0c\u5b98\u7f51\uff1ahttps://springdoc.org/\uff09\uff0cSwagger\u53ef\u4ee5\u5f88\u8f7b\u677e\u5730\u5229\u7528\u6ce8\u89e3\u4ee5\u53ca\u626b\u63cf\u673a\u5236\uff0c\u6765\u5feb\u901f\u751f\u6210\u5728\u7ebf\u6587\u6863\uff0c\u4ee5\u5b9e\u73b0\u5f53\u6211\u4eec\u9879\u76ee\u542f\u52a8\u4e4b\u540e\uff0c\u524d\u7aef\u5f00\u53d1\u4eba\u5458\u5c31\u53ef\u4ee5\u6253\u5f00Swagger\u63d0\u4f9b\u7684\u524d\u7aef\u9875\u9762\uff0c\u67e5\u770b\u548c\u6d4b\u8bd5\u63a5\u53e3\u3002\u4f9d\u8d56\u5982\u4e0b\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springdoc&lt;/groupId&gt;\n    &lt;artifactId&gt;springdoc-openapi-starter-webmvc-ui&lt;/artifactId&gt;\n    &lt;version&gt;2.1.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u9879\u76ee\u542f\u52a8\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\uff1ahttp://localhost:8080/swagger-ui/index.html\uff0c\u5c31\u80fd\u770b\u5230\u6211\u4eec\u7684\u5f00\u53d1\u6587\u6863\u4e86\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u5f00\u53d1\u6587\u6863\u4e2d\u81ea\u52a8\u5305\u542b\u4e86\u6211\u4eec\u5b9a\u4e49\u7684\u63a5\u53e3\uff0c\u5e76\u4e14\u8fd8\u6709\u5bf9\u5e94\u7684\u5b9e\u4f53\u7c7b\u4e5f\u653e\u5728\u4e86\u4e0b\u9762\u3002\u8fd9\u4e2a\u9875\u9762\u4e0d\u4ec5\u4ec5\u662f\u5c55\u793a\u63a5\u53e3\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u4e0a\u9762\u8fdb\u884c\u8c03\u8bd5\uff1a</p> <p></p> <p>\u8fd9\u5c31\u975e\u5e38\u65b9\u4fbf\u4e86\uff0c\u4e0d\u4ec5\u524d\u7aef\u4eba\u5458\u53ef\u4ee5\u5feb\u901f\u67e5\u8be2\u63a5\u53e3\u5b9a\u4e49\uff0c\u6211\u4eec\u81ea\u5df1\u4e5f\u53ef\u4ee5\u5728\u7ebf\u8fdb\u884c\u63a5\u53e3\u6d4b\u8bd5\uff0c\u76f4\u63a5\u629b\u5f03PostMan\u4e4b\u7c7b\u7684\u8f6f\u4ef6\u4e86\u3002</p> <p>\u867d\u7136Swagger\u7684UI\u754c\u9762\u5df2\u7ecf\u53ef\u4ee5\u5f88\u597d\u5730\u5c55\u793a\u540e\u7aef\u63d0\u4f9b\u7684\u63a5\u53e3\u4fe1\u606f\u4e86\uff0c\u4f46\u662f\u975e\u5e38\u7684\u6df7\u4e71\uff0c\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u914d\u7f6e\u63a5\u53e3\u7684\u4e00\u4e9b\u63cf\u8ff0\u4fe1\u606f\u3002\u9996\u5148\u6211\u4eec\u7684\u9875\u9762\u80af\u5b9a\u8981\u5c55\u793a\u4e00\u4e0b\u8fd9\u4e2a\u6587\u6863\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u53ea\u9700\u8981\u4e00\u4e2aBean\u5c31\u80fd\u641e\u5b9a\uff1a</p> <pre><code>@Bean\npublic OpenAPI springDocOpenAPI() {\n        return new OpenAPI().info(new Info()\n                        .title(\"\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf - \u5728\u7ebfAPI\u63a5\u53e3\u6587\u6863\")   //\u8bbe\u7f6eAPI\u6587\u6863\u7f51\u7ad9\u6807\u9898\n                        .description(\"\u8fd9\u662f\u4e00\u4e2a\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u7684\u540e\u7aefAPI\u6587\u6863\uff0c\u6b22\u8fce\u524d\u7aef\u4eba\u5458\u67e5\u9605\uff01\") //\u7f51\u7ad9\u4ecb\u7ecd\n                        .version(\"2.0\")   //\u5f53\u524dAPI\u7248\u672c\n                        .license(new License().name(\"\u6211\u7684B\u7ad9\u4e2a\u4eba\u4e3b\u9875\")  //\u9075\u5faa\u7684\u534f\u8bae\uff0c\u8fd9\u91cc\u62ff\u6765\u5199\u5176\u4ed6\u7684\u4e5f\u884c\n                                .url(\"https://space.bilibili.com/37737161\")));\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u7684\u9875\u9762\u4e2d\u5c31\u4f1a\u5c55\u793a\u81ea\u5b9a\u4e49\u7684\u6587\u672c\u4fe1\u606f\u4e86\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u4e3a\u4e00\u4e2aController\u7f16\u5199API\u63cf\u8ff0\u4fe1\u606f\uff1a</p> <pre><code>//\u4f7f\u7528@Tag\u6ce8\u89e3\u6765\u6dfb\u52a0Controller\u63cf\u8ff0\u4fe1\u606f\n@Tag(name = \"\u8d26\u6237\u9a8c\u8bc1\u76f8\u5173\", description = \"\u5305\u62ec\u7528\u6237\u767b\u5f55\u3001\u6ce8\u518c\u3001\u9a8c\u8bc1\u7801\u8bf7\u6c42\u7b49\u64cd\u4f5c\u3002\")\npublic class TestController {\n    ...\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u7c7b\u540d\u79f0\u4e0a\u9762\u6dfb\u52a0<code>@Tag</code>\u6ce8\u89e3\uff0c\u5e76\u586b\u5199\u76f8\u5173\u4fe1\u606f\uff0c\u6765\u4e3a\u5f53\u524d\u7684Controller\u8bbe\u7f6e\u63cf\u8ff0\u4fe1\u606f\u3002\u63a5\u7740\u6211\u4eec\u53ef\u4ee5\u4e3a\u6240\u6709\u7684\u8bf7\u6c42\u6620\u5c04\u914d\u7f6e\u63cf\u8ff0\u4fe1\u606f\uff1a</p> <pre><code>@ApiResponses({\n       @ApiResponse(responseCode = \"200\", description = \"\u6d4b\u8bd5\u6210\u529f\"),\n       @ApiResponse(responseCode = \"500\", description = \"\u6d4b\u8bd5\u5931\u8d25\")   //\u4e0d\u540c\u8fd4\u56de\u72b6\u6001\u7801\u63cf\u8ff0\n})\n@Operation(summary = \"\u8bf7\u6c42\u7528\u6237\u6570\u636e\u6d4b\u8bd5\u63a5\u53e3\")   //\u63a5\u53e3\u529f\u80fd\u63cf\u8ff0\n@ResponseBody\n@GetMapping(\"/hello\")\n//\u8bf7\u6c42\u53c2\u6570\u63cf\u8ff0\u548c\u6837\u4f8b\npublic String hello(@Parameter(description = \"\u6d4b\u8bd5\u6587\u672c\u6570\u636e\", example = \"KFCvivo50\") @RequestParam String text) {\n    return \"Hello World\";\n}\n</code></pre> <p>\u5bf9\u4e8e\u90a3\u4e9b\u4e0d\u9700\u8981\u5c55\u793a\u5728\u6587\u6863\u4e2d\u7684\u63a5\u53e3\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5c06\u5176\u5ffd\u7565\u6389\uff1a</p> <pre><code>@Hidden\n@ResponseBody\n@GetMapping(\"/hello\")\npublic String hello() {\n    return \"Hello World\";\n}\n</code></pre> <p>\u5bf9\u4e8e\u5b9e\u4f53\u7c7b\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7f16\u5199\u5bf9\u5e94\u7684API\u63a5\u53e3\u6587\u6863\uff1a</p> <pre><code>@Data\n@Schema(description = \"\u7528\u6237\u4fe1\u606f\u5b9e\u4f53\u7c7b\")\npublic class User {\n    @Schema(description = \"\u7528\u6237\u7f16\u53f7\")\n    int id;\n    @Schema(description = \"\u7528\u6237\u540d\u79f0\")\n    String name;\n    @Schema(description = \"\u7528\u6237\u90ae\u7bb1\")\n    String email;\n    @Schema(description = \"\u7528\u6237\u5bc6\u7801\")\n    String password;\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u6587\u6863\u4e2d\u67e5\u770b\u5b9e\u4f53\u7c7b\u7b80\u4ecb\u4ee5\u53ca\u5404\u4e2a\u5c5e\u6027\u7684\u4ecb\u7ecd\u4e86\u3002</p> <p>\u4e0d\u8fc7\uff0c\u8fd9\u79cd\u6587\u6863\u53ea\u9002\u5408\u5728\u5f00\u53d1\u73af\u5883\u4e0b\u751f\u6210\uff0c\u5982\u679c\u662f\u751f\u4ea7\u73af\u5883\uff0c\u6211\u4eec\u9700\u8981\u5173\u95ed\u6587\u6863\uff1a</p> <pre><code>springdoc:\n  api-docs:\n    enabled: false\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u5173\u95ed\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_15","title":"\u9879\u76ee\u8fd0\u884c\u76d1\u63a7\uff08\u9009\u5b66\uff09","text":"<p>\u6211\u4eec\u7684\u9879\u76ee\u5f00\u53d1\u5b8c\u6210\u4e4b\u540e\uff0c\u80af\u5b9a\u662f\u9700\u8981\u4e0a\u7ebf\u8fd0\u884c\u7684\uff0c\u4e0d\u8fc7\u5728\u9879\u76ee\u7684\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u5bf9\u5176\u8fdb\u884c\u76d1\u63a7\uff0c\u4ece\u800c\u5b9e\u65f6\u89c2\u5bdf\u5176\u8fd0\u884c\u72b6\u6001\uff0c\u5e76\u5728\u53d1\u751f\u95ee\u9898\u65f6\u505a\u51fa\u5bf9\u5e94\u8c03\u6574\uff0c\u56e0\u6b64\uff0c\u96c6\u6210\u9879\u76ee\u8fd0\u884c\u76d1\u63a7\u5c31\u5f88\u6709\u5fc5\u8981\u4e86\u3002</p> <p>SpringBoot\u6846\u67b6\u63d0\u4f9b\u4e86<code>spring-boot-starter-actuator</code>\u6a21\u5757\u6765\u5b9e\u73b0\u76d1\u63a7\u6548\u679c\uff1a</p> <pre><code>&lt;dependency&gt;\n   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n   &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6dfb\u52a0\u597d\u4e4b\u540e\uff0cActuator\u4f1a\u81ea\u52a8\u6ce8\u518c\u4e00\u4e9b\u63a5\u53e3\u7528\u4e8e\u67e5\u8be2\u5f53\u524dSpringBoot\u5e94\u7528\u7a0b\u5e8f\u7684\u72b6\u6001\uff0c\u5b98\u65b9\u6587\u6863\u5982\u4e0b\uff1ahttps://docs.spring.io/spring-boot/docs/3.1.1/actuator-api/htmlsingle/#overview</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6240\u6709Actuator\u81ea\u52a8\u6ce8\u518c\u7684\u63a5\u53e3\u8def\u5f84\u90fd\u662f<code>/actuator/{id}</code>\u683c\u5f0f\u7684\uff08\u53ef\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539\uff09\uff0c\u6bd4\u5982\u6211\u4eec\u60f3\u8981\u67e5\u8be2\u5f53\u524d\u670d\u52a1\u5668\u7684\u5065\u5eb7\u72b6\u6001\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee\u8fd9\u4e2a\u63a5\u53e3\uff1ahttp://localhost:8080/actuator/health\uff0c\u7ed3\u679c\u4f1a\u4ee5JSON\u683c\u5f0f\u8fd4\u56de\u7ed9\u6211\u4eec\uff1a</p> <p></p> <p>\u76f4\u63a5\u8bbf\u95ee\uff1ahttp://localhost:8080/actuator\u6839\u8def\u5f84\uff0c\u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u5df2\u7ecf\u5f00\u542f\u7684\u6240\u6709\u63a5\u53e3\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u53ea\u5f00\u542f\u4ee5\u4e0b\u63a5\u53e3\uff1a</p> <pre><code>{\n  \"_links\": {\n    \"self\": {\"href\":\"http://localhost:8080/actuator\",\"templated\":false},  //actuator\u81ea\u5df1\u7684\u4fe1\u606f\n    \"health-path\":{\"href\":\"http://localhost:8080/actuator/health/{*path}\",\"templated\":true},\n    \"health\":{\"href\":\"http://localhost:8080/actuator/health\",\"templated\":false}  //\u5e94\u7528\u7a0b\u5e8f\u5065\u5eb7\u60c5\u51b5\u76d1\u63a7\n    }\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u6765\u4fee\u6539\u4e00\u4e0b\u914d\u7f6e\u6587\u4ef6\uff0c\u8ba9\u5176\u66b4\u9732\u5168\u90e8\u63a5\u53e3\uff1a</p> <pre><code>management:\n  endpoints:\n    web:\n      exposure:\n        include: '*'   #\u4f7f\u7528*\u8868\u793a\u66b4\u9732\u5168\u90e8\u63a5\u53e3\n</code></pre> <p>\u91cd\u542f\u670d\u52a1\u5668\uff0c\u518d\u6b21\u83b7\u53d6\u53ef\u7528\u63a5\u53e3\u5c31\u53ef\u4ee5\u770b\u5230\u5168\u90e8\u7684\u4fe1\u606f\u4e86\uff0c\u8fd9\u91cc\u5c31\u4e0d\u5168\u90e8\u642c\u51fa\u6765\u4e86\uff0c\u53ea\u5217\u4e3e\u4e00\u4e9b\u5e38\u7528\u7684\uff1a</p> <pre><code>{\n  \"_links\": {\n    //\u5305\u542bActuator\u81ea\u5df1\u7684\u4fe1\u606f\n    \"self\": {\"href\":\"http://localhost:8080/actuator\",\"templated\":false},\n    //\u5df2\u6ce8\u518c\u7684Bean\u4fe1\u606f\n    \"beans\":{\"href\":\"http://localhost:8080/actuator/beans\",\"templated\":false},\n    //\u5e94\u7528\u7a0b\u5e8f\u5065\u5eb7\u60c5\u51b5\u76d1\u63a7\n    \"health\":{\"href\":\"http://localhost:8080/actuator/health\",\"templated\":false},\n    \"health-path\":{\"href\":\"http://localhost:8080/actuator/health/{*path}\",\"templated\":true},\n    //\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u4fe1\u606f\n    \"info\":{\"href\":\"http://localhost:8080/actuator/info\",\"templated\":false},\n    //\u7cfb\u7edf\u73af\u5883\u76f8\u5173\u4fe1\u606f\n    \"env\": {\"href\":\"http://localhost:8080/actuator/env\",\"templated\":false},\n    \"env-toMatch\":{\"href\":\"http://localhost:8080/actuator/env/{toMatch}\",\"templated\":true},\n    //\u65e5\u5fd7\u76f8\u5173\u4fe1\u606f\n    \"loggers\":{\"href\":\"http://localhost:8080/actuator/loggers\",\"templated\":false},\n    \"loggers-name\":{\"href\":\"http://localhost:8080/actuator/loggers/{name}\",\"templated\":true},\n    //\u5feb\u901f\u83b7\u53d6JVM\u5806\u8f6c\u50a8\u6587\u4ef6\n    \"heapdump\":{\"href\":\"http://localhost:8080/actuator/heapdump\",\"templated\":false},\n    //\u5feb\u901f\u83b7\u53d6JVM\u7ebf\u7a0b\u8f6c\u50a8\u4fe1\u606f\n    \"threaddump\":{\"href\":\"http://localhost:8080/actuator/threaddump\",\"templated\":false},\n    //\u8ba1\u5212\u4efb\u52a1\u76f8\u5173\u4fe1\u606f\n    \"scheduledtasks\":{\"href\":\"http://localhost:8080/actuator/scheduledtasks\",\"templated\":false},\n    //\u8bf7\u6c42\u6620\u5c04\u76f8\u5173\u4fe1\u606f\n    \"mappings\":{\"href\":\"http://localhost:8080/actuator/mappings\",\"templated\":false},\n    ...\n  }\n}\n</code></pre> <p>\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 http://localhost:8080/actuator/info \u63a5\u53e3\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u8fd0\u884c\u73af\u5883\u4fe1\u606f\uff1a</p> <p></p> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u91cc\u5f97\u5230\u7684\u6570\u636e\u662f\u4e00\u4e2a\u7a7a\u7684\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u8fd8\u9700\u8981\u5355\u72ec\u5f00\u542f\u5bf9\u5e94\u6a21\u5757\u624d\u53ef\u4ee5\uff1a</p> <pre><code>management:\n  endpoints:\n    web:\n      exposure:\n        include: '*'\n  #\u5f00\u542f\u67d0\u4e9b\u9ed8\u8ba4\u4e3afalse\u7684\u4fe1\u606f\n  info:\n    env:\n      enabled: true\n    os:\n      enabled: true\n    java:\n      enabled: true\n</code></pre> <p>\u518d\u6b21\u8bf7\u6c42\uff0c\u5c31\u80fd\u83b7\u5f97\u8fd0\u884c\u73af\u5883\u76f8\u5173\u4fe1\u606f\u4e86\uff0c\u6bd4\u5982\u8fd9\u91cc\u7684Java\u7248\u672c\u3001JVM\u4fe1\u606f\u3001\u64cd\u4f5c\u7cfb\u7edf\u4fe1\u606f\u7b49\uff1a</p> <p></p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u8ba9health\u663e\u793a\u66f4\u52a0\u8be6\u7ec6\u7684\u7cfb\u7edf\u72b6\u6001\u4fe1\u606f\uff0c\u8fd9\u91cc\u6211\u4eec\u5f00\u542f\u4e00\u4e0b\u914d\u7f6e\uff1a</p> <pre><code>management:\n    ...\n  endpoint:\n    health:\n      show-details: always  #\u5c55\u793a\u8be6\u7ec6\u5185\u5bb9\n    env:\n      show-values: always  #\u603b\u662f\u76f4\u63a5\u5c55\u793a\u503c\n</code></pre> <p>\u73b0\u5728\u5c31\u80fd\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u5360\u7528\u76f8\u5173\u4fe1\u606f\u4e86\uff0c\u6bd4\u5982\u4e0b\u9762\u7684\u78c1\u76d8\u5360\u7528\u3001\u6570\u636e\u5e93\u7b49\u4fe1\u606f\uff1a</p> <p></p> <p>\u5305\u62ec\u5b8c\u6574\u7684\u7cfb\u7edf\u73af\u5883\u4fe1\u606f\uff0c\u6bd4\u5982\u6211\u4eec\u914d\u7f6e\u7684\u670d\u52a1\u56688080\u7aef\u53e3\uff1a</p> <p></p> <p>\u6211\u4eec\u53ea\u9700\u8981\u901a\u8fc7\u8fd9\u4e9b\u63a5\u53e3\u5c31\u80fd\u5feb\u901f\u83b7\u53d6\u5230\u5f53\u524d\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u4fe1\u606f\u4e86\u3002</p> <p>\u9ad8\u7ea7\u4e00\u70b9\u7684\u8fd8\u6709\u7ebf\u7a0b\u8f6c\u50a8\u548c\u5806\u5185\u5b58\u8f6c\u50a8\u6587\u4ef6\u76f4\u63a5\u751f\u6210\uff0c\u4fbf\u4e8e\u6211\u4eec\u5bf9Java\u7a0b\u5e8f\u7684\u8fd0\u884c\u60c5\u51b5\u8fdb\u884c\u5206\u6790\uff0c\u8fd9\u91cc\u6211\u4eec\u83b7\u53d6\u4e00\u4e0b\u5806\u5185\u5b58\u8f6c\u50a8\u6587\u4ef6\uff1ahttp://localhost:8080/actuator/heapdump\uff0c\u6587\u4ef6\u4e0b\u8f7d\u4e4b\u540e\u76f4\u63a5\u4f7f\u7528IDEA\u5c31\u80fd\u6253\u5f00\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5176\u4e2d\u521b\u5efa\u7684byte\u6570\u7ec4\u5bf9\u8c61\u8ba1\u6570\u8fbe\u5230\u4e8672020\u4e2a\uff0c\u5176\u4e2d\u6211\u4eec\u81ea\u5df1\u7684TestController\u5bf9\u8c61\u53ea\u6709\u6709\u4e00\u4e2a\uff1a</p> <p></p> <p>\u4ee5\u53ca\u5bf9\u5e94\u7684\u7ebf\u7a0b\u8f6c\u50a8\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7http://localhost:8080/actuator/threaddump\u76f4\u63a5\u83b7\u53d6\uff1a</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_16","title":"\u5b9e\u73b0\u539f\u7406\u63a2\u7a76\uff08\u9009\u5b66\uff09","text":"<p>\u6ce8\u610f\uff1a\u96be\u5ea6\u8f83\u5927\uff0c\u672c\u7248\u5757\u4f5c\u4e3a\u9009\u5b66\u5185\u5bb9\uff0c\u5728\u5f00\u59cb\u524d\uff0c\u5fc5\u987b\u5b8c\u6210SSM\u9636\u6bb5\u6e90\u7801\u89e3\u6790\u90e8\u5206\u7684\u5b66\u4e60\u3002</p> <p>\u6211\u4eec\u5728\u524d\u9762\u7684\u5b66\u4e60\u4e2d\u5207\u5b9e\u611f\u53d7\u5230\u4e86SpringBoot\u4e3a\u6211\u4eec\u5e26\u6765\u7684\u4fbf\u6377\uff0c\u90a3\u4e48\u5b83\u4e3a\u4f55\u80fd\u591f\u5b9e\u73b0\u5982\u6b64\u5feb\u6377\u7684\u5f00\u53d1\u6a21\u5f0f\uff0cstarter\u53c8\u662f\u4e00\u4e2a\u600e\u6837\u7684\u5b58\u5728\uff0c\u5b83\u662f\u5982\u4f55\u8fdb\u884c\u81ea\u52a8\u914d\u7f6e\u7684\uff0c\u6211\u4eec\u73b0\u5728\u5c31\u5f00\u59cb\u7814\u7a76\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_17","title":"\u542f\u52a8\u539f\u7406\u4e0e\u5b9e\u73b0","text":"<p>\u9996\u5148\u6211\u4eec\u6765\u770b\u770b\uff0cSpringBoot\u9879\u76ee\u542f\u52a8\u4e4b\u540e\uff0c\u505a\u4e86\u4ec0\u4e48\u4e8b\u60c5\uff0cSpringApplication\u4e2d\u7684\u9759\u6001<code>run</code>\u65b9\u6cd5\uff1a</p> <pre><code>public static ConfigurableApplicationContext run(Class&lt;?&gt; primarySource, String... args) {\n    return run(new Class[]{primarySource}, args);\n}\n</code></pre> <p>\u5957\u5a03\u5982\u4e0b\uff1a</p> <pre><code>public static ConfigurableApplicationContext run(Class&lt;?&gt;[] primarySources, String[] args) {\n    return (new SpringApplication(primarySources)).run(args);\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u91cc\u76f4\u63a5new\u4e86\u4e00\u4e2a\u65b0\u7684SpringApplication\u5bf9\u8c61\uff0c\u4f20\u5165\u6211\u4eec\u7684\u4e3b\u7c7b\u4f5c\u4e3a\u6784\u9020\u65b9\u6cd5\u53c2\u6570\uff0c\u5e76\u8c03\u7528\u4e86\u975estatic\u7684<code>run</code>\u65b9\u6cd5\uff0c\u6211\u4eec\u5148\u6765\u770b\u770b\u6784\u9020\u65b9\u6cd5\u91cc\u9762\u505a\u4e86\u4ec0\u4e48\u4e8b\u60c5\uff1a</p> <pre><code>public SpringApplication(ResourceLoader resourceLoader, Class&lt;?&gt;... primarySources) {\n    ...\n    //\u8d44\u6e90\u52a0\u8f7d\u5668\u9ed8\u8ba4\u6839\u636e\u524d\u9762\u5224\u65ad\uff0c\u8fd9\u91cc\u4e3anull\n    this.resourceLoader = resourceLoader;\n    //\u8bbe\u7f6e\u4e3b\u8981\u6e90\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u7684\u542f\u52a8\u4e3b\u7c7b\n    Assert.notNull(primarySources, \"PrimarySources must not be null\");\n    this.primarySources = new LinkedHashSet(Arrays.asList(primarySources));\n    //\u8fd9\u91cc\u662f\u5173\u952e\uff0c\u8fd9\u91cc\u4f1a\u5224\u65ad\u5f53\u524dSpringBoot\u5e94\u7528\u7a0b\u5e8f\u662f\u5426\u4e3aWeb\u9879\u76ee\uff0c\u5e76\u8fd4\u56de\u5f53\u524d\u7684\u9879\u76ee\u7c7b\u578b\n    //deduceFromClasspath\u662f\u6839\u636e\u7c7b\u8def\u5f84\u4e0b\u5224\u65ad\u662f\u5426\u5305\u542bSpringBootWeb\u4f9d\u8d56\uff0c\u5982\u679c\u4e0d\u5305\u542b\u5c31\u662fNONE\u7c7b\u578b\uff0c\u5305\u542b\u5c31\u662fSERVLET\u7c7b\u578b\n    this.webApplicationType = WebApplicationType.deduceFromClasspath();\n    this.bootstrapRegistryInitializers = new ArrayList(this.getSpringFactoriesInstances(BootstrapRegistryInitializer.class));\n    //\u83b7\u53d6\u5e76\u8bbe\u7f6e\u6240\u6709ApplicationContextInitializer\u5b9e\u73b0\uff0c\u8fd9\u4e9b\u90fd\u662f\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u521d\u59cb\u5316\u5668\n    //\u8fd9\u4e2a\u63a5\u53e3\u7528\u4e8e\u5728 Spring \u5bb9\u5668\u6267\u884c onRefresh \u65b9\u6cd5\u5237\u65b0\u4e4b\u524d\u6267\u884c\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\n        //\u901a\u5e38\u7528\u4e8e\u5411 SpringBoot \u542f\u52a8\u7684\u5bb9\u5668\u4e2d\u6ce8\u5165\u4e00\u4e9b\u5c5e\u6027\uff0c\u6bd4\u5982ContextIdApplicationContextInitializer\u5c31\u662f\n    //\u5c06\u914d\u7f6e\u4e2d\u5b9a\u4e49\u7684 spring.application.name \u5c5e\u6027\u503c\u8bbe\u5b9a\u4e3a\u5e94\u7528\u7a0b\u5e8f\u4e0a\u4e0b\u6587\u7684ID\n    this.setInitializers(this.getSpringFactoriesInstances(ApplicationContextInitializer.class));\n    //\u8bbe\u7f6e\u5e94\u7528\u7a0b\u5e8f\u76d1\u542c\u5668\n    this.setListeners(this.getSpringFactoriesInstances(ApplicationListener.class));\n    //\u627e\u5230\u5e76\u8bbe\u5b9a\u5f53\u524d\u7684\u542f\u52a8\u4e3b\u7c7b\n    this.mainApplicationClass = this.deduceMainApplicationClass();\n}\n</code></pre> <pre><code>static WebApplicationType deduceFromClasspath() {\n    //\u8fd9\u91cc\u7684ClassUtils.isPresent\u662f\u901a\u8fc7\u53cd\u5c04\u673a\u5236\u5224\u65ad\u7c7b\u8def\u5f84\u4e0b\u662f\u5426\u5b58\u5728\u5bf9\u5e94\u7684\u4f9d\u8d56\n        if (ClassUtils.isPresent(WEBFLUX_INDICATOR_CLASS, null) &amp;&amp; !ClassUtils.isPresent(WEBMVC_INDICATOR_CLASS, null)\n                &amp;&amp; !ClassUtils.isPresent(JERSEY_INDICATOR_CLASS, null)) {\n            return WebApplicationType.REACTIVE;   //\u5224\u65ad\u51fa\u5b58\u5728WebFlux\u4f9d\u8d56\u4e14\u5176\u4ed6\u4e0d\u5b58\u5728\uff0c\u8fd4\u56deWebFlux\u7c7b\u578b\n        }\n    //\u5982\u679c\u4e0d\u5305\u542bWebFlux\u76f8\u5173\u4f9d\u8d56\uff0c\u5c31\u627e\u627e\u6709\u6ca1\u6709Servlet\u76f8\u5173\u4f9d\u8d56\uff0c\u53ea\u8981\u53d1\u73b0\u7f3a\u5931\u76f4\u63a5\u8fd4\u56deNONE\u666e\u901a\u7c7b\u578b\n        for (String className : SERVLET_INDICATOR_CLASSES) {\n            if (!ClassUtils.isPresent(className, null)) {\n                return WebApplicationType.NONE;\n            }\n        }\n        return WebApplicationType.SERVLET; //\u5426\u5219\u5c31\u662fServlet\u73af\u5883\u4e86\uff0c\u8fd4\u56deSERVLET\u7c7b\u578b\uff08\u4e5f\u5c31\u662f\u6211\u4eec\u4e4b\u524d\u7528\u5230\u7684\uff09\n}\n</code></pre> <p>\u901a\u8fc7\u9605\u8bfb\u4e0a\u9762\u7684\u6e90\u7801\uff0c\u6211\u4eec\u53d1\u73b0<code>getSpringFactoriesInstances</code>\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u4e00\u6b21\u6027\u83b7\u53d6\u6307\u5b9a\u7c7b\u578b\u5df2\u6ce8\u518c\u7684\u5b9e\u73b0\u7c7b\uff0c\u6211\u4eec\u5148\u6765\u7814\u7a76\u4e00\u4e0b\u5b83\u662f\u600e\u4e48\u505a\u5230\u7684\u3002\u8fd9\u91cc\u5c31\u8981\u63d0\u5230<code>spring.factories</code>\u6587\u4ef6\u4e86\uff0c\u5b83\u662f Spring \u4eff\u9020Java SPI\u5b9e\u73b0\u7684\u4e00\u79cd\u7c7b\u52a0\u8f7d\u673a\u5236\u3002\u5b83\u5728 META-INF/spring.factories \u6587\u4ef6\u4e2d\u914d\u7f6e\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u540d\u79f0\uff0c\u7136\u540e\u5728\u7a0b\u5e8f\u4e2d\u8bfb\u53d6\u8fd9\u4e9b\u914d\u7f6e\u6587\u4ef6\u5e76\u5b9e\u4f8b\u5316\u3002\u8fd9\u79cd\u81ea\u5b9a\u4e49\u7684SPI\u673a\u5236\u662f Spring Boot Starter \u5b9e\u73b0\u7684\u57fa\u7840\u3002</p> <p>SPI\u7684\u5e38\u89c1\u4f8b\u5b50\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u9a71\u52a8\u52a0\u8f7d\u63a5\u53e3\u5b9e\u73b0\u7c7b\u7684\u52a0\u8f7d\uff1aJDBC\u52a0\u8f7d\u4e0d\u540c\u7c7b\u578b\u6570\u636e\u5e93\u7684\u9a71\u52a8</li> <li>\u65e5\u5fd7\u95e8\u9762\u63a5\u53e3\u5b9e\u73b0\u7c7b\u52a0\u8f7d\uff1aSLF4J\u52a0\u8f7d\u4e0d\u540c\u63d0\u4f9b\u5546\u7684\u65e5\u5fd7\u5b9e\u73b0\u7c7b</li> </ul> <p>\u8bf4\u767d\u4e86\u5c31\u662f\u4eba\u5bb6\u5b9a\u4e49\u63a5\u53e3\uff0c\u4f46\u662f\u5b9e\u73b0\u53ef\u80fd\u6709\u5f88\u591a\u79cd\uff0c\u4f46\u662f\u6838\u5fc3\u53ea\u63d0\u4f9b\u63a5\u53e3\uff0c\u9700\u8981\u6211\u4eec\u6309\u9700\u9009\u62e9\u5bf9\u5e94\u7684\u5b9e\u73b0\uff0c\u8fd9\u79cd\u65b9\u5f0f\u662f\u9ad8\u5ea6\u89e3\u8026\u7684\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u6765\u770b\u770b<code>spring-boot-starter</code>\u4f9d\u8d56\u4e2d\u600e\u4e48\u5b9a\u4e49\u7684\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a\u5f88\u5173\u952e\u7684\u70b9\uff1a</p> <pre><code>&lt;dependency&gt;\n   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n   &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt;\n   &lt;version&gt;3.1.1&lt;/version&gt;\n   &lt;scope&gt;compile&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u8fd9\u4e2a<code>spring-boot-autoconfigure</code>\u662f\u4ec0\u4e48\u4e1c\u897f\uff1f\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u6574\u4e2a\u4f9d\u8d56\u5b9e\u73b0\u81ea\u52a8\u914d\u7f6e\u7684\u5173\u952e\u3002\u6253\u5f00\u8fd9\u4e2a\u4f9d\u8d56\u5185\u90e8\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u786e\u5b9e\u6709\u4e00\u4e2a<code>spring.factories</code>\u6587\u4ef6\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u91cc\u9762\u5b9a\u4e49\u4e86\u5f88\u591a\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\uff0c\u6bd4\u5982\u6211\u4eec\u521a\u521a\u770b\u5230\u7684<code>ApplicationContextInitializer</code>\u63a5\u53e3\uff1a</p> <p></p> <p>\u4e0d\u4ec5\u4ec5\u662f<code>spring-boot-starter</code>\u5b58\u5728\u8fd9\u6837\u7684\u6587\u4ef6\uff0c\u5176\u4ed6\u5f88\u591a\u4f9d\u8d56\uff0c\u6bd4\u5982<code>spring-boot-start-test</code>\u4e5f\u6709\u7740\u5bf9\u5e94\u7684<code>autoconfigure</code>\u6a21\u5757\uff0c\u53ea\u4e0d\u8fc7\u5927\u90e8\u5206SpringBoot\u7ef4\u62a4\u7684\u7ec4\u4ef6\uff0c\u90fd\u9ed8\u8ba4\u5c06\u5176\u4e2d\u7684<code>spring.factories</code>\u4fe1\u606f\u7edf\u4e00\u5199\u5230\u4e86<code>spring-boot-autoconfigure</code>\u548c<code>spring-boot-starter</code>\u4e2d\uff0c\u65b9\u4fbf\u540e\u7eed\u7ef4\u62a4\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u6e05\u695a\uff0c\u539f\u6765\u8fd9\u4e9b\u90fd\u662f\u901a\u8fc7\u4e00\u4e2a\u5355\u72ec\u7684\u6587\u4ef6\u5b9a\u4e49\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u6765\u770b\u770b<code>getSpringFactoriesInstances</code>\u65b9\u6cd5\u505a\u4e86\u4ec0\u4e48\uff1a</p> <pre><code>private &lt;T&gt; List&lt;T&gt; getSpringFactoriesInstances(Class&lt;T&gt; type) {\n    return this.getSpringFactoriesInstances(type, (SpringFactoriesLoader.ArgumentResolver)null);\n}\n\nprivate &lt;T&gt; List&lt;T&gt; getSpringFactoriesInstances(Class&lt;T&gt; type, SpringFactoriesLoader.ArgumentResolver argumentResolver) {\n    //\u8fd9\u91cc\u901a\u8fc7SpringFactoriesLoader\u52a0\u8f7d\u7c7b\u8def\u5f84\u4e0b\u7684\u6587\u4ef6\n    return SpringFactoriesLoader.forDefaultResourceLocation(this.getClassLoader()).load(type, argumentResolver);\n}\n</code></pre> <pre><code>public static SpringFactoriesLoader forDefaultResourceLocation(@Nullable ClassLoader classLoader) {\n    //\u67e5\u627e\u6240\u6709\u4f9d\u8d56\u4e0b\u7684META-INF/spring.factories\u6587\u4ef6\uff0c\u89e3\u6790\u5e76\u5f97\u5230\u6700\u7ec8\u7684SpringFactoriesLoader\u5bf9\u8c61\n    return forResourceLocation(\"META-INF/spring.factories\", classLoader);\n}\n</code></pre> <p>\u6240\u4ee5<code>getSpringFactoriesInstances</code>\u5176\u5b9e\u5c31\u662f\u901a\u8fc7\u8bfb\u53d6\u6240\u6709<code>META-INF/spring.factories</code>\u6587\u4ef6\u5f97\u5230\u7684\u5217\u8868\uff0c\u7136\u540e\u5b9e\u4f8b\u5316\u6307\u5b9a\u7c7b\u578b\u4e0b\u8bfb\u53d6\u5230\u7684\u6240\u6709\u5b9e\u73b0\u7c7b\u5e76\u8fd4\u56de\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u6e05\u695aSpringBoot\u8fd9\u4e00\u5927\u5806\u53c2\u4e0e\u81ea\u52a8\u914d\u7f6e\u7684\u7c7b\u662f\u600e\u4e48\u52a0\u8f7d\u8fdb\u6765\u7684\u4e86\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u56de\u5230\u4e00\u5f00\u59cb\u7684\u5730\u65b9\uff0c\u76ee\u524dSpringApplication\u5bf9\u8c61\u5df2\u7ecf\u6784\u9020\u597d\u4e86\uff0c\u7ee7\u7eed\u6765\u770b\u770b<code>run</code>\u65b9\u6cd5\u505a\u4e86\u4ec0\u4e48\uff1a</p> <pre><code>public ConfigurableApplicationContext run(String... args) {\n    long startTime = System.nanoTime();\n    DefaultBootstrapContext bootstrapContext = this.createBootstrapContext();\n    ConfigurableApplicationContext context = null;\n    this.configureHeadlessProperty();\n    //\u83b7\u53d6\u6240\u6709\u7684SpringApplicationRunListener\uff0c\u5e76\u901a\u77e5\u542f\u52a8\u4e8b\u4ef6\uff0c\u9ed8\u8ba4\u53ea\u6709\u4e00\u4e2a\u5b9e\u73b0\u7c7bEventPublishingRunListener\n    //EventPublishingRunListener\u4f1a\u5c06\u521d\u59cb\u5316\u5404\u4e2a\u9636\u6bb5\u7684\u4e8b\u4ef6\u8f6c\u53d1\u7ed9\u6240\u6709\u76d1\u542c\u5668\n    SpringApplicationRunListeners listeners = this.getRunListeners(args);\n    listeners.starting(bootstrapContext, this.mainApplicationClass);\n    try {\n        //\u73af\u5883\u914d\u7f6e\uff0c\u5305\u62ec\u6211\u4eec\u4e4b\u524d\u914d\u7f6e\u7684\u591a\u73af\u5883\u9009\u62e9\n        ApplicationArguments applicationArguments = new DefaultApplicationArguments(args);\n        ConfigurableEnvironment environment = this.prepareEnvironment(listeners, bootstrapContext, applicationArguments);\n        //\u6253\u5370Banner\uff0c\u4ece\u8fd9\u91cc\u5f00\u59cb\u6211\u4eec\u5c31\u53ef\u4ee5\u5207\u5207\u5b9e\u5b9e\u770b\u5230\u8fd0\u884c\u72b6\u4e86\n        Banner printedBanner = this.printBanner(environment);\n        //\u521b\u5efaApplicationContext\uff0c\u4e5f\u5c31\u662f\u6574\u4e2aSpring\u5e94\u7528\u7a0b\u5e8f\u7684IoC\u5bb9\u5668\uff0cSSM\u9636\u6bb5\u5df2\u7ecf\u8be6\u7ec6\u4ecb\u7ecd\u8fc7\uff0c\u6ce8\u610f\u8fd9\u91cc\u4f1a\u6839\u636e\u6784\u9020\u65f6\u5f97\u5230\u7684\u7c7b\u578b\uff0c\u521b\u5efa\u4e0d\u540c\u7684ApplicationContext\u5b9e\u73b0\u7c7b\uff08\u6bd4\u5982Servlet\u73af\u5883\u4e0b\u5c31\u662fWeb\u5bb9\u5668\uff09\n        context = this.createApplicationContext();\n        context.setApplicationStartup(this.applicationStartup);\n        //\u5bf9ApplicationContext\u8fdb\u884c\u524d\u7f6e\u5904\u7406\uff0c\u8fd9\u91cc\u4f1a\u5c06\u521b\u5efa\u5bf9\u8c61\u65f6\u8bbe\u5b9a\u7684\u6240\u6709ApplicationContextInitializer\u62ff\u6765\u6267\u884c\u4e00\u6b21initialize\u65b9\u6cd5\uff0c\u8fd9\u4e5f\u9a8c\u8bc1\u4e86\u6211\u4eec\u4e4b\u524d\u7684\u8bf4\u6cd5\uff0c\u8fd9\u4e00\u6b65\u786e\u5b9e\u662f\u5728\u5237\u65b0\u5bb9\u5668\u4e4b\u524d\u8fdb\u884c\u7684\n        this.prepareContext(bootstrapContext, context, environment, listeners, applicationArguments, printedBanner);\n        //\u6267\u884cApplicationContext\u7684refresh\u65b9\u6cd5\uff0c\u5237\u65b0\u5bb9\u5668\u521d\u59cb\u5316\u6240\u6709\u7684Bean\uff0c\u8fd9\u4e2a\u4e5f\u5728SSM\u9636\u6bb5\u8be6\u7ec6\u4ecb\u7ecd\u8fc7\u4e86\n        this.refreshContext(context);\n        this.afterRefresh(context, applicationArguments);\n        Duration timeTakenToStartup = Duration.ofNanos(System.nanoTime() - startTime);\n        if (this.logStartupInfo) {\n            (new StartupInfoLogger(this.mainApplicationClass)).logStarted(this.getApplicationLog(), timeTakenToStartup);\n        }\n        listeners.started(context, timeTakenToStartup);\n        //\u56e0\u4e3a\u6240\u6709\u7684Bean\u90fd\u5df2\u7ecf\u52a0\u8f7d\uff0c\u8fd9\u91cc\u5c31\u53ef\u4ee5\u8c03\u7528\u5168\u90e8\u7684\u81ea\u5b9a\u4e49Runner\u5b9e\u73b0\u4e86\n        this.callRunners(context, applicationArguments);\n    ...\n    //\u7ed3\u675f\n    return context;\n}\n</code></pre> <p>\u81f3\u6b64\uff0cSpringBoot\u9879\u76ee\u5c31\u6b63\u5e38\u542f\u52a8\u4e86\u3002</p> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u5373\u4f7f\u662fSpringBoot\uff0c\u4e5f\u662f\u79bb\u4e0d\u5f00Spring\u6700\u6838\u5fc3\u7684ApplicationContext\u5bb9\u5668\uff0c\u56e0\u4e3a\u5b83\u518d\u600e\u4e48\u4e5f\u662f\u4e00\u4e2aSpring\u9879\u76ee\uff0c\u5373\u4f7f\u73a9\u5f97\u518d\u9ad8\u7ea7\u4e0d\u8fd8\u662f\u5f97\u56f4\u7ed5IoC\u5bb9\u5668\u6765\u8fdb\u884c\u4e48\u3002\u6240\u4ee5\u8bf4\uff0cSSM\u9636\u6bb5\u5b66\u4e60\u7684\u5185\u5bb9\u624d\u662f\u771f\u6b63\u7684\u6838\u5fc3\uff0c\u800cSpringBoot\u4ec5\u4ec5\u662f\u5bf9Spring\u8fdb\u884c\u7684\u4e00\u5c42\u5f3a\u5316\u5c01\u88c5\uff0c\u4fbf\u4e8e\u5feb\u901f\u521b\u5efaSpring\u9879\u76ee\u7f62\u4e86\uff0c\u8fd9\u4e5f\u662f\u4e3a\u4ec0\u4e48\u4e00\u76f4\u5f3a\u8c03\u4e0d\u80fd\u8df3\u8fc7SSM\u5148\u5b66SpringBoot\u7684\u539f\u56e0\u3002</p> <p>\u65e2\u7136\u90fd\u8c08\u5230\u8fd9\u91cc\u4e86\uff0c\u6211\u4eec\u4e0d\u59a8\u518d\u6765\u770b\u4e00\u4e0b\u8fd9\u91cc\u7684ApplicationContext\u662f\u600e\u4e48\u6765\u7684\uff0c\u6253\u5f00<code>createApplicationContext</code>\u65b9\u6cd5\uff1a</p> <pre><code>protected ConfigurableApplicationContext createApplicationContext() {\n    return this.applicationContextFactory.create(this.webApplicationType); //\u8fd9\u4e2a\u7c7b\u578b\u5df2\u7ecf\u5728new\u7684\u65f6\u5019\u786e\u5b9a\u4e86\n}\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\u5728\u6784\u9020\u65b9\u6cd5\u4e2d<code>applicationContextFactory</code>\u76f4\u63a5\u4f7f\u7528\u7684\u662fDEFAULT\uff1a</p> <pre><code>...\nthis.applicationContextFactory = ApplicationContextFactory.DEFAULT;\n...\n</code></pre> <pre><code>ApplicationContextFactory DEFAULT = new DefaultApplicationContextFactory();   //\u4f7f\u7528\u7684\u662f\u9ed8\u8ba4\u5b9e\u73b0\u7c7b\n</code></pre> <p>\u6211\u4eec\u7ee7\u7eed\u5411\u4e0b\u6252DefaultApplicationContextFactory\u7684\u6e90\u7801<code>create</code>\u65b9\u6cd5\u90e8\u5206\uff1a</p> <pre><code>public ConfigurableApplicationContext create(WebApplicationType webApplicationType) {\n    try {\n        return (ConfigurableApplicationContext)this.getFromSpringFactories(webApplicationType, ApplicationContextFactory::create, this::createDefaultApplicationContext);  //\u5957\u5a03\u83b7\u53d6ConfigurableApplicationContext\u5b9e\u73b0\n    } catch (Exception var3) {\n        throw new IllegalStateException(\"Unable create a default ApplicationContext instance, you may need a custom ApplicationContextFactory\", var3);\n    }\n}\n\nprivate &lt;T&gt; T getFromSpringFactories(WebApplicationType webApplicationType,\n            BiFunction&lt;ApplicationContextFactory, WebApplicationType, T&gt; action, Supplier&lt;T&gt; defaultResult) {\n    //\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u91cc\u53c8\u662f\u901a\u8fc7SpringFactoriesLoader\u83b7\u53d6\u5230\u6240\u6709\u5019\u9009\u7684ApplicationContextFactory\u5b9e\u73b0\n  for (ApplicationContextFactory candidate : SpringFactoriesLoader.loadFactories(ApplicationContextFactory.class,\n                getClass().getClassLoader())) {\n            T result = action.apply(candidate, webApplicationType);\n            if (result != null) {\n                return result;   //\u5982\u679c\u662fServlet\u73af\u5883\uff0c\u8fd9\u91cc\u4f1a\u627e\u5230\u5b9e\u73b0\uff0c\u76f4\u63a5\u8fd4\u56de\n            }\n        }\n    //\u5982\u679c\u662f\u666e\u901a\u7684SpringBoot\u9879\u76ee\uff0c\u8fdeWeb\u73af\u5883\u90fd\u6ca1\u6709\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u521b\u5efa\u666e\u901a\u7684ApplicationContext\n        return (defaultResult != null) ? defaultResult.get() : null;\n}\n</code></pre> <p>\u65e2\u7136\u8fd9\u91cc\u53c8\u662fSpringFactoriesLoader\u52a0\u8f7dApplicationContextFactory\u5b9e\u73b0\uff0c\u6211\u4eec\u5c31\u76f4\u63a5\u53bb\u770b\u6709\u4e9b\u5565\uff1a</p> <p></p> <p>\u6211\u4eec\u4e5f\u4e0d\u51fa\u610f\u5916\u5730\u5728<code>spring.factories</code>\u4e2d\u627e\u5230\u4e86\u8fd9\u4e24\u4e2a\u5b9e\u73b0\uff0c\u56e0\u4e3a\u76ee\u524d\u662fServlet\u73af\u5883\uff0c\u6240\u4ee5\u5728\u8fd4\u56de\u65f6\u5f97\u5230\u6700\u7ec8\u7684\u7ed3\u679c\uff0c\u4e5f\u5c31\u662f\u751f\u6210\u7684AnnotationConfigServletWebServerApplicationContext\u5bf9\u8c61\uff0c\u4e5f\u5c31\u662f\u8bf4\u5230\u8fd9\u91cc\u4e3a\u6b62\uff0cSpring\u7684\u5bb9\u5668\u5c31\u57fa\u672c\u5df2\u7ecf\u786e\u5b9a\u4e86\uff0c\u5dee\u4e0d\u591a\u53ef\u4ee5\u5f00\u59cb\u8fd0\u884c\u4e86\uff0c\u4e0b\u4e00\u4e2a\u90e8\u5206\u6211\u4eec\u5c06\u7ee7\u7eed\u4ecb\u7ecdSpringBoot\u662f\u5982\u4f55\u5b9e\u73b0\u81ea\u52a8\u626b\u63cf\u4ee5\u53ca\u81ea\u52a8\u914d\u7f6e\u7684\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#_18","title":"\u81ea\u52a8\u914d\u7f6e\u539f\u7406","text":"<p>\u65e2\u7136\u4e3b\u7c7b\u5df2\u7ecf\u5728\u521d\u59cb\u9636\u6bb5\u6ce8\u518c\u4e3aBean\uff0c\u90a3\u4e48\u5728\u52a0\u8f7d\u65f6\uff0c\u5c31\u4f1a\u6839\u636e\u6ce8\u89e3\u5b9a\u4e49\uff0c\u8fdb\u884c\u66f4\u591a\u7684\u989d\u5916\u64cd\u4f5c\u3002\u6240\u4ee5\u6211\u4eec\u6765\u770b\u770b\u4e3b\u7c7b\u4e0a\u7684<code>@SpringBootApplication</code>\u6ce8\u89e3\u505a\u4e86\u4ec0\u4e48\u4e8b\u60c5\u3002</p> <pre><code>@Target({ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@SpringBootConfiguration\n@EnableAutoConfiguration\n@ComponentScan(\n    excludeFilters = {@Filter(\n    type = FilterType.CUSTOM,\n    classes = {TypeExcludeFilter.class}\n), @Filter(\n    type = FilterType.CUSTOM,\n    classes = {AutoConfigurationExcludeFilter.class}\n)}\n)\npublic @interface SpringBootApplication {\n  ...\n</code></pre> <p>\u6211\u4eec\u53d1\u73b0\uff0c<code>@SpringBootApplication</code>\u4e0a\u6dfb\u52a0\u4e86<code>@ComponentScan</code>\u6ce8\u89e3\uff0c\u6b64\u6ce8\u89e3\u6211\u4eec\u6b64\u524d\u5df2\u7ecf\u8ba4\u8bc6\u8fc7\u4e86\uff0c\u4f46\u662f\u8fd9\u91cc\u5e76\u6ca1\u6709\u914d\u7f6e\u5177\u4f53\u626b\u63cf\u7684\u5305\uff0c\u56e0\u6b64\u5b83\u4f1a\u81ea\u52a8\u5c06\u58f0\u660e\u6b64\u63a5\u53e3\u7684\u7c7b\u6240\u5728\u7684\u5305\u4f5c\u4e3abasePackage\uff0c\u6240\u4ee5\uff0c\u5f53\u6dfb\u52a0<code>@SpringBootApplication</code>\u4e4b\u540e\u4e5f\u5c31\u7b49\u4e8e\u76f4\u63a5\u5f00\u542f\u4e86\u81ea\u52a8\u626b\u63cf\uff0c\u6211\u4eec\u6240\u6709\u7684\u914d\u7f6e\u90fd\u4f1a\u81ea\u52a8\u52a0\u8f7d\uff0c\u4f46\u662f\u4e00\u5b9a\u6ce8\u610f\u4e0d\u80fd\u5728\u4e3b\u7c7b\u4e4b\u5916\u7684\u5305\u8fdb\u884cBean\u5b9a\u4e49\uff0c\u5426\u5219\u65e0\u6cd5\u626b\u63cf\u5230\uff0c\u9700\u8981\u624b\u52a8\u914d\u7f6e\u3002</p> <p>\u6211\u4eec\u81ea\u5df1\u7c7b\u8def\u5f84\u4e0b\u7684\u914d\u7f6e\u3001\u8fd8\u6709\u5404\u79cdBean\u5b9a\u4e49\u5982\u4f55\u8bfb\u53d6\u7684\u95ee\u9898\u89e3\u51b3\u4e86\uff0c\u63a5\u7740\u6211\u4eec\u6765\u770b\u7b2c\u4e8c\u4e2a\u6ce8\u89e3<code>@EnableAutoConfiguration</code>\uff0c\u5b83\u5c31\u662f\u5176\u4ed6Starter\u81ea\u52a8\u914d\u7f6e\u7684\u6838\u5fc3\u4e86\uff0c\u6211\u4eec\u6765\u770b\u770b\u5b83\u662f\u5982\u4f55\u5b9a\u4e49\u7684\uff1a</p> <pre><code>@Target({ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@Inherited\n@AutoConfigurationPackage\n@Import({AutoConfigurationImportSelector.class})\npublic @interface EnableAutoConfiguration {\n  ...\n</code></pre> <p>\u8fd9\u91cc\u5c31\u662fSSM\u9636\u6bb5\u6211\u4eec\u8ba4\u8bc6\u7684\u8001\u5957\u8def\u4e86\uff0c\u76f4\u63a5\u4e00\u624b<code>@Import</code>\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u6765\u5c06\u4e00\u4e9b\u5916\u90e8\u7684\u7c7b\u8fdb\u884c\u52a0\u8f7d\u3002\u6211\u4eec\u6765\u770b\u770bAutoConfigurationImportSelector\u505a\u4e86\u4ec0\u4e48\u4e8b\u60c5\uff1a</p> <pre><code>public class AutoConfigurationImportSelector implements DeferredImportSelector, BeanClassLoaderAware, ResourceLoaderAware, BeanFactoryAware, EnvironmentAware, Ordered {\n        ...\n}\n</code></pre> <p>\u6211\u4eec\u770b\u5230\u5b83\u5b9e\u73b0\u4e86\u5f88\u591a\u63a5\u53e3\uff0c\u5305\u62ec\u5927\u91cf\u7684Aware\u63a5\u53e3\uff0c\u6211\u4eec\u5728SSM\u9636\u6bb5\u4e5f\u4ecb\u7ecd\u8fc7\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u4e3a\u4e86\u611f\u77e5\u67d0\u4e9b\u5fc5\u8981\u7684\u5bf9\u8c61\uff0c\u5728\u52a0\u8f7d\u65f6\u5c06\u5176\u5b58\u5230\u5f53\u524d\u7c7b\u4e2d\u3002</p> <p>\u5176\u4e2d\u6700\u6838\u5fc3\u7684\u662f<code>DeferredImportSelector</code>\u63a5\u53e3\uff0c\u5b83\u662f<code>ImportSelector</code>\u7684\u5b50\u7c7b\uff0c\u5b83\u5b9a\u4e49\u4e86<code>selectImports</code>\u65b9\u6cd5\uff0c\u7528\u4e8e\u8fd4\u56de\u9700\u8981\u52a0\u8f7d\u7684\u7c7b\u540d\u79f0\uff0c\u5728Spring\u52a0\u8f7dImportSelector\u65f6\uff0c\u4f1a\u8c03\u7528\u6b64\u65b9\u6cd5\u6765\u83b7\u53d6\u66f4\u591a\u9700\u8981\u52a0\u8f7d\u7684\u7c7b\uff0c\u5e76\u5c06\u8fd9\u4e9b\u7c7b\u5168\u90e8\u6ce8\u518c\u4e3aBean\uff1a</p> <pre><code>public interface ImportSelector {\n    String[] selectImports(AnnotationMetadata importingClassMetadata);\n\n    @Nullable\n    default Predicate&lt;String&gt; getExclusionFilter() {\n        return null;\n    }\n}\n</code></pre> <p>\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u4e86\u89e3\u4e86\u4e24\u79cd\u4f7f\u7528<code>@Import</code>\u6709\u7279\u6b8a\u673a\u5236\u7684\u63a5\u53e3\uff1aImportSelector\uff08\u8fd9\u91cc\u7528\u5230\u7684\uff09\u548cImportBeanDefinitionRegistrar\uff08\u4e4b\u524dSSM\u9636\u6bb5\u6e90\u7801\u6709\u8bb2\uff09\u5f53\u7136\u8fd8\u6709\u666e\u901a\u7684<code>@Configuration</code>\u914d\u7f6e\u7c7b\u3002</p> <p>\u4e3a\u4e86\u540e\u7eed\u66f4\u597d\u7406\u89e3\u6211\u4eec\u53ef\u4ee5\u6765\u9605\u8bfb\u4e00\u4e0b<code>ConfigurationClassPostProcessor</code>\u7684\u6e90\u7801\uff0c\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u540e\u7f6e\u5904\u7406\u5668\u662fSpring\u4e2d\u63d0\u4f9b\u7684\uff0c\u8fd9\u662f\u4e13\u95e8\u7528\u4e8e\u5904\u7406\u914d\u7f6e\u7c7b\u7684\u540e\u7f6e\u5904\u7406\u5668\uff0c\u5176\u4e2d<code>ImportBeanDefinitionRegistrar</code>\uff0c\u8fd8\u6709\u8fd9\u91cc\u7684<code>ImportSelector</code>\u90fd\u662f\u9760\u5b83\u6765\u5904\u7406\uff0c\u4e0d\u8fc7\u5f53\u65f6Spring\u9636\u6bb5\u6ca1\u6709\u6df1\u5165\u8bb2\u89e3\uff0c\u6211\u4eec\u6765\u770b\u770b\u5b83\u5230\u5e95\u662f\u5982\u4f55\u5904\u7406<code>@Import</code>\u7684\uff1a</p> <pre><code>@Override\npublic void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) {\n        ...\n        processConfigBeanDefinitions(registry);   //\u5e38\u89c4\u5957\u5a03\n}\n</code></pre> <pre><code>public void processConfigBeanDefinitions(BeanDefinitionRegistry registry) {\n    //\u6ce8\u610f\u8fd9\u4e2a\u540e\u7f6e\u5904\u7406\u5668\u7ee7\u627f\u81eaBeanDefinitionRegistryPostProcessor\n    //\u6240\u4ee5\u8fd9\u4e2a\u9636\u6bb5\u4ec5\u4ec5\u662f\u5df2\u7ecf\u5b8c\u6210\u626b\u63cf\u4e86\u6240\u6709\u7684Bean\uff0c\u5f97\u5230\u4e86\u6240\u6709\u7684BeanDefinition\uff0c\u4f46\u662f\u8fd8\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u5904\u7406\n    //candidate\u662f\u5019\u9009\u8005\u7684\u610f\u601d\uff0c\u4e00\u4f1a\u4f1a\u5c06\u6807\u8bb0\u4e86@Configuration\u7684\u7c7b\u4f5c\u4e3aConfigurationClass\u52a0\u5165\u5230configCandidates\u4e2d\n    List&lt;BeanDefinitionHolder&gt; configCandidates = new ArrayList&lt;&gt;();\n    //\u76f4\u63a5\u53d6\u51fa\u6240\u6709\u5df2\u6ce8\u518cBean\u7684\u540d\u79f0\n    String[] candidateNames = registry.getBeanDefinitionNames();\n    for (String beanName : candidateNames) {\n       //\u4f9d\u6b21\u62ff\u5230\u5bf9\u5e94\u7684Bean\u5b9a\u4e49\uff0c\u7136\u540e\u8fdb\u884c\u5224\u65ad\n       BeanDefinition beanDef = registry.getBeanDefinition(beanName);\n       if (beanDef.getAttribute(ConfigurationClassUtils.CONFIGURATION_CLASS_ATTRIBUTE) != null) {\n          ...\n       }\n       else if (ConfigurationClassUtils.checkConfigurationClassCandidate(beanDef, this.metadataReaderFactory)) {   //\u5224\u65ad\u662f\u5426\u4e3a\u6253\u4e86 @Configuration \u7684\u914d\u7f6e\u7c7b\uff0c\u5982\u679c\u662f\u5c31\u52a0\u5165\u5230\u5019\u9009\u5217\u8868\u4e2d\n          configCandidates.add(new BeanDefinitionHolder(beanDef, beanName));\n       }\n    }\n    // \u5982\u679c\u4e00\u4e2a\u6253\u4e86 @Configuration \u7684\u7c7b\u90fd\u6ca1\u53d1\u73b0\uff0c\u76f4\u63a5\u8fd4\u56de\n    if (configCandidates.isEmpty()) {\n       return;\n    }\n    // \u5bf9\u6240\u6709\u7684\u914d\u7f6e\u7c7b\u4f9d\u636e @Order \u8fdb\u884c\u6392\u5e8f\n    configCandidates.sort((bd1, bd2) -&gt; {\n       int i1 = ConfigurationClassUtils.getOrder(bd1.getBeanDefinition());\n       int i2 = ConfigurationClassUtils.getOrder(bd2.getBeanDefinition());\n       return Integer.compare(i1, i2);\n    });\n    ...\n    // \u8fd9\u91cc\u4f7f\u7528do-while\u8bed\u53e5\u4f9d\u6b21\u89e3\u6790\u6240\u6709\u7684\u914d\u7f6e\u7c7b\n    ConfigurationClassParser parser = new ConfigurationClassParser(\n          this.metadataReaderFactory, this.problemReporter, this.environment,\n          this.resourceLoader, this.componentScanBeanNameGenerator, registry);\n    Set&lt;BeanDefinitionHolder&gt; candidates = new LinkedHashSet&lt;&gt;(configCandidates);\n    Set&lt;ConfigurationClass&gt; alreadyParsed = new HashSet&lt;&gt;(configCandidates.size());\n    do {\n       StartupStep processConfig = this.applicationStartup.start(\"spring.context.config-classes.parse\");\n       //\u8fd9\u91cc\u5c31\u4f1a\u901a\u8fc7Parser\u89e3\u6790\u914d\u7f6e\u7c7b\u4e2d\u5927\u90e8\u5206\u5185\u5bb9\uff0c\u5305\u62ec\u6211\u4eec\u4e4b\u524d\u9047\u5230\u7684@Import\u6ce8\u89e3\n             parser.parse(candidates);\n             parser.validate();\n       //\u89e3\u6790\u5b8c\u6210\u540e\u8bfb\u53d6\u5230\u6240\u6709\u7684\u914d\u7f6e\u7c7b\n       Set&lt;ConfigurationClass&gt; configClasses = new LinkedHashSet&lt;&gt;(parser.getConfigurationClasses());\n             configClasses.removeAll(alreadyParsed);\n       ... \n       //\u5c06\u4e0a\u9762\u8bfb\u53d6\u7684\u914d\u7f6e\u7c7b\u52a0\u8f7d\u4e3aBean\n       this.reader.loadBeanDefinitions(configClasses);\n       ...\n    }\n    while (!candidates.isEmpty());\n    ...\n}\n</code></pre> <p>\u6211\u4eec\u5c31\u63a5\u7740\u6765\u770b\uff0c<code>ConfigurationClassParser</code>\u662f\u5982\u4f55\u8fdb\u884c\u89e3\u6790\u7684\uff0c\u76f4\u63a5\u8fdb\u5165<code>parse</code>\u65b9\u6cd5\u7684\u5173\u952e\u90e8\u5206\uff1a</p> <pre><code>protected void processConfigurationClass(ConfigurationClass configClass, Predicate&lt;String&gt; filter) throws IOException {\n      //\u5904\u7406 @Conditional \u76f8\u5173\u6ce8\u89e3\u5904\u7406\uff0c\u540e\u9762\u4f1a\u8bb2\n    if (!this.conditionEvaluator.shouldSkip(configClass.getMetadata(), ConfigurationPhase.PARSE_CONFIGURATION)) {\n        ...\n        }\n        ConfigurationClassParser.SourceClass sourceClass = this.asSourceClass(configClass, filter);\n        do {\n            //\u8fd9\u91cc\u5c31\u662f\u6700\u6838\u5fc3\u4e86\n            sourceClass = this.doProcessConfigurationClass(configClass, sourceClass, filter);\n        } while(sourceClass != null);\n\n        this.configurationClasses.put(configClass, configClass);\n    }\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u518d\u6765\u770b\u6700\u6838\u5fc3\u7684<code>doProcessConfigurationClass</code>\u65b9\u6cd5\uff1a</p> <pre><code>protected final SourceClass doProcessConfigurationClass(ConfigurationClass configClass, SourceClass sourceClass)\n    ...\n    processImports(configClass, sourceClass, getImports(sourceClass), true);    // \u5904\u7406Import\u6ce8\u89e3\n    ...\n    return null;\n}\n</code></pre> <pre><code>private void processImports(ConfigurationClass configClass, SourceClass currentSourceClass,\n            Collection&lt;SourceClass&gt; importCandidates, Predicate&lt;String&gt; exclusionFilter,\n            boolean checkForCircularImports) {\n            ...\n        if (checkForCircularImports &amp;&amp; isChainedImportOnStack(configClass)) {\n            //\u68c0\u67e5\u662f\u5426\u5b58\u5728\u5faa\u73af\u5bfc\u5165\u60c5\u51b5\n            this.problemReporter.error(new CircularImportProblem(configClass, this.importStack));\n        }\n        else {\n            this.importStack.push(configClass);\n            try {\n                //\u4f9d\u6b21\u904d\u5386\u6240\u6709@Import\u6ce8\u89e3\u4e2d\u6dfb\u52a0\u7684\u7c7b\n                for (SourceClass candidate : importCandidates) {\n                    if (candidate.isAssignable(ImportSelector.class)) {\n                        // \u5982\u679c\u662fImportSelector\u7c7b\u578b\uff0c\u5219\u52a0\u8f7d\u7c7b\uff0c\u5e76\u5b8c\u6210\u5b9e\u4f8b\u5316\n                        Class&lt;?&gt; candidateClass = candidate.loadClass();\n                        ImportSelector selector = ParserStrategyUtils.instantiateClass(candidateClass, ImportSelector.class, this.environment, this.resourceLoader, this.registry);\n                        ...\n                        // \u5982\u679c\u662fDeferredImportSelector\uff08\u5ef6\u8fdf\u5bfc\u5165\uff09\u5219\u901a\u8fc7deferredImportSelectorHandler\u8fdb\u884c\u5904\u7406\n                        if (selector instanceof DeferredImportSelector deferredImportSelector) {\n                            this.deferredImportSelectorHandler.handle(configClass, deferredImportSelector);\n                        }\n                        else {\n                        // \u5982\u679c\u662f\u666e\u901a\u7684ImportSelector\u5219\u76f4\u63a5\u6267\u884cselectImports\u65b9\u6cd5\u5f97\u5230\u9700\u8981\u989d\u5916\u5bfc\u5165\u7684\u7c7b\u540d\u79f0\n                            String[] importClassNames = selector.selectImports(currentSourceClass.getMetadata());\n                            Collection&lt;SourceClass&gt; importSourceClasses = asSourceClasses(importClassNames, exclusionFilter);\n                            //\u9012\u5f52\u5904\u7406\u8fd9\u91cc\u5f97\u5230\u7684\u5168\u90e8\u7c7b\n                            processImports(configClass, currentSourceClass, importSourceClasses, exclusionFilter, false);\n                        }\n                    }\n                    else if (candidate.isAssignable(ImportBeanDefinitionRegistrar.class)) {\n                        // \u5224\u65ad\u662f\u5426\u4e3aImportBeanDefinitionRegistrar\u7c7b\u578b\uff0cSSM\u9636\u6bb5\u5df2\u7ecf\u8bb2\u89e3\u8fc7\u4e86\n                        Class&lt;?&gt; candidateClass = candidate.loadClass();\n                        ImportBeanDefinitionRegistrar registrar =\n                                ParserStrategyUtils.instantiateClass(candidateClass, ImportBeanDefinitionRegistrar.class, this.environment, this.resourceLoader, this.registry);\n                        //\u5f80configClass\u4e22ImportBeanDefinitionRegistrar\u4fe1\u606f\u8fdb\u53bb\uff0c\u4e4b\u540e\u518d\u5904\u7406\n                        configClass.addImportBeanDefinitionRegistrar(registrar, currentSourceClass.getMetadata());\n                    }\n                    else {\n                        // \u5982\u679c\u4ee5\u4e0a\u7c7b\u578b\u90fd\u4e0d\u662f\uff0c\u5219\u4e0d\u4f7f\u7528\u7279\u6b8a\u673a\u5236\uff0c\u5355\u7eaf\u5bfc\u5165\u4e3a\u666e\u901a\u7684\u914d\u7f6e\u7c7b\u8fdb\u884c\u5904\u7406\n                        this.importStack.registerImport(\n                                currentSourceClass.getMetadata(), candidate.getMetadata().getClassName());\n                        processConfigurationClass(candidate.asConfigClass(configClass), exclusionFilter);\n                    }\n                }\n            }\n            ...\n        }\n    }\n}\n</code></pre> <p>\u4e0d\u96be\u6ce8\u610f\u5230\uff0c\u867d\u7136\u8fd9\u91cc\u7279\u522b\u5904\u7406\u4e86<code>ImportSelector</code>\u5bf9\u8c61\uff0c\u4f46\u662f\u8fd8\u9488\u5bf9<code>ImportSelector</code>\u7684\u5b50\u63a5\u53e3<code>DeferredImportSelector</code>\u8fdb\u884c\u4e86\u989d\u5916\u5904\u7406\uff0cDeferred\u662f\u5ef6\u8fdf\u7684\u610f\u601d\uff0c\u5b83\u662f\u4e00\u4e2a\u5ef6\u8fdf\u6267\u884c\u7684<code>ImportSelector</code>\uff0c\u5e76\u4e0d\u4f1a\u7acb\u5373\u8fdb\u5904\u7406\uff0c\u800c\u662f\u4e22\u8fdbDeferredImportSelectorHandler\uff0c\u5e76\u4e14\u5728\u6211\u4eec\u4e0a\u9762\u63d0\u5230\u7684<code>parse</code>\u65b9\u6cd5\u7684\u6700\u540e\u8fdb\u884c\u5904\u7406\uff1a</p> <pre><code>public void parse(Set&lt;BeanDefinitionHolder&gt; configCandidates) {\n     ...\n    this.deferredImportSelectorHandler.process();  //\u6267\u884cDeferredImportSelector\u7684process\u65b9\u6cd5\uff0c\u8fd9\u91cc\u4f9d\u7136\u4f1a\u8fdb\u884c\u4e0a\u9762\u7684processImports\u64cd\u4f5c\uff0c\u53ea\u4e0d\u8fc7\u88ab\u5ef6\u8fdf\u5230\u8fd9\u4e2a\u4f4d\u7f6e\u6267\u884c\u4e86\n}\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b<code>DeferredImportSelector</code>\u6b63\u597d\u5c31\u6709\u4e00\u4e2a<code>process</code>\u65b9\u6cd5\uff1a</p> <pre><code>ublic interface DeferredImportSelector extends ImportSelector {\n    @Nullable\n    default Class&lt;? extends DeferredImportSelector.Group&gt; getImportGroup() {\n        return null;\n    }\n\n    public interface Group {\n        void process(AnnotationMetadata metadata, DeferredImportSelector selector);\n\n        Iterable&lt;DeferredImportSelector.Group.Entry&gt; selectImports();\n\n        public static class Entry {\n          ...\n</code></pre> <p>\u6700\u540e\u7ecf\u8fc7ConfigurationClassParser\u5904\u7406\u5b8c\u6210\u540e\uff0c\u901a\u8fc7<code>parser.getConfigurationClasses()</code>\u5c31\u80fd\u5f97\u5230\u901a\u8fc7\u914d\u7f6e\u7c7b\u5bfc\u5165\u90a3\u4e9b\u989d\u5916\u7684\u914d\u7f6e\u7c7b\u6216\u662f\u7279\u6b8a\u7684\u7c7b\u3002\u6700\u540e\u5c06\u8fd9\u4e9b\u914d\u7f6e\u7c7b\u5168\u90e8\u6ce8\u518cBeanDefinition\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4ea4\u7ed9\u63a5\u4e0b\u6765\u7684Bean\u521d\u59cb\u5316\u8fc7\u7a0b\u53bb\u5904\u7406\u4e86\uff1a</p> <pre><code>this.reader.loadBeanDefinitions(configClasses);\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u518d\u53bb\u770b<code>loadBeanDefinitions</code>\u662f\u5982\u4f55\u8fd0\u884c\u7684\uff1a</p> <pre><code>public void loadBeanDefinitions(Set&lt;ConfigurationClass&gt; configurationModel) {\n    ConfigurationClassBeanDefinitionReader.TrackedConditionEvaluator trackedConditionEvaluator = new ConfigurationClassBeanDefinitionReader.TrackedConditionEvaluator();\n    Iterator var3 = configurationModel.iterator();\n    while(var3.hasNext()) {\n        ConfigurationClass configClass = (ConfigurationClass)var3.next();\n        this.loadBeanDefinitionsForConfigurationClass(configClass, trackedConditionEvaluator);\n    }\n}\n\nprivate void loadBeanDefinitionsForConfigurationClass(ConfigurationClass configClass, ConfigurationClassBeanDefinitionReader.TrackedConditionEvaluator trackedConditionEvaluator) {\n    if (trackedConditionEvaluator.shouldSkip(configClass)) {\n        ...\n    } else {\n        if (configClass.isImported()) {\n            this.registerBeanDefinitionForImportedConfigurationClass(configClass);  //\u6ce8\u518c\u914d\u7f6e\u7c7b\u81ea\u5df1\n        }\n        Iterator var3 = configClass.getBeanMethods().iterator();\n        while(var3.hasNext()) {\n            BeanMethod beanMethod = (BeanMethod)var3.next();\n            this.loadBeanDefinitionsForBeanMethod(beanMethod); //\u6ce8\u518c@Bean\u6ce8\u89e3\u6807\u8bc6\u7684\u65b9\u6cd5\n        }\n        //\u6ce8\u518c@ImportResource\u5f15\u5165\u7684XML\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7684bean\u5b9a\u4e49\n        this.loadBeanDefinitionsFromImportedResources(configClass.getImportedResources());\n        //\u6ce8\u518cconfigClass\u4e2d\u7ecf\u8fc7\u89e3\u6790\u540e\u4fdd\u5b58\u7684\u6240\u6709ImportBeanDefinitionRegistrar\uff0c\u6ce8\u518c\u5bf9\u5e94\u7684BeanDefinition\n        this.loadBeanDefinitionsFromRegistrars(configClass.getImportBeanDefinitionRegistrars());\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6574\u4e2a<code>@Configuration</code>\u914d\u7f6e\u7c7b\u7684\u5e95\u5c42\u914d\u7f6e\u6d41\u7a0b\u6211\u4eec\u5c31\u5927\u81f4\u4e86\u89e3\u4e86\u3002\u63a5\u7740\u6211\u4eec\u6765\u770bAutoConfigurationImportSelector\u662f\u5982\u4f55\u5b9e\u73b0\u81ea\u52a8\u914d\u7f6e\u7684\uff0c\u53ef\u4ee5\u770b\u5230\u5185\u90e8\u7c7bAutoConfigurationGroup\u7684process\u65b9\u6cd5\uff0c\u5b83\u662f\u7236\u63a5\u53e3\u7684\u5b9e\u73b0\uff0c\u56e0\u4e3a\u7236\u63a5\u53e3\u662f<code>DeferredImportSelector</code>\uff0c\u6839\u636e\u524d\u9762\u7684\u63a8\u5bfc\uff0c\u5f88\u5bb9\u6613\u5f97\u77e5\uff0c\u5b9e\u9645\u4e0a\u6700\u540e\u4f1a\u8c03\u7528<code>process</code>\u65b9\u6cd5\u83b7\u53d6\u6240\u6709\u7684\u81ea\u52a8\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>public void process(AnnotationMetadata annotationMetadata, DeferredImportSelector deferredImportSelector) {\n    Assert.state(deferredImportSelector instanceof AutoConfigurationImportSelector, () -&gt; {\n        return String.format(\"Only %s implementations are supported, got %s\", AutoConfigurationImportSelector.class.getSimpleName(), deferredImportSelector.getClass().getName());\n    });\n    //\u83b7\u53d6\u6240\u6709\u7684Entry\uff0c\u5176\u5b9e\u5c31\u662f\u8bfb\u53d6\u6765\u67e5\u770b\u6709\u54ea\u4e9b\u81ea\u52a8\u914d\u7f6e\u7c7b\n    AutoConfigurationImportSelector.AutoConfigurationEntry autoConfigurationEntry = ((AutoConfigurationImportSelector)deferredImportSelector).getAutoConfigurationEntry(annotationMetadata);\n    this.autoConfigurationEntries.add(autoConfigurationEntry);\n    Iterator var4 = autoConfigurationEntry.getConfigurations().iterator();\n\n    while(var4.hasNext()) {\n        String importClassName = (String)var4.next();\n        this.entries.putIfAbsent(importClassName, annotationMetadata);\n    }\n    //\u8fd9\u91cc\u7ed3\u675f\u4e4b\u540e\uff0centries\u4e2d\u5c31\u6709\u4e0a\u9762\u83b7\u53d6\u5230\u7684\u81ea\u52a8\u914d\u7f6e\u7c7b\u4e86\n}\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b<code>getAutoConfigurationEntry</code>\u65b9\u6cd5\uff1a</p> <pre><code>protected AutoConfigurationImportSelector.AutoConfigurationEntry getAutoConfigurationEntry(AnnotationMetadata annotationMetadata) {\n    //\u8fd9\u91cc\u5224\u65ad\u662f\u5426\u5f00\u542f\u4e86\u81ea\u52a8\u914d\u7f6e\uff0c\u4f60\u60f3\u7684\u6ca1\u9519\uff0c\u81ea\u52a8\u914d\u7f6e\u662f\u53ef\u4ee5\u5173\u7684\n    if (!this.isEnabled(annotationMetadata)) {\n        return EMPTY_ENTRY;\n    } else {\n        //\u6839\u636e\u6ce8\u89e3\u5b9a\u4e49\u83b7\u53d6\u4e00\u4e9b\u5c5e\u6027\n        AnnotationAttributes attributes = this.getAttributes(annotationMetadata);\n        //\u83b7\u53d6\u6240\u6709\u9700\u8981\u81ea\u52a8\u914d\u7f6e\u7684\u7c7b\n        List&lt;String&gt; configurations = this.getCandidateConfigurations(annotationMetadata, attributes);\n        //\u79fb\u9664\u6389\u91cd\u590d\u7684\u81ea\u52a8\u914d\u7f6e\u7c7b\n        configurations = removeDuplicates(configurations);\n        //\u83b7\u53d6\u9700\u8981\u6392\u9664\u6389\u7684\u81ea\u52a8\u914d\u7f6e\u7c7b\n            Set&lt;String&gt; exclusions = getExclusions(annotationMetadata, attributes);\n            checkExcludedClasses(configurations, exclusions);\n            configurations.removeAll(exclusions);\n        ...\n            return new AutoConfigurationEntry(configurations, exclusions);\n    }\n}\n</code></pre> <p>\u6211\u4eec\u63a5\u7740\u5f80\u91cc\u9762\u770b\uff1a</p> <pre><code>protected List&lt;String&gt; getCandidateConfigurations(AnnotationMetadata metadata, AnnotationAttributes attributes) {\n            //\u8fd9\u91cc\u7ee7\u7eed\u5957\u5a03\n        List&lt;String&gt; configurations = ImportCandidates.load(AutoConfiguration.class, this.getBeanClassLoader()).getCandidates();\n        ...\n}\n</code></pre> <p>\u5230\u8fd9\u91cc\u7ec8\u4e8e\u627e\u5230\u4e86\uff1a</p> <pre><code>public static ImportCandidates load(Class&lt;?&gt; annotation, ClassLoader classLoader) {\n        Assert.notNull(annotation, \"'annotation' must not be null\");\n        ClassLoader classLoaderToUse = decideClassloader(classLoader);\n            //\u8fd9\u91cc\u76f4\u63a5\u83b7\u53d6 META-INF/spring/\u6ce8\u89e3\u7c7b\u540d.imports \u4e2d\u7684\u6240\u6709\u5185\u5bb9\n        String location = String.format(\"META-INF/spring/%s.imports\", annotation.getName());\n        ...\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u627e\u5230\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6709\u5f88\u591a\u81ea\u52a8\u914d\u7f6e\u7c7b\uff0c\u5b9e\u9645\u4e0aSpringBoot\u7684starter\u90fd\u662f\u4f9d\u9760\u81ea\u52a8\u914d\u7f6e\u7c7b\u6765\u5b9e\u73b0\u81ea\u52a8\u914d\u7f6e\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u968f\u4fbf\u770b\u4e00\u4e2a\uff0c\u6bd4\u5982\u7528\u4e8e\u81ea\u52a8\u914d\u7f6eMybatis\u6846\u67b6\u7684MybatisAutoConfiguration\u81ea\u52a8\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>@Configuration\n@ConditionalOnClass({SqlSessionFactory.class, SqlSessionFactoryBean.class})\n@ConditionalOnSingleCandidate(DataSource.class)\n@EnableConfigurationProperties({MybatisProperties.class})\n@AutoConfigureAfter({DataSourceAutoConfiguration.class, MybatisLanguageDriverAutoConfiguration.class})\npublic class MybatisAutoConfiguration implements InitializingBean {\n    ...\n\n    @Bean\n    @ConditionalOnMissingBean\n    public SqlSessionFactory sqlSessionFactory(DataSource dataSource) throws Exception {\n        ...\n    }\n\n    @Bean\n    @ConditionalOnMissingBean\n    public SqlSessionTemplate sqlSessionTemplate(SqlSessionFactory sqlSessionFactory) {\n        ...\n    }\n\n    ...\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u91cc\u9762\u76f4\u63a5\u5c06SqlSessionFactory\u548cSqlSessionTemplate\u6ce8\u518c\u4e3aBean\u4e86\uff0c\u7531\u4e8e\u8fd9\u4e2a\u81ea\u52a8\u914d\u7f6e\u7c7b\u5728\u4e0a\u9762\u7684\u4e00\u5957\u6d41\u7a0b\u4e2d\u5df2\u7ecf\u52a0\u8f7d\u4e86\uff0c\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u6211\u4eec\u624b\u52a8\u8fdb\u884c\u6ce8\u518c\u8fd9\u4e9bBean\u4e86\u3002\u4e0d\u8fc7\u8fd9\u91cc\u6709\u4e00\u4e2a\u975e\u5e38\u6709\u610f\u601d\u7684 @Conditional \u6ce8\u89e3\uff0c\u5b83\u53ef\u4ee5\u6839\u636e\u6761\u4ef6\u6765\u5224\u65ad\u662f\u5426\u6ce8\u518c\u8fd9\u4e2aBean\uff0c\u6bd4\u5982 @ConditionalOnMissingBean \u6ce8\u89e3\u5c31\u662f\u5f53\u8fd9\u4e2aBean\u4e0d\u5b58\u5728\u7684\u65f6\u5019\uff0c\u624d\u4f1a\u6ce8\u518c\uff0c\u5982\u679c\u8fd9\u4e2aBean\u5df2\u7ecf\u88ab\u5176\u4ed6\u914d\u7f6e\u7c7b\u7ed9\u6ce8\u518c\u4e86\uff0c\u90a3\u4e48\u8fd9\u91cc\u5c31\u4e0d\u8fdb\u884c\u6ce8\u518c\u3002</p> <p>\u7ecf\u8fc7\u8fd9\u4e00\u5957\u6d41\u7a0b\uff0c\u7b80\u800c\u8a00\u4e4b\u5c31\u662fSpringBoot\u8bfb\u53d6<code>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>\u6587\u4ef6\u6765\u786e\u5b9a\u8981\u52a0\u8f7d\u54ea\u4e9b\u81ea\u52a8\u914d\u7f6e\u7c7b\u6765\u5b9e\u73b0\u7684\u5168\u81ea\u52a8\u5316\uff0c\u771f\u6b63\u505a\u5230\u6dfb\u52a0\u4f9d\u8d56\u5c31\u80fd\u591f\u76f4\u63a5\u5b8c\u6210\u914d\u7f6e\u548c\u8fd0\u884c\uff0c\u81f3\u6b64\uff0cSpringBoot\u7684\u539f\u7406\u90e8\u5206\u5c31\u63a2\u7a76\u5b8c\u6bd5\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/#starter","title":"\u81ea\u5b9a\u4e49Starter\u9879\u76ee","text":"<p>\u6211\u4eec\u4eff\u7167Mybatis\u6765\u7f16\u5199\u4e00\u4e2a\u81ea\u5df1\u7684starter\uff0cMybatis\u7684starter\u5305\u542b\u4e24\u4e2a\u90e8\u5206\uff1a</p> <pre><code>&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n  &lt;parent&gt;\n    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis-spring-boot&lt;/artifactId&gt;\n    &lt;version&gt;2.2.0&lt;/version&gt;\n  &lt;/parent&gt;\n  &lt;!--  starter\u672c\u8eab\u53ea\u505a\u4f9d\u8d56\u96c6\u4e2d\u7ba1\u7406\uff0c\u4e0d\u7f16\u5199\u4efb\u4f55\u4ee3\u7801  --&gt;\n  &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;\n  &lt;name&gt;mybatis-spring-boot-starter&lt;/name&gt;\n  &lt;properties&gt;\n    &lt;module.name&gt;org.mybatis.spring.boot.starter&lt;/module.name&gt;\n  &lt;/properties&gt;\n  &lt;dependencies&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;!--  \u7f16\u5199\u7684\u4e13\u7528\u914d\u7f6e\u6a21\u5757   --&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;\n      &lt;artifactId&gt;mybatis-spring-boot-autoconfigure&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n      &lt;artifactId&gt;mybatis&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n      &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre> <p>\u56e0\u6b64\u6211\u4eec\u4e5f\u5c06\u6211\u4eec\u81ea\u5df1\u7684starter\u8fd9\u6837\u8bbe\u8ba1\uff0c\u6211\u4eec\u8bbe\u8ba1\u4e09\u4e2a\u6a21\u5757\uff1a</p> <ul> <li>spring-boot-hello\uff1a\u57fa\u7840\u4e1a\u52a1\u529f\u80fd\u6a21\u5757</li> <li>spring-boot-starter-hello\uff1a\u542f\u52a8\u5668</li> <li>spring-boot-autoconifgurer-hello\uff1a\u81ea\u52a8\u914d\u7f6e\u4f9d\u8d56</li> </ul> <p>\u9996\u5148\u662f\u57fa\u7840\u4e1a\u52a1\u529f\u80fd\u6a21\u5757\uff0c\u8fd9\u91cc\u6211\u4eec\u968f\u4fbf\u521b\u5efa\u4e00\u4e2a\u7c7b\u5c31\u53ef\u4ee5\u4e86\uff1a</p> <pre><code>public class HelloWorldService {\n    public void test(){\n        System.out.println(\"Hello World!\");\n    }\n}\n</code></pre> <p>\u542f\u52a8\u5668\u4e3b\u8981\u505a\u4f9d\u8d56\u7ba1\u7406\uff0c\u8fd9\u91cc\u5c31\u4e0d\u5199\u4efb\u4f55\u4ee3\u7801\uff0c\u53ea\u5199pom\u6587\u4ef6\uff1a</p> <pre><code>&lt;dependency&gt;\n      &lt;groupId&gt;org.example&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-autoconifgurer-hello&lt;/artifactId&gt;\n      &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n      &lt;groupId&gt;org.example&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-hello&lt;/artifactId&gt;\n      &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u5bfc\u5165autoconfigurer\u6a21\u5757\u4f5c\u4e3a\u4f9d\u8d56\u5373\u53ef\uff0c\u63a5\u7740\u6211\u4eec\u53bb\u7f16\u5199autoconfigurer\u6a21\u5757\uff0c\u9996\u5148\u5bfc\u5165\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.example&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-hello&lt;/artifactId&gt;\n            &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n        &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre> <p>\u63a5\u7740\u521b\u5efa\u4e00\u4e2aHelloWorldAutoConfiguration\u4f5c\u4e3a\u81ea\u52a8\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>@Configuration(proxyBeanMethods = false)\n@ConditionalOnWebApplication\n@EnableConfigurationProperties(HelloWorldProperties.class)\npublic class HelloWorldAutoConfiguration {\n\n    Logger logger = Logger.getLogger(this.getClass().getName());\n\n    @Autowired\n    HelloWorldProperties properties;\n\n    @Bean\n    @ConditionalOnMissingBean\n    public HelloWorldService helloWorldService(){\n        logger.info(\"\u81ea\u5b9a\u4e49starter\u9879\u76ee\u5df2\u542f\u52a8\uff01\");\n        logger.info(\"\u8bfb\u53d6\u5230\u81ea\u5b9a\u4e49\u914d\u7f6e\uff1a\"+properties.getValue());\n        return new HelloWorldService();\n    }\n}\n</code></pre> <p>\u5bf9\u5e94\u7684\u914d\u7f6e\u8bfb\u53d6\u7c7b\uff1a</p> <pre><code>@ConfigurationProperties(\"hello.world\")\npublic class HelloWorldProperties {\n\n    private String value;\n\n    public void setValue(String value) {\n        this.value = value;\n    }\n\n    public String getValue() {\n        return value;\n    }\n}\n</code></pre> <p>\u63a5\u7740\u518d\u7f16\u5199<code>META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports</code>\u6587\u4ef6\uff0c\u5e76\u5c06\u6211\u4eec\u7684\u81ea\u52a8\u914d\u7f6e\u7c7b\u6dfb\u52a0\u5373\u53ef\uff1a</p> <pre><code>com.test.autoconfigure.HelloWorldAutoConfiguration\n</code></pre> <p>\u6700\u540e\u518dMaven\u6839\u9879\u76ee\u6267\u884c<code>install</code>\u5b89\u88c5\u5230\u672c\u5730\u4ed3\u5e93\uff0c\u5b8c\u6210\u3002\u63a5\u7740\u5c31\u53ef\u4ee5\u5728\u5176\u4ed6\u9879\u76ee\u4e2d\u4f7f\u7528\u6211\u4eec\u7f16\u5199\u7684\u81ea\u5b9a\u4e49starter\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/","title":"SpringBoot\u7b14\u8bb0\uff08\u4e09\uff09\u524d\u540e\u7aef\u5206\u79bb","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#springboot","title":"\u8d70\u8fdbSpringBoot\u524d\u540e\u7aef\u5206\u79bb","text":"<p>\u524d\u540e\u7aef\u5206\u79bb\u662f\u4e00\u79cd\u8f6f\u4ef6\u67b6\u6784\u6a21\u5f0f\uff0c\u5b83\u5c06\u524d\u7aef\u548c\u540e\u7aef\u7684\u5f00\u53d1\u804c\u8d23\u5206\u5f00\uff0c\u4f7f\u5f97\u524d\u7aef\u548c\u540e\u7aef\u53ef\u4ee5\u72ec\u7acb\u8fdb\u884c\u5f00\u53d1\u3001\u6d4b\u8bd5\u548c\u90e8\u7f72\u3002\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u90fd\u662f\u7f16\u5199Web\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f46\u662f\u968f\u7740\u65f6\u4ee3\u53d1\u5c55\uff0c\u5404\u79cd\u684c\u9762App\u3001\u624b\u673a\u7aefApp\u8fd8\u6709\u5c0f\u7a0b\u5e8f\u5c42\u51fa\u4e0d\u7a77\uff0c\u8fd9\u90fd\u5b8c\u5168\u8131\u79bb\u6211\u4eec\u4e4b\u524d\u7684\u5f00\u53d1\u6a21\u5f0f\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684\u5212\u5206\u8d8a\u6765\u8d8a\u660e\u663e\uff0c\u524d\u540e\u7aef\u5206\u79bb\u5f00\u53d1\u52bf\u5728\u5fc5\u884c\u3002</p> <p>\u5728\u524d\u540e\u7aef\u5206\u79bb\u67b6\u6784\u4e2d\uff0c\u524d\u7aef\u4e3b\u8981\u8d1f\u8d23\u5c55\u793a\u5c42\u7684\u5f00\u53d1\uff0c\u5305\u62ec\u7528\u6237\u754c\u9762\u7684\u8bbe\u8ba1\u3001\u7528\u6237\u4ea4\u4e92\u7684\u5b9e\u73b0\u7b49\u3002\u524d\u7aef\u4f7f\u7528\u4e00\u4e9b\u6280\u672f\u6808\uff0c\u5982Vue\u3001React\u7b49\u6280\u672f\u6765\u5b9e\u73b0\u7528\u6237\u754c\u9762\uff0c\u540c\u65f6\u901a\u8fc7Ajax\u3001Axios\u7b49\u6280\u672f\u4e0e\u540e\u7aef\u8fdb\u884c\u6570\u636e\u7684\u4ea4\u4e92\uff0c\u8fd9\u6837\u524d\u7aef\u65e0\u8bba\u4f7f\u7528\u4ec0\u4e48\u6280\u672f\u8fdb\u884c\u5f00\u53d1\uff0c\u90fd\u4e0e\u540e\u7aef\u65e0\u5173\uff0c\u53d7\u5230\u7684\u9650\u5236\u4f1a\u5c0f\u5f88\u591a\u3002</p> <p>\u540e\u7aef\u4e3b\u8981\u8d1f\u8d23\u4e1a\u52a1\u903b\u8f91\u7684\u5904\u7406\u548c\u6570\u636e\u7684\u5b58\u50a8\uff0c\u5305\u62ec\u7528\u6237\u8ba4\u8bc1\u3001\u6570\u636e\u9a8c\u8bc1\u3001\u6570\u636e\u5904\u7406\u3001\u6570\u636e\u5e93\u8bbf\u95ee\u7b49\uff0c\u6211\u4eec\u5728SSM\u9636\u6bb5\u5c31\u5df2\u7ecf\u7ed9\u5404\u4f4d\u5c0f\u4f19\u4f34\u4ecb\u7ecd\u8fc7\u4e86\u524d\u540e\u7aef\u5f00\u53d1\u7684\u76f8\u5173\u601d\u8def\u4e86\uff0c\u5b9e\u9645\u4e0a\u540e\u7aef\u53ea\u9700\u8981\u8fd4\u56de\u524d\u7aef\u9700\u8981\u7684\u6570\u636e\u5373\u53ef\uff0c\u6211\u4eec\u4e00\u822c\u4f7f\u7528JSON\u683c\u5f0f\u8fdb\u884c\u8fd4\u56de\u3002</p> <p>\u524d\u540e\u7aef\u5206\u79bb\u67b6\u6784\u7684\u4f18\u52bf\u5305\u62ec\uff1a</p> <ul> <li>\u524d\u540e\u7aef\u53ef\u4ee5\u540c\u65f6\u72ec\u7acb\u8fdb\u884c\u5f00\u53d1\uff0c\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\u3002</li> <li>\u524d\u7aef\u53ef\u4ee5\u7075\u6d3b\u9009\u62e9\u6280\u672f\u6808\u548c\u6846\u67b6\uff0c\u63d0\u4f9b\u66f4\u597d\u7684\u7528\u6237\u4f53\u9a8c\u3002</li> <li>\u540e\u7aef\u53ef\u4ee5\u4e13\u6ce8\u4e8e\u4e1a\u52a1\u903b\u8f91\u7684\u5b9e\u73b0\uff0c\u63d0\u9ad8\u4ee3\u7801\u7684\u53ef\u7ef4\u62a4\u6027\u3002</li> <li>\u524d\u540e\u7aef\u901a\u8fc7\u63a5\u53e3\u8fdb\u884c\u901a\u4fe1\uff0c\u4f7f\u5f97\u524d\u7aef\u548c\u540e\u7aef\u53ef\u4ee5\u5206\u522b\u8fdb\u884c\u90e8\u7f72\uff0c\u63d0\u9ad8\u7cfb\u7edf\u7684\u53ef\u6269\u5c55\u6027\u548c\u7075\u6d3b\u6027\u3002</li> </ul> <p></p> <p>\u7136\u800c\uff0c\u524d\u540e\u7aef\u5206\u79bb\u67b6\u6784\u4e5f\u5b58\u5728\u4e00\u4e9b\u6311\u6218\uff0c\u5305\u62ec\u63a5\u53e3\u8bbe\u8ba1\u7684\u590d\u6742\u6027\u3001\u524d\u540e\u7aef\u534f\u4f5c\u7684\u6c9f\u901a\u6210\u672c\u7b49\u3002\u56e0\u6b64\uff0c\u5728\u9009\u62e9\u524d\u540e\u7aef\u5206\u79bb\u67b6\u6784\u65f6\uff0c\u9700\u8981\u7efc\u5408\u8003\u8651\u9879\u76ee\u7684\u7279\u70b9\u548c\u56e2\u961f\u6210\u5458\u7684\u6280\u80fd\uff0c\u4ee5\u53ca\u5f00\u53d1\u5468\u671f\u7b49\u56e0\u7d20\u3002</p> <p>\u672c\u7ae0\u6211\u4eec\u5c06\u4ecb\u7ecd\u4e24\u79cd\u5b9e\u73b0\u524d\u540e\u7aef\u5206\u79bb\u7684\u65b9\u6848\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#session","title":"\u57fa\u4e8eSession\u7684\u5206\u79bb\uff08\u6709\u72b6\u6001\uff09","text":"<p>\u57fa\u4e8eCookie\u7684\u524d\u540e\u7aef\u5206\u79bb\u662f\u6700\u7b80\u5355\u7684\u4e00\u79cd\uff0c\u4e5f\u662f\u66f4\u63a5\u8fd1\u6211\u4eec\u4e4b\u524d\u5b66\u4e60\u7684\u4e00\u79cd\u3002\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u90fd\u662f\u4f7f\u7528SpringSecurity\u63d0\u4f9b\u7684\u9ed8\u8ba4\u767b\u5f55\u6d41\u7a0b\u5b8c\u6210\u9a8c\u8bc1\u3002</p> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0aSpringSecurity\u5728\u767b\u5f55\u4e4b\u540e\uff0c\u4f1a\u5229\u7528Session\u673a\u5236\u8bb0\u5f55\u7528\u6237\u7684\u767b\u5f55\u72b6\u6001\uff0c\u8fd9\u5c31\u8981\u6c42\u6211\u4eec\u6bcf\u6b21\u8bf7\u6c42\u7684\u65f6\u5019\u90fd\u9700\u8981\u643a\u5e26Cookie\u624d\u53ef\u4ee5\uff0c\u56e0\u4e3aCookie\u4e2d\u5b58\u50a8\u4e86\u7528\u4e8e\u8bc6\u522b\u7684JSESSIONID\u6570\u636e\u3002\u56e0\u6b64\uff0c\u8981\u5b9e\u73b0\u524d\u540e\u7aef\u5206\u79bb\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u5c31\u53ef\u4ee5\u5b9e\u73b0\u4e86\uff0c\u8fd9\u5bf9\u4e8e\u5c0f\u578b\u7684\u5355\u7aef\u5e94\u7528\u7a0b\u5e8f\u975e\u5e38\u53cb\u597d\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#_1","title":"\u5b66\u4e60\u73af\u5883\u642d\u5efa","text":"<p>\u8003\u8651\u5230\u5404\u4f4d\u5c0f\u4f19\u4f34\u6ca1\u6709\u5b66\u4e60\u8fc7Vue\u7b49\u524d\u7aef\u6846\u67b6\uff0c\u8fd9\u91cc\u6211\u4eec\u4f9d\u7136\u4f7f\u7528\u524d\u7aef\u6a21\u7248\u8fdb\u884c\u9b54\u6539\u3002\u53ea\u4e0d\u8fc7\u73b0\u5728\u6211\u4eec\u7684\u524d\u7aef\u9875\u9762\u9700\u8981\u5355\u72ec\u8fdb\u884c\u90e8\u7f72\uff0c\u800c\u4e0d\u662f\u548c\u540e\u7aef\u63c9\u5728\u4e00\u8d77\uff0c\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u5148\u521b\u5efa\u4e00\u4e2a\u524d\u7aef\u9879\u76ee\uff0c\u4f9d\u8d56\u53ea\u9700\u52fe\u9009SpringWeb\u5373\u53ef\uff0c\u4e3b\u8981\u7528\u4f5c\u53cd\u5411\u4ee3\u7406\u524d\u7aef\u9875\u9762\uff1a</p> <p></p> <p>\u5982\u679c\u5404\u4f4d\u5c0f\u4f19\u4f34\u5b66\u4e60\u4e86Nginx\u4ee3\u7406\uff0c\u4f7f\u7528Nginx\u4ee3\u7406\u524d\u7aef\u9879\u76ee\u4f1a\u66f4\u597d\u4e00\u4e9b\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u5c06\u6240\u6709\u7684\u524d\u7aef\u6a21\u7248\u6587\u4ef6\u5168\u90e8\u4e22\u8fdb\u5bf9\u5e94\u7684\u76ee\u5f55\u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a<code>web</code>\u76ee\u5f55\u5230resource\u76ee\u5f55\u4e0b\uff0c\u7136\u540e\u653e\u5165\u6211\u4eec\u524d\u7aef\u6a21\u7248\u7684\u5168\u90e8\u6587\u4ef6\uff1a</p> <p></p> <p>\u7136\u540e\u914d\u7f6e\u4e00\u4e0b\u9759\u6001\u8d44\u6e90\u4ee3\u7406\uff0c\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u7684\u662f\u9875\u9762\u76f4\u63a5\u88ab\u4ee3\u7406\uff0c\u4e0d\u7528\u6211\u4eec\u624b\u52a8\u53bb\u5199Controller\u6765\u89e3\u6790\u89c6\u56fe\uff1a</p> <pre><code>spring:\n  web:\n    resources:\n      static-locations: classpath:/web\n</code></pre> <p>\u7136\u540e\u542f\u52a8\u670d\u52a1\u5668\u5c31\u884c\u4e86\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u968f\u4fbf\u8bbf\u95ee\u6211\u4eec\u7684\u7f51\u7ad9\u4e86\uff1a</p> <p></p> <p>\u8fd9\u6837\u524d\u7aef\u9875\u9762\u5c31\u90e8\u7f72\u5b8c\u6210\u4e86\uff0c\u63a5\u7740\u6211\u4eec\u8fd8\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u540e\u7aef\u9879\u76ee\uff0c\u7528\u4e8e\u53bb\u7f16\u5199\u6211\u4eec\u7684\u540e\u7aef\uff0c\u9009\u4e0a\u6211\u4eec\u9700\u8981\u7684\u4e00\u4e9b\u4f9d\u8d56\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u4fee\u6539\u4e00\u4e0b\u540e\u7aef\u670d\u52a1\u5668\u7684\u7aef\u53e3\uff0c\u56e0\u4e3a\u73b0\u5728\u6211\u4eec\u8981\u540c\u65f6\u5f00\u4e24\u4e2a\u670d\u52a1\u5668\uff0c\u4e00\u4e2a\u662f\u8d1f\u8d23\u90e8\u7f72\u524d\u7aef\u7684\uff0c\u4e00\u4e2a\u662f\u8d1f\u8d23\u90e8\u7f72\u540e\u7aef\u7684\uff0c\u8fd9\u6837\u5c31\u662f\u6807\u51c6\u7684\u524d\u540e\u7aef\u5206\u79bb\u4e86\uff0c\u6240\u4ee5\u8bf4\u4e3a\u4e86\u9632\u6b62\u7aef\u53e3\u6253\u67b6\uff0c\u6211\u4eec\u5c31\u628a\u7aef\u53e3\u5f00\u653e\u57288081\u4e0a\uff1a</p> <pre><code>server:\n  port: 8081\n</code></pre> <p>\u73b0\u5728\u542f\u52a8\u8fd9\u4e24\u4e2a\u670d\u52a1\u5668\uff0c\u6211\u4eec\u7684\u5b66\u4e60\u73af\u5883\u5c31\u642d\u5efa\u597d\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#_2","title":"\u5b9e\u73b0\u767b\u5f55\u6388\u6743\u548c\u8de8\u57df\u5904\u7406","text":"<p>\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u7684\u767b\u5f55\u64cd\u4f5c\u4ee5\u53ca\u767b\u5f55\u4e4b\u540e\u7684\u9875\u9762\u8df3\u8f6c\u90fd\u662f\u7531SpringSecurity\u6765\u5b8c\u6210\uff0c\u4f46\u662f\u73b0\u5728\u524d\u540e\u7aef\u5206\u79bb\u4e4b\u540e\uff0c\u6574\u4e2a\u6d41\u7a0b\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u73b0\u5728\u524d\u7aef\u4ec5\u4ec5\u662f\u8c03\u7528\u767b\u5f55\u63a5\u53e3\u8fdb\u884c\u4e00\u6b21\u6821\u9a8c\u5373\u53ef\uff0c\u800c\u540e\u7aef\u53ea\u9700\u8981\u8fd4\u56de\u672c\u6b21\u6821\u9a8c\u7684\u7ed3\u679c\uff0c\u7531\u524d\u7aef\u6765\u5224\u65ad\u662f\u5426\u6821\u9a8c\u6210\u529f\u5e76\u8df3\u8f6c\u9875\u9762\uff1a</p> <p></p> <p>\u56e0\u6b64\uff0c\u73b0\u5728\u6211\u4eec\u53ea\u9700\u8981\u8ba9\u767b\u5f55\u6a21\u5757\u54cd\u5e94\u4e00\u4e2aJSON\u6570\u636e\u544a\u8bc9\u524d\u7aef\u767b\u5f55\u6210\u529f\u4e0e\u5426\u5373\u53ef\uff0c\u5f53\u7136\uff0c\u524d\u7aef\u5728\u53d1\u8d77\u8bf7\u6c42\u7684\u65f6\u5019\u4f9d\u7136\u9700\u8981\u643a\u5e26Cookie\u4fe1\u606f\uff0c\u5426\u5219\u540e\u7aef\u4e0d\u8ba4\u8bc6\u662f\u8c01\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u5c31\u6765\u5c1d\u8bd5\u5b9e\u73b0\u4e00\u4e0b\u8fd9\u79cd\u6a21\u5f0f\uff0c\u9996\u5148\u6211\u4eec\u914d\u7f6e\u4e00\u4e0bSpringSecurity\u7684\u76f8\u5173\u63a5\u53e3\uff1a</p> <pre><code>@Configuration\npublic class SecurityConfiguration {\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                .authorizeHttpRequests(conf -&gt; {\n                    conf.anyRequest().authenticated();\n                })\n                .formLogin(conf -&gt; {\n                    //\u4e00\u822c\u5206\u79bb\u4e4b\u540e\uff0c\u4e3a\u4e86\u7edf\u4e00\u89c4\u8303\u63a5\u53e3\uff0c\u4f7f\u7528 /api/\u6a21\u5757/\u529f\u80fd \u7684\u5f62\u5f0f\u547d\u540d\u63a5\u53e3\n                    conf.loginProcessingUrl(\"/api/auth/login\");\n                    conf.permitAll();\n                })\n                .csrf(AbstractHttpConfigurer::disable)\n                .build();\n    }\n}\n</code></pre> <p>\u867d\u7136\u8fd9\u6837\u6210\u529f\u5b9a\u4e49\u4e86\u767b\u5f55\u63a5\u53e3\u76f8\u5173\u5185\u5bb9\uff0c\u4f46\u662f\u600e\u4e48\u624d\u80fd\u8ba9SpringSecurity\u5728\u767b\u5f55\u6210\u529f\u4e4b\u540e\u8fd4\u56de\u4e00\u4e2aJSON\u6570\u636e\u7ed9\u524d\u7aef\u800c\u4e0d\u662f\u9ed8\u8ba4\u7684\u91cd\u5b9a\u5411\u5462\uff1f\u8fd9\u65f6\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u8bbe\u7f6eSuccessHandler\u548cFailureHandler\u6765\u5b9e\u73b0\uff1a</p> <pre><code>        @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                ...\n                .formLogin(conf -&gt; {\n                    conf.loginProcessingUrl(\"/api/auth/login\");\n                    //\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u6210\u529f\u5931\u8d25\u5904\u7406\u5668\n                    conf.failureHandler(this::onAuthenticationFailure);\n                    conf.successHandler(this::onAuthenticationSuccess);\n                    conf.permitAll();\n                })\n                ...\n    }\n\n        //\u81ea\u5b9a\u4e49\u6210\u529f\u5931\u8d25\u5904\u7406\u5668\n    void onAuthenticationFailure(HttpServletRequest request,\n                                 HttpServletResponse response,\n                                 AuthenticationException exception) {\n:\n    }\n\n    void onAuthenticationSuccess(HttpServletRequest request, \n                                 HttpServletResponse response, \n                                 Authentication authentication) {\n\n    }\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u6807\u51c6\u7684JSON\u683c\u5f0f\u6570\u636e\u4f5c\u4e3a\u54cd\u5e94\uff0c\u8fd9\u91cc\u6211\u4eec\u6839\u636eRest API\u6807\u51c6\u6765\u8fdb\u884c\u7f16\u5199\uff1a</p> <p>REST API\u662f\u9075\u5faaREST\uff08Representational State Transfer, \u8868\u8ff0\u6027\u72b6\u6001\u8f6c\u79fb\uff09\u539f\u5219\u7684Web\u670d\u52a1\u63a5\u53e3\uff0c\u4e0b\u9762\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0bREST\u63a5\u53e3\u89c4\u8303\u4ee5\u53ca\u5bf9\u5e94\u7684\u54cd\u5e94\u6570\u636e\u8be5\u5982\u4f55\u7f16\u5199:</p> <p>\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u6765\u88c5\u8f7d\u54cd\u5e94\u6570\u636e:</p> <pre><code>public class RestBean&lt;T&gt; {  \n    int code;  \n    T data;  \n    String message;  \n\n    private RestBean(int code, T data,String message) {  \n        this.code = code;  \n        this.data = data;  \n        this.message = message;  \n    }  \n\n    public static &lt;T&gt; RestBean&lt;T&gt; success(T data) {  \n        return new RestBean&lt;&gt;(200,data,\"\u83b7\u53d6\u6210\u529f\");  \n    }  \n\n\n    public static &lt;T&gt; RestBean&lt;T&gt; failure(int code, String message) {  \n        return new RestBean&lt;&gt;(code,null,message);  \n    }  \n\n    public String asJsonString() {  \n        return JSONObject  \n                .from(this, JSONWriter.Feature.WriteNulls)  \n                .toString();  \n    }  \n}\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528\u8bb0\u5f55\u7c7b\u578b\u7684\u65b9\u5f0f(java17)\uff1a</p> <pre><code>public record RestBean&lt;T&gt; (int code, T data, String message) {\n        //\u5199\u51e0\u4e2a\u5de5\u5177\u65b9\u6cd5\uff0c\u7528\u4e8e\u5feb\u901f\u521b\u5efaRestBean\u5bf9\u8c61\n    public static &lt;T&gt; RestBean&lt;T&gt; success(T data){\n        return new RestBean&lt;&gt;(200, data, \"\u8bf7\u6c42\u6210\u529f\");\n    }\n\n    public static &lt;T&gt; RestBean&lt;T&gt; failure(int code, String message){\n        return new RestBean&lt;&gt;(code, null, message);\n    }\n\n    public static &lt;T&gt; RestBean&lt;T&gt; failure(int code){\n        return failure(code, \"\u8bf7\u6c42\u5931\u8d25\");\n    }\n        //\u5c06\u5f53\u524d\u5bf9\u8c61\u8f6c\u6362\u4e3aJSON\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\u7528\u4e8e\u8fd4\u56de\n    public String asJsonString() {\n        return JSONObject.toJSONString(this, JSONWriter.Feature.WriteNulls);\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u7a0d\u5fae\u8bbe\u7f6e\u4e00\u4e0b\u5bf9\u5e94\u7684Handler\u5373\u53ef\uff1a</p> <pre><code>        void onAuthenticationFailure(HttpServletRequest request,\n                                 HttpServletResponse response,\n                                 AuthenticationException exception) throws IOException {\n        response.setContentType(\"application/json;charset=utf-8\");\n        PrintWriter writer = response.getWriter();\n        writer.write(RestBean.failure(401, exception.getMessage()).asJsonString());\n    }\n\n    void onAuthenticationSuccess(HttpServletRequest request,\n                                 HttpServletResponse response,\n                                 Authentication authentication) throws IOException {\n        response.setContentType(\"application/json;charset=utf-8\");\n        PrintWriter writer = response.getWriter();\n        writer.write(RestBean.success(authentication.getName()).asJsonString());\n    }\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528API\u6d4b\u8bd5\u5de5\u5177\u6765\u8c03\u8bd5\u4e00\u4e0b\u4e86\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u54cd\u5e94\u7684\u7ed3\u679c\u662f\u6807\u51c6\u7684JSON\u683c\u5f0f\u6570\u636e\uff0c\u800c\u4e0d\u662f\u50cf\u4e4b\u524d\u90a3\u6837\u91cd\u5b9a\u5411\u5230\u4e00\u4e2a\u9875\u9762\uff0c\u8fd9\u6837\u524d\u7aef\u53d1\u8d77\u7684\u5f02\u6b65\u8bf7\u6c42\u5c31\u53ef\u4ee5\u8fdb\u884c\u5feb\u901f\u5224\u65ad\u4e86\u3002</p> <p>\u6211\u4eec\u6765\u5c1d\u8bd5\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u524d\u7aef\u903b\u8f91\u8bd5\u8bd5\u770b\uff0c\u8fd9\u91cc\u4f9d\u7136\u5f15\u5165Axios\u6846\u67b6\u6765\u53d1\u8d77\u5f02\u6b65\u8bf7\u6c42\uff1a</p> <pre><code>&lt;script src=\"https://unpkg.com/axios@1.1.2/dist/axios.min.js\"&gt;&lt;/script&gt;\n&lt;script&gt;\n    function getInfo() {\n        axios.post('http://localhost:8081/api/auth/login', {\n            username: document.getElementById('username').value,\n            password: document.getElementById('password').value\n        }, {\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded'\n            },\n            withCredentials: true\n        }).then(({data}) =&gt; {\n            if(data.code === 200) {  //\u901a\u8fc7\u72b6\u6001\u7801\u8fdb\u884c\u5224\u65ad\n                window.location.href = '/index.html'  //\u767b\u5f55\u6210\u529f\u8fdb\u5165\u4e3b\u9875\n            } else {\n                alert('\u767b\u5f55\u5931\u8d25\uff1a'+data.message)   //\u767b\u5f55\u5931\u8d25\u8fd4\u56de\u5f39\u7a97\n            }\n        })\n    }\n&lt;/script&gt;\n</code></pre> <p>\u53ef\u80fd\u4f1a\u6709\u5c0f\u4f19\u4f34\u597d\u5947\uff0c\u8fd9\u4e2a\u524d\u7aef\u4e0d\u662f\u6bcf\u4e2a\u9875\u9762\u90fd\u80fd\u968f\u4fbf\u8bbf\u95ee\u5417\uff0c\u8fd9\u767b\u5f55\u8ddf\u4e0d\u767b\u5f55\u6709\u5565\u533a\u522b\uff1f\u5b9e\u9645\u4e0a\u6211\u4eec\u7684\u524d\u7aef\u5f00\u53d1\u8005\u4f1a\u5728\u524d\u7aef\u505a\u76f8\u5e94\u7684\u8def\u7531\u4ee5\u53ca\u62e6\u622a\u6765\u63a7\u5236\u9875\u9762\u7684\u8df3\u8f6c\uff0c\u6211\u4eec\u540e\u7aef\u5f00\u53d1\u8005\u65e0\u9700\u62c5\u5fc3\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u8bc1\u81ea\u5df1\u8fd4\u56de\u7684\u6570\u636e\u662f\u51c6\u786e\u65e0\u8bef\u7684\u5373\u53ef\uff0c\u5176\u4ed6\u7684\u4ea4\u7ed9\u524d\u7aef\u5c0f\u59d0\u59d0\u5c31\u597d\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u662f\u505a\u4e2a\u6837\u5b50\u3002</p> <p>\u5f53\u70b9\u51fb\u6309\u94ae\u65f6\u5c31\u80fd\u53d1\u8d77\u8bf7\u6c42\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u73b0\u5728\u9047\u5230\u4e86\u4e00\u4e2a\u65b0\u7684\u95ee\u9898\uff1a</p> <p></p> <p>\u6211\u4eec\u5728\u53d1\u8d77\u767b\u5f55\u8bf7\u6c42\u65f6\uff0c\u524d\u7aef\u5f97\u5230\u4e86\u4e00\u4e2a\u8de8\u57df\u8bf7\u6c42\u9519\u8bef\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u524d\u7aef\u7684\u7ad9\u70b9\u548c\u540e\u7aef\u7ad9\u70b9\u4e0d\u4e00\u81f4\u5bfc\u81f4\u7684\uff0c\u6d4f\u89c8\u5668\u4e3a\u4e86\u7528\u6237\u7684\u5b89\u5168\uff0c\u9632\u6b62\u7f51\u9875\u4e2d\u4e00\u4e9b\u6076\u610f\u811a\u672c\u8de8\u7ad9\u8bf7\u6c42\u6570\u636e\uff0c\u4f1a\u5bf9\u672a\u7ecf\u8bb8\u53ef\u7684\u8de8\u57df\u8bf7\u6c42\u53d1\u8d77\u62e6\u622a\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u600e\u4e48\u624d\u80fd\u8ba9\u8fd9\u4e2a\u8bf7\u6c42\u53d8\u6210\u6211\u4eec\u8bb8\u53ef\u7684\u5462\uff1f\u5bf9\u4e8e\u8de8\u57df\u95ee\u9898\uff0c\u662f\u5c5e\u4e8e\u6211\u4eec\u540e\u7aef\u9700\u8981\u5904\u7406\u7684\u95ee\u9898\uff0c\u8ddf\u524d\u7aef\u65e0\u5173\uff0c\u6211\u4eec\u9700\u8981\u5728\u54cd\u5e94\u7684\u65f6\u5019\uff0c\u5728\u54cd\u5e94\u5934\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u8de8\u57df\u5c5e\u6027\uff0c\u6765\u544a\u8bc9\u6d4f\u89c8\u5668\u4ece\u54ea\u4e2a\u7ad9\u70b9\u53d1\u6765\u7684\u8de8\u57df\u8bf7\u6c42\u662f\u5b89\u5168\u7684\uff0c\u8fd9\u6837\u6d4f\u89c8\u5668\u5c31\u4e0d\u4f1a\u62e6\u622a\u4e86\u3002</p> <p>\u90a3\u4e48\u5982\u4f55\u8fdb\u884c\u914d\u7f6e\u5462\uff0c\u6211\u4eec\u73b0\u5728\u4f7f\u7528\u4e86SpringSecurity\u6846\u67b6\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u8de8\u57df\u914d\u7f6e\uff1a</p> <pre><code>    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                ...\n                .cors(conf -&gt; {\n                    CorsConfiguration cors = new CorsConfiguration();\n                    //\u6dfb\u52a0\u524d\u7aef\u7ad9\u70b9\u5730\u5740\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u544a\u8bc9\u6d4f\u89c8\u5668\u4fe1\u4efb\u4e86\n                    cors.addAllowedOrigin(\"http://localhost:8080\");\n                    //\u867d\u7136\u4e5f\u53ef\u4ee5\u50cf\u8fd9\u6837\u5141\u8bb8\u6240\u6709 cors.addAllowedOriginPattern(\"*\");\n                    //\u4f46\u662f\u8fd9\u6837\u5e76\u4e0d\u5b89\u5168\uff0c\u6211\u4eec\u5e94\u8be5\u53ea\u8bb8\u53ef\u7ed9\u6211\u4eec\u4fe1\u4efb\u7684\u7ad9\u70b9\n                    cors.setAllowCredentials(true);  //\u5141\u8bb8\u8de8\u57df\u8bf7\u6c42\u4e2d\u643a\u5e26Cookie\n                    cors.addAllowedHeader(\"*\");   //\u5176\u4ed6\u7684\u4e5f\u53ef\u4ee5\u914d\u7f6e\uff0c\u4e3a\u4e86\u65b9\u4fbf\u8fd9\u91cc\u5c31 * \u4e86\n                    cors.addAllowedMethod(\"*\");\n                    cors.addExposedHeader(\"*\");\n                    UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n                    source.registerCorsConfiguration(\"/**\", cors);  //\u76f4\u63a5\u9488\u5bf9\u4e8e\u6240\u6709\u5730\u5740\u751f\u6548\n                    conf.configurationSource(source);\n                })\n                ...\n                .build();\n    }\n</code></pre> <p>\u8fd9\u6837\uff0c\u5f53\u6211\u4eec\u518d\u6b21\u91cd\u542f\u670d\u52a1\u5668\uff0c\u8fd4\u56de\u7684\u54cd\u5e94\u5934\u4e2d\u90fd\u4f1a\u643a\u5e26\u8de8\u57df\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u8fd9\u6837\u6d4f\u89c8\u5668\u5c31\u4e0d\u4f1a\u8fdb\u884c\u62e6\u622a\u4e86\uff1a</p> <p></p> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u524d\u540e\u7aef\u5206\u79bb\u7684\u767b\u5f55\u6a21\u5f0f\u4e86\uff1a</p> <p></p> <p>\u7531\u4e8e\u8bb0\u4f4f\u6211\u529f\u80fd\u548c\u9000\u51fa\u767b\u5f55\u64cd\u4f5c\u8ddf\u4e4b\u524d\u662f\u4e00\u6837\u7684\u914d\u7f6e\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u4e0d\u8fdb\u884c\u6f14\u793a\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#1-rest","title":"1. REST\u63a5\u53e3\u89c4\u8303","text":"<ul> <li>\u4f7f\u7528HTTP\u65b9\u6cd5\uff1aGET\uff08\u68c0\u7d22\u8d44\u6e90\uff09\u3001POST\uff08\u521b\u5efa\u8d44\u6e90\uff09\u3001PUT\uff08\u66f4\u65b0\u8d44\u6e90\uff09\u3001DELETE\uff08\u5220\u9664\u8d44\u6e90\uff09\u3002</li> <li>\u65e0\u72b6\u6001: REST\u63a5\u53e3\u8981\u6c42\u5b9e\u73b0\u65e0\u72b6\u6001\u4ece\u800c\u4f7f\u5176\u72ec\u7acb\u4e8e\u4e4b\u524d\u7684\u8bf7\u6c42\u3002</li> <li>\u4f7f\u7528\u6b63\u786e\u7684HTTP\u72b6\u6001\u7801\uff1a\u5728HTTP\u54cd\u5e94\u4e2d\u53cd\u9988\u64cd\u4f5c\u7684\u7ed3\u679c\uff08\u4f8b\u5982\uff0c200\u8868\u793a\u6210\u529f\uff0c404\u8868\u793a\u8d44\u6e90\u4e0d\u5b58\u5728\u7b49\uff09\u3002</li> <li>URI \u5e94\u8be5\u6e05\u6670\u6613\u61c2\uff1aURI\u5e94\u80fd\u6e05\u6670\u5730\u6307\u793a\u51fa\u6240\u5f15\u7528\u8d44\u6e90\u7684\u7c7b\u578b\u548c\u7f16\u53f7\uff0c\u5e76\u80fd\u6613\u4e8e\u7406\u89e3\u548c\u4f7f\u7528\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#2","title":"2. \u54cd\u5e94\u6570\u636e\u683c\u5f0f","text":"<p>REST\u5e94\u7b54\u4e00\u822c\u4f7f\u7528\u7684\u683c\u5f0f\u4e3aJSON\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e2a\u6807\u51c6\u7684JSON\u54cd\u5e94\u6570\u636e\u6837\u4f8b\uff1a</p> <pre><code>{\n  \"code\": 200,\n  \"data\": {\n    \"id\": 1,\n    \"name\": \"Tom\",\n    \"age\": 18\n  },\n  \"message\": \"\u67e5\u8be2\u6210\u529f\"\n}\n</code></pre> <p>\u5b57\u6bb5\u7684\u542b\u4e49\u5206\u522b\u4e3a\uff1a</p> <ul> <li>code\uff1aHTTP\u72b6\u6001\u7801\uff0c\u8868\u793a\u8bf7\u6c42\u7684\u7ed3\u679c\u3002\u5e38\u89c1\u7684\u6709200\uff08\u6210\u529f\uff09\u3001400\uff08\u5ba2\u6237\u7aef\u9519\u8bef\uff09\u3001500\uff08\u670d\u52a1\u5668\u9519\u8bef\uff09\u7b49\u3002</li> <li>data\uff1a\u54cd\u5e94\u7684\u771f\u5b9e\u6570\u636e\u3002\u5728\u4e0a\u4f8b\u4e2d\uff0c\u662f\u4e00\u4e2a\u5305\u542b\u7528\u6237\u4fe1\u606f\u7684\u5bf9\u8c61\u3002</li> <li>message\uff1a\u8bf7\u6c42\u54cd\u5e94\u4fe1\u606f\uff0c\u5e38\u7528\u4e8e\u63cf\u8ff0\u8bf7\u6c42\u5904\u7406\u7ed3\u679c\u3002</li> </ul> <p>\u4e0a\u8ff0\u90fd\u662f\u5efa\u8bae\u7684\u6700\u4f73\u5b9e\u8df5\uff0c\u5b9e\u9645\u5e94\u7528\u4e2d\u53ef\u4ee5\u6839\u636e\u5177\u4f53\u7684\u4e1a\u52a1\u9700\u6c42\u8fdb\u884c\u9002\u5f53\u7684\u8c03\u6574\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#json","title":"\u54cd\u5e94JSON\u5316","text":"<p>\u524d\u9762\u6211\u4eec\u5b8c\u6210\u4e86\u524d\u540e\u7aef\u5206\u79bb\u7684\u767b\u5f55\u6a21\u5f0f\uff0c\u6211\u4eec\u6765\u770b\u770b\u4e00\u822c\u7684\u4e1a\u52a1\u63a5\u53e3\u8be5\u5982\u4f55\u53bb\u5b9e\u73b0\uff0c\u6bd4\u5982\u8fd9\u91cc\u6211\u4eec\u5199\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u7684\u7528\u6237\u540d\u79f0\u83b7\u53d6\u63a5\u53e3\uff1a</p> <pre><code>@RestController   //\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u4e00\u5f8b\u4f7f\u7528RestController\uff0c\u8fd9\u6837\u6bcf\u4e2a\u8bf7\u6c42\u9ed8\u8ba4\u90fd\u8fd4\u56deJSON\u5bf9\u8c61\n@RequestMapping(\"/api/user\")   //\u7528\u6237\u76f8\u5173\u7684\u63a5\u53e3\uff0c\u8def\u5f84\u53ef\u4ee5\u8bbe\u7f6e\u4e3a/api/user/xxxx\npublic class UserController {\n\n    @GetMapping(\"/name\")\n    public RestBean&lt;String&gt; username() {\n        User user = (User) SecurityContextHolder.getContext().getAuthentication().getPrincipal();\n        return RestBean.success(user.getUsername());\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u524d\u7aef\u5c31\u53ef\u4ee5\u5728\u767b\u5f55\u4e4b\u540e\u83b7\u53d6\u5230\u8fd9\u4e2a\u63a5\u53e3\u7684\u7ed3\u679c\u4e86\uff0c\u6ce8\u610f\u4e00\u5b9a\u8981\u5728\u8bf7\u6c42\u65f6\u643a\u5e26Cookie\uff0c\u5426\u5219\u670d\u52a1\u7aef\u65e0\u6cd5\u8bc6\u522b\u8eab\u4efd\uff0c\u4f1a\u76f4\u63a5\u88ab\u62e6\u622a\u5e76\u91cd\u5b9a\u5411\uff1a</p> <pre><code>&lt;script&gt;\n    axios.get('http://localhost:8081/api/user/name', {\n        withCredentials: true  //\u643a\u5e26Cookie\u8bbf\u95ee\uff0c\u4e0d\u7136\u670d\u52a1\u5668\u4e0d\u8ba4\u8bc6\u6211\u4eec\n    }).then(({data}) =&gt; {\n        document.getElementById('username').innerText = data.data\n    })\n&lt;/script&gt;\n</code></pre> <p>\u6ce8\u610f\u4e00\u5b9a\u8981\u767b\u5f55\u4e4b\u540e\u518d\u8bf7\u6c42\uff0c\u6210\u529f\u7684\u8bf7\u6c42\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u4e0d\u8fc7\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u7684\u4e00\u4e9b\u54cd\u5e94\u8fd8\u662f\u4e0d\u5b8c\u5584\uff0c\u6bd4\u5982\u7528\u6237\u6ca1\u6709\u767b\u5f55\uff0c\u9ed8\u8ba4\u8fd8\u662f\u4f1a302\u91cd\u5b9a\u5411\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u6211\u4eec\u53ea\u9700\u8981\u544a\u8bc9\u524d\u7aef\u6ca1\u6709\u767b\u5f55\u5c31\u884c\u4e86\uff0c\u6240\u4ee5\u8bf4\u6211\u4eec\u4fee\u6539\u4e00\u4e0b\u672a\u767b\u5f55\u72b6\u6001\u4e0b\u8fd4\u56de\u7684\u7ed3\u679c\uff1a</p> <pre><code>    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                ...\n                .exceptionHandling(conf -&gt; {\n                    //\u914d\u7f6e\u6388\u6743\u76f8\u5173\u5f02\u5e38\u5904\u7406\u5668\n                    conf.accessDeniedHandler(this::onAccessDeny);\n                    //\u914d\u7f6e\u9a8c\u8bc1\u76f8\u5173\u5f02\u5e38\u7684\u5904\u7406\u5668\n                    conf.authenticationEntryPoint(this::onAuthenticationFailure);\n                })\n                .build();\n    }\n</code></pre> <p>\u73b0\u5728\u6709\u4e09\u4e2a\u65b9\u6cd5\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u529f\u80fd\u90fd\u662f\u4e00\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u4eec\u6574\u5408\u4e3a\u540c\u4e00\u4e2a\u65b9\u6cd5\uff1a</p> <pre><code>        private void handleProcess(HttpServletRequest request,\n                       HttpServletResponse response,\n                       Object exceptionOrAuthentication) throws IOException {\n        response.setContentType(\"application/json;charset=utf-8\");\n        PrintWriter writer = response.getWriter();\n        if(exceptionOrAuthentication instanceof AccessDeniedException exception) {\n            writer.write(RestBean.failure(403, exception.getMessage()).asJsonString());\n        } else if(exceptionOrAuthentication instanceof Exception exception) {\n            writer.write(RestBean.failure(401, exception.getMessage()).asJsonString());\n        } else if(exceptionOrAuthentication instanceof Authentication authentication){\n            writer.write(RestBean.success(authentication.getName()).asJsonString());\n        }\n    }\n</code></pre> <p>\u8fd9\u6837\uff0c\u7528\u6237\u5728\u6ca1\u6709\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\uff0c\u8bf7\u6c42\u63a5\u53e3\u5c31\u4f1a\u8fd4\u56de\u6211\u4eec\u7684\u81ea\u5b9a\u4e49JSON\u4fe1\u606f\u4e86\uff1a</p> <p></p> <p>\u5bf9\u4e8e\u6211\u4eec\u9875\u9762\u4e2d\u7684\u4e00\u4e9b\u5e38\u89c1\u7684\u5f02\u5e38\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7f16\u5199\u5f02\u5e38\u5904\u7406\u5668\u6765\u5c06\u5176\u89c4\u8303\u5316\u8fd4\u56de\uff0c\u6bd4\u5982404\u9875\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u914d\u7f6e\u8ba9\u5176\u629b\u51fa\u5f02\u5e38\uff1a</p> <pre><code>spring:\n    mvc:\n    throw-exception-if-no-handler-found: true\n  web:\n    resources:\n      add-mappings: false\n</code></pre> <p>\u7136\u540e\u7f16\u5199\u5f02\u5e38\u5904\u7406\u5668\uff1a</p> <pre><code>@RestController\n@ControllerAdvice\npublic class ExceptionController {\n\n    @ExceptionHandler(Exception.class)\n    public RestBean&lt;String&gt; error(Exception e){\n        if(e instanceof NoHandlerFoundException exception)  //\u8fd9\u91cc\u5c31\u5927\u6982\u5904\u7406\u4e00\u4e0b404\u5c31\u884c\n            return RestBean.failure(404, e.getMessage());  \n        else if (e instanceof ServletException exception)  //\u5176\u4ed6\u7684Servlet\u5f02\u5e38\u5c31\u8fd4\u56de400\u72b6\u6001\u7801\n            return RestBean.failure(400, e.getMessage());\n        else\n            return RestBean.failure(500, e.getMessage());  //\u5176\u4ed6\u5f02\u5e38\u76f4\u63a5\u8fd4\u56de500\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u7684\u540e\u7aef\u5c31\u8fd4\u56de\u7684\u662f\u975e\u5e38\u7edf\u4e00\u7684JSON\u683c\u5f0f\u6570\u636e\u4e86\uff0c\u524d\u7aef\u5f00\u53d1\u4eba\u5458\u53ea\u9700\u8981\u6839\u636e\u6211\u4eec\u8fd4\u56de\u7684\u6570\u636e\u7f16\u5199\u7edf\u4e00\u7684\u5904\u7406\u5373\u53ef\uff0c\u57fa\u4e8eSession\u7684\u524d\u540e\u7aef\u5206\u79bb\u5b9e\u73b0\u8d77\u6765\u4e5f\u662f\u6700\u7b80\u5355\u7684\uff0c\u51e0\u4e4e\u6ca1\u6709\u591a\u5c11\u7684\u5b66\u4e60\u6210\u672c\uff0c\u8ddf\u6211\u4eec\u4e4b\u524d\u7684\u4f7f\u7528\u662f\u4e00\u6837\u7684\uff0c\u53ea\u662f\u73b0\u5728\u524d\u7aef\u5355\u72ec\u7f16\u5199\u4e86\u800c\u5df2\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#token","title":"\u57fa\u4e8eToken\u7684\u5206\u79bb\uff08\u65e0\u72b6\u6001\uff09","text":"<p>\u57fa\u4e8eToken\u7684\u524d\u540e\u7aef\u5206\u79bb\u4e3b\u6253\u65e0\u72b6\u6001\uff0c\u65e0\u72b6\u6001\u670d\u52a1\u662f\u6307\u5728\u5904\u7406\u6bcf\u4e2a\u8bf7\u6c42\u65f6\uff0c\u670d\u52a1\u672c\u8eab\u4e0d\u4f1a\u7ef4\u6301\u4efb\u4f55\u4e0e\u8bf7\u6c42\u76f8\u5173\u7684\u72b6\u6001\u4fe1\u606f\u3002\u6bcf\u4e2a\u8bf7\u6c42\u88ab\u89c6\u4e3a\u72ec\u7acb\u7684\u3001\u81ea\u5305\u542b\u7684\u64cd\u4f5c\uff0c\u670d\u52a1\u53ea\u5173\u6ce8\u5904\u7406\u8bf7\u6c42\u672c\u8eab\uff0c\u800c\u4e0d\u5173\u5fc3\u524d\u540e\u8bf7\u6c42\u4e4b\u95f4\u7684\u72b6\u6001\u53d8\u5316\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u7528\u6237\u5728\u53d1\u8d77\u8bf7\u6c42\u65f6\uff0c\u670d\u52a1\u5668\u4e0d\u4f1a\u8bb0\u5f55\u5176\u4fe1\u606f\uff0c\u800c\u662f\u901a\u8fc7\u7528\u6237\u643a\u5e26\u7684Token\u4fe1\u606f\u6765\u5224\u65ad\u662f\u54ea\u4e00\u4e2a\u7528\u6237\uff1a</p> <ul> <li>\u6709\u72b6\u6001\uff1a\u7528\u6237\u8bf7\u6c42\u63a5\u53e3 -&gt;  \u4eceSession\u4e2d\u8bfb\u53d6\u7528\u6237\u4fe1\u606f  -&gt;   \u6839\u636e\u5f53\u524d\u7684\u7528\u6237\u6765\u5904\u7406\u4e1a\u52a1   -&gt;  \u8fd4\u56de</li> <li>\u65e0\u72b6\u6001\uff1a\u7528\u6237\u643a\u5e26Token\u8bf7\u6c42\u63a5\u53e3    -&gt;   \u4ece\u8bf7\u6c42\u4e2d\u83b7\u53d6\u7528\u6237\u4fe1\u606f   -&gt;   \u6839\u636e\u5f53\u524d\u7684\u7528\u6237\u6765\u5904\u7406\u4e1a\u52a1   -&gt;  \u8fd4\u56de</li> </ul> <p>\u65e0\u72b6\u6001\u670d\u52a1\u7684\u4f18\u70b9\u5305\u62ec\uff1a</p> <ol> <li>\u670d\u52a1\u7aef\u65e0\u9700\u5b58\u50a8\u4f1a\u8bdd\u4fe1\u606f\uff1a\u4f20\u7edf\u7684\u4f1a\u8bdd\u7ba1\u7406\u65b9\u5f0f\u9700\u8981\u670d\u52a1\u7aef\u5b58\u50a8\u7528\u6237\u7684\u4f1a\u8bdd\u4fe1\u606f\uff0c\u5305\u62ec\u7528\u6237\u7684\u8eab\u4efd\u8ba4\u8bc1\u4fe1\u606f\u548c\u4f1a\u8bdd\u72b6\u6001\u3002\u800c\u4f7f\u7528Token\uff0c\u670d\u52a1\u7aef\u65e0\u9700\u5b58\u50a8\u4efb\u4f55\u4f1a\u8bdd\u4fe1\u606f\uff0c\u6240\u6709\u7684\u8ba4\u8bc1\u4fe1\u606f\u90fd\u5305\u542b\u5728Token\u4e2d\uff0c\u4f7f\u5f97\u670d\u52a1\u7aef\u53d8\u5f97\u65e0\u72b6\u6001\uff0c\u51cf\u8f7b\u4e86\u670d\u52a1\u5668\u7684\u8d1f\u62c5\uff0c\u540c\u65f6\u4e5f\u65b9\u4fbf\u4e86\u670d\u52a1\u7684\u6c34\u5e73\u6269\u5c55\u3002</li> <li>\u51cf\u5c11\u7f51\u7edc\u5ef6\u8fdf\uff1a\u4f20\u7edf\u7684\u4f1a\u8bdd\u7ba1\u7406\u65b9\u5f0f\u9700\u8981\u5728\u6bcf\u6b21\u8bf7\u6c42\u4e2d\u90fd\u643a\u5e26\u4f1a\u8bdd\u6807\u8bc6\uff0c\u5373\u4f7f\u662f\u65e0\u72b6\u6001\u7684RESTful API\u4e5f\u9700\u8981\u643a\u5e26\u8eab\u4efd\u8ba4\u8bc1\u4fe1\u606f\u3002\u800c\u4f7f\u7528Token\uff0c\u8eab\u4efd\u8ba4\u8bc1\u4fe1\u606f\u5df2\u7ecf\u5305\u542b\u5728Token\u4e2d\uff0c\u53ea\u9700\u8981\u5728\u8bf7\u6c42\u7684Authorization\u5934\u90e8\u643a\u5e26Token\u5373\u53ef\uff0c\u51cf\u5c11\u4e86\u6bcf\u6b21\u8bf7\u6c42\u7684\u6570\u636e\u91cf\uff0c\u51cf\u5c11\u4e86\u7f51\u7edc\u5ef6\u8fdf\u3002</li> <li>\u5ba2\u6237\u7aef\u65e0\u9700\u5b58\u50a8\u4f1a\u8bdd\u4fe1\u606f\uff1a\u4f20\u7edf\u7684\u4f1a\u8bdd\u7ba1\u7406\u65b9\u5f0f\u4e2d\uff0c\u5ba2\u6237\u7aef\u9700\u8981\u5b58\u50a8\u4f1a\u8bdd\u6807\u8bc6\uff0c\u4ee5\u4fbf\u5728\u6bcf\u6b21\u8bf7\u6c42\u4e2d\u643a\u5e26\u3002\u800c\u4f7f\u7528Token\uff0c\u5ba2\u6237\u7aef\u53ea\u9700\u8981\u4fdd\u5b58Token\u5373\u53ef\uff0c\u65b9\u4fbf\u4e86\u5ba2\u6237\u7aef\u7684\u5b58\u50a8\u548c\u7ba1\u7406\u3002</li> <li>\u8de8\u57df\u652f\u6301\uff1aToken\u53ef\u4ee5\u5728\u5404\u4e2a\u4e0d\u540c\u7684\u57df\u540d\u4e4b\u95f4\u8fdb\u884c\u4f20\u9012\u548c\u4f7f\u7528\uff0c\u56e0\u4e3aToken\u662f\u901a\u8fc7\u7b7e\u540d\u6765\u9a8c\u8bc1\u548c\u4fdd\u62a4\u6570\u636e\u5b8c\u6574\u6027\u7684\uff0c\u53ef\u4ee5\u9632\u6b62\u672a\u7ecf\u6388\u6743\u7684\u4fee\u6539\u3002</li> </ol> <p>\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u6df1\u5165\u5b66\u4e60\u76ee\u524d\u6bd4\u8f83\u4e3b\u6d41\u7684\u57fa\u4e8eToken\u7684\u524d\u540e\u7aef\u5206\u79bb\u65b9\u6848\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#jwt","title":"\u8ba4\u8bc6JWT\u4ee4\u724c","text":"<p>\u5728\u8ba4\u8bc6Token\u524d\u540e\u7aef\u5206\u79bb\u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u5148\u5b66\u4e60\u6700\u5e38\u89c1\u7684JWT\u4ee4\u724c\uff0c\u5b98\u7f51\uff1ahttps://jwt.io</p> <p>JSON Web Token\u4ee4\u724c\uff08JWT\uff09\u662f\u4e00\u4e2a\u5f00\u653e\u6807\u51c6\uff08RFC 7519\uff09\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u79cd\u7d27\u51d1\u548c\u81ea\u6210\u4e00\u4f53\u7684\u65b9\u5f0f\uff0c\u7528\u4e8e\u5728\u5404\u65b9\u4e4b\u95f4\u4f5c\u4e3aJSON\u5bf9\u8c61\u5b89\u5168\u5730\u4f20\u8f93\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u88ab\u9a8c\u8bc1\u548c\u4fe1\u4efb\uff0c\u56e0\u4e3a\u5b83\u662f\u6570\u5b57\u7b7e\u540d\u7684\u3002JWT\u53ef\u4ee5\u4f7f\u7528\u5bc6\u94a5\uff08\u4f7f\u7528HMAC\u7b97\u6cd5\uff09\u6216\u4f7f\u7528RSA\u6216ECDSA\u8fdb\u884c\u516c\u94a5/\u79c1\u94a5\u5bf9\u8fdb\u884c\u7b7e\u540d\u3002</p> <p>JWT\u4ee4\u724c\u7684\u683c\u5f0f\u5982\u4e0b\uff1a</p> <p></p> <p>\u4e00\u4e2aJWT\u4ee4\u724c\u75313\u90e8\u5206\u7ec4\u6210\uff1a\u6807\u5934(Header)\u3001\u6709\u6548\u8f7d\u8377(Payload)\u548c\u7b7e\u540d(Signature)\u3002\u5728\u4f20\u8f93\u7684\u65f6\u5019\uff0c\u4f1a\u5c06JWT\u7684\u94b12\u90e8\u5206\u5206\u522b\u8fdb\u884cBase64\u7f16\u7801\u540e\u7528<code>.</code>\u8fdb\u884c\u8fde\u63a5\u5f62\u6210\u6700\u7ec8\u9700\u8981\u4f20\u8f93\u7684\u5b57\u7b26\u4e32\u3002</p> <ul> <li>\u6807\u5934\uff1a\u5305\u542b\u4e00\u4e9b\u5143\u6570\u636e\u4fe1\u606f\uff0c\u6bd4\u5982JWT\u7b7e\u540d\u6240\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u8fd8\u6709\u7c7b\u578b\uff0c\u8fd9\u91cc\u7edf\u4e00\u90fd\u662fJWT\u3002</li> <li>\u6709\u6548\u8f7d\u8377\uff1a\u5305\u62ec\u7528\u6237\u540d\u79f0\u3001\u4ee4\u724c\u53d1\u5e03\u65f6\u95f4\u3001\u8fc7\u671f\u65f6\u95f4\u3001JWT ID\u7b49\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6dfb\u52a0\u5b57\u6bb5\uff0c\u6211\u4eec\u7684\u7528\u6237\u4fe1\u606f\u4e00\u822c\u90fd\u5728\u8fd9\u91cc\u5b58\u653e\u3002</li> <li>\u7b7e\u540d\uff1a\u9996\u5148\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u5bc6\u94a5\uff0c\u8be5\u5bc6\u94a5\u4ec5\u4ec5\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u4e2d\uff0c\u4fdd\u8bc1\u4e0d\u80fd\u8ba9\u5176\u4ed6\u7528\u6237\u77e5\u9053\u3002\u7136\u540e\u4f7f\u7528Header\u4e2d\u6307\u5b9a\u7684\u7b97\u6cd5\u5bf9Header\u548cPayload\u8fdb\u884cbase64\u52a0\u5bc6\u4e4b\u540e\u7684\u7ed3\u679c\u901a\u8fc7\u5bc6\u94a5\u8ba1\u7b97\u54c8\u5e0c\u503c\uff0c\u7136\u540e\u5c31\u5f97\u51fa\u4e00\u4e2a\u7b7e\u540d\u54c8\u5e0c\u3002\u8fd9\u4e2a\u4f1a\u7528\u4e8e\u4e4b\u540e\u9a8c\u8bc1\u5185\u5bb9\u662f\u5426\u88ab\u7be1\u6539\u3002</li> </ul> <p>\u8fd9\u91cc\u8fd8\u662f\u8865\u5145\u4e00\u4e0b\u4e00\u4e9b\u6982\u5ff5\uff0c\u56e0\u4e3a\u5f88\u591a\u4e1c\u897f\u90fd\u662f\u6211\u4eec\u4e4b\u524d\u6ca1\u6709\u63a5\u89e6\u8fc7\u7684\uff1a</p> <ul> <li>Base64\uff1a\u5c31\u662f\u5305\u62ec\u5c0f\u5199\u5b57\u6bcda-z\u3001\u5927\u5199\u5b57\u6bcdA-Z\u3001\u6570\u5b570-9\u3001\u7b26\u53f7\"+\"\u3001\"/\"\u4e00\u517164\u4e2a\u5b57\u7b26\u7684\u5b57\u7b26\u96c6\uff08\u672b\u5c3e\u8fd8\u67091\u4e2a\u6216\u591a\u4e2a<code>=</code>\u7528\u6765\u51d1\u591f\u5b57\u8282\u6570\uff09\uff0c\u4efb\u4f55\u7684\u7b26\u53f7\u90fd\u53ef\u4ee5\u8f6c\u6362\u6210\u8fd9\u4e2a\u5b57\u7b26\u96c6\u4e2d\u7684\u5b57\u7b26\uff0c\u8fd9\u4e2a\u8f6c\u6362\u8fc7\u7a0b\u5c31\u53eb\u505aBase64\u7f16\u7801\uff0c\u7f16\u7801\u4e4b\u540e\u4f1a\u751f\u6210\u53ea\u5305\u542b\u4e0a\u8ff064\u4e2a\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u3002\u76f8\u53cd\uff0c\u5982\u679c\u9700\u8981\u539f\u672c\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u8fdb\u884cBase64\u89e3\u7801\uff0c\u56de\u5230\u539f\u6709\u7684\u6837\u5b50\u3002</li> </ul> <pre><code>public void test(){\n    String str = \"\u4f60\u4eec\u53ef\u80fd\u4e0d\u77e5\u9053\u53ea\u752820\u4e07\u8d62\u5230578\u4e07\u662f\u4ec0\u4e48\u6982\u5ff5\";\n      //Base64\u4e0d\u53ea\u662f\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u7f16\u7801\uff0c\u4efb\u4f55byte[]\u6570\u636e\u90fd\u53ef\u4ee5\uff0c\u7f16\u7801\u7ed3\u679c\u53ef\u4ee5\u662fbyte[]\uff0c\u4e5f\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\n    String encodeStr = Base64.getEncoder().encodeToString(str.getBytes());\n    System.out.println(\"Base64\u7f16\u7801\u540e\u7684\u5b57\u7b26\u4e32\uff1a\"+encodeStr);\n\n    System.out.println(\"\u89e3\u7801\u540e\u7684\u5b57\u7b26\u4e32\uff1a\"+new String(Base64.getDecoder().decode(encodeStr)));\n}\n</code></pre> <p>\u6ce8\u610fBase64\u4e0d\u662f\u52a0\u5bc6\u7b97\u6cd5\uff0c\u53ea\u662f\u4e00\u79cd\u4fe1\u606f\u7684\u7f16\u7801\u65b9\u5f0f\u800c\u5df2\u3002</p> <ul> <li>\u52a0\u5bc6\u7b97\u6cd5\uff1a\u52a0\u5bc6\u7b97\u6cd5\u5206\u4e3a\u5bf9\u79f0\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u52a0\u5bc6\uff0c\u5176\u4e2d\u5bf9\u79f0\u52a0\u5bc6\uff08Symmetric Cryptography\uff09\u6bd4\u8f83\u597d\u7406\u89e3\uff0c\u5c31\u50cf\u4e00\u628a\u9501\u914d\u4e86\u4e24\u628a\u94a5\u5319\u4e00\u6837\uff0c\u8fd9\u4e24\u628a\u94a5\u5319\u4f60\u548c\u522b\u4eba\u90fd\u6709\u4e00\u628a\uff0c\u7136\u540e\u4f60\u4eec\u76f4\u63a5\u4f20\u9012\u6570\u636e\uff0c\u90fd\u4f1a\u628a\u6570\u636e\u7528\u9501\u7ed9\u9501\u4e0a\uff0c\u5c31\u7b97\u4f20\u9012\u7684\u9014\u4e2d\u6709\u4eba\u628a\u6570\u636e\u7a83\u53d6\u4e86\uff0c\u4e5f\u6ca1\u529e\u6cd5\u89e3\u5bc6\uff0c\u56e0\u4e3a\u94a5\u5319\u53ea\u6709\u4f60\u548c\u5bf9\u65b9\u6709\uff0c\u6ca1\u6709\u94a5\u5319\u65e0\u6cd5\u8fdb\u884c\u89e3\u5bc6\uff0c\u4f46\u662f\u8fd9\u6837\u6709\u4e2a\u95ee\u9898\uff0c\u65e2\u7136\u89e3\u5bc6\u7684\u5173\u952e\u5728\u4e8e\u94a5\u5319\u672c\u8eab\uff0c\u90a3\u4e48\u5982\u679c\u6709\u4eba\u4e0d\u4ec5\u7a83\u53d6\u4e86\u6570\u636e\uff0c\u800c\u4e14\u5bf9\u65b9\u90a3\u8fb9\u7684\u6cbb\u5b89\u4e5f\u4e0d\u597d\uff0c\u4e8e\u662f\u987a\u624b\u5c31\u5077\u8d70\u4e86\u94a5\u5319\uff0c\u90a3\u4f60\u4eec\u4e4b\u95f4\u53d1\u7684\u6570\u636e\u4e0d\u5c31\u51c9\u51c9\u4e86\u5417\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u975e\u5bf9\u79f0\u52a0\u5bc6\uff08Asymmetric Cryptography\uff09\u7b97\u6cd5\u51fa\u73b0\u4e86\uff0c\u5b83\u5e76\u4e0d\u662f\u76f4\u63a5\u751f\u6210\u4e00\u628a\u94a5\u5319\uff0c\u800c\u662f\u751f\u6210\u4e00\u4e2a\u516c\u94a5\u548c\u4e00\u4e2a\u79c1\u94a5\uff0c\u79c1\u94a5\u53ea\u80fd\u7531\u4f60\u4fdd\u7ba1\uff0c\u800c\u516c\u94a5\u4ea4\u7ed9\u5bf9\u65b9\u6216\u662f\u4f60\u8981\u53d1\u9001\u7684\u4efb\u4f55\u4eba\u90fd\u884c\uff0c\u73b0\u5728\u4f60\u9700\u8981\u628a\u6570\u636e\u4f20\u7ed9\u5bf9\u65b9\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4f7f\u7528\u79c1\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u4f46\u662f\uff0c\u8fd9\u4e2a\u6570\u636e\u53ea\u80fd\u4f7f\u7528\u5bf9\u5e94\u7684\u516c\u94a5\u8fdb\u884c\u89e3\u5bc6\uff0c\u76f8\u53cd\uff0c\u5982\u679c\u5bf9\u65b9\u9700\u8981\u7ed9\u4f60\u53d1\u9001\u6570\u636e\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u7528\u516c\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u800c\u6570\u636e\u53ea\u80fd\u4f7f\u7528\u79c1\u94a5\u8fdb\u884c\u89e3\u5bc6\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u7b97\u5bf9\u65b9\u7684\u516c\u94a5\u88ab\u7a83\u53d6\uff0c\u90a3\u4e48\u522b\u4eba\u53d1\u7ed9\u4f60\u7684\u6570\u636e\u4e5f\u6ca1\u529e\u6cd5\u89e3\u5bc6\u51fa\u6765\uff0c\u56e0\u4e3a\u9700\u8981\u79c1\u94a5\u624d\u80fd\u89e3\u5bc6\uff0c\u800c\u53ea\u6709\u4f60\u624d\u6709\u79c1\u94a5\u3002</p> <p>\u56e0\u6b64\uff0c\u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u5b89\u5168\u6027\u4f1a\u66f4\u9ad8\u4e00\u4e9b\uff0c\u5305\u62ecHTTPS\u7684\u9690\u79c1\u4fe1\u606f\u6b63\u662f\u4f7f\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u6765\u4fdd\u969c\u4f20\u8f93\u6570\u636e\u7684\u5b89\u5168\uff08\u5f53\u7136HTTPS\u5e76\u4e0d\u662f\u5355\u7eaf\u5730\u4f7f\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u5b8c\u6210\u7684\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u53bb\u4e86\u89e3\u4e00\u4e0b\uff09</p> <p>\u5bf9\u79f0\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u52a0\u5bc6\u90fd\u6709\u5f88\u591a\u7684\u7b97\u6cd5\uff0c\u6bd4\u5982\u5bf9\u79f0\u52a0\u5bc6\uff0c\u5c31\u6709\uff1aDES\u3001IDEA\u3001RC2\uff0c\u975e\u5bf9\u79f0\u52a0\u5bc6\u6709\uff1aRSA\u3001DAS\u3001ECC</p> <ul> <li>\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\uff1a\u5e38\u89c1\u7684\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u6709MD5, HMAC, SHA-1, SHA-224, SHA-256, SHA-384, \u548cSHA-512, \u5176\u4e2dSHA-224\u3001SHA-256\u3001SHA-384\uff0c\u548cSHA-512\u6211\u4eec\u53ef\u4ee5\u7edf\u79f0\u4e3aSHA2\u52a0\u5bc6\u7b97\u6cd5\uff0cSHA\u52a0\u5bc6\u7b97\u6cd5\u7684\u5b89\u5168\u6027\u8981\u6bd4MD5\u66f4\u9ad8\uff0c\u800cSHA2\u52a0\u5bc6\u7b97\u6cd5\u6bd4SHA1\u7684\u8981\u9ad8\uff0c\u5176\u4e2dSHA\u540e\u9762\u7684\u6570\u5b57\u8868\u793a\u7684\u662f\u52a0\u5bc6\u540e\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\uff0cSHA1\u9ed8\u8ba4\u4f1a\u4ea7\u751f\u4e00\u4e2a160\u4f4d\u7684\u4fe1\u606f\u6458\u8981\u3002\u7ecf\u8fc7\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u5f97\u5230\u7684\u52a0\u5bc6\u7ed3\u679c\uff0c\u662f\u65e0\u6cd5\u89e3\u5bc6\u56de\u53bb\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u52a0\u5bc6\u51fa\u6765\u662f\u4ec0\u4e48\u5c31\u662f\u4ec0\u4e48\u4e86\u3002\u672c\u8d28\u4e0a\uff0c\u5176\u5c31\u662f\u4e00\u79cd\u54c8\u5e0c\u51fd\u6570\uff0c\u7528\u4e8e\u5bf9\u4e00\u6bb5\u4fe1\u606f\u4ea7\u751f\u6458\u8981\uff0c\u4ee5\u9632\u6b62\u88ab\u7be1\u6539\u3002</li> </ul> <p>\u5b9e\u9645\u4e0a\u8fd9\u79cd\u7b97\u6cd5\u5c31\u5e38\u5e38\u88ab\u7528\u4f5c\u4fe1\u606f\u6458\u8981\u8ba1\u7b97\uff0c\u540c\u6837\u7684\u6570\u636e\u901a\u8fc7\u540c\u6837\u7684\u7b97\u6cd5\u8ba1\u7b97\u5f97\u5230\u7684\u7ed3\u679c\u80af\u5b9a\u4e5f\u4e00\u6837\uff0c\u800c\u5982\u679c\u6570\u636e\u88ab\u4fee\u6539\uff0c\u90a3\u4e48\u8ba1\u7b97\u7684\u7ed3\u679c\u80af\u5b9a\u5c31\u4e0d\u4e00\u6837\u4e86\u3002</p> <p>\u56e0\u6b64\uff0cJWT\u4ee4\u724c\u5b9e\u9645\u4e0a\u662f\u4e00\u79cd\u7ecf\u8fc7\u52a0\u5bc6\u7684JSON\u6570\u636e\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u7528\u6237\u540d\u5b57\u3001\u7528\u6237ID\u7b49\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u89e3\u5bc6JWT\u4ee4\u724c\u5f97\u5230\u7528\u6237\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a\u5c0f\u6d4b\u8bd5\u6765\u770b\u770b\uff0c\u5bfc\u5165JWT\u652f\u6301\u5e93\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n     &lt;groupId&gt;com.auth0&lt;/groupId&gt;\n     &lt;artifactId&gt;java-jwt&lt;/artifactId&gt;\n     &lt;version&gt;4.3.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u8981\u751f\u6210\u4e00\u4e2aJWT\u4ee4\u724c\u975e\u5e38\u7b80\u5355\uff1a</p> <pre><code>public class Main {\n    public static void main(String[] args) {\n        String jwtKey = \"abcdefghijklmn\";                 //\u4f7f\u7528\u4e00\u4e2aJWT\u79d8\u94a5\u8fdb\u884c\u52a0\u5bc6\n        Algorithm algorithm = Algorithm.HMAC256(jwtKey);  //\u521b\u5efaHMAC256\u52a0\u5bc6\u7b97\u6cd5\u5bf9\u8c61\n        String jwtToken = JWT.create()\n                .withClaim(\"id\", 1)   //\u5411\u4ee4\u724c\u4e2d\u585e\u5165\u81ea\u5b9a\u4e49\u7684\u6570\u636e\n                .withClaim(\"name\", \"lbw\")\n                .withClaim(\"role\", \"nb\")\n                .withExpiresAt(new Date(2024, Calendar.FEBRUARY, 1))  //JWT\u4ee4\u724c\u7684\u5931\u6548\u65f6\u95f4\n                .withIssuedAt(new Date())   //JWT\u4ee4\u724c\u7684\u7b7e\u53d1\u65f6\u95f4\n                .sign(algorithm);    //\u4f7f\u7528\u4e0a\u9762\u7684\u52a0\u5bc6\u7b97\u6cd5\u8fdb\u884c\u52a0\u5bc6\uff0c\u5b8c\u6210\u7b7e\u540d\n        System.out.println(jwtToken);   //\u5f97\u5230\u6700\u7ec8\u7684JWT\u4ee4\u724c\n    }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u6700\u540e\u5f97\u5230\u7684JWT\u4ee4\u724c\u5c31\u957f\u8fd9\u6837\uff1a</p> <pre><code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoibmIiLCJuYW1lIjoibGJ3IiwiaWQiOjEsImV4cCI6NjE2NjQ4NjA4MDAsImlhdCI6MTY5MDEzMTQ3OH0.KUuGKM0OynL_DEUnRIETDBlmGjoqbt_5dP2r21ZDE1s\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528Base64\u5c06\u5176\u8fd8\u539f\u4e3a\u539f\u672c\u7684\u6837\u5b50\uff1a</p> <pre><code>public static void main(String[] args) {\n        String jwtToken = \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJyb2xlIjoibmIiLCJuYW1lIjoibGJ3IiwiaWQiOjEsImV4cCI6NjE2NjQ4NjA4MDAsImlhdCI6MTY5MDEzMTQ3OH0.KUuGKM0OynL_DEUnRIETDBlmGjoqbt_5dP2r21ZDE1s\";\n        String[] split = jwtToken.split(\"\\\\.\");\n        for (int i = 0; i &lt; split.length - 1; i++) {\n            String s = split[i];\n            byte[] decode = Base64.getDecoder().decode(s);\n            System.out.println(new String(decode));\n        }\n}\n</code></pre> <p>\u89e3\u6790\u524d\u9762\u4e24\u4e2a\u90e8\u5206\u5f97\u5230\uff1a</p> <pre><code>{\"typ\":\"JWT\",\"alg\":\"HS256\"}\n{\"role\":\"nb\",\"name\":\"lbw\",\"id\":1,\"exp\":61664860800,\"iat\":1690131478}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u786e\u5b9e\u662f\u7ecf\u8fc7Base64\u52a0\u5bc6\u7684JSON\u683c\u5f0f\u6570\u636e\uff0c\u5305\u62ec\u6211\u4eec\u7684\u81ea\u5b9a\u4e49\u6570\u636e\u4e5f\u5728\u5176\u4e2d\uff0c\u800c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528JWT\u4ee4\u724c\u6765\u4f5c\u4e3a\u6211\u4eec\u6743\u9650\u6821\u9a8c\u7684\u6838\u5fc3\uff0c\u6211\u4eec\u53ef\u4ee5\u50cf\u8fd9\u6837\u8bbe\u8ba1\u6211\u4eec\u7684\u7cfb\u7edf\uff1a</p> <p></p> <p>\u9996\u5148\u7528\u6237\u8fd8\u662f\u6309\u7167\u6b63\u5e38\u6d41\u7a0b\u8fdb\u884c\u767b\u5f55\uff0c\u53ea\u4e0d\u8fc7\u7528\u6237\u5728\u767b\u5f55\u6210\u529f\u4e4b\u540e\uff0c\u670d\u52a1\u7aef\u4f1a\u8fd4\u56de\u4e00\u4e2aJWT\u4ee4\u724c\u7528\u4e8e\u540e\u7eed\u8bf7\u6c42\u4f7f\u7528\uff0c\u7531\u4e8eJWT\u4ee4\u724c\u5177\u6709\u65f6\u6548\u6027\uff0c\u6240\u4ee5\u8bf4\u5f53\u8fc7\u671f\u4e4b\u540e\u53c8\u9700\u8981\u91cd\u65b0\u767b\u5f55\u3002\u5c31\u50cf\u6211\u4eec\u8fdb\u5165\u6e38\u4e50\u56ed\u9700\u8981\u4e00\u5f20\u95e8\u7968\u4e00\u6837\uff0c\u53ea\u6709\u6301\u6709\u6e38\u4e50\u56ed\u95e8\u7968\u624d\u80fd\u8fdb\u5165\u6e38\u4e50\u56ed\u6e38\u73a9\uff0c\u5982\u679c\u6ca1\u6709\u95e8\u7968\u5c31\u4f1a\u88ab\u62d2\u4e4b\u95e8\u5916\uff0c\u800c\u6e38\u4e50\u56ed\u95e8\u7968\u4e5f\u6709\u65f6\u95f4\u9650\u5236\uff0c\u5982\u679c\u5df2\u7ecf\u8fc7\u671f\uff0c\u6211\u4eec\u4e5f\u662f\u6ca1\u6709\u529e\u6cd5\u8fdb\u5165\u6e38\u4e50\u56ed\u7684\u3002</p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u540e\u7eed\u8bf7\u6c42\u4e2d\u643a\u5e26\u8fd9\u4e2aToken\u5373\u53ef\uff08\u53ef\u4ee5\u653e\u5728Cookie\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u653e\u5728\u8bf7\u6c42\u5934\u4e2d\uff09\u8fd9\u6837\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u76f4\u63a5\u4eceToken\u4e2d\u89e3\u5bc6\u8bfb\u53d6\u5230\u6211\u4eec\u7528\u6237\u7684\u76f8\u5173\u4fe1\u606f\u4ee5\u53ca\u5224\u65ad\u7528\u6237\u662f\u5426\u767b\u5f55\u8fc7\u671f\u4e86\u3002</p> <p>\u4e0d\u8fc7\u8fd9\u4e2a\u65f6\u5019\u4f1a\u6709\u5c0f\u4f19\u4f34\u7591\u95ee\uff0c\u65e2\u7136\u73b0\u5728\u7528\u6237\u4fe1\u606f\u90fd\u5728JWT\u4e2d\uff0c\u90a3\u8981\u662f\u7528\u6237\u968f\u4fbf\u4fee\u6539\u91cc\u9762\u7684\u5185\u5bb9\uff0c\u5c82\u4e0d\u662f\u53ef\u4ee5\u4ee5\u4efb\u610f\u8eab\u4efd\u8bbf\u95ee\u670d\u52a1\u5668\u4e86\uff1f\u8fd9\u4f1a\u4e0d\u4f1a\u5b58\u5728\u5b89\u5168\u9690\u60a3\uff1f\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\uff0c\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u8bf4\u7684\u5f88\u6e05\u695a\u4e86\uff0cJWT\u5b9e\u9645\u4e0a\u6700\u540e\u4f1a\u6709\u4e00\u4e2a\u52a0\u5bc6\u7684\u7b7e\u540d\uff0c\u8fd9\u4e2a\u662f\u6839\u636e\u79d8\u94a5+JWT\u672c\u4f53\u5185\u5bb9\u8ba1\u7b97\u5f97\u5230\u7684\uff0c\u7528\u6237\u5728\u6ca1\u6709\u6301\u6709\u79d8\u94a5\u7684\u60c5\u51b5\u4e0b\uff0c\u662f\u4e0d\u53ef\u80fd\u8ba1\u7b97\u5f97\u5230\u6b63\u786e\u7684\u7b7e\u540d\u7684\uff0c\u6240\u4ee5\u8bf4\u670d\u52a1\u5668\u4f1a\u5728\u6536\u5230JWT\u65f6\u5bf9\u7b7e\u540d\u8fdb\u884c\u91cd\u65b0\u8ba1\u7b97\uff0c\u6bd4\u8f83\u662f\u5426\u4e00\u81f4\uff0c\u6765\u9a8c\u8bc1JWT\u662f\u5426\u88ab\u7528\u6237\u6076\u610f\u4fee\u6539\uff0c\u5982\u679c\u88ab\u4fee\u6539\u80af\u5b9a\u4e5f\u662f\u4e0d\u80fd\u901a\u8fc7\u7684\u3002</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#springsecurityjwt","title":"SpringSecurity\u5b9e\u73b0JWT\u6821\u9a8c","text":"<p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86JWT\u7684\u57fa\u672c\u539f\u7406\u4ee5\u53ca\u540e\u7aef\u7684\u57fa\u672c\u6821\u9a8c\u6d41\u7a0b\uff0c\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u5c31\u6765\u770b\u770b\u5982\u4f55\u5b9e\u73b0\u8fd9\u6837\u7684\u6d41\u7a0b\u3002</p> <p>SpringSecurity\u4e2d\u5e76\u6ca1\u6709\u4e3a\u6211\u4eec\u63d0\u4f9b\u9884\u8bbe\u7684JWT\u6821\u9a8c\u6a21\u5757\uff08\u53ea\u6709OAuth2\u6a21\u5757\u624d\u6709\uff0c\u4f46\u662f\u77e5\u8bc6\u592a\u8d85\u524d\u4e86\uff0c\u6211\u4eec\u6682\u65f6\u4e0d\u8bb2\u89e3\uff09\u8fd9\u91cc\u6211\u4eec\u53ea\u80fd\u624b\u52a8\u8fdb\u884c\u6574\u5408\uff0cJWT\u53ef\u4ee5\u5b58\u653e\u5728Cookie\u6216\u662f\u8bf7\u6c42\u5934\u4e2d\uff0c\u4e0d\u8fc7\u4e0d\u7ba1\u54ea\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5\u901a\u8fc7Request\u83b7\u53d6\u5230\u5bf9\u5e94\u7684JWT\u4ee4\u724c\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u6bd4\u8f83\u5e38\u89c1\u7684\u8bf7\u6c42\u5934\u643a\u5e26JWT\u7684\u65b9\u6848\uff0c\u5ba2\u6237\u7aef\u53d1\u8d77\u7684\u8bf7\u6c42\u4e2d\u4f1a\u643a\u5e26\u8fd9\u6837\u7684\u7684\u7279\u6b8a\u8bf7\u6c42\u5934\uff1a</p> <pre><code>Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJzZWxmIiwic3ViIjoidXNlciIsImV4cCI6MTY5MDIxODE2NCwiaWF0IjoxNjkwMTgyMTY0LCJzY29wZSI6ImFwcCJ9.Z5-WMeulZyx60WeNxrQg2z2GiVquEHrsBl9V4dixbRkAD6rFp-6gCrcAXWkebs0i-we4xTQ7TZW0ltuhGYZ1GmEaj4F6BP9VN8fLq2aT7GhCJDgjikaTs-w5BbbOD2PN_vTAK_KeVGvYhWU4_l81cvilJWVXAhzMtwgPsz1Dkd04cWTCpI7ZZi-RQaBGYlullXtUrehYcjprla8N-bSpmeb3CBVM3kpAdehzfRpAGWXotN27PIKyAbtiJ0rqdvRmvlSztNY0_1IoO4TprMTUr-wjilGbJ5QTQaYUKRHcK3OJrProz9m8ztClSq0GRvFIB7HuMlYWNYwf7lkKpGvKDg\n</code></pre> <p>\u8fd9\u91cc\u7684Authorization\u8bf7\u6c42\u5934\u5c31\u662f\u643a\u5e26JWT\u7684\u4e13\u7528\u5c5e\u6027\uff0c\u503c\u7684\u683c\u5f0f\u4e3a\"Bearer Token\"\uff0c\u524d\u9762\u7684Bearer\u4ee3\u8868\u8eab\u4efd\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6709\u4e24\u79cd\uff1a</p> <p>Basic \u548c Bearer \u662f\u4e24\u79cd\u4e0d\u540c\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u5f0f\u3002</p> <p>Basic \u662f\u4e00\u79cd\u57fa\u672c\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u5b83\u5c06\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fdb\u884cbase64\u7f16\u7801\u540e\uff0c\u653e\u5728 Authorization \u8bf7\u6c42\u5934\u4e2d\uff0c\u7528\u4e8e\u5411\u670d\u52a1\u5668\u9a8c\u8bc1\u7528\u6237\u8eab\u4efd\u3002\u8fd9\u79cd\u65b9\u5f0f\u4e0d\u591f\u5b89\u5168\uff0c\u56e0\u4e3a\u5b83\u5c06\u5bc6\u7801\u4ee5\u660e\u6587\u7684\u5f62\u5f0f\u4f20\u8f93\uff0c\u5bb9\u6613\u53d7\u5230\u4e2d\u95f4\u4eba\u653b\u51fb\u3002</p> <p>Bearer \u662f\u4e00\u79cd\u66f4\u5b89\u5168\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u5b83\u57fa\u4e8e\u4ee4\u724c\uff08Token\uff09\u6765\u9a8c\u8bc1\u7528\u6237\u8eab\u4efd\u3002Bearer \u4ee4\u724c\u662f\u7531\u8eab\u4efd\u9a8c\u8bc1\u670d\u52a1\u5668\u9881\u53d1\u7ed9\u5ba2\u6237\u7aef\u7684\uff0c\u5ba2\u6237\u7aef\u5728\u6bcf\u4e2a\u8bf7\u6c42\u4e2d\u5c06\u4ee4\u724c\u653e\u5728 Authorization \u8bf7\u6c42\u5934\u7684 Bearer \u5b57\u6bb5\u4e2d\u3002\u670d\u52a1\u5668\u4f1a\u9a8c\u8bc1\u4ee4\u724c\u7684\u6709\u6548\u6027\u548c\u6743\u9650\uff0c\u4ee5\u786e\u5b9a\u7528\u6237\u7684\u8eab\u4efd\u3002Bearer \u4ee4\u724c\u901a\u5e38\u4f7f\u7528 JSON Web Token (JWT) \u7684\u5f62\u5f0f\u8fdb\u884c\u4f20\u9012\u548c\u9a8c\u8bc1\u3002</p> <p>\u4e00\u4f1a\u6211\u4eec\u4f1a\u81ea\u884c\u7f16\u5199JWT\u6821\u9a8c\u62e6\u622a\u5668\u6765\u5904\u7406\u8fd9\u4e9b\u4fe1\u606f\u3002</p> <p>\u9996\u5148\u6211\u4eec\u5148\u628a\u7528\u4e8e\u5904\u7406JWT\u4ee4\u724c\u7684\u5de5\u5177\u7c7b\u5b8c\u6210\u4e00\u4e0b\uff1a</p> <pre><code>public class JwtUtils {\n    //Jwt\u79d8\u94a5\n    private static final String key = \"abcdefghijklmn\";\n\n    //\u6839\u636e\u7528\u6237\u4fe1\u606f\u521b\u5efaJwt\u4ee4\u724c\n    public static String createJwt(UserDetails user){\n        Algorithm algorithm = Algorithm.HMAC256(key);\n        Calendar calendar = Calendar.getInstance();\n        Date now = calendar.getTime();\n        calendar.add(Calendar.SECOND, 3600 * 24 * 7);\n        return JWT.create()\n                .withClaim(\"name\", user.getUsername())  //\u914d\u7f6eJWT\u81ea\u5b9a\u4e49\u4fe1\u606f\n                .withClaim(\"authorities\", user.getAuthorities().stream().map(GrantedAuthority::getAuthority).toList())\n                .withExpiresAt(calendar.getTime())  //\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\n                .withIssuedAt(now)    //\u8bbe\u7f6e\u521b\u5efa\u521b\u5efa\u65f6\u95f4\n                .sign(algorithm);   //\u6700\u7ec8\u7b7e\u540d\n    }\n\n    //\u6839\u636eJwt\u9a8c\u8bc1\u5e76\u89e3\u6790\u7528\u6237\u4fe1\u606f\n    public static UserDetails resolveJwt(String token){\n        Algorithm algorithm = Algorithm.HMAC256(key);\n        JWTVerifier jwtVerifier = JWT.require(algorithm).build();\n        try {\n            DecodedJWT verify = jwtVerifier.verify(token);  //\u5bf9JWT\u4ee4\u724c\u8fdb\u884c\u9a8c\u8bc1\uff0c\u770b\u770b\u662f\u5426\u88ab\u4fee\u6539\n            Map&lt;String, Claim&gt; claims = verify.getClaims();  //\u83b7\u53d6\u4ee4\u724c\u4e2d\u5185\u5bb9\n            if(new Date().after(claims.get(\"exp\").asDate())) //\u5982\u679c\u662f\u8fc7\u671f\u4ee4\u724c\u5219\u8fd4\u56denull\n                return null;\n            else\n                //\u91cd\u65b0\u7ec4\u88c5\u4e3aUserDetails\u5bf9\u8c61\uff0c\u5305\u62ec\u7528\u6237\u540d\u3001\u6388\u6743\u4fe1\u606f\u7b49\n                return User\n                        .withUsername(claims.get(\"name\").asString())\n                        .password(\"\")\n                        .authorities(claims.get(\"authorities\").asArray(String.class))\n                        .build();\n        } catch (JWTVerificationException e) {\n            return null;\n        }\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u81ea\u884c\u5b9e\u73b0\u4e00\u4e2aJwtAuthenticationFilter\u52a0\u5165\u5230SpringSecurity\u9ed8\u8ba4\u63d0\u4f9b\u7684\u8fc7\u6ee4\u5668\u94fe\uff08\u6709\u5173SpringSecurity\u7684\u5b9e\u73b0\u539f\u7406\u4ecb\u7ecd\uff0c\u6211\u4eec\u5728SSM\u4e2d\u5df2\u7ecf\u8be6\u7ec6\u8bb2\u89e3\u8fc7\uff0c\u5404\u4f4d\u5c0f\u4f19\u4f34\u53ef\u4ee5\u56de\u987e\u4e00\u4e0b\uff09\u4e2d\uff0c\u7528\u4e8e\u5904\u7406\u8bf7\u6c42\u5934\u4e2d\u643a\u5e26\u7684JWT\u4ee4\u724c\uff0c\u5e76\u914d\u7f6e\u767b\u5f55\u72b6\u6001\uff1a</p> <pre><code>public class JwtAuthenticationFilter extends OncePerRequestFilter {  \n//\u7ee7\u627fOncePerRequestFilter\u8868\u793a\u6bcf\u6b21\u8bf7\u6c42\u8fc7\u6ee4\u4e00\u6b21\uff0c\u7528\u4e8e\u5feb\u901f\u7f16\u5199JWT\u6821\u9a8c\u89c4\u5219\n\n    @Override\n    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain) throws ServletException, IOException {\n        //\u9996\u5148\u4eceHeader\u4e2d\u53d6\u51faJWT\n        String authorization = request.getHeader(\"Authorization\");\n        //\u5224\u65ad\u662f\u5426\u5305\u542bJWT\u4e14\u683c\u5f0f\u6b63\u786e\n        if (authorization != null &amp;&amp; authorization.startsWith(\"Bearer \")) {\n            String token = authorization.substring(7);  \n            //\u5f00\u59cb\u89e3\u6790\u6210UserDetails\u5bf9\u8c61\uff0c\u5982\u679c\u5f97\u5230\u7684\u662fnull\u8bf4\u660e\u89e3\u6790\u5931\u8d25\uff0cJWT\u6709\u95ee\u9898\n            UserDetails user = JwtUtils.resolveJwt(token);\n            if(user != null) {\n                //\u9a8c\u8bc1\u6ca1\u6709\u95ee\u9898\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5f00\u59cb\u521b\u5efaAuthentication\u4e86\uff0c\u8fd9\u91cc\u6211\u4eec\u8ddf\u9ed8\u8ba4\u60c5\u51b5\u4fdd\u6301\u4e00\u81f4\n                //\u4f7f\u7528UsernamePasswordAuthenticationToken\u4f5c\u4e3a\u5b9e\u4f53\uff0c\u586b\u5199\u76f8\u5173\u7528\u6237\u4fe1\u606f\u8fdb\u53bb\n                UsernamePasswordAuthenticationToken authentication =\n                        new UsernamePasswordAuthenticationToken(user, null, user.getAuthorities());\n                authentication.setDetails(new WebAuthenticationDetailsSource().buildDetails(request));\n                //\u7136\u540e\u76f4\u63a5\u628a\u914d\u7f6e\u597d\u7684Authentication\u585e\u7ed9SecurityContext\u8868\u793a\u5df2\u7ecf\u5b8c\u6210\u9a8c\u8bc1\n                SecurityContextHolder.getContext().setAuthentication(authentication);\n            }\n        }\n        //\u6700\u540e\u653e\u884c\uff0c\u7ee7\u7eed\u4e0b\u4e00\u4e2a\u8fc7\u6ee4\u5668\n        //\u53ef\u80fd\u5404\u4f4d\u5c0f\u4f19\u4f34\u4f1a\u597d\u5947\uff0c\u8981\u662f\u6ca1\u9a8c\u8bc1\u6210\u529f\u4e0d\u662f\u5e94\u8be5\u62e6\u622a\u5417\uff1f\u8fd9\u4e2a\u5176\u5b9e\u6ca1\u6709\u5173\u7cfb\u7684\n        //\u56e0\u4e3a\u5982\u679c\u6ca1\u6709\u9a8c\u8bc1\u5931\u8d25\u4e0a\u9762\u662f\u4e0d\u4f1a\u7ed9SecurityContext\u8bbe\u7f6eAuthentication\u7684\uff0c\u540e\u9762\u76f4\u63a5\u5c31\u88ab\u62e6\u622a\u6389\u4e86\n        //\u800c\u4e14\u6709\u53ef\u80fd\u7528\u6237\u53d1\u8d77\u7684\u662f\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\u8bf7\u6c42\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e5f\u8981\u653e\u884c\u7684\uff0c\u4e0d\u7136\u600e\u4e48\u767b\u5f55\uff0c\u6240\u4ee5\u8bf4\u76f4\u63a5\u653e\u884c\u5c31\u597d\n        filterChain.doFilter(request, response);\n    }\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u6765\u914d\u7f6e\u4e00\u4e0bSecurityConfiguration\u914d\u7f6e\u7c7b\uff0c\u5176\u5b9e\u914d\u7f6e\u65b9\u6cd5\u8ddf\u4e4b\u524d\u8fd8\u662f\u5dee\u4e0d\u591a\uff0c\u7528\u6237\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528\u8868\u5355\u8fdb\u884c\u767b\u5f55\uff0c\u5e76\u4e14\u767b\u5f55\u65b9\u5f0f\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u5c31\u662f\u6709\u4e24\u4e2a\u65b0\u589e\u7684\u90e8\u5206\u9700\u8981\u6211\u4eec\u6ce8\u610f\u4e00\u4e0b\uff1a</p> <pre><code>@Configuration\npublic class SecurityConfiguration {\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        return http\n                    //\u5176\u4ed6\u8ddf\u4e4b\u524d\u4e00\u6837\uff0c\u5c31\u7701\u7565\u6389\u4e86\n                ...  \n                //\u5c06Session\u7ba1\u7406\u521b\u5efa\u7b56\u7565\u6539\u6210\u65e0\u72b6\u6001\uff0c\u8fd9\u6837SpringSecurity\u5c31\u4e0d\u4f1a\u521b\u5efa\u4f1a\u8bdd\u4e86\uff0c\u4e5f\u4e0d\u4f1a\u91c7\u7528\u4e4b\u524d\u90a3\u5957\u673a\u5236\u8bb0\u5f55\u7528\u6237\uff0c\u56e0\u4e3a\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4eceJWT\u4e2d\u83b7\u53d6\u4fe1\u606f\n                .sessionManagement(conf -&gt; {\n                    conf.sessionCreationPolicy(SessionCreationPolicy.STATELESS);\n                })\n                    //\u6dfb\u52a0\u6211\u4eec\u7528\u4e8e\u5904\u7406JWT\u7684\u8fc7\u6ee4\u5668\u5230Security\u8fc7\u6ee4\u5668\u94fe\u4e2d\uff0c\u6ce8\u610f\u8981\u653e\u5728UsernamePasswordAuthenticationFilter\u4e4b\u524d\n                .addFilterBefore(new JwtAuthenticationFilter(), UsernamePasswordAuthenticationFilter.class)\n                .build();\n    }\n\n    //\u8fd9\u4e2a\u8ddf\u4e4b\u524d\u4e00\u6837\u7684\u5199\u6cd5\uff0c\u6574\u5408\u5230\u4e00\u8d77\u5904\u7406\uff0c\u7edf\u4e00\u8fd4\u56deJSON\u683c\u5f0f\n    private void handleProcess(HttpServletRequest request,\n                               HttpServletResponse response,\n                               Object exceptionOrAuthentication) throws IOException {\n        response.setContentType(\"application/json;charset=utf-8\");\n        PrintWriter writer = response.getWriter();\n        if(exceptionOrAuthentication instanceof AccessDeniedException exception) {\n            writer.write(RestBean.failure(403, exception.getMessage()).asJsonString());\n        } else if(exceptionOrAuthentication instanceof AuthenticationException exception) {\n            writer.write(RestBean.failure(401, exception.getMessage()).asJsonString());\n        } else if(exceptionOrAuthentication instanceof Authentication authentication){\n            //\u4e0d\u8fc7\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\uff0c\u5728\u767b\u5f55\u6210\u529f\u7684\u65f6\u5019\u9700\u8981\u8fd4\u56de\u6211\u4eec\u751f\u6210\u7684JWT\u4ee4\u724c\uff0c\u8fd9\u6837\u5ba2\u6237\u7aef\u4e0b\u6b21\u8bbf\u95ee\u5c31\u53ef\u4ee5\u643a\u5e26\u8fd9\u4e2a\u4ee4\u724c\u4e86\uff0c\u4ee4\u724c\u8fc7\u671f\u4e4b\u540e\u5c31\u9700\u8981\u91cd\u65b0\u767b\u5f55\u624d\u53ef\u4ee5\n            writer.write(RestBean.success(JwtUtils.createJwt((User) authentication.getPrincipal())).asJsonString());\n        }\n    }\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u6d4b\u8bd5\u4f7f\u7528\u7684Controller\u6765\u770b\u770b\u6548\u679c\uff1a</p> <pre><code>@RestController\npublic class TestController {\n\n    @GetMapping(\"/test\")\n    public String test(){\n        return \"HelloWorld\";\n    }\n}\n</code></pre> <p>\u90a3\u4e48\u73b0\u5728\u91c7\u7528JWT\u4e4b\u540e\uff0c\u6211\u4eec\u8981\u600e\u4e48\u4f7f\u7528\u5462\uff1f\u9996\u5148\u6211\u4eec\u8fd8\u662f\u4f7f\u7528\u5de5\u5177\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <p></p> <p>\u767b\u5f55\u6210\u529f\u4e4b\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u73b0\u5728\u8fd4\u56de\u7ed9\u6211\u4eec\u4e86\u4e00\u4e2aJWT\u4ee4\u724c\uff0c\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u4ee4\u724c\u4e86\u3002\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u8981\u8bbf\u95ee\u67d0\u4e2a\u63a5\u53e3\u83b7\u53d6\u6570\u636e\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u643a\u5e26\u8fd9\u4e2a\u4ee4\u724c\u8fdb\u884c\u8bbf\u95ee\uff1a</p> <p></p> <p>\u6ce8\u610f\u9700\u8981\u5728\u8bf7\u6c42\u5934\u4e2d\u6dfb\u52a0\uff1a</p> <pre><code>Authorization: Bearer \u521a\u521a\u83b7\u53d6\u7684Token\n</code></pre> <p>\u5982\u679c\u4ee5\u540e\u6ca1\u6709\u767b\u5f55\u6216\u8005\u643a\u5e26\u4e00\u4e2a\u9519\u8bef\u7684JWT\u8bbf\u95ee\u670d\u52a1\u5668\uff0c\u90fd\u4f1a\u8fd4\u56de401\u9519\u8bef\uff1a</p> <p></p> <p>\u6211\u4eec\u73b0\u5728\u6765\u6a21\u62df\u4e00\u4e0b\u524d\u7aef\u64cd\u4f5c\uff1a</p> <pre><code>&lt;script&gt;\n    //\u5176\u4ed6\u90fd\u662f\u8ddf\u4e4b\u524d\u4e00\u6837\u7684\n    function getInfo() {\n        axios.post('http://localhost:8081/api/auth/login', {\n            username: document.getElementById('username').value,\n            password: document.getElementById('password').value\n        }, {\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded'\n            }\n        }).then(({data}) =&gt; {\n            if(data.code === 200) {\n                //\u5c06\u5f97\u5230\u7684JWT\u4ee4\u724c\u5b58\u5230sessionStorage\u7528\u4e8e\u672c\u6b21\u4f1a\u8bdd\n                sessionStorage.setItem(\"access_token\", data.data)\n                window.location.href = '/index.html'\n            } else {\n                alert('\u767b\u5f55\u5931\u8d25\uff1a'+data.message)\n            }\n        })\n    }\n&lt;/script&gt;\n</code></pre> <p>\u63a5\u7740\u662f\u9996\u9875\uff0c\u83b7\u53d6\u4fe1\u606f\u7684\u65f6\u5019\u643a\u5e26\u4e0aJWT\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u4f9d\u8d56Cookie\u4e86\uff1a</p> <pre><code>&lt;script&gt;\n    axios.get('http://localhost:8081/api/user/name', {\n        headers: {\n            'Authorization': \"Bearer \"+sessionStorage.getItem(\"access_token\")\n        }\n    }).then(({data}) =&gt; {\n        document.getElementById('username').innerText = data.data\n    })\n&lt;/script&gt;\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u57fa\u4e8eSpringSecurity\u7684JWT\u6821\u9a8c\uff0c\u6574\u4e2a\u6d41\u7a0b\u8fd8\u662f\u975e\u5e38\u6e05\u6670\u7684\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#jwt_1","title":"\u9000\u51fa\u767b\u5f55JWT\u5904\u7406","text":"<p>\u867d\u7136\u6211\u4eec\u4f7f\u7528JWT\u5df2\u7ecf\u5f88\u65b9\u4fbf\u4e86\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u5f88\u4e25\u91cd\u7684\u95ee\u9898\u5c31\u662f\uff0c\u6211\u4eec\u6ca1\u529e\u6cd5\u50cfSession\u90a3\u6837\u53bb\u8e22\u7528\u6237\u4e0b\u7ebf\uff0c\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u6211\u4eec\u4e4b\u524d\u53ef\u4ee5\u4f7f\u7528\u9000\u51fa\u767b\u5f55\u63a5\u53e3\u76f4\u63a5\u9000\u51fa\uff0c\u7528\u6237Session\u4e2d\u7684\u9a8c\u8bc1\u4fe1\u606f\u4e5f\u4f1a\u88ab\u9500\u6bc1\uff0c\u4f46\u662f\u73b0\u5728\u662f\u65e0\u72b6\u6001\u7684\uff0c\u7528\u6237\u6765\u7ba1\u7406Token\u4ee4\u724c\uff0c\u670d\u52a1\u7aef\u53ea\u8ba4Token\u662f\u5426\u5408\u6cd5\uff0c\u90a3\u8fd9\u4e2a\u65f6\u5019\u8be5\u600e\u4e48\u8ba9\u7528\u6237\u6b63\u786e\u9000\u51fa\u767b\u5f55\u5462\uff1f</p> <p>\u9996\u5148\u6211\u4eec\u4ece\u6700\u7b80\u5355\u7684\u65b9\u6848\u5f00\u59cb\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8ba9\u5ba2\u6237\u7aef\u5220\u9664\u81ea\u5df1\u7684JWT\u4ee4\u724c\uff0c\u8fd9\u6837\u4e0d\u5c31\u76f8\u5f53\u4e8e\u9000\u51fa\u767b\u5f55\u4e86\u5417\uff0c\u8fd9\u6837\u751a\u81f3\u4e0d\u9700\u8981\u8bf7\u6c42\u670d\u52a1\u5668\uff0c\u76f4\u63a5\u5c31\u9000\u4e86\uff1a</p> <pre><code>&lt;script&gt;\n        ...\n\n    function logout() {\n        //\u76f4\u63a5\u5220\u9664\u5b58\u5728sessionStorage\u4e2d\u7684JWT\u4ee4\u724c\n        sessionStorage.removeItem(\"access_token\")\n        //\u7136\u540e\u56de\u5230\u767b\u5f55\u754c\u9762\n        window.location.href = '/login.html'\n    }\n&lt;/script&gt;\n</code></pre> <p>\u8fd9\u6837\u867d\u7136\u662f\u6700\u7b80\u5355\u7c97\u66b4\u7684\uff0c\u4f46\u662f\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u7528\u6237\u53ef\u4ee5\u81ea\u884c\u4fdd\u5b58\u8fd9\u4e2aToken\u62ff\u6765\u4f7f\u7528\u3002\u867d\u7136\u5ba2\u6237\u7aef\u5df2\u7ecf\u5220\u9664\u6389\u4e86\uff0c\u4f46\u662f\u8fd9\u4e2a\u4ee4\u724c\u4ecd\u7136\u662f\u53ef\u7528\u7684\uff0c\u5982\u679c\u7528\u6237\u79c1\u81ea\u4fdd\u5b58\u8fc7\uff0c\u90a3\u4e48\u4f9d\u7136\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\u8fd9\u4e2a\u4ee4\u724c\uff0c\u8fd9\u663e\u7136\u662f\u6709\u95ee\u9898\u7684\u3002</p> <p>\u76ee\u524d\u6709\u4e24\u79cd\u6bd4\u8f83\u597d\u7684\u65b9\u6848\uff1a</p> <ul> <li>\u9ed1\u540d\u5355\u65b9\u6848\uff1a\u6240\u6709\u9ed1\u540d\u5355\u4e2d\u7684JWT\u5c06\u4e0d\u53ef\u4f7f\u7528\u3002</li> <li>\u767d\u540d\u5355\u65b9\u6848\uff1a\u4e0d\u5728\u767d\u540d\u5355\u4e2d\u7684JWT\u5c06\u4e0d\u53ef\u4f7f\u7528\u3002</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u4ee5\u9ed1\u540d\u5355\u673a\u5236\u4e3a\u4f8b\uff0c\u8ba9\u7528\u6237\u9000\u51fa\u767b\u5f55\u4e4b\u540e\uff0c\u65e0\u6cd5\u518d\u6b21\u4f7f\u7528\u4e4b\u524d\u7684JWT\u8fdb\u884c\u64cd\u4f5c\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u7ed9JWT\u989d\u5916\u6dfb\u52a0\u4e00\u4e2a\u7528\u4e8e\u5224\u65ad\u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u8fd9\u91cc\u5c31\u7528UUID\u597d\u4e86\uff1a</p> <pre><code>public class JwtUtils {\n    private static final String key = \"abcdefghijklmn\";\n\n    public static String createJwt(UserDetails user){\n        Algorithm algorithm = Algorithm.HMAC256(key);\n        Calendar calendar = Calendar.getInstance();\n        Date now = calendar.getTime();\n        calendar.add(Calendar.SECOND, 3600 * 24 * 7);\n        return JWT.create()\n                    //\u989d\u5916\u6dfb\u52a0\u4e00\u4e2aUUID\u7528\u4e8e\u8bb0\u5f55\u9ed1\u540d\u5355\uff0c\u5c06\u5176\u4f5c\u4e3aJWT\u7684ID\u5c5e\u6027jti\n                    .withJWTId(UUID.randomUUID().toString())\n                .withClaim(\"name\", user.getUsername())\n                .withClaim(\"authorities\", user.getAuthorities().stream().map(GrantedAuthority::getAuthority).toList())\n                .withExpiresAt(calendar.getTime())\n                .withIssuedAt(now)\n                .sign(algorithm);\n    }\n\n        ...\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u53d1\u51fa\u53bb\u7684\u6240\u6709\u4ee4\u724c\u90fd\u4f1a\u643a\u5e26\u4e00\u4e2aUUID\u4f5c\u4e3a\u552f\u4e00\u51ed\u636e\uff0c\u63a5\u7740\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u4e13\u5c5e\u7684\u8868\u7528\u4e8e\u5b58\u50a8\u9ed1\u540d\u5355\uff1a</p> <pre><code>public class JwtUtils { \n\n  private static final HashSet&lt;String&gt; blackList = new HashSet&lt;&gt;();\n  //\u52a0\u5165\u9ed1\u540d\u5355\u65b9\u6cd5\n  public static boolean invalidate(String token){\n        Algorithm algorithm = Algorithm.HMAC256(key);\n        JWTVerifier jwtVerifier = JWT.require(algorithm).build();\n        try {\n            DecodedJWT verify = jwtVerifier.verify(token);\n            Map&lt;String, Claim&gt; claims = verify.getClaims();\n            //\u53d6\u51faUUID\u4e22\u8fdb\u9ed1\u540d\u5355\u4e2d\n            return blackList.add(verify.getId());\n        } catch (JWTVerificationException e) {\n            return false;\n        }\n  }\n\n  ...\n\n    public static UserDetails resolveJwt(String token){\n        Algorithm algorithm = Algorithm.HMAC256(key);\n        JWTVerifier jwtVerifier = JWT.require(algorithm).build();\n        try {\n            DecodedJWT verify = jwtVerifier.verify(token);\n            //\u5224\u65ad\u662f\u5426\u5b58\u5728\u4e8e\u9ed1\u540d\u5355\u4e2d\uff0c\u5982\u679c\u5b58\u5728\uff0c\u5219\u8fd4\u56denull\u8868\u793a\u5931\u6548\n            if(blackList.contains(verify.getId()))\n                return null;\n            Map&lt;String, Claim&gt; claims = verify.getClaims();\n            if(new Date().after(claims.get(\"exp\").asDate()))\n                return null;\n            return User\n                    .withUsername(claims.get(\"name\").asString())\n                    .password(\"\")\n                    .authorities(claims.get(\"authorities\").asArray(String.class))\n                    .build();\n        } catch (JWTVerificationException e) {\n            return null;\n        }\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765SecurityConfiguration\u4e2d\u914d\u7f6e\u4e00\u4e0b\u9000\u51fa\u767b\u5f55\u64cd\u4f5c\uff1a</p> <pre><code>private void onLogoutSuccess(HttpServletRequest request,\n                                 HttpServletResponse response,\n                                 Authentication authentication) throws IOException {\n        response.setContentType(\"application/json;charset=utf-8\");\n        PrintWriter writer = response.getWriter();\n        String authorization = request.getHeader(\"Authorization\");\n        if(authorization != null &amp;&amp; authorization.startsWith(\"Bearer \")) {\n            String token = authorization.substring(7);\n            //\u5c06Token\u52a0\u5165\u9ed1\u540d\u5355\n            if(JwtUtils.invalidate(token)) {\n                //\u53ea\u6709\u6210\u529f\u52a0\u5165\u9ed1\u540d\u5355\u624d\u4f1a\u9000\u51fa\u6210\u529f\n                writer.write(RestBean.success(\"\u9000\u51fa\u767b\u5f55\u6210\u529f\").asJsonString());\n                return;\n            }\n        }\n        writer.write(RestBean.failure(400, \"\u9000\u51fa\u767b\u5f55\u5931\u8d25\").asJsonString());\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u6210\u529f\u5b89\u6392\u4e0a\u4e86\u9ed1\u540d\u5355\u673a\u5236\uff0c\u5373\u4f7f\u7528\u6237\u63d0\u524d\u4fdd\u5b58\uff0c\u8fd9\u4e2aToken\u4f9d\u7136\u662f\u5931\u6548\u7684\uff1a</p> <p></p> <p>\u867d\u7136\u8fd9\u79cd\u9ed1\u540d\u5355\u673a\u5236\u5f88\u65b9\u4fbf\uff0c\u4f46\u662f\u5982\u679c\u5230\u4e86\u540e\u9762\u7684\u5fae\u670d\u52a1\u9636\u6bb5\uff0c\u53ef\u80fd\u591a\u4e2a\u670d\u52a1\u5668\u90fd\u9700\u8981\u5171\u4eab\u8fd9\u4e2a\u9ed1\u540d\u5355\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u518d\u5c06\u9ed1\u540d\u5355\u5b58\u50a8\u5728\u5355\u4e2a\u5e94\u7528\u4e2d\u5c31\u4e0d\u592a\u884c\u4e86\uff0c\u540e\u7eed\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4f7f\u7528Redis\u670d\u52a1\u5668\u6765\u5b58\u653e\u9ed1\u540d\u5355\u5217\u8868\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u591a\u4e2a\u670d\u52a1\u5668\u5171\u4eab\uff0c\u5e76\u4e14\u6839\u636eJWT\u7684\u8fc7\u671f\u65f6\u95f4\u5408\u7406\u8bbe\u5b9a\u9ed1\u540d\u5355\u4e2dUUID\u7684\u8fc7\u671f\u65f6\u95f4\uff0c\u81ea\u52a8\u6e05\u7406\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89%E5%89%8D%E5%90%8E%E7%AB%AF%E5%88%86%E7%A6%BB/#jwt_2","title":"\u81ea\u52a8\u7eed\u7b7eJWT\u4ee4\u724c","text":"<p>\u5728\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u5e0c\u671b\u7528\u6237\u80fd\u591f\u4e00\u76f4\u4f7f\u7528\u6211\u4eec\u7684\u7f51\u7ad9\uff0c\u800c\u4e0d\u662fJWT\u4ee4\u724c\u5230\u671f\u4e4b\u540e\u5c31\u9700\u8981\u91cd\u65b0\u767b\u5f55\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u524d\u7aef\u5c31\u53ef\u4ee5\u914d\u7f6eJWT\u81ea\u52a8\u7eed\u7b7e\uff0c\u5728\u53d1\u8d77\u8bf7\u6c42\u65f6\u5982\u679c\u4ee4\u724c\u5373\u5c06\u5230\u671f\uff0c\u90a3\u4e48\u5c31\u5411\u540e\u7aef\u53d1\u8d77\u7eed\u7b7e\u8bf7\u6c42\u5f97\u5230\u4e00\u4e2a\u65b0\u7684JWT\u4ee4\u724c\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5199\u4e00\u4e2a\u63a5\u53e3\u4e13\u95e8\u7528\u4e8e\u4ee4\u724c\u5237\u65b0\uff1a</p> <pre><code>@RestController\n@RequestMapping(\"/api/auth\")\npublic class AuthorizeController {\n\n    @GetMapping(\"/refresh\")\n    public RestBean&lt;String&gt; refreshToken(){\n        User user = (User) SecurityContextHolder.getContext().getAuthentication().getPrincipal();\n        String jwt = JwtUtils.createJwt(user);\n        return RestBean.success(jwt);\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u524d\u7aef\u5728\u53d1\u73b0\u4ee4\u724c\u53ef\u7528\u65f6\u95f4\u4e0d\u8db3\u65f6\uff0c\u5c31\u4f1a\u5148\u53d1\u8d77\u4e00\u4e2a\u8bf7\u6c42\u81ea\u52a8\u5b8c\u6210\u7eed\u671f\uff0c\u5f97\u5230\u4e00\u4e2a\u65b0\u7684Token\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u80fd\u8fd8\u9700\u8981\u914d\u7f6e\u4e00\u4e0b\u8fd9\u79cd\u65b9\u6848\u7684\u8bf7\u6c42\u9891\u7387\uff0c\u4e0d\u7136\u7528\u6237\u75af\u72c2\u8bf7\u6c42\u5237\u65b0Token\u5c31\u4e0d\u592a\u597d\u4e86\uff0c\u6211\u4eec\u540c\u6837\u53ef\u4ee5\u501f\u52a9Redis\u8fdb\u884c\u9650\u6d41\u7b49\u64cd\u4f5c\uff0c\u9632\u6b62\u9891\u7e41\u8bf7\u6c42\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8be6\u7ec6\u7f16\u5199\u4e86\uff0c\u5404\u4f4d\u5c0f\u4f19\u4f34\u53ef\u4ee5\u81ea\u884c\u5b9e\u73b0\u3002</p> <p>\u6211\u4eec\u6700\u540e\u53ef\u4ee5\u6765\u5bf9\u6bd4\u4e00\u4e0b\u4e24\u79cd\u524d\u540e\u7aef\u5206\u79bb\u65b9\u5f0f\u7684\u4f18\u7f3a\u70b9\u5982\u4f55\uff1a</p> <p>JWT\u6821\u9a8c\u65b9\u6848\u7684\u4f18\u70b9\uff1a</p> <ol> <li>\u65e0\u72b6\u6001: JWT\u662f\u65e0\u72b6\u6001\u7684\uff0c\u670d\u52a1\u5668\u4e0d\u9700\u8981\u5728\u540e\u7aef\u7ef4\u62a4\u7528\u6237\u7684\u4f1a\u8bdd\u4fe1\u606f\uff0c\u53ef\u4ee5\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u8fdb\u884c\u6c34\u5e73\u6269\u5c55\uff0c\u51cf\u8f7b\u670d\u52a1\u5668\u7684\u8d1f\u62c5\u3002</li> <li>\u57fa\u4e8eToken: JWT\u4f7f\u7528token\u4f5c\u4e3a\u8eab\u4efd\u8ba4\u8bc1\u4fe1\u606f\uff0c\u8be5token\u53ef\u4ee5\u5b58\u50a8\u7528\u6237\u76f8\u5173\u7684\u4fe1\u606f\u548c\u6743\u9650\u3002\u8fd9\u6837\u53ef\u4ee5\u51cf\u5c11\u4e0e\u6570\u636e\u5e93\u7684\u9891\u7e41\u4ea4\u4e92\uff0c\u63d0\u9ad8\u6027\u80fd\u3002</li> <li>\u5b89\u5168\u6027: JWT\u4f7f\u7528\u6570\u5b57\u7b7e\u540d\u6216\u52a0\u5bc6\u7b97\u6cd5\u4fdd\u8bc1token\u7684\u5b8c\u6574\u6027\u548c\u5b89\u5168\u6027\u3002\u6bcf\u6b21\u8bf7\u6c42\u90fd\u4f1a\u9a8c\u8bc1token\u7684\u5408\u6cd5\u6027\uff0c\u9632\u6b62\u4f2a\u9020\u6216\u7be1\u6539\u3002</li> <li>\u8de8\u57df\u652f\u6301: JWT\u53ef\u4ee5\u5728\u4e0d\u540c\u57df\u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u4f20\u8f93\uff0c\u9002\u5408\u524d\u540e\u7aef\u5206\u79bb\u7684\u67b6\u6784\u3002</li> </ol> <p>JWT\u6821\u9a8c\u65b9\u6848\u7684\u7f3a\u70b9\uff1a</p> <ol> <li>\u65e0\u6cd5\u505a\u5230\u5373\u65f6\u5931\u6548: JWT\u4e2d\u7684token\u901a\u5e38\u5177\u6709\u8f83\u957f\u7684\u6709\u6548\u671f\uff0c\u4e00\u65e6\u7b7e\u53d1\uff0c\u5c31\u65e0\u6cd5\u7acb\u5373\u5931\u6548\u3002\u5982\u679c\u9700\u8981\u5373\u65f6\u5931\u6548\uff0c\u9700\u8981\u5728\u670d\u52a1\u7aef\u8fdb\u884c\u989d\u5916\u7684\u5904\u7406\u3002</li> <li>\u4fe1\u606f\u65e0\u6cd5\u64a4\u9500: JWT\u4e2d\u7684token\u4e00\u65e6\u7b7e\u53d1\uff0c\u9664\u975e\u5230\u671f\u6216\u8005\u5ba2\u6237\u7aef\u6e05\u9664\uff0c\u65e0\u6cd5\u64a4\u9500\u3002\u65e0\u6cd5\u4e2d\u9014\u53d6\u6d88\u548c\u4fee\u6539\u6743\u9650\u3002</li> <li>Token\u589e\u5927\u7684\u95ee\u9898: JWT\u4e2d\u5305\u542b\u4e86\u7528\u6237\u4fe1\u606f\u548c\u6743\u9650\u7b49\uff0ctoken\u7684\u4f53\u79ef\u8f83\u5927\uff0c\u6bcf\u6b21\u8bf7\u6c42\u90fd\u9700\u8981\u643a\u5e26\uff0c\u589e\u52a0\u4e86\u7f51\u7edc\u4f20\u8f93\u7684\u5f00\u9500\u3002</li> <li>\u52a8\u6001\u6743\u9650\u7ba1\u7406\u95ee\u9898: JWT\u65e0\u6cd5\u5904\u7406\u52a8\u6001\u6743\u9650\u7ba1\u7406\uff0c\u4e00\u65e6\u7b7e\u53d1\u7684token\u6743\u9650\u53d1\u751f\u53d8\u5316\uff0c\u4ecd\u7136\u6709\u6548\uff0c\u9700\u8981\u5176\u4ed6\u624b\u6bb5\u8fdb\u884c\u5904\u7406\u3002</li> </ol> <p>\u4f20\u7edfSession\u6821\u9a8c\u65b9\u6848\u7684\u4f18\u70b9\uff1a</p> <ol> <li>\u5373\u65f6\u5931\u6548: Session\u5728\u670d\u52a1\u5668\u7aef\u7ba1\u7406\uff0c\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u8fc7\u671f\u65f6\u95f4\u6216\u624b\u52a8\u5220\u9664\u5b9e\u73b0\u5373\u65f6\u5931\u6548\uff0c\u4fdd\u62a4\u4f1a\u8bdd\u7684\u5b89\u5168\u6027\u3002</li> <li>\u4fe1\u606f\u5373\u65f6\u64a4\u9500: \u670d\u52a1\u5668\u7aef\u53ef\u4ee5\u968f\u65f6\u64a4\u9500\u6216\u4fee\u6539Session\u7684\u4fe1\u606f\u548c\u6743\u9650\u3002</li> <li>\u7075\u6d3b\u7684\u6743\u9650\u7ba1\u7406: Session\u65b9\u6848\u53ef\u4ee5\u66f4\u7075\u6d3b\u5730\u5904\u7406\u52a8\u6001\u6743\u9650\u7ba1\u7406\uff0c\u53ef\u4ee5\u6839\u636e\u5177\u4f53\u573a\u666f\u8fdb\u884c\u5373\u65f6\u8c03\u6574\u3002</li> </ol> <p>\u4f20\u7edfSession\u6821\u9a8c\u65b9\u6848\u7684\u7f3a\u70b9\uff1a</p> <ol> <li>\u72b6\u6001\u7ef4\u62a4: \u4f20\u7edfSession\u9700\u8981\u5728\u670d\u52a1\u5668\u7aef\u7ef4\u62a4\u4f1a\u8bdd\u72b6\u6001\u4fe1\u606f\uff0c\u589e\u52a0\u4e86\u670d\u52a1\u5668\u7684\u8d1f\u62c5\uff0c\u4e0d\u5229\u4e8e\u7cfb\u7edf\u7684\u6a2a\u5411\u6269\u5c55\u3002</li> <li>\u6027\u80fd\u5f00\u9500: \u6bcf\u6b21\u8bf7\u6c42\u90fd\u9700\u8981\u5728\u670d\u52a1\u5668\u7aef\u8fdb\u884c\u4f1a\u8bdd\u72b6\u6001\u7684\u6821\u9a8c\u548c\u8bfb\u5199\u64cd\u4f5c\uff0c\u589e\u52a0\u4e86\u6027\u80fd\u5f00\u9500\u3002</li> <li>\u8de8\u57df\u95ee\u9898: Session\u65b9\u6848\u5728\u8de8\u57df\u65f6\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0c\u9700\u8981\u8fdb\u884c\u989d\u5916\u7684\u5904\u7406\u3002</li> <li>\u65e0\u6cd5\u5206\u5e03\u5f0f\u5171\u4eab: \u4f20\u7edfSession\u65b9\u6848\u4e0d\u9002\u7528\u4e8e\u591a\u4e2a\u670d\u52a1\u5668\u4e4b\u95f4\u5171\u4eab\u4f1a\u8bdd\u4fe1\u606f\u7684\u573a\u666f\uff0c\u9700\u8981\u989d\u5916\u7684\u7ba1\u7406\u548c\u540c\u6b65\u673a\u5236\u3002</li> </ol> <p>\u7efc\u4e0a\u6240\u8ff0\uff0cJWT\u6821\u9a8c\u65b9\u6848\u9002\u7528\u4e8e\u65e0\u72b6\u6001\u3001\u5206\u5e03\u5f0f\u7cfb\u7edf\uff0c\u51e0\u4e4e\u6240\u6709\u5e38\u89c1\u7684\u524d\u540e\u7aef\u5206\u79bb\u7684\u67b6\u6784\u90fd\u53ef\u4ee5\u91c7\u7528\u8fd9\u79cd\u65b9\u6848\u3002\u800c\u4f20\u7edfSession\u6821\u9a8c\u65b9\u6848\u9002\u7528\u4e8e\u9700\u8981\u5373\u65f6\u5931\u6548\u3001\u5373\u65f6\u64a4\u9500\u548c\u7075\u6d3b\u6743\u9650\u7ba1\u7406\u7684\u573a\u666f\uff0c\u9002\u5408\u4f20\u7edf\u7684\u670d\u52a1\u5668\u7aef\u6e32\u67d3\u5e94\u7528\uff0c\u4ee5\u53ca\u5ba2\u6237\u7aef\u652f\u6301Cookie\u529f\u80fd\u7684\u524d\u540e\u7aef\u5206\u79bb\u67b6\u6784\u3002\u5728\u9009\u62e9\u6821\u9a8c\u65b9\u6848\u65f6\uff0c\u9700\u8981\u6839\u636e\u5177\u4f53\u7684\u4e1a\u52a1\u9700\u6c42\u548c\u6280\u672f\u573a\u666f\u8fdb\u884c\u9009\u62e9\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/","title":"SpringBoot\u7b14\u8bb0\uff08\u4e8c\uff09\u6570\u636e\u4ea4\u4e92","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#springboot","title":"\u6df1\u5165SpringBoot\u6570\u636e\u4ea4\u4e92","text":"<p>\u524d\u9762\u6211\u4eec\u4e86\u89e3\u4e86SpringBoot\u4ee5\u53ca\u4e00\u4e9b\u5e38\u7528\u7684\u6846\u67b6\u6574\u5408\uff0c\u76f8\u4fe1\u5404\u4f4d\u5c0f\u4f19\u4f34\u5df2\u7ecf\u4f53\u9a8c\u5230SpringBoot\u5e26\u6765\u7684\u8d85\u4fbf\u6377\u5f00\u53d1\u4f53\u9a8c\u4e86\u3002\u672c\u7ae0\u6211\u4eec\u5c06\u6df1\u5165\u8bb2\u89e3SpringBoot\u7684\u6570\u636e\u4ea4\u4e92\uff0c\u4f7f\u7528\u66f4\u591a\u65b9\u4fbf\u597d\u7528\u7684\u6301\u4e45\u5c42\u6846\u67b6\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#jdbc","title":"JDBC\u4ea4\u4e92\u6846\u67b6","text":"<p>\u9664\u4e86\u6211\u4eec\u524d\u9762\u4e00\u76f4\u8ba4\u8bc6\u7684Mybatis\u4e4b\u5916\uff0c\u5b9e\u9645\u4e0aSpring\u5b98\u65b9\u4e5f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u975e\u5e38\u65b9\u4fbf\u7684JDBC\u64cd\u4f5c\u5de5\u5177\uff0c\u5b83\u540c\u6837\u53ef\u4ee5\u5feb\u901f\u8fdb\u884c\u589e\u5220\u6539\u67e5\u3002\u9996\u5148\u6211\u4eec\u8fd8\u662f\u901a\u8fc7starter\u5c06\u4f9d\u8d56\u5bfc\u5165\uff1a</p> <pre><code>&lt;dependency&gt;\n   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n   &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u5bfc\u5165\u5b8c\u6210\u4e4b\u540e\u5c31\u53ef\u4ee5\u8f7b\u677e\u4f7f\u7528\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#jdbc_1","title":"JDBC\u6a21\u7248\u7c7b","text":"<p>Spring JDBC\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u4e00\u4e2a\u975e\u5e38\u65b9\u4fbf\u7684<code>JdbcTemplate</code>\u7c7b\uff0c\u5b83\u5c01\u88c5\u4e86\u5e38\u7528\u7684JDBC\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u5feb\u901f\u4f7f\u7528\u8fd9\u4e9b\u65b9\u6cd5\u6765\u5b9e\u73b0\u589e\u5220\u6539\u67e5\uff0c\u8fd9\u91cc\u6211\u4eec\u8fd8\u662f\u914d\u7f6e\u4e00\u4e0bMySQL\u6570\u636e\u6e90\u4fe1\u606f\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>spring:\n  datasource:\n    url: jdbc:mysql://localhost:3306/test\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.cj.jdbc.Driver\n</code></pre> <p>\u6211\u4eec\u8981\u64cd\u4f5c\u6570\u636e\u5e93\uff0c\u6700\u7b80\u5355\u76f4\u63a5\u7684\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528JdbcTemplate\u6765\u5b8c\u6210\uff1a</p> <pre><code>@Resource\nJdbcTemplate template;\n</code></pre> <p>\u5b83\u7ed9\u6211\u4eec\u5c01\u88c5\u4e86\u5f88\u591a\u65b9\u6cd5\u4f7f\u7528\uff0c\u6bd4\u5982\u6211\u4eec\u8981\u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u6761\u8bb0\u5f55\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>queryForMap</code>\u5feb\u901f\u4ee5Map\u4e3a\u7ed3\u679c\u7684\u5f62\u5f0f\u67e5\u8be2\u4e00\u884c\u6570\u636e\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    Map&lt;String, Object&gt; map = template.queryForMap(\"select * from user where id = ?\", 1);\n    System.out.println(map);\n}\n</code></pre> <p>\u975e\u5e38\u65b9\u4fbf\uff1a</p> <p></p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u7f16\u5199\u81ea\u5b9a\u4e49\u7684Mapper\u7528\u4e8e\u76f4\u63a5\u5f97\u5230\u67e5\u8be2\u7ed3\u679c\uff1a</p> <pre><code>@Data\n@AllArgsConstructor\npublic class User {\n    int id;\n    String name;\n    String email;\n    String password;\n}\n</code></pre> <pre><code>@Test\nvoid contextLoads() {\n    User user = template.queryForObject(\"select * from user where id = ?\",\n        (r, i) -&gt; new User(r.getInt(1), r.getString(2), r.getString(3), r.getString(4)), 1);\n    System.out.println(user);\n}\n</code></pre> <p>\u5f53\u7136\u9664\u4e86\u8fd9\u4e9b\u4e4b\u5916\uff0c\u5b83\u8fd8\u63d0\u4f9b\u4e86<code>update</code>\u65b9\u6cd5\u9002\u7528\u4e8e\u5404\u79cd\u60c5\u51b5\u7684\u67e5\u8be2\u3001\u66f4\u65b0\u3001\u5220\u9664\u64cd\u4f5c\uff1a</p> <pre><code> @Test\nvoid contextLoads() {\n    int update = template.update(\"insert into user values(2, 'admin', '654321@qq.com', '123456')\");\n    System.out.println(\"\u66f4\u65b0\u4e86 \"+update+\" \u884c\");\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u5982\u679c\u662f\u90a3\u79cd\u975e\u5e38\u5c0f\u578b\u7684\u9879\u76ee\uff0c\u751a\u81f3\u662f\u6d4b\u8bd5\u7528\u4f8b\u7684\u8bdd\uff0c\u90fd\u53ef\u4ee5\u5feb\u901f\u4f7f\u7528JdbcTemplate\u5feb\u901f\u8fdb\u884c\u5404\u79cd\u64cd\u4f5c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#jdbc_2","title":"JDBC\u7b80\u5355\u5c01\u88c5","text":"<p>\u5bf9\u4e8e\u4e00\u4e9b\u63d2\u5165\u64cd\u4f5c\uff0cSpring JDBC\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u66f4\u65b9\u4fbf\u7684SimpleJdbcInsert\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u5b9e\u73b0\u66f4\u591a\u9ad8\u7ea7\u7684\u63d2\u5165\u529f\u80fd\uff0c\u6bd4\u5982\u6211\u4eec\u7684\u8868\u4e3b\u952e\u91c7\u7528\u7684\u662f\u81ea\u589eID\uff0c\u90a3\u4e48\u5b83\u652f\u6301\u63d2\u5165\u540e\u8fd4\u56de\u81ea\u52a8\u751f\u6210\u7684ID\uff0c\u8fd9\u5c31\u975e\u5e38\u65b9\u4fbf\u4e86\uff1a</p> <pre><code>@Configuration\npublic class WebConfiguration {\n\n    @Resource\n    DataSource source;\n\n    @Test\n    void contextLoads() {\n        //\u8fd9\u4e2a\u7c7b\u9700\u8981\u81ea\u5df1\u521b\u5efa\u5bf9\u8c61\n        SimpleJdbcInsert simple = new SimpleJdbcInsert(source)\n                .withTableName(\"user\")   //\u8bbe\u7f6e\u8981\u64cd\u4f5c\u7684\u8868\u540d\u79f0\n                .usingGeneratedKeyColumns(\"id\");    //\u8bbe\u7f6e\u81ea\u589e\u4e3b\u952e\u5217\n        Map&lt;String, Object&gt; user = new HashMap&lt;&gt;(2);  //\u63d2\u5165\u64cd\u4f5c\u9700\u8981\u4f20\u5165\u4e00\u4e2aMap\u4f5c\u4e3a\u6570\u636e\n        user.put(\"name\", \"bob\");\n        user.put(\"email\", \"112233@qq.com\");\n        user.put(\"password\", \"123456\");\n        Number number = simple.executeAndReturnKey(user);   //\u6700\u540e\u5f97\u5230\u7684Numver\u5c31\u662f\u5f97\u5230\u7684\u81ea\u589e\u4e3b\u952e\n        System.out.println(number);\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u5feb\u901f\u8fdb\u884c\u63d2\u5165\u64cd\u4f5c\u5e76\u4e14\u8fd4\u56de\u81ea\u589e\u4e3b\u952e\u4e86\uff0c\u8fd8\u662f\u633a\u65b9\u4fbf\u7684\u3002</p> <p></p> <p>\u5f53\u7136\uff0c\u867d\u7136SpringJDBC\u7ed9\u6211\u4eec\u63d0\u4f9b\u4e86\u8fd9\u4e9b\u5c0f\u5de5\u5177\uff0c\u4f46\u662f\u5176\u5b9e\u53ea\u9002\u7528\u4e8e\u7b80\u5355\u5c0f\u9879\u76ee\uff0c\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\u5c31\u4e0d\u592a\u9002\u5408\u4e86\uff0c\u4e0b\u4e00\u90e8\u5206\u6211\u4eec\u5c06\u4ecb\u7ecdJPA\u6846\u67b6\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#jpa","title":"JPA\u6846\u67b6","text":"<ul> <li>\u7528\u4e86Mybatis\u4e4b\u540e\uff0c\u4f60\u770b\u90a3\u4e2aJDBC\uff0c\u771f\u662f\u592a\u900a\u4e86\u3002</li> <li>\u8fd9\u4e48\u8bf4\uff0c\u4f60\u7684\u9879\u76ee\u5f88\u52c7\u54e6\uff1f</li> <li>\u5f00\u73a9\u7b11\uff0c\u6211\u7684\u5199\u4ee3\u7801\u8d85\u52c7\u7684\u597d\u4e0d\u597d\u3002</li> <li>\u963f\u4f1f\uff0c\u4f60\u53ef\u66fe\u5e7b\u60f3\u8fc7\u6709\u4e00\u5929\u4f60\u7684\u9879\u76ee\u91cc\u4e0d\u518d\u6709SQL\u8bed\u53e5\uff1f</li> <li>\u4e0d\u518d\u6709SQL\u8bed\u53e5\uff1f\u90a3\u6211\u600e\u4e48\u548c\u6570\u636e\u5e93\u4ea4\u4e92\u554a\uff1f</li> <li>\u6211\u770b\u4f60\u662f\u5b8c\u5168\u4e0d\u61c2\u54e6</li> <li>\u61c2\uff0c\u61c2\u4ec0\u4e48\u554a\uff1f</li> <li>\u4f60\u60f3\u61c2\uff1f\u6765\uff0c\u5230\u6211\u9879\u76ee\u91cc\u6765\uff0c\u6211\u7ed9\u4f60\u770b\u70b9\u597d\u5eb7\u7684\u3002</li> <li>\u597d\u5eb7\uff1f\u662f\u4ec0\u4e48\u65b0\u6846\u67b6\u54e6\uff1f</li> <li>\u4ec0\u4e48\u65b0\u6846\u67b6\uff0c\u6bd4\u65b0\u6846\u67b6\u8fd8\u523a\u6fc0\uff0c\u8fd8\u53ef\u4ee5\u8ba9\u4f60\u7684\u9879\u76ee\u767bduang\u90ce\u54e6\u3002</li> <li>\u54c7\uff0c\u6770\u54e5\uff0c\u4f60\u9879\u76ee\u91cc\u9762\u90fd\u6ca1SQL\u8bed\u53e5\u8bf6\uff0c\u8fd9\u662f\u7528\u7684\u4ec0\u4e48\u6846\u67b6\u554a\uff1f</li> </ul> <p>\u200b       \u5728\u6211\u4eec\u4e4b\u524d\u7f16\u5199\u7684\u9879\u76ee\u4e2d\uff0c\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0a\u5927\u90e8\u5206\u7684\u6570\u636e\u5e93\u4ea4\u4e92\u64cd\u4f5c\uff0c\u5230\u6700\u540e\u90fd\u53ea\u4f1a\u505a\u4e00\u4e2a\u4e8b\u60c5\uff0c\u90a3\u5c31\u662f\u628a\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u6620\u5c04\u4e3aJava\u4e2d\u7684\u5bf9\u8c61\u3002\u6bd4\u5982\u6211\u4eec\u8981\u901a\u8fc7\u7528\u6237\u540d\u53bb\u67e5\u627e\u5bf9\u5e94\u7684\u7528\u6237\uff0c\u6216\u662f\u901a\u8fc7ID\u67e5\u627e\u5bf9\u5e94\u7684\u5b66\u751f\u4fe1\u606f\uff0c\u5728\u4f7f\u7528Mybatis\u65f6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7f16\u5199\u6b63\u786e\u7684SQL\u8bed\u53e5\u5c31\u53ef\u4ee5\u76f4\u63a5\u5c06\u83b7\u53d6\u7684\u6570\u636e\u6620\u5c04\u4e3a\u5bf9\u5e94\u7684Java\u5bf9\u8c61\uff0c\u901a\u8fc7\u8c03\u7528Mapper\u4e2d\u7684\u65b9\u6cd5\u5c31\u80fd\u76f4\u63a5\u83b7\u5f97\u5b9e\u4f53\u7c7b\uff0c\u8fd9\u6837\u5c31\u65b9\u4fbf\u6211\u4eec\u5728Java\u4e2d\u6570\u636e\u5e93\u8868\u4e2d\u7684\u76f8\u5173\u4fe1\u606f\u4e86\u3002</p> <p>\u200b       \u4f46\u662f\u4ee5\u4e0a\u8fd9\u4e9b\u64cd\u4f5c\u90fd\u6709\u4e00\u4e2a\u5171\u6027\uff0c\u90a3\u5c31\u662f\u5b83\u4eec\u90fd\u662f\u901a\u8fc7\u67d0\u79cd\u6761\u4ef6\u53bb\u8fdb\u884c\u67e5\u8be2\uff0c\u800c\u6700\u540e\u7684\u67e5\u8be2\u7ed3\u679c\uff0c\u90fd\u662f\u4e00\u4e2a\u5b9e\u4f53\u7c7b\uff0c\u6240\u4ee5\u4f60\u4f1a\u53d1\u73b0\u4f60\u5199\u7684\u5f88\u591aSQL\u8bed\u53e5\u90fd\u662f\u4e00\u4e2a\u5957\u8def<code>select * from xxx where xxx=xxx</code>\uff0c\u5b9e\u9645\u4e0a\u5bf9\u4e8e\u8fd9\u79cd\u7b80\u5355SQL\u8bed\u53e5\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u5f04\u6210\u4e00\u4e2a\u6a21\u7248\u6765\u4f7f\u7528\uff0c\u90a3\u4e48\u80fd\u5426\u6709\u4e00\u79cd\u6846\u67b6\uff0c\u5e2e\u6211\u4eec\u628a\u8fd9\u4e9b\u76f8\u540c\u7684\u5957\u8def\u7ed9\u5c01\u88c5\u8d77\u6765\uff0c\u76f4\u63a5\u628a\u8fd9\u7c7b\u76f8\u4f3c\u7684SQL\u8bed\u53e5\u7ed9\u5c4f\u853d\u6389\uff0c\u4e0d\u518d\u7531\u6211\u4eec\u7f16\u5199\uff0c\u800c\u662f\u8ba9\u6846\u67b6\u81ea\u5df1\u53bb\u7ec4\u5408\u62fc\u63a5\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#springdata-jpa","title":"\u8ba4\u8bc6SpringData JPA","text":"<p>\u9996\u5148\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u56fd\u5916\u7684\u7edf\u8ba1\uff1a</p> <p></p> <p>\u4e0d\u5bf9\u5427\uff0c\u4e3a\u4ec0\u4e48Mybatis\u8fd9\u4e48\u597d\u7528\uff0c\u8fd9\u4e48\u5f3a\u5927\uff0c\u5374\u53ea\u670910%\u7684\u4eba\u559c\u6b22\u5462\uff1f\u7136\u800c\u4e8b\u5b9e\u5c31\u662f\uff0c\u5728\u56fd\u5916JPA\u51e0\u4e4e\u5360\u636e\u4e86\u4e3b\u5bfc\u5730\u4f4d\uff0c\u800cMybatis\u5e76\u4e0d\u50cf\u56fd\u5185\u90a3\u6837\u53d7\u5f85\u89c1\uff0c\u6240\u4ee5\u4f60\u4f1a\u53d1\u73b0\uff0cJPA\u90fd\u6709SpringBoot\u7684\u5b98\u65b9\u76f4\u63a5\u63d0\u4f9b\u7684starter\uff0c\u800cMybatis\u6ca1\u6709\uff0c\u76f4\u5230SpringBoot 3\u624d\u5f00\u59cb\u52a0\u5165\u5230\u5b98\u65b9\u6a21\u7248\u4e2d\u3002</p> <p>\u90a3\u4e48\uff0c\u4ec0\u4e48\u662fJPA\uff1f</p> <p>JPA\uff08Java Persistence API\uff09\u548cJDBC\u7c7b\u4f3c\uff0c\u4e5f\u662f\u5b98\u65b9\u5b9a\u4e49\u7684\u4e00\u7ec4\u63a5\u53e3\uff0c\u4f46\u662f\u5b83\u76f8\u6bd4\u4f20\u7edf\u7684JDBC\uff0c\u5b83\u662f\u4e3a\u4e86\u5b9e\u73b0ORM\u800c\u751f\u7684\uff0c\u5373Object-Relationl Mapping\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u548c\u5bf9\u8c61\u4e4b\u95f4\u5f62\u6210\u4e00\u4e2a\u6620\u5c04\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5728\u5177\u4f53\u7684\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u9700\u8981\u518d\u53bb\u548c\u590d\u6742\u7684SQL\u8bed\u53e5\u6253\u4ea4\u9053\uff0c\u53ea\u8981\u50cf\u5e73\u65f6\u64cd\u4f5c\u5bf9\u8c61\u4e00\u6837\u64cd\u4f5c\u5b83\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u5176\u4e2d\u6bd4\u8f83\u5e38\u89c1\u7684JPA\u5b9e\u73b0\u6709\uff1a</p> <ol> <li>Hibernate\uff1aHibernate\u662fJPA\u89c4\u8303\u7684\u4e00\u4e2a\u5177\u4f53\u5b9e\u73b0\uff0c\u4e5f\u662f\u76ee\u524d\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684JPA\u5b9e\u73b0\u6846\u67b6\u4e4b\u4e00\u3002\u5b83\u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u5bf9\u8c61\u5173\u7cfb\u6620\u5c04\u529f\u80fd\uff0c\u53ef\u4ee5\u5c06Java\u5bf9\u8c61\u6620\u5c04\u5230\u6570\u636e\u5e93\u8868\u4e2d\uff0c\u5e76\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u67e5\u8be2\u8bed\u8a00\u548c\u7f13\u5b58\u673a\u5236\u3002</li> <li>EclipseLink\uff1aEclipseLink\u662f\u53e6\u4e00\u4e2a\u6d41\u884c\u7684JPA\u5b9e\u73b0\u6846\u67b6\uff0c\u7531Eclipse\u57fa\u91d1\u4f1a\u5f00\u53d1\u548c\u7ef4\u62a4\u3002\u5b83\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684\u7279\u6027\uff0c\u5982\u5bf9\u8c61\u5173\u7cfb\u6620\u5c04\u3001\u7f13\u5b58\u3001\u67e5\u8be2\u8bed\u8a00\u548c\u8fde\u63a5\u6c60\u7ba1\u7406\u7b49\uff0c\u5e76\u5177\u6709\u8f83\u9ad8\u7684\u6027\u80fd\u548c\u53ef\u6269\u5c55\u6027\u3002</li> <li>OpenJPA\uff1aOpenJPA\u662fApache\u57fa\u91d1\u4f1a\u7684\u4e00\u4e2a\u5f00\u6e90\u9879\u76ee\uff0c\u4e5f\u662fJPA\u89c4\u8303\u7684\u4e00\u4e2a\u5b9e\u73b0\u3002\u5b83\u63d0\u4f9b\u4e86\u9ad8\u6027\u80fd\u7684JPA\u5b9e\u73b0\u548c\u4e30\u5bcc\u7684\u7279\u6027\uff0c\u5982\u5ef6\u8fdf\u52a0\u8f7d\u3001\u7f13\u5b58\u548c\u5206\u5e03\u5f0f\u4e8b\u52a1\u7b49\u3002</li> <li>TopLink\uff1aTopLink\u662fOracle\u516c\u53f8\u5f00\u53d1\u7684\u4e00\u4e2a\u5bf9\u8c61\u5173\u7cfb\u6620\u5c04\u6846\u67b6\uff0c\u4e5f\u662fJPA\u89c4\u8303\u7684\u4e00\u4e2a\u5b9e\u73b0\u3002\u867d\u7136EclipseLink\u5df2\u7ecf\u53d6\u4ee3\u4e86TopLink\u6210\u4e3aOracle\u63a8\u8350\u7684JPA\u5b9e\u73b0\uff0c\u4f46TopLink\u4ecd\u7136\u5f97\u5230\u5e7f\u6cdb\u4f7f\u7528\u3002</li> </ol> <p>\u5728\u4e4b\u524d\uff0c\u6211\u4eec\u4f7f\u7528JDBC\u6216\u662fMybatis\u6765\u64cd\u4f5c\u6570\u636e\uff0c\u901a\u8fc7\u76f4\u63a5\u7f16\u5199\u5bf9\u5e94\u7684SQL\u8bed\u53e5\u6765\u5b9e\u73b0\u6570\u636e\u8bbf\u95ee\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u5b9e\u9645\u4e0a\u6211\u4eec\u5728Java\u4e2d\u5927\u90e8\u5206\u64cd\u4f5c\u6570\u636e\u5e93\u7684\u60c5\u51b5\u90fd\u662f\u8bfb\u53d6\u6570\u636e\u5e76\u5c01\u88c5\u4e3a\u4e00\u4e2a\u5b9e\u4f53\u7c7b\uff0c\u56e0\u6b64\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u76f4\u63a5\u5c06\u5b9e\u4f53\u7c7b\u76f4\u63a5\u5bf9\u5e94\u5230\u4e00\u4e2a\u6570\u636e\u5e93\u8868\u5462\uff1f\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u5f20\u8868\u91cc\u9762\u6709\u4ec0\u4e48\u5c5e\u6027\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u5bf9\u8c61\u5c31\u6709\u4ec0\u4e48\u5c5e\u6027\uff0c\u6240\u6709\u5c5e\u6027\u8ddf\u6570\u636e\u5e93\u91cc\u9762\u7684\u5b57\u6bb5\u4e00\u4e00\u5bf9\u5e94\uff0c\u800c\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u53ea\u9700\u8981\u8bfb\u53d6\u4e00\u884c\u7684\u6570\u636e\u5e76\u5c01\u88c5\u4e3a\u6211\u4eec\u5b9a\u4e49\u597d\u7684\u5b9e\u4f53\u7c7b\u65e2\u53ef\u4ee5\uff0c\u800c\u5177\u4f53\u7684SQL\u8bed\u53e5\u6267\u884c\uff0c\u5b8c\u5168\u53ef\u4ee5\u4ea4\u7ed9\u6846\u67b6\u6839\u636e\u6211\u4eec\u5b9a\u4e49\u7684\u6620\u5c04\u5173\u7cfb\u53bb\u751f\u6210\uff0c\u4e0d\u518d\u7531\u6211\u4eec\u53bb\u7f16\u5199\uff0c\u56e0\u4e3a\u8fd9\u4e9bSQL\u5b9e\u9645\u4e0a\u90fd\u662f\u5343\u7bc7\u4e00\u5f8b\u7684\u3002</p> <p>\u800c\u5b9e\u73b0JPA\u89c4\u8303\u7684\u6846\u67b6\u4e00\u822c\u6700\u5e38\u7528\u7684\u5c31\u662f<code>Hibernate</code>\uff0c\u5b83\u662f\u4e00\u4e2a\u91cd\u91cf\u7ea7\u6846\u67b6\uff0c\u5b66\u4e60\u96be\u5ea6\u76f8\u6bd4Mybatis\u4e5f\u66f4\u9ad8\u4e00\u4e9b\uff0c\u800cSpringDataJPA\u4e5f\u662f\u91c7\u7528Hibernate\u6846\u67b6\u4f5c\u4e3a\u5e95\u5c42\u5b9e\u73b0\uff0c\u5e76\u5bf9\u5176\u52a0\u4ee5\u5c01\u88c5\u3002</p> <p>\u5b98\u7f51\uff1ahttps://spring.io/projects/spring-data-jpa</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#jpa_1","title":"\u4f7f\u7528JPA\u5feb\u901f\u4e0a\u624b","text":"<p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bfc\u5165stater\u4f9d\u8d56\u5373\u53ef\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u7c7b\uff0c\u6bd4\u5982\u7528\u6237\u7c7b\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u4e00\u4e2a\u8d26\u53f7\u5bf9\u5e94\u7684\u5c5e\u6027\u5168\u90e8\u5b9a\u4e49\u597d\u5373\u53ef\uff1a</p> <pre><code>@Data\npublic class Account {\n    int id;\n    String username;\n    String password;\n}\n</code></pre> <p>\u63a5\u7740\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6ce8\u89e3\u5f62\u5f0f\uff0c\u5728\u5c5e\u6027\u4e0a\u6dfb\u52a0\u6570\u636e\u5e93\u6620\u5c04\u5173\u7cfb\uff0c\u8fd9\u6837\u5c31\u80fd\u591f\u8ba9JPA\u77e5\u9053\u6211\u4eec\u7684\u5b9e\u4f53\u7c7b\u5bf9\u5e94\u7684\u6570\u636e\u5e93\u8868\u957f\u5565\u6837\uff0c\u8fd9\u91cc\u7528\u5230\u4e86\u5f88\u591a\u6ce8\u89e3\uff1a</p> <pre><code>@Data\n@Entity   //\u8868\u793a\u8fd9\u4e2a\u7c7b\u662f\u4e00\u4e2a\u5b9e\u4f53\u7c7b\n@Table(name = \"account\")    //\u5bf9\u5e94\u7684\u6570\u636e\u5e93\u4e2d\u8868\u540d\u79f0\npublic class Account {\n\n    @GeneratedValue(strategy = GenerationType.IDENTITY)   //\u751f\u6210\u7b56\u7565\uff0c\u8fd9\u91cc\u914d\u7f6e\u4e3a\u81ea\u589e\n    @Column(name = \"id\")    //\u5bf9\u5e94\u8868\u4e2did\u8fd9\u4e00\u5217\n    @Id     //\u6b64\u5c5e\u6027\u4e3a\u4e3b\u952e\n    int id;\n\n    @Column(name = \"username\")   //\u5bf9\u5e94\u8868\u4e2dusername\u8fd9\u4e00\u5217\n    String username;\n\n    @Column(name = \"password\")   //\u5bf9\u5e94\u8868\u4e2dpassword\u8fd9\u4e00\u5217\n    String password;\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u4fee\u6539\u4e00\u4e0b\u914d\u7f6e\u6587\u4ef6\uff0c\u628a\u65e5\u5fd7\u6253\u5370\u7ed9\u6253\u5f00\uff1a</p> <pre><code>spring:\n  jpa:\n    #\u5f00\u542fSQL\u8bed\u53e5\u6267\u884c\u65e5\u5fd7\u4fe1\u606f\n    show-sql: true\n    hibernate:\n      #\u914d\u7f6e\u4e3a\u68c0\u67e5\u6570\u636e\u5e93\u8868\u7ed3\u6784\uff0c\u6ca1\u6709\u65f6\u4f1a\u81ea\u52a8\u521b\u5efa\n      ddl-auto: update\n</code></pre> <p><code>ddl-auto</code>\u5c5e\u6027\u7528\u4e8e\u8bbe\u7f6e\u81ea\u52a8\u8868\u5b9a\u4e49\uff0c\u53ef\u4ee5\u5b9e\u73b0\u81ea\u52a8\u5728\u6570\u636e\u5e93\u4e2d\u4e3a\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u8868\uff0c\u8868\u7684\u7ed3\u6784\u4f1a\u6839\u636e\u6211\u4eec\u5b9a\u4e49\u7684\u5b9e\u4f53\u7c7b\u51b3\u5b9a\uff0c\u5b83\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a</p> <ul> <li><code>none</code>: \u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\uff0c\u6570\u636e\u5e93\u8868\u7ed3\u6784\u9700\u8981\u624b\u52a8\u521b\u5efa\u3002</li> <li><code>create</code>: \u6846\u67b6\u5728\u6bcf\u6b21\u8fd0\u884c\u65f6\u90fd\u4f1a\u5220\u9664\u6240\u6709\u8868\uff0c\u5e76\u91cd\u65b0\u521b\u5efa\u3002</li> <li><code>create-drop</code>: \u6846\u67b6\u5728\u6bcf\u6b21\u8fd0\u884c\u65f6\u90fd\u4f1a\u5220\u9664\u6240\u6709\u8868\uff0c\u7136\u540e\u518d\u521b\u5efa\uff0c\u4f46\u5728\u7a0b\u5e8f\u7ed3\u675f\u65f6\u4f1a\u518d\u6b21\u5220\u9664\u6240\u6709\u8868\u3002</li> <li><code>update</code>: \u6846\u67b6\u4f1a\u68c0\u67e5\u6570\u636e\u5e93\u8868\u7ed3\u6784\uff0c\u5982\u679c\u4e0e\u5b9e\u4f53\u7c7b\u5b9a\u4e49\u4e0d\u5339\u914d\uff0c\u5219\u4f1a\u505a\u76f8\u5e94\u7684\u4fee\u6539\uff0c\u4ee5\u4fdd\u6301\u5b83\u4eec\u7684\u4e00\u81f4\u6027\u3002</li> <li><code>validate</code>: \u6846\u67b6\u4f1a\u68c0\u67e5\u6570\u636e\u5e93\u8868\u7ed3\u6784\u4e0e\u5b9e\u4f53\u7c7b\u5b9a\u4e49\u662f\u5426\u5339\u914d\uff0c\u5982\u679c\u4e0d\u5339\u914d\uff0c\u5219\u4f1a\u629b\u51fa\u5f02\u5e38\u3002</li> </ul> <p>\u8fd9\u4e2a\u914d\u7f6e\u9879\u7684\u4f5c\u7528\u662f\u4e3a\u4e86\u907f\u514d\u624b\u52a8\u7ba1\u7406\u6570\u636e\u5e93\u8868\u7ed3\u6784\uff0c\u4f7f\u5f00\u53d1\u8005\u53ef\u4ee5\u66f4\u65b9\u4fbf\u5730\u8fdb\u884c\u5f00\u53d1\u548c\u6d4b\u8bd5\uff0c\u4f46\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u66f4\u63a8\u8350\u4f7f\u7528\u6570\u636e\u5e93\u8fc1\u79fb\u5de5\u5177\u6765\u7ba1\u7406\u8868\u7ed3\u6784\u7684\u53d8\u66f4\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5728\u65e5\u5fd7\u4e2d\u53d1\u73b0\uff0c\u5728\u542f\u52a8\u65f6\u6267\u884c\u4e86\u5982\u4e0bSQL\u8bed\u53e5\uff1a</p> <p></p> <p>\u6211\u4eec\u7684\u6570\u636e\u5e93\u4e2d\u5bf9\u5e94\u7684\u8868\u5df2\u7ecf\u81ea\u52a8\u521b\u5efa\u597d\u4e86\u3002</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u5982\u4f55\u8bbf\u95ee\u6211\u4eec\u7684\u8868\uff0c\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2aRepository\u5b9e\u73b0\u7c7b\uff1a</p> <pre><code>@Repository\npublic interface AccountRepository extends JpaRepository&lt;Account, Integer&gt; {\n}\n</code></pre> <p>\u6ce8\u610fJpaRepository\u6709\u4e24\u4e2a\u6cdb\u578b\uff0c\u524d\u8005\u662f\u5177\u4f53\u64cd\u4f5c\u7684\u5bf9\u8c61\u5b9e\u4f53\uff0c\u4e5f\u5c31\u662f\u5bf9\u5e94\u7684\u8868\uff0c\u540e\u8005\u662fID\u7684\u7c7b\u578b\uff0c\u63a5\u53e3\u4e2d\u5df2\u7ecf\u5b9a\u4e49\u4e86\u6bd4\u8f83\u5e38\u7528\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002\u7f16\u5199\u63a5\u53e3\u7ee7\u627f\u5373\u53ef\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6ce8\u5165\u6b64\u63a5\u53e3\u83b7\u5f97\u5b9e\u73b0\u7c7b\uff1a</p> <pre><code>@Resource\nAccountRepository repository;\n\n@Test\nvoid contextLoads() {\n    Account account = new Account();\n    account.setUsername(\"\u5c0f\u7ea2\");\n    account.setPassword(\"1234567\");\n    System.out.println(repository.save(account).getId());   //\u4f7f\u7528save\u6765\u5feb\u901f\u63d2\u5165\u6570\u636e\uff0c\u5e76\u4e14\u4f1a\u8fd4\u56de\u63d2\u5165\u7684\u5bf9\u8c61\uff0c\u5982\u679c\u5b58\u5728\u81ea\u589eID\uff0c\u5bf9\u8c61\u7684\u81ea\u589eid\u5c5e\u6027\u4f1a\u81ea\u52a8\u88ab\u8d4b\u503c\uff0c\u8fd9\u5c31\u5f88\u65b9\u4fbf\u4e86\n}\n</code></pre> <p>\u6267\u884c\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u540c\u65f6\uff0c\u67e5\u8be2\u64cd\u4f5c\u4e5f\u5f88\u65b9\u4fbf\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    //\u9ed8\u8ba4\u901a\u8fc7\u901a\u8fc7ID\u67e5\u627e\u7684\u65b9\u6cd5\uff0c\u5e76\u4e14\u8fd4\u56de\u7684\u7ed3\u679c\u662fOptional\u5305\u88c5\u7684\u5bf9\u8c61\uff0c\u975e\u5e38\u4eba\u6027\u5316\n    repository.findById(1).ifPresent(System.out::println);\n}\n</code></pre> <p>\u5f97\u5230\u7ed3\u679c\u4e3a\uff1a</p> <p></p> <p>\u5305\u62ec\u5e38\u89c1\u7684\u4e00\u4e9b\u8ba1\u6570\u3001\u5220\u9664\u64cd\u4f5c\u7b49\u90fd\u5305\u542b\u5728\u91cc\u9762\uff0c\u4ec5\u4ec5\u914d\u7f6e\u5e94\u8be5\u63a5\u53e3\u5c31\u80fd\u5b8c\u7f8e\u5b9e\u73b0\u589e\u5220\u6539\u67e5\uff1a</p> <p></p> <p>\u6211\u4eec\u53d1\u73b0\uff0c\u4f7f\u7528\u4e86JPA\u4e4b\u540e\uff0c\u6574\u4e2a\u9879\u76ee\u7684\u4ee3\u7801\u4e2d\u6ca1\u6709\u51fa\u73b0\u4efb\u4f55\u7684SQL\u8bed\u53e5\uff0c\u53ef\u4ee5\u8bf4\u662f\u975e\u5e38\u65b9\u4fbf\u4e86\uff0cJPA\u4f9d\u9760\u6211\u4eec\u63d0\u4f9b\u7684\u6ce8\u89e3\u4fe1\u606f\u81ea\u52a8\u5b8c\u6210\u4e86\u6240\u6709\u4fe1\u606f\u7684\u6620\u5c04\u548c\u5173\u8054\u3002</p> <p>\u76f8\u6bd4Mybatis\uff0cJPA\u51e0\u4e4e\u5c31\u662f\u4e00\u4e2a\u5168\u81ea\u52a8\u7684ORM\u6846\u67b6\uff0c\u800cMybatis\u5219\u9876\u591a\u7b97\u662f\u534a\u81ea\u52a8ORM\u6846\u67b6\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#sql","title":"\u65b9\u6cd5\u540d\u79f0\u62fc\u63a5\u81ea\u5b9a\u4e49SQL","text":"<p>\u867d\u7136\u63a5\u53e3\u9884\u7f6e\u7684\u65b9\u6cd5\u4f7f\u7528\u8d77\u6765\u975e\u5e38\u65b9\u4fbf\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u9700\u8981\u8fdb\u884c\u6761\u4ef6\u67e5\u8be2\u7b49\u64cd\u4f5c\u6216\u662f\u4e00\u4e9b\u5224\u65ad\uff0c\u5c31\u9700\u8981\u81ea\u5b9a\u4e49\u4e00\u4e9b\u65b9\u6cd5\u6765\u5b9e\u73b0\uff0c\u540c\u6837\u7684\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u7f16\u5199SQL\u8bed\u53e5\uff0c\u800c\u662f\u901a\u8fc7\u65b9\u6cd5\u540d\u79f0\u7684\u62fc\u63a5\u6765\u5b9e\u73b0\u6761\u4ef6\u5224\u65ad\uff0c\u8fd9\u91cc\u5217\u51fa\u4e86\u6240\u6709\u652f\u6301\u7684\u6761\u4ef6\u5224\u65ad\u540d\u79f0\uff1a</p> \u5c5e\u6027 \u62fc\u63a5\u65b9\u6cd5\u540d\u79f0\u793a\u4f8b \u6267\u884c\u7684\u8bed\u53e5 Distinct findDistinctByLastnameAndFirstname select distinct \u2026 where x.lastname = ?1 and x.firstname = ?2 And findByLastnameAndFirstname \u2026 where x.lastname = ?1 and x.firstname = ?2 Or findByLastnameOrFirstname \u2026 where x.lastname = ?1 or x.firstname = ?2 Is\uff0cEquals findByFirstname<code>,</code>findByFirstnameIs<code>,</code>findByFirstnameEquals \u2026 where x.firstname = ?1 Between findByStartDateBetween \u2026 where x.startDate between ?1 and ?2 LessThan findByAgeLessThan \u2026 where x.age &lt; ?1 LessThanEqual findByAgeLessThanEqual \u2026 where x.age &lt;= ?1 GreaterThan findByAgeGreaterThan \u2026 where x.age &gt; ?1 GreaterThanEqual findByAgeGreaterThanEqual \u2026 where x.age &gt;= ?1 After findByStartDateAfter \u2026 where x.startDate &gt; ?1 Before findByStartDateBefore \u2026 where x.startDate &lt; ?1 IsNull\uff0cNull findByAge(Is)Null \u2026 where x.age is null IsNotNull\uff0cNotNull findByAge(Is)NotNull \u2026 where x.age not null Like findByFirstnameLike \u2026 where x.firstname like ?1 NotLike findByFirstnameNotLike \u2026 where x.firstname not like ?1 StartingWith findByFirstnameStartingWith \u2026 where x.firstname like ?1\uff08\u53c2\u6570\u4e0e\u9644\u52a0<code>%</code>\u7ed1\u5b9a\uff09 EndingWith findByFirstnameEndingWith \u2026 where x.firstname like ?1\uff08\u53c2\u6570\u4e0e\u524d\u7f00<code>%</code>\u7ed1\u5b9a\uff09 Containing findByFirstnameContaining \u2026 where x.firstname like ?1\uff08\u53c2\u6570\u7ed1\u5b9a\u4ee5<code>%</code>\u5305\u88c5\uff09 OrderBy findByAgeOrderByLastnameDesc \u2026 where x.age = ?1 order by x.lastname desc Not findByLastnameNot \u2026 where x.lastname &lt;&gt; ?1 In findByAgeIn(Collection ages) \u2026 where x.age in ?1 NotIn findByAgeNotIn(Collection ages) \u2026 where x.age not in ?1 True findByActiveTrue \u2026 where x.active = true False findByActiveFalse \u2026 where x.active = false IgnoreCase findByFirstnameIgnoreCase \u2026 where UPPER(x.firstname) = UPPER(?1) <p>\u6bd4\u5982\u6211\u4eec\u60f3\u8981\u5b9e\u73b0\u6839\u636e\u7528\u6237\u540d\u6a21\u7cca\u5339\u914d\u67e5\u627e\u7528\u6237\uff1a</p> <pre><code>@Repository\npublic interface AccountRepository extends JpaRepository&lt;Account, Integer&gt; {\n    //\u6309\u7167\u8868\u4e2d\u7684\u89c4\u5219\u8fdb\u884c\u540d\u79f0\u62fc\u63a5\uff0c\u4e0d\u7528\u523b\u610f\u53bb\u8bb0\uff0cIDEA\u4f1a\u6709\u63d0\u793a\n    List&lt;Account&gt; findAllByUsernameLike(String str);\n}\n</code></pre> <p>\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    repository.findAllByUsernameLike(\"%\u660e%\").forEach(System.out::println);\n}\n</code></pre> <p></p> <p>\u53c8\u6bd4\u5982\u6211\u4eec\u60f3\u540c\u65f6\u6839\u636e\u7528\u6237\u540d\u548cID\u4e00\u8d77\u67e5\u8be2\uff1a</p> <pre><code>@Repository\npublic interface AccountRepository extends JpaRepository&lt;Account, Integer&gt; {\n    List&lt;Account&gt; findAllByUsernameLike(String str);\n\n    Account findByIdAndUsername(int id, String username);\n    //\u4e5f\u53ef\u4ee5\u4f7f\u7528Optional\u7c7b\u8fdb\u884c\u5305\u88c5\uff0cOptional&lt;Account&gt; findByIdAndUsername(int id, String username);\n}\n</code></pre> <pre><code>@Test\nvoid contextLoads() {\n    System.out.println(repository.findByIdAndUsername(1, \"\u5c0f\u660e\"));\n}\n</code></pre> <p>\u6bd4\u5982\u6211\u4eec\u60f3\u5224\u65ad\u6570\u636e\u5e93\u4e2d\u662f\u5426\u5b58\u5728\u67d0\u4e2aID\u7684\u7528\u6237\uff1a</p> <pre><code>@Repository\npublic interface AccountRepository extends JpaRepository&lt;Account, Integer&gt; {\n    List&lt;Account&gt; findAllByUsernameLike(String str);\n    Account findByIdAndUsername(int id, String username);\n    //\u4f7f\u7528exists\u5224\u65ad\u662f\u5426\u5b58\u5728\n    boolean existsAccountById(int id);\n}\n</code></pre> <p>\u6ce8\u610f\u81ea\u5b9a\u4e49\u6761\u4ef6\u64cd\u4f5c\u7684\u65b9\u6cd5\u540d\u79f0\u4e00\u5b9a\u8981\u9075\u5faa\u89c4\u5219\uff0c\u4e0d\u7136\u4f1a\u51fa\u73b0\u5f02\u5e38\uff1a</p> <pre><code>Caused by: org.springframework.data.repository.query.QueryCreationException: Could not create query for public abstract  ...\n</code></pre> <p>\u6709\u4e86\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u6211\u4eec\u5728\u7f16\u5199\u4e00\u4e9b\u7b80\u5355SQL\u7684\u65f6\u5019\u5c31\u5f88\u65b9\u4fbf\u4e86\uff0c\u7528\u4e45\u4e86\u751a\u81f3\u76f4\u63a5\u5fd8\u8bb0SQL\u600e\u4e48\u5199\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#_1","title":"\u5173\u8054\u67e5\u8be2","text":"<p>\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u6bd4\u8f83\u5e38\u89c1\u7684\u573a\u666f\u8fd8\u6709\u5173\u8054\u67e5\u8be2\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u4f1a\u5728\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5916\u952e\u5b57\u6bb5\uff0c\u800c\u6b64\u5916\u952e\u5b57\u6bb5\u53c8\u6307\u5411\u4e86\u53e6\u4e00\u4e2a\u8868\u4e2d\u7684\u6570\u636e\uff0c\u5f53\u6211\u4eec\u67e5\u8be2\u6570\u636e\u65f6\uff0c\u53ef\u80fd\u4f1a\u9700\u8981\u5c06\u5173\u8054\u6570\u636e\u4e5f\u4e00\u5e76\u83b7\u53d6\uff0c\u6bd4\u5982\u6211\u4eec\u60f3\u8981\u67e5\u8be2\u67d0\u4e2a\u7528\u6237\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4e00\u822c\u7528\u6237\u7b80\u7565\u4fe1\u606f\u4f1a\u5355\u72ec\u5b58\u653e\u4e00\u4e2a\u8868\uff0c\u800c\u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u4f1a\u5355\u72ec\u5b58\u653e\u5728\u53e6\u4e00\u4e2a\u8868\u4e2d\u3002\u5f53\u7136\uff0c\u9664\u4e86\u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u4e4b\u5916\uff0c\u53ef\u80fd\u5728\u67d0\u4e9b\u7535\u5546\u5e73\u53f0\u8fd8\u4f1a\u6709\u7528\u6237\u7684\u8d2d\u4e70\u8bb0\u5f55\u3001\u7528\u6237\u7684\u8d2d\u7269\u8f66\uff0c\u4ea4\u6d41\u793e\u533a\u4e2d\u7684\u7528\u6237\u5e16\u5b50\u3001\u7528\u6237\u8bc4\u8bba\u7b49\uff0c\u8fd9\u4e9b\u90fd\u662f\u9700\u8981\u6839\u636e\u7528\u6237\u4fe1\u606f\u8fdb\u884c\u5173\u8054\u67e5\u8be2\u7684\u5185\u5bb9\u3002</p> <p></p> <p>\u6211\u4eec\u77e5\u9053\uff0c\u5728JPA\u4e2d\uff0c\u6bcf\u5f20\u8868\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u7684\u6620\u5c04\uff0c\u800c\u8868\u4e4b\u95f4\u7684\u5173\u8054\u5173\u7cfb\uff0c\u4e5f\u53ef\u4ee5\u770b\u4f5c\u5bf9\u8c61\u4e4b\u95f4\u7684\u4f9d\u8d56\u5173\u7cfb\uff0c\u6bd4\u5982\u7528\u6237\u8868\u4e2d\u5305\u542b\u4e86\u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u7684ID\u5b57\u6bb5\u4f5c\u4e3a\u5916\u952e\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u5c31\u662f\u7528\u6237\u8868\u5b9e\u4f53\u4e2d\u5305\u62ec\u4e86\u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u5b9e\u4f53\u5bf9\u8c61\uff1a</p> <pre><code>@Data\n@Entity\n@Table(name = \"users_detail\")\npublic class AccountDetail {\n\n    @Column(name = \"id\")\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Id\n    int id;\n\n    @Column(name = \"address\")\n    String address;\n\n    @Column(name = \"email\")\n    String email;\n\n    @Column(name = \"phone\")\n    String phone;\n\n    @Column(name = \"real_name\")\n    String realName;\n}\n</code></pre> <p>\u800c\u7528\u6237\u4fe1\u606f\u548c\u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u4e4b\u95f4\u5f62\u6210\u4e86\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb\uff0c\u90a3\u4e48\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u5728\u7c7b\u4e2d\u6307\u5b9a\u8fd9\u79cd\u5173\u7cfb\uff1a</p> <pre><code>@Data\n@Entity\n@Table(name = \"users\")\npublic class Account {\n\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name = \"id\")\n    @Id\n    int id;\n\n    @Column(name = \"username\")\n    String username;\n\n    @Column(name = \"password\")\n    String password;\n\n    @JoinColumn(name = \"detail_id\")   //\u6307\u5b9a\u5b58\u50a8\u5916\u952e\u7684\u5b57\u6bb5\u540d\u79f0\n    @OneToOne    //\u58f0\u660e\u4e3a\u4e00\u5bf9\u4e00\u5173\u7cfb\n    AccountDetail detail;\n}\n</code></pre> <p>\u5728\u4fee\u6539\u5b9e\u4f53\u7c7b\u4fe1\u606f\u540e\uff0c\u6211\u4eec\u53d1\u73b0\u5728\u542f\u52a8\u65f6\u4e5f\u8fdb\u884c\u4e86\u66f4\u65b0\uff0c\u65e5\u5fd7\u5982\u4e0b\uff1a</p> <pre><code>Hibernate: alter table users add column detail_id integer\nHibernate: create table users_detail (id integer not null auto_increment, address varchar(255), email varchar(255), phone varchar(255), real_name varchar(255), primary key (id)) engine=InnoDB\nHibernate: alter table users add constraint FK7gb021edkxf3mdv5bs75ni6jd foreign key (detail_id) references users_detail (id)\n</code></pre> <p>\u662f\u4e0d\u662f\u611f\u89c9\u975e\u5e38\u65b9\u4fbf\uff01\u90fd\u61d2\u5f97\u53bb\u624b\u52a8\u6539\u8868\u7ed3\u6784\u4e86\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u5f80\u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u6570\u636e\uff0c\u4e00\u4f1a\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u67e5\u8be2\uff1a</p> <pre><code>@Test\nvoid pageAccount() {\n    repository.findById(1).ifPresent(System.out::println);\n}\n</code></pre> <p>\u67e5\u8be2\u540e\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f97\u5230\u5982\u4e0b\u7ed3\u679c\uff1a</p> <pre><code>Hibernate: select account0_.id as id1_0_0_, account0_.detail_id as detail_i4_0_0_, account0_.password as password2_0_0_, account0_.username as username3_0_0_, accountdet1_.id as id1_1_1_, accountdet1_.address as address2_1_1_, accountdet1_.email as email3_1_1_, accountdet1_.phone as phone4_1_1_, accountdet1_.real_name as real_nam5_1_1_ from users account0_ left outer join users_detail accountdet1_ on account0_.detail_id=accountdet1_.id where account0_.id=?\nAccount(id=1, username=Test, password=123456, detail=AccountDetail(id=1, address=\u56db\u5ddd\u7701\u6210\u90fd\u5e02\u9752\u7f8a\u533a, email=8371289@qq.com, phone=1234567890, realName=\u672c\u4f1f))\n</code></pre> <p>\u4e5f\u5c31\u662f\uff0c\u5728\u5efa\u7acb\u5173\u7cfb\u4e4b\u540e\uff0c\u6211\u4eec\u67e5\u8be2Account\u5bf9\u8c61\u65f6\uff0c\u4f1a\u81ea\u52a8\u5c06\u5173\u8054\u6570\u636e\u7684\u7ed3\u679c\u4e5f\u4e00\u5e76\u8fdb\u884c\u67e5\u8be2\u3002</p> <p>\u90a3\u8981\u662f\u6211\u4eec\u53ea\u60f3\u8981Account\u7684\u6570\u636e\uff0c\u4e0d\u60f3\u8981\u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u6570\u636e\u600e\u4e48\u529e\u5462\uff1f\u6211\u5e0c\u671b\u5728\u6211\u8981\u7528\u7684\u65f6\u5019\u518d\u83b7\u53d6\u8be6\u7ec6\u4fe1\u606f\uff0c\u8fd9\u6837\u53ef\u4ee5\u8282\u7701\u4e00\u4e9b\u7f51\u7edc\u5f00\u9500\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u61d2\u52a0\u8f7d\uff0c\u8fd9\u6837\u53ea\u6709\u5728\u9700\u8981\u65f6\u624d\u4f1a\u5411\u6570\u636e\u5e93\u83b7\u53d6\uff1a</p> <pre><code>@JoinColumn(name = \"detail_id\")\n@OneToOne(fetch = FetchType.LAZY)    //\u5c06\u83b7\u53d6\u7c7b\u578b\u6539\u4e3aLAZY\nAccountDetail detail;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <pre><code>@Transactional   //\u61d2\u52a0\u8f7d\u5c5e\u6027\u9700\u8981\u5728\u4e8b\u52a1\u73af\u5883\u4e0b\u83b7\u53d6\uff0c\u56e0\u4e3arepository\u65b9\u6cd5\u8c03\u7528\u5b8c\u540eSession\u4f1a\u7acb\u5373\u5173\u95ed\n@Test\nvoid pageAccount() {\n    repository.findById(1).ifPresent(account -&gt; {\n        System.out.println(account.getUsername());   //\u83b7\u53d6\u7528\u6237\u540d\n        System.out.println(account.getDetail());  //\u83b7\u53d6\u8be6\u7ec6\u4fe1\u606f\uff08\u61d2\u52a0\u8f7d\uff09\n    });\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u770b\u770b\u63a7\u5236\u53f0\u8f93\u51fa\u4e86\u4ec0\u4e48\uff1a</p> <pre><code>Hibernate: select account0_.id as id1_0_0_, account0_.detail_id as detail_i4_0_0_, account0_.password as password2_0_0_, account0_.username as username3_0_0_ from users account0_ where account0_.id=?\nTest\nHibernate: select accountdet0_.id as id1_1_0_, accountdet0_.address as address2_1_0_, accountdet0_.email as email3_1_0_, accountdet0_.phone as phone4_1_0_, accountdet0_.real_name as real_nam5_1_0_ from users_detail accountdet0_ where accountdet0_.id=?\nAccountDetail(id=1, address=\u56db\u5ddd\u7701\u6210\u90fd\u5e02\u9752\u7f8a\u533a, email=8371289@qq.com, phone=1234567890, realName=\u5362\u672c)\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u83b7\u53d6\u7528\u6237\u540d\u4e4b\u524d\uff0c\u5e76\u6ca1\u6709\u53bb\u67e5\u8be2\u7528\u6237\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u800c\u662f\u5f53\u6211\u4eec\u83b7\u53d6\u8be6\u7ec6\u4fe1\u606f\u65f6\u624d\u8fdb\u884c\u67e5\u8be2\u5e76\u8fd4\u56deAccountDetail\u5bf9\u8c61\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u662f\u5426\u4e5f\u53ef\u4ee5\u5728\u6dfb\u52a0\u6570\u636e\u65f6\uff0c\u5229\u7528\u5b9e\u4f53\u7c7b\u4e4b\u95f4\u7684\u5173\u8054\u4fe1\u606f\uff0c\u4e00\u6b21\u6027\u6dfb\u52a0\u4e24\u5f20\u8868\u7684\u6570\u636e\u5462\uff1f\u53ef\u4ee5\uff0c\u4f46\u662f\u6211\u4eec\u9700\u8981\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u7ea7\u8054\u5173\u8054\u64cd\u4f5c\u8bbe\u5b9a\uff1a</p> <pre><code>@JoinColumn(name = \"detail_id\")\n@OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL) //\u8bbe\u7f6e\u5173\u8054\u64cd\u4f5c\u4e3aALL\nAccountDetail detail;\n</code></pre> <ul> <li>ALL\uff1a\u6240\u6709\u64cd\u4f5c\u90fd\u8fdb\u884c\u5173\u8054\u64cd\u4f5c</li> <li>PERSIST\uff1a\u63d2\u5165\u64cd\u4f5c\u65f6\u624d\u8fdb\u884c\u5173\u8054\u64cd\u4f5c</li> <li>REMOVE\uff1a\u5220\u9664\u64cd\u4f5c\u65f6\u624d\u8fdb\u884c\u5173\u8054\u64cd\u4f5c</li> <li>MERGE\uff1a\u4fee\u6539\u64cd\u4f5c\u65f6\u624d\u8fdb\u884c\u5173\u8054\u64cd\u4f5c</li> </ul> <p>\u53ef\u4ee5\u591a\u4e2a\u5e76\u5b58\uff0c\u63a5\u7740\u6211\u4eec\u6765\u8fdb\u884c\u4e00\u4e0b\u6d4b\u8bd5\uff1a</p> <pre><code>@Test\nvoid addAccount(){\n    Account account = new Account();\n    account.setUsername(\"Nike\");\n    account.setPassword(\"123456\");\n    AccountDetail detail = new AccountDetail();\n    detail.setAddress(\"\u91cd\u5e86\u5e02\u6e1d\u4e2d\u533a\u89e3\u653e\u7891\");\n    detail.setPhone(\"1234567890\");\n    detail.setEmail(\"73281937@qq.com\");\n    detail.setRealName(\"\u5f20\u4e09\");\n    account.setDetail(detail);\n    account = repository.save(account);\n    System.out.println(\"\u63d2\u5165\u65f6\uff0c\u81ea\u52a8\u751f\u6210\u7684\u4e3b\u952eID\u4e3a\uff1a\"+account.getId()+\"\uff0c\u5916\u952eID\u4e3a\uff1a\"+account.getDetail().getId());\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u65e5\u5fd7\u7ed3\u679c\uff1a</p> <pre><code>Hibernate: insert into users_detail (address, email, phone, real_name) values (?, ?, ?, ?)\nHibernate: insert into users (detail_id, password, username) values (?, ?, ?)\n\u63d2\u5165\u65f6\uff0c\u81ea\u52a8\u751f\u6210\u7684\u4e3b\u952eID\u4e3a\uff1a6\uff0c\u5916\u952eID\u4e3a\uff1a3\n</code></pre> <p>\u7ed3\u675f\u540e\u4f1a\u53d1\u73b0\u6570\u636e\u5e93\u4e2d\u4e24\u5f20\u8868\u90fd\u540c\u65f6\u5b58\u5728\u6570\u636e\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u6765\u770b\u4e00\u5bf9\u591a\u5173\u8054\uff0c\u6bd4\u5982\u6bcf\u4e2a\u7528\u6237\u7684\u6210\u7ee9\u4fe1\u606f\uff1a</p> <pre><code>@JoinColumn(name = \"uid\")  //\u6ce8\u610f\u8fd9\u91cc\u7684name\u6307\u7684\u662fScore\u8868\u4e2d\u7684uid\u5b57\u6bb5\u5bf9\u5e94\u7684\u5c31\u662f\u5f53\u524d\u7684\u4e3b\u952e\uff0c\u4f1a\u5c06uid\u5916\u952e\u8bbe\u7f6e\u4e3a\u5f53\u524d\u7684\u4e3b\u952e\n@OneToMany(fetch = FetchType.LAZY, cascade = CascadeType.REMOVE)   //\u5728\u79fb\u9664Account\u65f6\uff0c\u4e00\u5e76\u79fb\u9664\u6240\u6709\u7684\u6210\u7ee9\u4fe1\u606f\uff0c\u4f9d\u7136\u4f7f\u7528\u61d2\u52a0\u8f7d\nList&lt;Score&gt; scoreList;\n</code></pre> <pre><code>@Data\n@Entity\n@Table(name = \"users_score\")   //\u6210\u7ee9\u8868\uff0c\u6ce8\u610f\u53ea\u5b58\u6210\u7ee9\uff0c\u4e0d\u5b58\u5b66\u79d1\u4fe1\u606f\uff0c\u5b66\u79d1\u4fe1\u606fid\u505a\u5916\u952e\npublic class Score {\n\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name = \"id\")\n    @Id\n    int id;\n\n    @OneToOne   //\u4e00\u5bf9\u4e00\u5bf9\u5e94\u5230\u5b66\u79d1\u4e0a\n    @JoinColumn(name = \"cid\")\n    Subject subject;\n\n    @Column(name = \"socre\")\n    double score;\n\n    @Column(name = \"uid\")\n    int uid;\n}\n</code></pre> <pre><code>@Data\n@Entity\n@Table(name = \"subjects\")   //\u5b66\u79d1\u4fe1\u606f\u8868\npublic class Subject {\n\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Column(name = \"cid\")\n    @Id\n    int cid;\n\n    @Column(name = \"name\")\n    String name;\n\n    @Column(name = \"teacher\")\n    String teacher;\n\n    @Column(name = \"time\")\n    int time;\n}\n</code></pre> <p>\u5728\u6570\u636e\u5e93\u4e2d\u586b\u5199\u76f8\u5e94\u6570\u636e\uff0c\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u67e5\u8be2\u7528\u6237\u7684\u6210\u7ee9\u4fe1\u606f\u4e86\uff1a</p> <pre><code>@Transactional\n@Test\nvoid test() {\n    repository.findById(1).ifPresent(account -&gt; {\n        account.getScoreList().forEach(System.out::println);\n    });\n}\n</code></pre> <p>\u6210\u529f\u5f97\u5230\u7528\u6237\u6240\u6709\u7684\u6210\u7ee9\u4fe1\u606f\uff0c\u5305\u62ec\u5f97\u5206\u548c\u5b66\u79d1\u4fe1\u606f\u3002</p> <p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u5bf9\u5e94\u6210\u7ee9\u4e2d\u7684\u6559\u5e08\u4fe1\u606f\u5355\u72ec\u5206\u51fa\u4e00\u5f20\u8868\u5b58\u50a8\uff0c\u5e76\u5efa\u7acb\u591a\u5bf9\u4e00\u7684\u5173\u7cfb\uff0c\u56e0\u4e3a\u591a\u95e8\u8bfe\u7a0b\u53ef\u80fd\u7531\u540c\u4e00\u4e2a\u8001\u5e08\u6559\u6388\uff08\u5343\u4e07\u522b\u641e\u6655\u4e86\uff0c\u4e00\u5b9a\u8981\u7406\u6e05\u695a\u5173\u8054\u5173\u7cfb\uff0c\u540c\u65f6\u4e5f\u662f\u8003\u9a8c\u4f60\u7684\u57fa\u7840\u624e\u4e0d\u624e\u5b9e\uff09\uff1a</p> <pre><code>@ManyToOne(fetch = FetchType.LAZY)\n@JoinColumn(name = \"tid\")   //\u5b58\u50a8\u6559\u5e08ID\u7684\u5b57\u6bb5\uff0c\u548c\u4e00\u5bf9\u4e00\u662f\u4e00\u6837\u7684\uff0c\u4e5f\u4f1a\u5f53\u524d\u8868\u4e2d\u521b\u4e2a\u5916\u952e\nTeacher teacher;\n</code></pre> <p>\u63a5\u7740\u5c31\u662f\u6559\u5e08\u5b9e\u4f53\u7c7b\u4e86\uff1a</p> <pre><code>@Data\n@Entity\n@Table(name = \"teachers\")\npublic class Teacher {\n\n    @Column(name = \"id\")\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    @Id\n    int id;\n\n    @Column(name = \"name\")\n    String name;\n\n    @Column(name = \"sex\")\n    String sex;\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u518d\u8fdb\u884c\u4e00\u4e0b\u6d4b\u8bd5\uff1a</p> <pre><code>@Transactional\n@Test\nvoid test() {\n    repository.findById(3).ifPresent(account -&gt; {\n        account.getScoreList().forEach(score -&gt; {\n            System.out.println(\"\u8bfe\u7a0b\u540d\u79f0\uff1a\"+score.getSubject().getName());\n            System.out.println(\"\u5f97\u5206\uff1a\"+score.getScore());\n            System.out.println(\"\u4efb\u8bfe\u6559\u5e08\uff1a\"+score.getSubject().getTeacher().getName());\n        });\n    });\n}\n</code></pre> <p>\u6210\u529f\u5f97\u5230\u591a\u5bf9\u4e00\u7684\u6559\u5e08\u4fe1\u606f\u3002</p> <p>\u6700\u540e\u6211\u4eec\u518d\u6765\u770b\u6700\u590d\u6742\u7684\u60c5\u51b5\uff0c\u73b0\u5728\u6211\u4eec\u4e00\u95e8\u8bfe\u7a0b\u53ef\u4ee5\u7531\u591a\u4e2a\u8001\u5e08\u6559\u6388\uff0c\u800c\u4e00\u4e2a\u8001\u5e08\u4e5f\u53ef\u4ee5\u6559\u6388\u591a\u4e2a\u8bfe\u7a0b\uff0c\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u5c31\u662f\u5f88\u660e\u663e\u7684\u591a\u5bf9\u591a\u573a\u666f\uff0c\u73b0\u5728\u53c8\u8be5\u5982\u4f55\u5b9a\u4e49\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u50cf\u4e4b\u524d\u4e00\u6837\uff0c\u63d2\u5165\u4e00\u5f20\u4e2d\u95f4\u8868\u8868\u793a\u6559\u6388\u5173\u7cfb\uff0c\u8fd9\u4e2a\u8868\u4e2d\u4e13\u95e8\u5b58\u50a8\u54ea\u4e2a\u8001\u5e08\u6559\u54ea\u4e2a\u79d1\u76ee\uff1a</p> <pre><code>@ManyToMany(fetch = FetchType.LAZY)   //\u591a\u5bf9\u591a\u573a\u666f\n@JoinTable(name = \"teach_relation\",     //\u591a\u5bf9\u591a\u4e2d\u95f4\u5173\u8054\u8868\n        joinColumns = @JoinColumn(name = \"cid\"),    //\u5f53\u524d\u5b9e\u4f53\u4e3b\u952e\u5728\u5173\u8054\u8868\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\n        inverseJoinColumns = @JoinColumn(name = \"tid\")   //\u6559\u5e08\u5b9e\u4f53\u4e3b\u952e\u5728\u5173\u8054\u8868\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\n)\nList&lt;Teacher&gt; teacher;\n</code></pre> <p>\u63a5\u7740\uff0cJPA\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u5f20\u4e2d\u95f4\u8868\uff0c\u5e76\u81ea\u52a8\u8bbe\u7f6e\u5916\u952e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u591a\u5bf9\u591a\u5173\u8054\u4fe1\u606f\u7f16\u5199\u5728\u5176\u4e2d\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#jpqlsql","title":"JPQL\u81ea\u5b9a\u4e49SQL\u8bed\u53e5","text":"<p>\u867d\u7136SpringDataJPA\u80fd\u591f\u7b80\u5316\u5927\u90e8\u5206\u6570\u636e\u83b7\u53d6\u573a\u666f\uff0c\u4f46\u662f\u96be\u514d\u4f1a\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u573a\u666f\uff0c\u9700\u8981\u4f7f\u7528\u590d\u6742\u67e5\u8be2\u624d\u80fd\u591f\u53bb\u5b8c\u6210\uff0c\u8fd9\u65f6\u4f60\u53c8\u4f1a\u53d1\u73b0\uff0c\u5982\u679c\u8981\u5b9e\u73b0\uff0c\u53ea\u80fd\u7528\u56deMybatis\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u9700\u8981\u81ea\u5df1\u624b\u52a8\u7f16\u5199SQL\u8bed\u53e5\uff0c\u8fc7\u5ea6\u4f9d\u8d56SpringDataJPA\u4f1a\u4f7f\u5f97SQL\u8bed\u53e5\u4e0d\u53ef\u63a7\u3002</p> <p>\u4f7f\u7528JPA\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u50cfMybatis\u90a3\u6837\uff0c\u76f4\u63a5\u7f16\u5199SQL\u8bed\u53e5\uff0c\u4e0d\u8fc7\u5b83\u662fJPQL\u8bed\u8a00\uff0c\u4e0e\u539f\u751fSQL\u8bed\u53e5\u5f88\u7c7b\u4f3c\uff0c\u4f46\u662f\u5b83\u662f\u9762\u5411\u5bf9\u8c61\u7684\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u7f16\u5199\u539f\u751fSQL\u8bed\u53e5\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u8981\u66f4\u65b0\u7528\u6237\u8868\u4e2d\u6307\u5b9aID\u7528\u6237\u7684\u5bc6\u7801\uff1a</p> <pre><code>@Repository\npublic interface AccountRepository extends JpaRepository&lt;Account, Integer&gt; {\n\n    @Transactional    //DML\u64cd\u4f5c\u9700\u8981\u4e8b\u52a1\u73af\u5883\uff0c\u53ef\u4ee5\u4e0d\u5728\u8fd9\u91cc\u58f0\u660e\uff0c\u4f46\u662f\u8c03\u7528\u65f6\u4e00\u5b9a\u8981\u5904\u4e8e\u4e8b\u52a1\u73af\u5883\u4e0b\n    @Modifying     //\u8868\u793a\u8fd9\u662f\u4e00\u4e2aDML\u64cd\u4f5c\n    @Query(\"update Account set password = ?2 where id = ?1\") //\u8fd9\u91cc\u64cd\u4f5c\u7684\u662f\u4e00\u4e2a\u5b9e\u4f53\u7c7b\u5bf9\u5e94\u7684\u8868\uff0c\u53c2\u6570\u4f7f\u7528?\u4ee3\u8868\uff0c\u540e\u9762\u63a5\u7b2cn\u4e2a\u53c2\u6570\n    int updatePasswordById(int id, String newPassword);\n}\n</code></pre> <pre><code>@Test\nvoid updateAccount(){\n    repository.updatePasswordById(1, \"654321\");\n}\n</code></pre> <p>\u73b0\u5728\u6211\u60f3\u4f7f\u7528\u539f\u751fSQL\u6765\u5b9e\u73b0\u6839\u636e\u7528\u6237\u540d\u79f0\u4fee\u6539\u5bc6\u7801\uff1a</p> <pre><code>@Transactional\n@Modifying\n@Query(value = \"update users set password = :pwd where username = :name\", nativeQuery = true) //\u4f7f\u7528\u539f\u751fSQL\uff0c\u548cMybatis\u4e00\u6837\uff0c\u8fd9\u91cc\u4f7f\u7528 :\u540d\u79f0 \u8868\u793a\u53c2\u6570\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u7ee7\u7eed\u7528\u4e0a\u9762\u90a3\u79cd\u65b9\u5f0f\u3002\nint updatePasswordByUsername(@Param(\"name\") String username,   //\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528@Param\u6307\u5b9a\u540d\u79f0\n                             @Param(\"pwd\") String newPassword);\n</code></pre> <pre><code>@Test\nvoid updateAccount(){\n    repository.updatePasswordByUsername(\"Admin\", \"654321\");\n}\n</code></pre> <p>\u901a\u8fc7\u7f16\u5199\u539f\u751fSQL\uff0c\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u5f25\u8865\u4e86SQL\u4e0d\u53ef\u63a7\u7684\u95ee\u9898\u3002</p> <p>\u867d\u7136JPA\u80fd\u591f\u4e3a\u6211\u4eec\u5e26\u6765\u975e\u5e38\u4fbf\u6377\u7684\u5f00\u53d1\u4f53\u9a8c\uff0c\u4f46\u662f\u6b63\u662f\u56e0\u4e3a\u592a\u4fbf\u6377\u4e86\uff0c\u4fdd\u59c6\u7ea7\u7684\u4f53\u9a8c\u6709\u65f6\u4e5f\u4f1a\u9002\u5f97\u5176\u53cd\uff0c\u5c24\u5176\u662f\u4e00\u4e9b\u56fd\u5185\u7528\u5230\u590d\u6742\u67e5\u8be2\u4e1a\u52a1\u7684\u9879\u76ee\uff0c\u53ef\u80fd\u5f00\u53d1\u5230\u540e\u671f\u7279\u522b\u5e9e\u5927\u65f6\uff0c\u5c31\u53ea\u80fd\u4ece\u5e95\u5c42SQL\u8bed\u53e5\u5f00\u59cb\u8fdb\u884c\u4f18\u5316\uff0c\u800c\u7531\u4e8eJPA\u5c3d\u53ef\u80fd\u5730\u5728\u5c4f\u853d\u6211\u4eec\u5bf9SQL\u8bed\u53e5\u7684\u7f16\u5199\uff0c\u6240\u4ee5\u540e\u671f\u4f18\u5316\u662f\u4e2a\u5927\u95ee\u9898\uff0c\u5e76\u4e14Hibernate\u76f8\u5bf9\u4e8eMybatis\u6765\u8bf4\uff0c\u66f4\u52a0\u91cd\u91cf\u7ea7\u3002\u4e0d\u8fc7\uff0c\u5728\u5fae\u670d\u52a1\u7684\u65f6\u4ee3\uff0c\u5355\u4f53\u9879\u76ee\u4e00\u822c\u4e0d\u4f1a\u592a\u5927\uff0cJPA\u7684\u52a3\u52bf\u5e76\u6ca1\u6709\u592a\u660e\u663e\u5730\u4f53\u73b0\u51fa\u6765\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#mybatisplus","title":"MybatisPlus\u6846\u67b6","text":"<p>\u524d\u9762\u6211\u4eec\u4f53\u9a8c\u4e86JPA\u5e26\u6765\u7684\u5feb\u901f\u5f00\u53d1\u4f53\u9a8c\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u9762\u5bf9\u4e00\u4e9b\u590d\u6742\u67e5\u8be2\u65f6\uff0cJPA\u4f3c\u4e4e\u6709\u70b9\u529b\u4e0d\u4ece\u5fc3\uff0c\u53cd\u89c2\u7a0d\u5fae\u9ebb\u70e6\u4e00\u70b9\u7684Mybatis\u5374\u80fd\u591f\u624b\u52a8\u7f16\u5199SQL\uff0c\u4f7f\u7528\u8d77\u6765\u66f4\u52a0\u7075\u6d3b\uff0c\u90a3\u4e48\u6709\u6ca1\u6709\u4e00\u79cd\u65e2\u80fd\u7075\u6d3b\u638c\u63a7\u903b\u8f91\u53c8\u80fd\u5feb\u901f\u5b8c\u6210\u5f00\u53d1\u7684\u6301\u4e45\u5c42\u6846\u67b6\u5462\uff1f</p> <p>MyBatis-Plus\uff08\u7b80\u79f0 MP\uff09\u662f\u4e00\u4e2a MyBatis\u7684\u589e\u5f3a\u5de5\u5177\uff0c\u5728 MyBatis \u7684\u57fa\u7840\u4e0a\u53ea\u505a\u589e\u5f3a\u4e0d\u505a\u6539\u53d8\uff0c\u4e3a\u7b80\u5316\u5f00\u53d1\u3001\u63d0\u9ad8\u6548\u7387\u800c\u751f\u3002</p> <p>MybatisPlus\u7684\u613f\u666f\u662f\u6210\u4e3a MyBatis \u6700\u597d\u7684\u642d\u6863\uff0c\u5c31\u50cf \u9b42\u6597\u7f57 \u4e2d\u7684 1P\u30012P\uff0c\u57fa\u53cb\u642d\u914d\uff0c\u6548\u7387\u7ffb\u500d\u3002</p> <p></p> <p>\u5b98\u65b9\u7f51\u7ad9\u5730\u5740\uff1ahttps://baomidou.com</p> <p>MybatisPlus\u5177\u6709\u4ee5\u4e0b\u7279\u6027\uff1a</p> <ul> <li>\u65e0\u4fb5\u5165\uff1a\u53ea\u505a\u589e\u5f3a\u4e0d\u505a\u6539\u53d8\uff0c\u5f15\u5165\u5b83\u4e0d\u4f1a\u5bf9\u73b0\u6709\u5de5\u7a0b\u4ea7\u751f\u5f71\u54cd\uff0c\u5982\u4e1d\u822c\u987a\u6ed1</li> <li>\u635f\u8017\u5c0f\uff1a\u542f\u52a8\u5373\u4f1a\u81ea\u52a8\u6ce8\u5165\u57fa\u672c CURD\uff0c\u6027\u80fd\u57fa\u672c\u65e0\u635f\u8017\uff0c\u76f4\u63a5\u9762\u5411\u5bf9\u8c61\u64cd\u4f5c</li> <li>\u5f3a\u5927\u7684 CRUD \u64cd\u4f5c\uff1a\u5185\u7f6e\u901a\u7528 Mapper\u3001\u901a\u7528 Service\uff0c\u4ec5\u4ec5\u901a\u8fc7\u5c11\u91cf\u914d\u7f6e\u5373\u53ef\u5b9e\u73b0\u5355\u8868\u5927\u90e8\u5206 CRUD \u64cd\u4f5c\uff0c\u66f4\u6709\u5f3a\u5927\u7684\u6761\u4ef6\u6784\u9020\u5668\uff0c\u6ee1\u8db3\u5404\u7c7b\u4f7f\u7528\u9700\u6c42</li> <li>\u652f\u6301 Lambda \u5f62\u5f0f\u8c03\u7528\uff1a\u901a\u8fc7 Lambda \u8868\u8fbe\u5f0f\uff0c\u65b9\u4fbf\u7684\u7f16\u5199\u5404\u7c7b\u67e5\u8be2\u6761\u4ef6\uff0c\u65e0\u9700\u518d\u62c5\u5fc3\u5b57\u6bb5\u5199\u9519</li> <li>\u652f\u6301\u4e3b\u952e\u81ea\u52a8\u751f\u6210\uff1a\u652f\u6301\u591a\u8fbe 4 \u79cd\u4e3b\u952e\u7b56\u7565\uff08\u5185\u542b\u5206\u5e03\u5f0f\u552f\u4e00 ID \u751f\u6210\u5668 - Sequence\uff09\uff0c\u53ef\u81ea\u7531\u914d\u7f6e\uff0c\u5b8c\u7f8e\u89e3\u51b3\u4e3b\u952e\u95ee\u9898</li> <li>\u652f\u6301 ActiveRecord \u6a21\u5f0f\uff1a\u652f\u6301 ActiveRecord \u5f62\u5f0f\u8c03\u7528\uff0c\u5b9e\u4f53\u7c7b\u53ea\u9700\u7ee7\u627f Model \u7c7b\u5373\u53ef\u8fdb\u884c\u5f3a\u5927\u7684 CRUD \u64cd\u4f5c</li> <li>\u652f\u6301\u81ea\u5b9a\u4e49\u5168\u5c40\u901a\u7528\u64cd\u4f5c\uff1a\u652f\u6301\u5168\u5c40\u901a\u7528\u65b9\u6cd5\u6ce8\u5165\uff08 Write once, use anywhere \uff09</li> <li>\u5185\u7f6e\u4ee3\u7801\u751f\u6210\u5668\uff1a\u91c7\u7528\u4ee3\u7801\u6216\u8005 Maven \u63d2\u4ef6\u53ef\u5feb\u901f\u751f\u6210 Mapper \u3001 Model \u3001 Service \u3001 Controller \u5c42\u4ee3\u7801\uff0c\u652f\u6301\u6a21\u677f\u5f15\u64ce\uff0c\u66f4\u6709\u8d85\u591a\u81ea\u5b9a\u4e49\u914d\u7f6e\u7b49\u60a8\u6765\u4f7f\u7528</li> <li>\u5185\u7f6e\u5206\u9875\u63d2\u4ef6\uff1a\u57fa\u4e8e MyBatis \u7269\u7406\u5206\u9875\uff0c\u5f00\u53d1\u8005\u65e0\u9700\u5173\u5fc3\u5177\u4f53\u64cd\u4f5c\uff0c\u914d\u7f6e\u597d\u63d2\u4ef6\u4e4b\u540e\uff0c\u5199\u5206\u9875\u7b49\u540c\u4e8e\u666e\u901a List \u67e5\u8be2</li> <li>\u5206\u9875\u63d2\u4ef6\u652f\u6301\u591a\u79cd\u6570\u636e\u5e93\uff1a\u652f\u6301 MySQL\u3001MariaDB\u3001Oracle\u3001DB2\u3001H2\u3001HSQL\u3001SQLite\u3001Postgre\u3001SQLServer \u7b49\u591a\u79cd\u6570\u636e\u5e93</li> <li>\u5185\u7f6e\u6027\u80fd\u5206\u6790\u63d2\u4ef6\uff1a\u53ef\u8f93\u51fa SQL \u8bed\u53e5\u4ee5\u53ca\u5176\u6267\u884c\u65f6\u95f4\uff0c\u5efa\u8bae\u5f00\u53d1\u6d4b\u8bd5\u65f6\u542f\u7528\u8be5\u529f\u80fd\uff0c\u80fd\u5feb\u901f\u63ea\u51fa\u6162\u67e5\u8be2</li> <li>\u5185\u7f6e\u5168\u5c40\u62e6\u622a\u63d2\u4ef6\uff1a\u63d0\u4f9b\u5168\u8868 delete \u3001 update \u64cd\u4f5c\u667a\u80fd\u5206\u6790\u963b\u65ad\uff0c\u4e5f\u53ef\u81ea\u5b9a\u4e49\u62e6\u622a\u89c4\u5219\uff0c\u9884\u9632\u8bef\u64cd\u4f5c</li> </ul> <p>\u6846\u67b6\u6574\u4f53\u7ed3\u6784\u5982\u4e0b\uff1a</p> <p></p> <p>\u4e0d\u8fc7\uff0c\u5149\u8bf4\u8fd8\u662f\u4e0d\u80fd\u4f53\u4f1a\u5230\u5b83\u5e26\u6765\u7684\u4fbf\u6377\u6027\uff0c\u6211\u4eec\u63a5\u7740\u5c31\u6765\u4e0a\u624b\u4f53\u9a8c\u4e00\u4e0b\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#_2","title":"\u5feb\u901f\u4e0a\u624b","text":"<p>\u8ddf\u4e4b\u524d\u4e00\u6837\uff0c\u8fd8\u662f\u6dfb\u52a0\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n     &lt;groupId&gt;com.baomidou&lt;/groupId&gt;\n     &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;\n     &lt;version&gt;3.5.3.1&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n     &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n     &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u914d\u7f6e\u6587\u4ef6\u4f9d\u7136\u53ea\u9700\u8981\u914d\u7f6e\u6570\u636e\u6e90\u5373\u53ef\uff1a</p> <pre><code>spring:\n  datasource:\n    url: jdbc:mysql://localhost:3306/test\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.cj.jdbc.Driver\n</code></pre> <p>\u7136\u540e\u4f9d\u7136\u662f\u5b9e\u4f53\u7c7b\uff0c\u53ef\u4ee5\u76f4\u63a5\u6620\u5c04\u5230\u6570\u636e\u5e93\u4e2d\u7684\u8868\uff1a</p> <pre><code>@Data\n@TableName(\"user\")  //\u5bf9\u5e94\u7684\u8868\u540d\npublic class User {\n    @TableId(type = IdType.AUTO)   //\u5bf9\u5e94\u7684\u4e3b\u952e\n    int id;\n    @TableField(\"name\")   //\u5bf9\u5e94\u7684\u5b57\u6bb5\n    String name;\n    @TableField(\"email\")\n    String email;\n    @TableField(\"password\")\n    String password;\n}\n</code></pre> <p>\u63a5\u7740\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7f16\u5199\u4e00\u4e2aMapper\u6765\u64cd\u4f5c\u4e86\uff1a</p> <pre><code>@Mapper\npublic interface UserMapper extends BaseMapper&lt;User&gt; {\n    //\u4f7f\u7528\u65b9\u5f0f\u4e0eJPA\u6781\u5176\u76f8\u4f3c\uff0c\u540c\u6837\u662f\u7ee7\u627f\u4e00\u4e2a\u57fa\u7840\u7684\u6a21\u7248Mapper\n    //\u8fd9\u4e2a\u6a21\u7248\u91cc\u9762\u63d0\u4f9b\u4e86\u9884\u8bbe\u7684\u5927\u91cf\u65b9\u6cd5\u76f4\u63a5\u4f7f\u7528\uff0c\u8ddfJPA\u5982\u51fa\u4e00\u8f99\n}\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u5c31\u6765\u5199\u4e00\u4e2a\u7b80\u5355\u6d4b\u8bd5\u7528\u4f8b\uff1a</p> <pre><code>@SpringBootTest\nclass DemoApplicationTests {\n\n    @Resource\n    UserMapper mapper;\n\n    @Test\n    void contextLoads() {\n        System.out.println(mapper.selectById(1));  //\u540c\u6837\u53ef\u4ee5\u76f4\u63a5selectById\uff0c\u975e\u5e38\u5feb\u901f\u65b9\u4fbf\n    }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2aMapper\u63d0\u4f9b\u7684\u65b9\u6cd5\u8fd8\u662f\u5f88\u4e30\u5bcc\u7684\uff1a</p> <p></p> <p>\u540e\u7eed\u7684\u677f\u5757\u6211\u4eec\u5c06\u8be6\u7ec6\u4ecb\u7ecd\u5b83\u7684\u4f7f\u7528\u65b9\u5f0f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#_3","title":"\u6761\u4ef6\u6784\u9020\u5668","text":"<p>\u5bf9\u4e8e\u4e00\u4e9b\u590d\u6742\u67e5\u8be2\u7684\u60c5\u51b5\uff0cMybatisPlus\u652f\u6301\u6211\u4eec\u81ea\u5df1\u6784\u9020QueryWrapper\u7528\u4e8e\u590d\u6742\u6761\u4ef6\u67e5\u8be2\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    QueryWrapper&lt;User&gt; wrapper = new QueryWrapper&lt;&gt;();    //\u590d\u6742\u67e5\u8be2\u53ef\u4ee5\u4f7f\u7528QueryWrapper\u6765\u5b8c\u6210\n    wrapper\n            .select(\"id\", \"name\", \"email\", \"password\")    //\u53ef\u4ee5\u81ea\u5b9a\u4e49\u9009\u62e9\u54ea\u4e9b\u5b57\u6bb5\n            .ge(\"id\", 2)                //\u9009\u62e9\u5224\u65adid\u5927\u4e8e\u7b49\u4e8e1\u7684\u6240\u6709\u6570\u636e\n            .orderByDesc(\"id\");   //\u6839\u636eid\u5b57\u6bb5\u8fdb\u884c\u964d\u5e8f\u6392\u5e8f\n    System.out.println(mapper.selectList(wrapper));   //Mapper\u540c\u6837\u652f\u6301\u4f7f\u7528QueryWrapper\u8fdb\u884c\u67e5\u8be2\n}\n</code></pre> <p>\u901a\u8fc7\u4f7f\u7528\u4e0a\u9762\u7684QueryWrapper\u5bf9\u8c61\u8fdb\u884c\u67e5\u8be2\uff0c\u4e5f\u5c31\u7b49\u4ef7\u4e8e\u4e0b\u9762\u7684SQL\u8bed\u53e5\uff1a</p> <pre><code>select id,name,email,password from user where id &gt;= 2 order by id desc\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u5728\u914d\u7f6e\u4e2d\u5f00\u542fSQL\u65e5\u5fd7\u6253\u5370\uff1a</p> <pre><code>mybatis-plus:\n  configuration:\n    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl\n</code></pre> <p>\u6700\u540e\u5f97\u5230\u7684\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u6709\u4e9b\u65f6\u5019\u6211\u4eec\u9047\u5230\u9700\u8981\u6279\u5904\u7406\u7684\u60c5\u51b5\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u6279\u5904\u7406\u64cd\u4f5c\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    //\u652f\u6301\u6279\u5904\u7406\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u4e00\u6b21\u6027\u5220\u9664\u591a\u4e2a\u6307\u5b9aID\u7684\u7528\u6237\n    int count = mapper.deleteBatchIds(List.of(1, 3));\n    System.out.println(count);\n}\n</code></pre> <p></p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5feb\u901f\u8fdb\u884c\u5206\u9875\u67e5\u8be2\u64cd\u4f5c\uff0c\u4e0d\u8fc7\u5728\u6267\u884c\u524d\u6211\u4eec\u9700\u8981\u5148\u914d\u7f6e\u4e00\u4e0b\uff1a</p> <pre><code>@Configuration\npublic class MybatisConfiguration {\n    @Bean\n    public MybatisPlusInterceptor paginationInterceptor() {\n        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();\n        //\u6dfb\u52a0\u5206\u9875\u62e6\u622a\u5668\u5230MybatisPlusInterceptor\u4e2d\n        interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));\n        return interceptor;\n    }\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u4f7f\u7528\u5206\u9875\u529f\u80fd\u4e86\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    //\u8fd9\u91cc\u6211\u4eec\u5c06\u7528\u6237\u8868\u52062\u9875\uff0c\u5e76\u83b7\u53d6\u7b2c\u4e00\u9875\u7684\u6570\u636e\n    Page&lt;User&gt; page = mapper.selectPage(Page.of(1, 2), Wrappers.emptyWrapper());\n    System.out.println(page.getRecords());   //\u83b7\u53d6\u5206\u9875\u4e4b\u540e\u7684\u6570\u636e\n}\n</code></pre> <p></p> <p>\u5bf9\u4e8e\u6570\u636e\u66f4\u65b0\u64cd\u4f5c\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528UpdateWrapper\u975e\u5e38\u65b9\u4fbf\u7684\u6765\u5b8c\u6210\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    UpdateWrapper&lt;User&gt; wrapper = new UpdateWrapper&lt;&gt;();\n    wrapper\n            .set(\"name\", \"lbw\")\n            .eq(\"id\", 1);\n    System.out.println(mapper.update(null, wrapper));\n}\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u5feb\u901f\u5b8c\u6210\u66f4\u65b0\u64cd\u4f5c\u4e86\uff1a</p> <p></p> <p>QueryWrapper\u548cUpdateWrapper\u8fd8\u6709\u4e13\u95e8\u652f\u6301Java 8\u65b0\u589e\u7684Lambda\u8868\u8fbe\u5f0f\u7684\u7279\u6b8a\u5b9e\u73b0\uff0c\u53ef\u4ee5\u76f4\u63a5\u4ee5\u51fd\u6570\u5f0f\u7684\u5f62\u5f0f\u8fdb\u884c\u7f16\u5199\uff0c\u4f7f\u7528\u65b9\u6cd5\u662f\u4e00\u6837\u7684\uff0c\u8fd9\u91cc\u7b80\u5355\u6f14\u793a\u51e0\u4e2a\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n        LambdaQueryWrapper&lt;User&gt; wrapper = Wrappers\n                .&lt;User&gt;lambdaQuery()\n                .eq(User::getId, 2)   //\u6bd4\u5982\u6211\u4eec\u9700\u8981\u9009\u62e9id\u4e3a2\u7684\u7528\u6237\uff0c\u524d\u9762\u4f20\u5165\u65b9\u6cd5\u5f15\u7528\uff0c\u540e\u9762\u6bd4\u7684\u503c\n                .select(User::getName, User::getId);   //\u6bd4\u5982\u6211\u4eec\u53ea\u9700\u8981\u9009\u62e9name\u548cid\uff0c\u90a3\u5c31\u4f20\u5165\u5bf9\u5e94\u7684get\u65b9\u6cd5\u5f15\u7528\n        System.out.println(mapper.selectOne(wrapper));\n}\n</code></pre> <p>\u4e0d\u8fc7\u611f\u89c9\u53ef\u8bfb\u6027\u4f3c\u4e4e\u6ca1\u6709\u4e0d\u7528Lambda\u9ad8\u554a\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#_4","title":"\u63a5\u53e3\u57fa\u672c\u64cd\u4f5c","text":"<p>\u867d\u7136\u4f7f\u7528MybatisPlus\u63d0\u4f9b\u7684BaseMapper\u5df2\u7ecf\u5f88\u65b9\u4fbf\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u7684\u4e1a\u52a1\u4e2d\uff0c\u5b9e\u9645\u4e0a\u5f88\u591a\u65f6\u5019\u4e5f\u662f\u4e00\u6837\u7684\u5de5\u4f5c\uff0c\u90fd\u662f\u53bb\u7b80\u5355\u8c03\u7528\u5e95\u5c42\u7684Mapper\u505a\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u4e8b\u60c5\uff0c\u90a3\u4e48\u80fd\u4e0d\u80fd\u5e72\u8106\u628aService\u4e5f\u7ed9\u5f04\u4e2a\u6a21\u7248\uff1fMybatisPlus\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5f88\u65b9\u4fbf\u7684CRUD\u63a5\u53e3\uff0c\u76f4\u63a5\u5b9e\u73b0\u4e86\u5404\u79cd\u4e1a\u52a1\u4e2d\u4f1a\u7528\u5230\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c\u3002</p> <p>\u6211\u4eec\u53ea\u9700\u8981\u7ee7\u627f\u5373\u53ef\uff1a</p> <pre><code>@Service\npublic interface UserService extends IService&lt;User&gt; {\n    //\u9664\u4e86\u7ee7\u627f\u6a21\u7248\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u628a\u5b83\u5f53\u6210\u666e\u901aService\u6dfb\u52a0\u81ea\u5df1\u9700\u8981\u7684\u65b9\u6cd5\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u8fd8\u9700\u8981\u7f16\u5199\u4e00\u4e2a\u5b9e\u73b0\u7c7b\uff0c\u8fd9\u4e2a\u5b9e\u73b0\u7c7b\u5c31\u662fUserService\u7684\u5b9e\u73b0\uff1a</p> <pre><code>@Service   //\u9700\u8981\u7ee7\u627fServiceImpl\u624d\u80fd\u5b9e\u73b0\u90a3\u4e9b\u9ed8\u8ba4\u7684CRUD\u65b9\u6cd5\npublic class UserServiceImpl extends ServiceImpl&lt;UserMapper, User&gt; implements UserService {\n}\n</code></pre> <p>\u4f7f\u7528\u8d77\u6765\u4e5f\u5f88\u65b9\u4fbf\uff0c\u6574\u5408\u4e86\u8d85\u591a\u65b9\u6cd5\uff1a</p> <p></p> <p>\u6bd4\u5982\u6211\u4eec\u60f3\u6279\u91cf\u63d2\u5165\u4e00\u7ec4\u7528\u6237\u6570\u636e\u5230\u6570\u636e\u5e93\u4e2d\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    List&lt;User&gt; users = List.of(new User(\"xxx\"), new User(\"yyy\"));\n    //\u9884\u8bbe\u65b9\u6cd5\u4e2d\u5df2\u7ecf\u652f\u6301\u6279\u91cf\u4fdd\u5b58\u4e86\uff0c\u8fd9\u76f8\u6bd4\u6211\u4eec\u76f4\u63a5\u7528for\u6548\u7387\u9ad8\u4e0d\u5c11\n    service.saveBatch(users);\n}\n</code></pre> <p>\u8fd8\u6709\u66f4\u52a0\u65b9\u4fbf\u5feb\u6377\u7684\u4fdd\u5b58\u6216\u66f4\u65b0\u64cd\u4f5c\uff0c\u5f53\u6570\u636e\u4e0d\u5b58\u5728\u65f6\uff08\u901a\u8fc7\u4e3b\u952eID\u5224\u65ad\uff09\u5219\u63d2\u5165\u65b0\u6570\u636e\uff0c\u5426\u5219\u5c31\u66f4\u65b0\u6570\u636e\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    service.saveOrUpdate(new User(\"aaa\"));\n}\n</code></pre> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528Service\u6765\u8fdb\u884c\u94fe\u5f0f\u67e5\u8be2\uff0c\u5199\u6cd5\u975e\u5e38\u8212\u670d\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    User one = service.query().eq(\"id\", 1).one();\n    System.out.println(one);\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#_5","title":"\u65b0\u7248\u4ee3\u7801\u751f\u6210\u5668","text":"<p>\u6700\u540e\u6211\u4eec\u518d\u6765\u9686\u91cd\u4ecb\u7ecd\u4e00\u4e0bMybatisPlus\u7684\u4ee3\u7801\u751f\u6210\u5668\uff0c\u8fd9\u4e2a\u4e1c\u897f\u53ef\u8c13\u662f\u62ef\u6551\u4e86\u5343\u5343\u4e07\u4e07\u5b66\u5b50\u7684\u6bd5\u8bbe\u554a\u3002</p> <p>\u5b83\u80fd\u591f\u6839\u636e\u6570\u636e\u5e93\u505a\u5230\u4ee3\u7801\u7684\u4e00\u952e\u751f\u6210\uff0c\u80fd\u505a\u5230\u4ec0\u4e48\u7a0b\u5ea6\u5462\uff1f</p> <p></p> <p>\u4f60\u6ca1\u770b\u9519\uff0c\u6574\u4e2a\u9879\u76ee\u4eceMapper\u5230Controller\uff0c\u6240\u6709\u7684\u4e1c\u897f\u5168\u90e8\u90fd\u7ed9\u4f60\u751f\u6210\u597d\u4e86\uff0c\u4f60\u53ea\u7ba1\u628a\u9700\u8981\u8865\u5145\u7684\u4e1a\u52a1\u7ed9\u5199\u4e86\u5c31\u884c\uff0c\u8fd9\u662f\u771f\u6b63\u7684\u628a\u996d\u7ed9\u5582\u5230\u4f60\u5634\u8fb9\u7684\u884c\u4e3a\uff0c\u662f\u5e7f\u5927\u5b66\u5b50\u7684\u6bd5\u8bbe\u5927\u6740\u5668\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u5c31\u6765\u770b\u770b\uff0c\u8fd9\u73a9\u610f\u600e\u4e48\u53bb\u7528\u7684\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u5148\u628a\u6574\u4e2a\u9879\u76ee\u7684\u6570\u636e\u5e93\u7ed9\u521b\u5efa\u597d\uff0c\u521b\u5efa\u597d\u4e4b\u540e\uff0c\u6211\u4eec\u7ee7\u7eed\u4e0b\u4e00\u6b65\uff0c\u8fd9\u91cc\u6211\u4eec\u4ece\u5934\u5f00\u59cb\u521b\u5efa\u4e00\u4e2a\u9879\u76ee\uff0c\u611f\u53d7\u4e00\u4e0b\u5b83\u7684\u5f3a\u5927\uff0c\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u7684SpringBoot\u9879\u76ee\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u5bfc\u5165\u4e00\u4f1a\u9700\u8981\u7528\u5230\u7684\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;\n    &lt;version&gt;3.5.3.1&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;\n    &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;\n    &lt;version&gt;3.5.3.1&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.velocity&lt;/groupId&gt;\n    &lt;artifactId&gt;velocity-engine-core&lt;/artifactId&gt;\n    &lt;version&gt;2.3&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7136\u540e\u518d\u914d\u7f6e\u4e00\u4e0b\u6570\u636e\u6e90\uff1a</p> <pre><code>spring:\n  datasource:\n    url: jdbc:mysql://localhost:3306/test\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.cj.jdbc.Driver\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u59cb\u7f16\u5199\u81ea\u52a8\u751f\u6210\u811a\u672c\u4e86\uff0c\u8fd9\u91cc\u4f9d\u7136\u9009\u62e9\u6d4b\u8bd5\u7c7b\uff0c\u7528\u5230<code>FastAutoGenerator</code>\u4f5c\u4e3a\u751f\u6210\u5668\uff1a</p> <pre><code>        @Test\n    void contextLoads() {\n        FastAutoGenerator\n                    //\u9996\u5148\u4f7f\u7528create\u6765\u914d\u7f6e\u6570\u636e\u5e93\u94fe\u63a5\u4fe1\u606f\n                .create(new DataSourceConfig.Builder(dataSource))\n                .execute();\n    }\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u914d\u7f6e\u4e00\u4e0b\u5168\u5c40\u8bbe\u7f6e\uff0c\u8fd9\u4e9b\u4f1a\u5f71\u54cd\u4e00\u4f1a\u751f\u6210\u7684\u4ee3\u7801\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    FastAutoGenerator\n            .create(new DataSourceConfig.Builder(dataSource))\n            .globalConfig(builder -&gt; {\n                builder.author(\"lbw\");              //\u4f5c\u8005\u4fe1\u606f\uff0c\u4e00\u4f1a\u4f1a\u53d8\u6210\u6ce8\u91ca\n                builder.commentDate(\"2024-01-01\");  //\u65e5\u671f\u4fe1\u606f\uff0c\u4e00\u4f1a\u4f1a\u53d8\u6210\u6ce8\u91ca\n                builder.outputDir(\"src/main/java\"); //\u8f93\u51fa\u76ee\u5f55\u8bbe\u7f6e\u4e3a\u5f53\u524d\u9879\u76ee\u7684\u76ee\u5f55\n            })\n            .execute();\n}\n</code></pre> <p>\u7136\u540e\u662f\u6253\u5305\u8bbe\u7f6e\uff0c\u4e5f\u5c31\u662f\u9879\u76ee\u7684\u751f\u6210\u7684\u5305\u7b49\u7b49\uff0c\u8fd9\u91cc\u7b80\u5355\u914d\u7f6e\u4e00\u4e0b\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    FastAutoGenerator\n            ...\n                //\u6253\u5305\u8bbe\u7f6e\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e00\u4e0b\u5305\u540d\u5c31\u884c\uff0c\u6ce8\u610f\u8ddf\u6211\u4eec\u9879\u76ee\u5305\u540d\u8bbe\u7f6e\u4e3a\u4e00\u81f4\u7684\n                .packageConfig(builder -&gt; builder.parent(\"com.example\"))\n                .strategyConfig(builder -&gt; {\n                    //\u8bbe\u7f6e\u4e3a\u6240\u6709Mapper\u6dfb\u52a0@Mapper\u6ce8\u89e3\n                    builder\n                            .mapperBuilder()\n                            .mapperAnnotation(Mapper.class)\n                            .build();\n            })\n            .execute();\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u4e86\u8fd9\u4e2a\u811a\u672c\u4e86\uff1a</p> <p></p> <p>\u73b0\u5728\uff0c\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u7684\u9879\u76ee\u4e2d\u5df2\u7ecf\u51fa\u73b0\u81ea\u52a8\u751f\u6210\u4ee3\u7801\u4e86\uff1a</p> <p></p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u8fd9\u4e2a\u9879\u76ee\uff1a</p> <p></p> <p>\u901f\u5ea6\u53ef\u4ee5\u8bf4\u662f\u975e\u5e38\u4e4b\u5feb\uff0c\u4e00\u4e2a\u9879\u76ee\u6a21\u7248\u5c31\u642d\u5efa\u5b8c\u6210\u4e86\uff0c\u6211\u4eec\u53ea\u9700\u8981\u63a5\u7740\u5199\u4e1a\u52a1\u5c31\u53ef\u4ee5\u4e86\uff0c\u5f53\u7136\u5982\u679c\u5404\u4f4d\u5c0f\u4f19\u4f34\u9700\u8981\u66f4\u591a\u5b9a\u5236\u5316\u7684\u8bdd\uff0c\u53ef\u4ee5\u5728\u5b98\u7f51\u67e5\u770b\u5176\u4ed6\u7684\u914d\u7f6e\uff1ahttps://baomidou.com/pages/981406/</p> <p>\u5bf9\u4e8e\u4e00\u4e9b\u6709\u7279\u6b8a\u8981\u6c42\u7684\u7528\u6237\u6765\u8bf4\uff0c\u6211\u4eec\u5e0c\u671b\u80fd\u591f\u4ee5\u81ea\u5df1\u7684\u6a21\u7248\u6765\u8fdb\u884c\u751f\u4ea7\uff0c\u600e\u4e48\u624d\u80fd\u4fee\u6539\u5b83\u81ea\u52a8\u751f\u6210\u7684\u4ee3\u7801\u6a21\u7248\u5462\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u627e\u5230<code>mybatis-plus-generator</code>\u7684\u6e90\u7801\uff1a</p> <p></p> <p>\u751f\u6210\u6a21\u7248\u90fd\u5728\u5728\u8fd9\u4e2a\u91cc\u9762\u6709\u5199\uff0c\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u53bb\u4fee\u6539\u8fd9\u4e9b\u6a21\u7248\uff0c\u53d8\u6210\u6211\u4eec\u81ea\u5df1\u5e0c\u671b\u7684\u6837\u5b50\uff0c\u7531\u4e8e\u9ed8\u8ba4\u7684\u6a21\u7248\u89e3\u6790\u5f15\u64ce\u4e3aVelocity\uff0c\u6211\u4eec\u9700\u8981\u590d\u5236\u4ee5<code>.vm</code>\u7ed3\u5c3e\u7684\u6587\u4ef6\u5230<code>resource</code>\u968f\u4fbf\u4e00\u4e2a\u76ee\u5f55\u4e2d\uff0c\u7136\u540e\u968f\u4fbf\u6539\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u914d\u7f6e\u4e00\u4e0b\u6a21\u7248\uff1a</p> <pre><code>@Test\nvoid contextLoads() {\n    FastAutoGenerator\n            ...\n                .strategyConfig(builder -&gt; {\n                builder\n                        .mapperBuilder()\n                        .enableFileOverride()   //\u5f00\u542f\u6587\u4ef6\u91cd\u5199\uff0c\u81ea\u52a8\u8986\u76d6\u65b0\u7684\n                        .mapperAnnotation(Mapper.class)\n                        .build();\n            })\n            .templateConfig(builder -&gt; {\n                builder.mapper(\"/template/mapper.java.vm\");\n            })\n            .execute();\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u65b0\u751f\u6210\u7684\u4ee3\u7801\u4e2d\u5c31\u662f\u6309\u7167\u6211\u4eec\u81ea\u5df1\u7684\u6a21\u7248\u6765\u5b9a\u4e49\u4e86:</p> <p></p> <p>\u6709\u4e86\u4ee3\u7801\u751f\u6210\u5668\uff0c\u6211\u4eec\u5de5 (\u5212) \u4f5c (\u6c34) \u6548\u7387\u66f4\u4e0a\u4e00\u5c42\u697c\u5566~</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#redis","title":"Redis\u4ea4\u4e92","text":"<p>Redis\u4e0eSpringBoot\u8fdb\u884c\u96c6\u6210\u8bf7\u5728Redis\u7bc7\u89c6\u9891\u6559\u7a0b\u4e2d\u8fdb\u884c\u89c2\u770b\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringBoot/SpringBoot%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E6%95%B0%E6%8D%AE%E4%BA%A4%E4%BA%92/#elasticsearch","title":"Elasticsearch\u4ea4\u4e92","text":"<p>Elasticsearch\u4e0eSpringBoot\u8fdb\u884c\u96c6\u6210\u8bf7\u5728Elasticsearch\u7bc7\u89c6\u9891\u6559\u7a0b\u4e2d\u8fdb\u884c\u89c2\u770b\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/","title":"SpringCloud\u7b14\u8bb0\uff08\u4e00\uff09","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_1","title":"\u5fae\u670d\u52a1\u57fa\u7840","text":"<p>\u6ce8\u610f\uff1a\u6b64\u9636\u6bb5\u5b66\u4e60\u63a8\u8350\u7684\u7535\u8111\u914d\u7f6e\uff0c\u81f3\u5c11\u914d\u59074\u6838\u5fc3CPU\uff08\u4e3b\u98913.0Ghz\u4ee5\u4e0a\uff09+16GB\u5185\u5b58\uff0c\u5426\u5219\u5361\u5230\u4f60\u6000\u7591\u4eba\u751f\u3002</p> <p>\u524d\u9762\u6211\u4eec\u8bb2\u89e3\u4e86SpringBoot\u6846\u67b6\uff0c\u901a\u8fc7\u4f7f\u7528SpringBoot\u6846\u67b6\uff0c\u6211\u4eec\u7684\u9879\u76ee\u5f00\u53d1\u901f\u5ea6\u53ef\u4ee5\u8bf4\u662f\u5f97\u5230\u4e86\u8d28\u7684\u63d0\u5347\u3002\u540c\u65f6\uff0c\u6211\u4eec\u5bf9\u4e8e\u9879\u76ee\u7684\u7ef4\u62a4\u548c\u7406\u89e3\uff0c\u4e5f\u4f1a\u66f4\u52a0\u7684\u8f7b\u677e\u3002\u53ef\u89c1\uff0cSpringBoot\u4e3a\u6211\u4eec\u7684\u5f00\u53d1\u5e26\u6765\u4e86\u5de8\u5927\u4fbf\u6377\u3002\u800c\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u57fa\u4e8eSpringBoot\uff0c\u7ee7\u7eed\u6df1\u5165\u5230\u4f01\u4e1a\u5b9e\u9645\u573a\u666f\uff0c\u63a2\u8ba8\u5fae\u670d\u52a1\u67b6\u6784\u4e0b\u7684SpringCloud\u3002\u8fd9\u4e2a\u90e8\u5206\u6211\u4eec\u4f1a\u66f4\u52a0\u6ce8\u91cd\u4e8e\u67b6\u6784\u8bbe\u8ba1\u4e0a\u7684\u8bb2\u89e3\uff0c\u5f31\u5316\u5b9e\u73b0\u539f\u7406\u65b9\u9762\u7684\u7814\u7a76\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_2","title":"\u4f20\u7edf\u9879\u76ee\u8f6c\u578b","text":"<p>\u8981\u8bf4\u8fd1\u51e0\u5e74\u6700\u706b\u70ed\u7684\u8bdd\u9898\uff0c\u90a3\u8fd8\u5f97\u662f\u5fae\u670d\u52a1\uff0c\u90a3\u4e48\u4ec0\u4e48\u662f\u5fae\u670d\u52a1\u5462\uff1f</p> <p>\u6211\u4eec\u53ef\u4ee5\u5148\u4ece\u6280\u672f\u7684\u6f14\u53d8\u5f00\u59cb\u770b\u8d77\uff0c\u5728\u6211\u4eec\u5b66\u4e60JavaWeb\u4e4b\u540e\uff0c\u4e00\u822c\u7684\u7f51\u7ad9\u5f00\u53d1\u6a21\u5f0f\u4e3aServlet+JSP\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u6211\u4eec\u5728\u5b66\u4e60\u4e86SSM\u4e4b\u540e\uff0c\u4f1a\u53d1\u73b0\u8fd9\u79cd\u6a21\u5f0f\u5df2\u7ecf\u8fdc\u8fdc\u843d\u540e\u4e86\uff0c\u7b2c\u4e00\uff0c\u4e00\u4e2a\u516c\u53f8\u4e0d\u53ef\u80fd\u53bb\u62db\u90a3\u4e48\u591a\u540c\u65f6\u4f1a\u524d\u7aef+\u540e\u7aef\u7684\u5f00\u53d1\u4eba\u5458\uff0c\u5c31\u7b97\u62db\u5230\uff0c\u4e5f\u5e76\u4e0d\u4e00\u5b9a\u80fd\u4fdd\u8bc1\u4e24\u4e2a\u65b9\u9762\u90fd\u6bd4\u8f83\u64c5\u957f\uff0c\u76f8\u6bd4\u524d\u540e\u7aef\u5206\u5f00\u5b66\u4e60\u7684\u5f00\u53d1\u4eba\u5458\uff0c\u663e\u7136\u540e\u8005\u7684\u5b66\u4e60\u6210\u672c\u66f4\u4f4e\uff0c\u4e13\u6ce8\u5ea6\u66f4\u9ad8\u3002\u56e0\u6b64\u524d\u540e\u7aef\u5206\u79bb\u6210\u4e3a\u4e86\u4e00\u79cd\u65b0\u7684\u8d8b\u52bf\u3002\u901a\u8fc7\u4f7f\u7528SpringBoot\uff0c\u6211\u4eec\u51e0\u4e4e\u53ef\u4ee5\u5f88\u5feb\u901f\u5730\u5f00\u53d1\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u5355\u4f53\u5e94\u7528\uff0c\u53ea\u9700\u8981\u542f\u52a8\u4e00\u4e2a\u670d\u52a1\u7aef\uff0c\u6211\u4eec\u6574\u4e2a\u9879\u76ee\u5c31\u5f00\u59cb\u8fd0\u884c\u4e86\uff0c\u5404\u9879\u529f\u80fd\u878d\u4e8e\u4e00\u4f53\uff0c\u5f00\u53d1\u8d77\u6765\u4e5f\u66f4\u52a0\u8f7b\u677e\u3002</p> <p>\u4f46\u662f\u968f\u7740\u6211\u4eec\u9879\u76ee\u7684\u4e0d\u65ad\u6269\u5927\uff0c\u5355\u4f53\u5e94\u7528\u4f3c\u4e4e\u663e\u5f97\u6709\u70b9\u4e4f\u529b\u4e86\u3002</p> <p>\u968f\u7740\u8d8a\u6765\u8d8a\u591a\u7684\u529f\u80fd\u4e0d\u65ad\u5730\u52a0\u5165\u5230\u4e00\u4e2aSpringBoot\u9879\u76ee\u4e2d\uff0c\u968f\u7740\u63a5\u53e3\u4e0d\u65ad\u589e\u52a0\uff0c\u6574\u4e2a\u7cfb\u7edf\u5c31\u8981\u5728\u540c\u4e00\u65f6\u95f4\u5185\u54cd\u5e94\u66f4\u591a\u7c7b\u578b\u7684\u8bf7\u6c42\uff0c\u663e\u7136\uff0c\u8fd9\u79cd\u6269\u5c55\u65b9\u5f0f\u662f\u4e0d\u53ef\u80fd\u65e0\u9650\u4f7f\u7528\u4e0b\u53bb\u7684\uff0c\u603b\u6709\u4e00\u5929\uff0c\u8fd9\u4e2aSpringBoot\u9879\u76ee\u4f1a\u5e9e\u5927\u5230\u8fd0\u884c\u7f13\u6162\u3002\u5e76\u4e14\u6240\u6709\u7684\u529f\u80fd\u5982\u679c\u90fd\u96c6\u6210\u5728\u5355\u7aef\u4e0a\uff0c\u90a3\u4e48\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u4f1a\u5168\u90e8\u6c47\u96c6\u5230\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\uff0c\u5bf9\u6b64\u670d\u52a1\u5668\u9020\u6210\u5de8\u5927\u538b\u529b\u3002</p> <p>\u53ef\u4ee5\u8bd5\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u6211\u4eec\u7684\u7535\u8111\u5df2\u7ecf\u5347\u7ea7\u5230i9-12900K\uff0c\u4f46\u662f\u4f9d\u7136\u5728\u8fd0\u884c\u9879\u76ee\u7684\u65f6\u5019\u7f13\u6162\uff0c\u65e0\u6cd5\u540c\u4e00\u65f6\u95f4\u54cd\u5e94\u6210\u5343\u4e0a\u4e07\u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u8fd9\u4e2a\u95ee\u9898\u5c31\u5df2\u7ecf\u4e0d\u662f\u5355\u7eaf\u5347\u7ea7\u673a\u5668\u914d\u7f6e\u53ef\u4ee5\u89e3\u51b3\u7684\u4e86\u3002</p> <p></p> <p>\u4f20\u7edf\u5355\u4f53\u67b6\u6784\u5e94\u7528\u968f\u7740\u9879\u76ee\u89c4\u6a21\u7684\u6269\u5927\uff0c\u5b9e\u9645\u4e0a\u4f1a\u66b4\u9732\u8d8a\u6765\u8d8a\u591a\u7684\u95ee\u9898\uff0c\u5c24\u5176\u662f\u4e00\u53f0\u670d\u52a1\u5668\u65e0\u6cd5\u627f\u53d7\u5e9e\u5927\u7684\u5355\u4f53\u5e94\u7528\u90e8\u7f72\uff0c\u5e76\u4e14\u5355\u4f53\u5e94\u7528\u7684\u7ef4\u62a4\u4e5f\u4f1a\u8d8a\u6765\u8d8a\u56f0\u96be\uff0c\u6211\u4eec\u5f97\u5bfb\u627e\u4e00\u79cd\u65b0\u7684\u5f00\u53d1\u67b6\u6784\u6765\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u4e86\u3002</p> <p>In short, the microservice architectural style is an approach to developing a single application as a suite of small services, each running in its own process and communicating with lightweight mechanisms, often an HTTP resource API. These services are built around business capabilities and independently deployable by fully automated deployment machinery. There is a bare minimum of centralized management of these services, which may be written in different programming languages and use different data storage technologies.</p> <p>Martin Fowler\u57282014\u5e74\u63d0\u51fa\u4e86\u201c\u5fae\u670d\u52a1\u201d\u67b6\u6784\uff0c\u5b83\u662f\u4e00\u79cd\u5168\u65b0\u7684\u67b6\u6784\u98ce\u683c\u3002</p> <ul> <li>\u5fae\u670d\u52a1\u628a\u4e00\u4e2a\u5e9e\u5927\u7684\u5355\u4f53\u5e94\u7528\u62c6\u5206\u4e3a\u4e00\u4e2a\u4e2a\u7684\u5c0f\u578b\u670d\u52a1\uff0c\u6bd4\u5982\u6211\u4eec\u539f\u6765\u7684\u56fe\u4e66\u7ba1\u7406\u9879\u76ee\u4e2d\uff0c\u6709\u767b\u5f55\u3001\u6ce8\u518c\u3001\u6dfb\u52a0\u3001\u5220\u9664\u3001\u641c\u7d22\u7b49\u529f\u80fd\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u529f\u80fd\u5355\u72ec\u505a\u6210\u4e00\u4e2a\u4e2a\u5c0f\u578b\u7684SpringBoot\u9879\u76ee\uff0c\u72ec\u7acb\u8fd0\u884c\u3002</li> <li>\u6bcf\u4e2a\u5c0f\u578b\u7684\u5fae\u670d\u52a1\uff0c\u90fd\u53ef\u4ee5\u72ec\u7acb\u90e8\u7f72\u548c\u5347\u7ea7\uff0c\u8fd9\u6837\uff0c\u5c31\u7b97\u6574\u4e2a\u7cfb\u7edf\u5d29\u6e83\uff0c\u90a3\u4e48\u4e5f\u53ea\u4f1a\u5f71\u54cd\u4e00\u4e2a\u670d\u52a1\u7684\u8fd0\u884c\u3002</li> <li>\u5fae\u670d\u52a1\u4e4b\u95f4\u4f7f\u7528HTTP\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\uff0c\u4e0d\u518d\u662f\u5355\u4f53\u5e94\u7528\u5185\u90e8\u4ea4\u4e92\u4e86\uff0c\u867d\u7136\u8fd9\u6837\u4f1a\u663e\u5f97\u66f4\u9ebb\u70e6\uff0c\u4f46\u662f\u5e26\u6765\u7684\u597d\u5904\u4e5f\u662f\u5f88\u76f4\u63a5\u7684\uff0c\u751a\u81f3\u80fd\u7a81\u7834\u8bed\u8a00\u9650\u5236\uff0c\u4f7f\u7528\u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u8fdb\u884c\u5fae\u670d\u52a1\u5f00\u53d1\uff0c\u53ea\u9700\u8981\u4f7f\u7528HTTP\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\u5373\u53ef\u3002</li> <li>\u6211\u4eec\u53ef\u4ee5\u540c\u65f6\u8d2d\u4e70\u591a\u53f0\u4e3b\u673a\u6765\u5206\u522b\u90e8\u7f72\u8fd9\u4e9b\u5fae\u670d\u52a1\uff0c\u8fd9\u6837\uff0c\u5355\u673a\u7684\u538b\u529b\u5c31\u88ab\u5206\u6563\u5230\u591a\u53f0\u673a\u5668\uff0c\u5e76\u4e14\u6bcf\u53f0\u673a\u5668\u7684\u914d\u7f6e\u4e0d\u4e00\u5b9a\u9700\u8981\u592a\u9ad8\uff0c\u8fd9\u6837\u5c31\u80fd\u8282\u7701\u5927\u91cf\u7684\u6210\u672c\uff0c\u540c\u65f6\u5b89\u5168\u6027\u4e5f\u5f97\u5230\u5f88\u5927\u7684\u4fdd\u8bc1\u3002</li> <li>\u751a\u81f3\u540c\u4e00\u4e2a\u5fae\u670d\u52a1\u53ef\u4ee5\u540c\u65f6\u5b58\u5728\u591a\u4e2a\uff0c\u8fd9\u6837\u5f53\u5176\u4e2d\u4e00\u4e2a\u670d\u52a1\u5668\u51fa\u73b0\u95ee\u9898\u65f6\uff0c\u5176\u4ed6\u670d\u52a1\u5668\u4e5f\u5728\u8fd0\u884c\u540c\u6837\u7684\u5fae\u670d\u52a1\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u4e00\u4e2a\u5fae\u670d\u52a1\u7684\u9ad8\u53ef\u7528\u3002</li> </ul> <p></p> <p>\u5f53\u7136\uff0c\u8fd9\u91cc\u53ea\u662f\u7b80\u5355\u7684\u6f14\u793a\u4e00\u4e0b\u5fae\u670d\u52a1\u67b6\u6784\uff0c\u5b9e\u9645\u5f00\u53d1\u4e2d\u80af\u5b9a\u662f\u6bd4\u8fd9\u4e2a\u590d\u6742\u5f97\u591a\u7684\u3002</p> <p>\u53ef\u89c1\uff0c\u91c7\u7528\u5fae\u670d\u52a1\u67b6\u6784\uff0c\u66f4\u52a0\u80fd\u591f\u5e94\u5bf9\u5f53\u4eca\u65f6\u4ee3\u4e0b\u7684\u79cd\u79cd\u8003\u9a8c\uff0c\u4f20\u7edf\u9879\u76ee\u7684\u5f00\u53d1\u6a21\u5f0f\uff0c\u9700\u8981\u8fdb\u884c\u67b6\u6784\u4e0a\u7684\u5347\u7ea7\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#springcloud","title":"\u8d70\u8fdbSpringCloud","text":"<p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86\u5fae\u670d\u52a1\u67b6\u6784\u7684\u4f18\u70b9\uff0c\u90a3\u4e48\u540c\u6837\u7684\uff0c\u8fd9\u4e9b\u4f18\u70b9\u7684\u80cc\u540e\u4e5f\u5b58\u5728\u7740\u8bf8\u591a\u7684\u95ee\u9898\uff1a</p> <ul> <li>\u8981\u5b9e\u73b0\u5fae\u670d\u52a1\u5e76\u4e0d\u662f\u8bf4\u53ea\u9700\u8981\u7b80\u5355\u5730\u5c06\u9879\u76ee\u8fdb\u884c\u62c6\u5206\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u8003\u8651\u5bf9\u5404\u4e2a\u5fae\u670d\u52a1\u8fdb\u884c\u7ba1\u7406\u3001\u76d1\u63a7\u7b49\uff0c\u8fd9\u6837\u6211\u4eec\u624d\u80fd\u591f\u53ca\u65f6\u5730\u5bfb\u627e\u548c\u6392\u67e5\u95ee\u9898\u3002\u56e0\u6b64\u5fae\u670d\u52a1\u5f80\u5f80\u9700\u8981\u7684\u662f\u4e00\u6574\u5957\u89e3\u51b3\u65b9\u6848\uff0c\u5305\u62ec\u670d\u52a1\u6ce8\u518c\u548c\u53d1\u73b0\u3001\u5bb9\u707e\u5904\u7406\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u914d\u7f6e\u7ba1\u7406\u7b49\u3002</li> <li>\u5b83\u4e0d\u50cf\u5355\u4f53\u67b6\u6784\u90a3\u79cd\u65b9\u4fbf\u7ef4\u62a4\uff0c\u7531\u4e8e\u90e8\u7f72\u5728\u591a\u4e2a\u670d\u52a1\u5668\uff0c\u6211\u4eec\u4e0d\u5f97\u4e0d\u53bb\u4fdd\u8bc1\u5404\u4e2a\u5fae\u670d\u52a1\u80fd\u591f\u7a33\u5b9a\u8fd0\u884c\uff0c\u5728\u7ba1\u7406\u96be\u5ea6\u4e0a\u80af\u5b9a\u662f\u9ad8\u4e8e\u4f20\u7edf\u5355\u4f53\u5e94\u7528\u7684\u3002</li> <li>\u5728\u5206\u5e03\u5f0f\u7684\u73af\u5883\u4e0b\uff0c\u5355\u4f53\u5e94\u7528\u7684\u67d0\u4e9b\u529f\u80fd\u53ef\u80fd\u4f1a\u53d8\u5f97\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6bd4\u5982\u5206\u5e03\u5f0f\u4e8b\u52a1\u3002</li> </ul> <p>\u6240\u4ee5\uff0c\u4e3a\u4e86\u66f4\u597d\u5730\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff0cSpringCloud\u6b63\u5f0f\u767b\u573a\u3002</p> <p>SpringCloud\u662fSpring\u63d0\u4f9b\u7684\u4e00\u5957\u5206\u5e03\u5f0f\u89e3\u51b3\u65b9\u6848\uff0c\u96c6\u5408\u4e86\u4e00\u4e9b\u5927\u578b\u4e92\u8054\u7f51\u516c\u53f8\u7684\u5f00\u6e90\u4ea7\u54c1\uff0c\u5305\u62ec\u8bf8\u591a\u7ec4\u4ef6\uff0c\u5171\u540c\u7ec4\u6210SpringCloud\u6846\u67b6\u3002\u5e76\u4e14\uff0c\u5b83\u5229\u7528Spring Boot\u7684\u5f00\u53d1\u4fbf\u5229\u6027\u5de7\u5999\u5730\u7b80\u5316\u4e86\u5206\u5e03\u5f0f\u7cfb\u7edf\u57fa\u7840\u8bbe\u65bd\u7684\u5f00\u53d1\uff0c\u5982\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u3001\u914d\u7f6e\u4e2d\u5fc3\u3001\u6d88\u606f\u603b\u7ebf\u3001\u8d1f\u8f7d\u5747\u8861\u3001\u7194\u65ad\u673a\u5236\u3001\u6570\u636e\u76d1\u63a7\u7b49\uff0c\u90fd\u53ef\u4ee5\u7528Spring Boot\u7684\u5f00\u53d1\u98ce\u683c\u505a\u5230\u4e00\u952e\u542f\u52a8\u548c\u90e8\u7f72\u3002</p> <p>\u7531\u4e8e\u4e2d\u5c0f\u578b\u516c\u53f8\u6ca1\u6709\u72ec\u7acb\u5f00\u53d1\u81ea\u5df1\u7684\u5206\u5e03\u5f0f\u57fa\u7840\u8bbe\u65bd\u7684\u80fd\u529b\uff0c\u4f7f\u7528SpringCloud\u89e3\u51b3\u65b9\u6848\u80fd\u591f\u4ee5\u6700\u4f4e\u7684\u6210\u672c\u5e94\u5bf9\u5f53\u524d\u65f6\u4ee3\u7684\u4e1a\u52a1\u53d1\u5c55\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0cSpringCloud\u6574\u4f53\u67b6\u6784\u7684\u4eae\u70b9\u662f\u975e\u5e38\u660e\u663e\u7684\uff0c\u5206\u5e03\u5f0f\u67b6\u6784\u4e0b\u7684\u5404\u4e2a\u573a\u666f\uff0c\u90fd\u6709\u5bf9\u5e94\u7684\u7ec4\u4ef6\u6765\u5904\u7406\uff0c\u6bd4\u5982\u57fa\u4e8eNetflix\uff08\u5948\u98de\uff09\u7684\u5f00\u6e90\u5206\u5e03\u5f0f\u89e3\u51b3\u65b9\u6848\u63d0\u4f9b\u7684\u7ec4\u4ef6\uff1a</p> <ul> <li>Eureka  -  \u5b9e\u73b0\u670d\u52a1\u6cbb\u7406\uff08\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u6240\u6709\u7684\u5fae\u670d\u52a1\u8fdb\u884c\u96c6\u4e2d\u7ba1\u7406\uff0c\u5305\u62ec\u4ed6\u4eec\u7684\u8fd0\u884c\u72b6\u6001\u3001\u4fe1\u606f\u7b49\u3002</li> <li>Ribbon  -  \u4e3a\u670d\u52a1\u4e4b\u95f4\u76f8\u4e92\u8c03\u7528\u63d0\u4f9b\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff08\u73b0\u5728\u88abSpringCloudLoadBalancer\u53d6\u4ee3\uff09</li> <li>Hystrix  -  \u65ad\u8def\u5668\uff0c\u4fdd\u62a4\u7cfb\u7edf\uff0c\u63a7\u5236\u6545\u969c\u8303\u56f4\u3002\u6682\u65f6\u53ef\u4ee5\u8ddf\u5bb6\u91cc\u7535\u95f8\u7684\u4fdd\u9669\u4e1d\u7c7b\u6bd4\uff0c\u5f53\u89e6\u7535\u5371\u9669\u53d1\u751f\u65f6\u80fd\u591f\u9632\u6b62\u8fdb\u4e00\u6b65\u7684\u53d1\u5c55\u3002</li> <li>Zuul   -     api\u7f51\u5173\uff0c\u8def\u7531\uff0c\u8d1f\u8f7d\u5747\u8861\u7b49\u591a\u79cd\u4f5c\u7528\uff0c\u5c31\u50cf\u6211\u4eec\u7684\u8def\u7531\u5668\uff0c\u53ef\u80fd\u6709\u5f88\u591a\u4e2a\u8bbe\u5907\u90fd\u8fde\u63a5\u4e86\u8def\u7531\u5668\uff0c\u4f46\u662f\u6570\u636e\u5305\u8981\u8f6c\u53d1\u7ed9\u8c01\u5219\u662f\u7531\u8def\u7531\u5668\u5728\u8fdb\u884c\uff08\u5df2\u7ecf\u88abSpringCloudGateway\u53d6\u4ee3\uff09</li> <li>Config  -  \u914d\u7f6e\u7ba1\u7406\uff0c\u53ef\u4ee5\u5b9e\u73b0\u914d\u7f6e\u6587\u4ef6\u96c6\u4e2d\u7ba1\u7406</li> </ul> <p>\u5f53\u7136\uff0c\u8fd9\u91cc\u53ea\u662f\u8fdb\u884c\u7b80\u5355\u7684\u4e86\u89e3\u5373\u53ef\uff0c\u5b9e\u9645\u4e0a\u5fae\u670d\u52a1\u7684\u73a9\u6cd5\u975e\u5e38\u591a\uff0c\u6211\u4eec\u540e\u9762\u7684\u5b66\u4e60\u4e2d\u5c06\u4f1a\u9010\u6b65\u8fdb\u884c\u63a2\u7d22\u3002</p> <p>\u90a3\u4e48\u9996\u5148\uff0c\u6211\u4eec\u5c31\u4ece\u6ce8\u518c\u4e2d\u5fc3\u5f00\u59cb\u8bf4\u8d77\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#eureka","title":"Eureka \u6ce8\u518c\u4e2d\u5fc3","text":"<p>\u5b98\u65b9\u6587\u6863\uff1ahttps://docs.spring.io/spring-cloud-netflix/docs/current/reference/html/</p> <p>\u5c0f\u8d34\u58eb\uff1a\u5404\u4f4d\u5c0f\u4f19\u4f34\u5728\u5b66\u4e60\u7684\u8fc7\u7a0b\u4e2d\u89c9\u5f97\u6709\u4ec0\u4e48\u7591\u60d1\u7684\u53ef\u4ee5\u76f4\u63a5\u67e5\u9605\u5b98\u65b9\u6587\u6863\uff0c\u6211\u4eec\u4f1a\u5728\u6bcf\u4e00\u4e2a\u6280\u672f\u5f00\u59cb\u4e4b\u524d\u8d34\u4e0a\u5b98\u65b9\u6587\u6863\u7684\u5730\u5740\uff0c\u65b9\u4fbf\u5404\u4f4d\u8fdb\u884c\u67e5\u9605\uff0c\u540c\u65f6\u5728\u6211\u4eec\u7684\u8bfe\u7a0b\u4e2d\u5e76\u4e0d\u4e00\u5b9a\u4f1a\u5b8c\u5b8c\u6574\u6574\u5730\u8bb2\u5b8c\u6574\u4e2a\u6846\u67b6\u7684\u5185\u5bb9\uff0c\u6709\u5173\u8be6\u7ec6\u7684\u529f\u80fd\u548c\u4f7f\u7528\u65b9\u6cd5\u6587\u6863\u4e2d\u4e5f\u662f\u5199\u7684\u975e\u5e38\u6e05\u695a\u7684\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u6df1\u5165\u5b66\u4e60\u54e6\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_3","title":"\u5fae\u670d\u52a1\u9879\u76ee\u7ed3\u6784","text":"<p>\u73b0\u5728\u6211\u4eec\u91cd\u65b0\u8bbe\u8ba1\u4e00\u4e0b\u4e4b\u524d\u7684\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u9879\u76ee\uff0c\u5c06\u539f\u6709\u7684\u5927\u578b\uff08\u4e5f\u8bb8 \u9879\u76ee\u8fdb\u884c\u62c6\u5206\uff0c\u6ce8\u610f\u9879\u76ee\u62c6\u5206\u4e00\u5b9a\u8981\u5c3d\u53ef\u80fd\u4fdd\u8bc1\u5355\u4e00\u804c\u8d23\uff0c\u76f8\u540c\u7684\u4e1a\u52a1\u4e0d\u8981\u5728\u591a\u4e2a\u5fae\u670d\u52a1\u4e2d\u91cd\u590d\u51fa\u73b0\uff0c\u5982\u679c\u51fa\u73b0\u9700\u8981\u501f\u52a9\u5176\u4ed6\u4e1a\u52a1\u5b8c\u6210\u7684\u670d\u52a1\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528\u670d\u52a1\u4e4b\u95f4\u76f8\u4e92\u8c03\u7528\u7684\u5f62\u5f0f\u6765\u5b9e\u73b0\uff08\u4e4b\u540e\u4f1a\u4ecb\u7ecd\uff09\uff1a</p> <ul> <li>\u767b\u5f55\u9a8c\u8bc1\u670d\u52a1\uff1a\u7528\u4e8e\u5904\u7406\u7528\u6237\u6ce8\u518c\u3001\u767b\u5f55\u3001\u5bc6\u7801\u91cd\u7f6e\u7b49\uff0c\u53cd\u6b63\u5c31\u662f\u4e00\u5207\u4e0e\u8d26\u6237\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u5305\u62ec\u7528\u6237\u4fe1\u606f\u83b7\u53d6\u7b49\u3002</li> <li>\u56fe\u4e66\u7ba1\u7406\u670d\u52a1\uff1a\u7528\u4e8e\u8fdb\u884c\u56fe\u4e66\u6dfb\u52a0\u3001\u5220\u9664\u3001\u66f4\u65b0\u7b49\u64cd\u4f5c\uff0c\u56fe\u4e66\u7ba1\u7406\u76f8\u5173\u7684\u670d\u52a1\uff0c\u5305\u62ec\u56fe\u4e66\u7684\u5b58\u50a8\u7b49\u548c\u4fe1\u606f\u83b7\u53d6\u3002</li> <li>\u56fe\u4e66\u501f\u9605\u670d\u52a1\uff1a\u4ea4\u4e92\u6027\u6bd4\u8f83\u5f3a\u7684\u670d\u52a1\uff0c\u9700\u8981\u548c\u767b\u9646\u9a8c\u8bc1\u670d\u52a1\u548c\u56fe\u4e66\u7ba1\u7406\u670d\u52a1\u8fdb\u884c\u4ea4\u4e92\u3002</li> </ul> <p>\u90a3\u4e48\u65e2\u7136\u8981\u5c06\u5355\u4f53\u5e94\u7528\u62c6\u5206\u4e3a\u591a\u4e2a\u5c0f\u578b\u670d\u52a1\uff0c\u6211\u4eec\u5c31\u9700\u8981\u91cd\u65b0\u8bbe\u8ba1\u4e00\u4e0b\u6574\u4e2a\u9879\u76ee\u76ee\u5f55\u7ed3\u6784\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u521b\u5efa\u591a\u4e2a\u5b50\u9879\u76ee\uff0c\u6bcf\u4e00\u4e2a\u5b50\u9879\u76ee\u90fd\u662f\u4e00\u4e2a\u670d\u52a1\uff0c\u8fd9\u6837\u7531\u7236\u9879\u76ee\u7edf\u4e00\u7ba1\u7406\u4f9d\u8d56\uff0c\u5c31\u65e0\u9700\u6bcf\u4e2a\u5b50\u9879\u76ee\u90fd\u53bb\u5355\u72ec\u7ba1\u7406\u4f9d\u8d56\u4e86\uff0c\u4e5f\u66f4\u65b9\u4fbf\u4e00\u70b9\u3002</p> <p>\u6211\u4eec\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u666e\u901a\u7684SpringBoot\u9879\u76ee\uff1a</p> <p></p> <p>\u7136\u540e\u4e0d\u9700\u8981\u52fe\u9009\u4efb\u4f55\u4f9d\u8d56\uff0c\u76f4\u63a5\u521b\u5efa\u5373\u53ef\uff0c\u9879\u76ee\u521b\u5efa\u5b8c\u6210\u5e76\u521d\u59cb\u5316\u540e\uff0c\u6211\u4eec\u5220\u9664\u7236\u5de5\u7a0b\u7684\u65e0\u7528\u6587\u4ef6\uff0c\u53ea\u4fdd\u7559\u5fc5\u8981\u6587\u4ef6\uff0c\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u6309\u7167\u6211\u4eec\u5212\u5206\u7684\u670d\u52a1\uff0c\u8fdb\u884c\u5b50\u5de5\u7a0b\u521b\u5efa\u4e86\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Maven\u9879\u76ee\uff0c\u6ce8\u610f\u7236\u9879\u76ee\u8981\u6307\u5b9a\u4e3a\u6211\u4eec\u4e00\u5f00\u59cb\u521b\u5efa\u7684\u7684\u9879\u76ee\uff0c\u5b50\u9879\u76ee\u547d\u540d\u968f\u610f\uff1a</p> <p></p> <p>\u5b50\u9879\u76ee\u521b\u5efa\u597d\u4e4b\u540e\uff0c\u63a5\u7740\u6211\u4eec\u5728\u5b50\u9879\u76ee\u4e2d\u521b\u5efaSpringBoot\u7684\u542f\u52a8\u4e3b\u7c7b\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u70b9\u51fb\u8fd0\u884c\uff0c\u5373\u53ef\u542f\u52a8\u5b50\u9879\u76ee\u4e86\uff0c\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u5b50\u9879\u76ee\u5c31\u4e00\u4e2a\u6700\u7b80\u5355\u7684SpringBoot web\u9879\u76ee\uff0c\u6ce8\u610f\u542f\u52a8\u4e4b\u540e\u6700\u4e0b\u65b9\u6709\u5f39\u7a97\uff0c\u6211\u4eec\u70b9\u51fb\"\u4f7f\u7528 \u670d\u52a1\"\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9e\u65f6\u67e5\u770b\u5f53\u524d\u6574\u4e2a\u5927\u9879\u76ee\u4e2d\u6709\u54ea\u4e9b\u5fae\u670d\u52a1\u4e86\uff1a</p> <p></p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u4ee5\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u521b\u5efa\u5176\u4ed6\u7684\u5b50\u9879\u76ee\uff0c\u6ce8\u610f\u6211\u4eec\u6700\u597d\u5c06\u5176\u4ed6\u5b50\u9879\u76ee\u7684\u7aef\u53e3\u8bbe\u7f6e\u5f97\u4e0d\u4e00\u6837\uff0c\u4e0d\u7136\u4f1a\u5bfc\u81f4\u7aef\u53e3\u5360\u7528\uff0c\u6211\u4eec\u5206\u522b\u4e3a\u5b83\u4eec\u521b\u5efa<code>application.yml</code>\u6587\u4ef6\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u6765\u5c1d\u8bd5\u542f\u52a8\u4e00\u4e0b\u8fd9\u4e09\u4e2a\u670d\u52a1\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u90fd\u662f\u53ef\u4ee5\u76f4\u63a5\u542f\u52a8\u7684\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5b83\u4eec\u5206\u522b\u8fd0\u884c\u5728\u4e0d\u540c\u7684\u7aef\u53e3\u4e0a\uff0c\u8fd9\u6837\uff0c\u5c31\u65b9\u4fbf\u4e0d\u540c\u7684\u7a0b\u5e8f\u5458\u7f16\u5199\u4e0d\u540c\u7684\u670d\u52a1\u4e86\uff0c\u63d0\u4ea4\u5f53\u524d\u9879\u76ee\u4ee3\u7801\u65f6\u7684\u51b2\u7a81\u7387\u4e5f\u4f1a\u964d\u4f4e\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u6765\u521b\u5efa\u4e00\u4e0b\u6570\u636e\u5e93\uff0c\u8fd9\u91cc\u8fd8\u662f\u8001\u6837\u5b50\uff0c\u521b\u5efa\u4e09\u4e2a\u8868\u5373\u53ef\uff0c\u5f53\u7136\u5b9e\u9645\u4e0a\u6bcf\u4e2a\u5fae\u670d\u52a1\u5355\u72ec\u4f7f\u7528\u4e00\u4e2a\u6570\u636e\u5e93\u670d\u52a1\u5668\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u56e0\u4e3a\u6309\u7167\u5355\u4e00\u804c\u8d23\u670d\u52a1\u53ea\u4f1a\u64cd\u4f5c\u81ea\u5df1\u5bf9\u5e94\u7684\u8868\uff0c\u8fd9\u91ccUP\u4e3b\u6bd4\u8f83\u7a77\uff0c\u5c31\u53ea\u7528\u4e00\u4e2a\u6570\u636e\u5e93\u6f14\u793a\u4e86\uff1a</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u521b\u5efa\u597d\u4e4b\u540e\uff0c\u7ed3\u679c\u5982\u4e0b\uff0c\u4e00\u5171\u4e09\u5f20\u8868\uff0c\u5404\u4f4d\u53ef\u4ee5\u81ea\u884c\u6dfb\u52a0\u4e00\u4e9b\u6570\u636e\u5230\u91cc\u9762\uff0c\u8fd9\u5c31\u4e0d\u8d34\u51fa\u6765\u4e86\uff1a</p> <p></p> <p>\u5982\u679c\u5404\u4f4d\u5acc\u9ebb\u70e6\u7684\u8bdd\u53ef\u4ee5\u4e0b\u8f7d<code>.sql</code>\u6587\u4ef6\u81ea\u884c\u5bfc\u5165\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u6765\u7a0d\u5fae\u5199\u4e00\u70b9\u4e1a\u52a1\uff0c\u6bd4\u5982\u7528\u6237\u4fe1\u606f\u67e5\u8be2\u4e1a\u52a1\uff0c\u6211\u4eec\u5148\u628a\u6570\u636e\u5e93\u76f8\u5173\u7684\u4f9d\u8d56\u8fdb\u884c\u5bfc\u5165\uff0c\u8fd9\u91cc\u4f9d\u7136\u4f7f\u7528Mybatis\u6846\u67b6\uff0c\u9996\u5148\u5728\u7236\u9879\u76ee\u4e2d\u6dfb\u52a0MySQL\u9a71\u52a8\u548cLombok\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;mysql&lt;/groupId&gt;\n    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n     &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n     &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7531\u4e8e\u4e0d\u662f\u6240\u6709\u7684\u5b50\u9879\u76ee\u90fd\u9700\u8981\u7528\u5230Mybatis\uff0c\u6211\u4eec\u5728\u7236\u9879\u76ee\u4e2d\u53ea\u8fdb\u884c\u7248\u672c\u7ba1\u7406\u5373\u53ef\uff1a</p> <pre><code>&lt;dependencyManagement&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;\n            &lt;version&gt;2.2.0&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/dependencyManagement&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u7528\u6237\u670d\u52a1\u5b50\u9879\u76ee\u4e2d\u6dfb\u52a0\u6b64\u4f9d\u8d56\u4e86\uff1a</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre> <p>\u63a5\u7740\u6dfb\u52a0\u6570\u636e\u6e90\u4fe1\u606f\uff08UP\u7528\u5230\u662f\u963f\u91cc\u4e91\u7684MySQL\u4e91\u6570\u636e\u5e93\uff0c\u5404\u4f4d\u6ce8\u610f\u4fee\u6539\u4e00\u4e0b\u6570\u636e\u5e93\u5730\u5740\uff09\uff1a</p> <pre><code>spring:\n  datasource:\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    url: jdbc:mysql://cloudstudy.mysql.cn-chengdu.rds.aliyuncs.com:3306/cloudstudy\n    username: test\n    password: 123456\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u5199\u7528\u6237\u67e5\u8be2\u76f8\u5173\u7684\u4e1a\u52a1\uff1a</p> <pre><code>@Data\npublic class User {\n    int uid;\n    String name;\n    String sex;\n}\n</code></pre> <pre><code>@Mapper\npublic interface UserMapper {\n    @Select(\"select * from DB_USER where uid = #{uid}\")\n    User getUserById(int uid);\n}\n</code></pre> <pre><code>public interface UserService {\n    User getUserById(int uid);\n}\n</code></pre> <pre><code>@Service\npublic class UserServiceImpl implements UserService {\n\n    @Resource\n    UserMapper mapper;\n\n    @Override\n    public User getUserById(int uid) {\n        return mapper.getUserById(uid);\n    }\n}\n</code></pre> <pre><code>@RestController\npublic class UserController {\n\n    @Resource\n    UserService service;\n\n    //\u8fd9\u91cc\u4ee5RESTFul\u98ce\u683c\u4e3a\u4f8b\n    @RequestMapping(\"/user/{uid}\")\n    public User findUserById(@PathVariable(\"uid\") int uid){\n        return service.getUserById(uid);\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u8bbf\u95ee\u5373\u53ef\u62ff\u5230\u6570\u636e\uff1a</p> <p></p> <p>\u540c\u6837\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u5b8c\u6210\u4e00\u4e0b\u56fe\u4e66\u67e5\u8be2\u4e1a\u52a1\uff0c\u6ce8\u610f\u73b0\u5728\u662f\u5728\u56fe\u4e66\u7ba1\u7406\u5fae\u670d\u52a1\u4e2d\u7f16\u5199\uff08\u522b\u5fd8\u4e86\u5bfc\u5165Mybatis\u4f9d\u8d56\u4ee5\u53ca\u914d\u7f6e\u6570\u636e\u6e90\uff09\uff1a</p> <pre><code>@Data\npublic class Book {\n    int bid;\n    String title;\n    String desc;\n}\n</code></pre> <pre><code>@Mapper\npublic interface BookMapper {\n\n    @Select(\"select * from DB_BOOK where bid = #{bid}\")\n    Book getBookById(int bid);\n}\n</code></pre> <pre><code>public interface BookService {\n    Book getBookById(int bid);\n}\n</code></pre> <pre><code>@Service\npublic class BookServiceImpl implements BookService {\n\n    @Resource\n    BookMapper mapper;\n\n    @Override\n    public Book getBookById(int bid) {\n        return mapper.getBookById(bid);\n    }\n}\n</code></pre> <pre><code>@RestController\npublic class BookController {\n\n    @Resource\n    BookService service;\n\n    @RequestMapping(\"/book/{bid}\")\n    Book findBookById(@PathVariable(\"bid\") int bid){\n        return service.getBookById(bid);\n    }\n}\n</code></pre> <p>\u540c\u6837\u8fdb\u884c\u4e00\u4e0b\u6d4b\u8bd5\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u4e00\u4e2a\u5b8c\u6574\u9879\u76ee\u7684\u5c31\u62c6\u5206\u6210\u4e86\u591a\u4e2a\u5fae\u670d\u52a1\uff0c\u4e0d\u540c\u5fae\u670d\u52a1\u4e4b\u95f4\u662f\u72ec\u7acb\u8fdb\u884c\u5f00\u53d1\u548c\u90e8\u7f72\u7684\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_4","title":"\u670d\u52a1\u95f4\u8c03\u7528","text":"<p>\u524d\u9762\u6211\u4eec\u5b8c\u6210\u4e86\u7528\u6237\u4fe1\u606f\u67e5\u8be2\u548c\u56fe\u4e66\u4fe1\u606f\u67e5\u8be2\uff0c\u73b0\u5728\u6211\u4eec\u6765\u63a5\u7740\u5b8c\u6210\u501f\u9605\u670d\u52a1\u3002</p> <p>\u501f\u9605\u670d\u52a1\u662f\u4e00\u4e2a\u5173\u8054\u6027\u6bd4\u8f83\u5f3a\u7684\u670d\u52a1\uff0c\u5b83\u4e0d\u4ec5\u4ec5\u9700\u8981\u67e5\u8be2\u501f\u9605\u4fe1\u606f\uff0c\u540c\u65f6\u53ef\u80fd\u8fd8\u9700\u8981\u83b7\u53d6\u501f\u9605\u4fe1\u606f\u4e0b\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u6bd4\u5982\u5177\u4f53\u90a3\u4e2a\u7528\u6237\u501f\u9605\u4e86\u54ea\u672c\u4e66\uff0c\u5e76\u4e14\u7528\u6237\u548c\u4e66\u7c4d\u7684\u8be6\u60c5\u4e5f\u9700\u8981\u540c\u65f6\u51fa\u73b0\uff0c\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5c31\u9700\u8981\u53bb\u8bbf\u95ee\u9664\u4e86\u501f\u9605\u8868\u4ee5\u5916\u7684\u7528\u6237\u8868\u548c\u56fe\u4e66\u8868\u3002</p> <p></p> <p>\u4f46\u662f\u8fd9\u663e\u7136\u662f\u8fdd\u53cd\u6211\u4eec\u4e4b\u524d\u6240\u8bf4\u7684\u5355\u4e00\u804c\u8d23\u7684\uff0c\u76f8\u540c\u7684\u4e1a\u52a1\u529f\u80fd\u4e0d\u5e94\u8be5\u91cd\u590d\u51fa\u73b0\uff0c\u4f46\u662f\u73b0\u5728\u7531\u9700\u8981\u5728\u6b64\u670d\u52a1\u4e2d\u67e5\u8be2\u7528\u6237\u7684\u4fe1\u606f\u548c\u56fe\u4e66\u4fe1\u606f\uff0c\u90a3\u600e\u4e48\u529e\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u8ba9\u4e00\u4e2a\u670d\u52a1\u53bb\u8c03\u7528\u53e6\u4e00\u4e2a\u670d\u52a1\u6765\u83b7\u53d6\u4fe1\u606f\u3002</p> <p></p> <p>\u8fd9\u6837\uff0c\u56fe\u4e66\u7ba1\u7406\u5fae\u670d\u52a1\u548c\u7528\u6237\u7ba1\u7406\u5fae\u670d\u52a1\u76f8\u5bf9\u4e8e\u501f\u9605\u8bb0\u5f55\uff0c\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u7684\u5173\u7cfb\uff0c\u524d\u8005\u662f\u751f\u4ea7\u8005\uff0c\u540e\u8005\u4fbf\u662f\u6d88\u8d39\u8005\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u5148\u5c06\u501f\u9605\u5173\u8054\u4fe1\u606f\u67e5\u8be2\u5b8c\u5584\u4e86\uff1a</p> <pre><code>@Data\npublic class Borrow {\n    int id;\n    int uid;\n    int bid;\n}\n</code></pre> <pre><code>@Mapper\npublic interface BorrowMapper {\n    @Select(\"select * from DB_BORROW where uid = #{uid}\")\n    List&lt;Borrow&gt; getBorrowsByUid(int uid);\n\n    @Select(\"select * from DB_BORROW where bid = #{bid}\")\n    List&lt;Borrow&gt; getBorrowsByBid(int bid);\n\n    @Select(\"select * from DB_BORROW where bid = #{bid} and uid = #{uid}\")\n    Borrow getBorrow(int uid, int bid);\n}\n</code></pre> <p>\u73b0\u5728\u6709\u4e00\u4e2a\u9700\u6c42\uff0c\u9700\u8981\u67e5\u8be2\u7528\u6237\u7684\u501f\u9605\u8be6\u7ec6\u4fe1\u606f\uff0c\u4e5f\u5c31\u662f\u8bf4\u9700\u8981\u67e5\u8be2\u67d0\u4e2a\u7528\u6237\u5177\u4f53\u501f\u4e86\u90a3\u4e9b\u4e66\uff0c\u5e76\u4e14\u9700\u8981\u6b64\u7528\u6237\u7684\u4fe1\u606f\u548c\u6240\u6709\u5df2\u501f\u9605\u7684\u4e66\u7c4d\u4fe1\u606f\u4e00\u8d77\u8fd4\u56de\uff0c\u90a3\u4e48\u6211\u4eec\u5148\u6765\u8bbe\u8ba1\u4e00\u4e0b\u8fd4\u56de\u5b9e\u4f53\uff1a</p> <pre><code>@Data\n@AllArgsConstructor\npublic class UserBorrowDetail {\n    User user;\n    List&lt;Book&gt; bookList;\n}\n</code></pre> <p>\u4f46\u662f\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53d1\u73b0User\u548cBook\u5b9e\u4f53\u5b9e\u9645\u4e0a\u662f\u5728\u53e6\u5916\u4e24\u4e2a\u5fae\u670d\u52a1\u4e2d\u5b9a\u4e49\u7684\uff0c\u76f8\u5f53\u4e8e\u5f53\u524d\u9879\u76ee\u5e76\u6ca1\u6709\u5b9a\u4e49\u8fd9\u4e9b\u5b9e\u4f53\u7c7b\uff0c\u90a3\u4e48\u600e\u4e48\u89e3\u51b3\u5462\uff1f</p> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u670d\u52a1\u9700\u8981\u7528\u5230\u7684\u5b9e\u4f53\u7c7b\u5355\u72ec\u653e\u5165\u53e6\u4e00\u4e2a\u4e00\u4e2a\u9879\u76ee\u4e2d\uff0c\u7136\u540e\u8ba9\u8fd9\u4e9b\u9879\u76ee\u5f15\u7528\u96c6\u4e2d\u5b58\u653e\u5b9e\u4f53\u7c7b\u7684\u90a3\u4e2a\u9879\u76ee\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e2a\u5fae\u670d\u52a1\u7684\u5b9e\u4f53\u7c7b\u4fe1\u606f\u90fd\u53ef\u4ee5\u5171\u7528\u4e86\uff1a</p> <p></p> <p>\u7136\u540e\u53ea\u9700\u8981\u5728\u5bf9\u5e94\u7684\u7c7b\u4e2d\u5f15\u7528\u6b64\u9879\u76ee\u4f5c\u4e3a\u4f9d\u8d56\u5373\u53ef\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;commons&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u4e4b\u540e\u65b0\u7684\u516c\u5171\u5b9e\u4f53\u7c7b\u90fd\u53ef\u4ee5\u5728<code>commons</code>\u9879\u76ee\u4e2d\u8fdb\u884c\u5b9a\u4e49\u4e86\uff0c\u73b0\u5728\u6211\u4eec\u63a5\u7740\u6765\u5b8c\u6210\u521a\u521a\u7684\u9700\u6c42\uff0c\u5148\u5b9a\u4e49\u63a5\u53e3\uff1a</p> <pre><code>public interface BorrowService {\n\n    UserBorrowDetail getUserBorrowDetailByUid(int uid);\n}\n</code></pre> <pre><code>@Service\npublic class BorrowServiceImpl implements BorrowService{\n\n    @Resource\n    BorrowMapper mapper;\n\n    @Override\n    public UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n        List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n        //\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u73b0\u5728\u62ff\u5230\u501f\u9605\u5173\u8054\u4fe1\u606f\u4e86\uff0c\u600e\u4e48\u8c03\u7528\u5176\u4ed6\u670d\u52a1\u83b7\u53d6\u4fe1\u606f\u5462\uff1f\n    }\n}\n</code></pre> <p>\u9700\u8981\u8fdb\u884c\u670d\u52a1\u8fdc\u7a0b\u8c03\u7528\u6211\u4eec\u9700\u8981\u7528\u5230<code>RestTemplate</code>\u6765\u8fdb\u884c\uff1a</p> <pre><code>@Service\npublic class BorrowServiceImpl implements BorrowService{\n\n    @Resource\n    BorrowMapper mapper;\n\n    @Override\n    public UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n        List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n        //RestTemplate\u652f\u6301\u591a\u79cd\u65b9\u5f0f\u7684\u8fdc\u7a0b\u8c03\u7528\n        RestTemplate template = new RestTemplate();\n        //\u8fd9\u91cc\u901a\u8fc7\u8c03\u7528getForObject\u6765\u8bf7\u6c42\u5176\u4ed6\u670d\u52a1\uff0c\u5e76\u5c06\u7ed3\u679c\u81ea\u52a8\u8fdb\u884c\u5c01\u88c5\n        //\u83b7\u53d6User\u4fe1\u606f\n        User user = template.getForObject(\"http://localhost:8082/user/\"+uid, User.class);\n        //\u83b7\u53d6\u6bcf\u4e00\u672c\u4e66\u7684\u8be6\u7ec6\u4fe1\u606f\n        List&lt;Book&gt; bookList = borrow\n                .stream()\n                .map(b -&gt; template.getForObject(\"http://localhost:8080/book/\"+b.getBid(), Book.class))\n                .collect(Collectors.toList());\n        return new UserBorrowDetail(user, bookList);\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u518d\u6700\u540e\u5b8c\u5584\u4e00\u4e0bController\uff1a</p> <pre><code>@RestController\npublic class BorrowController {\n\n    @Resource\n    BorrowService service;\n\n    @RequestMapping(\"/borrow/{uid}\")\n    UserBorrowDetail findUserBorrows(@PathVariable(\"uid\") int uid){\n        return service.getUserBorrowDetailByUid(uid);\n    }\n}\n</code></pre> <p>\u5728\u6570\u636e\u5e93\u4e2d\u6dfb\u52a0\u4e00\u70b9\u501f\u9605\u4fe1\u606f\uff0c\u6d4b\u8bd5\u770b\u770b\u80fd\u4e0d\u80fd\u6b63\u5e38\u83b7\u53d6\uff08\u6ce8\u610f\u4e00\u5b9a\u8981\u4fdd\u8bc1\u4e09\u4e2a\u670d\u52a1\u90fd\u5904\u4e8e\u5f00\u542f\u72b6\u6001\uff0c\u5426\u5219\u8fdc\u7a0b\u8c03\u7528\u4f1a\u5931\u8d25\uff09\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u7ed3\u679c\u6b63\u5e38\uff0c\u6ca1\u6709\u95ee\u9898\uff0c\u8fdc\u7a0b\u8c03\u7528\u6210\u529f\u3002</p> <p>\u8fd9\u6837\uff0c\u4e00\u4e2a\u7b80\u6613\u7684\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u7684\u5206\u5e03\u5f0f\u9879\u76ee\u5c31\u642d\u5efa\u5b8c\u6210\u4e86\uff0c\u8fd9\u91cc\u8bb0\u5f97\u628a\u6574\u4e2a\u9879\u76ee\u538b\u7f29\u6253\u5305\u5907\u4efd\u4e00\u4e0b\uff0c\u4e0b\u4e00\u7ae0\u5b66\u4e60SpringCloud Alibaba\u4e5f\u9700\u8981\u8fdb\u884c\u914d\u7f6e\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_5","title":"\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0","text":"<p>\u524d\u9762\u6211\u4eec\u4e86\u89e3\u4e86\u5982\u4f55\u5bf9\u5355\u4f53\u5e94\u7528\u8fdb\u884c\u62c6\u5206\uff0c\u5e76\u4e14\u4e5f\u5b66\u4e60\u4e86\u5982\u4f55\u8fdb\u884c\u670d\u52a1\u4e4b\u95f4\u7684\u76f8\u4e92\u8c03\u7528\uff0c\u4f46\u662f\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u867d\u7136\u670d\u52a1\u62c6\u5206\u5b8c\u6210\uff0c\u4f46\u662f\u6ca1\u6709\u4e00\u4e2a\u6bd4\u8f83\u5408\u7406\u7684\u7ba1\u7406\u673a\u5236\uff0c\u5982\u679c\u5355\u7eaf\u53ea\u662f\u8fd9\u6837\u7f16\u5199\uff0c\u5728\u90e8\u7f72\u548c\u7ef4\u62a4\u8d77\u6765\uff0c\u80af\u5b9a\u662f\u5f88\u9ebb\u70e6\u7684\u3002\u53ef\u4ee5\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c\u67d0\u4e00\u5929\u8fd9\u4e9b\u5fae\u670d\u52a1\u7684\u7aef\u53e3\u6216\u662f\u5730\u5740\u5927\u89c4\u6a21\u5730\u53d1\u751f\u6539\u53d8\uff0c\u6211\u4eec\u5c31\u4e0d\u5f97\u4e0d\u5c06\u670d\u52a1\u4e4b\u95f4\u7684\u8c03\u7528\u8def\u5f84\u5927\u89c4\u6a21\u7684\u540c\u6b65\u8fdb\u884c\u4fee\u6539\uff0c\u8fd9\u662f\u591a\u4e48\u53ef\u6015\u7684\u4e8b\u60c5\u3002\u6211\u4eec\u9700\u8981\u524a\u5f31\u8fd9\u79cd\u670d\u52a1\u4e4b\u95f4\u7684\u5f3a\u5173\u8054\u6027\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u96c6\u4e2d\u7ba1\u7406\u5fae\u670d\u52a1\u7684\u5e73\u53f0\uff0c\u8fd9\u65f6\u5c31\u8981\u501f\u52a9\u6211\u4eec\u8fd9\u4e00\u90e8\u5206\u7684\u4e3b\u89d2\u4e86\u3002</p> <p>Eureka\u80fd\u591f\u81ea\u52a8\u6ce8\u518c\u5e76\u53d1\u73b0\u5fae\u670d\u52a1\uff0c\u7136\u540e\u5bf9\u670d\u52a1\u7684\u72b6\u6001\u3001\u4fe1\u606f\u8fdb\u884c\u96c6\u4e2d\u7ba1\u7406\uff0c\u8fd9\u6837\u5f53\u6211\u4eec\u9700\u8981\u83b7\u53d6\u5176\u4ed6\u670d\u52a1\u7684\u4fe1\u606f\u65f6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5411Eureka\u8fdb\u884c\u67e5\u8be2\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p></p> <p>\u50cf\u8fd9\u6837\u7684\u8bdd\uff0c\u670d\u52a1\u4e4b\u95f4\u7684\u5f3a\u5173\u8054\u6027\u5c31\u4f1a\u88ab\u8fdb\u4e00\u6b65\u524a\u5f31\u3002</p> <p>\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u5c31\u6765\u642d\u5efa\u4e00\u4e2aEureka\u670d\u52a1\u5668\uff0c\u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Maven\u9879\u76ee\u5373\u53ef\uff0c\u7136\u540e\u6211\u4eec\u9700\u8981\u5728\u7236\u5de5\u7a0b\u4e2d\u6dfb\u52a0\u4e00\u4e0bSpringCloud\u7684\u4f9d\u8d56\uff0c\u8fd9\u91cc\u9009\u7528<code>2021.0.1</code>\u7248\u672c\uff08Spring Cloud \u6700\u65b0\u7684\u7248\u672c\u547d\u540d\u65b9\u5f0f\u53d8\u66f4\u4e86\uff0c\u73b0\u5728\u662f YEAR.x \u8fd9\u79cd\u547d\u540d\u65b9\u5f0f\uff0c\u5177\u4f53\u53ef\u4ee5\u5728\u5b98\u7f51\u67e5\u770b\uff1ahttps://spring.io/projects/spring-cloud#learn\uff09\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n    &lt;version&gt;2021.0.1&lt;/version&gt;\n    &lt;type&gt;pom&lt;/type&gt;\n    &lt;scope&gt;import&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u4e3a\u65b0\u521b\u5efa\u7684\u9879\u76ee\u6dfb\u52a0\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre> <p>\u4e0b\u8f7d\u5185\u5bb9\u6709\u70b9\u591a\uff0c\u9996\u6b21\u5bfc\u5165\u8bf7\u8010\u5fc3\u7b49\u5f85\u4e00\u4e0b\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u6765\u521b\u5efa\u4e3b\u7c7b\uff0c\u8fd8\u662f\u4e00\u6837\u7684\u64cd\u4f5c\uff1a</p> <pre><code>@EnableEurekaServer\n@SpringBootApplication\npublic class EurekaServerApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(EurekaServerApplication.class, args);\n    }\n}\n</code></pre> <p>\u522b\u7740\u6025\u542f\u52a8\uff01\uff01\uff01\u63a5\u7740\u6211\u4eec\u9700\u8981\u4fee\u6539\u4e00\u4e0b\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>server:\n  port: 8888\neureka:\n    # \u5f00\u542f\u4e4b\u524d\u9700\u8981\u4fee\u6539\u4e00\u4e0b\u5ba2\u6237\u7aef\u8bbe\u7f6e\uff08\u867d\u7136\u662f\u670d\u52a1\u7aef\n  client:\n    # \u7531\u4e8e\u6211\u4eec\u662f\u4f5c\u4e3a\u670d\u52a1\u7aef\u89d2\u8272\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u83b7\u53d6\u670d\u52a1\u7aef\uff0c\u6539\u4e3afalse\uff0c\u9ed8\u8ba4\u4e3atrue\n        fetch-registry: false\n        # \u6682\u65f6\u4e0d\u9700\u8981\u5c06\u81ea\u5df1\u4e5f\u6ce8\u518c\u5230Eureka\n    register-with-eureka: false\n    # \u5c06eureka\u670d\u52a1\u7aef\u6307\u5411\u81ea\u5df1\n    service-url:\n      defaultZone: http://localhost:8888/eureka\n</code></pre> <p>\u597d\u4e86\uff0c\u73b0\u5728\u5dee\u4e0d\u591a\u53ef\u4ee5\u542f\u52a8\u4e86\uff0c\u542f\u52a8\u5b8c\u6210\u540e\uff0c\u76f4\u63a5\u8f93\u5165\u5730\u5740+\u7aef\u53e3\u5373\u53ef\u8bbf\u95eeEureka\u7684\u7ba1\u7406\u540e\u53f0\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u76ee\u524d\u8fd8\u6ca1\u6709\u4efb\u4f55\u7684\u670d\u52a1\u6ce8\u518c\u5230Eureka\uff0c\u6211\u4eec\u63a5\u7740\u6765\u914d\u7f6e\u4e00\u4e0b\u6211\u4eec\u7684\u4e09\u4e2a\u5fae\u670d\u52a1\uff0c\u9996\u5148\u8fd8\u662f\u9700\u8981\u5bfc\u5165Eureka\u4f9d\u8d56\uff08\u6ce8\u610f\u522b\u5bfc\u9519\u4e86\uff0c\u540d\u79f0\u91cc\u9762\u6709\u4e2astarter\u7684\u624d\u662f\uff09\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7136\u540e\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>eureka:\n  client:\n    # \u8ddf\u4e0a\u9762\u4e00\u6837\uff0c\u9700\u8981\u6307\u5411Eureka\u670d\u52a1\u7aef\u5730\u5740\uff0c\u8fd9\u6837\u624d\u80fd\u8fdb\u884c\u6ce8\u518c\n    service-url:\n      defaultZone: http://localhost:8888/eureka\n</code></pre> <p>OK\uff0c\u65e0\u9700\u5728\u542f\u52a8\u7c7b\u6dfb\u52a0\u6ce8\u89e3\uff0c\u76f4\u63a5\u542f\u52a8\u5c31\u53ef\u4ee5\u4e86\uff0c\u7136\u540e\u6253\u5f00Eureka\u7684\u670d\u52a1\u7ba1\u7406\u9875\u9762\uff0c\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u521a\u521a\u5f00\u542f\u7684\u670d\u52a1\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230<code>8082</code>\u7aef\u53e3\u4e0a\u7684\u670d\u52a1\u5668\uff0c\u5df2\u7ecf\u6210\u529f\u6ce8\u518c\u5230Eureka\u4e86\uff0c\u4f46\u662f\u8fd9\u4e2a\u670d\u52a1\u540d\u79f0\u600e\u4e48\u4f1a\u663e\u793a\u4e3aUNKNOWN\uff0c\u6211\u4eec\u9700\u8981\u4fee\u6539\u4e00\u4e0b\uff1a</p> <pre><code>spring:\n  application:\n    name: userservice\n</code></pre> <p></p> <p>\u5f53\u6211\u4eec\u7684\u670d\u52a1\u542f\u52a8\u4e4b\u540e\uff0c\u4f1a\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u8ddfEureka\u53d1\u9001\u4e00\u6b21\u5fc3\u8df3\u5305\uff0c\u8fd9\u6837Eureka\u5c31\u80fd\u591f\u611f\u77e5\u5230\u6211\u4eec\u7684\u670d\u52a1\u662f\u5426\u5904\u4e8e\u6b63\u5e38\u8fd0\u884c\u72b6\u6001\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u7528\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u5c06\u53e6\u5916\u4e24\u4e2a\u5fae\u670d\u52a1\u4e5f\u6ce8\u518c\u8fdb\u6765\uff1a</p> <p></p> <p>\u90a3\u4e48\uff0c\u73b0\u5728\u6211\u4eec\u600e\u4e48\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\u5462\uff1f</p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u4e4b\u524d\u5982\u679c\u9700\u8981\u5bf9\u5176\u4ed6\u5fae\u670d\u52a1\u8fdb\u884c\u8fdc\u7a0b\u8c03\u7528\uff0c\u90a3\u4e48\u5c31\u5fc5\u987b\u8981\u77e5\u9053\u5176\u4ed6\u670d\u52a1\u7684\u5730\u5740\uff1a</p> <pre><code>User user = template.getForObject(\"http://localhost:8082/user/\"+uid, User.class);\n</code></pre> <p>\u800c\u73b0\u5728\u6709\u4e86Eureka\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5411\u5176\u8fdb\u884c\u67e5\u8be2\uff0c\u5f97\u5230\u5bf9\u5e94\u7684\u5fae\u670d\u52a1\u5730\u5740\uff0c\u8fd9\u91cc\u76f4\u63a5\u5c06\u670d\u52a1\u540d\u79f0\u66ff\u6362\u5373\u53ef\uff1a</p> <pre><code>@Service\npublic class BorrowServiceImpl implements BorrowService {\n\n    @Resource\n    BorrowMapper mapper;\n\n    @Resource\n    RestTemplate template;\n\n    @Override\n    public UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n        List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n\n        //\u8fd9\u91cc\u4e0d\u7528\u518d\u5199IP\uff0c\u76f4\u63a5\u5199\u670d\u52a1\u540d\u79f0userservice\n        User user = template.getForObject(\"http://userservice/user/\"+uid, User.class);\n        //\u8fd9\u91cc\u4e0d\u7528\u518d\u5199IP\uff0c\u76f4\u63a5\u5199\u670d\u52a1\u540d\u79f0bookservice\n        List&lt;Book&gt; bookList = borrow\n                .stream()\n                .map(b -&gt; template.getForObject(\"http://bookservice/book/\"+b.getBid(), Book.class))\n                .collect(Collectors.toList());\n        return new UserBorrowDetail(user, bookList);\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u624b\u52a8\u5c06RestTemplate\u58f0\u660e\u4e3a\u4e00\u4e2aBean\uff0c\u7136\u540e\u6dfb\u52a0<code>@LoadBalanced</code>\u6ce8\u89e3\uff0c\u8fd9\u6837Eureka\u5c31\u4f1a\u5bf9\u670d\u52a1\u7684\u8c03\u7528\u8fdb\u884c\u81ea\u52a8\u53d1\u73b0\uff0c\u5e76\u63d0\u4f9b\u8d1f\u8f7d\u5747\u8861\uff1a</p> <pre><code>@Configuration\npublic class BeanConfig {\n    @Bean\n    @LoadBalanced\n    RestTemplate template(){\n        return new RestTemplate();\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5c31\u53ef\u4ee5\u6b63\u5e38\u8c03\u7528\u4e86\uff1a</p> <p></p> <p>\u4e0d\u5bf9\u554a\uff0c\u4e0d\u662f\u8bf4\u6709\u8d1f\u8f7d\u5747\u8861\u7684\u80fd\u529b\u5417\uff0c\u600e\u4e48\u4e2a\u8d1f\u8f7d\u5747\u8861\u5462\uff1f</p> <p>\u6211\u4eec\u5148\u6765\u770b\u770b\uff0c\u540c\u4e00\u4e2a\u670d\u52a1\u5668\u5b9e\u9645\u4e0a\u662f\u53ef\u4ee5\u6ce8\u518c\u5f88\u591a\u4e2a\u7684\uff0c\u4f46\u662f\u5b83\u4eec\u7684\u7aef\u53e3\u4e0d\u540c\uff0c\u6bd4\u5982\u6211\u4eec\u8fd9\u91cc\u521b\u5efa\u591a\u4e2a\u7528\u6237\u67e5\u8be2\u670d\u52a1\uff0c\u6211\u4eec\u73b0\u5728\u5c06\u539f\u6709\u7684\u7aef\u53e3\u914d\u7f6e\u4fee\u6539\u4e00\u4e0b\uff0c\u7531IDEA\u4e2d\u8bbe\u5b9a\u542f\u52a8\u53c2\u6570\u6765\u51b3\u5b9a\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u591a\u521b\u5efa\u51e0\u4e2a\u4e0d\u540c\u7aef\u53e3\u7684\u542f\u52a8\u9879\u4e86\uff1a</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5728Eureka\u4e2d\uff0c\u540c\u4e00\u4e2a\u670d\u52a1\u51fa\u73b0\u4e86\u4e24\u4e2a\u5b9e\u4f8b\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u7528\u6237\u67e5\u8be2\uff0c\u7136\u540e\u8fdb\u884c\u8fdc\u7a0b\u8c03\u7528\uff0c\u770b\u770b\u8bf7\u6c42\u662f\u4e0d\u662f\u5747\u5300\u5730\u5206\u914d\u5230\u8fd9\u4e24\u4e2a\u670d\u52a1\u7aef\uff1a</p> <pre><code>@RestController\npublic class UserController {\n\n    @Resource\n    UserService service;\n\n    @RequestMapping(\"/user/{uid}\")\n    public User findUserById(@PathVariable(\"uid\") int uid){\n        System.out.println(\"\u6211\u88ab\u8c03\u7528\u62c9\uff01\");\n        return service.getUserById(uid);\n    }\n}\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u4e24\u4e2a\u5b9e\u4f8b\u90fd\u80fd\u591f\u5747\u5300\u5730\u88ab\u5206\u914d\u8bf7\u6c42\uff1a</p> <p></p> <p></p> <p>\u8fd9\u6837\uff0c\u670d\u52a1\u81ea\u52a8\u53d1\u73b0\u4ee5\u53ca\u7b80\u5355\u7684\u8d1f\u8f7d\u5747\u8861\u5c31\u5b9e\u73b0\u5b8c\u6210\u4e86\uff0c\u5e76\u4e14\uff0c\u5982\u679c\u67d0\u4e2a\u5fae\u670d\u52a1\u6302\u6389\u4e86\uff0c\u53ea\u8981\u5b58\u5728\u5176\u4ed6\u540c\u6837\u7684\u5fae\u670d\u52a1\u5b9e\u4f8b\u5728\u8fd0\u884c\uff0c\u90a3\u4e48\u5c31\u4e0d\u4f1a\u5bfc\u81f4\u6574\u4e2a\u5fae\u670d\u52a1\u4e0d\u53ef\u7528\uff0c\u6781\u5927\u5730\u4fdd\u8bc1\u4e86\u5b89\u5168\u6027\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_6","title":"\u6ce8\u518c\u4e2d\u5fc3\u9ad8\u53ef\u7528","text":"<p>\u5404\u4f4d\u53ef\u5426\u60f3\u8fc7\u8fd9\u6837\u7684\u4e00\u4e2a\u95ee\u9898\uff1f\u867d\u7136Eureka\u80fd\u591f\u5b9e\u73b0\u670d\u52a1\u6ce8\u518c\u548c\u53d1\u73b0\uff0c\u4f46\u662f\u5982\u679cEureka\u670d\u52a1\u5668\u5d29\u6e83\u4e86\uff0c\u5c82\u4e0d\u662f\u6240\u6709\u9700\u8981\u7528\u5230\u670d\u52a1\u53d1\u73b0\u7684\u5fae\u670d\u52a1\u5c31GG\u4e86\uff1f</p> <p>\u4e3a\u4e86\u907f\u514d\uff0c\u8fd9\u79cd\u95ee\u9898\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u50cf\u4e0a\u9762\u90a3\u6837\uff0c\u642d\u5efaEureka\u96c6\u7fa4\uff0c\u5b58\u5728\u591a\u4e2aEureka\u670d\u52a1\u5668\uff0c\u8fd9\u6837\u5c31\u7b97\u6302\u6389\u5176\u4e2d\u4e00\u4e2a\uff0c\u5176\u4ed6\u7684\u4e5f\u8fd8\u5728\u6b63\u5e38\u8fd0\u884c\uff0c\u5c31\u4e0d\u4f1a\u4f7f\u5f97\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\u4e0d\u53ef\u7528\u3002\u5f53\u7136\uff0c\u8981\u662f\u7269\u7406\u9ed1\u5ba2\u76f4\u63a5\u70b8\u4e86\u6574\u4e2a\u673a\u623f\uff0c\u90a3\u8fd8\u662f\u7b97\u4e86\u5427\u3002</p> <p></p> <p>\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u642d\u5efaEureka\u96c6\u7fa4\uff0c\u8fd9\u91cc\u7531\u4e8e\u673a\u5668\u914d\u7f6e\u4e0d\u9ad8\uff0c\u5c31\u642d\u5efa\u4e24\u4e2aEureka\u670d\u52a1\u5668\u7ec4\u6210\u96c6\u7fa4\u3002</p> <p>\u9996\u5148\u6211\u4eec\u9700\u8981\u4fee\u6539\u4e00\u4e0bEureka\u670d\u52a1\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\uff0c\uff1a</p> <pre><code>server:\n  port: 8801\nspring:\n  application:\n    name: eurekaserver\neureka:\n  instance:\n    # \u7531\u4e8e\u4e0d\u652f\u6301\u591a\u4e2alocalhost\u7684Eureka\u670d\u52a1\u5668\uff0c\u4f46\u662f\u53c8\u53ea\u6709\u672c\u5730\u6d4b\u8bd5\u73af\u5883\uff0c\u6240\u4ee5\u5c31\u53ea\u80fd\u81ea\u5b9a\u4e49\u4e3b\u673a\u540d\u79f0\u4e86\n    # \u4e3b\u673a\u540d\u79f0\u6539\u4e3aeureka01\n    hostname: eureka01\n  client:\n    fetch-registry: false\n    # \u53bb\u6389register-with-eureka\u9009\u9879\uff0c\u8ba9Eureka\u670d\u52a1\u5668\u81ea\u5df1\u6ce8\u518c\u5230\u5176\u4ed6Eureka\u670d\u52a1\u5668\uff0c\u8fd9\u6837\u624d\u80fd\u76f8\u4e92\u542f\u7528\n    service-url:\n        # \u6ce8\u610f\u8fd9\u91cc\u586b\u5199\u5176\u4ed6Eureka\u670d\u52a1\u5668\u7684\u5730\u5740\uff0c\u4e0d\u7528\u5199\u81ea\u5df1\u7684\n      defaultZone: http://eureka01:8801/eureka\n</code></pre> <pre><code>server:\n  port: 8802\nspring:\n  application:\n    name: eurekaserver\neureka:\n  instance:\n    hostname: eureka02\n  client:\n    fetch-registry: false\n    service-url:\n      defaultZone: http://eureka01:8801/eureka\n</code></pre> <p>\u8fd9\u91cc\u7531\u4e8e\u6211\u4eec\u4fee\u6539\u6210\u81ea\u5b9a\u4e49\u7684\u5730\u5740\uff0c\u9700\u8981\u5728hosts\u6587\u4ef6\u4e2d\u5c06\u5176\u89e3\u6790\u5230172.0.0.1\u624d\u80fd\u56de\u5230localhost\uff0cMac\u4e0b\u6587\u4ef6\u8def\u5f84\u4e3a<code>/etc/hosts</code>\uff0cWindows\u4e0b\u4e3a<code>C:\\Windows\\system32\\drivers\\etc\\hosts</code>\uff1a</p> <p></p> <p>\u5bf9\u521b\u5efa\u7684\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u5206\u522b\u6dfb\u52a0\u542f\u52a8\u914d\u7f6e\uff0c\u76f4\u63a5\u4f7f\u7528<code>spring.profiles.active</code>\u6307\u5b9a\u542f\u7528\u7684\u914d\u7f6e\u6587\u4ef6\u5373\u53ef\uff1a</p> <p></p> <p>\u63a5\u7740\u542f\u52a8\u8fd9\u4e24\u4e2a\u6ce8\u518c\u4e2d\u5fc3\uff0c\u8fd9\u4e24\u4e2aEureka\u7ba1\u7406\u9875\u9762\u90fd\u53ef\u4ee5\u88ab\u8bbf\u95ee\uff0c\u6211\u4eec\u8bbf\u95ee\u5176\u4e2d\u4e00\u4e2a\uff1a</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u4e0b\u65b9<code>replicas</code>\u4e2d\u5df2\u7ecf\u5305\u542b\u4e86\u53e6\u4e00\u4e2aEureka\u670d\u52a1\u5668\u7684\u5730\u5740\uff0c\u5e76\u4e14\u662f\u53ef\u7528\u72b6\u6001\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5c06\u6211\u4eec\u7684\u5fae\u670d\u52a1\u914d\u7f6e\u4e5f\u8fdb\u884c\u4fee\u6539\uff1a</p> <pre><code>eureka:\n  client:\n    service-url:\n        # \u5c06\u4e24\u4e2aEureka\u7684\u5730\u5740\u90fd\u52a0\u5165\uff0c\u8fd9\u6837\u5c31\u7b97\u6709\u4e00\u4e2aEureka\u6302\u6389\uff0c\u4e5f\u80fd\u5b8c\u6210\u6ce8\u518c\n      defaultZone: http://localhost:8801/eureka, http://localhost:8802/eureka\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u670d\u52a1\u5168\u90e8\u6210\u529f\u6ce8\u518c\uff0c\u5e76\u4e14\u4e24\u4e2aEureka\u670d\u52a1\u7aef\u90fd\u663e\u793a\u4e3a\u5df2\u6ce8\u518c\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u6a21\u62df\u4e00\u4e0b\uff0c\u5c06\u5176\u4e2d\u4e00\u4e2aEureka\u670d\u52a1\u5668\u5173\u95ed\u6389\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u4f1a\u76f4\u63a5\u53d8\u6210\u4e0d\u53ef\u7528\u72b6\u6001\uff1a</p> <p></p> <p>\u5f53\u7136\uff0c\u5982\u679c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u91cd\u542f\u521a\u521a\u5173\u95ed\u7684Eureka\u670d\u52a1\u5668\uff0c\u4f1a\u81ea\u52a8\u540c\u6b65\u5176\u4ed6Eureka\u670d\u52a1\u5668\u7684\u6570\u636e\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#loadbalancer","title":"LoadBalancer \u8d1f\u8f7d\u5747\u8861","text":"<p>\u524d\u9762\u6211\u4eec\u8bb2\u89e3\u4e86\u5982\u4f55\u5bf9\u670d\u52a1\u8fdb\u884c\u62c6\u5206\u3001\u5982\u4f55\u901a\u8fc7Eureka\u670d\u52a1\u5668\u8fdb\u884c\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\uff0c\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\uff0c\u5b83\u7684\u8d1f\u8f7d\u5747\u8861\u5230\u5e95\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u5b9e\u9645\u4e0a\u4e4b\u524d\u6f14\u793a\u7684\u8d1f\u8f7d\u5747\u8861\u662f\u4f9d\u9760LoadBalancer\u5b9e\u73b0\u7684\u3002</p> <p>\u57282020\u5e74\u524d\u7684SpringCloud\u7248\u672c\u662f\u91c7\u7528Ribbon\u4f5c\u4e3a\u8d1f\u8f7d\u5747\u8861\u5b9e\u73b0\uff0c\u4f46\u662f2020\u5e74\u7684\u7248\u672c\u4e4b\u540eSpringCloud\u628aRibbon\u79fb\u9664\u4e86\uff0c\u8fdb\u800c\u7528\u81ea\u5df1\u7f16\u5199\u7684LoadBalancer\u66ff\u4ee3\u3002</p> <p>\u90a3\u4e48\uff0c\u8d1f\u8f7d\u5747\u8861\u662f\u5982\u4f55\u8fdb\u884c\u7684\u5462\uff1f</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_7","title":"\u8d1f\u8f7d\u5747\u8861","text":"<p>\u5b9e\u9645\u4e0a\uff0c\u5728\u6dfb\u52a0<code>@LoadBalanced</code>\u6ce8\u89e3\u4e4b\u540e\uff0c\u4f1a\u542f\u7528\u62e6\u622a\u5668\u5bf9\u6211\u4eec\u53d1\u8d77\u7684\u670d\u52a1\u8c03\u7528\u8bf7\u6c42\u8fdb\u884c\u62e6\u622a\uff08\u6ce8\u610f\u8fd9\u91cc\u662f\u9488\u5bf9\u6211\u4eec\u53d1\u8d77\u7684\u8bf7\u6c42\u8fdb\u884c\u62e6\u622a\uff09\uff0c\u53eb\u505a<code>LoadBalancerInterceptor</code>\uff0c\u5b83\u5b9e\u73b0<code>ClientHttpRequestInterceptor</code>\u63a5\u53e3\uff1a</p> <pre><code>@FunctionalInterface\npublic interface ClientHttpRequestInterceptor {\n    ClientHttpResponse intercept(HttpRequest request, byte[] body, ClientHttpRequestExecution execution) throws IOException;\n}\n</code></pre> <p>\u4e3b\u8981\u662f\u5bf9<code>intercept</code>\u65b9\u6cd5\u7684\u5b9e\u73b0\uff1a</p> <pre><code>public ClientHttpResponse intercept(final HttpRequest request, final byte[] body, final ClientHttpRequestExecution execution) throws IOException {\n    URI originalUri = request.getURI();\n    String serviceName = originalUri.getHost();\n    Assert.state(serviceName != null, \"Request URI does not contain a valid hostname: \" + originalUri);\n    return (ClientHttpResponse)this.loadBalancer.execute(serviceName, this.requestFactory.createRequest(request, body, execution));\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u6253\u4e2a\u65ad\u70b9\u770b\u770b\u5b9e\u9645\u662f\u600e\u4e48\u5728\u6267\u884c\u7684\uff0c\u53ef\u4ee5\u770b\u5230\uff1a</p> <p></p> <p></p> <p>\u670d\u52a1\u7aef\u4f1a\u5728\u53d1\u8d77\u8bf7\u6c42\u65f6\u6267\u884c\u8fd9\u4e9b\u62e6\u622a\u5668\u3002</p> <p>\u90a3\u4e48\u8fd9\u4e2a\u62e6\u622a\u5668\u505a\u4e86\u4ec0\u4e48\u4e8b\u60c5\u5462\uff0c\u9996\u5148\u6211\u4eec\u8981\u660e\u786e\uff0c\u6211\u4eec\u7ed9\u8fc7\u6765\u7684\u8bf7\u6c42\u5730\u5740\uff0c\u5e76\u4e0d\u662f\u4e00\u4e2a\u6709\u6548\u7684\u4e3b\u673a\u540d\u79f0\uff0c\u800c\u662f\u670d\u52a1\u540d\u79f0\uff0c\u90a3\u4e48\u600e\u4e48\u624d\u80fd\u5f97\u5230\u771f\u6b63\u9700\u8981\u8bbf\u95ee\u7684\u4e3b\u673a\u540d\u79f0\u5462\uff0c\u80af\u5b9a\u662f\u5f97\u627eEureka\u83b7\u53d6\u7684\u3002</p> <p>\u6211\u4eec\u6765\u770b\u770b<code>loadBalancer.execute()</code>\u505a\u4e86\u4ec0\u4e48\uff0c\u5b83\u7684\u5177\u4f53\u5b9e\u73b0\u4e3a<code>BlockingLoadBalancerClient</code>\uff1a</p> <pre><code>//\u4ece\u4e0a\u9762\u7ed9\u8fdb\u6765\u4e86\u670d\u52a1\u7684\u540d\u79f0\u548c\u5177\u4f53\u7684\u8bf7\u6c42\u5b9e\u4f53\npublic &lt;T&gt; T execute(String serviceId, LoadBalancerRequest&lt;T&gt; request) throws IOException {\n    String hint = this.getHint(serviceId);\n    LoadBalancerRequestAdapter&lt;T, DefaultRequestContext&gt; lbRequest = new LoadBalancerRequestAdapter(request, new DefaultRequestContext(request, hint));\n    Set&lt;LoadBalancerLifecycle&gt; supportedLifecycleProcessors = this.getSupportedLifecycleProcessors(serviceId);\n    supportedLifecycleProcessors.forEach((lifecycle) -&gt; {\n        lifecycle.onStart(lbRequest);\n    });\n    //\u53ef\u4ee5\u770b\u5230\u5728\u8fd9\u91cc\u4f1a\u8c03\u7528choose\u65b9\u6cd5\u81ea\u52a8\u83b7\u53d6\u5bf9\u5e94\u7684\u670d\u52a1\u5b9e\u4f8b\u4fe1\u606f\n    ServiceInstance serviceInstance = this.choose(serviceId, lbRequest);\n    if (serviceInstance == null) {\n        supportedLifecycleProcessors.forEach((lifecycle) -&gt; {\n            lifecycle.onComplete(new CompletionContext(Status.DISCARD, lbRequest, new EmptyResponse()));\n        });\n        //\u6ca1\u6709\u53d1\u73b0\u4efb\u4f55\u6b64\u670d\u52a1\u7684\u5b9e\u4f8b\u5c31\u629b\u5f02\u5e38\uff08\u4e4b\u524d\u7684\u6d4b\u8bd5\u4e2d\u53ef\u80fd\u5df2\u7ecf\u9047\u5230\u4e86\uff09\n        throw new IllegalStateException(\"No instances available for \" + serviceId);\n    } else {\n        //\u6210\u529f\u83b7\u53d6\u5230\u5bf9\u5e94\u670d\u52a1\u7684\u5b9e\u4f8b\uff0c\u8fd9\u65f6\u5c31\u53ef\u4ee5\u53d1\u8d77HTTP\u8bf7\u6c42\u83b7\u53d6\u4fe1\u606f\u4e86\n        return this.execute(serviceId, serviceInstance, lbRequest);\n    }\n}\n</code></pre> <p>\u6240\u4ee5\uff0c\u5b9e\u9645\u4e0a\u5728\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\u7684\u65f6\u5019\uff0c\u4f1a\u5411Eureka\u53d1\u8d77\u8bf7\u6c42\uff0c\u9009\u62e9\u4e00\u4e2a\u53ef\u7528\u7684\u5bf9\u5e94\u670d\u52a1\uff0c\u7136\u540e\u4f1a\u8fd4\u56de\u6b64\u670d\u52a1\u7684\u4e3b\u673a\u5730\u5740\u7b49\u4fe1\u606f\uff1a</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_8","title":"\u81ea\u5b9a\u4e49\u8d1f\u8f7d\u5747\u8861\u7b56\u7565","text":"<p>LoadBalancer\u9ed8\u8ba4\u63d0\u4f9b\u4e86\u4e24\u79cd\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff1a</p> <ul> <li>RandomLoadBalancer  -  \u968f\u673a\u5206\u914d\u7b56\u7565</li> <li>(\u9ed8\u8ba4) RoundRobinLoadBalancer  -  \u8f6e\u8be2\u5206\u914d\u7b56\u7565</li> </ul> <p>\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u4fee\u6539\u9ed8\u8ba4\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u53ef\u4ee5\u8fdb\u884c\u6307\u5b9a\uff0c\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u5e0c\u671b\u7528\u6237\u670d\u52a1\u91c7\u7528\u968f\u673a\u5206\u914d\u7b56\u7565\uff0c\u6211\u4eec\u9700\u8981\u5148\u521b\u5efa\u968f\u673a\u5206\u914d\u7b56\u7565\u7684\u914d\u7f6e\u7c7b\uff08\u4e0d\u7528\u52a0<code>@Configuration</code>\uff09\uff1a</p> <pre><code>public class LoadBalancerConfig {\n    //\u5c06\u5b98\u65b9\u63d0\u4f9b\u7684 RandomLoadBalancer \u6ce8\u518c\u4e3aBean\n    @Bean\n    public ReactorLoadBalancer&lt;ServiceInstance&gt; randomLoadBalancer(Environment environment, LoadBalancerClientFactory loadBalancerClientFactory){\n        String name = environment.getProperty(LoadBalancerClientFactory.PROPERTY_NAME);\n        return new RandomLoadBalancer(loadBalancerClientFactory.getLazyProvider(name, ServiceInstanceListSupplier.class), name);\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u4e3a\u5bf9\u5e94\u7684\u670d\u52a1\u6307\u5b9a\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u76f4\u63a5\u4f7f\u7528\u6ce8\u89e3\u5373\u53ef\uff1a</p> <pre><code>@Configuration\n@LoadBalancerClient(value = \"userservice\",      //\u6307\u5b9a\u4e3a userservice \u670d\u52a1\uff0c\u53ea\u8981\u662f\u8c03\u7528\u6b64\u670d\u52a1\u90fd\u4f1a\u4f7f\u7528\u6211\u4eec\u6307\u5b9a\u7684\u7b56\u7565\n                    configuration = LoadBalancerConfig.class)   //\u6307\u5b9a\u6211\u4eec\u521a\u521a\u5b9a\u4e49\u597d\u7684\u914d\u7f6e\u7c7b\npublic class BeanConfig {\n    @Bean\n    @LoadBalanced\n    RestTemplate template(){\n        return new RestTemplate();\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728<code>BlockingLoadBalancerClient</code>\u4e2d\u6dfb\u52a0\u65ad\u70b9\uff0c\u89c2\u5bdf\u662f\u5426\u91c7\u7528\u6211\u4eec\u6307\u5b9a\u7684\u7b56\u7565\u8fdb\u884c\u8bf7\u6c42\uff1a</p> <p></p> <p></p> <p>\u53d1\u73b0\u8bbf\u95eeuserservice\u670d\u52a1\u7684\u7b56\u7565\u5df2\u7ecf\u66f4\u6539\u4e3a\u6211\u4eec\u6307\u5b9a\u7684\u7b56\u7565\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#openfeign","title":"OpenFeign\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861","text":"<p>\u5b98\u65b9\u6587\u6863\uff1ahttps://docs.spring.io/spring-cloud-openfeign/docs/current/reference/html/</p> <p>Feign\u548cRestTemplate\u4e00\u6837\uff0c\u4e5f\u662fHTTP\u5ba2\u6237\u7aef\u8bf7\u6c42\u5de5\u5177\uff0c\u4f46\u662f\u5b83\u7684\u4f7f\u7528\u65b9\u5f0f\u66f4\u52a0\u4fbf\u6377\u3002\u9996\u5148\u662f\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u5728\u542f\u52a8\u7c7b\u6dfb\u52a0<code>@EnableFeignClients</code>\u6ce8\u89e3\uff1a</p> <pre><code>@SpringBootApplication\n@EnableFeignClients\npublic class BorrowApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(BorrowApplication.class, args);\n    }\n}\n</code></pre> <p>\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u9700\u8981\u8c03\u7528\u5176\u4ed6\u5fae\u670d\u52a1\u63d0\u4f9b\u7684\u63a5\u53e3\uff0c\u8be5\u600e\u4e48\u505a\u5462\uff1f\u6211\u4eec\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u5bf9\u5e94\u670d\u52a1\u7684\u63a5\u53e3\u7c7b\u5373\u53ef\uff1a</p> <pre><code>@FeignClient(\"userservice\")   //\u58f0\u660e\u4e3auserservice\u670d\u52a1\u7684HTTP\u8bf7\u6c42\u5ba2\u6237\u7aef\npublic interface UserClient {\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u76f4\u63a5\u521b\u5efa\u6240\u9700\u7c7b\u578b\u7684\u65b9\u6cd5\uff0c\u6bd4\u5982\u6211\u4eec\u4e4b\u524d\u7684\uff1a</p> <pre><code>RestTemplate template = new RestTemplate();\nUser user = template.getForObject(\"http://userservice/user/\"+uid, User.class);\n</code></pre> <p>\u73b0\u5728\u53ef\u4ee5\u76f4\u63a5\u5199\u6210\u8fd9\u6837\uff1a</p> <pre><code>@FeignClient(\"userservice\")\npublic interface UserClient {\n\n    //\u8def\u5f84\u4fdd\u8bc1\u548c\u5176\u4ed6\u5fae\u670d\u52a1\u63d0\u4f9b\u7684\u4e00\u81f4\u5373\u53ef\n    @RequestMapping(\"/user/{uid}\")\n    User getUserById(@PathVariable(\"uid\") int uid);  //\u53c2\u6570\u548c\u8fd4\u56de\u503c\u4e5f\u4fdd\u6301\u4e00\u81f4\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u76f4\u63a5\u6ce8\u5165\u4f7f\u7528\uff08\u6709Mybatis\u90a3\u5473\u4e86\uff09\uff1a</p> <pre><code>@Resource\nUserClient userClient;\n\n@Override\npublic UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n    List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n\n    User user = userClient.getUserById(uid);\n    //\u8fd9\u91cc\u4e0d\u7528\u518d\u5199IP\uff0c\u76f4\u63a5\u5199\u670d\u52a1\u540d\u79f0bookservice\n    List&lt;Book&gt; bookList = borrow\n            .stream()\n            .map(b -&gt; template.getForObject(\"http://bookservice/book/\"+b.getBid(), Book.class))\n            .collect(Collectors.toList());\n    return new UserBorrowDetail(user, bookList);\n}\n</code></pre> <p>\u8bbf\u95ee\uff0c\u53ef\u4ee5\u770b\u5230\u7ed3\u679c\u4f9d\u7136\u662f\u6b63\u786e\u7684\uff1a</p> <p></p> <p>\u5e76\u4e14\u6211\u4eec\u53ef\u4ee5\u89c2\u5bdf\u4e00\u4e0b\u4e24\u4e2a\u7528\u6237\u5fae\u670d\u52a1\u7684\u8c03\u7528\u60c5\u51b5\uff0c\u4e5f\u662f\u4ee5\u8d1f\u8f7d\u5747\u8861\u7684\u5f62\u5f0f\u8fdb\u884c\u7684\u3002</p> <p>\u6309\u7167\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u63a5\u7740\u5c06\u56fe\u4e66\u7ba1\u7406\u670d\u52a1\u7684\u8c03\u7528\u4e5f\u6539\u6210\u63a5\u53e3\u5f62\u5f0f\uff1a</p> <p></p> <p>\u6700\u540e\u6211\u4eec\u7684Service\u4ee3\u7801\u5c31\u53d8\u6210\u4e86\uff1a</p> <pre><code>@Service\npublic class BorrowServiceImpl implements BorrowService {\n\n    @Resource\n    BorrowMapper mapper;\n\n    @Resource\n    UserClient userClient;\n\n    @Resource\n    BookClient bookClient;\n\n    @Override\n    public UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n        List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n\n        User user = userClient.getUserById(uid);\n        List&lt;Book&gt; bookList = borrow\n                .stream()\n                .map(b -&gt; bookClient.getBookById(b.getBid()))\n                .collect(Collectors.toList());\n        return new UserBorrowDetail(user, bookList);\n    }\n}\n</code></pre> <p>\u7ee7\u7eed\u8bbf\u95ee\u8fdb\u884c\u6d4b\u8bd5\uff1a</p> <p></p> <p>OK\uff0c\u6b63\u5e38\u3002</p> <p>\u5f53\u7136\uff0cFeign\u4e5f\u6709\u5f88\u591a\u7684\u5176\u4ed6\u914d\u7f6e\u9009\u9879\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u505a\u4ecb\u7ecd\u4e86\uff0c\u8be6\u7ec6\u8bf7\u67e5\u9605\u5b98\u65b9\u6587\u6863\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#hystrix","title":"Hystrix \u670d\u52a1\u7194\u65ad","text":"<p>\u5b98\u65b9\u6587\u6863\uff1ahttps://cloud.spring.io/spring-cloud-static/spring-cloud-netflix/1.3.5.RELEASE/single/spring-cloud-netflix.html#_circuit_breaker_hystrix_clients</p> <p>\u6211\u4eec\u77e5\u9053\uff0c\u5fae\u670d\u52a1\u4e4b\u95f4\u662f\u53ef\u4ee5\u8fdb\u884c\u76f8\u4e92\u8c03\u7528\u7684\uff0c\u90a3\u4e48\u5982\u679c\u51fa\u73b0\u4e86\u4e0b\u9762\u7684\u60c5\u51b5\u4f1a\u5bfc\u81f4\u4ec0\u4e48\u95ee\u9898\uff1f</p> <p></p> <p>\u7531\u4e8e\u4f4d\u4e8e\u6700\u5e95\u7aef\u7684\u670d\u52a1\u63d0\u4f9b\u8005E\u53d1\u751f\u6545\u969c\uff0c\u90a3\u4e48\u6b64\u65f6\u4f1a\u76f4\u63a5\u5bfc\u81f4\u670d\u52a1ABCD\u5168\u7ebf\u5d29\u6e83\uff0c\u5c31\u50cf\u96ea\u5d29\u4e86\u4e00\u6837\u3002</p> <p></p> <p>\u8fd9\u79cd\u95ee\u9898\u5b9e\u9645\u4e0a\u662f\u4e0d\u53ef\u907f\u514d\u7684\uff0c\u7531\u4e8e\u591a\u79cd\u56e0\u7d20\uff0c\u6bd4\u5982\u7f51\u7edc\u5361\u987f\u3001\u7cfb\u7edf\u6545\u969c\u3001\u786c\u4ef6\u95ee\u9898\u7b49\uff0c\u90fd\u5b58\u5728\u4e00\u5b9a\u53ef\u80fd\uff0c\u4f1a\u5bfc\u81f4\u8fd9\u79cd\u6781\u7aef\u7684\u60c5\u51b5\u53d1\u751f\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u5bfb\u627e\u4e00\u4e2a\u5e94\u5bf9\u8fd9\u79cd\u6781\u7aef\u60c5\u51b5\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u96ea\u5d29\u95ee\u9898\uff0cSpringCloud\u63d0\u4f9b\u4e86Hystrix\u7194\u65ad\u5668\u7ec4\u4ef6\uff0c\u4ed6\u5c31\u50cf\u6211\u4eec\u5bb6\u4e2d\u7684\u4fdd\u9669\u4e1d\u4e00\u6837\uff0c\u5f53\u7535\u6d41\u8fc7\u8f7d\u5c31\u4f1a\u76f4\u63a5\u7194\u65ad\uff0c\u9632\u6b62\u5371\u9669\u8fdb\u4e00\u6b65\u53d1\u751f\uff0c\u4ece\u800c\u4fdd\u8bc1\u5bb6\u5ead\u7528\u7535\u5b89\u5168\u3002\u53ef\u4ee5\u60f3\u8c61\u4e00\u4e0b\uff0c\u5982\u679c\u6574\u6761\u94fe\u8def\u4e0a\u7684\u670d\u52a1\u5df2\u7ecf\u5168\u7ebf\u5d29\u6e83\uff0c\u8fd9\u65f6\u8fd8\u5728\u4e0d\u65ad\u5730\u6709\u5927\u91cf\u7684\u8bf7\u6c42\u5230\u8fbe\uff0c\u9700\u8981\u5404\u4e2a\u670d\u52a1\u8fdb\u884c\u5904\u7406\uff0c\u80af\u5b9a\u662f\u4f1a\u4f7f\u5f97\u60c5\u51b5\u8d8a\u6765\u8d8a\u7cdf\u7cd5\u7684\u3002</p> <p>\u6211\u4eec\u6765\u8be6\u7ec6\u770b\u770b\u5b83\u7684\u5de5\u4f5c\u673a\u5236\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_9","title":"\u670d\u52a1\u964d\u7ea7","text":"<p>\u9996\u5148\u6211\u4eec\u6765\u770b\u770b\u670d\u52a1\u964d\u7ea7\uff0c\u6ce8\u610f\u4e00\u5b9a\u8981\u533a\u5206\u5f00\u670d\u52a1\u964d\u7ea7\u548c\u670d\u52a1\u7194\u65ad\u7684\u533a\u522b\uff0c\u670d\u52a1\u964d\u7ea7\u5e76\u4e0d\u4f1a\u76f4\u63a5\u8fd4\u56de\u9519\u8bef\uff0c\u800c\u662f\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u8865\u6551\u63aa\u65bd\uff0c\u6b63\u5e38\u54cd\u5e94\u7ed9\u8bf7\u6c42\u8005\u3002\u8fd9\u6837\u76f8\u5f53\u4e8e\u670d\u52a1\u4f9d\u7136\u53ef\u7528\uff0c\u4f46\u662f\u670d\u52a1\u80fd\u529b\u80af\u5b9a\u662f\u4e0b\u964d\u4e86\u7684\u3002</p> <p>\u6211\u4eec\u5c31\u57fa\u4e8e\u501f\u9605\u7ba1\u7406\u670d\u52a1\u6765\u8fdb\u884c\u8bb2\u89e3\uff0c\u6211\u4eec\u4e0d\u5f00\u542f\u7528\u6237\u670d\u52a1\u548c\u56fe\u4e66\u670d\u52a1\uff0c\u8868\u793a\u7528\u6237\u670d\u52a1\u548c\u56fe\u4e66\u670d\u52a1\u5df2\u7ecf\u6302\u6389\u4e86\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5bfc\u5165Hystrix\u7684\u4f9d\u8d56\uff08\u6b64\u9879\u76ee\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\uff0cSpringCloud\u4f9d\u8d56\u4e2d\u5df2\u7ecf\u4e0d\u81ea\u5e26\u4e86\uff0c\u6240\u4ee5\u8bf4\u9700\u8981\u81ea\u5df1\u5355\u72ec\u5bfc\u5165\uff09\uff1a</p> <pre><code>   &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;\n            &lt;version&gt;2.2.10.RELEASE&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5728\u542f\u52a8\u7c7b\u6dfb\u52a0\u6ce8\u89e3\u5f00\u542f\uff1a</p> <pre><code>@SpringBootApplication\n@EnableHystrix   //\u542f\u7528Hystrix\npublic class BorrowApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(BorrowApplication.class, args);\n    }\n}\n</code></pre> <p>\u90a3\u4e48\u73b0\u5728\uff0c\u7531\u4e8e\u7528\u6237\u670d\u52a1\u548c\u56fe\u4e66\u670d\u52a1\u4e0d\u53ef\u7528\uff0c\u6240\u4ee5\u67e5\u8be2\u501f\u9605\u4fe1\u606f\u7684\u8bf7\u6c42\u80af\u5b9a\u662f\u6ca1\u529e\u6cd5\u6b63\u5e38\u54cd\u5e94\u7684\uff0c\u8fd9\u65f6\u6211\u4eec\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u5907\u9009\u65b9\u6848\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u670d\u52a1\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u8fd4\u56de\u6211\u4eec\u7684\u5907\u9009\u65b9\u6848\uff1a</p> <pre><code>@RestController\npublic class BorrowController {\n\n    @Resource\n    BorrowService service;\n\n    @HystrixCommand(fallbackMethod = \"onError\")    //\u4f7f\u7528@HystrixCommand\u6765\u6307\u5b9a\u5907\u9009\u65b9\u6848\n    @RequestMapping(\"/borrow/{uid}\")\n    UserBorrowDetail findUserBorrows(@PathVariable(\"uid\") int uid){\n        return service.getUserBorrowDetailByUid(uid);\n    }\n\n    //\u5907\u9009\u65b9\u6848\uff0c\u8fd9\u91cc\u76f4\u63a5\u8fd4\u56de\u7a7a\u5217\u8868\u4e86\n    //\u6ce8\u610f\u53c2\u6570\u548c\u8fd4\u56de\u503c\u8981\u548c\u4e0a\u9762\u7684\u4e00\u81f4\n    UserBorrowDetail onError(int uid){\n        return new UserBorrowDetail(null, Collections.emptyList());\n    }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u867d\u7136\u6211\u4eec\u7684\u670d\u52a1\u65e0\u6cd5\u6b63\u5e38\u8fd0\u884c\u4e86\uff0c\u4f46\u662f\u4f9d\u7136\u53ef\u4ee5\u7ed9\u6d4f\u89c8\u5668\u6b63\u5e38\u8fd4\u56de\u54cd\u5e94\u6570\u636e\uff1a</p> <p></p> <p></p> <p>\u670d\u52a1\u964d\u7ea7\u662f\u4e00\u79cd\u6bd4\u8f83\u6e29\u67d4\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u867d\u7136\u670d\u52a1\u672c\u8eab\u7684\u4e0d\u53ef\u7528\uff0c\u4f46\u662f\u80fd\u591f\u4fdd\u8bc1\u6b63\u5e38\u54cd\u5e94\u6570\u636e\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_10","title":"\u670d\u52a1\u7194\u65ad","text":"<p>\u7194\u65ad\u673a\u5236\u662f\u5e94\u5bf9\u96ea\u5d29\u6548\u5e94\u7684\u4e00\u79cd\u5fae\u670d\u52a1\u94fe\u8def\u4fdd\u62a4\u673a\u5236\uff0c\u5f53\u68c0\u6d4b\u51fa\u94fe\u8def\u7684\u67d0\u4e2a\u5fae\u670d\u52a1\u4e0d\u53ef\u7528\u6216\u8005\u54cd\u5e94\u65f6\u95f4\u592a\u957f\u65f6\uff0c\u4f1a\u8fdb\u884c\u670d\u52a1\u7684\u964d\u7ea7\uff0c\u8fdb\u800c\u7194\u65ad\u8be5\u8282\u70b9\u5fae\u670d\u52a1\u7684\u8c03\u7528\uff0c\u5feb\u901f\u8fd4\u56de\u201d\u9519\u8bef\u201d\u7684\u54cd\u5e94\u4fe1\u606f\u3002\u5f53\u68c0\u6d4b\u5230\u8be5\u8282\u70b9\u5fae\u670d\u52a1\u54cd\u5e94\u6b63\u5e38\u540e\u6062\u590d\u8c03\u7528\u94fe\u8def\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u7194\u65ad\u5c31\u662f\u5728\u964d\u7ea7\u7684\u57fa\u7840\u4e0a\u8fdb\u4e00\u6b65\u5347\u7ea7\u5f62\u6210\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u591a\u6b21\u8c03\u7528\u5931\u8d25\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u5347\u7ea7\u4e3a\u7194\u65ad\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u6dfb\u52a0\u4e24\u6761\u8f93\u51fa\u8bed\u53e5\uff1a</p> <pre><code>@RestController\npublic class BorrowController {\n\n    @Resource\n    BorrowService service;\n\n    @HystrixCommand(fallbackMethod = \"onError\")\n    @RequestMapping(\"/borrow/{uid}\")\n    UserBorrowDetail findUserBorrows(@PathVariable(\"uid\") int uid){\n        System.out.println(\"\u5f00\u59cb\u5411\u5176\u4ed6\u670d\u52a1\u83b7\u53d6\u4fe1\u606f\");\n        return service.getUserBorrowDetailByUid(uid);\n    }\n\n    UserBorrowDetail onError(int uid){\n        System.out.println(\"\u670d\u52a1\u9519\u8bef\uff0c\u8fdb\u5165\u5907\u9009\u65b9\u6cd5\uff01\");\n        return new UserBorrowDetail(null, Collections.emptyList());\n    }\n}\n</code></pre> <p>\u63a5\u7740\uff0c\u6211\u4eec\u5728\u6d4f\u89c8\u5668\u4e2d\u75af\u72c2\u70b9\u51fb\u5237\u65b0\u6309\u94ae\uff0c\u5bf9\u6b64\u670d\u52a1\u75af\u72c2\u53d1\u8d77\u8bf7\u6c42\uff0c\u53ef\u4ee5\u770b\u5230\u540e\u53f0\uff1a</p> <p></p> <p>\u4e00\u5f00\u59cb\u7684\u65f6\u5019\uff0c\u4f1a\u6b63\u5e38\u5730\u53bb\u8c03\u7528Controller\u5bf9\u5e94\u7684\u65b9\u6cd5<code>findUserBorrows</code>\uff0c\u53d1\u73b0\u5931\u8d25\u7136\u540e\u8fdb\u5165\u5907\u9009\u65b9\u6cd5\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u5728\u6301\u7eed\u8bf7\u6c42\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\uff0c\u6ca1\u6709\u518d\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u800c\u662f\u76f4\u63a5\u8c03\u7528\u5907\u9009\u65b9\u6848\uff0c\u8fd9\u4fbf\u662f\u5347\u7ea7\u5230\u4e86\u7194\u65ad\u72b6\u6001\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u4e0d\u65ad\u70b9\u51fb\uff0c\u7ee7\u7eed\u4e0d\u65ad\u5730\u53d1\u8d77\u8bf7\u6c42\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fc7\u4e86\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\uff0c\u4f1a\u5c1d\u8bd5\u6b63\u5e38\u6267\u884c\u4e00\u6b21<code>findUserBorrows</code>\uff0c\u4f46\u662f\u4f9d\u7136\u662f\u5931\u8d25\u72b6\u6001\uff0c\u6240\u4ee5\u7ee7\u7eed\u4fdd\u6301\u7194\u65ad\u72b6\u6001\u3002</p> <p>\u6240\u4ee5\u5f97\u5230\u7ed3\u8bba\uff0c\u5b83\u80fd\u591f\u5bf9\u4e00\u6bb5\u65f6\u95f4\u5185\u51fa\u73b0\u7684\u9519\u8bef\u8fdb\u884c\u4fa6\u6d4b\uff0c\u5f53\u4fa6\u6d4b\u5230\u51fa\u9519\u6b21\u6570\u8fc7\u591a\u65f6\uff0c\u7194\u65ad\u5668\u4f1a\u6253\u5f00\uff0c\u6240\u6709\u7684\u8bf7\u6c42\u4f1a\u76f4\u63a5\u54cd\u5e94\u5931\u8d25\uff0c\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u53ea\u6267\u884c\u4e00\u5b9a\u6570\u91cf\u7684\u8bf7\u6c42\uff0c\u5982\u679c\u8fd8\u662f\u51fa\u73b0\u9519\u8bef\uff0c\u90a3\u4e48\u5219\u7ee7\u7eed\u4fdd\u6301\u6253\u5f00\u72b6\u6001\uff0c\u5426\u5219\u8bf4\u660e\u670d\u52a1\u6062\u590d\u6b63\u5e38\u8fd0\u884c\uff0c\u5173\u95ed\u7194\u65ad\u5668\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u5f00\u542f\u53e6\u5916\u4e24\u4e2a\u670d\u52a1\u4e4b\u540e\uff0c\u7ee7\u7eed\u70b9\u51fb\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5f53\u53e6\u5916\u4e24\u4e2a\u670d\u52a1\u6b63\u5e38\u8fd0\u884c\u4e4b\u540e\uff0c\u5f53\u518d\u6b21\u5c1d\u8bd5\u8c03\u7528<code>findUserBorrows</code>\u4e4b\u540e\u4f1a\u6210\u529f\uff0c\u4e8e\u662f\u7194\u65ad\u673a\u5236\u5c31\u5173\u95ed\u4e86\uff0c\u670d\u52a1\u6062\u590d\u8fd0\u884c\u3002</p> <p>\u603b\u7ed3\u4e00\u4e0b\uff1a</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#openfeign_1","title":"OpenFeign\u5b9e\u73b0\u964d\u7ea7","text":"<p>Hystrix\u4e5f\u53ef\u4ee5\u914d\u5408Feign\u8fdb\u884c\u964d\u7ea7\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u5e94\u63a5\u53e3\u4e2d\u5b9a\u4e49\u7684\u8fdc\u7a0b\u8c03\u7528\u5355\u72ec\u8fdb\u884c\u964d\u7ea7\u64cd\u4f5c\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u8fd8\u662f\u4ee5\u7528\u6237\u670d\u52a1\u6302\u6389\u4e3a\u4f8b\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u80af\u5b9a\u662f\u4f1a\u8fdc\u7a0b\u8c03\u7528\u5931\u8d25\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u7684Controller\u4e2d\u7684\u65b9\u6cd5\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u76f4\u63a5\u629b\u51fa\u5f02\u5e38\uff0c\u8fdb\u800c\u88abHystrix\u76d1\u63a7\u5230\u5e76\u8fdb\u884c\u670d\u52a1\u964d\u7ea7\u3002</p> <p>\u800c\u5b9e\u9645\u4e0a\u5bfc\u81f4\u65b9\u6cd5\u6267\u884c\u5f02\u5e38\u7684\u6839\u6e90\u5c31\u662f\u8fdc\u7a0b\u8c03\u7528\u5931\u8d25\uff0c\u6240\u4ee5\u6211\u4eec\u6362\u4e2a\u601d\u8def\uff0c\u65e2\u7136\u7528\u6237\u670d\u52a1\u8c03\u7528\u5931\u8d25\uff0c\u90a3\u4e48\u6211\u5c31\u7ed9\u8fd9\u4e2a\u8fdc\u7a0b\u8c03\u7528\u6dfb\u52a0\u4e00\u4e2a\u66ff\u4ee3\u65b9\u6848\uff0c\u5982\u679c\u6b64\u8fdc\u7a0b\u8c03\u7528\u5931\u8d25\uff0c\u90a3\u4e48\u5c31\u76f4\u63a5\u4e0a\u66ff\u4ee3\u65b9\u6848\u3002\u90a3\u4e48\u600e\u4e48\u5b9e\u73b0\u66ff\u4ee3\u65b9\u6848\u5462\uff1f\u6211\u4eec\u77e5\u9053Feign\u90fd\u662f\u4ee5\u63a5\u53e3\u7684\u5f62\u5f0f\u6765\u58f0\u660e\u8fdc\u7a0b\u8c03\u7528\uff0c\u90a3\u4e48\u65e2\u7136\u8fdc\u7a0b\u8c03\u7528\u5df2\u7ecf\u5931\u6548\uff0c\u6211\u4eec\u5c31\u81ea\u884c\u5bf9\u5176\u8fdb\u884c\u5b9e\u73b0\uff0c\u521b\u5efa\u4e00\u4e2a\u5b9e\u73b0\u7c7b\uff0c\u5bf9\u539f\u6709\u7684\u63a5\u53e3\u65b9\u6cd5\u8fdb\u884c\u66ff\u4ee3\u65b9\u6848\u5b9e\u73b0\uff1a</p> <pre><code>@Component   //\u6ce8\u610f\uff0c\u9700\u8981\u5c06\u5176\u6ce8\u518c\u4e3aBean\uff0cFeign\u624d\u80fd\u81ea\u52a8\u6ce8\u5165\npublic class UserFallbackClient implements UserClient{\n    @Override\n    public User getUserById(int uid) {   //\u8fd9\u91cc\u6211\u4eec\u81ea\u884c\u5bf9\u5176\u8fdb\u884c\u5b9e\u73b0\uff0c\u5e76\u8fd4\u56de\u6211\u4eec\u7684\u66ff\u4ee3\u65b9\u6848\n        User user = new User();\n        user.setName(\"\u6211\u662f\u66ff\u4ee3\u65b9\u6848\");\n        return user;\n    }\n}\n</code></pre> <p>\u5b9e\u73b0\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u539f\u6709\u7684\u63a5\u53e3\u4e2d\u6307\u5b9a\u5931\u8d25\u66ff\u4ee3\u5b9e\u73b0\u5373\u53ef\uff1a</p> <pre><code>//fallback\u53c2\u6570\u6307\u5b9a\u4e3a\u6211\u4eec\u521a\u521a\u7f16\u5199\u7684\u5b9e\u73b0\u7c7b\n@FeignClient(value = \"userservice\", fallback = UserFallbackClient.class)\npublic interface UserClient {\n\n    @RequestMapping(\"/user/{uid}\")\n    User getUserById(@PathVariable(\"uid\") int uid);\n}\n</code></pre> <p>\u73b0\u5728\u53bb\u6389<code>BorrowController</code>\u7684<code>@HystrixCommand</code>\u6ce8\u89e3\u548c\u5907\u9009\u65b9\u6cd5\uff1a</p> <pre><code>@RestController\npublic class BorrowController {\n\n    @Resource\n    BorrowService service;\n\n    @RequestMapping(\"/borrow/{uid}\")\n    UserBorrowDetail findUserBorrows(@PathVariable(\"uid\") int uid){\n        return service.getUserBorrowDetailByUid(uid);\n    }\n}\n</code></pre> <p>\u6700\u540e\u6211\u4eec\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f00\u542f\u7194\u65ad\u652f\u6301\uff1a</p> <pre><code>feign:\n  circuitbreaker:\n    enabled: true\n</code></pre> <p>\u542f\u52a8\u670d\u52a1\uff0c\u8c03\u7528\u63a5\u53e3\u8bd5\u8bd5\u770b\uff1a</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u73b0\u5728\u5df2\u7ecf\u91c7\u7528\u6211\u4eec\u7684\u66ff\u4ee3\u65b9\u6848\u4f5c\u4e3a\u7ed3\u679c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_11","title":"\u76d1\u63a7\u9875\u9762\u90e8\u7f72","text":"<p>\u9664\u4e86\u5bf9\u670d\u52a1\u7684\u964d\u7ea7\u548c\u7194\u65ad\u5904\u7406\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u5b9e\u65f6\u76d1\u63a7\uff0c\u53ea\u9700\u8981\u5b89\u88c5\u76d1\u63a7\u9875\u9762\u5373\u53ef\uff0c\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9879\u76ee\uff0c\u5bfc\u5165\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix-dashboard&lt;/artifactId&gt;\n    &lt;version&gt;2.2.10.RELEASE&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6dfb\u52a0\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>server:\n  port: 8900\nhystrix:\n  dashboard:\n    # \u5c06localhost\u6dfb\u52a0\u5230\u767d\u540d\u5355\uff0c\u9ed8\u8ba4\u662f\u4e0d\u5141\u8bb8\u7684\n    proxy-stream-allow-list: \"localhost\"\n</code></pre> <p>\u63a5\u7740\u521b\u5efa\u4e3b\u7c7b\uff0c\u6ce8\u610f\u9700\u8981\u6dfb\u52a0<code>@EnableHystrixDashboard</code>\u6ce8\u89e3\u5f00\u542f\u7ba1\u7406\u9875\u9762\uff1a</p> <pre><code>@SpringBootApplication\n@EnableHystrixDashboard\npublic class HystrixDashBoardApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(HystrixDashBoardApplication.class, args);\n    }\n}\n</code></pre> <p>\u542f\u52a8Hystrix\u7ba1\u7406\u9875\u9762\u670d\u52a1\uff0c\u7136\u540e\u6211\u4eec\u9700\u8981\u5728\u8981\u8fdb\u884c\u76d1\u63a7\u7684\u670d\u52a1\u4e2d\u6dfb\u52a0Actuator\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>Actuator\u662fSpringBoot\u7a0b\u5e8f\u7684\u76d1\u63a7\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5065\u5eb7\u68c0\u67e5\uff0c\u8bb0\u5f55\u4fe1\u606f\u7b49\u3002\u5728\u4f7f\u7528\u4e4b\u524d\u9700\u8981\u5f15\u5165spring-boot-starter-actuator\uff0c\u5e76\u505a\u7b80\u5355\u7684\u914d\u7f6e\u5373\u53ef\u3002</p> <p>\u6dfb\u52a0\u6b64\u4f9d\u8d56\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5728IDEA\u4e2d\u67e5\u770b\u8fd0\u884c\u60c5\u51b5\uff1a</p> <p></p> <p>\u7136\u540e\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6eActuator\u6dfb\u52a0\u66b4\u9732\uff1a</p> <pre><code>management:\n  endpoints:\n    web:\n      exposure:\n        include: '*'\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6253\u5f00\u521a\u521a\u542f\u52a8\u7684\u7ba1\u7406\u9875\u9762\uff0c\u5730\u5740\u4e3a\uff1ahttp://localhost:8900/hystrix/</p> <p></p> <p>\u5728\u4e2d\u95f4\u586b\u5199\u8981\u76d1\u63a7\u7684\u670d\u52a1\uff1a\u6bd4\u5982\u501f\u9605\u670d\u52a1\uff1ahttp://localhost:8301/actuator/hystrix.stream\uff0c\u6ce8\u610f\u540e\u9762\u8981\u6dfb\u52a0<code>/actuator/hystrix.stream</code>\uff0c\u7136\u540e\u70b9\u51fbMonitor Stream\u5373\u53ef\u8fdb\u5165\u76d1\u63a7\u9875\u9762\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u73b0\u5728\u90fd\u662fLoading\u72b6\u6001\uff0c\u8fd9\u662f\u56e0\u4e3a\u8fd8\u6ca1\u6709\u5f00\u59cb\u7edf\u8ba1\uff0c\u6211\u4eec\u73b0\u5728\u5c1d\u8bd5\u8c03\u7528\u51e0\u6b21\u6211\u4eec\u7684\u670d\u52a1\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u8c03\u7528\u4e4b\u540e\uff0c\u76d1\u63a7\u9875\u9762\u51fa\u73b0\u4e86\u4fe1\u606f\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u52305\u6b21\u8bbf\u95ee\u90fd\u662f\u6b63\u5e38\u7684\uff0c\u6240\u4ee5\u663e\u793a\u4e3a\u7eff\u8272\uff0c\u63a5\u7740\u6211\u4eec\u6765\u5c1d\u8bd5\u5c06\u56fe\u4e66\u670d\u52a1\u5173\u95ed\uff0c\u8fd9\u6837\u5c31\u4f1a\u5bfc\u81f4\u670d\u52a1\u964d\u7ea7\u751a\u81f3\u7194\u65ad\uff0c\u7136\u540e\u518d\u591a\u6b21\u8bbf\u95ee\u6b64\u670d\u52a1\u770b\u770b\u76d1\u63a7\u4f1a\u5982\u4f55\u53d8\u5316\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u9519\u8bef\u7387\u76f4\u63a5\u98d9\u5347\u5230100%\uff0c\u5e76\u4e14\u4e00\u6bb5\u65f6\u95f4\u5185\u6301\u7eed\u51fa\u73b0\u9519\u8bef\uff0c\u4e2d\u5fc3\u7684\u5706\u5708\u4e5f\u53d8\u6210\u4e86\u7ea2\u8272\uff0c\u6211\u4eec\u7ee7\u7eed\u8fdb\u884c\u8bbf\u95ee\uff1a</p> <p></p> <p>\u5728\u51fa\u73b0\u5927\u91cf\u9519\u8bef\u7684\u60c5\u51b5\u4e0b\u4fdd\u6301\u6301\u7eed\u8bbf\u95ee\uff0c\u53ef\u4ee5\u770b\u5230\u6b64\u65f6\u5df2\u7ecf\u5c06\u670d\u52a1\u7194\u65ad\uff0c<code>Circuit</code>\u66f4\u6539\u4e3aOpen\u72b6\u6001\uff0c\u5e76\u4e14\u56fe\u4e2d\u7684\u5706\u5708\u4e5f\u53d8\u5f97\u66f4\u5927\uff0c\u8868\u793a\u538b\u529b\u5728\u6301\u7eed\u4e0a\u5347\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#gateway","title":"Gateway \u8def\u7531\u7f51\u5173","text":"<p>\u5b98\u7f51\u5730\u5740\uff1ahttps://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/</p> <p>\u8bf4\u5230\u8def\u7531\uff0c\u60f3\u5fc5\u5404\u4f4d\u4e00\u5b9a\u6700\u5148\u60f3\u5230\u7684\u5c31\u662f\u5bb6\u91cc\u7684\u8def\u7531\u5668\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u5bb6\u91cc\u7684\u8def\u7531\u5668\u5145\u5f53\u7684\u662f\u4e00\u4e2a\u4ec0\u4e48\u89d2\u8272\u5462\uff1f</p> <p>\u6211\u4eec\u77e5\u9053\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u8fde\u63a5\u4e92\u8054\u7f51\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5c06\u624b\u673a\u6216\u662f\u7535\u8111\u8fde\u63a5\u5230\u5bb6\u91cc\u7684\u8def\u7531\u5668\u624d\u53ef\u4ee5\uff0c\u800c\u8def\u7531\u5668\u5219\u8fde\u63a5\u5149\u732b\uff0c\u5149\u732b\u518d\u901a\u8fc7\u5149\u7ea4\u8fde\u63a5\u5230\u4e92\u8054\u7f51\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e92\u8054\u7f51\u65b9\u5411\u53d1\u9001\u8fc7\u6765\u7684\u6570\u636e\uff0c\u9700\u8981\u7ecf\u8fc7\u8def\u7531\u5668\u624d\u80fd\u5230\u8fbe\u6211\u4eec\u7684\u8bbe\u5907\u3002\u800c\u8def\u7531\u5668\u5145\u5f53\u7684\u5c31\u662f\u6570\u636e\u5305\u4e2d\u8f6c\u7ad9\uff0c\u6240\u6709\u7684\u5c40\u57df\u7f51\u8bbe\u5907\u90fd\u65e0\u6cd5\u76f4\u63a5\u4e0e\u4e92\u8054\u7f51\u8fde\u63a5\uff0c\u800c\u662f\u9700\u8981\u7ecf\u8fc7\u8def\u7531\u5668\u8fdb\u884c\u4e2d\u8f6c\uff0c\u6211\u4eec\u4e00\u822c\u8bf4\u8def\u7531\u5668\u4e0b\u7684\u7f51\u7edc\u662f\u5185\u7f51\uff0c\u800c\u4e92\u8054\u7f51\u90a3\u4e00\u7aef\u662f\u5916\u7f51\u3002</p> <p></p> <p>\u6211\u4eec\u7684\u5c40\u57df\u7f51\u8bbe\u5907\uff0c\u65e0\u6cd5\u88ab\u4e92\u8054\u7f51\u4e0a\u7684\u5176\u4ed6\u8bbe\u5907\u76f4\u63a5\u8bbf\u95ee\uff0c\u80af\u5b9a\u662f\u80fd\u591f\u4fdd\u8bc1\u5230\u5b89\u5168\u6027\u7684\u3002\u5e76\u4e92\u8054\u7f51\u53d1\u9001\u8fc7\u6765\u7684\u6570\u636e\uff0c\u9700\u8981\u7ecf\u8fc7\u8def\u7531\u5668\u8fdb\u884c\u89e3\u6790\uff0c\u8bc6\u522b\u5230\u5e95\u662f\u54ea\u4e00\u4e2a\u8bbe\u5907\u7684\u6570\u636e\u5305\uff0c\u7136\u540e\u518d\u53d1\u9001\u7ed9\u5bf9\u5e94\u7684\u8bbe\u5907\u3002</p> <p>\u800c\u6211\u4eec\u7684\u5fae\u670d\u52a1\u4e5f\u662f\u8fd9\u6837\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5fae\u670d\u52a1\u90fd\u9700\u8981\u76f4\u63a5\u66b4\u9732\u7ed9\u5916\u90e8\u8c03\u7528\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u8def\u7531\u673a\u5236\uff0c\u6dfb\u52a0\u4e00\u5c42\u9632\u62a4\uff0c\u8ba9\u6240\u6709\u7684\u8bf7\u6c42\u5168\u90e8\u901a\u8fc7\u8def\u7531\u6765\u8f6c\u53d1\u5230\u5404\u4e2a\u5fae\u670d\u52a1\uff0c\u5e76\u4e14\u8f6c\u53d1\u7ed9\u591a\u4e2a\u76f8\u540c\u5fae\u670d\u52a1\u5b9e\u4f8b\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u3002</p> <p></p> <p>\u5728\u4e4b\u524d\uff0c\u8def\u7531\u7684\u5b9e\u73b0\u4e00\u822c\u4f7f\u7528Zuul\uff0c\u4f46\u662f\u5df2\u7ecf\u505c\u66f4\uff0c\u800c\u73b0\u5728\u65b0\u51fa\u73b0\u4e86\u7531SpringCloud\u5b98\u65b9\u5f00\u53d1\u7684Gateway\u8def\u7531\uff0c\u5b83\u76f8\u6bd4Zuul\u4e0d\u4ec5\u6027\u80fd\u4e0a\u5f97\u5230\u4e86\u4e00\u5b9a\u7684\u63d0\u5347\uff0c\u5e76\u4e14\u662f\u5b98\u65b9\u63a8\u51fa\uff0c\u5951\u5408\u6027\u4e5f\u4f1a\u66f4\u597d\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u5c31\u4e3b\u8981\u8bb2\u89e3Gateway\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_12","title":"\u90e8\u7f72\u7f51\u5173","text":"<p>\u73b0\u5728\u6211\u4eec\u6765\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9879\u76ee\uff0c\u4f5c\u4e3a\u6211\u4eec\u7684\u7f51\u5173\uff0c\u8fd9\u91cc\u9700\u8981\u6dfb\u52a0\u4e24\u4e2a\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre> <p>\u7b2c\u4e00\u4e2a\u4f9d\u8d56\u5c31\u662f\u7f51\u5173\u7684\u4f9d\u8d56\uff0c\u800c\u7b2c\u4e8c\u4e2a\u5219\u8ddf\u5176\u4ed6\u5fae\u670d\u52a1\u4e00\u6837\uff0c\u9700\u8981\u6ce8\u518c\u5230Eureka\u624d\u80fd\u751f\u6548\uff0c\u6ce8\u610f\u522b\u6dfb\u52a0Web\u4f9d\u8d56\uff0c\u4f7f\u7528\u7684\u662fWebFlux\u6846\u67b6\u3002</p> <p>\u7136\u540e\u6211\u4eec\u6765\u5b8c\u5584\u4e00\u4e0b\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>server:\n  port: 8500\neureka:\n  client:\n    service-url:\n      defaultZone: http://localhost:8801/eureka, http://localhost:8802/eureka\nspring:\n  application:\n    name: gateway\n</code></pre> <p>\u73b0\u5728\u5c31\u53ef\u4ee5\u542f\u52a8\u4e86\uff1a</p> <p></p> <p>\u4f46\u662f\u73b0\u5728\u8fd8\u6ca1\u6709\u914d\u7f6e\u4efb\u4f55\u7684\u8def\u7531\u529f\u80fd\uff0c\u6211\u4eec\u63a5\u7740\u5c06\u8def\u7531\u529f\u80fd\u8fdb\u884c\u914d\u7f6e\uff1a</p> <pre><code>spring:\n  cloud:\n    gateway:\n        # \u914d\u7f6e\u8def\u7531\uff0c\u6ce8\u610f\u8fd9\u91cc\u662f\u4e2a\u5217\u8868\uff0c\u6bcf\u4e00\u9879\u90fd\u5305\u542b\u4e86\u5f88\u591a\u4fe1\u606f\n      routes:\n        - id: borrow-service   # \u8def\u7531\u540d\u79f0\n          uri: lb://borrowservice  # \u8def\u7531\u7684\u5730\u5740\uff0clb\u8868\u793a\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u5230\u5fae\u670d\u52a1\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528http\u6b63\u5e38\u8f6c\u53d1\n          predicates: # \u8def\u7531\u89c4\u5219\uff0c\u65ad\u8a00\u4ec0\u4e48\u8bf7\u6c42\u4f1a\u88ab\u8def\u7531\n            - Path=/borrow/**  # \u53ea\u8981\u662f\u8bbf\u95ee\u7684\u8fd9\u4e2a\u8def\u5f84\uff0c\u4e00\u5f8b\u90fd\u88ab\u8def\u7531\u5230\u4e0a\u9762\u6307\u5b9a\u7684\u670d\u52a1\n</code></pre> <p>\u8def\u7531\u89c4\u5219\u7684\u8be6\u7ec6\u5217\u8868\uff08\u65ad\u8a00\u5de5\u5382\u5217\u8868\uff09\u5728\u8fd9\u91cc\uff1ahttps://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gateway-request-predicates-factories\uff0c\u53ef\u4ee5\u6307\u5b9a\u591a\u79cd\u7c7b\u578b\uff0c\u5305\u62ec\u6307\u5b9a\u65f6\u95f4\u6bb5\u3001Cookie\u643a\u5e26\u60c5\u51b5\u3001Header\u643a\u5e26\u60c5\u51b5\u3001\u8bbf\u95ee\u7684\u57df\u540d\u5730\u5740\u3001\u8bbf\u95ee\u7684\u65b9\u6cd5\u3001\u8def\u5f84\u3001\u53c2\u6570\u3001\u8bbf\u95ee\u8005IP\u7b49\u3002\u4e5f\u53ef\u4ee5\u4f7f\u7528\u914d\u7f6e\u7c7b\u8fdb\u884c\u914d\u7f6e\uff0c\u4f46\u662f\u8fd8\u662f\u63a8\u8350\u76f4\u63a5\u914d\u7f6e\u6587\u4ef6\uff0c\u7701\u4e8b\u3002</p> <p>\u63a5\u7740\u542f\u52a8\u7f51\u5173\uff0c\u642d\u8f7dArm\u67b6\u6784\u82af\u7247\u7684Mac\u7535\u8111\u53ef\u80fd\u4f1a\u9047\u5230\u8fd9\u4e2a\u95ee\u9898\uff1a</p> <p></p> <p>\u8fd9\u662f\u56e0\u4e3a\u6ca1\u6709\u627e\u5230\u9002\u7528\u4e8e\u6b64\u67b6\u6784\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u4e0d\u5f71\u54cd\u4f7f\u7528\uff0c\u65e0\u89c6\u5373\u53ef\uff0c\u5e0c\u671b\u4ee5\u540e\u7684\u7248\u672c\u80fd\u4fee\u590d\u5427\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u8def\u7531\u6765\u8bbf\u95ee\u6211\u4eec\u7684\u670d\u52a1\u4e86\uff1a</p> <p></p> <p>\u6ce8\u610f\u6b64\u65f6\u4f9d\u7136\u53ef\u4ee5\u901a\u8fc7\u539f\u6709\u7684\u670d\u52a1\u5730\u5740\u8fdb\u884c\u8bbf\u95ee\uff1a</p> <p></p> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u4e0d\u9700\u8981\u5916\u7f51\u76f4\u63a5\u8bbf\u95ee\u7684\u5fae\u670d\u52a1\u5168\u90e8\u653e\u5230\u5185\u7f51\u73af\u5883\u4e0b\uff0c\u800c\u53ea\u4f9d\u9760\u7f51\u5173\u6765\u5bf9\u5916\u8fdb\u884c\u4ea4\u6d89\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_13","title":"\u8def\u7531\u8fc7\u6ee4\u5668","text":"<p>\u8def\u7531\u8fc7\u6ee4\u5668\u652f\u6301\u4ee5\u67d0\u79cd\u65b9\u5f0f\u4fee\u6539\u4f20\u5165\u7684 HTTP \u8bf7\u6c42\u6216\u4f20\u51fa\u7684 HTTP \u54cd\u5e94\uff0c\u8def\u7531\u8fc7\u6ee4\u5668\u7684\u8303\u56f4\u662f\u67d0\u4e00\u4e2a\u8def\u7531\uff0c\u8ddf\u4e4b\u524d\u7684\u65ad\u8a00\u4e00\u6837\uff0cSpring Cloud Gateway \u4e5f\u5305\u542b\u8bb8\u591a\u5185\u7f6e\u7684\u8def\u7531\u8fc7\u6ee4\u5668\u5de5\u5382\uff0c\u8be6\u7ec6\u5217\u8868\uff1ahttps://docs.spring.io/spring-cloud-gateway/docs/current/reference/html/#gatewayfilter-factories</p> <p>\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u5e0c\u671b\u5728\u8bf7\u6c42\u5230\u8fbe\u65f6\uff0c\u5728\u8bf7\u6c42\u5934\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u4fe1\u606f\u518d\u8f6c\u53d1\u7ed9\u6211\u4eec\u7684\u670d\u52a1\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u4f7f\u7528\u8def\u7531\u8fc7\u6ee4\u5668\u6765\u5b8c\u6210\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u4fee\u6539\uff1a</p> <pre><code>spring:\n  application:\n    name: gateway\n  cloud:\n    gateway:\n      routes:\n      - id: borrow-service\n        uri: lb://borrowservice\n        predicates:\n        - Path=/borrow/**\n      # \u7ee7\u7eed\u6dfb\u52a0\u65b0\u7684\u8def\u7531\u914d\u7f6e\uff0c\u8fd9\u91cc\u5c31\u4ee5\u4e66\u7c4d\u7ba1\u7406\u670d\u52a1\u4e3a\u4f8b\n      # \u6ce8\u610f-\u8981\u5bf9\u9f50routes:\n      - id: book-service\n        uri: lb://bookservice\n        predicates:\n        - Path=/book/**\n        filters:   # \u6dfb\u52a0\u8fc7\u6ee4\u5668\n        - AddRequestHeader=Test, HelloWorld!\n        # AddRequestHeader \u5c31\u662f\u6dfb\u52a0\u8bf7\u6c42\u5934\u4fe1\u606f\uff0c\u5176\u4ed6\u5de5\u5382\u8bf7\u67e5\u9605\u5b98\u7f51\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728BookController\u4e2d\u83b7\u53d6\u5e76\u8f93\u51fa\u4e00\u4e0b\uff0c\u770b\u770b\u662f\u4e0d\u662f\u6210\u529f\u6dfb\u52a0\u4e86\uff1a</p> <pre><code>@RestController\npublic class BookController {\n\n    @Resource\n    BookService service;\n\n    @RequestMapping(\"/book/{bid}\")\n    Book findBookById(@PathVariable(\"bid\") int bid,\n                      HttpServletRequest request){\n        System.out.println(request.getHeader(\"Test\"));\n        return service.getBookById(bid);\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u901a\u8fc7Gateway\u8bbf\u95ee\u6211\u4eec\u7684\u56fe\u4e66\u7ba1\u7406\u670d\u52a1\uff1a</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u6210\u529f\u83b7\u53d6\u5230\u7531\u7f51\u5173\u6dfb\u52a0\u7684\u8bf7\u6c42\u5934\u4fe1\u606f\u4e86\u3002</p> <p>\u9664\u4e86\u9488\u5bf9\u4e8e\u67d0\u4e00\u4e2a\u8def\u7531\u914d\u7f6e\u8fc7\u6ee4\u5668\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5168\u5c40\u8fc7\u6ee4\u5668\uff0c\u5b83\u80fd\u591f\u4f5c\u7528\u4e8e\u5168\u5c40\u3002\u4f46\u662f\u6211\u4eec\u9700\u8981\u901a\u8fc7\u4ee3\u7801\u7684\u65b9\u5f0f\u8fdb\u884c\u7f16\u5199\uff0c\u6bd4\u5982\u6211\u4eec\u8981\u5b9e\u73b0\u62e6\u622a\u6ca1\u6709\u643a\u5e26\u6307\u5b9a\u8bf7\u6c42\u53c2\u6570\u7684\u8bf7\u6c42\uff1a</p> <pre><code>@Component   //\u9700\u8981\u6ce8\u518c\u4e3aBean\npublic class TestFilter implements GlobalFilter {\n    @Override\n    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) {   //\u53ea\u9700\u8981\u5b9e\u73b0\u6b64\u65b9\u6cd5\n        return null;\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u7f16\u5199\u5224\u65ad\uff1a</p> <pre><code>@Override\npublic Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n    //\u5148\u83b7\u53d6ServerHttpRequest\u5bf9\u8c61\uff0c\u6ce8\u610f\u4e0d\u662fHttpServletRequest\n    ServerHttpRequest request = exchange.getRequest();\n    //\u6253\u5370\u4e00\u4e0b\u6240\u6709\u7684\u8bf7\u6c42\u53c2\u6570\n    System.out.println(request.getQueryParams());\n    //\u5224\u65ad\u662f\u5426\u5305\u542btest\u53c2\u6570\uff0c\u4e14\u53c2\u6570\u503c\u4e3a1\n    List&lt;String&gt; value = request.getQueryParams().get(\"test\");\n    if(value != null &amp;&amp; value.contains(\"1\")) {\n        //\u5c06ServerWebExchange\u5411\u8fc7\u6ee4\u94fe\u7684\u4e0b\u4e00\u7ea7\u4f20\u9012\uff08\u8ddfJavaWeb\u4e2d\u4ecb\u7ecd\u7684\u8fc7\u6ee4\u5668\u5176\u5b9e\u662f\u5dee\u4e0d\u591a\u7684\uff09\n        return chain.filter(exchange);\n    }else {\n        //\u76f4\u63a5\u5728\u8fd9\u91cc\u4e0d\u518d\u5411\u4e0b\u4f20\u9012\uff0c\u7136\u540e\u8fd4\u56de\u54cd\u5e94\n        return exchange.getResponse().setComplete();\n    }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u7ed3\u679c\uff1a</p> <p></p> <p></p> <p>\u6210\u529f\u5b9e\u73b0\u89c4\u5219\u5224\u65ad\u548c\u62e6\u622a\u64cd\u4f5c\u3002</p> <p>\u5f53\u7136\uff0c\u8fc7\u6ee4\u5668\u80af\u5b9a\u662f\u53ef\u4ee5\u5b58\u5728\u5f88\u591a\u4e2a\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u6307\u5b9a\u8fc7\u6ee4\u5668\u4e4b\u95f4\u7684\u987a\u5e8f\uff1a</p> <pre><code>@Component\npublic class TestFilter implements GlobalFilter, Ordered {   //\u5b9e\u73b0Ordered\u63a5\u53e3\n\n    @Override\n    public int getOrder() {\n        return 0;\n    }\n</code></pre> <p>\u6ce8\u610fOrder\u7684\u503c\u8d8a\u5c0f\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u5e76\u4e14\u65e0\u8bba\u662f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u7f16\u5199\u7684\u5355\u4e2a\u8def\u7531\u8fc7\u6ee4\u5668\u8fd8\u662f\u5168\u5c40\u8def\u7531\u8fc7\u6ee4\u5668\uff0c\u90fd\u4f1a\u53d7\u5230Order\u503c\u5f71\u54cd\uff08\u5355\u4e2a\u8def\u7531\u7684\u8fc7\u6ee4\u5668Order\u503c\u6309\u4ece\u4e0a\u5f80\u4e0b\u7684\u987a\u5e8f\u4ece1\u5f00\u59cb\u9012\u589e\uff09\uff0c\u6700\u7ec8\u662f\u6309\u7167Order\u503c\u51b3\u5b9a\u54ea\u4e2a\u8fc7\u6ee4\u5668\u4f18\u5148\u6267\u884c\uff0c\u5f53Order\u503c\u4e00\u6837\u65f6 \u5168\u5c40\u8def\u7531\u8fc7\u6ee4\u5668\u6267\u884c <code>\u4f18\u4e8e</code> \u5355\u72ec\u7684\u8def\u7531\u8fc7\u6ee4\u5668\u6267\u884c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#config","title":"Config \u914d\u7f6e\u4e2d\u5fc3","text":"<p>\u5b98\u65b9\u6587\u6863\uff1ahttps://docs.spring.io/spring-cloud-config/docs/current/reference/html/</p> <p>\u7ecf\u8fc7\u524d\u9762\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u5bf9\u4e8e\u4e00\u4e2a\u5206\u5e03\u5f0f\u5e94\u7528\u7684\u6280\u672f\u9009\u578b\u548c\u642d\u5efa\u5df2\u7ecf\u4e86\u89e3\u5f97\u6bd4\u8f83\u591a\u4e86\uff0c\u4f46\u662f\u5404\u4f4d\u6709\u6ca1\u6709\u53d1\u73b0\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u6211\u4eec\u7684\u5fae\u670d\u52a1\u9879\u76ee\u9700\u8981\u90e8\u7f72\u5f88\u591a\u4e2a\u5b9e\u4f8b\uff0c\u90a3\u4e48\u914d\u7f6e\u6587\u4ef6\u6211\u4eec\u5c82\u4e0d\u662f\u5f97\u4e00\u4e2a\u4e00\u4e2a\u53bb\u6539\uff0c\u53ef\u80fd\u5341\u51e0\u4e2a\u5b9e\u4f8b\u8fd8\u597d\uff0c\u8981\u662f\u6709\u51e0\u5341\u4e2a\u4e0a\u767e\u4e2a\u5462\uff1f\u90a3\u6211\u4eec\u4e00\u4e2a\u4e00\u4e2a\u53bb\u914d\u7f6e\uff0c\u5c82\u4e0d\u76f4\u63a5\u731d\u6b7b\u5728\u5de5\u4f4d\u4e0a\u3002</p> <p>\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u4e00\u79cd\u66f4\u52a0\u9ad8\u7ea7\u7684\u96c6\u4e2d\u5316\u5730\u914d\u7f6e\u6587\u4ef6\u7ba1\u7406\u5de5\u5177\uff0c\u96c6\u4e2d\u5730\u5bf9\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u914d\u7f6e\u3002</p> <p>Spring Cloud Config \u4e3a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u5916\u90e8\u914d\u7f6e\u63d0\u4f9b\u670d\u52a1\u5668\u7aef\u548c\u5ba2\u6237\u7aef\u652f\u6301\u3002\u4f7f\u7528 Config Server\uff0c\u60a8\u53ef\u4ee5\u96c6\u4e2d\u7ba1\u7406\u6240\u6709\u73af\u5883\u4e2d\u5e94\u7528\u7a0b\u5e8f\u7684\u5916\u90e8\u914d\u7f6e\u3002</p> <p></p> <p>\u5b9e\u9645\u4e0aSpring Cloud Config\u5c31\u662f\u4e00\u4e2a\u914d\u7f6e\u4e2d\u5fc3\uff0c\u6240\u6709\u7684\u670d\u52a1\u90fd\u53ef\u4ee5\u4ece\u914d\u7f6e\u4e2d\u5fc3\u53d6\u51fa\u914d\u7f6e\uff0c\u800c\u914d\u7f6e\u4e2d\u5fc3\u53c8\u53ef\u4ee5\u4eceGitHub\u8fdc\u7a0b\u4ed3\u5e93\u4e2d\u83b7\u53d6\u4e91\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u6837\u6211\u4eec\u53ea\u9700\u8981\u4fee\u6539GitHub\u4e2d\u7684\u914d\u7f6e\u5373\u53ef\u5bf9\u6240\u6709\u7684\u670d\u52a1\u8fdb\u884c\u914d\u7f6e\u7ba1\u7406\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_14","title":"\u90e8\u7f72\u914d\u7f6e\u4e2d\u5fc3","text":"<p>\u8fd9\u91cc\u6211\u4eec\u63a5\u7740\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9879\u76ee\uff0c\u5e76\u5bfc\u5165\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre> <p>\u8001\u89c4\u77e9\uff0c\u542f\u52a8\u7c7b\uff1a</p> <pre><code>@SpringBootApplication\n@EnableConfigServer\npublic class ConfigApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(ConfigApplication.class, args);\n    }\n}\n</code></pre> <p>\u63a5\u7740\u5c31\u662f\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>server:\n  port: 8700\nspring:\n  application:\n    name: configserver\neureka:\n  client:\n    service-url:\n      defaultZone: http://localhost:8801/eureka, http://localhost:8802/eureka\n</code></pre> <p>\u5148\u542f\u52a8\u4e00\u6b21\u770b\u770b\uff0c\u80fd\u4e0d\u80fd\u6210\u529f\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6211\u4eec\u4ee5\u672c\u5730\u4ed3\u5e93\u4e3a\u4f8b\uff08\u5c31\u4e0d\u7528GitHub\u4e86\uff0c\u5361\u5230\u6000\u7591\u4eba\u751f\u4e86\uff09\uff0c\u9996\u5148\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u672c\u5730Git\u4ed3\u5e93\uff0c\u6253\u5f00\u7ec8\u7aef\uff0c\u5728\u684c\u9762\u4e0a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u672c\u5730\u4ed3\u5e93\uff1a</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u5728\u6587\u4ef6\u5939\u4e2d\u968f\u4fbf\u521b\u5efa\u4e00\u4e9b\u914d\u7f6e\u6587\u4ef6\uff0c\u6ce8\u610f\u540d\u79f0\u6700\u597d\u662f{\u670d\u52a1\u540d\u79f0}-{\u73af\u5883}.yml\uff1a</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6dfb\u52a0\u672c\u5730\u4ed3\u5e93\u7684\u4e00\u4e9b\u4fe1\u606f\uff08\u8fdc\u7a0b\u4ed3\u5e93\u540c\u7406\uff09\uff0c\u8be6\u7ec6\u4f7f\u7528\u6559\u7a0b\uff1ahttps://docs.spring.io/spring-cloud-config/docs/current/reference/html/#_git_backend</p> <pre><code>spring:\n  cloud:\n    config:\n      server:\n        git:\n            # \u8fd9\u91cc\u586b\u5199\u7684\u662f\u672c\u5730\u4ed3\u5e93\u5730\u5740\uff0c\u8fdc\u7a0b\u4ed3\u5e93\u76f4\u63a5\u586b\u5199\u8fdc\u7a0b\u4ed3\u5e93\u5730\u5740 http://git...\n          uri: file://${user.home}/Desktop/config-repo\n          # \u9ed8\u8ba4\u5206\u652f\u8bbe\u5b9a\u4e3a\u4f60\u81ea\u5df1\u672c\u5730\u6216\u662f\u8fdc\u7a0b\u5206\u652f\u7684\u540d\u79f0\n          default-label: main\n</code></pre> <p>\u7136\u540e\u542f\u52a8\u6211\u4eec\u7684\u914d\u7f6e\u670d\u52a1\u5668\uff0c\u901a\u8fc7\u4ee5\u4e0b\u683c\u5f0f\u8fdb\u884c\u8bbf\u95ee\uff1a</p> <ul> <li>http://localhost:8700/{\u670d\u52a1\u540d\u79f0}/{\u73af\u5883}/{Git\u5206\u652f}</li> <li>http://localhost:8700/{Git\u5206\u652f}/{\u670d\u52a1\u540d\u79f0}-{\u73af\u5883}.yml</li> </ul> <p>\u6bd4\u5982\u6211\u4eec\u8981\u8bbf\u95ee\u56fe\u4e66\u670d\u52a1\u7684\u751f\u4ea7\u73af\u5883\u4ee3\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528 http://localhost:8700/bookservice/prod/main \u94fe\u63a5\uff0c\u5b83\u4f1a\u663e\u793a\u8be6\u7ec6\u4fe1\u606f\uff1a</p> <p></p> <p>\u4e5f\u53ef\u4ee5\u4f7f\u7528 http://localhost:8700/main/bookservice-prod.yml \u94fe\u63a5\uff0c\u5b83\u4ec5\u663e\u793a\u914d\u7f6e\u6587\u4ef6\u539f\u6587\uff1a</p> <p></p> <p>\u5f53\u7136\uff0c\u9664\u4e86\u4f7f\u7528Git\u6765\u4fdd\u5b58\u4e4b\u5916\uff0c\u8fd8\u652f\u6301\u4e00\u4e9b\u5176\u4ed6\u7684\u65b9\u5f0f\uff0c\u8be6\u7ec6\u60c5\u51b5\u8bf7\u67e5\u9605\u5b98\u7f51\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#_15","title":"\u5ba2\u6237\u7aef\u914d\u7f6e","text":"<p>\u670d\u52a1\u7aef\u914d\u7f6e\u5b8c\u6210\u4e4b\u540e\uff0c\u6211\u4eec\u63a5\u7740\u6765\u914d\u7f6e\u4e00\u4e0b\u5ba2\u6237\u7aef\uff0c\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u7684\u670d\u52a1\u65e2\u7136\u9700\u8981\u4ece\u670d\u52a1\u5668\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u914d\u7f6e\uff0c\u6211\u4eec\u5220\u9664\u539f\u6765\u7684<code>application.yml</code>\u6587\u4ef6\uff08\u4e5f\u53ef\u4ee5\u4fdd\u7559\uff0c\u6700\u540e\u65e0\u8bba\u662f\u8fdc\u7aef\u914d\u7f6e\u8fd8\u662f\u672c\u5730\u914d\u7f6e\u90fd\u4f1a\u88ab\u52a0\u8f7d\uff09\uff0c\u6539\u7528<code>bootstrap.yml</code>\uff08\u5728application.yml\u4e4b\u524d\u52a0\u8f7d\uff0c\u53ef\u4ee5\u5b9e\u73b0\u914d\u7f6e\u6587\u4ef6\u8fdc\u7a0b\u83b7\u53d6\uff09\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>spring:\n  cloud:\n    config:\n        # \u540d\u79f0\uff0c\u5176\u5b9e\u5c31\u662f\u6587\u4ef6\u540d\u79f0\n      name: bookservice\n      # \u914d\u7f6e\u670d\u52a1\u5668\u7684\u5730\u5740\n      uri: http://localhost:8700\n      # \u73af\u5883\n      profile: prod\n      # \u5206\u652f\n      label: main\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u4e4b\u540e\uff0c\u542f\u52a8\u56fe\u4e66\u670d\u52a1\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u4ece\u8fdc\u7aef\u83b7\u53d6\u5230\u4e86\u914d\u7f6e\uff0c\u5e76\u8fdb\u884c\u542f\u52a8\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#cap","title":"\u5fae\u670d\u52a1CAP\u539f\u5219","text":"<p>\u7ecf\u8fc7\u524d\u9762\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u5bf9SpringCloud Netflix\u4ee5\u53caSpringCloud\u5b98\u65b9\u6574\u4e2a\u751f\u6001\u4e0b\u7684\u7ec4\u4ef6\u8ba4\u8bc6\u4e5f\u5dee\u4e0d\u591a\u4e86\uff0c\u5165\u95e8\u6559\u5b66\u5c31\u5230\u6b64\u4e3a\u6b62\uff0c\u4e0b\u4e00\u7ae0\u5c06\u5f00\u542f\u771f\u6b63\u7cbe\u5f69\u7684\u6b63\u7247\u90e8\u5206\uff0c\u672c\u7ae0\u7684\u6700\u540e\u6211\u4eec\u8fd8\u662f\u6765\u4e86\u89e3\u4e00\u4e9b\u7406\u8bba\u4e0a\u7684\u77e5\u8bc6\u3002</p> <p></p> <p>CAP\u539f\u5219\u53c8\u79f0CAP\u5b9a\u7406\uff0c\u6307\u7684\u662f\u5728\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u5b58\u5728Consistency\uff08\u4e00\u81f4\u6027\uff09\u3001Availability\uff08\u53ef\u7528\u6027\uff09\u3001Partition tolerance\uff08\u5206\u533a\u5bb9\u9519\u6027\uff09\uff0c\u4e09\u8005\u4e0d\u53ef\u540c\u65f6\u4fdd\u8bc1\uff0c\u6700\u591a\u53ea\u80fd\u4fdd\u8bc1\u5176\u4e2d\u7684\u4e24\u8005\u3002   </p> <p>\u4e00\u81f4\u6027\uff08C\uff09\uff1a\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u6240\u6709\u6570\u636e\u5907\u4efd\uff0c\u5728\u540c\u4e00\u65f6\u523b\u90fd\u662f\u540c\u6837\u7684\u503c\uff08\u6240\u6709\u7684\u8282\u70b9\u65e0\u8bba\u4f55\u65f6\u8bbf\u95ee\u90fd\u80fd\u62ff\u5230\u6700\u65b0\u7684\u503c\uff09</p> <p>\u53ef\u7528\u6027\uff08A\uff09\uff1a\u7cfb\u7edf\u4e2d\u975e\u6545\u969c\u8282\u70b9\u6536\u5230\u7684\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u5fc5\u987b\u5f97\u5230\u54cd\u5e94\uff08\u6bd4\u5982\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u670d\u52a1\u964d\u7ea7\u548c\u7194\u65ad\uff0c\u5176\u5b9e\u5c31\u662f\u4e00\u79cd\u7ef4\u6301\u53ef\u7528\u6027\u7684\u63aa\u65bd\uff0c\u867d\u7136\u670d\u52a1\u8fd4\u56de\u7684\u662f\u6ca1\u6709\u4ec0\u4e48\u610f\u4e49\u7684\u6570\u636e\uff0c\u4f46\u662f\u4e0d\u81f3\u4e8e\u7528\u6237\u7684\u8bf7\u6c42\u4f1a\u88ab\u670d\u52a1\u5668\u5ffd\u7565\uff09</p> <p>\u5206\u533a\u5bb9\u9519\u6027\uff08P\uff09\uff1a\u4e00\u4e2a\u5206\u5e03\u5f0f\u7cfb\u7edf\u91cc\u9762\uff0c\u8282\u70b9\u4e4b\u95f4\u7ec4\u6210\u7684\u7f51\u7edc\u672c\u6765\u5e94\u8be5\u662f\u8fde\u901a\u7684\uff0c\u7136\u800c\u53ef\u80fd\u56e0\u4e3a\u4e00\u4e9b\u6545\u969c\uff08\u6bd4\u5982\u7f51\u7edc\u4e22\u5305\u7b49\uff0c\u8fd9\u662f\u5f88\u96be\u907f\u514d\u7684\uff09\uff0c\u4f7f\u5f97\u6709\u4e9b\u8282\u70b9\u4e4b\u95f4\u4e0d\u8fde\u901a\u4e86\uff0c\u6574\u4e2a\u7f51\u7edc\u5c31\u5206\u6210\u4e86\u51e0\u5757\u533a\u57df\uff0c\u6570\u636e\u5c31\u6563\u5e03\u5728\u4e86\u8fd9\u4e9b\u4e0d\u8fde\u901a\u7684\u533a\u57df\u4e2d\uff08\u8fd9\u6837\u5c31\u53ef\u80fd\u51fa\u73b0\u67d0\u4e9b\u88ab\u5206\u533a\u8282\u70b9\u5b58\u653e\u7684\u6570\u636e\u8bbf\u95ee\u5931\u8d25\uff0c\u6211\u4eec\u9700\u8981\u6765\u5bb9\u5fcd\u8fd9\u4e9b\u4e0d\u53ef\u9760\u7684\u60c5\u51b5\uff09</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u6570\u636e\u5b58\u653e\u7684\u8282\u70b9\u6570\u8d8a\u591a\uff0c\u5206\u533a\u5bb9\u5fcd\u6027\u5c31\u8d8a\u9ad8\uff0c\u4f46\u662f\u8981\u590d\u5236\u66f4\u65b0\u7684\u6b21\u6570\u5c31\u8d8a\u591a\uff0c\u4e00\u81f4\u6027\u5c31\u8d8a\u96be\u4fdd\u8bc1\u3002\u540c\u65f6\u4e3a\u4e86\u4fdd\u8bc1\u4e00\u81f4\u6027\uff0c\u66f4\u65b0\u6240\u6709\u8282\u70b9\u6570\u636e\u6240\u9700\u8981\u7684\u65f6\u95f4\u5c31\u8d8a\u957f\uff0c\u90a3\u4e48\u53ef\u7528\u6027\u5c31\u4f1a\u964d\u4f4e\u3002</p> <p>\u6240\u4ee5\u8bf4\uff0c\u53ea\u80fd\u5b58\u5728\u4ee5\u4e0b\u4e09\u79cd\u65b9\u6848\uff1a</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#ac","title":"AC \u53ef\u7528\u6027+\u4e00\u81f4\u6027","text":"<p>\u8981\u540c\u65f6\u4fdd\u8bc1\u53ef\u7528\u6027\u548c\u4e00\u81f4\u6027\uff0c\u4ee3\u8868\u7740\u67d0\u4e2a\u8282\u70b9\u6570\u636e\u66f4\u65b0\u4e4b\u540e\uff0c\u9700\u8981\u7acb\u5373\u5c06\u7ed3\u679c\u901a\u77e5\u7ed9\u5176\u4ed6\u8282\u70b9\uff0c\u5e76\u4e14\u8981\u5c3d\u53ef\u80fd\u7684\u5feb\uff0c\u8fd9\u6837\u624d\u80fd\u53ca\u65f6\u54cd\u5e94\u4fdd\u8bc1\u53ef\u7528\u6027\uff0c\u8fd9\u5c31\u5bf9\u7f51\u7edc\u7684\u7a33\u5b9a\u6027\u8981\u6c42\u975e\u5e38\u9ad8\uff0c\u4f46\u662f\u5b9e\u9645\u60c5\u51b5\u4e0b\uff0c\u7f51\u7edc\u5f88\u5bb9\u6613\u51fa\u73b0\u4e22\u5305\u7b49\u60c5\u51b5\uff0c\u5e76\u4e0d\u662f\u4e00\u4e2a\u53ef\u9760\u7684\u4f20\u8f93\uff0c\u5982\u679c\u9700\u8981\u907f\u514d\u8fd9\u79cd\u95ee\u9898\uff0c\u5c31\u53ea\u80fd\u5c06\u8282\u70b9\u5168\u90e8\u653e\u5728\u4e00\u8d77\uff0c\u4f46\u662f\u8fd9\u663e\u7136\u8fdd\u80cc\u4e86\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u6982\u5ff5\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6211\u4eec\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf\u6765\u8bf4\uff0c\u5f88\u96be\u63a5\u53d7\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#cp","title":"CP \u4e00\u81f4\u6027+\u5206\u533a\u5bb9\u9519\u6027","text":"<p>\u4e3a\u4e86\u4fdd\u8bc1\u4e00\u81f4\u6027\uff0c\u90a3\u4e48\u5c31\u5f97\u5c06\u67d0\u4e2a\u8282\u70b9\u7684\u6700\u65b0\u6570\u636e\u53d1\u9001\u7ed9\u5176\u4ed6\u8282\u70b9\uff0c\u5e76\u4e14\u9700\u8981\u7b49\u5230\u6240\u6709\u8282\u70b9\u90fd\u5f97\u5230\u6570\u636e\u624d\u80fd\u8fdb\u884c\u54cd\u5e94\uff0c\u540c\u65f6\u6709\u4e86\u5206\u533a\u5bb9\u9519\u6027\uff0c\u90a3\u4e48\u4ee3\u8868\u6211\u4eec\u53ef\u4ee5\u5bb9\u5fcd\u7f51\u7edc\u7684\u4e0d\u53ef\u9760\u95ee\u9898\uff0c\u6240\u4ee5\u5c31\u7b97\u7f51\u7edc\u51fa\u73b0\u5361\u987f\uff0c\u90a3\u4e48\u4e5f\u5fc5\u987b\u7b49\u5f85\u6240\u6709\u8282\u70b9\u5b8c\u6210\u6570\u636e\u540c\u6b65\uff0c\u624d\u80fd\u8fdb\u884c\u54cd\u5e94\uff0c\u56e0\u6b64\u5c31\u4f1a\u5bfc\u81f4\u670d\u52a1\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u5b8c\u5168\u5931\u6548\uff0c\u6240\u4ee5\u53ef\u7528\u6027\u662f\u65e0\u6cd5\u5f97\u5230\u4fdd\u8bc1\u7684\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/#ap","title":"AP \u53ef\u7528\u6027+\u5206\u533a\u5bb9\u9519\u6027","text":"<p>\u65e2\u7136CP\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e00\u6bb5\u65f6\u95f4\u5185\u670d\u52a1\u5f97\u4e0d\u5230\u4efb\u4f55\u54cd\u5e94\uff0c\u90a3\u4e48\u8981\u4fdd\u8bc1\u53ef\u7528\u6027\uff0c\u5c31\u53ea\u80fd\u653e\u5f03\u8282\u70b9\u4e4b\u95f4\u6570\u636e\u7684\u9ad8\u5ea6\u7edf\u4e00\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u5728\u6570\u636e\u4e0d\u7edf\u4e00\u7684\u60c5\u51b5\u4e0b\uff0c\u8fdb\u884c\u54cd\u5e94\uff0c\u56e0\u6b64\u5c31\u65e0\u6cd5\u4fdd\u8bc1\u4e00\u81f4\u6027\u4e86\u3002\u867d\u7136\u8fd9\u6837\u4f1a\u5bfc\u81f4\u62ff\u4e0d\u5230\u6700\u65b0\u7684\u6570\u636e\uff0c\u4f46\u662f\u53ea\u8981\u6570\u636e\u540c\u6b65\u64cd\u4f5c\u5728\u540e\u53f0\u7ee7\u7eed\u8fd0\u884c\uff0c\u4e00\u5b9a\u80fd\u591f\u5728\u67d0\u4e00\u65f6\u523b\u5b8c\u6210\u6240\u6709\u8282\u70b9\u6570\u636e\u7684\u540c\u6b65\uff0c\u90a3\u4e48\u5c31\u80fd\u5b9e\u73b0\u6700\u7ec8\u4e00\u81f4\u6027\uff0c\u6240\u4ee5AP\u5b9e\u9645\u4e0a\u662f\u6700\u80fd\u63a5\u53d7\u7684\u4e00\u79cd\u65b9\u6848\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u5b9e\u73b0\u7684Eureka\u96c6\u7fa4\uff0c\u5b83\u4f7f\u7528\u7684\u5c31\u662fAP\u65b9\u6848\uff0cEureka\u5404\u4e2a\u8282\u70b9\u90fd\u662f\u5e73\u7b49\u7684\uff0c\u5c11\u6570\u8282\u70b9\u6302\u6389\u4e0d\u4f1a\u5f71\u54cd\u6b63\u5e38\u8282\u70b9\u7684\u5de5\u4f5c\uff0c\u5269\u4f59\u7684\u8282\u70b9\u4f9d\u7136\u53ef\u4ee5\u63d0\u4f9b\u6ce8\u518c\u548c\u67e5\u8be2\u670d\u52a1\u3002\u800cEureka\u5ba2\u6237\u7aef\u5728\u5411\u67d0\u4e2aEureka\u670d\u52a1\u7aef\u6ce8\u518c\u65f6\u5982\u679c\u53d1\u73b0\u8fde\u63a5\u5931\u8d25\uff0c\u5219\u4f1a\u81ea\u52a8\u5207\u6362\u81f3\u5176\u4ed6\u8282\u70b9\u3002\u53ea\u8981\u6709\u4e00\u53f0Eureka\u670d\u52a1\u5668\u6b63\u5e38\u8fd0\u884c\uff0c\u90a3\u4e48\u5c31\u80fd\u4fdd\u8bc1\u670d\u52a1\u53ef\u7528\uff08A\uff09\uff0c\u53ea\u4e0d\u8fc7\u67e5\u8be2\u5230\u7684\u4fe1\u606f\u53ef\u80fd\u4e0d\u662f\u6700\u65b0\u7684\uff08C\uff09</p> <p>\u5728\u4e4b\u540e\u7684\u7ae0\u8282\uff0c\u6211\u4eec\u8fd8\u4f1a\u7ee7\u7eed\u4e86\u89e3\u8fd9\u4e9b\u7406\u8bba\u7684\u5176\u4ed6\u5b9e\u9645\u5e94\u7528\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/","title":"\u5fae\u670d\u52a1\u5e94\u7528","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86SpringCloudAlibaba\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u5bf9\u4e00\u4e2a\u5fae\u670d\u52a1\u9879\u76ee\u7684\u67b6\u6784\u4f53\u7cfb\u5df2\u7ecf\u6709\u4e86\u4e00\u5b9a\u7684\u4e86\u89e3\uff0c\u90a3\u4e48\u672c\u7ae0\u6211\u4eec\u5c06\u5728\u5e94\u7528\u5c42\u9762\u7ee7\u7eed\u63a2\u8ba8\u5fae\u670d\u52a1\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_2","title":"\u5206\u5e03\u5f0f\u6743\u9650\u6821\u9a8c","text":"<p>\u867d\u7136\u5b8c\u6210\u524d\u9762\u7684\u90e8\u5206\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u81ea\u5df1\u53bb\u7f16\u5199\u4e00\u4e2a\u6bd4\u8f83\u4e2d\u89c4\u4e2d\u77e9\u7684\u5fae\u670d\u52a1\u9879\u76ee\u4e86\uff0c\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\u6211\u4eec\u6ca1\u6709\u89e3\u51b3\uff0c\u767b\u5f55\u95ee\u9898\u3002\u5047\u5982\u73b0\u5728\u8981\u6c42\u7528\u6237\u767b\u5f55\u4e4b\u540e\uff0c\u624d\u80fd\u8fdb\u884c\u56fe\u4e66\u7684\u67e5\u8be2\u3001\u501f\u9605\u7b49\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u53c8\u8be5\u5982\u4f55\u8bbe\u8ba1\u8fd9\u4e2a\u7cfb\u7edf\u5462\uff1f</p> <p>\u56de\u987e\u6211\u4eec\u4e4b\u524d\u8fdb\u884c\u6743\u9650\u6821\u9a8c\u7684\u539f\u7406\uff0c\u670d\u52a1\u5668\u662f\u5982\u4f55\u5224\u5b9a\u4e00\u4e2a\u8bf7\u6c42\u662f\u6765\u81ea\u54ea\u4e2a\u7528\u6237\u7684\u5462\uff1f</p> <ul> <li>\u9996\u5148\u6d4f\u89c8\u5668\u4f1a\u5411\u670d\u52a1\u7aef\u53d1\u9001\u8bf7\u6c42\uff0c\u8bbf\u95ee\u6211\u4eec\u7684\u7f51\u7ad9\u3002</li> <li>\u670d\u52a1\u7aef\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2aSESSION ID\uff0c\u5e76\u6682\u65f6\u5b58\u50a8\u5728\u670d\u52a1\u7aef\uff0c\u7136\u540e\u4f1a\u53d1\u9001\u7ed9\u6d4f\u89c8\u5668\u4f5c\u4e3aCookie\u4fdd\u5b58\u3002</li> <li>\u4e4b\u540e\u6d4f\u89c8\u5668\u4f1a\u4e00\u76f4\u643a\u5e26\u6b64Cookie\u8bbf\u95ee\u670d\u52a1\u5668\uff0c\u8fd9\u6837\u5728\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u5c31\u80fd\u6839\u636e\u643a\u5e26\u7684Cookie\u4e2d\u7684SESSION ID\u5224\u65ad\u662f\u54ea\u4e2a\u7528\u6237\u4e86\u3002</li> <li>\u8fd9\u6837\u670d\u52a1\u7aef\u548c\u6d4f\u89c8\u5668\u4e4b\u95f4\u53ef\u4ee5\u8f7b\u677e\u5730\u5efa\u7acb\u4f1a\u8bdd\u4e86\u3002</li> </ul> <p>\u4f46\u662f\u6211\u4eec\u60f3\u4e00\u4e0b\uff0c\u6211\u4eec\u73b0\u5728\u91c7\u7528\u7684\u662f\u5206\u5e03\u5f0f\u7684\u7cfb\u7edf\uff0c\u90a3\u4e48\u5728\u7528\u6237\u670d\u52a1\u8fdb\u884c\u767b\u5f55\u4e4b\u540e\uff0c\u5176\u4ed6\u670d\u52a1\u6bd4\u5982\u56fe\u4e66\u670d\u52a1\u548c\u501f\u9605\u670d\u52a1\uff0c\u5b83\u4eec\u4f1a\u77e5\u9053\u7528\u6237\u767b\u5f55\u4e86\u5417\uff1f</p> <p></p> <p>\u5b9e\u9645\u4e0a\u6211\u4eec\u767b\u5f55\u5230\u7528\u6237\u670d\u52a1\u4e4b\u540e\uff0cSession\u4e2d\u7684\u7528\u6237\u6570\u636e\u53ea\u4f1a\u5728\u7528\u6237\u670d\u52a1\u7684\u5e94\u7528\u4e2d\u4fdd\u5b58\uff0c\u800c\u5728\u5176\u4ed6\u670d\u52a1\u4e2d\uff0c\u5e76\u6ca1\u6709\u5bf9\u5e94\u7684\u4fe1\u606f\uff0c\u4f46\u662f\u6211\u4eec\u73b0\u5728\u5e0c\u671b\u7684\u662f\uff0c\u6240\u6709\u7684\u670d\u52a1\u90fd\u80fd\u591f\u540c\u6b65\u8fd9\u4e9bSession\u4fe1\u606f\uff0c\u8fd9\u6837\u6211\u4eec\u624d\u80fd\u5b9e\u73b0\u5728\u7528\u6237\u670d\u52a1\u767b\u5f55\u4e4b\u540e\u5176\u4ed6\u670d\u52a1\u90fd\u80fd\u77e5\u9053\uff0c\u90a3\u4e48\u6211\u4eec\u8be5\u5982\u4f55\u5b9e\u73b0Session\u7684\u540c\u6b65\u5462\uff1f</p> <ol> <li>\u6211\u4eec\u53ef\u4ee5\u5728\u6bcf\u53f0\u670d\u52a1\u5668\u4e0a\u90fd\u590d\u5236\u4e00\u4efdSession\uff0c\u4f46\u662f\u8fd9\u6837\u663e\u7136\u662f\u5f88\u6d6a\u8d39\u65f6\u95f4\u7684\uff0c\u5e76\u4e14\u7528\u6237\u9a8c\u8bc1\u6570\u636e\u5360\u7528\u7684\u5185\u5b58\u4f1a\u6210\u500d\u7684\u589e\u52a0\u3002</li> <li>\u5c06Session\u79fb\u51fa\u670d\u52a1\u5668\uff0c\u7528\u7edf\u4e00\u5b58\u50a8\u6765\u5b58\u653e\uff0c\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728Redis\u6216\u662fMySQL\u4e2d\u5b58\u653e\u7528\u6237\u7684Session\u4fe1\u606f\uff0c\u8fd9\u6837\u6240\u6709\u7684\u670d\u52a1\u5668\u5728\u9700\u8981\u83b7\u53d6Session\u4fe1\u606f\u65f6\uff0c\u7edf\u4e00\u8bbf\u95eeRedis\u6216\u662fMySQL\u5373\u53ef\uff0c\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u6240\u6709\u670d\u52a1\u90fd\u53ef\u4ee5\u540c\u6b65Session\u4e86\uff08\u662f\u4e0d\u662f\u8d8a\u6765\u8d8a\u611f\u89c9\u53ea\u8981\u6709\u95ee\u9898\uff0c\u6ca1\u6709\u4ec0\u4e48\u662f\u52a0\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u89e3\u51b3\u4e0d\u4e86\u7684\uff09</li> </ol> <p></p> <p>\u90a3\u4e48\uff0c\u6211\u4eec\u5c31\u7740\u91cd\u6765\u7814\u7a76\u4e00\u4e0b\uff0c\u7136\u540e\u5b9e\u73b02\u53f7\u65b9\u6848\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u4f7f\u7528Redis\u4f5c\u4e3aSession\u7edf\u4e00\u5b58\u50a8\uff0c\u6211\u4eec\u628a\u4e00\u5f00\u59cb\u7684\u538b\u7f29\u5305\u91cd\u65b0\u89e3\u538b\u4e00\u6b21\uff0c\u53c8\u6765\u4ece\u5934\u5f00\u59cb\u7f16\u5199\u5427\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5c31\u53ea\u4f7f\u7528Nacos\u5c31\u884c\u4e86\uff0c\u548c\u4e4b\u524d\u4e00\u6837\uff0c\u6211\u4eec\u628aNacos\u7684\u5305\u5bfc\u5165\u4e00\u4e0b\uff0c\u7136\u540e\u8fdb\u884c\u4e00\u4e9b\u914d\u7f6e\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u9700\u8981\u4e3a\u6bcf\u4e2a\u670d\u52a1\u90fd\u6dfb\u52a0\u9a8c\u8bc1\u673a\u5236\uff0c\u9996\u5148\u5bfc\u5165\u4f9d\u8d56\uff1a</p> <pre><code>&lt;!--  SpringSession Redis\u652f\u6301  --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;!--  \u6dfb\u52a0Redis\u7684Starter  --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u4f9d\u7136\u4f7f\u7528SpringSecurity\u6846\u67b6\u4f5c\u4e3a\u6743\u9650\u6821\u9a8c\u6846\u67b6\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728\u6bcf\u4e2a\u670d\u52a1\u90fd\u7f16\u5199\u4e00\u4e0b\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>spring:\n  session:\n    # \u5b58\u50a8\u7c7b\u578b\u4fee\u6539\u4e3aredis\n    store-type: redis\n  redis:\n    # Redis\u670d\u52a1\u5668\u7684\u4fe1\u606f\uff0c\u8be5\u548b\u5199\u548b\u5199\n    host: 1.14.121.107\n</code></pre> <p>\u8fd9\u6837\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u670d\u52a1\u7684\u63a5\u53e3\u90fd\u4f1a\u88abSpringSecurity\u6240\u4fdd\u62a4\uff0c\u53ea\u6709\u767b\u5f55\u6210\u529f\u4e4b\u540e\uff0c\u624d\u53ef\u4ee5\u88ab\u8bbf\u95ee\u3002</p> <p>\u6211\u4eec\u6765\u6253\u5f00Nacos\u770b\u770b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u4e09\u4e2a\u670d\u52a1\u90fd\u6b63\u5e38\u6ce8\u518c\u4e86\uff0c\u63a5\u7740\u6211\u4eec\u53bb\u8bbf\u95ee\u56fe\u4e66\u670d\u52a1\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8bbf\u95ee\u5931\u8d25\uff0c\u76f4\u63a5\u628a\u6211\u4eec\u7ed9\u91cd\u5b9a\u5411\u5230\u767b\u9646\u9875\u9762\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\u5fc5\u987b\u767b\u9646\u4e4b\u540e\u624d\u80fd\u8bbf\u95ee\uff0c\u540c\u6837\u7684\u65b9\u5f0f\u53bb\u8bbf\u95ee\u5176\u4ed6\u670d\u52a1\uff0c\u4e5f\u662f\u4e00\u6837\u7684\u6548\u679c\u3002</p> <p>\u7531\u4e8e\u73b0\u5728\u662f\u7edf\u4e00Session\u5b58\u50a8\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u4efb\u610f\u4e00\u4e2a\u670d\u52a1\u767b\u5f55\u4e4b\u540e\uff0c\u5176\u4ed6\u670d\u52a1\u90fd\u53ef\u4ee5\u6b63\u5e38\u8bbf\u95ee\uff0c\u73b0\u5728\u6211\u4eec\u5728\u5f53\u524d\u9875\u9762\u767b\u5f55\uff0c\u767b\u5f55\u4e4b\u540e\u53ef\u4ee5\u770b\u5230\u56fe\u4e66\u670d\u52a1\u80fd\u591f\u6b63\u5e38\u8bbf\u95ee\u4e86\uff1a</p> <p></p> <p>\u540c\u65f6\u7528\u6237\u670d\u52a1\u4e5f\u80fd\u6b63\u5e38\u8bbf\u95ee\u4e86\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u4e00\u4e0bRedis\u670d\u52a1\u5668\u4e2d\u662f\u4e0d\u662f\u5b58\u50a8\u4e86\u6211\u4eec\u7684Session\u4fe1\u606f\uff1a</p> <p></p> <p>\u867d\u7136\u770b\u8d77\u6765\u597d\u50cf\u786e\u5b9e\u6ca1\u5565\u95ee\u9898\u4e86\uff0c\u4f46\u662f\u501f\u9605\u670d\u52a1\u70b8\u4e86\uff0c\u6211\u4eec\u6765\u770b\u770b\u4e3a\u4ec0\u4e48\uff1a</p> <p></p> <p>\u5728RestTemplate\u8fdb\u884c\u8fdc\u7a0b\u8c03\u7528\u7684\u65f6\u5019\uff0c\u7531\u4e8e\u6211\u4eec\u7684\u8bf7\u6c42\u6ca1\u6709\u643a\u5e26\u5bf9\u5e94SESSION\u7684Cookie\uff0c\u6240\u4ee5\u5bfc\u81f4\u9a8c\u8bc1\u5931\u8d25\uff0c\u8bbf\u95ee\u4e0d\u6210\u529f\uff0c\u8fd4\u56de401\uff0c\u6240\u4ee5\u867d\u7136\u8fd9\u79cd\u65b9\u6848\u770b\u8d77\u6765\u6bd4\u8f83\u5408\u7406\uff0c\u4f46\u662f\u5728\u6211\u4eec\u7684\u5b9e\u9645\u4f7f\u7528\u4e2d\uff0c\u8fd8\u662f\u5b58\u5728\u4e00\u4e9b\u4e0d\u4fbf\u7684\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#oauth-20","title":"OAuth 2.0 \u5b9e\u73b0\u5355\u70b9\u767b\u5f55","text":"<p>\u6ce8\u610f\uff1a\u7b2c\u4e00\u6b21\u63a5\u89e6\u53ef\u80fd\u4f1a\u6bd4\u8f83\u96be\uff0c\u4e0d\u592a\u597d\u7406\u89e3\uff0c\u9700\u8981\u591a\u5b9e\u8df5\u548c\u89c2\u5bdf\u3002</p> <p>\u524d\u9762\u6211\u4eec\u867d\u7136\u4f7f\u7528\u4e86\u7edf\u4e00\u5b58\u50a8\u6765\u89e3\u51b3Session\u5171\u4eab\u95ee\u9898\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u5c31\u7b97\u5b9e\u73b0\u4e86Session\u5171\u4eab\uff0c\u4f9d\u7136\u5b58\u5728\u4e00\u4e9b\u95ee\u9898\uff0c\u7531\u4e8e\u6211\u4eec\u6bcf\u4e2a\u670d\u52a1\u90fd\u6709\u81ea\u5df1\u7684\u9a8c\u8bc1\u6a21\u5757\uff0c\u5b9e\u9645\u4e0a\u6574\u4e2a\u7cfb\u7edf\u662f\u5b58\u5728\u5197\u4f59\u529f\u80fd\u7684\u3001\u540c\u65f6\u8fd8\u6709\u6211\u4eec\u4e0a\u9762\u51fa\u73b0\u7684\u95ee\u9898\uff0c\u90a3\u4e48\u80fd\u5426\u5b9e\u73b0\u53ea\u5728\u4e00\u4e2a\u670d\u52a1\u8fdb\u884c\u767b\u5f55\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5176\u4ed6\u7684\u670d\u52a1\u5462\uff1f</p> <p></p> <p>\u5b9e\u9645\u4e0a\u4e4b\u524d\u7684\u767b\u5f55\u6a21\u5f0f\u79f0\u4e3a\u591a\u70b9\u767b\u5f55\uff0c\u800c\u6211\u4eec\u5e0c\u671b\u7684\u662f\u5b9e\u73b0\u5355\u70b9\u767b\u9646\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u5f97\u627e\u4e00\u4e2a\u66f4\u597d\u7684\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u9996\u5148\u9700\u8981\u4e86\u89e3\u4e00\u79cd\u5168\u65b0\u7684\u767b\u5f55\u65b9\u5f0f\uff1aOAuth 2.0\uff0c\u6211\u4eec\u7ecf\u5e38\u770b\u5230\u4e00\u4e9b\u7f51\u7ad9\u652f\u6301\u7b2c\u4e09\u65b9\u767b\u5f55\uff0c\u6bd4\u5982\u6dd8\u5b9d\u3001\u54b8\u9c7c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u652f\u4ed8\u5b9d\u8fdb\u884c\u767b\u5f55\uff0c\u817e\u8baf\u6e38\u620f\u53ef\u4ee5\u7528QQ\u6216\u662f\u5fae\u4fe1\u767b\u9646\uff0c\u4ee5\u53ca\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u90fd\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u5fae\u4fe1\u8fdb\u884c\u767b\u5f55\u3002\u6211\u4eec\u77e5\u9053\u5b83\u4eec\u5e76\u4e0d\u662f\u5c5e\u4e8e\u540c\u4e00\u4e2a\u7cfb\u7edf\uff0c\u6bd4\u5982\u6dd8\u5b9d\u548c\u54b8\u9c7c\u90fd\u4e0d\u5c5e\u4e8e\u652f\u4ed8\u5b9d\u8fd9\u4e2a\u5e94\u7528\uff0c\u4f46\u662f\u7531\u4e8e\u9700\u8981\u83b7\u53d6\u652f\u4ed8\u5b9d\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u9700\u8981\u4f7f\u7528 OAuth2.0 \u6765\u5b9e\u73b0\u7b2c\u4e09\u65b9\u6388\u6743\uff0c\u57fa\u4e8e\u7b2c\u4e09\u65b9\u5e94\u7528\u8bbf\u95ee\u7528\u6237\u4fe1\u606f\u7684\u6743\u9650\uff08\u672c\u8d28\u4e0a\u5c31\u662f\u7ed9\u522b\u4eba\u8c03\u7528\u81ea\u5df1\u670d\u52a1\u63a5\u53e3\u7684\u6743\u9650\uff09\uff0c\u90a3\u4e48\u5b83\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u5462\uff1f</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_3","title":"\u56db\u79cd\u6388\u6743\u6a21\u5f0f","text":"<p>\u6211\u4eec\u8fd8\u662f\u4ece\u7406\u8bba\u5f00\u59cb\u8bb2\u89e3\uff0cOAuth 2.0\u4e00\u5171\u6709\u56db\u79cd\u6388\u6743\u6a21\u5f0f\uff1a</p> <ol> <li>\u5ba2\u6237\u7aef\u6a21\u5f0f\uff08Client Credentials\uff09</li> </ol> <p>\u8fd9\u662f\u6700\u7b80\u5355\u7684\u4e00\u79cd\u6a21\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5411\u9a8c\u8bc1\u670d\u52a1\u5668\u8bf7\u6c42\u4e00\u4e2aToken\uff08\u8fd9\u91cc\u53ef\u80fd\u6709\u4e9b\u5c0f\u4f19\u4f34\u5bf9Token\u7684\u6982\u5ff5\u4e0d\u662f\u5f88\u719f\u6089\uff0cToken\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u4ee4\u724c\uff0c\u6211\u4eec\u9700\u8981\u5728\u9a8c\u8bc1\u670d\u52a1\u5668\uff08User Account And Authentication\uff09\u670d\u52a1\u62ff\u5230\u4ee4\u724c\u4e4b\u540e\uff0c\u624d\u80fd\u53bb\u8bbf\u95ee\u8d44\u6e90\uff0c\u6bd4\u5982\u7528\u6237\u4fe1\u606f\u3001\u501f\u9605\u4fe1\u606f\u7b49\uff0c\u8fd9\u6837\u8d44\u6e90\u670d\u52a1\u5668\u624d\u80fd\u77e5\u9053\u6211\u4eec\u662f\u8c01\u4ee5\u53ca\u662f\u5426\u6210\u529f\u767b\u5f55\u4e86\uff09</p> <p>\u5f53\u7136\uff0c\u8fd9\u91cc\u7684\u524d\u7aef\u9875\u9762\u53ea\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5b83\u8fd8\u53ef\u4ee5\u662f\u5176\u4ed6\u4efb\u4f55\u7c7b\u578b\u7684\u5ba2\u6237\u7aef\uff0c\u6bd4\u5982App\u3001\u5c0f\u7a0b\u5e8f\u751a\u81f3\u662f\u7b2c\u4e09\u65b9\u5e94\u7528\u7684\u670d\u52a1\u3002</p> <p></p> <p>\u867d\u7136\u8fd9\u79cd\u6a21\u5f0f\u6bd4\u8f83\u7b80\u4fbf\uff0c\u4f46\u662f\u5df2\u7ecf\u5931\u53bb\u4e86\u7528\u6237\u9a8c\u8bc1\u7684\u610f\u4e49\uff0c\u538b\u6839\u5c31\u4e0d\u662f\u7ed9\u7528\u6237\u6821\u9a8c\u51c6\u5907\u7684\uff0c\u800c\u662f\u66f4\u9002\u7528\u4e8e\u670d\u52a1\u5185\u90e8\u8c03\u7528\u7684\u573a\u666f\u3002</p> <ol> <li>\u5bc6\u7801\u6a21\u5f0f\uff08Resource Owner Password Credentials\uff09</li> </ol> <p>\u5bc6\u7801\u6a21\u5f0f\u76f8\u6bd4\u5ba2\u6237\u7aef\u6a21\u5f0f\uff0c\u5c31\u591a\u4e86\u7528\u6237\u540d\u548c\u5bc6\u7801\u7684\u4fe1\u606f\uff0c\u7528\u6237\u9700\u8981\u63d0\u4f9b\u5bf9\u5e94\u8d26\u53f7\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u624d\u80fd\u83b7\u53d6\u5230Token\u3002</p> <p></p> <p>\u867d\u7136\u8fd9\u6837\u770b\u8d77\u6765\u6bd4\u8f83\u5408\u7406\uff0c\u4f46\u662f\u4f1a\u76f4\u63a5\u5c06\u8d26\u53f7\u548c\u5bc6\u7801\u6cc4\u9732\u7ed9\u5ba2\u6237\u7aef\uff0c\u9700\u8981\u540e\u53f0\u5b8c\u5168\u4fe1\u4efb\u5ba2\u6237\u7aef\u4e0d\u4f1a\u62ff\u8d26\u53f7\u5bc6\u7801\u53bb\u5e72\u5176\u4ed6\u574f\u4e8b\uff0c\u6240\u4ee5\u8fd9\u4e5f\u4e0d\u662f\u6211\u4eec\u5e38\u89c1\u7684\u3002</p> <ol> <li>\u9690\u5f0f\u6388\u6743\u6a21\u5f0f\uff08Implicit Grant\uff09</li> </ol> <p>\u9996\u5148\u7528\u6237\u8bbf\u95ee\u9875\u9762\u65f6\uff0c\u4f1a\u91cd\u5b9a\u5411\u5230\u8ba4\u8bc1\u670d\u52a1\u5668\uff0c\u63a5\u7740\u8ba4\u8bc1\u670d\u52a1\u5668\u7ed9\u7528\u6237\u4e00\u4e2a\u8ba4\u8bc1\u9875\u9762\uff0c\u7b49\u5f85\u7528\u6237\u6388\u6743\uff0c\u7528\u6237\u586b\u5199\u4fe1\u606f\u5b8c\u6210\u6388\u6743\u540e\uff0c\u8ba4\u8bc1\u670d\u52a1\u5668\u8fd4\u56deToken\u3002</p> <p></p> <p>\u5b83\u9002\u7528\u4e8e\u6ca1\u6709\u670d\u52a1\u7aef\u7684\u7b2c\u4e09\u65b9\u5e94\u7528\u9875\u9762\uff0c\u5e76\u4e14\u76f8\u6bd4\u524d\u9762\u4e00\u79cd\u5f62\u5f0f\uff0c\u9a8c\u8bc1\u90fd\u662f\u5728\u9a8c\u8bc1\u670d\u52a1\u5668\u8fdb\u884c\u7684\uff0c\u654f\u611f\u4fe1\u606f\u4e0d\u4f1a\u8f7b\u6613\u6cc4\u9732\uff0c\u4f46\u662fToken\u4f9d\u7136\u5b58\u5728\u6cc4\u9732\u7684\u98ce\u9669\u3002</p> <ol> <li>\u6388\u6743\u7801\u6a21\u5f0f\uff08Authrization Code\uff09</li> </ol> <p>\u8fd9\u79cd\u6a21\u5f0f\u662f\u6700\u5b89\u5168\u7684\u4e00\u79cd\u6a21\u5f0f\uff0c\u4e5f\u662f\u63a8\u8350\u4f7f\u7528\u7684\u4e00\u79cd\uff0c\u6bd4\u5982\u6211\u4eec\u624b\u673a\u4e0a\u7684\u5f88\u591aApp\u90fd\u662f\u4f7f\u7528\u7684\u8fd9\u79cd\u6a21\u5f0f\u3002</p> <p>\u76f8\u6bd4\u9690\u5f0f\u6388\u6743\u6a21\u5f0f\uff0c\u5b83\u5e76\u4e0d\u4f1a\u76f4\u63a5\u8fd4\u56deToken\uff0c\u800c\u662f\u8fd4\u56de\u6388\u6743\u7801\uff0c\u771f\u6b63\u7684Token\u662f\u901a\u8fc7\u5e94\u7528\u670d\u52a1\u5668\u8bbf\u95ee\u9a8c\u8bc1\u670d\u52a1\u5668\u83b7\u5f97\u7684\u3002\u5728\u4e00\u5f00\u59cb\u7684\u65f6\u5019\uff0c\u5e94\u7528\u670d\u52a1\u5668\uff08\u5ba2\u6237\u7aef\u901a\u8fc7\u8bbf\u95ee\u81ea\u5df1\u7684\u5e94\u7528\u670d\u52a1\u5668\u6765\u8fdb\u800c\u8bbf\u95ee\u5176\u4ed6\u670d\u52a1\uff09\u548c\u9a8c\u8bc1\u670d\u52a1\u5668\u4e4b\u95f4\u4f1a\u5171\u4eab\u4e00\u4e2a<code>secret</code>\uff0c\u8fd9\u4e2a\u4e1c\u897f\u6ca1\u6709\u5176\u4ed6\u4eba\u77e5\u9053\uff0c\u800c\u9a8c\u8bc1\u670d\u52a1\u5668\u5728\u7528\u6237\u9a8c\u8bc1\u5b8c\u6210\u4e4b\u540e\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u6388\u6743\u7801\uff0c\u5e94\u7528\u670d\u52a1\u5668\u6700\u540e\u5c06\u6388\u6743\u7801\u548c<code>secret</code>\u4e00\u8d77\u4ea4\u7ed9\u9a8c\u8bc1\u670d\u52a1\u5668\u8fdb\u884c\u9a8c\u8bc1\uff0c\u5e76\u4e14Token\u4e5f\u662f\u5728\u670d\u52a1\u7aef\u4e4b\u95f4\u4f20\u9012\uff0c\u4e0d\u4f1a\u76f4\u63a5\u7ed9\u5230\u5ba2\u6237\u7aef\u3002</p> <p></p> <p>\u8fd9\u6837\u5c31\u7b97\u6709\u4eba\u4e2d\u9014\u7a83\u53d6\u4e86\u6388\u6743\u7801\uff0c\u4e5f\u6beb\u65e0\u610f\u4e49\uff0c\u56e0\u4e3a\uff0cToken\u7684\u83b7\u53d6\u5fc5\u987b\u540c\u65f6\u643a\u5e26\u6388\u6743\u7801\u548csecret\uff0c\u4f46\u662f<code>secret</code>\u7b2c\u4e09\u65b9\u662f\u65e0\u6cd5\u5f97\u77e5\u7684\uff0c\u5e76\u4e14Token\u4e0d\u4f1a\u76f4\u63a5\u4e22\u7ed9\u5ba2\u6237\u7aef\uff0c\u5927\u5927\u51cf\u5c11\u4e86\u6cc4\u9732\u7684\u98ce\u9669\u3002</p> <p>\u4f46\u662f\u4e4d\u4e00\u770b\uff0cOAuth 2.0\u4e0d\u5e94\u8be5\u662f\u90a3\u79cd\u7b2c\u4e09\u65b9\u5e94\u7528\u4e3a\u4e86\u8bf7\u6c42\u6211\u4eec\u7684\u670d\u52a1\u800c\u4f7f\u7528\u7684\u5417\uff0c\u800c\u6211\u4eec\u8fd9\u91cc\u9700\u8981\u7684\u53ea\u662f\u5b9e\u73b0\u540c\u4e00\u4e2a\u5e94\u7528\u5185\u90e8\u670d\u52a1\u4e4b\u95f4\u7684\u8ba4\u8bc1\uff0c\u5176\u5b9e\u6211\u4e5f\u53ef\u4ee5\u5229\u7528 OAuth2.0 \u6765\u5b9e\u73b0\u5355\u70b9\u767b\u5f55\uff0c\u53ea\u662f\u5c11\u4e86\u8d44\u6e90\u670d\u52a1\u5668\u8fd9\u4e00\u89d2\u8272\uff0c\u5ba2\u6237\u7aef\u5c31\u662f\u6211\u4eec\u7684\u6574\u4e2a\u7cfb\u7edf\uff0c\u63a5\u4e0b\u6765\u5c31\u8ba9\u6211\u4eec\u6765\u5b9e\u73b0\u4e00\u4e0b\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_4","title":"\u642d\u5efa\u9a8c\u8bc1\u670d\u52a1\u5668","text":"<p>\u7b2c\u4e00\u6b65\u5c31\u662f\u6700\u91cd\u8981\u7684\uff0c\u6211\u4eec\u9700\u8981\u642d\u5efa\u4e00\u4e2a\u9a8c\u8bc1\u670d\u52a1\u5668\uff0c\u5b83\u662f\u6211\u4eec\u8fdb\u884c\u6743\u9650\u6821\u9a8c\u7684\u6838\u5fc3\uff0c\u9a8c\u8bc1\u670d\u52a1\u5668\u6709\u5f88\u591a\u7684\u7b2c\u4e09\u65b9\u5b9e\u73b0\u4e5f\u6709Spring\u5b98\u65b9\u63d0\u4f9b\u7684\u5b9e\u73b0\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528Spring\u5b98\u65b9\u63d0\u4f9b\u7684\u9a8c\u8bc1\u670d\u52a1\u5668\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5c06\u6700\u5f00\u59cb\u4fdd\u5b58\u597d\u7684\u9879\u76ee\u89e3\u538b\uff0c\u5c31\u91cd\u65b0\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9879\u76ee\uff0c\u9996\u5148\u6211\u4eec\u5728\u7236\u9879\u76ee\u4e2d\u6dfb\u52a0\u6700\u65b0\u7684SpringCloud\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n    &lt;version&gt;2021.0.1&lt;/version&gt;\n    &lt;type&gt;pom&lt;/type&gt;\n    &lt;scope&gt;import&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6a21\u5757<code>auth-service</code>\uff0c\u6dfb\u52a0\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n\n    &lt;!--  OAuth2.0\u4f9d\u8d56\uff0c\u4e0d\u518d\u5185\u7f6e\u4e86\uff0c\u6240\u4ee5\u5f97\u6211\u4eec\u81ea\u5df1\u6307\u5b9a\u4e00\u4e0b\u7248\u672c  --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;\n        &lt;version&gt;2.2.5.RELEASE&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u4fee\u6539\u4e00\u4e0b\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>server:\n  port: 8500\n  servlet:\n    #\u4e3a\u4e86\u9632\u6b62\u4e00\u4f1a\u5728\u670d\u52a1\u4e4b\u95f4\u8df3\u8f6c\u5bfc\u81f4Cookie\u6253\u67b6\uff08\u56e0\u4e3a\u6240\u6709\u670d\u52a1\u5730\u5740\u90fd\u662flocalhost\uff0c\u90fd\u4f1a\u5b58JSESSIONID\uff09\n    #\u8fd9\u91cc\u4fee\u6539\u4e00\u4e0bcontext-path\uff0c\u8fd9\u6837\u4fdd\u5b58\u7684Cookie\u4f1a\u4f7f\u7528\u6307\u5b9a\u7684\u8def\u5f84\uff0c\u5c31\u4e0d\u4f1a\u548c\u5176\u4ed6\u670d\u52a1\u6253\u67b6\u4e86\n    #\u4f46\u662f\u6ce8\u610f\u4e4b\u540e\u7684\u8bf7\u6c42\u90fd\u5f97\u5728\u6700\u524d\u9762\u52a0\u4e0a\u8fd9\u4e2a\u8def\u5f84\n    context-path: /sso\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u7f16\u5199\u4e00\u4e0b\u914d\u7f6e\u7c7b\uff0c\u8fd9\u91cc\u9700\u8981\u4e24\u4e2a\u914d\u7f6e\u7c7b\uff0c\u4e00\u4e2a\u662fOAuth2\u7684\u914d\u7f6e\u7c7b\uff0c\u8fd8\u6709\u4e00\u4e2a\u662fSpringSecurity\u7684\u914d\u7f6e\u7c7b\uff1a</p> <pre><code>@Configuration\npublic class SecurityConfiguration extends WebSecurityConfigurerAdapter {\n\n    @Override\n    protected void configure(HttpSecurity http) throws Exception {\n        http\n                .authorizeRequests()\n                .anyRequest().authenticated()  //\n                .and()\n                .formLogin().permitAll();    //\u4f7f\u7528\u8868\u5355\u767b\u5f55\n    }\n\n    @Override\n    protected void configure(AuthenticationManagerBuilder auth) throws Exception {\n        BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();\n        auth\n                .inMemoryAuthentication()   //\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u7528\u6237\uff0c\u61d2\u5f97\u641e\u6570\u636e\u5e93\u4e86\n                .passwordEncoder(encoder)\n                .withUser(\"test\").password(encoder.encode(\"123456\")).roles(\"USER\");\n    }\n\n    @Bean   //\u8fd9\u91cc\u9700\u8981\u5c06AuthenticationManager\u6ce8\u518c\u4e3aBean\uff0c\u5728OAuth\u914d\u7f6e\u4e2d\u4f7f\u7528\n    @Override\n    public AuthenticationManager authenticationManagerBean() throws Exception {\n        return super.authenticationManagerBean();\n    }\n}\n</code></pre> <pre><code>@EnableAuthorizationServer   //\u5f00\u542f\u9a8c\u8bc1\u670d\u52a1\u5668\n@Configuration\npublic class OAuth2Configuration extends AuthorizationServerConfigurerAdapter {\n\n    @Resource\n    private AuthenticationManager manager;\n\n    private final BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();\n\n    /**\n     * \u8fd9\u4e2a\u65b9\u6cd5\u662f\u5bf9\u5ba2\u6237\u7aef\u8fdb\u884c\u914d\u7f6e\uff0c\u4e00\u4e2a\u9a8c\u8bc1\u670d\u52a1\u5668\u53ef\u4ee5\u9884\u8bbe\u5f88\u591a\u4e2a\u5ba2\u6237\u7aef\uff0c\n     * \u4e4b\u540e\u8fd9\u4e9b\u6307\u5b9a\u7684\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u6309\u7167\u4e0b\u9762\u6307\u5b9a\u7684\u65b9\u5f0f\u8fdb\u884c\u9a8c\u8bc1\n     * @param clients \u5ba2\u6237\u7aef\u914d\u7f6e\u5de5\u5177\n     */\n    @Override\n    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n        clients\n                .inMemory()   //\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u786c\u7f16\u7801\u521b\u5efa\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u50cfSecurity\u90a3\u6837\u81ea\u5b9a\u4e49\u6216\u662f\u4f7f\u7528JDBC\u4ece\u6570\u636e\u5e93\u8bfb\u53d6\n                .withClient(\"web\")   //\u5ba2\u6237\u7aef\u540d\u79f0\uff0c\u968f\u4fbf\u8d77\u5c31\u884c\n                .secret(encoder.encode(\"654321\"))      //\u53ea\u4e0e\u5ba2\u6237\u7aef\u5206\u4eab\u7684secret\uff0c\u968f\u4fbf\u5199\uff0c\u4f46\u662f\u6ce8\u610f\u8981\u52a0\u5bc6\n                .autoApprove(false)    //\u81ea\u52a8\u5ba1\u6279\uff0c\u8fd9\u91cc\u5173\u95ed\uff0c\u8981\u7684\u5c31\u662f\u4e00\u4f1a\u4f53\u9a8c\u90a3\u79cd\u611f\u89c9\n                .scopes(\"book\", \"user\", \"borrow\")     //\u6388\u6743\u8303\u56f4\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u5168\u90e8all\n                .authorizedGrantTypes(\"client_credentials\", \"password\", \"implicit\", \"authorization_code\", \"refresh_token\");\n                //\u6388\u6743\u6a21\u5f0f\uff0c\u4e00\u5171\u652f\u63015\u79cd\uff0c\u9664\u4e86\u4e4b\u524d\u6211\u4eec\u4ecb\u7ecd\u7684\u56db\u79cd\u4e4b\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u5237\u65b0Token\u7684\u6a21\u5f0f\n                //\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u628a\u4e94\u79cd\u90fd\u5199\u4e0a\uff0c\u65b9\u4fbf\u4e00\u4f1a\u5b9e\u9a8c\uff0c\u5f53\u7136\u5404\u4f4d\u4e5f\u53ef\u4ee5\u5355\u72ec\u53ea\u5199\u4e00\u79cd\u4e00\u4e2a\u4e00\u4e2a\u8fdb\u884c\u6d4b\u8bd5\n                //\u73b0\u5728\u6211\u4eec\u6307\u5b9a\u7684\u5ba2\u6237\u7aef\u5c31\u652f\u6301\u8fd9\u4e94\u79cd\u7c7b\u578b\u7684\u6388\u6743\u65b9\u5f0f\u4e86\n    }\n\n    @Override\n    public void configure(AuthorizationServerSecurityConfigurer security) {\n        security\n                .passwordEncoder(encoder)    //\u7f16\u7801\u5668\u8bbe\u5b9a\u4e3aBCryptPasswordEncoder\n                .allowFormAuthenticationForClients()  //\u5141\u8bb8\u5ba2\u6237\u7aef\u4f7f\u7528\u8868\u5355\u9a8c\u8bc1\uff0c\u4e00\u4f1a\u6211\u4eecPOST\u8bf7\u6c42\u4e2d\u4f1a\u643a\u5e26\u8868\u5355\u4fe1\u606f\n                .checkTokenAccess(\"permitAll()\");     //\u5141\u8bb8\u6240\u6709\u7684Token\u67e5\u8be2\u8bf7\u6c42\n    }\n\n    @Override\n    public void configure(AuthorizationServerEndpointsConfigurer endpoints) {\n        endpoints\n                .authenticationManager(manager);\n        //\u7531\u4e8eSpringSecurity\u65b0\u7248\u672c\u7684\u4e00\u4e9b\u5e95\u5c42\u6539\u52a8\uff0c\u8fd9\u91cc\u9700\u8981\u914d\u7f6e\u4e00\u4e0bauthenticationManager\uff0c\u624d\u80fd\u6b63\u5e38\u4f7f\u7528password\u6a21\u5f0f\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u542f\u52a8\u670d\u52a1\u5668\u4e86\uff1a</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u4f7f\u7528Postman\u8fdb\u884c\u63a5\u53e3\u6d4b\u8bd5\uff0c\u9996\u5148\u6211\u4eec\u4ece\u6700\u7b80\u5355\u7684\u5ba2\u6237\u7aef\u6a21\u5f0f\u8fdb\u884c\u6d4b\u8bd5\uff0c\u5ba2\u6237\u7aef\u6a21\u5f0f\u53ea\u9700\u8981\u63d0\u4f9bid\u548csecret\u5373\u53ef\u76f4\u63a5\u62ff\u5230Token\uff0c\u6ce8\u610f\u9700\u8981\u518d\u6dfb\u52a0\u4e00\u4e2agrant_type\u6765\u8868\u660e\u6211\u4eec\u7684\u6388\u6743\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u8bf7\u6c42\u8def\u5f84\u4e3ahttp://localhost:8500/sso/oauth/token\uff1a</p> <p></p> <p>\u53d1\u8d77\u8bf7\u6c42\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u5f97\u5230\u4e86Token\uff0c\u5b83\u662f\u4ee5JSON\u683c\u5f0f\u7ed9\u5230\u6211\u4eec\u7684\uff1a</p> <p></p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u8bbf\u95ee http://localhost:8500/sso/oauth/check_token \u6765\u9a8c\u8bc1\u6211\u4eec\u7684Token\u662f\u5426\u6709\u6548\uff1a</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230active\u4e3atrue\uff0c\u8868\u793a\u6211\u4eec\u521a\u521a\u7533\u8bf7\u5230\u7684Token\u662f\u6709\u6548\u7684\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\u7b2c\u4e8c\u79cdpassword\u6a21\u5f0f\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u63d0\u4f9b\u5177\u4f53\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u6388\u6743\u6a21\u5f0f\u5b9a\u4e49\u4e3apassword\u5373\u53ef\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5728\u8bf7\u6c42\u5934\u4e2d\u6dfb\u52a0Basic\u9a8c\u8bc1\u4fe1\u606f\uff0c\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u586b\u5199id\u548csecret\u5373\u53ef\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5728\u8bf7\u6c42\u5934\u4e2d\u81ea\u52a8\u751f\u6210\u4e86Basic\u9a8c\u8bc1\u76f8\u5173\u5185\u5bb9\uff1a</p> <p></p> <p></p> <p>\u54cd\u5e94\u6210\u529f\uff0c\u5f97\u5230Token\u4fe1\u606f\uff0c\u5e76\u4e14\u8fd9\u91cc\u8fd8\u591a\u51fa\u4e86\u4e00\u4e2arefresh_token\uff0c\u8fd9\u662f\u7528\u4e8e\u5237\u65b0Token\u7684\uff0c\u6211\u4eec\u4e4b\u540e\u4f1a\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p></p> <p>\u67e5\u8be2Token\u4fe1\u606f\u4e4b\u540e\u8fd8\u53ef\u4ee5\u770b\u5230\u767b\u5f55\u7684\u5177\u4f53\u7528\u6237\u4ee5\u53ca\u89d2\u8272\u6743\u9650\u7b49\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u6765\u770b\u9690\u5f0f\u6388\u6743\u6a21\u5f0f\uff0c\u8fd9\u79cd\u6a21\u5f0f\u6211\u4eec\u9700\u8981\u5728\u9a8c\u8bc1\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u767b\u5f55\u64cd\u4f5c\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u8bf7\u6c42Token\uff0c\u9a8c\u8bc1\u767b\u5f55\u8bf7\u6c42\u5730\u5740\uff1ahttp://localhost:8500/sso/oauth/authorize?client_id=web&amp;response_type=token</p> <p>\u6ce8\u610fresponse_type\u4e00\u5b9a\u8981\u662ftoken\u7c7b\u578b\uff0c\u8fd9\u6837\u624d\u4f1a\u76f4\u63a5\u8fd4\u56deToken\uff0c\u6d4f\u89c8\u5668\u53d1\u8d77\u8bf7\u6c42\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u719f\u6089\u800c\u53c8\u964c\u751f\u7684\u754c\u9762\uff0c\u6ca1\u9519\uff0c\u5b9e\u9645\u4e0a\u8fd9\u91cc\u5c31\u662f\u4f7f\u7528\u6211\u4eec\u4e4b\u524d\u8bb2\u89e3\u7684SpringSecurity\u8fdb\u884c\u767b\u9646\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u914d\u7f6e\u4e00\u4e0b\u8bb0\u4f4f\u6211\u4e4b\u7c7b\u7684\u529f\u80fd\uff0c\u8fd9\u91cc\u5c31\u4e0d\u6f14\u793a\u4e86\uff1a</p> <p></p> <p>\u4f46\u662f\u767b\u5f55\u4e4b\u540e\u6211\u4eec\u53d1\u73b0\u51fa\u73b0\u4e86\u4e00\u4e2a\u9519\u8bef\uff1a</p> <p></p> <p>\u8fd9\u662f\u56e0\u4e3a\u767b\u5f55\u6210\u529f\u4e4b\u540e\uff0c\u9a8c\u8bc1\u670d\u52a1\u5668\u9700\u8981\u5c06\u7ed3\u679c\u7ed9\u56de\u5ba2\u6237\u7aef\uff0c\u6240\u4ee5\u9700\u8981\u63d0\u4f9b\u5ba2\u6237\u7aef\u7684\u56de\u8c03\u5730\u5740\uff0c\u8fd9\u6837\u6d4f\u89c8\u5668\u5c31\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230\u6307\u5b9a\u7684\u56de\u8c03\u5730\u5740\u5e76\u4e14\u8bf7\u6c42\u4e2d\u4f1a\u643a\u5e26Token\u4fe1\u606f\uff0c\u8fd9\u91cc\u6211\u4eec\u968f\u4fbf\u914d\u7f6e\u4e00\u4e2a\u56de\u8c03\u5730\u5740\uff1a</p> <pre><code>@Override\npublic void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n    clients\n            .inMemory()\n            .withClient(\"web\")\n            .secret(encoder.encode(\"654321\"))\n            .autoApprove(false)\n            .scopes(\"book\", \"user\", \"borrow\")\n            .redirectUris(\"http://localhost:8201/login\")   //\u53ef\u4ee5\u5199\u591a\u4e2a\uff0c\u5f53\u6709\u591a\u4e2a\u65f6\u9700\u8981\u5728\u9a8c\u8bc1\u8bf7\u6c42\u4e2d\u6307\u5b9a\u4f7f\u7528\u54ea\u4e2a\u5730\u5740\u8fdb\u884c\u56de\u8c03\n            .authorizedGrantTypes(\"client_credentials\", \"password\", \"implicit\", \"authorization_code\", \"refresh_token\");\n}\n</code></pre> <p>\u63a5\u7740\u91cd\u542f\u9a8c\u8bc1\u670d\u52a1\u5668\uff0c\u518d\u6b21\u8bbf\u95ee\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u4f1a\u8ba9\u6211\u4eec\u9009\u62e9\u54ea\u4e9b\u8303\u56f4\u8fdb\u884c\u6388\u6743\uff0c\u5c31\u50cf\u6211\u4eec\u5728\u5fae\u4fe1\u5c0f\u7a0b\u5e8f\u4e2d\u767b\u9646\u4e00\u6837\uff0c\u4f1a\u8ba9\u6211\u4eec\u6388\u4e88\u7528\u6237\u4fe1\u606f\u6743\u9650\u3001\u652f\u4ed8\u6743\u9650\u3001\u4fe1\u7528\u67e5\u8be2\u6743\u9650\u7b49\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u7531\u51b3\u5b9a\u8981\u4e0d\u8981\u7ed9\u5ba2\u6237\u7aef\u6388\u4e88\u8bbf\u95ee\u8fd9\u4e9b\u8d44\u6e90\u7684\u6743\u9650\uff0c\u8fd9\u91cc\u6211\u4eec\u5168\u90e8\u9009\u62e9\u6388\u4e88\uff1a</p> <p></p> <p>\u6388\u4e88\u4e4b\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u6d4f\u89c8\u5668\u88ab\u91cd\u5b9a\u5411\u5230\u6211\u4eec\u521a\u521a\u6307\u5b9a\u7684\u56de\u8c03\u5730\u5740\u4e2d\uff0c\u5e76\u4e14\u643a\u5e26\u4e86Token\u4fe1\u606f\uff0c\u73b0\u5728\u6211\u4eec\u6765\u6821\u9a8c\u4e00\u4e0b\u770b\u770b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0cToken\u4e5f\u662f\u6709\u6548\u7684\u3002</p> <p>\u6700\u540e\u6211\u4eec\u6765\u770b\u770b\u7b2c\u56db\u79cd\u6700\u5b89\u5168\u7684\u6388\u6743\u7801\u6a21\u5f0f\uff0c\u8fd9\u79cd\u6a21\u5f0f\u5176\u5b9e\u6d41\u7a0b\u548c\u4e0a\u9762\u662f\u4e00\u6837\u7684\uff0c\u4f46\u662f\u8bf7\u6c42\u7684\u662fcode\u7c7b\u578b\uff1ahttp://localhost:8500/sso/oauth/authorize?client_id=web&amp;response_type=code</p> <p>\u53ef\u4ee5\u770b\u5230\u8bbf\u95ee\u4e4b\u540e\uff0c\u4f9d\u7136\u4f1a\u8fdb\u5165\u5230\u56de\u8c03\u5730\u5740\uff0c\u4f46\u662f\u8fd9\u65f6\u7ed9\u7684\u5c31\u662f\u6388\u6743\u7801\u4e86\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u7ed9Token\uff0c\u90a3\u4e48\u8fd9\u4e2aToken\u8be5\u600e\u4e48\u83b7\u53d6\u5462\uff1f</p> <p></p> <p>\u6309\u7167\u6211\u4eec\u4e4b\u524d\u8bb2\u89e3\u7684\u539f\u7406\uff0c\u6211\u4eec\u9700\u8981\u643a\u5e26\u6388\u6743\u7801\u548csecret\u4e00\u8d77\u8bf7\u6c42\uff0c\u624d\u80fd\u62ff\u5230Token\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u662f\u7531\u56de\u8c03\u7684\u670d\u52a1\u5668\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u5728Postman\u4e2d\u8fdb\u884c\uff0c\u6211\u4eec\u590d\u5236\u521a\u521a\u5f97\u5230\u7684\u6388\u6743\u7801\uff0c\u63a5\u53e3\u4f9d\u7136\u662f<code>localhost:8500/sso/oauth/token</code>\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u7ed3\u679c\u4e5f\u662f\u6b63\u5e38\u8fd4\u56de\u4e86Token\u4fe1\u606f\uff1a</p> <p></p> <p>\u8fd9\u6837\u6211\u4eec\u56db\u79cd\u6700\u57fa\u672c\u7684Token\u8bf7\u6c42\u65b9\u5f0f\u5c31\u5b9e\u73b0\u4e86\u3002</p> <p>\u6700\u540e\u8fd8\u6709\u4e00\u4e2a\u662f\u5237\u65b0\u4ee4\u724c\u4f7f\u7528\u7684\uff0c\u5f53\u6211\u4eec\u7684Token\u8fc7\u671f\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2arefresh_token\u6765\u7533\u8bf7\u4e00\u4e2a\u65b0\u7684Token\uff1a</p> <p></p> <p>\u4f46\u662f\u6267\u884c\u4e4b\u540e\u6211\u4eec\u53d1\u73b0\u4f1a\u76f4\u63a5\u51fa\u73b0\u4e00\u4e2a\u5185\u90e8\u9519\u8bef\uff1a</p> <p></p> <p></p> <p>\u67e5\u770b\u65e5\u5fd7\u53d1\u73b0\uff0c\u8fd9\u91cc\u8fd8\u9700\u8981\u6211\u4eec\u5355\u72ec\u914d\u7f6e\u4e00\u4e2aUserDetailsService\uff0c\u6211\u4eec\u76f4\u63a5\u628aSecurity\u4e2d\u7684\u5b9e\u4f8b\u6ce8\u518c\u4e3aBean\uff1a</p> <pre><code>@Bean\n@Override\npublic UserDetailsService userDetailsServiceBean() throws Exception {\n    return super.userDetailsServiceBean();\n}\n</code></pre> <p>\u7136\u540e\u5728Endpoint\u4e2d\u8bbe\u7f6e\uff1a</p> <pre><code>@Resource\nUserDetailsService service;\n\n@Override\npublic void configure(AuthorizationServerEndpointsConfigurer endpoints) {\n    endpoints\n            .userDetailsService(service)\n            .authenticationManager(manager);\n}\n</code></pre> <p>\u6700\u540e\u518d\u6b21\u5c1d\u8bd5\u5237\u65b0Token\uff1a</p> <p></p> <p>OK\uff0c\u6210\u529f\u5237\u65b0Token\uff0c\u8fd4\u56de\u4e86\u4e00\u4e2a\u65b0\u7684\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#enableoauth2sso","title":"\u57fa\u4e8e@EnableOAuth2Sso\u5b9e\u73b0","text":"<p>\u524d\u9762\u6211\u4eec\u5c06\u9a8c\u8bc1\u670d\u52a1\u5668\u5df2\u7ecf\u642d\u5efa\u5b8c\u6210\u4e86\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u6765\u5b9e\u73b0\u4e00\u4e0b\u5355\u70b9\u767b\u9646\u5427\uff0cSpringCloud\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5ba2\u6237\u7aef\u7684\u76f4\u63a5\u5b9e\u73b0\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u6ce8\u89e3\u548c\u5c11\u91cf\u914d\u7f6e\u5373\u53ef\u5c06\u6211\u4eec\u7684\u670d\u52a1\u4f5c\u4e3a\u4e00\u4e2a\u5355\u70b9\u767b\u9646\u5e94\u7528\uff0c\u4f7f\u7528\u7684\u662f\u7b2c\u56db\u79cd\u6388\u6743\u7801\u6a21\u5f0f\u3002</p> <p>\u4e00\u53e5\u8bdd\u6765\u8bf4\u5c31\u662f\uff0c\u8fd9\u79cd\u6a21\u5f0f\u53ea\u662f\u5c06\u9a8c\u8bc1\u65b9\u5f0f\u7531\u539f\u672c\u7684\u9ed8\u8ba4\u767b\u5f55\u5f62\u5f0f\u6539\u53d8\u4e3a\u4e86\u7edf\u4e00\u5728\u6388\u6743\u670d\u52a1\u5668\u767b\u9646\u7684\u5f62\u5f0f\u3002</p> <p>\u9996\u5148\u8fd8\u662f\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;\n    &lt;version&gt;2.2.5.RELEASE&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6211\u4eec\u53ea\u9700\u8981\u76f4\u63a5\u5728\u542f\u52a8\u7c7b\u4e0a\u6dfb\u52a0\u5373\u53ef\uff1a</p> <pre><code>@EnableOAuth2Sso\n@SpringBootApplication\npublic class BookApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(BookApplication.class, args);\n    }\n}\n</code></pre> <p>\u6211\u4eec\u4e0d\u9700\u8981\u8fdb\u884c\u989d\u5916\u7684\u914d\u7f6e\u7c7b\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6ce8\u89e3\u5df2\u7ecf\u5e2e\u6211\u4eec\u505a\u4e86\uff1a</p> <pre><code>@Target({ElementType.TYPE})\n@Retention(RetentionPolicy.RUNTIME)\n@Documented\n@EnableOAuth2Client\n@EnableConfigurationProperties({OAuth2SsoProperties.class})\n@Import({OAuth2SsoDefaultConfiguration.class, OAuth2SsoCustomConfiguration.class, ResourceServerTokenServicesConfiguration.class})\npublic @interface EnableOAuth2Sso {\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u5b83\u76f4\u63a5\u6ce8\u518c\u4e86OAuth2SsoDefaultConfiguration\uff0c\u800c\u8fd9\u4e2a\u7c7b\u5c31\u662f\u5e2e\u52a9\u6211\u4eec\u5bf9Security\u8fdb\u884c\u914d\u7f6e\u7684\uff1a</p> <pre><code>@Configuration\n@Conditional({NeedsWebSecurityCondition.class})\npublic class OAuth2SsoDefaultConfiguration extends WebSecurityConfigurerAdapter {\n    //\u76f4\u63a5\u7ee7\u627f\u7684WebSecurityConfigurerAdapter\uff0c\u5e2e\u6211\u4eec\u628a\u9a8c\u8bc1\u8bbe\u7f6e\u90fd\u5199\u597d\u4e86\n    private final ApplicationContext applicationContext;\n\n    public OAuth2SsoDefaultConfiguration(ApplicationContext applicationContext) {\n        this.applicationContext = applicationContext;\n    }\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u6211\u4eec\u7684\u9a8c\u8bc1\u670d\u52a1\u5668\u76f8\u5173\u4fe1\u606f\uff1a</p> <pre><code>security:\n  oauth2:\n    client:\n      #\u4e0d\u591a\u8bf4\u4e86\n      client-id: web\n      client-secret: 654321\n      #Token\u83b7\u53d6\u5730\u5740\n      access-token-uri: http://localhost:8500/sso/oauth/token\n      #\u9a8c\u8bc1\u9875\u9762\u5730\u5740\n      user-authorization-uri: http://localhost:8500/sso/oauth/authorize\n    resource:\n      #Token\u4fe1\u606f\u83b7\u53d6\u548c\u6821\u9a8c\u5730\u5740\n      token-info-uri: http://localhost:8500/sso/oauth/check_token\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5c31\u5f00\u542f\u56fe\u4e66\u670d\u52a1\uff0c\u8c03\u7528\u56fe\u4e66\u63a5\u53e3\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5728\u53d1\u73b0\u6ca1\u6709\u767b\u5f55\u9a8c\u8bc1\u65f6\uff0c\u4f1a\u76f4\u63a5\u8df3\u8f6c\u5230\u6388\u6743\u9875\u9762\uff0c\u8fdb\u884c\u6388\u6743\u767b\u5f55\uff0c\u4e4b\u540e\u624d\u53ef\u4ee5\u7ee7\u7eed\u8bbf\u95ee\u56fe\u4e66\u670d\u52a1\uff1a</p> <p></p> <p>\u90a3\u4e48\u7528\u6237\u4fe1\u606f\u5462\uff1f\u662f\u5426\u4e5f\u4e00\u5e76\u4fdd\u5b58\u8fc7\u6765\u4e86\uff1f\u6211\u4eec\u8fd9\u91cc\u76f4\u63a5\u83b7\u53d6\u4e00\u4e0bSpringSecurity\u7684Context\u67e5\u770b\u7528\u6237\u4fe1\u606f\uff0c\u83b7\u53d6\u65b9\u5f0f\u8ddf\u6211\u4eec\u4e4b\u524d\u7684\u89c6\u9891\u4e2d\u8bb2\u89e3\u7684\u662f\u4e00\u6837\u7684\uff1a</p> <pre><code>@RequestMapping(\"/book/{bid}\")\nBook findBookById(@PathVariable(\"bid\") int bid){\n    //\u901a\u8fc7SecurityContextHolder\u5c06\u7528\u6237\u4fe1\u606f\u53d6\u51fa\n    SecurityContext context = SecurityContextHolder.getContext();\n    System.out.println(context.getAuthentication());\n    return service.getBookById(bid);\n}\n</code></pre> <p>\u518d\u6b21\u8bbf\u95ee\u56fe\u4e66\u7ba1\u7406\u63a5\u53e3\uff0c\u53ef\u4ee5\u770b\u5230\uff1a</p> <p></p> <p>\u8fd9\u91cc\u4f7f\u7528\u7684\u4e0d\u662f\u4e4b\u524d\u7684UsernamePasswordAuthenticationToken\u4e5f\u4e0d\u662fRememberMeAuthenticationToken\uff0c\u800c\u662f\u65b0\u7684OAuth2Authentication\uff0c\u5b83\u4fdd\u5b58\u4e86\u9a8c\u8bc1\u670d\u52a1\u5668\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u4ee5\u53ca\u7ecf\u8fc7\u6211\u4eec\u4e4b\u524d\u7684\u767b\u9646\u6d41\u7a0b\u4e4b\u540e\uff0c\u9a8c\u8bc1\u670d\u52a1\u5668\u53d1\u653e\u7ed9\u5ba2\u6237\u7aef\u7684Token\u4fe1\u606f\uff0c\u5e76\u901a\u8fc7Token\u4fe1\u606f\u5728\u9a8c\u8bc1\u670d\u52a1\u5668\u8fdb\u884c\u9a8c\u8bc1\u83b7\u53d6\u7528\u6237\u4fe1\u606f\uff0c\u6700\u540e\u4fdd\u5b58\u5230Session\u4e2d\uff0c\u8868\u793a\u7528\u6237\u5df2\u9a8c\u8bc1\uff0c\u6240\u4ee5\u672c\u8d28\u4e0a\u8fd8\u662f\u8981\u4f9d\u8d56\u6d4f\u89c8\u5668\u5b58Cookie\u7684\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u6240\u6709\u7684\u670d\u52a1\u90fd\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u8fdb\u884c\u9a8c\u8bc1\uff0c\u522b\u5fd8\u4e86\u628a\u91cd\u5b9a\u5411\u5730\u5740\u7ed9\u6240\u6709\u670d\u52a1\u90fd\u52a0\u4e0a\uff1a</p> <pre><code>@Override\npublic void configure(ClientDetailsServiceConfigurer clients) throws Exception {\n    clients\n            .inMemory()\n            .withClient(\"web\")\n            .secret(encoder.encode(\"654321\"))\n            .autoApprove(true)   //\u8fd9\u91cc\u628a\u81ea\u52a8\u5ba1\u6279\u5f00\u4e86\uff0c\u5c31\u4e0d\u7528\u518d\u53bb\u624b\u52a8\u9009\u540c\u610f\u4e86\n            .scopes(\"book\", \"user\", \"borrow\")\n            .redirectUris(\"http://localhost:8101/login\", \"http://localhost:8201/login\", \"http://localhost:8301/login\")\n            .authorizedGrantTypes(\"client_credentials\", \"password\", \"implicit\", \"authorization_code\", \"refresh_token\");\n}\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5b9e\u73b0\u53ea\u5728\u9a8c\u8bc1\u670d\u52a1\u5668\u767b\u9646\uff0c\u5982\u679c\u767b\u9646\u8fc7\u5176\u4ed6\u7684\u670d\u52a1\u90fd\u53ef\u4ee5\u8bbf\u95ee\u4e86\u3002</p> <p>\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u7531\u4e8eSESSION\u4e0d\u540c\u6b65\uff0c\u6bcf\u6b21\u5207\u6362\u4e0d\u540c\u7684\u670d\u52a1\u8fdb\u884c\u8bbf\u95ee\u90fd\u4f1a\u91cd\u65b0\u5bfc\u9a8c\u8bc1\u670d\u52a1\u5668\u53bb\u9a8c\u8bc1\u4e00\u6b21\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6709\u4e24\u4e2a\u65b9\u6848\uff1a</p> <ul> <li>\u50cf\u4e4b\u524d\u4e00\u6837\u505aSESSION\u7edf\u4e00\u5b58\u50a8</li> <li>\u8bbe\u7f6econtext-path\u8def\u5f84\uff0c\u6bcf\u4e2a\u670d\u52a1\u5355\u72ec\u8bbe\u7f6e\uff0c\u5c31\u4e0d\u4f1a\u6253\u67b6\u4e86</li> </ul> <p>\u4f46\u662f\u8fd9\u6837\u4f9d\u7136\u6ca1\u6cd5\u89e3\u51b3\u670d\u52a1\u95f4\u8c03\u7528\u7684\u95ee\u9898\uff0c\u6240\u4ee5\u4ec5\u4ec5\u4f9d\u9760\u5355\u70b9\u767b\u9646\u7684\u6a21\u5f0f\u4e0d\u592a\u884c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#enableresourceserver","title":"\u57fa\u4e8e@EnableResourceServer\u5b9e\u73b0","text":"<p>\u524d\u9762\u6211\u4eec\u8bb2\u89e3\u4e86\u5c06\u6211\u4eec\u7684\u670d\u52a1\u4f5c\u4e3a\u5355\u70b9\u767b\u9646\u5e94\u7528\u76f4\u63a5\u5b9e\u73b0\u5355\u70b9\u767b\u9646\uff0c\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u5982\u679c\u662f\u4ee5\u7b2c\u4e09\u65b9\u5e94\u7528\u8fdb\u884c\u8bbf\u95ee\u5462\uff1f\u8fd9\u65f6\u6211\u4eec\u5c31\u9700\u8981\u5c06\u6211\u4eec\u7684\u670d\u52a1\u4f5c\u4e3a\u8d44\u6e90\u670d\u52a1\u4e86\uff0c\u4f5c\u4e3a\u8d44\u6e90\u670d\u52a1\u5c31\u4e0d\u4f1a\u518d\u63d0\u4f9b\u9a8c\u8bc1\u7684\u8fc7\u7a0b\uff0c\u800c\u662f\u76f4\u63a5\u8981\u6c42\u8bf7\u6c42\u65f6\u643a\u5e26Token\uff0c\u800c\u9a8c\u8bc1\u8fc7\u7a0b\u6211\u4eec\u8fd9\u91cc\u5c31\u7ee7\u7eed\u7528Postman\u6765\u5b8c\u6210\uff0c\u8fd9\u624d\u662f\u6211\u4eec\u5e38\u89c1\u7684\u6a21\u5f0f\u3002</p> <p>\u4e00\u53e5\u8bdd\u6765\u8bf4\uff0c\u8ddf\u4e0a\u9762\u76f8\u6bd4\uff0c\u6211\u4eec\u53ea\u9700\u8981\u643a\u5e26Token\u5c31\u80fd\u8bbf\u95ee\u8fd9\u4e9b\u8d44\u6e90\u670d\u52a1\u5668\u4e86\uff0c\u5ba2\u6237\u7aef\u88ab\u72ec\u7acb\u4e86\u51fa\u6765\uff0c\u7528\u4e8e\u643a\u5e26Token\u53bb\u8bbf\u95ee\u8fd9\u4e9b\u670d\u52a1\u3002</p> <p>\u6211\u4eec\u4e5f\u53ea\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u6ce8\u89e3\u548c\u5c11\u91cf\u914d\u7f6e\u5373\u53ef\uff1a</p> <pre><code>@EnableResourceServer\n@SpringBootApplication\npublic class BookApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(BookApplication.class, args);\n    }\n}\n</code></pre> <p>\u914d\u7f6e\u4e2d\u53ea\u9700\u8981\uff1a</p> <pre><code>security:\n  oauth2:\n    client:\n        #\u57fa\u64cd\n      client-id: web\n      client-secret: 654321\n    resource:\n        #\u56e0\u4e3a\u8d44\u6e90\u670d\u52a1\u5668\u5f97\u9a8c\u8bc1\u4f60\u7684Token\u662f\u5426\u6709\u8bbf\u95ee\u6b64\u8d44\u6e90\u7684\u6743\u9650\u4ee5\u53ca\u7528\u6237\u4fe1\u606f\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u4e00\u4e2a\u9a8c\u8bc1\u5730\u5740\n      token-info-uri: http://localhost:8500/sso/oauth/check_token\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u542f\u52a8\u670d\u52a1\u5668\uff0c\u76f4\u63a5\u8bbf\u95ee\u4f1a\u53d1\u73b0\uff1a</p> <p></p> <p>\u8fd9\u662f\u7531\u4e8e\u6211\u4eec\u7684\u8bf7\u6c42\u5934\u4e2d\u6ca1\u6709\u643a\u5e26Token\u4fe1\u606f\uff0c\u73b0\u5728\u6709\u4e24\u79cd\u65b9\u5f0f\u53ef\u4ee5\u8bbf\u95ee\u6b64\u8d44\u6e90\uff1a</p> <ul> <li>\u5728URL\u540e\u9762\u6dfb\u52a0<code>access_token</code>\u8bf7\u6c42\u53c2\u6570\uff0c\u503c\u4e3aToken\u503c</li> <li>\u5728\u8bf7\u6c42\u5934\u4e2d\u6dfb\u52a0<code>Authorization</code>\uff0c\u503c\u4e3a<code>Bearer +Token\u503c</code></li> </ul> <p>\u6211\u4eec\u5148\u6765\u8bd5\u8bd5\u770b\u6700\u7b80\u7684\u4e00\u79cd\uff1a</p> <p></p> <p>\u53e6\u4e00\u79cd\u6211\u4eec\u9700\u8981\u4f7f\u7528Postman\u6765\u5b8c\u6210\uff1a</p> <p></p> <p>\u6dfb\u52a0\u9a8c\u8bc1\u4fe1\u606f\u540e\uff0c\u4f1a\u5e2e\u52a9\u6211\u4eec\u8f6c\u6362\u6210\u8bf7\u6c42\u5934\u4fe1\u606f\uff1a</p> <p></p> <p></p> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u5c06\u8d44\u6e90\u670d\u52a1\u5668\u642d\u5efa\u5b8c\u6210\u4e86\u3002</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u5982\u4f55\u5bf9\u8d44\u6e90\u670d\u52a1\u5668\u8fdb\u884c\u6df1\u5ea6\u81ea\u5b9a\u4e49\uff0c\u6211\u4eec\u53ef\u4ee5\u4e3a\u5176\u7f16\u5199\u4e00\u4e2a\u914d\u7f6e\u7c7b\uff0c\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u5e0c\u671b\u7528\u6237\u6388\u6743\u4e86\u67d0\u4e2aScope\u624d\u53ef\u4ee5\u8bbf\u95ee\u6b64\u670d\u52a1\uff1a</p> <pre><code>@Configuration\npublic class ResourceConfiguration extends ResourceServerConfigurerAdapter { //\u7ee7\u627f\u6b64\u7c7b\u8fdb\u884c\u9ad8\u5ea6\u81ea\u5b9a\u4e49\n\n    @Override\n    public void configure(HttpSecurity http) throws Exception {  //\u8fd9\u91cc\u4e5f\u6709HttpSecurity\u5bf9\u8c61\uff0c\u65b9\u4fbf\u6211\u4eec\u914d\u7f6eSpringSecurity\n        http\n                .authorizeRequests()\n                .anyRequest().access(\"#oauth2.hasScope('lbwnb')\");  //\u6dfb\u52a0\u81ea\u5b9a\u4e49\u89c4\u5219\n                        //Token\u5fc5\u987b\u8981\u6709\u6211\u4eec\u81ea\u5b9a\u4e49scope\u6388\u6743\u624d\u53ef\u4ee5\u8bbf\u95ee\u6b64\u8d44\u6e90\n    }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u5f53\u6ca1\u6709\u5bf9\u5e94\u7684scope\u6388\u6743\u65f6\uff0c\u90a3\u4e48\u4f1a\u76f4\u63a5\u8fd4\u56de<code>insufficient_scope</code>\u9519\u8bef\uff1a</p> <p></p> <p>\u4e0d\u77e5\u9053\u5404\u4f4d\u662f\u5426\u6709\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0a\u8d44\u6e90\u670d\u52a1\u5668\u5b8c\u5168\u6ca1\u6709\u5fc5\u8981\u5c06Security\u7684\u4fe1\u606f\u4fdd\u5b58\u5728Session\u4e2d\u4e86\uff0c\u56e0\u4e3a\u73b0\u5728\u53ea\u9700\u8981\u5c06Token\u544a\u8bc9\u8d44\u6e90\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u8d44\u6e90\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u8054\u7cfb\u9a8c\u8bc1\u670d\u52a1\u5668\uff0c\u5f97\u5230\u7528\u6237\u4fe1\u606f\uff0c\u5c31\u4e0d\u9700\u8981\u4f7f\u7528\u4e4b\u524d\u7684Session\u5b58\u50a8\u673a\u5236\u4e86\uff0c\u6240\u4ee5\u4f60\u4f1a\u53d1\u73b0HttpSession\u4e2d\u6ca1\u6709SPRING_SECURITY_CONTEXT\uff0c\u73b0\u5728Security\u4fe1\u606f\u90fd\u662f\u901a\u8fc7\u8fde\u63a5\u8d44\u6e90\u670d\u52a1\u5668\u83b7\u53d6\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u5c06\u6240\u6709\u7684\u670d\u52a1\u90fd</p> <p>\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\u6ca1\u6709\u89e3\u51b3\uff0c\u6211\u4eec\u5728\u4f7f\u7528RestTemplate\u8fdb\u884c\u670d\u52a1\u95f4\u7684\u8fdc\u7a0b\u8c03\u7528\u65f6\uff0c\u4f1a\u5f97\u5230\u4ee5\u4e0b\u9519\u8bef\uff1a</p> <p></p> <p>\u5b9e\u9645\u4e0a\u8fd9\u662f\u56e0\u4e3a\u5728\u670d\u52a1\u8c03\u7528\u65f6\u6ca1\u6709\u643a\u5e26Token\u4fe1\u606f\uff0c\u6211\u4eec\u5f97\u60f3\u4e2a\u529e\u6cd5\u628a\u7528\u6237\u4f20\u6765\u7684Token\u4fe1\u606f\u5728\u8fdb\u884c\u8fdc\u7a0b\u8c03\u7528\u65f6\u4e5f\u643a\u5e26\u4e0a\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528OAuth2RestTemplate\uff0c\u5b83\u4f1a\u5728\u8bf7\u6c42\u5176\u4ed6\u670d\u52a1\u65f6\u643a\u5e26\u5f53\u524d\u8bf7\u6c42\u7684Token\u4fe1\u606f\u3002\u5b83\u7ee7\u627f\u81eaRestTemplate\uff0c\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u5b9a\u4e49\u4e00\u4e2aBean\uff1a</p> <pre><code>@Configuration\npublic class WebConfiguration {\n\n    @Resource\n    OAuth2ClientContext context;\n\n    @Bean\n    public OAuth2RestTemplate restTemplate(){\n        return new OAuth2RestTemplate(new ClientCredentialsResourceDetails(), context);\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u76f4\u63a5\u66ff\u6362\u6389\u4e4b\u524d\u7684RestTemplate\u5373\u53ef\uff1a</p> <pre><code>@Service\npublic class BorrowServiceImpl implements BorrowService {\n\n    @Resource\n    BorrowMapper mapper;\n\n    @Resource\n    OAuth2RestTemplate template;\n\n    @Override\n    public UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n        List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n        User user = template.getForObject(\"http://localhost:8101/user/\"+uid, User.class);\n        //\u83b7\u53d6\u6bcf\u4e00\u672c\u4e66\u7684\u8be6\u7ec6\u4fe1\u606f\n        List&lt;Book&gt; bookList = borrow\n                .stream()\n                .map(b -&gt; template.getForObject(\"http://localhost:8201/book/\"+b.getBid(), Book.class))\n                .collect(Collectors.toList());\n        return new UserBorrowDetail(user, bookList);\n    }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u670d\u52a1\u6210\u529f\u8c03\u7528\u4e86\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u6765\u5c06Nacos\u52a0\u5165\uff0c\u5e76\u901a\u8fc7Feign\u5b9e\u73b0\u8fdc\u7a0b\u8c03\u7528\u3002</p> <p>\u4f9d\u8d56\u8fd8\u662f\u8d34\u4e00\u4e0b\uff0c\u4e0d\u7136\u627e\u4e0d\u5230\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;\n    &lt;version&gt;2021.0.1.0&lt;/version&gt;\n    &lt;type&gt;pom&lt;/type&gt;\n    &lt;scope&gt;import&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-loadbalancer&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u6240\u6709\u670d\u52a1\u90fd\u5df2\u7ecf\u6ce8\u518c\u6210\u529f\u4e86\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u914d\u7f6e\u4e00\u4e0b\u501f\u9605\u670d\u52a1\u7684\u8d1f\u8f7d\u5747\u8861\uff1a</p> <pre><code>@Configuration\npublic class WebConfiguration {\n\n    @Resource\n    OAuth2ClientContext context;\n\n    @LoadBalanced   //\u548cRestTemplate\u4e00\u6837\u76f4\u63a5\u6dfb\u52a0\u6ce8\u89e3\u5c31\u884c\u4e86\n    @Bean\n    public OAuth2RestTemplate restTemplate(){\n        return new OAuth2RestTemplate(new ClientCredentialsResourceDetails(), context);\n    }\n}\n</code></pre> <p></p> <p>\u73b0\u5728\u6211\u4eec\u6765\u628a\u5b83\u66ff\u6362\u4e3aFeign\uff0c\u8001\u6837\u5b50\uff0c\u4e24\u4e2a\u5ba2\u6237\u7aef\uff1a</p> <pre><code>@FeignClient(\"user-service\")\npublic interface UserClient {\n\n    @RequestMapping(\"/user/{uid}\")\n    User getUserById(@PathVariable(\"uid\") int uid);\n}\n</code></pre> <pre><code>@FeignClient(\"book-service\")\npublic interface BookClient {\n\n    @RequestMapping(\"/book/{bid}\")\n    Book getBookById(@PathVariable(\"bid\") int bid);\n}\n</code></pre> <p>\u4f46\u662f\u914d\u7f6e\u5b8c\u6210\u4e4b\u540e\uff0c\u53c8\u51fa\u73b0\u521a\u521a\u7684\u95ee\u9898\u4e86\uff0cOpenFeign\u4e5f\u6ca1\u6709\u643a\u5e26Token\u8fdb\u884c\u8bbf\u95ee\uff1a</p> <p></p> <p>\u90a3\u4e48\u600e\u4e48\u914d\u7f6eFeign\u643a\u5e26Token\u8bbf\u95ee\u5462\uff1f\u9047\u5230\u8fd9\u79cd\u95ee\u9898\u76f4\u63a5\u53bb\u5b98\u65b9\u67e5\uff1ahttps://docs.spring.io/spring-cloud-openfeign/docs/current/reference/html/#oauth2-support\uff0c\u975e\u5e38\u7b80\u5355\uff0c\u4e24\u4e2a\u914d\u7f6e\u5c31\u641e\u5b9a\uff1a</p> <pre><code>feign:\n  oauth2:\n    #\u5f00\u542fOauth\u652f\u6301\uff0c\u8fd9\u6837\u5c31\u4f1a\u5728\u8bf7\u6c42\u5934\u4e2d\u643a\u5e26Token\u4e86\n    enabled: true\n    #\u540c\u65f6\u5f00\u542f\u8d1f\u8f7d\u5747\u8861\u652f\u6301\n    load-balanced: true\n</code></pre> <p>\u91cd\u542f\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u7ed3\u679cOK\u4e86\uff1a</p> <p></p> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u6210\u529f\u5c06\u4e4b\u524d\u7684\u4e09\u4e2a\u670d\u52a1\u4f5c\u4e3a\u8d44\u6e90\u670d\u52a1\u5668\u4e86\uff0c\u6ce8\u610f\u548c\u6211\u4eec\u4e0a\u9762\u7684\u4f5c\u4e3a\u5ba2\u6237\u7aef\u662f\u4e0d\u540c\u7684\uff0c\u5c06\u670d\u52a1\u76f4\u63a5\u4f5c\u4e3a\u5ba2\u6237\u7aef\u76f8\u5f53\u4e8e\u53ea\u9700\u8981\u9a8c\u8bc1\u901a\u8fc7\u5373\u53ef\uff0c\u5e76\u4e14\u8fd8\u662f\u8981\u4fdd\u5b58Session\u4fe1\u606f\uff0c\u76f8\u5f53\u4e8e\u53ea\u662f\u5c06\u767b\u5f55\u6d41\u7a0b\u6362\u5230\u7edf\u4e00\u7684\u9a8c\u8bc1\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u7f62\u4e86\u3002\u800c\u5c06\u5176\u4f5c\u4e3a\u8d44\u6e90\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u53e6\u5916\u627e\u5ba2\u6237\u7aef\uff08\u53ef\u4ee5\u662f\u6d4f\u89c8\u5668\u3001\u5c0f\u7a0b\u5e8f\u3001App\u3001\u7b2c\u4e09\u65b9\u670d\u52a1\u7b49\uff09\u6765\u8bbf\u95ee\uff0c\u5e76\u4e14\u4e5f\u662f\u9700\u8981\u5148\u8fdb\u884c\u9a8c\u8bc1\u7136\u540e\u518d\u901a\u8fc7\u643a\u5e26Token\u8fdb\u884c\u8bbf\u95ee\uff0c\u8fd9\u79cd\u6a21\u5f0f\u662f\u6211\u4eec\u6bd4\u8f83\u5e38\u89c1\u7684\u6a21\u5f0f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#jwttoken","title":"\u4f7f\u7528jwt\u5b58\u50a8Token","text":"<p>\u5b98\u7f51\uff1ahttps://jwt.io</p> <p>JSON Web Token\u4ee4\u724c\uff08JWT\uff09\u662f\u4e00\u4e2a\u5f00\u653e\u6807\u51c6\uff08RFC 7519\uff09\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u79cd\u7d27\u51d1\u548c\u81ea\u6210\u4e00\u4f53\u7684\u65b9\u5f0f\uff0c\u7528\u4e8e\u5728\u5404\u65b9\u4e4b\u95f4\u4f5c\u4e3aJSON\u5bf9\u8c61\u5b89\u5168\u5730\u4f20\u8f93\u4fe1\u606f\u3002\u8fd9\u4e9b\u4fe1\u606f\u53ef\u4ee5\u88ab\u9a8c\u8bc1\u548c\u4fe1\u4efb\uff0c\u56e0\u4e3a\u5b83\u662f\u6570\u5b57\u7b7e\u540d\u7684\u3002JWT\u53ef\u4ee5\u4f7f\u7528\u5bc6\u94a5\uff08\u4f7f\u7528HMAC\u7b97\u6cd5\uff09\u6216\u4f7f\u7528RSA\u6216ECDSA\u8fdb\u884c\u516c\u94a5/\u79c1\u94a5\u5bf9\u8fdb\u884c\u7b7e\u540d\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u4e4b\u524d\u90fd\u662f\u643a\u5e26Token\u5411\u8d44\u6e90\u670d\u52a1\u5668\u53d1\u8d77\u8bf7\u6c42\u540e\uff0c\u8d44\u6e90\u670d\u52a1\u5668\u7531\u4e8e\u4e0d\u77e5\u9053\u6211\u4eecToken\u7684\u7528\u6237\u4fe1\u606f\uff0c\u6240\u4ee5\u9700\u8981\u5411\u9a8c\u8bc1\u670d\u52a1\u5668\u8be2\u95ee\u6b64Token\u7684\u8ba4\u8bc1\u4fe1\u606f\uff0c\u8fd9\u6837\u624d\u80fd\u5f97\u5230Token\u4ee3\u8868\u7684\u7528\u6237\u4fe1\u606f\uff0c\u4f46\u662f\u5404\u4f4d\u662f\u5426\u8003\u8651\u8fc7\uff0c\u5982\u679c\u6bcf\u6b21\u7528\u6237\u8bf7\u6c42\u90fd\u53bb\u67e5\u8be2\u7528\u6237\u4fe1\u606f\uff0c\u90a3\u4e48\u5728\u5927\u91cf\u8bf7\u6c42\u4e0b\uff0c\u9a8c\u8bc1\u670d\u52a1\u5668\u7684\u538b\u529b\u53ef\u80fd\u4f1a\u975e\u5e38\u7684\u5927\u3002\u800c\u4f7f\u7528JWT\u4e4b\u540e\uff0cToken\u4e2d\u4f1a\u76f4\u63a5\u4fdd\u5b58\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u6837\u8d44\u6e90\u670d\u52a1\u5668\u5c31\u4e0d\u518d\u9700\u8981\u8be2\u95ee\u9a8c\u8bc1\u670d\u52a1\u5668\uff0c\u81ea\u884c\u5c31\u53ef\u4ee5\u5b8c\u6210\u89e3\u6790\uff0c\u6211\u4eec\u7684\u76ee\u6807\u662f\u4e0d\u8054\u7cfb\u9a8c\u8bc1\u670d\u52a1\u5668\u5c31\u80fd\u76f4\u63a5\u5b8c\u6210\u9a8c\u8bc1\u3002</p> <p>JWT\u4ee4\u724c\u7684\u683c\u5f0f\u5982\u4e0b\uff1a</p> <p></p> <p>\u4e00\u4e2aJWT\u4ee4\u724c\u75313\u90e8\u5206\u7ec4\u6210\uff1a\u6807\u5934(Header)\u3001\u6709\u6548\u8f7d\u8377(Payload)\u548c\u7b7e\u540d(Signature)\u3002\u5728\u4f20\u8f93\u7684\u65f6\u5019\uff0c\u4f1a\u5c06JWT\u76843\u90e8\u5206\u5206\u522b\u8fdb\u884cBase64\u7f16\u7801\u540e\u7528<code>.</code>\u8fdb\u884c\u8fde\u63a5\u5f62\u6210\u6700\u7ec8\u9700\u8981\u4f20\u8f93\u7684\u5b57\u7b26\u4e32\u3002</p> <ul> <li>\u6807\u5934\uff1a\u5305\u542b\u4e00\u4e9b\u5143\u6570\u636e\u4fe1\u606f\uff0c\u6bd4\u5982JWT\u7b7e\u540d\u6240\u4f7f\u7528\u7684\u52a0\u5bc6\u7b97\u6cd5\uff0c\u8fd8\u6709\u7c7b\u578b\uff0c\u8fd9\u91cc\u7edf\u4e00\u90fd\u662fJWT\u3002</li> <li>\u6709\u6548\u8f7d\u8377\uff1a\u5305\u62ec\u7528\u6237\u540d\u79f0\u3001\u4ee4\u724c\u53d1\u5e03\u65f6\u95f4\u3001\u8fc7\u671f\u65f6\u95f4\u3001JWT ID\u7b49\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u6dfb\u52a0\u5b57\u6bb5\uff0c\u6211\u4eec\u7684\u7528\u6237\u4fe1\u606f\u4e00\u822c\u90fd\u5728\u8fd9\u91cc\u5b58\u653e\u3002</li> <li>\u7b7e\u540d\uff1a\u9996\u5148\u9700\u8981\u6307\u5b9a\u4e00\u4e2a\u5bc6\u94a5\uff0c\u8be5\u5bc6\u94a5\u4ec5\u4ec5\u4fdd\u5b58\u5728\u670d\u52a1\u5668\u4e2d\uff0c\u4fdd\u8bc1\u4e0d\u80fd\u8ba9\u5176\u4ed6\u7528\u6237\u77e5\u9053\u3002\u7136\u540e\u4f7f\u7528Header\u4e2d\u6307\u5b9a\u7684\u7b97\u6cd5\u5bf9Header\u548cPayload\u8fdb\u884cbase64\u52a0\u5bc6\u4e4b\u540e\u7684\u7ed3\u679c\u901a\u8fc7\u5bc6\u94a5\u8ba1\u7b97\u54c8\u5e0c\u503c\uff0c\u7136\u540e\u5c31\u5f97\u51fa\u4e00\u4e2a\u7b7e\u540d\u54c8\u5e0c\u3002\u8fd9\u4e2a\u4f1a\u7528\u4e8e\u4e4b\u540e\u9a8c\u8bc1\u5185\u5bb9\u662f\u5426\u88ab\u7be1\u6539\u3002</li> </ul> <p>\u8fd9\u91cc\u8fd8\u662f\u8865\u5145\u4e00\u4e0b\u4e00\u4e9b\u6982\u5ff5\uff0c\u56e0\u4e3a\u5f88\u591a\u4e1c\u897f\u90fd\u662f\u6211\u4eec\u4e4b\u524d\u6ca1\u6709\u63a5\u89e6\u8fc7\u7684\uff1a</p> <ul> <li>Base64\uff1a\u5c31\u662f\u5305\u62ec\u5c0f\u5199\u5b57\u6bcda-z\u3001\u5927\u5199\u5b57\u6bcdA-Z\u3001\u6570\u5b570-9\u3001\u7b26\u53f7\"+\"\u3001\"/\"\u4e00\u517164\u4e2a\u5b57\u7b26\u7684\u5b57\u7b26\u96c6\uff08\u672b\u5c3e\u8fd8\u67091\u4e2a\u6216\u591a\u4e2a<code>=</code>\u7528\u6765\u51d1\u591f\u5b57\u8282\u6570\uff09\uff0c\u4efb\u4f55\u7684\u7b26\u53f7\u90fd\u53ef\u4ee5\u8f6c\u6362\u6210\u8fd9\u4e2a\u5b57\u7b26\u96c6\u4e2d\u7684\u5b57\u7b26\uff0c\u8fd9\u4e2a\u8f6c\u6362\u8fc7\u7a0b\u5c31\u53eb\u505aBase64\u7f16\u7801\uff0c\u7f16\u7801\u4e4b\u540e\u4f1a\u751f\u6210\u53ea\u5305\u542b\u4e0a\u8ff064\u4e2a\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u3002\u76f8\u53cd\uff0c\u5982\u679c\u9700\u8981\u539f\u672c\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u8fdb\u884cBase64\u89e3\u7801\uff0c\u56de\u5230\u539f\u6709\u7684\u6837\u5b50\u3002</li> </ul> <pre><code>public void test(){\n    String str = \"\u4f60\u4eec\u53ef\u80fd\u4e0d\u77e5\u9053\u53ea\u752820\u4e07\u8d62\u5230578\u4e07\u662f\u4ec0\u4e48\u6982\u5ff5\";\n      //Base64\u4e0d\u53ea\u662f\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u8fdb\u884c\u7f16\u7801\uff0c\u4efb\u4f55byte[]\u6570\u636e\u90fd\u53ef\u4ee5\uff0c\u7f16\u7801\u7ed3\u679c\u53ef\u4ee5\u662fbyte[]\uff0c\u4e5f\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\n    String encodeStr = Base64.getEncoder().encodeToString(str.getBytes());\n    System.out.println(\"Base64\u7f16\u7801\u540e\u7684\u5b57\u7b26\u4e32\uff1a\"+encodeStr);\n\n    System.out.println(\"\u89e3\u7801\u540e\u7684\u5b57\u7b26\u4e32\uff1a\"+new String(Base64.getDecoder().decode(encodeStr)));\n}\n</code></pre> <p>\u6ce8\u610fBase64\u4e0d\u662f\u52a0\u5bc6\u7b97\u6cd5\uff0c\u53ea\u662f\u4e00\u79cd\u4fe1\u606f\u7684\u7f16\u7801\u65b9\u5f0f\u800c\u5df2\u3002</p> <ul> <li>\u52a0\u5bc6\u7b97\u6cd5\uff1a\u52a0\u5bc6\u7b97\u6cd5\u5206\u4e3a\u5bf9\u79f0\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u52a0\u5bc6\uff0c\u5176\u4e2d\u5bf9\u79f0\u52a0\u5bc6\uff08Symmetric Cryptography\uff09\u6bd4\u8f83\u597d\u7406\u89e3\uff0c\u5c31\u50cf\u4e00\u628a\u9501\u914d\u4e86\u4e24\u628a\u94a5\u5319\u4e00\u6837\uff0c\u8fd9\u4e24\u628a\u94a5\u5319\u4f60\u548c\u522b\u4eba\u90fd\u6709\u4e00\u628a\uff0c\u7136\u540e\u4f60\u4eec\u76f4\u63a5\u4f20\u9012\u6570\u636e\uff0c\u90fd\u4f1a\u628a\u6570\u636e\u7528\u9501\u7ed9\u9501\u4e0a\uff0c\u5c31\u7b97\u4f20\u9012\u7684\u9014\u4e2d\u6709\u4eba\u628a\u6570\u636e\u7a83\u53d6\u4e86\uff0c\u4e5f\u6ca1\u529e\u6cd5\u89e3\u5bc6\uff0c\u56e0\u4e3a\u94a5\u5319\u53ea\u6709\u4f60\u548c\u5bf9\u65b9\u6709\uff0c\u6ca1\u6709\u94a5\u5319\u65e0\u6cd5\u8fdb\u884c\u89e3\u5bc6\uff0c\u4f46\u662f\u8fd9\u6837\u6709\u4e2a\u95ee\u9898\uff0c\u65e2\u7136\u89e3\u5bc6\u7684\u5173\u952e\u5728\u4e8e\u94a5\u5319\u672c\u8eab\uff0c\u90a3\u4e48\u5982\u679c\u6709\u4eba\u4e0d\u4ec5\u7a83\u53d6\u4e86\u6570\u636e\uff0c\u800c\u4e14\u5bf9\u65b9\u90a3\u8fb9\u7684\u6cbb\u5b89\u4e5f\u4e0d\u597d\uff0c\u4e8e\u662f\u987a\u624b\u5c31\u5077\u8d70\u4e86\u94a5\u5319\uff0c\u90a3\u4f60\u4eec\u4e4b\u95f4\u53d1\u7684\u6570\u636e\u4e0d\u5c31\u51c9\u51c9\u4e86\u5417\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u975e\u5bf9\u79f0\u52a0\u5bc6\uff08Asymmetric Cryptography\uff09\u7b97\u6cd5\u51fa\u73b0\u4e86\uff0c\u5b83\u5e76\u4e0d\u662f\u76f4\u63a5\u751f\u6210\u4e00\u628a\u94a5\u5319\uff0c\u800c\u662f\u751f\u6210\u4e00\u4e2a\u516c\u94a5\u548c\u4e00\u4e2a\u79c1\u94a5\uff0c\u79c1\u94a5\u53ea\u80fd\u7531\u4f60\u4fdd\u7ba1\uff0c\u800c\u516c\u94a5\u4ea4\u7ed9\u5bf9\u65b9\u6216\u662f\u4f60\u8981\u53d1\u9001\u7684\u4efb\u4f55\u4eba\u90fd\u884c\uff0c\u73b0\u5728\u4f60\u9700\u8981\u628a\u6570\u636e\u4f20\u7ed9\u5bf9\u65b9\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4f7f\u7528\u79c1\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u4f46\u662f\uff0c\u8fd9\u4e2a\u6570\u636e\u53ea\u80fd\u4f7f\u7528\u5bf9\u5e94\u7684\u516c\u94a5\u8fdb\u884c\u89e3\u5bc6\uff0c\u76f8\u53cd\uff0c\u5982\u679c\u5bf9\u65b9\u9700\u8981\u7ed9\u4f60\u53d1\u9001\u6570\u636e\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u7528\u516c\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u800c\u6570\u636e\u53ea\u80fd\u4f7f\u7528\u79c1\u94a5\u8fdb\u884c\u89e3\u5bc6\uff0c\u8fd9\u6837\u7684\u8bdd\u5c31\u7b97\u5bf9\u65b9\u7684\u516c\u94a5\u88ab\u7a83\u53d6\uff0c\u90a3\u4e48\u522b\u4eba\u53d1\u7ed9\u4f60\u7684\u6570\u636e\u4e5f\u6ca1\u529e\u6cd5\u89e3\u5bc6\u51fa\u6765\uff0c\u56e0\u4e3a\u9700\u8981\u79c1\u94a5\u624d\u80fd\u89e3\u5bc6\uff0c\u800c\u53ea\u6709\u4f60\u624d\u6709\u79c1\u94a5\u3002</p> <p>\u56e0\u6b64\uff0c\u975e\u5bf9\u79f0\u52a0\u5bc6\u7684\u5b89\u5168\u6027\u4f1a\u66f4\u9ad8\u4e00\u4e9b\uff0c\u5305\u62ecHTTPS\u7684\u9690\u79c1\u4fe1\u606f\u6b63\u662f\u4f7f\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u6765\u4fdd\u969c\u4f20\u8f93\u6570\u636e\u7684\u5b89\u5168\uff08\u5f53\u7136HTTPS\u5e76\u4e0d\u662f\u5355\u7eaf\u5730\u4f7f\u7528\u975e\u5bf9\u79f0\u52a0\u5bc6\u5b8c\u6210\u7684\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u53bb\u4e86\u89e3\u4e00\u4e0b\uff09</p> <p>\u5bf9\u79f0\u52a0\u5bc6\u548c\u975e\u5bf9\u79f0\u52a0\u5bc6\u90fd\u6709\u5f88\u591a\u7684\u7b97\u6cd5\uff0c\u6bd4\u5982\u5bf9\u79f0\u52a0\u5bc6\uff0c\u5c31\u6709\uff1aDES\u3001IDEA\u3001RC2\uff0c\u975e\u5bf9\u79f0\u52a0\u5bc6\u6709\uff1aRSA\u3001DAS\u3001ECC</p> <ul> <li>\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\uff1a\u5e38\u89c1\u7684\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u6709MD5, HMAC, SHA-1, SHA-224, SHA-256, SHA-384, \u548cSHA-512, \u5176\u4e2dSHA-224\u3001SHA-256\u3001SHA-384\uff0c\u548cSHA-512\u6211\u4eec\u53ef\u4ee5\u7edf\u79f0\u4e3aSHA2\u52a0\u5bc6\u7b97\u6cd5\uff0cSHA\u52a0\u5bc6\u7b97\u6cd5\u7684\u5b89\u5168\u6027\u8981\u6bd4MD5\u66f4\u9ad8\uff0c\u800cSHA2\u52a0\u5bc6\u7b97\u6cd5\u6bd4SHA1\u7684\u8981\u9ad8\uff0c\u5176\u4e2dSHA\u540e\u9762\u7684\u6570\u5b57\u8868\u793a\u7684\u662f\u52a0\u5bc6\u540e\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\uff0cSHA1\u9ed8\u8ba4\u4f1a\u4ea7\u751f\u4e00\u4e2a160\u4f4d\u7684\u4fe1\u606f\u6458\u8981\u3002\u7ecf\u8fc7\u4e0d\u53ef\u9006\u52a0\u5bc6\u7b97\u6cd5\u5f97\u5230\u7684\u52a0\u5bc6\u7ed3\u679c\uff0c\u662f\u65e0\u6cd5\u89e3\u5bc6\u56de\u53bb\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u52a0\u5bc6\u51fa\u6765\u662f\u4ec0\u4e48\u5c31\u662f\u4ec0\u4e48\u4e86\u3002\u672c\u8d28\u4e0a\uff0c\u5176\u5c31\u662f\u4e00\u79cd\u54c8\u5e0c\u51fd\u6570\uff0c\u7528\u4e8e\u5bf9\u4e00\u6bb5\u4fe1\u606f\u4ea7\u751f\u6458\u8981\uff0c\u4ee5\u9632\u6b62\u88ab\u7be1\u6539\u3002</li> </ul> <p>\u5b9e\u9645\u4e0a\u8fd9\u79cd\u7b97\u6cd5\u5c31\u5e38\u5e38\u88ab\u7528\u4f5c\u4fe1\u606f\u6458\u8981\u8ba1\u7b97\uff0c\u540c\u6837\u7684\u6570\u636e\u901a\u8fc7\u540c\u6837\u7684\u7b97\u6cd5\u8ba1\u7b97\u5f97\u5230\u7684\u7ed3\u679c\u80af\u5b9a\u4e5f\u4e00\u6837\uff0c\u800c\u5982\u679c\u6570\u636e\u88ab\u4fee\u6539\uff0c\u90a3\u4e48\u8ba1\u7b97\u7684\u7ed3\u679c\u80af\u5b9a\u5c31\u4e0d\u4e00\u6837\u4e86\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528jwt\uff0c\u5c06\u6211\u4eec\u7684Token\u91c7\u7528\u65b0\u7684\u65b9\u5f0f\u8fdb\u884c\u5b58\u50a8\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u6700\u7b80\u5355\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5bf9\u79f0\u5bc6\u94a5\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u9a8c\u8bc1\u670d\u52a1\u5668\u8fdb\u884c\u4e00\u4e9b\u4fee\u6539\uff1a</p> <pre><code>@Bean\npublic JwtAccessTokenConverter tokenConverter(){  //Token\u8f6c\u6362\u5668\uff0c\u5c06\u5176\u8f6c\u6362\u4e3aJWT\n    JwtAccessTokenConverter converter = new JwtAccessTokenConverter();\n    converter.setSigningKey(\"lbwnb\");   //\u8fd9\u4e2a\u662f\u5bf9\u79f0\u5bc6\u94a5\uff0c\u4e00\u4f1a\u8d44\u6e90\u670d\u52a1\u5668\u90a3\u8fb9\u4e5f\u8981\u6307\u5b9a\u4e3a\u8fd9\u4e2a\n    return converter;\n}\n\n@Bean\npublic TokenStore tokenStore(JwtAccessTokenConverter converter){  //Token\u5b58\u50a8\u65b9\u5f0f\u73b0\u5728\u6539\u4e3aJWT\u5b58\u50a8\n    return new JwtTokenStore(converter);  //\u4f20\u5165\u521a\u521a\u5b9a\u4e49\u597d\u7684\u8f6c\u6362\u5668\n}\n</code></pre> <pre><code>@Resource\nTokenStore store;\n\n@Resource\nJwtAccessTokenConverter converter;\n\nprivate AuthorizationServerTokenServices serverTokenServices(){  //\u8fd9\u91cc\u5bf9AuthorizationServerTokenServices\u8fdb\u884c\u4e00\u4e0b\u914d\u7f6e\n    DefaultTokenServices services = new DefaultTokenServices();\n    services.setSupportRefreshToken(true);   //\u5141\u8bb8Token\u5237\u65b0\n    services.setTokenStore(store);   //\u6dfb\u52a0\u521a\u521a\u7684TokenStore\n    services.setTokenEnhancer(converter);   //\u6dfb\u52a0Token\u589e\u5f3a\uff0c\u5176\u5b9e\u5c31\u662fJwtAccessTokenConverter\uff0c\u589e\u5f3a\u662f\u6dfb\u52a0\u4e00\u4e9b\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u5230JWT\u4e2d\n    return services;\n}\n\n@Override\npublic void configure(AuthorizationServerEndpointsConfigurer endpoints) {\n    endpoints\n            .tokenServices(serverTokenServices())   //\u8bbe\u5b9a\u4e3a\u521a\u521a\u914d\u7f6e\u597d\u7684AuthorizationServerTokenServices\n            .userDetailsService(service)\n            .authenticationManager(manager);\n}\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u91cd\u542f\u9a8c\u8bc1\u670d\u52a1\u5668\u4e86\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6210\u529f\u83b7\u53d6\u4e86AccessToken\uff0c\u4f46\u662f\u8fd9\u91cc\u7684\u683c\u5f0f\u8ddf\u6211\u4eec\u4e4b\u524d\u7684\u683c\u5f0f\u5c31\u5927\u4e0d\u76f8\u540c\u4e86\uff0c\u56e0\u4e3a\u73b0\u5728\u5b83\u662fJWT\u4ee4\u724c\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u4e00\u4e0bBase64\u89e3\u7801\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684\u9a8c\u8bc1\u4fe1\u606f\u5305\u542b\u5728\u5185\uff0c\u73b0\u5728\u6211\u4eec\u5bf9\u8d44\u6e90\u670d\u52a1\u5668\u8fdb\u884c\u914d\u7f6e\uff1a</p> <pre><code>security:\n  oauth2:\n    resource:\n      jwt:\n        key-value: lbwnb #\u6ce8\u610f\u8fd9\u91cc\u8981\u8ddf\u9a8c\u8bc1\u670d\u52a1\u5668\u7684\u5bc6\u94a5\u4e00\u81f4\uff0c\u8fd9\u6837\u7b97\u51fa\u6765\u7684\u7b7e\u540d\u624d\u4f1a\u4e00\u81f4\n</code></pre> <p>\u7136\u540e\u542f\u52a8\u8d44\u6e90\u670d\u52a1\u5668\uff0c\u8bf7\u6c42\u4e00\u4e0b\u63a5\u53e3\u8bd5\u8bd5\u770b\uff1a</p> <p></p> <p>\u8bf7\u6c42\u6210\u529f\uff0c\u5f97\u5230\u6570\u636e\uff1a</p> <p></p> <p>\u6ce8\u610f\u5982\u679cToken\u6709\u8bef\uff0c\u90a3\u4e48\u4f1a\u5f97\u5230\uff1a</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#redis","title":"Redis\u4e0e\u5206\u5e03\u5f0f","text":"<p>\u5728SpringBoot\u9636\u6bb5\uff0c\u6211\u4eec\u5b66\u4e60\u4e86Redis\uff0c\u5b83\u662f\u4e00\u4e2a\u57fa\u4e8e\u5185\u5b58\u7684\u9ad8\u6027\u80fd\u6570\u636e\u5e93\uff0c\u6211\u4eec\u5f53\u65f6\u5df2\u7ecf\u5b66\u4e60\u4e86\u5305\u62ec\u57fa\u672c\u64cd\u4f5c\u3001\u5e38\u7528\u6570\u636e\u7c7b\u578b\u3001\u6301\u4e45\u5316\u3001\u4e8b\u52a1\u548c\u9501\u673a\u5236\u4ee5\u53ca\u4f7f\u7528Java\u4e0eRedis\u8fdb\u884c\u4ea4\u4e92\u7b49\uff0c\u5229\u7528\u5b83\u7684\u9ad8\u6027\u80fd\uff0c\u6211\u4eec\u8fd8\u4f7f\u7528\u5b83\u6765\u505aMybatis\u7684\u4e8c\u7ea7\u7f13\u5b58\u3001\u4ee5\u53caToken\u7684\u6301\u4e45\u5316\u5b58\u50a8\u3002\u800c\u8fd9\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5c06\u7ee7\u7eed\u6df1\u5165\uff0c\u63a2\u8ba8Redis\u5728\u5206\u5e03\u5f0f\u5f00\u53d1\u573a\u666f\u4e0b\u7684\u5e94\u7528\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_5","title":"\u4e3b\u4ece\u590d\u5236","text":"<p>\u5728\u5206\u5e03\u5f0f\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8ba9Redis\u5b9e\u73b0\u4e3b\u4ece\u6a21\u5f0f\uff1a</p> <p></p> <p>\u4e3b\u4ece\u590d\u5236\uff0c\u662f\u6307\u5c06\u4e00\u53f0Redis\u670d\u52a1\u5668\u7684\u6570\u636e\uff0c\u590d\u5236\u5230\u5176\u4ed6\u7684Redis\u670d\u52a1\u5668\u3002\u524d\u8005\u79f0\u4e3a\u4e3b\u8282\u70b9(Master)\uff0c\u540e\u8005\u79f0\u4e3a\u4ece\u8282\u70b9(Slave)\uff0c\u6570\u636e\u7684\u590d\u5236\u662f\u5355\u5411\u7684\uff0c\u53ea\u80fd\u7531\u4e3b\u8282\u70b9\u5230\u4ece\u8282\u70b9\u3002Master\u4ee5\u5199\u4e3a\u4e3b\uff0cSlave \u4ee5\u8bfb\u4e3a\u4e3b\u3002</p> <p>\u8fd9\u6837\u7684\u597d\u5904\u80af\u5b9a\u662f\u663e\u800c\u6613\u89c1\u7684\uff1a</p> <ul> <li>\u5b9e\u73b0\u4e86\u8bfb\u5199\u5206\u79bb\uff0c\u63d0\u9ad8\u4e86\u6027\u80fd\u3002</li> <li>\u5728\u5199\u5c11\u8bfb\u591a\u7684\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u751a\u81f3\u53ef\u4ee5\u5b89\u6392\u5f88\u591a\u4e2a\u4ece\u8282\u70b9\uff0c\u8fd9\u6837\u5c31\u80fd\u591f\u5927\u5e45\u5ea6\u7684\u5206\u62c5\u538b\u529b\uff0c\u5e76\u4e14\u5c31\u7b97\u6302\u6389\u4e00\u4e2a\uff0c\u5176\u4ed6\u7684\u4e5f\u80fd\u4f7f\u7528\u3002</li> </ul> <p>\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u5c31\u6765\u5c1d\u8bd5\u5b9e\u73b0\u4e00\u4e0b\uff0c\u8fd9\u91cc\u6211\u4eec\u8fd8\u662f\u5728Windows\u4e0b\u8fdb\u884c\u6d4b\u8bd5\uff0c\u6253\u5f00Redis\u6587\u4ef6\u5939\uff0c\u6211\u4eec\u8981\u5f00\u542f\u4e24\u4e2aRedis\u670d\u52a1\u5668\uff0c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6<code>redis.windows.conf</code>\uff1a</p> <pre><code># Accept connections on the specified port, default is 6379 (IANA #815344).\n# If port 0 is specified Redis will not listen on a TCP socket.\nport 6001\n</code></pre> <p>\u4e00\u4e2a\u670d\u52a1\u5668\u7684\u7aef\u53e3\u8bbe\u5b9a\u4e3a6001\uff0c\u590d\u5236\u4e00\u4efd\uff0c\u53e6\u4e00\u4e2a\u7684\u7aef\u53e3\u4e3a6002\uff0c\u63a5\u7740\u6211\u4eec\u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u542f\u52a8\uff0c\u6253\u5f00cmd\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u7684\u4e24\u4e2a\u670d\u52a1\u5668\u5c31\u542f\u52a8\u6210\u529f\u4e86\uff0c\u63a5\u7740\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u67e5\u770b\u5f53\u524d\u670d\u52a1\u5668\u7684\u4e3b\u4ece\u72b6\u6001\uff0c\u6211\u4eec\u6253\u5f00\u5ba2\u6237\u7aef\uff1a</p> <p></p> <p>\u8f93\u5165<code>info replication</code>\u547d\u4ee4\u6765\u67e5\u770b\u5f53\u524d\u7684\u4e3b\u4ece\u72b6\u6001\uff0c\u53ef\u4ee5\u770b\u5230\u9ed8\u8ba4\u7684\u89d2\u8272\u4e3a\uff1amaster\uff0c\u4e5f\u5c31\u662f\u8bf4\u6240\u6709\u7684\u670d\u52a1\u5668\u5728\u542f\u52a8\u4e4b\u540e\u90fd\u662f\u4e3b\u8282\u70b9\u7684\u72b6\u6001\u3002\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u8ba96002\u4f5c\u4e3a\u4ece\u8282\u70b9\uff0c\u901a\u8fc7\u4e00\u4e2a\u547d\u4ee4\u5373\u53ef\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u8f93\u5165<code>replicaof 127.0.0.1 6001</code>\u547d\u4ee4\u540e\uff0c\u5c31\u4f1a\u5c066001\u670d\u52a1\u5668\u4f5c\u4e3a\u4e3b\u8282\u70b9\uff0c\u800c\u5f53\u524d\u8282\u70b9\u4f5c\u4e3a6001\u7684\u4ece\u8282\u70b9\uff0c\u5e76\u4e14\u89d2\u8272\u4e5f\u4f1a\u53d8\u6210\uff1aslave\uff0c\u63a5\u7740\u6211\u4eec\u6765\u770b\u770b6001\u7684\u60c5\u51b5\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u4ece\u8282\u70b9\u4fe1\u606f\u4e2d\u5df2\u7ecf\u51fa\u73b0\u4e866002\u670d\u52a1\u5668\uff0c\u4e5f\u5c31\u662f\u8bf4\u73b0\u5728\u6211\u4eec\u76846001\u548c6002\u5c31\u5f62\u6210\u4e86\u4e3b\u4ece\u5173\u7cfb\uff08\u8fd8\u5305\u542b\u4e00\u4e2a\u504f\u79fb\u91cf\uff0c\u8fd9\u4e2a\u504f\u79fb\u91cf\u53cd\u5e94\u7684\u662f\u4ece\u8282\u70b9\u7684\u540c\u6b65\u60c5\u51b5\uff09</p> <p>\u4e3b\u670d\u52a1\u5668\u548c\u4ece\u670d\u52a1\u5668\u90fd\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u590d\u5236\u504f\u79fb\u91cf\uff0c\u4e3b\u670d\u52a1\u5668\u6bcf\u6b21\u5411\u4ece\u670d\u52a1\u5668\u4e2d\u4f20\u9012 N \u4e2a\u5b57\u8282\u7684\u65f6\u5019\uff0c\u4f1a\u5c06\u81ea\u5df1\u7684\u590d\u5236\u504f\u79fb\u91cf\u52a0\u4e0a N\u3002\u4ece\u670d\u52a1\u5668\u4e2d\u6536\u5230\u4e3b\u670d\u52a1\u5668\u7684 N \u4e2a\u5b57\u8282\u7684\u6570\u636e\uff0c\u5c31\u4f1a\u5c06\u81ea\u5df1\u989d\u590d\u5236\u504f\u79fb\u91cf\u52a0\u4e0a N\uff0c\u901a\u8fc7\u4e3b\u4ece\u670d\u52a1\u5668\u7684\u504f\u79fb\u91cf\u5bf9\u6bd4\u53ef\u4ee5\u5f88\u6e05\u695a\u7684\u77e5\u9053\u4e3b\u4ece\u670d\u52a1\u5668\u7684\u6570\u636e\u662f\u5426\u5904\u4e8e\u4e00\u81f4\uff0c\u5982\u679c\u4e0d\u4e00\u81f4\u5c31\u9700\u8981\u8fdb\u884c\u589e\u91cf\u540c\u6b65\u4e86\u3002</p> <p>\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u5728\u4e3b\u8282\u70b9\u65b0\u589e\u6570\u636e\uff0c\u770b\u770b\u662f\u5426\u4f1a\u540c\u6b65\u5230\u4ece\u8282\u70b9\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6211\u4eec\u57286001\u670d\u52a1\u5668\u63d2\u5165\u7684<code>a</code>\uff0c\u53ef\u4ee5\u5728\u4ece\u8282\u70b96002\u8bfb\u53d6\u5230\uff0c\u90a3\u4e48\uff0c\u4ece\u8282\u70b9\u65b0\u589e\u7684\u6570\u636e\u5728\u4e3b\u8282\u70b9\u80fd\u5f97\u5230\u5417\uff1f\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u4ece\u8282\u70b9\u538b\u6839\u5c31\u6ca1\u529e\u6cd5\u8fdb\u884c\u6570\u636e\u63d2\u5165\uff0c\u8282\u70b9\u7684\u6a21\u5f0f\u4e3a\u53ea\u8bfb\u6a21\u5f0f\u3002\u90a3\u4e48\u5982\u679c\u6211\u4eec\u73b0\u5728\u4e0d\u60f3\u8ba96002\u4f5c\u4e3a6001\u7684\u4ece\u8282\u70b9\u4e86\u5462\uff1f</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u901a\u8fc7\u8f93\u5165<code>replicaof no one</code>\uff0c\u5373\u53ef\u53d8\u56deMaster\u89d2\u8272\u3002\u63a5\u7740\u6211\u4eec\u518d\u6765\u542f\u52a8\u4e00\u53f06003\u670d\u52a1\u5668\uff0c\u6d41\u7a0b\u662f\u4e00\u6837\u7684\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u8fde\u63a5\u4e4b\u540e\uff0c\u4e5f\u4f1a\u76f4\u63a5\u540c\u6b65\u4e3b\u8282\u70b9\u7684\u6570\u636e\uff0c\u56e0\u6b64\u65e0\u8bba\u662f\u5df2\u7ecf\u5904\u4e8e\u4ece\u8282\u70b9\u72b6\u6001\u8fd8\u662f\u521a\u521a\u542f\u52a8\u5b8c\u6210\u7684\u670d\u52a1\u5668\uff0c\u90fd\u4f1a\u4ece\u4e3b\u8282\u70b9\u540c\u6b65\u6570\u636e\uff0c\u5b9e\u9645\u4e0a\u6574\u4e2a\u540c\u6b65\u6d41\u7a0b\u4e3a\uff1a</p> <ol> <li>\u4ece\u8282\u70b9\u6267\u884creplicaof ip port\u547d\u4ee4\u540e\uff0c\u4ece\u8282\u70b9\u4f1a\u4fdd\u5b58\u4e3b\u8282\u70b9\u76f8\u5173\u7684\u5730\u5740\u4fe1\u606f\u3002</li> <li>\u4ece\u8282\u70b9\u901a\u8fc7\u6bcf\u79d2\u8fd0\u884c\u7684\u5b9a\u65f6\u4efb\u52a1\u53d1\u73b0\u914d\u7f6e\u4e86\u65b0\u7684\u4e3b\u8282\u70b9\u540e\uff0c\u4f1a\u5c1d\u8bd5\u4e0e\u8be5\u8282\u70b9\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5\uff0c\u4e13\u95e8\u7528\u4e8e\u63a5\u6536\u4e3b\u8282\u70b9\u53d1\u9001\u7684\u590d\u5236\u547d\u4ee4\u3002</li> <li>\u8fde\u63a5\u6210\u529f\u540e\uff0c\u7b2c\u4e00\u6b21\u4f1a\u5c06\u4e3b\u8282\u70b9\u7684\u6570\u636e\u8fdb\u884c\u5168\u91cf\u590d\u5236\uff0c\u4e4b\u540e\u91c7\u7528\u589e\u91cf\u590d\u5236\uff0c\u6301\u7eed\u5c06\u65b0\u6765\u7684\u5199\u547d\u4ee4\u540c\u6b65\u7ed9\u4ece\u8282\u70b9\u3002</li> </ol> <p>\u5f53\u6211\u4eec\u7684\u4e3b\u8282\u70b9\u5173\u95ed\u540e\uff0c\u4ece\u8282\u70b9\u4f9d\u7136\u53ef\u4ee5\u8bfb\u53d6\u6570\u636e\uff1a</p> <p></p> <p>\u4f46\u662f\u4ece\u8282\u70b9\u4f1a\u75af\u72c2\u62a5\u9519\uff1a</p> <p></p> <p>\u5f53\u7136\u6bcf\u6b21\u90fd\u53bb\u6572\u4e2a\u547d\u4ee4\u914d\u7f6e\u4e3b\u4ece\u592a\u9ebb\u70e6\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\uff0c\u6dfb\u52a0\u8fd9\u6837\u884c\u5373\u53ef\uff1a</p> <pre><code>replicaof 127.0.0.1 6001\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u7ed96002\u548c6003\u670d\u52a1\u5668\u90fd\u914d\u7f6e\u4e00\u4e0b\uff0c\u73b0\u5728\u6211\u4eec\u91cd\u542f\u4e09\u4e2a\u670d\u52a1\u5668\u3002</p> <p></p> <p>\u5f53\u7136\uff0c\u9664\u4e86\u4f5c\u4e3aMaster\u8282\u70b9\u7684\u4ece\u8282\u70b9\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u5176\u4f5c\u4e3a\u4ece\u8282\u70b9\u7684\u4ece\u8282\u70b9\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u8ba96003\u4f5c\u4e3a6002\u7684\u4ece\u8282\u70b9\uff1a</p> <p></p> <p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u73b0\u5728\u5dee\u4e0d\u591a\u662f\u8fd9\u6837\u7684\u7684\u4e00\u4e2a\u60c5\u51b5\uff1a</p> <p></p> <p>\u91c7\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u4f18\u70b9\u80af\u5b9a\u662f\u663e\u800c\u6613\u89c1\u7684\uff0c\u4f46\u662f\u7f3a\u70b9\u4e5f\u5f88\u660e\u663e\uff0c\u6574\u4e2a\u4f20\u64ad\u94fe\u8def\u4e00\u65e6\u4e2d\u9014\u51fa\u73b0\u95ee\u9898\uff0c\u90a3\u4e48\u5c31\u4f1a\u5bfc\u81f4\u540e\u9762\u7684\u4ece\u8282\u70b9\u65e0\u6cd5\u53ca\u65f6\u540c\u6b65\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_6","title":"\u54e8\u5175\u6a21\u5f0f","text":"<p>\u524d\u9762\u6211\u4eec\u8bb2\u89e3\u4e86Redis\u5b9e\u73b0\u4e3b\u4ece\u590d\u5236\u7684\u4e00\u4e9b\u57fa\u672c\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u63a5\u7740\u6765\u770b\u54e8\u5175\u6a21\u5f0f\u3002</p> <p>\u7ecf\u8fc7\u4e4b\u524d\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0a\u6700\u5173\u952e\u7684\u8fd8\u662f\u4e3b\u8282\u70b9\uff0c\u56e0\u4e3a\u4e00\u65e6\u4e3b\u8282\u70b9\u51fa\u73b0\u95ee\u9898\uff0c\u90a3\u4e48\u6574\u4e2a\u4e3b\u4ece\u7cfb\u7edf\u5c06\u65e0\u6cd5\u5199\u5165\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u5f97\u60f3\u4e00\u4e2a\u529e\u6cd5\uff0c\u5904\u7406\u4e00\u4e0b\u4e3b\u8282\u70b9\u6545\u969c\u7684\u60c5\u51b5\u3002\u5b9e\u9645\u4e0a\u6211\u4eec\u53ef\u4ee5\u53c2\u8003\u4e4b\u524d\u7684\u670d\u52a1\u6cbb\u7406\u6a21\u5f0f\uff0c\u6bd4\u5982Nacos\u548cEureka\uff0c\u6240\u6709\u7684\u670d\u52a1\u90fd\u4f1a\u88ab\u5b9e\u65f6\u76d1\u63a7\uff0c\u90a3\u4e48\u53ea\u8981\u51fa\u73b0\u95ee\u9898\uff0c\u80af\u5b9a\u662f\u53ef\u4ee5\u53ca\u65f6\u53d1\u73b0\u7684\uff0c\u5e76\u4e14\u80fd\u591f\u91c7\u53d6\u54cd\u5e94\u7684\u8865\u6551\u63aa\u65bd\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u5373\u5c06\u4ecb\u7ecd\u7684\u54e8\u5175\uff1a</p> <p></p> <p>\u6ce8\u610f\u8fd9\u91cc\u7684\u54e8\u5175\u4e0d\u662f\u6211\u4eec\u4e4b\u524d\u5b66\u4e60SpringCloud Alibaba\u7684\u90a3\u4e2a\uff0c\u662f\u4e13\u7528\u4e8eRedis\u7684\u3002\u54e8\u5175\u4f1a\u5bf9\u6240\u6709\u7684\u8282\u70b9\u8fdb\u884c\u76d1\u63a7\uff0c\u5982\u679c\u53d1\u73b0\u4e3b\u8282\u70b9\u51fa\u73b0\u95ee\u9898\uff0c\u90a3\u4e48\u4f1a\u7acb\u5373\u8ba9\u4ece\u8282\u70b9\u8fdb\u884c\u6295\u7968\uff0c\u9009\u4e3e\u4e00\u4e2a\u65b0\u7684\u4e3b\u8282\u70b9\u51fa\u6765\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u7531\u4e8e\u4e3b\u8282\u70b9\u7684\u6545\u969c\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u4e0d\u53ef\u5199\uff08\u6ce8\u610f\u8981\u5b9e\u73b0\u8fd9\u6837\u7684\u529f\u80fd\u6700\u5c0f\u7684\u7cfb\u7edf\u5fc5\u987b\u662f\u4e00\u4e3b\u4e00\u4ece\uff0c\u518d\u5c0f\u7684\u8bdd\u5c31\u6ca1\u6709\u610f\u4e49\u4e86\uff09</p> <p></p> <p>\u90a3\u4e48\u600e\u4e48\u542f\u52a8\u4e00\u4e2a\u54e8\u5175\u5462\uff1f\u6211\u4eec\u53ea\u9700\u8981\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u914d\u7f6e\u6587\u4ef6\u5373\u53ef\uff0c\u8fd9\u91cc\u76f4\u63a5\u5220\u9664\u5168\u90e8\u5185\u5bb9\uff0c\u6dfb\u52a0\uff1a</p> <pre><code>sentinel monitor lbwnb 127.0.0.1 6001 1\n</code></pre> <p>\u5176\u4e2d\u7b2c\u4e00\u4e2a\u548c\u7b2c\u4e8c\u4e2a\u662f\u56fa\u5b9a\uff0c\u7b2c\u4e09\u4e2a\u662f\u4e3a\u76d1\u63a7\u5bf9\u8c61\u540d\u79f0\uff0c\u968f\u610f\uff0c\u540e\u9762\u5c31\u662f\u4e3b\u8282\u70b9\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u5305\u62ecIP\u5730\u5740\u548c\u7aef\u53e3\uff0c\u6700\u540e\u4e00\u4e2a1\u6211\u4eec\u6682\u65f6\u5148\u4e0d\u8bf4\uff0c\u7136\u540e\u6211\u4eec\u4f7f\u7528\u6b64\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u542f\u52a8\u540e\uff1a</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u4ee5\u54e8\u5175\u6a21\u5f0f\u542f\u52a8\u540e\uff0c\u4f1a\u81ea\u52a8\u76d1\u63a7\u4e3b\u8282\u70b9\uff0c\u7136\u540e\u8fd8\u4f1a\u663e\u793a\u90a3\u4e9b\u8282\u70b9\u662f\u4f5c\u4e3a\u4ece\u8282\u70b9\u5b58\u5728\u7684\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u76f4\u63a5\u628a\u4e3b\u8282\u70b9\u5173\u95ed\uff0c\u770b\u770b\u4f1a\u53d1\u751f\u4ec0\u4e48\u4e8b\u60c5\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u4ece\u8282\u70b9\u8fd8\u662f\u6b63\u5e38\u7684\u5728\u62a5\u9519\uff0c\u4e00\u5f00\u59cb\u7684\u65f6\u5019\u4e0d\u4f1a\u76f4\u63a5\u91cd\u65b0\u8fdb\u884c\u9009\u4e3e\u800c\u662f\u7ee7\u7eed\u5c1d\u8bd5\u91cd\u8fde\uff08\u56e0\u4e3a\u6709\u53ef\u80fd\u53ea\u662f\u7f51\u7edc\u5c0f\u5361\u4e00\u4e0b\uff0c\u6ca1\u5fc5\u8981\u8fd9\u4e48\u654f\u611f\uff09\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\uff0c\u4f9d\u7136\u65e0\u6cd5\u8fde\u63a5\uff0c\u54e8\u5175\u8f93\u51fa\u4e86\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u54e8\u5175\u53d1\u73b0\u4e3b\u8282\u70b9\u5df2\u7ecf\u6709\u4e00\u6bb5\u65f6\u95f4\u4e0d\u53ef\u7528\u4e86\uff0c\u90a3\u4e48\u5c31\u4f1a\u5f00\u59cb\u8fdb\u884c\u91cd\u65b0\u9009\u4e3e\uff0c6003\u8282\u70b9\u88ab\u9009\u4e3a\u4e86\u65b0\u7684\u4e3b\u8282\u70b9\uff0c\u5e76\u4e14\u4e4b\u524d\u7684\u4e3b\u8282\u70b96001\u53d8\u6210\u4e86\u65b0\u7684\u4e3b\u8282\u70b9\u7684\u4ece\u8282\u70b9\uff1a</p> <p></p> <p></p> <p>\u5f53\u6211\u4eec\u518d\u6b21\u542f\u52a86001\u65f6\uff0c\u4f1a\u53d1\u73b0\uff0c\u5b83\u81ea\u52a8\u53d8\u6210\u4e866003\u7684\u4ece\u8282\u70b9\uff0c\u5e76\u4e14\u4f1a\u5c06\u6570\u636e\u540c\u6b65\u8fc7\u6765\uff1a</p> <p></p> <p>\u90a3\u4e48\uff0c\u8fd9\u4e2a\u9009\u4e3e\u89c4\u5219\u662f\u600e\u6837\u7684\u5462\uff1f\u662f\u5728\u6240\u6709\u7684\u4ece\u8282\u70b9\u4e2d\u968f\u673a\u9009\u53d6\u8fd8\u662f\u9075\u5faa\u67d0\u79cd\u89c4\u5219\u5462\uff1f</p> <ol> <li>\u9996\u5148\u4f1a\u6839\u636e\u4f18\u5148\u7ea7\u8fdb\u884c\u9009\u62e9\uff0c\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u914d\u7f6e\uff0c\u6dfb\u52a0<code>replica-priority</code>\u914d\u7f6e\u9879\uff08\u9ed8\u8ba4\u662f100\uff09\uff0c\u8d8a\u5c0f\u8868\u793a\u4f18\u5148\u7ea7\u8d8a\u9ad8\u3002</li> <li>\u5982\u679c\u4f18\u5148\u7ea7\u4e00\u6837\uff0c\u90a3\u5c31\u9009\u62e9\u504f\u79fb\u91cf\u6700\u5927\u7684</li> <li>\u8981\u662f\u8fd8\u9009\u4e0d\u51fa\u6765\uff0c\u90a3\u5c31\u9009\u62e9runid\uff08\u542f\u52a8\u65f6\u968f\u673a\u751f\u6210\u7684\uff09\u6700\u5c0f\u7684\u3002</li> </ol> <p>\u8981\u662f\u54e8\u5175\u4e5f\u6302\u4e86\u548b\u529e\uff1f\u6ca1\u4e8b\uff0c\u54b1\u4eec\u53ef\u4ee5\u591a\u5b89\u6392\u51e0\u4e2a\u54e8\u5175\uff0c\u53ea\u9700\u8981\u628a\u54e8\u5175\u7684\u914d\u7f6e\u590d\u5236\u4e00\u4e0b\uff0c\u7136\u540e\u4fee\u6539\u7aef\u53e3\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u540c\u65f6\u542f\u52a8\u591a\u4e2a\u54e8\u5175\u4e86\uff0c\u6211\u4eec\u542f\u52a83\u4e2a\u54e8\u5175\uff08\u4e00\u4e3b\u4e8c\u4ece\u4e09\u54e8\u5175\uff09\uff0c\u8fd9\u91cc\u6211\u4eec\u5427\u6700\u540e\u4e00\u4e2a\u503c\u6539\u4e3a<code>2</code>\uff1a</p> <pre><code>sentinel monitor lbwnb 192.168.0.8 6001 2\n</code></pre> <p>\u8fd9\u4e2a\u503c\u5b9e\u9645\u4e0a\u4ee3\u8868\u7684\u662f\u5f53\u6709\u51e0\u4e2a\u54e8\u5175\u8ba4\u4e3a\u4e3b\u8282\u70b9\u6302\u6389\u65f6\uff0c\u5c31\u5224\u65ad\u4e3b\u8282\u70b9\u771f\u7684\u6302\u6389\u4e86</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u628a6001\u8282\u70b9\u6302\u6389\uff0c\u770b\u770b\u8fd9\u4e09\u4e2a\u54e8\u5175\u4f1a\u600e\u4e48\u6837\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u90fd\u663e\u793a\u5c06master\u5207\u6362\u4e3a6002\u8282\u70b9\u4e86\u3002</p> <p>\u90a3\u4e48\uff0c\u5728\u54e8\u5175\u91cd\u65b0\u9009\u4e3e\u65b0\u7684\u4e3b\u8282\u70b9\u4e4b\u540e\uff0c\u6211\u4eecJava\u4e2d\u7684Redis\u7684\u5ba2\u6237\u7aef\u600e\u4e48\u611f\u77e5\u5230\u5462\uff1f\u6211\u4eec\u6765\u770b\u770b\uff0c\u9996\u5148\u8fd8\u662f\u5bfc\u5165\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;redis.clients&lt;/groupId&gt;\n        &lt;artifactId&gt;jedis&lt;/artifactId&gt;\n        &lt;version&gt;4.2.1&lt;/version&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre> <pre><code>public class Main {\n    public static void main(String[] args) {\n        //\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u4f7f\u7528JedisSentinelPool\u6765\u83b7\u53d6Master\u8282\u70b9\n        //\u9700\u8981\u628a\u4e09\u4e2a\u54e8\u5175\u7684\u5730\u5740\u90fd\u586b\u5165\n        try (JedisSentinelPool pool = new JedisSentinelPool(\"lbwnb\",\n                new HashSet&lt;&gt;(Arrays.asList(\"192.168.0.8:26741\", \"192.168.0.8:26740\", \"192.168.0.8:26739\")))) {\n            Jedis jedis = pool.getResource();   //\u76f4\u63a5\u8be2\u95ee\u5e76\u5f97\u5230Jedis\u5bf9\u8c61\uff0c\u8fd9\u5c31\u662f\u8fde\u63a5\u7684Master\u8282\u70b9\n            jedis.set(\"test\", \"114514\");    //\u76f4\u63a5\u5199\u5165\u5373\u53ef\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u5411Master\u8282\u70b9\u5199\u5165\n\n            Jedis jedis2 = pool.getResource();   //\u518d\u6b21\u83b7\u53d6\n            System.out.println(jedis2.get(\"test\"));   //\u8bfb\u53d6\u64cd\u4f5c\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0cJedis\u5bf9\u8c61\u5c31\u53ef\u4ee5\u901a\u8fc7\u54e8\u5175\u6765\u83b7\u53d6\uff0c\u5f53Master\u8282\u70b9\u66f4\u65b0\u540e\uff0c\u4e5f\u80fd\u5f97\u5230\u6700\u65b0\u7684\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_7","title":"\u96c6\u7fa4\u642d\u5efa","text":"<p>\u5982\u679c\u6211\u4eec\u670d\u52a1\u5668\u7684\u5185\u5b58\u4e0d\u591f\u7528\u4e86\uff0c\u4f46\u662f\u73b0\u5728\u6211\u4eec\u7684Redis\u53c8\u9700\u8981\u7ee7\u7eed\u5b58\u50a8\u5185\u5bb9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u5229\u7528\u96c6\u7fa4\u6765\u5b9e\u73b0\u6269\u5bb9\u3002</p> <p>\u56e0\u4e3a\u5355\u673a\u7684\u5185\u5b58\u5bb9\u91cf\u6700\u5927\u5c31\u90a3\u4e48\u591a\uff0c\u5df2\u7ecf\u6ca1\u529e\u6cd5\u518d\u7ee7\u7eed\u6269\u5c55\u4e86\uff0c\u4f46\u662f\u73b0\u5728\u53c8\u9700\u8981\u5b58\u50a8\u66f4\u591a\u7684\u5185\u5bb9\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba9N\u53f0\u673a\u5668\u4e0a\u7684Redis\u6765\u5206\u522b\u5b58\u50a8\u5404\u4e2a\u90e8\u5206\u7684\u6570\u636e\uff08\u6bcf\u4e2aRedis\u53ef\u4ee5\u5b58\u50a81/N\u7684\u6570\u636e\u91cf\uff09\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u5bb9\u91cf\u7684\u6a2a\u5411\u6269\u5c55\u3002\u540c\u65f6\u6bcf\u53f0Redis\u8fd8\u53ef\u4ee5\u914d\u4e00\u4e2a\u4ece\u8282\u70b9\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u66f4\u597d\u5730\u4fdd\u8bc1\u6570\u636e\u7684\u5b89\u5168\u6027\u3002</p> <p></p> <p>\u90a3\u4e48\u95ee\u9898\u6765\uff0c\u73b0\u5728\u7528\u6237\u6765\u4e86\u4e00\u4e2a\u5199\u5165\u7684\u8bf7\u6c42\uff0c\u6570\u636e\u8be5\u5199\u5230\u54ea\u4e2a\u8282\u70b9\u4e0a\u5462\uff1f\u6211\u4eec\u6765\u7814\u7a76\u4e00\u4e0b\u96c6\u7fa4\u7684\u673a\u5236\uff1a</p> <p>\u9996\u5148\uff0c\u4e00\u4e2aRedis\u96c6\u7fa4\u5305\u542b16384\u4e2a\u63d2\u69fd\uff0c\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2aRedis \u5b9e\u4f8b\u8d1f\u8d23\u7ef4\u62a4\u4e00\u90e8\u5206\u63d2\u69fd\u4ee5\u53ca\u63d2\u69fd\u6240\u6620\u5c04\u7684\u952e\u503c\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u4e2a\u63d2\u69fd\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f</p> <p>\u5b9e\u9645\u4e0a\uff0c\u63d2\u69fd\u5c31\u662f\u952e\u7684Hash\u8ba1\u7b97\u540e\u7684\u4e00\u4e2a\u7ed3\u679c\uff0c\u6ce8\u610f\u8fd9\u91cc\u51fa\u73b0\u4e86<code>\u8ba1\u7b97\u673a\u7f51\u7edc</code>\u4e2d\u7684CRC\u5faa\u73af\u5197\u4f59\u6821\u9a8c\uff0c\u8fd9\u91cc\u91c7\u7528CRC16\uff0c\u80fd\u5f97\u523016\u4e2abit\u4f4d\u7684\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u8bf4\u7b97\u51fa\u6765\u4e4b\u540e\u7ed3\u679c\u662f0-65535\u4e4b\u95f4\uff0c\u518d\u8fdb\u884c\u53d6\u6a21\uff0c\u5f97\u5230\u6700\u7ec8\u7ed3\u679c\uff1a</p> <p>Redis key\u7684\u8def\u7531\u8ba1\u7b97\u516c\u5f0f\uff1aslot = CRC16\uff08key\uff09 % 16384</p> <p>\u7ed3\u679c\u7684\u503c\u662f\u591a\u5c11\uff0c\u5c31\u5e94\u8be5\u5b58\u653e\u5230\u5bf9\u5e94\u7ef4\u62a4\u7684Redis\u4e0b\uff0c\u6bd4\u5982Redis\u8282\u70b91\u8d1f\u8d230-25565\u7684\u63d2\u69fd\uff0c\u800c\u8fd9\u65f6\u5ba2\u6237\u7aef\u63d2\u5165\u4e86\u4e00\u4e2a\u65b0\u7684\u6570\u636e<code>a=10</code>\uff0ca\u5728Hash\u8ba1\u7b97\u540e\u7ed3\u679c\u4e3a666\uff0c\u90a3\u4e48a\u5c31\u5e94\u8be5\u5b58\u653e\u52301\u53f7Redis\u8282\u70b9\u4e2d\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u672c\u8d28\u4e0a\u5c31\u662f\u901a\u8fc7\u54c8\u5e0c\u7b97\u6cd5\u5c06\u63d2\u5165\u7684\u6570\u636e\u5206\u644a\u5230\u5404\u4e2a\u8282\u70b9\u7684\uff0c\u6240\u4ee5\u8bf4\u54c8\u5e0c\u7b97\u6cd5\u771f\u7684\u662f\u5904\u5904\u90fd\u6709\u7528\u554a\u3002</p> <p>\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u5c31\u6765\u642d\u5efa\u4e00\u4e2a\u7b80\u5355\u7684Redis\u96c6\u7fa4\uff0c\u8fd9\u91cc\u521b\u5efa6\u4e2a\u914d\u7f6e\uff0c\u6ce8\u610f\u5f00\u542f\u96c6\u7fa4\u6a21\u5f0f\uff1a</p> <pre><code># Normal Redis instances can't be part of a Redis Cluster; only nodes that are\n# started as cluster nodes can. In order to start a Redis instance as a\n# cluster node enable the cluster support uncommenting the following:\n#\ncluster-enabled yes\n</code></pre> <p>\u63a5\u7740\u8bb0\u5f97\u628a\u6240\u6709\u7684\u6301\u4e45\u5316\u6587\u4ef6\u5168\u90e8\u5220\u9664\uff0c\u6240\u6709\u7684\u8282\u70b9\u5185\u5bb9\u5fc5\u987b\u662f\u7a7a\u7684\u3002</p> <p>\u7136\u540e\u8f93\u5165<code>redis-cli.exe --cluster create --cluster-replicas 1 127.0.0.1:6001 127.0.0.1:6002 127.0.0.1:6003 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003</code>\uff0c\u8fd9\u91cc\u7684<code>--cluster-replicas 1</code>\u6307\u7684\u662f\u6bcf\u4e2a\u8282\u70b9\u914d\u4e00\u4e2a\u4ece\u8282\u70b9\uff1a</p> <p></p> <p>\u8f93\u5165\u4e4b\u540e\uff0c\u4f1a\u4e3a\u4f60\u5c55\u793a\u5ba2\u6237\u7aef\u9ed8\u8ba4\u5206\u914d\u7684\u65b9\u6848\uff0c\u5e76\u4e14\u4f1a\u8be2\u95ee\u4f60\u5f53\u524d\u7684\u65b9\u6848\u662f\u5426\u5408\u7406\u3002\u53ef\u4ee5\u770b\u52306001/6002/6003\u90fd\u88ab\u9009\u4e3a\u4e3b\u8282\u70b9\uff0c\u5176\u4ed6\u7684\u4e3a\u4ece\u8282\u70b9\uff0c\u6211\u4eec\u76f4\u63a5\u8f93\u5165yes\u5373\u53ef\uff1a</p> <p></p> <p>\u6700\u540e\u5206\u914d\u6210\u529f\uff0c\u53ef\u4ee5\u770b\u5230\u63d2\u69fd\u7684\u5206\u914d\u60c5\u51b5\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u968f\u4fbf\u8fde\u63a5\u4e00\u4e2a\u8282\u70b9\uff0c\u5c1d\u8bd5\u63d2\u5165\u4e00\u4e2a\u503c\uff1a</p> <p></p> <p>\u5728\u63d2\u5165\u65f6\uff0c\u51fa\u73b0\u4e86\u4e00\u4e2a\u9519\u8bef\uff0c\u5b9e\u9645\u4e0a\u8fd9\u5c31\u662f\u56e0\u4e3aa\u8ba1\u7b97\u51fa\u6765\u7684\u54c8\u5e0c\u503c\uff08\u63d2\u69fd\uff09\uff0c\u4e0d\u5f52\u5f53\u524d\u8282\u70b9\u7ba1\uff0c\u6211\u4eec\u5f97\u53bb\u7ba1\u8fd9\u4e2a\u63d2\u69fd\u7684\u8282\u70b9\u6267\u884c\uff0c\u901a\u8fc7\u4e0a\u9762\u7684\u5206\u914d\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u523015495\u5c5e\u4e8e\u8282\u70b96003\u7ba1\u7406\uff1a</p> <p></p> <p>\u57286003\u8282\u70b9\u63d2\u5165\u6210\u529f\uff0c\u5f53\u7136\u6211\u4eec\u4e5f\u53ef\u4ee5\u4f7f\u7528\u96c6\u7fa4\u65b9\u5f0f\u8fde\u63a5\uff0c\u8fd9\u6837\u6211\u4eec\u65e0\u8bba\u5728\u54ea\u4e2a\u8282\u70b9\u90fd\u53ef\u4ee5\u63d2\u5165\uff0c\u53ea\u9700\u8981\u6dfb\u52a0<code>-c</code>\u8868\u793a\u4ee5\u96c6\u7fa4\u6a21\u5f0f\u8bbf\u95ee\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u57286001\u8282\u70b9\u6210\u529f\u5bf9a\u7684\u503c\u8fdb\u884c\u4e86\u66f4\u65b0\uff0c\u53ea\u4e0d\u8fc7\u8fd8\u662f\u88ab\u91cd\u5b9a\u5411\u5230\u4e866003\u8282\u70b9\u8fdb\u884c\u63d2\u5165\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u8f93\u5165<code>cluster nodes</code>\u547d\u4ee4\u6765\u67e5\u770b\u5f53\u524d\u6240\u6709\u8282\u70b9\u7684\u4fe1\u606f\uff1a</p> <p></p> <p>\u90a3\u4e48\u73b0\u5728\u5982\u679c\u6211\u4eec\u8ba9\u67d0\u4e00\u4e2a\u4e3b\u8282\u70b9\u6302\u6389\u4f1a\u600e\u4e48\u6837\uff1f\u73b0\u5728\u6211\u4eec\u628a6001\u6302\u6389\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u539f\u672c\u76846001\u4ece\u8282\u70b97001\uff0c\u664b\u5347\u4e3a\u4e86\u65b0\u7684\u4e3b\u8282\u70b9\uff0c\u800c\u4e4b\u524d\u76846001\u5df2\u7ecf\u6302\u4e86\uff0c\u73b0\u5728\u6211\u4eec\u5c066001\u91cd\u542f\u8bd5\u8bd5\u770b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u52306001\u53d8\u6210\u4e867001\u7684\u4ece\u8282\u70b9\uff0c\u90a3\u4e48\u8981\u662f6001\u548c7001\u90fd\u6302\u4e86\u5462\uff1f</p> <p></p> <p>\u8fd9\u65f6\u6211\u4eec\u5c1d\u8bd5\u63d2\u5165\u65b0\u7684\u6570\u636e\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5f53\u5b58\u5728\u8282\u70b9\u4e0d\u53ef\u7528\u65f6\uff0c\u4f1a\u65e0\u6cd5\u63d2\u5165\u65b0\u7684\u6570\u636e\uff0c\u73b0\u5728\u6211\u4eec\u5c066001\u548c7001\u6062\u590d\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6062\u590d\u4e4b\u540e\u53c8\u53ef\u4ee5\u7ee7\u7eed\u6b63\u5e38\u4f7f\u7528\u4e86\u3002</p> <p>\u6700\u540e\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u5982\u4f55\u4f7f\u7528Java\u8fde\u63a5\u5230\u96c6\u7fa4\u6a21\u5f0f\u4e0b\u7684Redis\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230JedisCluster\u5bf9\u8c61\uff1a</p> <pre><code>public class Main {\n    public static void main(String[] args) {\n        //\u548c\u5ba2\u6237\u7aef\u4e00\u6837\uff0c\u968f\u4fbf\u8fde\u4e00\u4e2a\u5c31\u884c\uff0c\u4e5f\u53ef\u4ee5\u591a\u5199\u51e0\u4e2a\uff0c\u6784\u9020\u65b9\u6cd5\u6709\u5f88\u591a\u79cd\u53ef\u4ee5\u9009\u62e9\n        try(JedisCluster cluster = new JedisCluster(new HostAndPort(\"192.168.0.8\", 6003))){\n            System.out.println(\"\u96c6\u7fa4\u5b9e\u4f8b\u6570\u91cf\uff1a\"+cluster.getClusterNodes().size());\n            cluster.set(\"a\", \"yyds\");\n            System.out.println(cluster.get(\"a\"));\n        }\n    }\n}\n</code></pre> <p>\u64cd\u4f5c\u57fa\u672c\u548cJedis\u5bf9\u8c61\u4e00\u6837\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u505a\u8d58\u8ff0\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_8","title":"\u5206\u5e03\u5f0f\u9501","text":"<p>\u5728\u6211\u4eec\u7684\u4f20\u7edf\u5355\u4f53\u5e94\u7528\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u7528\u5230\u9501\u673a\u5236\uff0c\u76ee\u7684\u662f\u4e3a\u4e86\u9632\u6b62\u591a\u7ebf\u7a0b\u7ade\u4e89\u5bfc\u81f4\u7684\u5e76\u53d1\u95ee\u9898\uff0c\u4f46\u662f\u73b0\u5728\u6211\u4eec\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\uff0c\u53c8\u8be5\u5982\u4f55\u5b9e\u73b0\u9501\u673a\u5236\u5462\uff1f\u53ef\u80fd\u4e00\u6761\u94fe\u8def\u4e0a\u6709\u5f88\u591a\u7684\u5e94\u7528\uff0c\u5b83\u4eec\u90fd\u662f\u72ec\u7acb\u8fd0\u884c\u7684\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u501f\u52a9Redis\u6765\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\u3002</p> <p>\u8fd8\u8bb0\u5f97\u6211\u4eec\u4e0a\u4e00\u7ae0\u6700\u540e\u63d0\u51fa\u7684\u95ee\u9898\u5417\uff1f</p> <pre><code>@Override\npublic boolean doBorrow(int uid, int bid) {\n    //1. \u5224\u65ad\u56fe\u4e66\u548c\u7528\u6237\u662f\u5426\u90fd\u652f\u6301\u501f\u9605\uff0c\u5982\u679c\u6b64\u65f6\u6765\u4e8610\u4e2a\u7ebf\u7a0b\uff0c\u90fd\u8fdb\u6765\u4e86\uff0c\u90a3\u4e48\u90fd\u80fd\u591f\u5224\u65ad\u4e3a\u53ef\u4ee5\u501f\u9605\n    if(bookClient.bookRemain(bid) &lt; 1)\n        throw new RuntimeException(\"\u56fe\u4e66\u6570\u91cf\u4e0d\u8db3\");\n    if(userClient.userRemain(uid) &lt; 1)\n        throw new RuntimeException(\"\u7528\u6237\u501f\u9605\u91cf\u4e0d\u8db3\");\n    //2. \u9996\u5148\u5c06\u56fe\u4e66\u7684\u6570\u91cf-1\uff0c\u7531\u4e8e\u4e0a\u976210\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8fdb\u6765\uff0c\u540c\u65f6\u5224\u65ad\u53ef\u4ee5\u501f\u9605\uff0c\u90a3\u4e48\u8fd9\u4e2a10\u4e2a\u7ebf\u7a0b\u5c31\u540c\u65f6\u5c06\u56fe\u4e66\u6570\u91cf-1\uff0c\u90a3\u5e93\u5b58\u5c82\u4e0d\u662f\u76f4\u63a5\u53d8\u6210\u8d1f\u6570\u4e86\uff1f\uff1f\uff1f\n    if(!bookClient.bookBorrow(bid))\n        throw new RuntimeException(\"\u5728\u501f\u9605\u56fe\u4e66\u65f6\u51fa\u73b0\u9519\u8bef\uff01\");\n    ...\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\u5728\u9ad8\u5e76\u53d1\u4e0b\uff0c\u6211\u4eec\u770b\u4f3c\u6b63\u5e38\u7684\u501f\u9605\u6d41\u7a0b\uff0c\u4f1a\u51fa\u73b0\u95ee\u9898\uff0c\u6bd4\u5982\u73b0\u5728\u540c\u65f6\u6765\u4e8610\u4e2a\u540c\u5b66\u8981\u501f\u540c\u4e00\u672c\u4e66\uff0c\u4f46\u662f\u73b0\u5728\u53ea\u67093\u672c\uff0c\u800c\u6211\u4eec\u7684\u5224\u65ad\u89c4\u5219\u662f\uff0c\u9996\u5148\u770b\u4e66\u591f\u4e0d\u591f\uff0c\u5982\u679c\u6b64\u65f6\u8fd910\u4e2a\u8bf7\u6c42\u90fd\u5df2\u7ecf\u8d70\u5230\u8fd9\u91cc\uff0c\u5e76\u4e14\u90fd\u5224\u5b9a\u4e3a\u53ef\u4ee5\u8fdb\u884c\u501f\u9605\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u51fa\u73b0\u4e86\uff0c\u63a5\u4e0b\u6765\u8fd910\u4e2a\u8bf7\u6c42\u90fd\u5f00\u59cb\u8fdb\u884c\u501f\u9605\u64cd\u4f5c\uff0c\u5bfc\u81f4\u5e93\u5b58\u76f4\u63a5\u7206\u8868\uff0c\u5f62\u6210\u8d85\u501f\u95ee\u9898\uff08\u5728\u7535\u5546\u7cfb\u7edf\u4e2d\u4e5f\u5b58\u5728\u540c\u6837\u7684\u8d85\u5356\u95ee\u9898\uff09</p> <p>\u56e0\u6b64\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u79cd\u95ee\u9898\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u5206\u5e03\u5f0f\u9501\u6765\u5b9e\u73b0\u3002\u90a3\u4e48Redis\u5982\u4f55\u53bb\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\u5462\uff1f</p> <p>\u5728Redis\u5b58\u5728\u8fd9\u6837\u4e00\u4e2a\u547d\u4ee4\uff1a</p> <pre><code>setnx key value\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u770b\u8d77\u6765\u548c<code>set</code>\u547d\u4ee4\u5dee\u4e0d\u591a\uff0c\u4f46\u662f\u5b83\u6709\u4e00\u4e2a\u673a\u5236\uff0c\u5c31\u662f\u53ea\u6709\u5f53\u6307\u5b9a\u7684key\u4e0d\u5b58\u5728\u7684\u65f6\u5019\uff0c\u624d\u80fd\u8fdb\u884c\u63d2\u5165\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f<code>set if not exists</code>\u7684\u7f29\u5199\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5f53\u5ba2\u6237\u7aef1\u8bbe\u5b9aa\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef2\u4f7f\u7528<code>setnx</code>\u4f1a\u76f4\u63a5\u5931\u8d25\u3002</p> <p></p> <p>\u5f53\u5ba2\u6237\u7aef1\u5c06a\u5220\u9664\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef2\u5c31\u53ef\u4ee5\u4f7f\u7528<code>setnx</code>\u6210\u529f\u63d2\u5165\u4e86\u3002</p> <p>\u5229\u7528\u8fd9\u79cd\u7279\u6027\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u670d\u52a1\u4e2d\u5b9e\u73b0\u5206\u5e03\u5f0f\u9501\uff0c\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u8981\u662f\u67d0\u4e2a\u670d\u52a1\u52a0\u4e86\u9501\u4f46\u662f\u5361\u987f\u4e86\u5462\uff0c\u6216\u662f\u76f4\u63a5\u5d29\u6e83\u4e86\uff0c\u90a3\u8fd9\u628a\u9501\u5c82\u4e0d\u662f\u6c38\u8fdc\u65e0\u6cd5\u91ca\u653e\u4e86\uff1f\u56e0\u6b64\u6211\u4eec\u8fd8\u53ef\u4ee5\u8003\u8651\u52a0\u4e2a\u8fc7\u671f\u65f6\u95f4\uff1a</p> <pre><code>set a 666 EX 5 NX\n</code></pre> <p>\u8fd9\u91cc\u4f7f\u7528<code>set</code>\u547d\u4ee4\uff0c\u6700\u540e\u52a0\u4e00\u4e2aNX\u8868\u793a\u662f\u4f7f\u7528<code>setnx</code>\u7684\u6a21\u5f0f\uff0c\u548c\u4e0a\u9762\u662f\u4e00\u6837\u7684\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7EX\u8bbe\u5b9a\u8fc7\u671f\u65f6\u95f4\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e3a5\u79d2\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c5\u79d2\u8fd8\u6ca1\u91ca\u653e\uff0c\u90a3\u4e48\u5c31\u81ea\u52a8\u5220\u9664\u3002</p> <p></p> <p>\u5f53\u7136\uff0c\u6dfb\u52a0\u4e86\u8fc7\u671f\u65f6\u95f4\uff0c\u5e26\u4e86\u7684\u597d\u5904\u662f\u663e\u800c\u6613\u89c1\u7684\uff0c\u4f46\u662f\u540c\u65f6\u4e5f\u5e26\u6765\u4e86\u5f88\u591a\u7684\u9ebb\u70e6\uff0c\u6211\u4eec\u6765\u8bbe\u60f3\u4e00\u4e0b\u8fd9\u79cd\u60c5\u51b5\uff1a</p> <p></p> <p>\u56e0\u6b64\uff0c\u5355\u7eaf\u53ea\u662f\u6dfb\u52a0\u8fc7\u671f\u65f6\u95f4\uff0c\u4f1a\u51fa\u73b0\u8fd9\u79cd\u628a\u522b\u4eba\u52a0\u7684\u9501\u8c01\u5378\u4e86\u7684\u60c5\u51b5\uff0c\u8981\u89e3\u51b3\u8fd9\u79cd\u95ee\u9898\u4e5f\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u73b0\u5728\u7684\u76ee\u6807\u5c31\u662f\u4fdd\u8bc1\u4efb\u52a1\u53ea\u80fd\u5220\u9664\u81ea\u5df1\u52a0\u7684\u9501\uff0c\u5982\u679c\u662f\u522b\u4eba\u52a0\u7684\u9501\u662f\u6ca1\u6709\u8d44\u683c\u5220\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5427a\u7684\u503c\u6307\u5b9a\u4e3a\u6211\u4eec\u4efb\u52a1\u4e13\u5c5e\u7684\u503c\uff0c\u6bd4\u5982\u53ef\u4ee5\u4f7f\u7528UUID\u4e4b\u7c7b\u7684\uff0c\u5982\u679c\u5728\u4e3b\u52a8\u5220\u9664\u9501\u7684\u65f6\u5019\u53d1\u73b0\u503c\u4e0d\u662f\u6211\u4eec\u5f53\u524d\u4efb\u52a1\u6307\u5b9a\u7684\uff0c\u90a3\u4e48\u8bf4\u660e\u53ef\u80fd\u662f\u56e0\u4e3a\u8d85\u65f6\uff0c\u5176\u4ed6\u4efb\u52a1\u5df2\u7ecf\u52a0\u9501\u4e86\u3002</p> <p></p> <p>\u5982\u679c\u4f60\u5728\u5b66\u4e60\u672c\u7bc7\u4e4b\u524d\u5b8c\u6210\u4e86JUC\u5e76\u53d1\u7f16\u7a0b\u7bc7\u7684\u5b66\u4e60\uff0c\u90a3\u4e48\u4e00\u5b9a\u4f1a\u6709\u4e00\u4e2a\u7591\u60d1\uff0c\u5982\u679c\u5728\u8d85\u65f6\u4e4b\u524d\u90a3\u4e00\u5239\u90a3\u8fdb\u5165\u5230\u91ca\u653e\u9501\u7684\u9636\u6bb5\uff0c\u83b7\u53d6\u5230\u503c\u80af\u5b9a\u8fd8\u662f\u81ea\u5df1\uff0c\u4f46\u662f\u5728\u5373\u5c06\u6267\u884c\u5220\u9664\u4e4b\u524d\uff0c\u7531\u4e8e\u8d85\u65f6\u673a\u5236\u5bfc\u81f4\u88ab\u5220\u9664\u5e76\u4e14\u5176\u4ed6\u4efb\u52a1\u4e5f\u52a0\u9501\u4e86\uff0c\u90a3\u4e48\u8fd9\u65f6\u518d\u8fdb\u884c\u5220\u9664\uff0c\u4ecd\u7136\u4f1a\u5bfc\u81f4\u5220\u9664\u5176\u4ed6\u4efb\u52a1\u52a0\u7684\u9501\u3002</p> <p></p> <p>\u5b9e\u9645\u4e0a\u672c\u8d28\u8fd8\u662f\u56e0\u4e3a\u9501\u7684\u8d85\u65f6\u65f6\u95f4\u4e0d\u592a\u597d\u8861\u91cf\uff0c\u5982\u679c\u8d85\u65f6\u65f6\u95f4\u80fd\u591f\u8bbe\u5b9a\u5730\u6bd4\u8f83\u6070\u5f53\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u907f\u514d\u8fd9\u79cd\u95ee\u9898\u4e86\u3002</p> <p>\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u4e00\u4e0bRedisson\u6846\u67b6\uff0c\u5b83\u662fRedis\u5b98\u65b9\u63a8\u8350\u7684Java\u7248\u7684Redis\u5ba2\u6237\u7aef\u3002\u5b83\u63d0\u4f9b\u7684\u529f\u80fd\u975e\u5e38\u591a\uff0c\u4e5f\u975e\u5e38\u5f3a\u5927\uff0cRedisson\u5185\u90e8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u76d1\u63a7\u9501\u7684\u770b\u95e8\u72d7\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u5728Redisson\u5b9e\u4f8b\u88ab\u5173\u95ed\u524d\uff0c\u4e0d\u65ad\u7684\u5ef6\u957f\u9501\u7684\u6709\u6548\u671f\uff0c\u5b83\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u5f88\u591a\u79cd\u5206\u5e03\u5f0f\u9501\u7684\u5b9e\u73b0\uff0c\u4f7f\u7528\u8d77\u6765\u4e5f\u7c7b\u4f3c\u6211\u4eec\u5728JUC\u4e2d\u5b66\u4e60\u7684\u9501\uff0c\u8fd9\u91cc\u6211\u4eec\u5c1d\u8bd5\u4f7f\u7528\u4e00\u4e0b\u5b83\u7684\u5206\u5e03\u5f0f\u9501\u529f\u80fd\u3002</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.redisson&lt;/groupId&gt;\n    &lt;artifactId&gt;redisson&lt;/artifactId&gt;\n    &lt;version&gt;3.17.0&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;io.netty&lt;/groupId&gt;\n    &lt;artifactId&gt;netty-all&lt;/artifactId&gt;\n    &lt;version&gt;4.1.75.Final&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u9996\u5148\u6211\u4eec\u6765\u770b\u770b\u4e0d\u52a0\u9501\u7684\u60c5\u51b5\u4e0b\uff1a</p> <pre><code>public static void main(String[] args) {\n    for (int i = 0; i &lt; 10; i++) {\n        new Thread(() -&gt; {\n            try(Jedis jedis = new Jedis(\"192.168.0.10\", 6379)){\n                for (int j = 0; j &lt; 100; j++) {   //\u6bcf\u4e2a\u5ba2\u6237\u7aef\u83b7\u53d6a\u7136\u540e\u589e\u52a0a\u7684\u503c\u518d\u5199\u56de\u53bb\uff0c\u5982\u679c\u4e0d\u52a0\u9501\u90a3\u4e48\u80af\u5b9a\u4f1a\u51fa\u95ee\u9898\n                    int a = Integer.parseInt(jedis.get(\"a\")) + 1;\n                    jedis.set(\"a\", a+\"\");\n                }\n            }\n        }).start();\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u6ca1\u6709\u76f4\u63a5\u7528<code>incr</code>\u800c\u662f\u6211\u4eec\u81ea\u5df1\u8fdb\u884c\u8ba1\u7b97\uff0c\u65b9\u4fbf\u6a21\u62df\uff0c\u53ef\u4ee5\u770b\u5230\u8fd0\u884c\u7ed3\u675f\u4e4b\u540ea\u7684\u503c\u5e76\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u6765\u7ed9\u5b83\u52a0\u4e00\u628a\u9501\uff0c\u6ce8\u610f\u8fd9\u4e2a\u9501\u662f\u57fa\u4e8eRedis\u7684\uff0c\u4e0d\u4ec5\u4ec5\u53ea\u53ef\u4ee5\u7528\u4e8e\u5f53\u524d\u5e94\u7528\uff0c\u662f\u80fd\u591f\u57ae\u7cfb\u7edf\u7684\uff1a</p> <pre><code>public static void main(String[] args) {\n    Config config = new Config();\n    config.useSingleServer().setAddress(\"redis://192.168.0.10:6379\");   //\u914d\u7f6e\u8fde\u63a5\u7684Redis\u670d\u52a1\u5668\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u96c6\u7fa4\n    RedissonClient client =  Redisson.create(config);   //\u521b\u5efaRedissonClient\u5ba2\u6237\u7aef\n    for (int i = 0; i &lt; 10; i++) {\n        new Thread(() -&gt; {\n            try(Jedis jedis = new Jedis(\"192.168.0.10\", 6379)){\n                RLock lock = client.getLock(\"testLock\");    //\u6307\u5b9a\u9501\u7684\u540d\u79f0\uff0c\u62ff\u5230\u9501\u5bf9\u8c61\n                for (int j = 0; j &lt; 100; j++) {\n                    lock.lock();    //\u52a0\u9501\n                    int a = Integer.parseInt(jedis.get(\"a\")) + 1;\n                    jedis.set(\"a\", a+\"\");\n                    lock.unlock();   //\u89e3\u9501\n                }\n            }\n            System.out.println(\"\u7ed3\u675f\uff01\");\n        }).start();\n    }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u7ed3\u679c\u6ca1\u6709\u95ee\u9898\uff1a</p> <p></p> <p>\u6ce8\u610f\uff0c\u5982\u679c\u7528\u4e8e\u5b58\u653e\u9501\u7684Redis\u670d\u52a1\u5668\u6302\u4e86\uff0c\u90a3\u4e48\u80af\u5b9a\u662f\u4f1a\u51fa\u95ee\u9898\u7684\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528RedLock\uff0c\u5b83\u7684\u601d\u8def\u662f\uff0c\u5728\u591a\u4e2aRedis\u670d\u52a1\u5668\u4e0a\u4fdd\u5b58\u9501\uff0c\u53ea\u9700\u8981\u8d85\u8fc7\u534a\u6570\u7684Redis\u670d\u52a1\u5668\u83b7\u53d6\u5230\u9501\uff0c\u90a3\u4e48\u5c31\u771f\u7684\u83b7\u53d6\u5230\u9501\u4e86\uff0c\u8fd9\u6837\u5c31\u7b97\u6302\u6389\u4e00\u90e8\u5206\u8282\u70b9\uff0c\u4e5f\u80fd\u4fdd\u8bc1\u6b63\u5e38\u8fd0\u884c\uff0c\u8fd9\u91cc\u5c31\u4e0d\u505a\u6f14\u793a\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#mysql","title":"MySQL\u4e0e\u5206\u5e03\u5f0f","text":"<p>\u524d\u9762\u6211\u8bb2\u89e3\u4e86Redis\u5728\u5206\u5e03\u5f0f\u573a\u666f\u7684\u4e0b\u7684\u76f8\u5173\u5e94\u7528\uff0c\u63a5\u7740\u6211\u4eec\u6765\u770b\u770bMySQL\u6570\u636e\u5e93\u5728\u5206\u5e03\u5f0f\u573a\u666f\u4e0b\u7684\u5e94\u7528\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_9","title":"\u4e3b\u4ece\u590d\u5236","text":"<p>\u5f53\u6211\u4eec\u4f7f\u7528MySQL\u7684\u65f6\u5019\uff0c\u4e5f\u53ef\u4ee5\u91c7\u53d6\u4e3b\u4ece\u590d\u5236\u7684\u7b56\u7565\uff0c\u5b83\u7684\u5b9e\u73b0\u601d\u8def\u57fa\u672c\u548cRedis\u76f8\u4f3c\uff0c\u4e5f\u662f\u91c7\u7528\u589e\u91cf\u590d\u5236\u7684\u65b9\u5f0f\uff0cMySQL\u4f1a\u5728\u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u8bb0\u5f55\u4e8c\u8fdb\u5236\u65e5\u5fd7\uff0c\u6240\u6709\u7684DML\u548cDDL\u64cd\u4f5c\u90fd\u4f1a\u88ab\u8bb0\u5f55\u8fdb\u65e5\u5fd7\u4e2d\uff0c\u4e3b\u5e93\u53ea\u9700\u8981\u5c06\u8bb0\u5f55\u7684\u64cd\u4f5c\u590d\u5236\u7ed9\u4ece\u5e93\uff0c\u8ba9\u4ece\u5e93\u4e5f\u8fd0\u884c\u4e00\u6b21\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5b9e\u73b0\u4e3b\u4ece\u590d\u5236\u3002\u4f46\u662f\u6ce8\u610f\u5b83\u4e0d\u4f1a\u5728\u4e00\u5f00\u59cb\u8fdb\u884c\u5168\u91cf\u590d\u5236\uff0c\u6240\u4ee5\u6700\u597d\u518d\u5f00\u59cb\u4e3b\u4ece\u4e4b\u524d\u5c06\u6570\u636e\u5e93\u7684\u5185\u5bb9\u4fdd\u6301\u4e00\u81f4\u3002</p> <p>\u548c\u4e4b\u524d\u4e00\u6837\uff0c\u4e00\u65e6\u6211\u4eec\u5b9e\u73b0\u4e86\u4e3b\u4ece\u590d\u5236\uff0c\u90a3\u4e48\u5c31\u7b97\u4e3b\u5e93\u51fa\u73b0\u6545\u969c\uff0c\u4ece\u5e93\u4e5f\u80fd\u6b63\u5e38\u63d0\u4f9b\u670d\u52a1\uff0c\u5e76\u4e14\u8fd8\u53ef\u4ee5\u5b9e\u73b0\u8bfb\u5199\u5206\u79bb\u7b49\u64cd\u4f5c\u3002\u8fd9\u91cc\u6211\u4eec\u5c31\u4f7f\u7528\u4e24\u53f0\u4e3b\u673a\u6765\u642d\u5efa\u4e00\u4e3b\u4e00\u4ece\u7684\u73af\u5883\uff0c\u9996\u5148\u786e\u4fdd\u4e24\u53f0\u670d\u52a1\u5668\u90fd\u5b89\u88c5\u4e86MySQL\u6570\u636e\u5e93\u5e76\u4e14\u90fd\u5df2\u7ecf\u6b63\u5e38\u8fd0\u884c\u4e86\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u521b\u5efa\u5bf9\u5e94\u7684\u8d26\u53f7\uff0c\u4e00\u4f1a\u65b9\u4fbf\u4ece\u5e93\u8fdb\u884c\u8bbf\u95ee\u7684\u7528\u6237\uff1a</p> <pre><code>CREATE USER test identified with mysql_native_password by '123456';\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5f00\u542f\u4e00\u4e0b\u5916\u7f51\u8bbf\u95ee\uff1a</p> <pre><code>sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf\n</code></pre> <p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code># If MySQL is running as a replication slave, this should be\n# changed. Ref https://dev.mysql.com/doc/refman/8.0/en/server-system-variables.html#sysvar_tmpdir\n# tmpdir                = /tmp\n#\n# Instead of skip-networking the default is now to listen only on\n# localhost which is more compatible and is not less secure.\n# bind-address          = 127.0.0.1    \u8fd9\u91cc\u6ce8\u91ca\u6389\u5c31\u884c\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u91cd\u542f\u4e00\u4e0bMySQL\u670d\u52a1\uff1a</p> <pre><code>sudo systemctl restart mysql.service \n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u9996\u5148\u6765\u914d\u7f6e\u4e3b\u5e93\uff0c\u4e3b\u5e93\u53ea\u9700\u8981\u4e3a\u6211\u4eec\u521a\u521a\u521b\u5efa\u597d\u7684\u7528\u6237\u5206\u914d\u4e00\u4e2a\u4e3b\u4ece\u590d\u5236\u7684\u6743\u9650\u5373\u53ef\uff1a</p> <pre><code>grant replication slave on *.* to test;\nFLUSH PRIVILEGES;\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u8f93\u5165\u547d\u4ee4\u6765\u67e5\u770b\u4e3b\u5e93\u7684\u76f8\u5173\u60c5\u51b5\uff1a</p> <p></p> <p>\u8fd9\u6837\u4e3b\u5e93\u5c31\u642d\u5efa\u5b8c\u6210\u4e86\uff0c\u63a5\u7740\u6211\u4eec\u9700\u8981\u5c06\u4ece\u5e93\u8fdb\u884c\u914d\u7f6e\uff0c\u9996\u5148\u662f\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code># The following can be used as easy to replay backup logs or for replication.\n# note: if you are setting up a replication slave, see README.Debian about\n#       other settings you may need to change.\n# \u8fd9\u91cc\u9700\u8981\u5c06server-id\u914d\u7f6e\u4e3a\u5176\u4ed6\u7684\u503c\uff08\u9ed8\u8ba4\u662f1\uff09\u6240\u6709Mysql\u4e3b\u4ece\u5b9e\u4f8b\u7684id\u5fc5\u987b\u552f\u4e00\uff0c\u4e0d\u80fd\u6253\u67b6\uff0c\u4e0d\u7136\u4e00\u4f1a\u5f00\u542f\u4f1a\u5931\u8d25\nserver-id               = 2\n</code></pre> <p>\u8fdb\u5165\u6570\u636e\u5e93\uff0c\u8f93\u5165\uff1a</p> <pre><code>change replication source to SOURCE_HOST='192.168.0.8',SOURCE_USER='test',SOURCE_PASSWORD='123456',SOURCE_LOG_FILE='binlog.000004',SOURCE_LOG_POS=591;\n</code></pre> <p>\u6ce8\u610f\u540e\u9762\u7684logfile\u548cpos\u5c31\u662f\u6211\u4eec\u4e0a\u9762\u4ece\u4e3b\u5e93\u4e2d\u663e\u793a\u7684\u4fe1\u606f\u3002</p> <p></p> <p>\u6267\u884c\u5b8c\u6210\u540e\uff0c\u663e\u793aOK\u8868\u793a\u6ca1\u6709\u95ee\u9898\uff0c\u63a5\u7740\u8f93\u5165\uff1a</p> <pre><code>start replica;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u7684\u4ece\u673a\u5c31\u6b63\u5f0f\u542f\u52a8\u4e86\uff0c\u73b0\u5728\u6211\u4eec\u8f93\u5165\uff1a</p> <pre><code>show replica status\\G;\n</code></pre> <p>\u6765\u67e5\u770b\u5f53\u524d\u4ece\u673a\u72b6\u6001\uff0c\u53ef\u4ee5\u770b\u5230\uff1a</p> <p></p> <p>\u6700\u5173\u952e\u7684\u662f\u4e0b\u9762\u7684Replica_IO_Running\u548cReplica_SQL_Running\u5fc5\u987b\u540c\u65f6\u4e3aYes\u624d\u53ef\u4ee5\uff0c\u5b9e\u9645\u4e0a\u4ece\u5e93\u4f1a\u521b\u5efa\u4e24\u4e2a\u7ebf\u7a0b\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u8d1f\u8d23\u4e0e\u4e3b\u5e93\u8fdb\u884c\u901a\u4fe1\uff0c\u83b7\u53d6\u4e8c\u8fdb\u5236\u65e5\u5fd7\uff0c\u6682\u65f6\u5b58\u653e\u5230\u4e00\u4e2a\u4e2d\u95f4\u8868\uff08Relay_Log\uff09\u4e2d\uff0c\u800c\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u5219\u662f\u5c06\u4e2d\u95f4\u8868\u4fdd\u5b58\u7684\u4e8c\u8fdb\u5236\u65e5\u5fd7\u7684\u4fe1\u606f\u8fdb\u884c\u6267\u884c\uff0c\u7136\u540e\u63d2\u5165\u5230\u4ece\u5e93\u4e2d\u3002</p> <p>\u6700\u540e\u914d\u7f6e\u5b8c\u6210\uff0c\u6211\u4eec\u6765\u770b\u770b\u5728\u4e3b\u5e93\u8fdb\u884c\u64cd\u4f5c\u4f1a\u4e0d\u4f1a\u540c\u6b65\u5230\u4ece\u5e93\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5728\u4e3b\u5e93\u4e2d\u521b\u5efa\u7684\u6570\u636e\u5e93\uff0c\u88ab\u540c\u6b65\u5230\u4ece\u5e93\u4e2d\u4e86\uff0c\u6211\u4eec\u518d\u6765\u8bd5\u8bd5\u770b\u521b\u5efa\u8868\u548c\u63d2\u5165\u6570\u636e\uff1a</p> <pre><code>use yyds;\ncreate table test  (\n  `id` int primary key,\n  `name` varchar(255) NULL,\n  `passwd` varchar(255) NULL\n);\n</code></pre> <p></p> <p>\u73b0\u5728\u6211\u4eec\u968f\u4fbf\u63d2\u5165\u4e00\u70b9\u6570\u636e\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u7684MySQL\u4e3b\u4ece\u5c31\u642d\u5efa\u5b8c\u6210\u4e86\uff0c\u90a3\u4e48\u5982\u679c\u4e3b\u673a\u6b64\u65f6\u6302\u4e86\u4f1a\u600e\u4e48\u6837\uff1f</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230IO\u7ebf\u7a0b\u662f\u5904\u4e8e\u91cd\u8fde\u72b6\u6001\uff0c\u4f1a\u7b49\u5f85\u4e3b\u5e93\u91cd\u65b0\u6062\u590d\u8fd0\u884c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_10","title":"\u5206\u5e93\u5206\u8868","text":"<p>\u5728\u5927\u578b\u7684\u4e92\u8054\u7f51\u7cfb\u7edf\u4e2d\uff0c\u53ef\u80fd\u5355\u53f0MySQL\u7684\u5b58\u50a8\u5bb9\u91cf\u65e0\u6cd5\u6ee1\u8db3\u4e1a\u52a1\u7684\u9700\u6c42\uff0c\u8fd9\u65f6\u5019\u5c31\u9700\u8981\u8fdb\u884c\u6269\u5bb9\u4e86\u3002</p> <p>\u548c\u4e4b\u524d\u7684\u95ee\u9898\u4e00\u6837\uff0c\u5355\u53f0\u4e3b\u673a\u7684\u786c\u4ef6\u8d44\u6e90\u662f\u5b58\u5728\u74f6\u9888\u7684\uff0c\u4e0d\u53ef\u80fd\u65e0\u9650\u5236\u5730\u7eb5\u5411\u6269\u5c55\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u5f97\u901a\u8fc7\u591a\u53f0\u5b9e\u4f8b\u6765\u8fdb\u884c\u5bb9\u91cf\u7684\u6a2a\u5411\u6269\u5bb9\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6570\u636e\u5206\u6563\u5b58\u50a8\uff0c\u8ba9\u591a\u53f0\u4e3b\u673a\u5171\u540c\u6765\u4fdd\u5b58\u6570\u636e\u3002</p> <p>\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u600e\u4e48\u4e2a\u5206\u6563\u6cd5\uff1f</p> <ul> <li>\u5782\u76f4\u62c6\u5206\uff1a\u6211\u4eec\u7684\u8868\u548c\u6570\u636e\u5e93\u90fd\u53ef\u4ee5\u8fdb\u884c\u5782\u76f4\u62c6\u5206\uff0c\u6240\u8c13\u5782\u76f4\u62c6\u5206\uff0c\u5c31\u662f\u5c06\u6570\u636e\u5e93\u4e2d\u6240\u6709\u7684\u8868\uff0c\u6309\u7167\u4e1a\u52a1\u529f\u80fd\u62c6\u5206\u5230\u5404\u4e2a\u6570\u636e\u5e93\u4e2d\uff08\u662f\u4e0d\u662f\u611f\u89c9\u8ddf\u524d\u9762\u4e24\u7ae0\u7684\u5b66\u4e60\u7684\u67b6\u6784\u5bf9\u5e94\u8d77\u6765\u4e86\uff09\u800c\u5bf9\u4e8e\u4e00\u5f20\u8868\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5916\u952e\u4e4b\u7c7b\u7684\u673a\u5236\uff0c\u5c06\u5176\u62c6\u5206\u4e3a\u591a\u4e2a\u8868\u3002</li> </ul> <p></p> <ul> <li>\u6c34\u5e73\u62c6\u5206\uff1a\u6c34\u5e73\u62c6\u5206\u9488\u5bf9\u7684\u4e0d\u662f\u8868\uff0c\u800c\u662f\u6570\u636e\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9\u5f88\u591a\u4e2a\u5177\u6709\u76f8\u540c\u8868\u7684\u6570\u636e\u5e93\u5b58\u653e\u4e00\u90e8\u5206\u6570\u636e\uff0c\u76f8\u5f53\u4e8e\u662f\u5c06\u6570\u636e\u5206\u6563\u5b58\u50a8\u5728\u5404\u4e2a\u8282\u70b9\u4e0a\u3002</li> </ul> <p></p> <p>\u90a3\u4e48\u8981\u5b9e\u73b0\u8fd9\u6837\u7684\u62c6\u5206\u64cd\u4f5c\uff0c\u6211\u4eec\u81ea\u884c\u53bb\u7f16\u5199\u4ee3\u7801\u5de5\u4f5c\u91cf\u80af\u5b9a\u662f\u6bd4\u8f83\u5927\u7684\uff0c\u56e0\u6b64\u76ee\u524d\u5b9e\u9645\u4e0a\u5df2\u7ecf\u6709\u4e00\u4e9b\u89e3\u51b3\u65b9\u6848\u4e86\uff0c\u6bd4\u5982\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528MyCat\uff08\u4e5f\u662f\u4e00\u4e2a\u6570\u636e\u5e93\u4e2d\u95f4\u4ef6\uff0c\u76f8\u5f53\u4e8e\u6302\u4e86\u4e00\u5c42\u4ee3\u7406\uff0c\u518d\u901a\u8fc7MyCat\u8fdb\u884c\u5206\u5e93\u5206\u8868\u64cd\u4f5c\u6570\u636e\u5e93\uff0c\u53ea\u9700\u8981\u8fde\u63a5\u5c31\u80fd\u4f7f\u7528\uff0c\u7c7b\u4f3c\u7684\u8fd8\u6709ShardingSphere-Proxy\uff09\u6216\u662fSharding JDBC\uff08\u5e94\u7528\u7a0b\u5e8f\u4e2d\u76f4\u63a5\u5bf9SQL\u8bed\u53e5\u8fdb\u884c\u5206\u6790\uff0c\u7136\u540e\u8f6c\u6362\u6210\u5206\u5e93\u5206\u8868\u64cd\u4f5c\uff0c\u9700\u8981\u6211\u4eec\u81ea\u5df1\u7f16\u5199\u4e00\u4e9b\u903b\u8f91\u4ee3\u7801\uff09\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u8bb2\u89e3\u4e00\u4e0bSharding JDBC\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#sharding-jdbc","title":"Sharding JDBC","text":"<p>\u5b98\u65b9\u6587\u6863\uff08\u4e2d\u6587\uff09\uff1ahttps://shardingsphere.apache.org/document/5.1.0/cn/overview/#shardingsphere-jdbc</p> <p>\u5b9a\u4f4d\u4e3a\u8f7b\u91cf\u7ea7 Java \u6846\u67b6\uff0c\u5728 Java \u7684 JDBC \u5c42\u63d0\u4f9b\u7684\u989d\u5916\u670d\u52a1\uff0c\u5b83\u4f7f\u7528\u5ba2\u6237\u7aef\u76f4\u8fde\u6570\u636e\u5e93\uff0c\u4ee5 jar \u5305\u5f62\u5f0f\u63d0\u4f9b\u670d\u52a1\uff0c\u65e0\u9700\u989d\u5916\u90e8\u7f72\u548c\u4f9d\u8d56\uff0c\u53ef\u7406\u89e3\u4e3a\u589e\u5f3a\u7248\u7684 JDBC \u9a71\u52a8\uff0c\u5b8c\u5168\u517c\u5bb9 JDBC \u548c\u5404\u79cd ORM \u6846\u67b6\u3002</p> <ul> <li>\u9002\u7528\u4e8e\u4efb\u4f55\u57fa\u4e8e JDBC \u7684 ORM \u6846\u67b6\uff0c\u5982\uff1aJPA, Hibernate, Mybatis, Spring JDBC Template \u6216\u76f4\u63a5\u4f7f\u7528 JDBC\uff1b</li> <li>\u652f\u6301\u4efb\u4f55\u7b2c\u4e09\u65b9\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u5982\uff1aDBCP, C3P0, BoneCP, HikariCP \u7b49\uff1b</li> <li>\u652f\u6301\u4efb\u610f\u5b9e\u73b0 JDBC \u89c4\u8303\u7684\u6570\u636e\u5e93\uff0c\u76ee\u524d\u652f\u6301 MySQL\uff0cPostgreSQL\uff0cOracle\uff0cSQLServer \u4ee5\u53ca\u4efb\u4f55\u53ef\u4f7f\u7528 JDBC \u8bbf\u95ee\u7684\u6570\u636e\u5e93\u3002</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u4e3b\u8981\u6f14\u793a\u4e00\u4e0b\u6c34\u5e73\u5206\u8868\u65b9\u5f0f\uff0c\u6211\u4eec\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684SpringBoot\u9879\u76ee\u5373\u53ef\uff0c\u4f9d\u8d56\u5982\u4e0b\uff1a</p> <pre><code>&lt;dependencies&gt;\n    &lt;!--  ShardingJDBC\u4f9d\u8d56\uff0c\u90a3\u5fc5\u987b\u5b89\u6392\u6700\u65b0\u7248\u554a\uff0c\u5e0c\u671b\u4f60\u4eec\u770b\u89c6\u9891\u7684\u65f6\u5019\u8fd8\u662f5.X\u7248\u672c  --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.apache.shardingsphere&lt;/groupId&gt;\n        &lt;artifactId&gt;shardingsphere-jdbc-core-spring-boot-starter&lt;/artifactId&gt;\n        &lt;version&gt;5.1.0&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;\n        &lt;version&gt;2.2.2&lt;/version&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n        &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n        &lt;optional&gt;true&lt;/optional&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre> <p>\u6570\u636e\u5e93\u6211\u4eec\u8fd9\u91cc\u76f4\u63a5\u7528\u4e0a\u8282\u8bfe\u7684\u5373\u53ef\uff0c\u56e0\u4e3a\u53ea\u9700\u8981\u4e24\u4e2a\u8868\u7ed3\u6784\u4e00\u6837\u7684\u6570\u636e\u5e93\u5373\u53ef\uff0c\u6b63\u597d\u4e0a\u8282\u8bfe\u8fdb\u884c\u4e86\u540c\u6b65\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u628a\u4ece\u5e93\u53d8\u56de\u6b63\u5e38\u72b6\u6001\u5c31\u53ef\u4ee5\u4e86\uff1a</p> <pre><code>stop replica;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u628a\u4e24\u4e2a\u8868\u7684root\u7528\u6237\u5bc6\u7801\u6539\u4e00\u4e0b\uff0c\u4e00\u4f1a\u7528\u8fd9\u4e2a\u7528\u6237\u8fde\u63a5\u6570\u636e\u5e93\uff1a</p> <pre><code>update user set authentication_string='' where user='root';\nupdate user set host = '%' where user = 'root';\nalter user root identified with mysql_native_password by '123456';\nFLUSH PRIVILEGES;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u770b\uff0c\u5982\u679c\u76f4\u63a5\u5c1d\u8bd5\u5f00\u542f\u670d\u52a1\u5668\uff0c\u90a3\u80af\u5b9a\u662f\u5f00\u4e0d\u4e86\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u8981\u914d\u7f6e\u6570\u636e\u6e90\uff1a</p> <p></p> <p>\u90a3\u4e48\u6570\u636e\u6e90\u8be5\u600e\u4e48\u914d\u7f6e\u5462\uff1f\u73b0\u5728\u6211\u4eec\u662f\u4e00\u4e2a\u5206\u5e93\u5206\u8868\u7684\u72b6\u6001\uff0c\u9700\u8981\u914d\u7f6e\u4e24\u4e2a\u6570\u636e\u6e90\uff1a</p> <pre><code>spring:\n  shardingsphere:\n    datasource:\n      # \u6709\u51e0\u4e2a\u6570\u636e\u5c31\u914d\u51e0\u4e2a\uff0c\u8fd9\u91cc\u662f\u540d\u79f0\uff0c\u6309\u7167\u4e0b\u9762\u7684\u683c\u5f0f\uff0c\u540d\u79f0+\u6570\u5b57\u7684\u5f62\u5f0f\n      names: db0,db1\n      # \u4e3a\u6bcf\u4e2a\u6570\u636e\u6e90\u5355\u72ec\u8fdb\u884c\u914d\u7f6e\n      db0:\n        # \u6570\u636e\u6e90\u5b9e\u73b0\u7c7b\uff0c\u8fd9\u91cc\u4f7f\u7528\u9ed8\u8ba4\u7684HikariDataSource\n        type: com.zaxxer.hikari.HikariDataSource\n        # \u6570\u636e\u5e93\u9a71\u52a8\n        driver-class-name: com.mysql.cj.jdbc.Driver\n        # \u4e0d\u7528\u6211\u591a\u8bf4\u4e86\u5427\n        jdbc-url: jdbc:mysql://192.168.0.8:3306/yyds\n        username: root\n        password: 123456\n      db1:\n        type: com.zaxxer.hikari.HikariDataSource\n        driver-class-name: com.mysql.cj.jdbc.Driver\n        jdbc-url: jdbc:mysql://192.168.0.13:3306/yyds\n        username: root\n        password: 123456\n</code></pre> <p>\u5982\u679c\u542f\u52a8\u6ca1\u6709\u95ee\u9898\uff0c\u90a3\u4e48\u5c31\u662f\u914d\u7f6e\u6210\u529f\u4e86\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5bf9\u9879\u76ee\u8fdb\u884c\u4e00\u4e9b\u7f16\u5199\uff0c\u6dfb\u52a0\u6211\u4eec\u7684\u7528\u6237\u5b9e\u4f53\u7c7b\u548cMapper\uff1a</p> <pre><code>@Data\n@AllArgsConstructor\npublic class User {\n    int id;\n    String name;\n    String passwd;\n}\n</code></pre> <pre><code>@Mapper\npublic interface UserMapper {\n\n    @Select(\"select * from test where id = #{id}\")\n    User getUserById(int id);\n\n    @Insert(\"insert into test(id, name, passwd) values(#{id}, #{name}, #{passwd})\")\n    int addUser(User user);\n}\n</code></pre> <p>\u5b9e\u9645\u4e0a\u8fd9\u4e9b\u64cd\u4f5c\u90fd\u662f\u5e38\u89c4\u64cd\u4f5c\uff0c\u5728\u7f16\u5199\u4ee3\u7801\u65f6\u5173\u6ce8\u70b9\u4f9d\u7136\u653e\u5728\u4e1a\u52a1\u672c\u8eab\u4e0a\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u6765\u7f16\u5199\u914d\u7f6e\u6587\u4ef6\uff0c\u6211\u4eec\u9700\u8981\u544a\u8bc9ShardingJDBC\u8981\u5982\u4f55\u8fdb\u884c\u5206\u7247\uff0c\u9996\u5148\u660e\u786e\uff1a\u73b0\u5728\u662f\u4e24\u4e2a\u6570\u636e\u5e93\u90fd\u6709test\u8868\u5b58\u653e\u7528\u6237\u6570\u636e\uff0c\u6211\u4eec\u76ee\u6807\u662f\u5c06\u7528\u6237\u4fe1\u606f\u5206\u522b\u5b58\u653e\u5230\u8fd9\u4e24\u4e2a\u6570\u636e\u5e93\u7684\u8868\u4e2d\u3002</p> <p>\u4e0d\u5e9f\u8bdd\u4e86\uff0c\u76f4\u63a5\u4e0a\u914d\u7f6e\uff1a</p> <pre><code>spring:\n  shardingsphere:\n    rules:\n      sharding:\n        tables:\n            #\u8fd9\u91cc\u586b\u5199\u8868\u540d\u79f0\uff0c\u7a0b\u5e8f\u4e2d\u5bf9\u8fd9\u5f20\u8868\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u90fd\u4f1a\u91c7\u7528\u4e0b\u9762\u7684\u8def\u7531\u65b9\u6848\n            #\u6bd4\u5982\u6211\u4eec\u4e0a\u9762Mybatis\u5c31\u662f\u5bf9test\u8868\u8fdb\u884c\u64cd\u4f5c\uff0c\u6240\u4ee5\u4f1a\u8d70\u4e0b\u9762\u7684\u8def\u7531\u65b9\u6848\n          test:\n            #\u8fd9\u91cc\u586b\u5199\u5b9e\u9645\u7684\u8def\u7531\u8282\u70b9\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u8981\u5206\u4e24\u4e2a\u5e93\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u628a\u4e24\u4e2a\u5e93\u90fd\u5199\u4e0a\uff0c\u4ee5\u53ca\u5bf9\u5e94\u7684\u8868\n            #\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8868\u8fbe\u5f0f\uff0c\u6bd4\u5982\u4e0b\u9762\u7684\u53ef\u4ee5\u7b80\u5199\u4e3a db$-&gt;{0..1}.test\n            actual-data-nodes: db0.test,db1.test\n            #\u8fd9\u91cc\u662f\u5206\u5e93\u7b56\u7565\u914d\u7f6e\n            database-strategy:\n                #\u8fd9\u91cc\u9009\u62e9\u6807\u51c6\u7b56\u7565\uff0c\u4e5f\u53ef\u4ee5\u914d\u7f6e\u590d\u6742\u7b56\u7565\uff0c\u57fa\u4e8e\u591a\u4e2a\u952e\u8fdb\u884c\u5206\u7247\n              standard:\n                #\u53c2\u4e0e\u5206\u7247\u8fd0\u7b97\u7684\u5b57\u6bb5\uff0c\u4e0b\u9762\u7684\u7b97\u6cd5\u4f1a\u6839\u636e\u8fd9\u91cc\u63d0\u4f9b\u7684\u5b57\u6bb5\u8fdb\u884c\u8fd0\u7b97\n                sharding-column: id\n                #\u8fd9\u91cc\u586b\u5199\u6211\u4eec\u4e0b\u9762\u81ea\u5b9a\u4e49\u7684\u7b97\u6cd5\u540d\u79f0\n                sharding-algorithm-name: my-alg\n        sharding-algorithms:\n            #\u81ea\u5b9a\u4e49\u4e00\u4e2a\u65b0\u7684\u7b97\u6cd5\uff0c\u540d\u79f0\u968f\u610f\n          my-alg:\n            #\u7b97\u6cd5\u7c7b\u578b\uff0c\u5b98\u65b9\u5185\u7f6e\u4e86\u5f88\u591a\u79cd\uff0c\u8fd9\u91cc\u6f14\u793a\u6700\u7b80\u5355\u7684\u4e00\u79cd\n            type: MOD\n            props:\n              sharding-count: 2\n    props:\n        #\u5f00\u542f\u65e5\u5fd7\uff0c\u4e00\u4f1a\u65b9\u4fbf\u6211\u4eec\u89c2\u5bdf\n            sql-show: true\n</code></pre> <p>\u5176\u4e2d\uff0c\u5206\u7247\u7b97\u6cd5\u6709\u5f88\u591a\u5185\u7f6e\u7684\uff0c\u53ef\u4ee5\u5728\u8fd9\u91cc\u67e5\u8be2\uff1ahttps://shardingsphere.apache.org/document/5.1.0/cn/user-manual/shardingsphere-jdbc/builtin-algorithm/sharding/\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u7684\u662fMOD\uff0c\u4e5f\u5c31\u662f\u53d6\u6a21\u5206\u7247\u7b97\u6cd5\uff0c\u5b83\u4f1a\u6839\u636e\u4e3b\u952e\u7684\u503c\u8fdb\u884c\u53d6\u6a21\u8fd0\u7b97\uff0c\u6bd4\u5982\u6211\u4eec\u8fd9\u91cc\u586b\u5199\u7684\u662f2\uff0c\u90a3\u4e48\u5c31\u8868\u793a\u5bf9\u4e3b\u952e\u8fdb\u884c\u6a212\u8fd0\u7b97\uff0c\u6839\u636e\u6570\u636e\u6e90\u7684\u540d\u79f0\uff0c\u6bd4\u5982db0\u5c31\u662f\u53d6\u6a21\u540e\u4e3a0\uff0cdb1\u5c31\u662f\u53d6\u6a21\u540e\u4e3a1\uff08\u5b98\u65b9\u6587\u6863\u63cf\u8ff0\u7684\u5e76\u4e0d\u662f\u5f88\u6e05\u695a\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6700\u7ec8\u5b9e\u73b0\u7684\u6548\u679c\u5c31\u662f\u5355\u6570\u653e\u5728<code>db1</code>\uff0c\u53cc\u6570\u653e\u5728<code>db0</code>\uff0c\u5f53\u7136\u5b83\u8fd8\u652f\u6301\u4e00\u4e9b\u5176\u4ed6\u7684\u7b97\u6cd5\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u4ecb\u7ecd\u4e86\u3002</p> <p>\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u7f16\u5199\u4e00\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u6765\u770b\u770b\uff0c\u662f\u5426\u80fd\u591f\u6309\u7167\u6211\u4eec\u4e0a\u9762\u7684\u89c4\u5219\u8fdb\u884c\u8def\u7531\uff1a</p> <pre><code>@SpringBootTest\nclass ShardingJdbcTestApplicationTests {\n\n    @Resource\n    UserMapper mapper;\n\n    @Test\n    void contextLoads() {\n        for (int i = 0; i &lt; 10; i++) {\n            //\u8fd9\u91ccID\u81ea\u52a8\u751f\u62101-10\uff0c\u7136\u540e\u63d2\u5165\u6570\u636e\u5e93\n            mapper.addUser(new User(i, \"xxx\", \"ccc\"));   \n        }\n    }\n\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u8fd0\u884c\u4e86\uff1a</p> <p></p> <p>\u6d4b\u8bd5\u901a\u8fc7\uff0c\u6211\u4eec\u6765\u770b\u770b\u6570\u636e\u5e93\u91cc\u9762\u662f\u4e0d\u662f\u6309\u7167\u6211\u4eec\u7684\u89c4\u5219\u8fdb\u884c\u6570\u636e\u63d2\u5165\u7684\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e24\u5f20\u8868\uff0c\u90fd\u6210\u529f\u6309\u7167\u6211\u4eec\u6307\u5b9a\u7684\u8def\u7531\u89c4\u5219\u8fdb\u884c\u63d2\u5165\u4e86\uff0c\u6211\u4eec\u6765\u770b\u770b\u8be6\u7ec6\u7684\u8def\u7531\u60c5\u51b5\uff0c\u901a\u8fc7\u63a7\u5236\u53f0\u8f93\u51fa\u7684SQL\u5c31\u53ef\u4ee5\u770b\u5230\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6240\u6709\u7684SQL\u8bed\u53e5\u90fd\u6709\u4e00\u4e2aLogic SQL\uff08\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u5728Mybatis\u91cc\u9762\u5199\u7684\uff0c\u662f\u4ec0\u4e48\u5c31\u662f\u4ec0\u4e48\uff09\u7d27\u63a5\u7740\u4e0b\u9762\u5c31\u662fActual SQL\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e2a\u903b\u8f91SQL\u6700\u7ec8\u4f1a\u6839\u636e\u6211\u4eec\u7684\u7b56\u7565\u8f6c\u6362\u4e3a\u5b9e\u9645SQL\uff0c\u6bd4\u5982\u7b2c\u4e00\u6761\u6570\u636e\uff0c\u5b83\u7684id\u662f0\uff0c\u90a3\u4e48\u5b9e\u9645\u8f6c\u6362\u51fa\u6765\u7684SQL\u4f1a\u5728db0\u8fd9\u4e2a\u6570\u636e\u6e90\u8fdb\u884c\u63d2\u5165\u3002</p> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u5f88\u8f7b\u677e\u5730\u5b9e\u73b0\u4e86\u5206\u5e93\u7b56\u7565\u3002</p> <p>\u5206\u5e93\u5b8c\u6210\u4e4b\u540e\uff0c\u63a5\u7740\u6211\u4eec\u6765\u770b\u5206\u8868\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u7684\u6570\u636e\u5e93\u4e2d\u6709<code>test_0</code>\u548c<code>test_1</code>\u4e24\u5f20\u8868\uff0c\u8868\u7ed3\u6784\u4e00\u6837\uff0c\u4f46\u662f\u6211\u4eec\u4e5f\u662f\u5e0c\u671b\u80fd\u591f\u6839\u636eid\u53d6\u6a21\u8fd0\u7b97\u7684\u7ed3\u679c\u5206\u522b\u653e\u5230\u8fd9\u4e24\u4e2a\u4e0d\u540c\u7684\u8868\u4e2d\uff0c\u5b9e\u73b0\u601d\u8def\u5176\u5b9e\u662f\u5dee\u4e0d\u591a\u7684\uff0c\u8fd9\u91cc\u9996\u5148\u9700\u8981\u4ecb\u7ecd\u4e00\u4e0b\u4e24\u79cd\u8868\u6982\u5ff5\uff1a</p> <ul> <li>\u903b\u8f91\u8868\uff1a\u76f8\u540c\u7ed3\u6784\u7684\u6c34\u5e73\u62c6\u5206\u6570\u636e\u5e93\uff08\u8868\uff09\u7684\u903b\u8f91\u540d\u79f0\uff0c\u662f SQL \u4e2d\u8868\u7684\u903b\u8f91\u6807\u8bc6\u3002 \u4f8b\uff1a\u8ba2\u5355\u6570\u636e\u6839\u636e\u4e3b\u952e\u5c3e\u6570\u62c6\u5206\u4e3a 10 \u5f20\u8868\uff0c\u5206\u522b\u662f <code>t_order_0</code> \u5230 <code>t_order_9</code>\uff0c\u4ed6\u4eec\u7684\u903b\u8f91\u8868\u540d\u4e3a <code>t_order</code></li> <li>\u771f\u5b9e\u8868\uff1a\u5728\u6c34\u5e73\u62c6\u5206\u7684\u6570\u636e\u5e93\u4e2d\u771f\u5b9e\u5b58\u5728\u7684\u7269\u7406\u8868\u3002 \u5373\u4e0a\u4e2a\u793a\u4f8b\u4e2d\u7684 <code>t_order_0</code> \u5230 <code>t_order_9</code></li> </ul> <p>\u73b0\u5728\u6211\u4eec\u5c31\u4ee5\u4e00\u53f7\u6570\u636e\u5e93\u4e3a\u4f8b\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u91cc\u9762\u521b\u5efa\u4e0a\u9762\u63d0\u5230\u7684\u4e24\u5f20\u8868\uff0c\u4e4b\u524d\u7684\u90a3\u4e2a<code>test</code>\u8868\u5220\u4e0d\u5220\u90fd\u53ef\u4ee5\uff0c\u5c31\u5f53\u505a\u4e0d\u5b58\u5728\u5c31\u884c\u4e86\uff1a</p> <pre><code>create table test_0  (\n  `id` int primary key,\n  `name` varchar(255) NULL,\n  `passwd` varchar(255) NULL\n);\n\ncreate table test_1  (\n  `id` int primary key,\n  `name` varchar(255) NULL,\n  `passwd` varchar(255) NULL\n);\n</code></pre> <p></p> <p>\u63a5\u7740\u6211\u4eec\u4e0d\u8981\u53bb\u4fee\u6539\u4efb\u4f55\u7684\u4e1a\u52a1\u4ee3\u7801\uff0cMybatis\u91cc\u9762\u5199\u7684\u662f\u4ec0\u4e48\u4f9d\u7136\u4fdd\u6301\u539f\u6837\uff0c\u5373\u4f7f\u6211\u4eec\u7684\u8868\u540d\u5df2\u7ecf\u53d8\u4e86\uff0c\u6211\u4eec\u9700\u8981\u505a\u7684\u662f\u901a\u8fc7\u8def\u7531\u6765\u4fee\u6539\u539f\u6709\u7684SQL\uff0c\u914d\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>spring:\n  shardingsphere:\n    rules:\n      sharding:\n        tables:\n          test:\n            actual-data-nodes: db0.test_$-&gt;{0..1}\n            #\u73b0\u5728\u6211\u4eec\u6765\u914d\u7f6e\u4e00\u4e0b\u5206\u8868\u7b56\u7565\uff0c\u6ce8\u610f\u8fd9\u91cc\u662ftable-strategy\u4e0a\u9762\u662fdatabase-strategy\n            table-strategy:\n                #\u57fa\u672c\u90fd\u8ddf\u4e4b\u524d\u662f\u4e00\u6837\u7684\n              standard:\n                sharding-column: id\n                sharding-algorithm-name: my-alg\n        sharding-algorithms:\n          my-alg:\n            #\u8fd9\u91cc\u6211\u4eec\u6f14\u793a\u4e00\u4e0bINLINE\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u884c\u7f16\u5199\u8868\u8fbe\u5f0f\u6765\u51b3\u5b9a\n            type: INLINE\n            props:\n                #\u6bd4\u5982\u6211\u4eec\u8fd8\u662f\u5e0c\u671b\u8fdb\u884c\u6a212\u8ba1\u7b97\u5f97\u5230\u6570\u636e\u8be5\u53bb\u7684\u8868\n                #\u53ea\u9700\u8981\u7ed9\u4e00\u4e2a\u6700\u7ec8\u7684\u8868\u540d\u79f0\u5c31\u884c\u4e86test_\uff0c\u540e\u9762\u7684\u6570\u5b57\u662f\u8868\u8fbe\u5f0f\u53d6\u6a21\u7b97\u51fa\u7684\n                #\u5b9e\u9645\u4e0a\u8fd9\u6837\u5199\u548cMOD\u6a21\u5f0f\u4e00\u6a21\u4e00\u6837\n              algorithm-expression: test_$-&gt;{id % 2}\n              #\u6ca1\u9519\uff0c\u67e5\u8be2\u4e5f\u4f1a\u6839\u636e\u5206\u7247\u7b56\u7565\u6765\u8fdb\u884c\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u4f7f\u7528\u7684\u662f\u8303\u56f4\u67e5\u8be2\uff0c\u90a3\u4e48\u4f9d\u7136\u4f1a\u8fdb\u884c\u5168\u91cf\u67e5\u8be2\n              #\u8fd9\u4e2a\u6211\u4eec\u540e\u9762\u7d27\u63a5\u7740\u4f1a\u8bb2\uff0c\u8fd9\u91cc\u5148\u5199\u4e0a\u5427\n              allow-range-query-with-inline-sharding: false\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u770b\u770b\u4f1a\u4e0d\u4f1a\u6309\u7167\u6211\u4eec\u7684\u7b56\u7565\u8fdb\u884c\u5206\u8868\u63d2\u5165\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6839\u636e\u6211\u4eec\u7684\u7b97\u6cd5\uff0c\u539f\u672c\u7684\u903b\u8f91\u8868\u88ab\u4fee\u6539\u4e3a\u4e86\u6700\u7ec8\u8fdb\u884c\u5206\u8868\u8ba1\u7b97\u540e\u7684\u7ed3\u679c\uff0c\u6211\u4eec\u6765\u67e5\u770b\u4e00\u4e0b\u6570\u636e\u5e93\uff1a</p> <p></p> <p>\u63d2\u5165\u6211\u4eec\u4e86\u89e3\u5b8c\u6bd5\u4e86\uff0c\u6211\u4eec\u6765\u770b\u770b\u67e5\u8be2\u5462\uff1a</p> <pre><code>@SpringBootTest\nclass ShardingJdbcTestApplicationTests {\n\n    @Resource\n    UserMapper mapper;\n\n    @Test\n    void contextLoads() {\n        System.out.println(mapper.getUserById(0));\n        System.out.println(mapper.getUserById(1));\n    }\n\n}\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6839\u636e\u6211\u4eec\u914d\u7f6e\u7684\u7b56\u7565\uff0c\u67e5\u8be2\u4e5f\u4f1a\u81ea\u52a8\u9009\u62e9\u5bf9\u5e94\u7684\u8868\u8fdb\u884c\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u6709\u5185\u5473\u4e86\u3002</p> <p>\u90a3\u4e48\u5982\u679c\u662f\u8303\u56f4\u67e5\u8be2\u5462\uff1f</p> <pre><code>@Select(\"select * from test where id between #{start} and #{end}\")\nList&lt;User&gt; getUsersByIdRange(int start, int end);\n</code></pre> <pre><code>@SpringBootTest\nclass ShardingJdbcTestApplicationTests {\n\n    @Resource\n    UserMapper mapper;\n\n    @Test\n    void contextLoads() {\n        System.out.println(mapper.getUsersByIdRange(3, 5));\n    }\n\n}\n</code></pre> <p>\u6211\u4eec\u6765\u770b\u770b\u6267\u884c\u7ed3\u679c\u4f1a\u600e\u4e48\u6837\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230INLINE\u7b97\u6cd5\u9ed8\u8ba4\u662f\u4e0d\u652f\u6301\u8fdb\u884c\u5168\u91cf\u67e5\u8be2\u7684\uff0c\u6211\u4eec\u5f97\u5c06\u4e0a\u9762\u7684\u914d\u7f6e\u9879\u6539\u6210true\uff1a</p> <pre><code>allow-range-query-with-inline-sharding: true\n</code></pre> <p>\u518d\u6b21\u8fdb\u884c\u6d4b\u8bd5\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6700\u7ec8\u51fa\u6765\u7684SQL\u8bed\u53e5\u662f\u76f4\u63a5\u5bf9\u4e24\u4e2a\u8868\u90fd\u8fdb\u884c\u67e5\u8be2\uff0c\u7136\u540e\u6c42\u51fa\u4e00\u4e2a\u5e76\u96c6\u51fa\u6765\u4f5c\u4e3a\u6700\u540e\u7684\u7ed3\u679c\u3002</p> <p>\u5f53\u7136\u9664\u4e86\u5206\u7247\u4e4b\u5916\uff0c\u8fd8\u6709\u5e7f\u64ad\u8868\u548c\u7ed1\u5b9a\u8868\u673a\u5236\uff0c\u7528\u4e8e\u591a\u79cd\u4e1a\u52a1\u573a\u666f\u4e0b\uff0c\u8fd9\u91cc\u5c31\u4e0d\u591a\u505a\u4ecb\u7ecd\u4e86\uff0c\u8be6\u7ec6\u8bf7\u67e5\u9605\u5b98\u65b9\u6587\u6863\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_11","title":"\u5206\u5e03\u5f0f\u5e8f\u5217\u7b97\u6cd5","text":"<p>\u524d\u9762\u6211\u4eec\u8bb2\u89e3\u4e86\u5982\u4f55\u8fdb\u884c\u5206\u5e93\u5206\u8868\uff0c\u63a5\u7740\u6211\u4eec\u6765\u770b\u770b\u5206\u5e03\u5f0f\u5e8f\u5217\u7b97\u6cd5\u3002</p> <p>\u5728\u590d\u6742\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\uff0c\u7279\u522b\u662f\u5fae\u670d\u6784\u67b6\u4e2d\uff0c\u5f80\u5f80\u9700\u8981\u5bf9\u5927\u91cf\u7684\u6570\u636e\u548c\u6d88\u606f\u8fdb\u884c\u552f\u4e00\u6807\u8bc6\u3002\u968f\u7740\u7cfb\u7edf\u7684\u590d\u6742\uff0c\u6570\u636e\u7684\u589e\u591a\uff0c\u5206\u5e93\u5206\u8868\u6210\u4e3a\u4e86\u5e38\u89c1\u7684\u65b9\u6848\uff0c\u5bf9\u6570\u636e\u5206\u5e93\u5206\u8868\u540e\u9700\u8981\u6709\u4e00\u4e2a\u552f\u4e00ID\u6765\u6807\u8bc6\u4e00\u6761\u6570\u636e\u6216\u6d88\u606f\uff08\u5982\u8ba2\u5355\u53f7\u3001\u4ea4\u6613\u6d41\u6c34\u3001\u4e8b\u4ef6\u7f16\u53f7\u7b49\uff09\uff0c\u6b64\u65f6\u4e00\u4e2a\u80fd\u591f\u751f\u6210\u5168\u5c40\u552f\u4e00ID\u7684\u7cfb\u7edf\u662f\u975e\u5e38\u5fc5\u8981\u7684\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u4e4b\u524d\u521b\u5efa\u8fc7\u5b66\u751f\u4fe1\u606f\u8868\u3001\u56fe\u4e66\u501f\u9605\u8868\u3001\u56fe\u4e66\u7ba1\u7406\u8868\uff0c\u6240\u6709\u7684\u4fe1\u606f\u90fd\u4f1a\u6709\u4e00\u4e2aID\u4f5c\u4e3a\u4e3b\u952e\uff0c\u5e76\u4e14\u8fd9\u4e2aID\u6709\u4ee5\u4e0b\u8981\u6c42\uff1a</p> <ul> <li>\u4e3a\u4e86\u533a\u522b\u4e8e\u5176\u4ed6\u7684\u6570\u636e\uff0c\u8fd9\u4e2aID\u5fc5\u987b\u662f\u5168\u5c40\u552f\u4e00\u7684\u3002</li> <li>\u4e3b\u952e\u5e94\u8be5\u5c3d\u53ef\u80fd\u7684\u4fdd\u6301\u6709\u5e8f\uff0c\u8fd9\u6837\u4f1a\u5927\u5927\u63d0\u5347\u7d22\u5f15\u7684\u67e5\u8be2\u6548\u7387\u3002</li> </ul> <p>\u90a3\u4e48\u6211\u4eec\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e0b\uff0c\u5982\u4f55\u4fdd\u8bc1ID\u7684\u751f\u6210\u6ee1\u8db3\u4e0a\u9762\u7684\u9700\u6c42\u5462\uff1f</p> <ol> <li>\u4f7f\u7528UUID\uff1aUUID\u662f\u7531\u4e00\u7ec432\u4f4d\u6570\u768416\u8fdb\u5236\u6570\u5b57\u968f\u673a\u6784\u6210\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528JDK\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684UUID\u7c7b\u6765\u521b\u5efa\uff1a</li> </ol> <pre><code>public static void main(String[] args) {\n    String uuid = UUID.randomUUID().toString();\n    System.out.println(uuid);\n}\n</code></pre> <p>\u7ed3\u679c\u4e3a<code>73d5219b-dc0f-4282-ac6e-8df17bcd5860</code>\uff0c\u751f\u6210\u901f\u5ea6\u975e\u5e38\u5feb\uff0c\u53ef\u4ee5\u770b\u5230\u786e\u5b9e\u662f\u80fd\u591f\u4fdd\u8bc1\u552f\u4e00\u6027\uff0c\u56e0\u4e3a\u6bcf\u6b21\u90fd\u4e0d\u4e00\u6837\uff0c\u800c\u4e14\u8fd9\u4e48\u957f\u4e00\u4e32\u90a3\u91cd\u590d\u7684\u6982\u7387\u771f\u7684\u662f\u5c0f\u7684\u53ef\u601c\u3002</p> <p>\u4f46\u662f\u5b83\u5e76\u4e0d\u6ee1\u8db3\u6211\u4eec\u4e0a\u9762\u7684\u7b2c\u4e8c\u4e2a\u8981\u6c42\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u9700\u8981\u5c3d\u53ef\u80fd\u7684\u4fdd\u8bc1\u6709\u5e8f\uff0c\u800c\u8fd9\u91cc\u6211\u4eec\u5f97\u5230\u7684\u90fd\u662f\u4e00\u4e9b\u65e0\u5e8f\u7684ID\u3002</p> <ol> <li>\u96ea\u82b1\u7b97\u6cd5\uff08Snowflake\uff09\uff1a</li> </ol> <p>\u6211\u4eec\u6765\u770b\u96ea\u82b1\u7b97\u6cd5\uff0c\u5b83\u4f1a\u751f\u6210\u4e00\u4e2a\u4e00\u4e2a64bit\u5927\u5c0f\u7684\u6574\u578b\u7684ID\uff0cint\u80af\u5b9a\u662f\u88c5\u4e0d\u4e0b\u4e86\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5b83\u4e3b\u8981\u662f\u4e09\u4e2a\u90e8\u5206\u7ec4\u6210\uff0c\u65f6\u95f4+\u5de5\u4f5c\u673a\u5668ID+\u5e8f\u5217\u53f7\uff0c\u65f6\u95f4\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff0c41\u4e2abit\u4f4d\u80fd\u8868\u793a\u7ea670\u5e74\u7684\u65f6\u95f4\uff0c\u65f6\u95f4\u7eaa\u5143\u4ece2016\u5e7411\u67081\u65e5\u96f6\u70b9\u5f00\u59cb\uff0c\u53ef\u4ee5\u4f7f\u7528\u52302086\u5e74\uff0c\u5de5\u4f5c\u673a\u5668ID\u5176\u5b9e\u5c31\u662f\u8282\u70b9ID\uff0c\u6bcf\u4e2a\u8282\u70b9\u7684ID\u90fd\u4e0d\u76f8\u540c\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u533a\u5206\u51fa\u6765\uff0c10\u4e2abit\u4f4d\u53ef\u4ee5\u8868\u793a\u6700\u591a1024\u4e2a\u8282\u70b9\uff0c\u6700\u540e12\u4f4d\u5c31\u662f\u6bcf\u4e2a\u8282\u70b9\u4e0b\u7684\u5e8f\u5217\u53f7\uff0c\u56e0\u6b64\u6bcf\u53f0\u673a\u5668\u6bcf\u6beb\u79d2\u5c31\u53ef\u4ee5\u67094096\u4e2a\u7cfb\u5217\u53f7\u3002</p> <p>\u8fd9\u6837\uff0c\u5b83\u5c31\u517c\u5177\u4e86\u4e0a\u9762\u6240\u8bf4\u7684\u552f\u4e00\u6027\u548c\u6709\u5e8f\u6027\u4e86\uff0c\u4f46\u662f\u4f9d\u7136\u662f\u6709\u7f3a\u70b9\u7684\uff0c\u7b2c\u4e00\u4e2a\u662f\u65f6\u95f4\u95ee\u9898\uff0c\u5982\u679c\u673a\u5668\u65f6\u95f4\u51fa\u73b0\u5012\u9000\uff0c\u90a3\u4e48\u5c31\u4f1a\u5bfc\u81f4\u751f\u6210\u91cd\u590d\u7684ID\uff0c\u5e76\u4e14\u8282\u70b9\u5bb9\u91cf\u53ea\u67091024\u4e2a\uff0c\u5982\u679c\u662f\u8d85\u5927\u89c4\u6a21\u96c6\u7fa4\uff0c\u4e5f\u662f\u5b58\u5728\u9690\u60a3\u7684\u3002</p> <p>ShardingJDBC\u652f\u6301\u4ee5\u4e0a\u4e24\u79cd\u7b97\u6cd5\u4e3a\u6211\u4eec\u81ea\u52a8\u751f\u6210ID\uff0c\u6587\u6863\uff1ahttps://shardingsphere.apache.org/document/5.1.0/cn/user-manual/shardingsphere-jdbc/builtin-algorithm/keygen/</p> <p>\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u662f\u8981ShardingJDBC\u6765\u8ba9\u6211\u4eec\u7684\u4e3b\u952eID\u4ee5\u96ea\u82b1\u7b97\u6cd5\u8fdb\u884c\u751f\u6210\uff0c\u9996\u5148\u662f\u914d\u7f6e\u6570\u636e\u5e93\uff0c\u56e0\u4e3a\u6211\u4eec\u9ed8\u8ba4\u7684id\u662fint\u7c7b\u578b\uff0c\u88c5\u4e0d\u4e0b64\u4f4d\u7684\uff0c\u6539\u4e00\u4e0b\uff1a</p> <pre><code>ALTER TABLE `yyds`.`test` MODIFY COLUMN `id` bigint NOT NULL FIRST;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u4fee\u6539\u4e00\u4e0bMybatis\u7684\u63d2\u5165\u8bed\u53e5\uff0c\u56e0\u4e3a\u73b0\u5728id\u662f\u7531ShardingJDBC\u81ea\u52a8\u751f\u6210\uff0c\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u81ea\u5df1\u52a0\u4e86\uff1a</p> <pre><code>@Insert(\"insert into test(name, passwd) values(#{name}, #{passwd})\")\nint addUser(User user);\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5c06\u6211\u4eec\u7684\u7b97\u6cd5\u5199\u4e0a\uff1a</p> <pre><code>spring:\n  shardingsphere:\n    datasource:\n      sharding:\n        tables:\n          test:\n            actual-data-nodes: db0.test,db1.test\n            #\u8fd9\u91cc\u8fd8\u662f\u4f7f\u7528\u5206\u5e93\u7b56\u7565\n            database-strategy:\n              standard:\n                sharding-column: id\n                sharding-algorithm-name: my-alg\n            #\u8fd9\u91cc\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u4e3b\u952e\u751f\u6210\u7b56\u7565\n            key-generate-strategy:\n              column: id\n              key-generator-name: my-gen\n        key-generators:\n            #\u8fd9\u91cc\u5199\u6211\u4eec\u81ea\u5b9a\u4e49\u7684\u4e3b\u952e\u751f\u6210\u7b97\u6cd5\n          my-gen:\n            #\u4f7f\u7528\u96ea\u82b1\u7b97\u6cd5\n            type: SNOWFLAKE\n            props:\n                #\u5de5\u4f5c\u673a\u5668ID\uff0c\u4fdd\u8bc1\u552f\u4e00\u5c31\u884c\n              worker-id: 666\n        sharding-algorithms:\n          my-alg:\n            type: MOD\n            props:\n              sharding-count: 2\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u7f16\u5199\u4e00\u4e0b\u6d4b\u8bd5\u7528\u4f8b\uff1a</p> <pre><code>@SpringBootTest\nclass ShardingJdbcTestApplicationTests {\n\n    @Resource\n    UserMapper mapper;\n\n    @Test\n    void contextLoads() {\n        for (int i = 0; i &lt; 20; i++) {\n            mapper.addUser(new User(\"aaa\", \"bbb\"));\n        }\n    }\n\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u65e5\u5fd7\uff1a</p> <p></p> <p>\u5728\u63d2\u5165\u7684\u65f6\u5019\uff0c\u5c06\u6211\u4eec\u7684SQL\u8bed\u53e5\u81ea\u884c\u6dfb\u52a0\u4e86\u4e00\u4e2aid\u5b57\u6bb5\uff0c\u5e76\u4e14\u4f7f\u7528\u7684\u662f\u96ea\u82b1\u7b97\u6cd5\u751f\u6210\u7684\u503c\uff0c\u5e76\u4e14\u4e5f\u662f\u6839\u636e\u6211\u4eec\u7684\u5206\u5e93\u7b56\u7565\u5728\u8fdb\u884c\u63d2\u5165\u64cd\u4f5c\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/#_12","title":"\u8bfb\u5199\u5206\u79bb","text":"<p>\u6700\u540e\u6211\u4eec\u6765\u770b\u770b\u8bfb\u5199\u5206\u79bb\uff0c\u6211\u4eec\u4e4b\u524d\u5b9e\u73b0\u4e86MySQL\u7684\u4e3b\u4ece\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u4e3b\u5e93\u4f5c\u4e3a\u8bfb\uff0c\u4ece\u5e93\u4f5c\u4e3a\u5199\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6211\u4eec\u8fd8\u662f\u5c06\u6570\u636e\u5e93\u53d8\u56de\u4e3b\u4ece\u72b6\u6001\uff0c\u76f4\u63a5\u5220\u9664\u5f53\u524d\u7684\u8868\uff0c\u6211\u4eec\u91cd\u65b0\u6765\u8fc7\uff1a</p> <pre><code>drop table test;\n</code></pre> <p>\u6211\u4eec\u9700\u8981\u5c06\u4ece\u5e93\u5f00\u542f\u53ea\u8bfb\u6a21\u5f0f\uff0c\u5728MySQL\u914d\u7f6e\u4e2d\u8fdb\u884c\u4fee\u6539\uff1a</p> <pre><code>read-only    = 1\n</code></pre> <p>\u8fd9\u6837\u4ece\u5e93\u5c31\u53ea\u80fd\u8bfb\u6570\u636e\u4e86\uff08\u4f46\u662froot\u8d26\u53f7\u8fd8\u662f\u53ef\u4ee5\u5199\u6570\u636e\uff09\uff0c\u63a5\u7740\u6211\u4eec\u91cd\u542f\u670d\u52a1\u5668\uff1a</p> <pre><code>sudo systemctl restart mysql.service\n</code></pre> <p>\u7136\u540e\u8fdb\u5165\u4e3b\u5e93\uff0c\u770b\u770b\u72b6\u6001\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u914d\u7f6e\u4e00\u4e0b\u4ece\u5e93\uff1a</p> <pre><code>change replication source to SOURCE_HOST='192.168.0.13',SOURCE_USER='test',SOURCE_PASSWORD='123456',SOURCE_LOG_FILE='binlog.000007',SOURCE_LOG_POS=19845;\nstart replica;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5728\u4e3b\u5e93\u521b\u5efa\u8868\uff1a</p> <pre><code>create table test  (\n  `id` bigint primary key,\n  `name` varchar(255) NULL,\n  `passwd` varchar(255) NULL\n);\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u914d\u7f6eShardingJDBC\u4e86\uff0c\u6253\u5f00\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>spring:\n  shardingsphere:\n    rules:\n        #\u914d\u7f6e\u8bfb\u5199\u5206\u79bb\n      readwrite-splitting:\n        data-sources:\n            #\u540d\u79f0\u968f\u4fbf\u5199\n          user-db:\n            #\u4f7f\u7528\u9759\u6001\u7c7b\u578b\uff0c\u52a8\u6001Dynamic\u7c7b\u578b\u53ef\u4ee5\u81ea\u52a8\u53d1\u73b0auto-aware-data-source-name\uff0c\u8fd9\u91cc\u4e0d\u6f14\u793a\n            type: Static\n            props:\n                #\u914d\u7f6e\u5199\u5e93\uff08\u53ea\u80fd\u4e00\u4e2a\uff09\n              write-data-source-name: db0\n              #\u914d\u7f6e\u4ece\u5e93\uff08\u591a\u4e2a\uff0c\u9017\u53f7\u9694\u5f00\uff09\n              read-data-source-names: db1\n              #\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\n              load-balancer-name: my-load\n        load-balancers:\n            #\u81ea\u5b9a\u4e49\u7684\u8d1f\u8f7d\u5747\u8861\u7b56\u7565\n          my-load:\n            type: ROUND_ROBIN\n</code></pre> <p>\u6ce8\u610f\u628a\u4e4b\u524d\u6539\u7684\u7528\u6237\u5b9e\u4f53\u7c7b\u548cMapper\u6539\u56de\u53bb\uff0c\u8fd9\u91cc\u6211\u4eec\u5c31\u4e0d\u7528\u81ea\u52a8\u751f\u6210ID\u7684\u4e86\u3002\u6240\u6709\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u5730\u5740\uff1ahttps://shardingsphere.apache.org/document/5.1.0/cn/user-manual/shardingsphere-jdbc/builtin-algorithm/load-balance/</p> <p>\u73b0\u5728\u6211\u4eec\u5c31\u6765\u6d4b\u8bd5\u4e00\u4e0b\u5427\uff1a</p> <pre><code>@SpringBootTest\nclass ShardingJdbcTestApplicationTests {\n\n    @Resource\n    UserMapper mapper;\n\n    @Test\n    void contextLoads() {\n        mapper.addUser(new User(10, \"aaa\", \"bbb\"));\n        System.out.println(mapper.getUserById(10));\n    }\n\n}\n</code></pre> <p>\u8fd0\u884c\u770b\u770bSQL\u65e5\u5fd7\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5f53\u6211\u4eec\u6267\u884c\u63d2\u5165\u64cd\u4f5c\u65f6\uff0c\u4f1a\u76f4\u63a5\u5411db0\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u8bfb\u53d6\u64cd\u4f5c\u662f\u4f1a\u6839\u636e\u6211\u4eec\u7684\u914d\u7f6e\uff0c\u9009\u62e9db1\u8fdb\u884c\u64cd\u4f5c\u3002</p> <p>\u81f3\u6b64\uff0c\u5fae\u670d\u52a1\u5e94\u7528\u7ae0\u8282\u5230\u6b64\u7ed3\u675f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/","title":"SpringCloud\u7b14\u8bb0\uff08\u56db\uff09","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_1","title":"\u6d88\u606f\u961f\u5217","text":"<p>\u7ecf\u8fc7\u524d\u9762\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u6211\u4eec\u4e4b\u524d\u7684\u6280\u672f\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\u7684\u5e94\u7528\uff0c\u63a5\u7740\u6211\u4eec\u6765\u770b\u6700\u540e\u4e00\u7ae0\u7684\u5185\u5bb9\u3002</p> <p>\u90a3\u4e48\uff0c\u4ec0\u4e48\u662f\u6d88\u606f\u961f\u5217\u5462\uff1f</p> <p>\u6211\u4eec\u4e4b\u524d\u5982\u679c\u9700\u8981\u8fdb\u884c\u8fdc\u7a0b\u8c03\u7528\uff0c\u90a3\u4e48\u4e00\u822c\u53ef\u4ee5\u901a\u8fc7\u53d1\u9001HTTP\u8bf7\u6c42\u6765\u5b8c\u6210\uff0c\u800c\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff0c\u5c31\u662f\u6d88\u606f\u961f\u5217\uff0c\u5b83\u80fd\u591f\u5c06\u53d1\u9001\u65b9\u53d1\u9001\u7684\u4fe1\u606f\u653e\u5165\u961f\u5217\u4e2d\uff0c\u5f53\u65b0\u7684\u6d88\u606f\u5165\u961f\u65f6\uff0c\u4f1a\u901a\u77e5\u63a5\u6536\u65b9\u8fdb\u884c\u5904\u7406\uff0c\u4e00\u822c\u6d88\u606f\u53d1\u9001\u65b9\u79f0\u4e3a\u751f\u4ea7\u8005\uff0c\u63a5\u6536\u65b9\u79f0\u4e3a\u6d88\u8d39\u8005\u3002</p> <p></p> <p>\u8fd9\u6837\u6211\u4eec\u6240\u6709\u7684\u8bf7\u6c42\uff0c\u90fd\u53ef\u4ee5\u76f4\u63a5\u4e22\u5230\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u518d\u7531\u6d88\u8d39\u8005\u53d6\u51fa\uff0c\u4e0d\u518d\u662f\u76f4\u63a5\u8fde\u63a5\u6d88\u8d39\u8005\u7684\u5f62\u5f0f\u4e86\uff0c\u800c\u662f\u52a0\u4e86\u4e00\u4e2a\u4e2d\u95f4\u5546\uff0c\u8fd9\u4e5f\u662f\u4e00\u79cd\u5f88\u597d\u7684\u89e3\u8026\u65b9\u6848\uff0c\u5e76\u4e14\u5728\u9ad8\u5e76\u53d1\u7684\u60c5\u51b5\u4e0b\uff0c\u7531\u4e8e\u6d88\u8d39\u8005\u80fd\u529b\u6709\u9650\uff0c\u6d88\u606f\u961f\u5217\u4e5f\u80fd\u8d77\u5230\u4e00\u4e2a\u524a\u5cf0\u586b\u8c37\u7684\u4f5c\u7528\uff0c\u5806\u79ef\u4e00\u90e8\u5206\u7684\u8bf7\u6c42\uff0c\u518d\u7531\u6d88\u8d39\u8005\u6765\u6162\u6162\u5904\u7406\uff0c\u800c\u4e0d\u4f1a\u50cf\u76f4\u63a5\u8c03\u7528\u90a3\u6837\u8bf7\u6c42\u8702\u62e5\u800c\u81f3\u3002</p> <p>\u90a3\u4e48\uff0c\u6d88\u606f\u961f\u5217\u5177\u4f53\u5b9e\u73b0\u6709\u54ea\u4e9b\u5462\uff1a</p> <ul> <li>RabbitMQ  -  \u6027\u80fd\u5f88\u5f3a\uff0c\u541e\u5410\u91cf\u5f88\u9ad8\uff0c\u652f\u6301\u591a\u79cd\u534f\u8bae\uff0c\u96c6\u7fa4\u5316\uff0c\u6d88\u606f\u7684\u53ef\u9760\u6267\u884c\u7279\u6027\u7b49\u4f18\u52bf\uff0c\u5f88\u9002\u5408\u4f01\u4e1a\u7684\u5f00\u53d1\u3002</li> <li>Kafka - \u63d0\u4f9b\u4e86\u8d85\u9ad8\u7684\u541e\u5410\u91cf\uff0cms\u7ea7\u522b\u7684\u5ef6\u8fdf\uff0c\u6781\u9ad8\u7684\u53ef\u7528\u6027\u4ee5\u53ca\u53ef\u9760\u6027\uff0c\u800c\u4e14\u5206\u5e03\u5f0f\u53ef\u4ee5\u4efb\u610f\u6269\u5c55\u3002</li> <li>RocketMQ  -  \u963f\u91cc\u5df4\u5df4\u63a8\u51fa\u7684\u6d88\u606f\u961f\u5217\uff0c\u7ecf\u5386\u8fc7\u53cc\u5341\u4e00\u7684\u8003\u9a8c\uff0c\u5355\u673a\u541e\u5410\u91cf\u9ad8\uff0c\u6d88\u606f\u7684\u9ad8\u53ef\u9760\u6027\uff0c\u6269\u5c55\u6027\u5f3a\uff0c\u652f\u6301\u4e8b\u52a1\u7b49\uff0c\u4f46\u662f\u529f\u80fd\u4e0d\u591f\u5b8c\u6574\uff0c\u8bed\u8a00\u652f\u6301\u6027\u8f83\u5dee\u3002</li> </ul> <p>\u6211\u4eec\u8fd9\u91cc\uff0c\u4e3b\u8981\u8bb2\u89e3\u7684\u662fRabbitMQ\u6d88\u606f\u961f\u5217\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#rabbitmq","title":"RabbitMQ \u6d88\u606f\u961f\u5217","text":"<p>\u5b98\u65b9\u7f51\u7ad9\uff1ahttps://www.rabbitmq.com</p> <p>RabbitMQ\u62e5\u6709\u6570\u4e07\u8ba1\u7684\u7528\u6237\uff0c\u662f\u6700\u53d7\u6b22\u8fce\u7684\u5f00\u6e90\u6d88\u606f\u961f\u5217\u4e4b\u4e00\uff0c\u4eceT-Mobile\u5230Runtastic\uff0cRabbitMQ\u5728\u5168\u7403\u8303\u56f4\u5185\u7528\u4e8e\u5c0f\u578b\u521d\u521b\u4f01\u4e1a\u548c\u5927\u578b\u4f01\u4e1a\u3002</p> <p>RabbitMQ\u8f7b\u91cf\u7ea7\uff0c\u6613\u4e8e\u5728\u672c\u5730\u548c\u4e91\u7aef\u90e8\u7f72\uff0c\u5b83\u652f\u6301\u591a\u79cd\u6d88\u606f\u534f\u8bae\u3002RabbitMQ\u53ef\u4ee5\u90e8\u7f72\u5728\u5206\u5e03\u5f0f\u548c\u8054\u5408\u914d\u7f6e\u4e2d\uff0c\u4ee5\u6ee1\u8db3\u5927\u89c4\u6a21\u3001\u9ad8\u53ef\u7528\u6027\u8981\u6c42\u3002</p> <p>RabbitMQ\u5728\u8bb8\u591a\u64cd\u4f5c\u7cfb\u7edf\u548c\u4e91\u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u5e76\u4e3a\u5927\u591a\u6570\u6d41\u884c\u8bed\u8a00\u63d0\u4f9b\u4e86\u5e7f\u6cdb\u7684\u5f00\u53d1\u8005\u5de5\u5177\u3002</p> <p>\u6211\u4eec\u9996\u5148\u8fd8\u662f\u6765\u770b\u770b\u5982\u4f55\u8fdb\u884c\u5b89\u88c5\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_2","title":"\u5b89\u88c5\u6d88\u606f\u961f\u5217","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttps://www.rabbitmq.com/download.html</p> <p>\u7531\u4e8e\u9664\u4e86\u6d88\u606f\u961f\u5217\u672c\u8eab\u4e4b\u5916\u8fd8\u9700\u8981Erlang\u73af\u5883\uff08RabbitMQ\u5c31\u662f\u8fd9\u4e2a\u8bed\u8a00\u5f00\u53d1\u7684\uff09\u6240\u4ee5\u6211\u4eec\u5c31\u5728\u6211\u4eec\u7684Ubuntu\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u5b89\u88c5\u3002</p> <p>\u9996\u5148\u662fErlang\uff0c\u6bd4\u8f83\u5927\uff0c1GB\u5de6\u53f3\uff1a</p> <pre><code>sudo apt install erlang\n</code></pre> <p>\u63a5\u7740\u5b89\u88c5RabbitMQ\uff1a</p> <pre><code>sudo apt install rabbitmq-server\n</code></pre> <p>\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u8f93\u5165\uff1a</p> <pre><code>sudo rabbitmqctl status\n</code></pre> <p>\u6765\u67e5\u770b\u5f53\u524d\u7684RabbitMQ\u8fd0\u884c\u72b6\u6001\uff0c\u5305\u62ec\u8fd0\u884c\u73af\u5883\u3001\u5185\u5b58\u5360\u7528\u3001\u65e5\u5fd7\u6587\u4ef6\u7b49\u4fe1\u606f\uff1a</p> <pre><code>Runtime\n\nOS PID: 13718\nOS: Linux\nUptime (seconds): 65\nIs under maintenance?: false\nRabbitMQ version: 3.8.9\nNode name: rabbit@ubuntu-server-2\nErlang configuration: Erlang/OTP 23 [erts-11.1.8] [source] [64-bit] [smp:2:2] [ds:2:2:10] [async-threads:64]\nErlang processes: 280 used, 1048576 limit\nScheduler run queue: 1\nCluster heartbeat timeout (net_ticktime): 60\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u7684RabbitMQ\u670d\u52a1\u5668\u5c31\u5b89\u88c5\u5b8c\u6210\u4e86\uff0c\u8981\u7701\u4e8b\u8fd8\u5f97\u662fUbuntu\u554a\u3002</p> <p>\u53ef\u4ee5\u770b\u5230\u9ed8\u8ba4\u6709\u4e24\u4e2a\u7aef\u53e3\u540d\u88ab\u4f7f\u7528\uff1a</p> <pre><code>Listeners\n\nInterface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication\nInterface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0\n</code></pre> <p>\u6211\u4eec\u4e00\u4f1a\u4e3b\u8981\u4f7f\u7528\u7684\u5c31\u662famqp\u534f\u8bae\u7684\u90a3\u4e2a\u7aef\u53e3<code>5672</code>\u6765\u8fdb\u884c\u8fde\u63a5\uff0c25672\u662f\u96c6\u7fa4\u5316\u7aef\u53e3\uff0c\u4e4b\u540e\u6211\u4eec\u4e5f\u4f1a\u7528\u5230\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06RabbitMQ\u7684\u7ba1\u7406\u9762\u677f\u5f00\u542f\uff0c\u8fd9\u6837\u8bdd\u5c31\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e0a\u8fdb\u884c\u5b9e\u65f6\u8bbf\u95ee\u548c\u76d1\u63a7\u4e86\uff1a</p> <pre><code>sudo rabbitmq-plugins enable rabbitmq_management\n</code></pre> <p>\u518d\u6b21\u67e5\u770b\u72b6\u6001\uff0c\u53ef\u4ee5\u770b\u5230\u591a\u4e86\u4e00\u4e2a\u7ba1\u7406\u9762\u677f\uff0c\u4f7f\u7528\u7684\u662fHTTP\u534f\u8bae\uff1a</p> <pre><code>Listeners\n\nInterface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication\nInterface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0\nInterface: [::], port: 15672, protocol: http, purpose: HTTP API\n</code></pre> <p>\u6211\u4eec\u6253\u5f00\u6d4f\u89c8\u5668\u76f4\u63a5\u8bbf\u95ee\u4e00\u4e0b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u9700\u8981\u6211\u4eec\u8fdb\u884c\u767b\u5f55\u624d\u53ef\u4ee5\u8fdb\u5165\uff0c\u6211\u4eec\u8fd9\u91cc\u8fd8\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u624d\u53ef\u4ee5\uff0c\u8fd9\u91cc\u5c31\u90fd\u7528admin\uff1a</p> <pre><code>sudo rabbitmqctl add_user \u7528\u6237\u540d \u5bc6\u7801\n</code></pre> <p>\u5c06\u7ba1\u7406\u5458\u6743\u9650\u7ed9\u4e88\u6211\u4eec\u521a\u521a\u521b\u5efa\u597d\u7684\u7528\u6237\uff1a</p> <pre><code>sudo rabbitmqctl set_user_tags admin administrator\n</code></pre> <p>\u521b\u5efa\u5b8c\u6210\u4e4b\u540e\uff0c\u6211\u4eec\u767b\u5f55\u4e00\u4e0b\u9875\u9762\uff1a</p> <p></p> <p>\u8fdb\u5165\u4e86\u4e4b\u540e\u4f1a\u663e\u793a\u5f53\u524d\u7684\u6d88\u606f\u961f\u5217\u60c5\u51b5\uff0c\u5305\u62ec\u7248\u672c\u53f7\u3001Erlang\u7248\u672c\u7b49\uff0c\u8fd9\u91cc\u9700\u8981\u4ecb\u7ecd\u4e00\u4e0bRabbitMQ\u7684\u8bbe\u8ba1\u67b6\u6784\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u77e5\u9053\u5404\u4e2a\u6a21\u5757\u7ba1\u7406\u7684\u662f\u4ec0\u4e48\u5185\u5bb9\u4e86\uff1a</p> <p></p> <ul> <li>\u751f\u4ea7\u8005\uff08Publisher\uff09\u548c\u6d88\u8d39\u8005\uff08Consumer\uff09\uff1a\u4e0d\u7528\u591a\u8bf4\u4e86\u5427\u3002</li> <li>Channel\uff1a\u6211\u4eec\u7684\u5ba2\u6237\u7aef\u8fde\u63a5\u90fd\u4f1a\u4f7f\u7528\u4e00\u4e2aChannel\uff0c\u518d\u901a\u8fc7Channel\u53bb\u8bbf\u95ee\u5230RabbitMQ\u670d\u52a1\u5668\uff0c\u6ce8\u610f\u901a\u4fe1\u534f\u8bae\u4e0d\u662fhttp\uff0c\u800c\u662famqp\u534f\u8bae\u3002</li> <li>Exchange\uff1a\u7c7b\u4f3c\u4e8e\u4ea4\u6362\u673a\u4e00\u6837\u7684\u5b58\u5728\uff0c\u4f1a\u6839\u636e\u6211\u4eec\u7684\u8bf7\u6c42\uff0c\u8f6c\u53d1\u7ed9\u76f8\u5e94\u7684\u6d88\u606f\u961f\u5217\uff0c\u6bcf\u4e2a\u961f\u5217\u90fd\u53ef\u4ee5\u7ed1\u5b9a\u5230Exchange\u4e0a\uff0c\u8fd9\u6837Exchange\u5c31\u53ef\u4ee5\u5c06\u6570\u636e\u8f6c\u53d1\u7ed9\u961f\u5217\u4e86\uff0c\u53ef\u4ee5\u5b58\u5728\u5f88\u591a\u4e2a\uff0c\u4e0d\u540c\u7684Exchange\u7c7b\u578b\u53ef\u4ee5\u7528\u4e8e\u5b9e\u73b0\u4e0d\u540c\u6d88\u606f\u7684\u6a21\u5f0f\u3002</li> <li>Queue\uff1a\u6d88\u606f\u961f\u5217\u672c\u4f53\uff0c\u751f\u4ea7\u8005\u6240\u6709\u7684\u6d88\u606f\u90fd\u5b58\u653e\u5728\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u7b49\u5f85\u6d88\u8d39\u8005\u53d6\u51fa\u3002</li> <li>Virtual Host\uff1a\u6709\u70b9\u7c7b\u4f3c\u4e8e\u73af\u5883\u9694\u79bb\uff0c\u4e0d\u540c\u73af\u5883\u90fd\u53ef\u4ee5\u5355\u72ec\u914d\u7f6e\u4e00\u4e2aVirtual Host\uff0c\u6bcf\u4e2aVirtual Host\u53ef\u4ee5\u5305\u542b\u5f88\u591a\u4e2aExchange\u548cQueue\uff0c\u6bcf\u4e2aVirtual Host\u76f8\u4e92\u4e4b\u95f4\u4e0d\u5f71\u54cd\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_3","title":"\u4f7f\u7528\u6d88\u606f\u961f\u5217","text":"<p>\u6211\u4eec\u5c31\u4ece\u6700\u7b80\u7684\u7684\u6a21\u578b\u5f00\u59cb\u8bb2\u8d77\uff1a</p> <p></p> <p>\uff08\u4e00\u4e2a\u751f\u4ea7\u8005 -&gt; \u6d88\u606f\u961f\u5217 -&gt; \u4e00\u4e2a\u6d88\u8d39\u8005\uff09</p> <p>\u751f\u4ea7\u8005\u53ea\u9700\u8981\u5c06\u6570\u636e\u4e22\u8fdb\u6d88\u606f\u961f\u5217\uff0c\u800c\u6d88\u8d39\u8005\u53ea\u9700\u8981\u5c06\u6570\u636e\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u53d6\u51fa\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u7684\u6d88\u606f\u4ea4\u4e92\u3002\u6211\u4eec\u73b0\u5728\u6765\u6f14\u793a\u4e00\u4e0b\uff0c\u9996\u5148\u8fdb\u5165\u5230\u6211\u4eec\u7684\u7ba1\u7406\u9875\u9762\uff0c\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5b9e\u9a8c\u73af\u5883\uff0c\u53ea\u9700\u8981\u65b0\u5efa\u4e00\u4e2aVirtual Host\u5373\u53ef\uff1a</p> <p></p> <p>\u6dfb\u52a0\u65b0\u7684\u865a\u62df\u4e3b\u673a\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u5f53\u524dadmin\u7528\u6237\u7684\u4e3b\u673a\u8bbf\u95ee\u6743\u9650\u4e2d\u65b0\u589e\u4e86\u6211\u4eec\u521a\u521a\u6dfb\u52a0\u7684\u73af\u5883\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u4ea4\u6362\u673a\uff1a</p> <p></p> <p>\u4ea4\u6362\u673a\u5217\u8868\u4e2d\u81ea\u52a8\u4e3a\u6211\u4eec\u65b0\u589e\u4e86\u521a\u521a\u521b\u5efa\u597d\u7684\u865a\u62df\u4e3b\u673a\u76f8\u5173\u7684\u9884\u8bbe\u4ea4\u6362\u673a\uff0c\u4e00\u51717\u4e2a\uff0c\u8fd9\u91cc\u6211\u4eec\u9996\u5148\u4ecb\u7ecd\u4e00\u4e0b\u524d\u9762\u4e24\u4e2a<code>direct</code>\u7c7b\u578b\u7684\u4ea4\u6362\u673a\uff0c\u4e00\u4e2a\u662f<code>\uff08AMQP default\uff09</code>\u8fd8\u6709\u4e00\u4e2a\u662f<code>amq.direct</code>\uff0c\u5b83\u4eec\u90fd\u662f\u76f4\u8fde\u6a21\u5f0f\u7684\u4ea4\u6362\u673a\uff0c\u6211\u4eec\u6765\u770b\u770b\u7b2c\u4e00\u4e2a\uff1a</p> <p></p> <p>\u7b2c\u4e00\u4e2a\u4ea4\u6362\u673a\u662f\u6240\u6709\u865a\u62df\u4e3b\u673a\u90fd\u4f1a\u81ea\u5e26\u7684\u4e00\u4e2a\u9ed8\u8ba4\u4ea4\u6362\u673a\uff0c\u5e76\u4e14\u6b64\u4ea4\u6362\u673a\u4e0d\u53ef\u5220\u9664\uff0c\u6b64\u4ea4\u6362\u673a\u9ed8\u8ba4\u7ed1\u5b9a\u5230\u6240\u6709\u7684\u6d88\u606f\u961f\u5217\uff0c\u5982\u679c\u662f\u901a\u8fc7\u9ed8\u8ba4\u4ea4\u6362\u673a\u53d1\u9001\u6d88\u606f\uff0c\u90a3\u4e48\u4f1a\u6839\u636e\u6d88\u606f\u7684<code>routingKey</code>\uff08\u4e4b\u540e\u6211\u4eec\u53d1\u6d88\u606f\u90fd\u4f1a\u6307\u5b9a\uff09\u51b3\u5b9a\u53d1\u9001\u7ed9\u54ea\u4e2a\u540c\u540d\u7684\u6d88\u606f\u961f\u5217\uff0c\u540c\u65f6\u4e5f\u4e0d\u80fd\u663e\u793a\u5730\u5c06\u6d88\u606f\u961f\u5217\u7ed1\u5b9a\u6216\u89e3\u7ed1\u5230\u6b64\u4ea4\u6362\u673a\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8be6\u7ec6\u4fe1\u606f\u4e2d\uff0c\u5f53\u524d\u4ea4\u6362\u673a\u7279\u6027\u662f\u6301\u4e45\u5316\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5c31\u7b97\u673a\u5668\u91cd\u542f\uff0c\u90a3\u4e48\u6b64\u4ea4\u6362\u673a\u4e5f\u4f1a\u4fdd\u7559\uff0c\u5982\u679c\u4e0d\u662f\u6301\u4e45\u5316\uff0c\u90a3\u4e48\u4e00\u65e6\u91cd\u542f\u5c31\u4f1a\u6d88\u5931\u3002\u5b9e\u9645\u4e0a\u6211\u4eec\u5728\u5217\u8868\u4e2d\u770b\u5230<code>D</code>\u7684\u5b57\u6837\uff0c\u5c31\u8868\u793a\u6b64\u4ea4\u6362\u673a\u662f\u6301\u4e45\u5316\u7684\uff0c\u5305\u542b\u4e00\u4f1a\u6211\u4eec\u8981\u8bb2\u89e3\u7684\u6d88\u606f\u961f\u5217\u5217\u8868\u4e5f\u662f\u8fd9\u6837\uff0c\u6240\u6709\u81ea\u52a8\u751f\u6210\u7684\u4ea4\u6362\u673a\u90fd\u662f\u6301\u4e45\u5316\u7684\u3002</p> <p>\u6211\u4eec\u63a5\u7740\u6765\u770b\u7b2c\u4e8c\u4e2a\u4ea4\u6362\u673a\uff0c\u8fd9\u4e2a\u4ea4\u6362\u673a\u662f\u4e00\u4e2a\u666e\u901a\u7684\u76f4\u8fde\u4ea4\u6362\u673a\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u4ea4\u6362\u673a\u548c\u6211\u4eec\u521a\u521a\u4ecb\u7ecd\u7684\u9ed8\u8ba4\u4ea4\u6362\u673a\u7c7b\u578b\u4e00\u81f4\uff0c\u5e76\u4e14\u4e5f\u662f\u6301\u4e45\u5316\u7684\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5b83\u662f\u5177\u6709\u7ed1\u5b9a\u5173\u7cfb\u7684\uff0c\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u7684\u6d88\u606f\u961f\u5217\u7ed1\u5b9a\u5230\u6b64\u4ea4\u6362\u673a\u4e0a\uff0c\u90a3\u4e48\u8fd9\u4e2a\u4ea4\u6362\u673a\u65e0\u6cd5\u6b63\u5e38\u5c06\u4fe1\u606f\u5b58\u653e\u5230\u6307\u5b9a\u7684\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u4e5f\u662f\u6839\u636e<code>routingKey</code>\u5bfb\u627e\u6d88\u606f\u961f\u5217\uff08\u4f46\u662f\u53ef\u4ee5\u81ea\u5b9a\u4e49\uff09</p> <p>\u6211\u4eec\u53ef\u4ee5\u5728\u4e0b\u9762\u76f4\u63a5\u64cd\u4f5c\uff0c\u8ba9\u67d0\u4e2a\u961f\u5217\u7ed1\u5b9a\uff0c\u8fd9\u91cc\u6211\u4eec\u5148\u4e0d\u8fdb\u884c\u64cd\u4f5c\u3002</p> <p>\u4ecb\u7ecd\u5b8c\u4e86\u4e24\u4e2a\u6700\u57fa\u672c\u7684\u4ea4\u6362\u673a\u4e4b\u540e\uff08\u5176\u4ed6\u7c7b\u578b\u7684\u4ea4\u6362\u673a\u6211\u4eec\u4f1a\u5728\u540e\u9762\u8fdb\u884c\u4ecb\u7ecd\uff09\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\u6d88\u606f\u961f\u5217\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6d88\u606f\u961f\u5217\u5217\u8868\u4e2d\u6ca1\u6709\u4efb\u4f55\u7684\u6d88\u606f\u961f\u5217\uff0c\u6211\u4eec\u53ef\u4ee5\u6765\u5c1d\u8bd5\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u6d88\u606f\u961f\u5217\uff1a</p> <p></p> <p>\u7b2c\u4e00\u884c\uff0c\u6211\u4eec\u9009\u62e9\u6211\u4eec\u521a\u521a\u521b\u5efa\u597d\u7684\u865a\u62df\u4e3b\u673a\uff0c\u5728\u8fd9\u4e2a\u865a\u62df\u4e3b\u673a\u4e0b\u521b\u5efa\u6b64\u6d88\u606f\u961f\u5217\uff0c\u63a5\u7740\u6211\u4eec\u5c06\u5176\u7c7b\u578b\u5b9a\u4e49\u4e3a<code>Classic</code>\u7c7b\u578b\uff0c\u4e5f\u5c31\u662f\u7ecf\u5178\u7c7b\u578b\uff08\u5176\u4ed6\u7c7b\u578b\u6211\u4eec\u4f1a\u5728\u540e\u9762\u9010\u6b65\u4ecb\u7ecd\uff09\u540d\u79f0\u968f\u4fbf\u8d77\u4e00\u4e2a\uff0c\u7136\u540e\u6301\u4e45\u5316\u6211\u4eec\u9009\u62e9<code>Transient</code>\u6682\u65f6\u7684\uff08\u5f53\u7136\u4e5f\u53ef\u4ee5\u6301\u4e45\u5316\uff0c\u770b\u4f60\u81ea\u5df1\uff09\u81ea\u52a8\u5220\u9664\u6211\u4eec\u9009\u62e9<code>No</code>\uff08\u9700\u8981\u81f3\u5c11\u6709\u4e00\u4e2a\u6d88\u8d39\u8005\u8fde\u63a5\u5230\u8fd9\u4e2a\u961f\u5217\uff0c\u4e4b\u540e\uff0c\u4e00\u65e6\u6240\u6709\u4e0e\u8fd9\u4e2a\u961f\u5217\u8fde\u63a5\u7684\u6d88\u8d39\u8005\u90fd\u65ad\u5f00\u65f6\uff0c\u5c31\u4f1a\u81ea\u52a8\u5220\u9664\u6b64\u961f\u5217\uff09\u6700\u4e0b\u9762\u7684\u53c2\u6570\u6211\u4eec\u6682\u65f6\u4e0d\u8fdb\u884c\u4efb\u4f55\u8bbe\u7f6e\uff08\u4e4b\u540e\u4f1a\u7528\u5230\uff09</p> <p>\u73b0\u5728\uff0c\u6211\u4eec\u5c31\u521b\u5efa\u597d\u4e86\u4e00\u4e2a\u7ecf\u5178\u7684\u6d88\u606f\u961f\u5217\uff1a</p> <p></p> <p>\u70b9\u51fb\u6b64\u961f\u5217\u7684\u540d\u79f0\uff0c\u6211\u4eec\u53ef\u4ee5\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\uff1a</p> <p></p> <p>\u8be6\u7ec6\u76f8\u4fe1\u4e2d\u5305\u62ec\u961f\u5217\u7684\u5f53\u524d\u8d1f\u8f7d\u72b6\u6001\u3001\u5c5e\u6027\u3001\u6d88\u606f\u961f\u5217\u5360\u7528\u7684\u5185\u5b58\uff0c\u6d88\u606f\u6570\u91cf\u7b49\uff0c\u4e00\u4f1a\u6211\u4eec\u53d1\u9001\u6d88\u606f\u65f6\u53ef\u4ee5\u8fdb\u4e00\u6b65\u8fdb\u884c\u89c2\u5bdf\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u9700\u8981\u5c06\u6b64\u6d88\u606f\u961f\u5217\u7ed1\u5b9a\u5230\u4e0a\u9762\u7684\u7b2c\u4e8c\u4e2a\u76f4\u8fde\u4ea4\u6362\u673a\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u6b64\u4ea4\u6362\u673a\u5411\u6b64\u6d88\u606f\u961f\u5217\u53d1\u9001\u6d88\u606f\u4e86\uff1a</p> <p></p> <p>\u8fd9\u91cc\u586b\u5199\u4e4b\u524d\u7b2c\u4e8c\u4e2a\u4ea4\u6362\u673a\u7684\u540d\u79f0\u8fd8\u6709\u6211\u4eec\u81ea\u5b9a\u4e49\u7684<code>routingKey</code>\uff08\u6700\u597d\u8fd8\u662f\u548c\u6d88\u606f\u961f\u5217\u540d\u79f0\u4e00\u81f4\uff0c\u8fd9\u91cc\u662f\u4e3a\u4e86\u4e00\u4f1a\u6f14\u793a\u4e24\u4e2a\u4ea4\u6362\u673a\u533a\u522b\u7528\uff09\u6211\u4eec\u76f4\u63a5\u70b9\u51fb\u7ed1\u5b9a\u5373\u53ef\uff1a</p> <p></p> <p>\u7ed1\u5b9a\u4e4b\u540e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u961f\u5217\u5df2\u7ecf\u7ed1\u5b9a\u5bf9\u5e94\u7684\u4ea4\u6362\u673a\u4e86\uff0c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u524d\u5f80\u4ea4\u6362\u673a\u5bf9\u6b64\u6d88\u606f\u961f\u5217\u53d1\u9001\u4e00\u4e2a\u6d88\u606f\uff1a</p> <p></p> <p>\u56de\u5230\u4ea4\u6362\u673a\u4e4b\u540e\uff0c\u53ef\u4ee5\u5361\u5230\u8fd9\u8fb9\u4e5f\u662f\u540c\u6b65\u4e86\u5f53\u524d\u7684\u7ed1\u5b9a\u4fe1\u606f\uff0c\u5728\u4e0b\u65b9\uff0c\u6211\u4eec\u76f4\u63a5\u5411\u6b64\u6d88\u606f\u961f\u5217\u53d1\u9001\u4fe1\u606f\uff1a</p> <p></p> <p>\u70b9\u51fb\u53d1\u9001\u4e4b\u540e\uff0c\u6211\u4eec\u56de\u5230\u521a\u521a\u7684\u4ea4\u6362\u673a\u8be6\u7ec6\u9875\u9762\uff0c\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u6709\u4e00\u6761\u65b0\u7684\u6d88\u606f\u5728\u961f\u5217\u4e2d\u4e86\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u6d88\u606f\u961f\u5217\u8fd9\u8fb9\u83b7\u53d6\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6d88\u606f\uff0c\u627e\u5230\u4e0b\u65b9\u7684Get message\u9009\u9879\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6709\u4e09\u4e2a\u9009\u62e9\uff0c\u9996\u5148\u7b2c\u4e00\u4e2aAck Mode\uff0c\u8fd9\u4e2a\u662f\u5e94\u7b54\u6a21\u5f0f\u9009\u62e9\uff0c\u4e00\u5171\u67094\u4e2a\u9009\u9879\uff1a</p> <p></p> <ul> <li>Nack message requeue true\uff1a\u62d2\u7edd\u6d88\u606f\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e0d\u4f1a\u5c06\u6d88\u606f\u4ece\u6d88\u606f\u961f\u5217\u53d6\u51fa\uff0c\u5e76\u4e14\u91cd\u65b0\u6392\u961f\uff0c\u4e00\u6b21\u53ef\u4ee5\u62d2\u7edd\u591a\u4e2a\u6d88\u606f\u3002</li> <li>Ack message requeue false\uff1a\u786e\u8ba4\u5e94\u7b54\uff0c\u786e\u8ba4\u540e\u6d88\u606f\u4f1a\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u79fb\u9664\uff0c\u4e00\u6b21\u53ef\u4ee5\u786e\u8ba4\u591a\u4e2a\u6d88\u606f\u3002</li> <li>Reject message requeue true/false\uff1a\u4e5f\u662f\u62d2\u7edd\u6b64\u6d88\u606f\uff0c\u4f46\u662f\u53ef\u4ee5\u6307\u5b9a\u662f\u5426\u91cd\u65b0\u6392\u961f\u3002</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u9ed8\u8ba4\u7684\u5c31\u53ef\u4ee5\u4e86\uff0c\u8fd9\u6837\u53ea\u4f1a\u67e5\u770b\u6d88\u606f\u662f\u5565\uff0c\u4f46\u662f\u4e0d\u4f1a\u53d6\u51fa\uff0c\u6d88\u606f\u4f9d\u7136\u5b58\u5728\u4e8e\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u7f16\u7801\u683c\u5f0f\uff0c\u4f7f\u7528\u9ed8\u8ba4\u7684\u5c31\u53ef\u4ee5\u4e86\uff0c\u6700\u540e\u5c31\u662f\u8981\u751f\u6548\u7684\u64cd\u4f5c\u6570\u91cf\uff0c\u9009\u62e91\u5c31\u884c\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u521a\u521a\u7684\u6d88\u606f\u5df2\u7ecf\u6210\u529f\u8bfb\u53d6\u5230\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u518d\u53bb\u7b2c\u4e00\u4e2a\u9ed8\u8ba4\u4ea4\u6362\u673a\u4e2d\u5c1d\u8bd5\u53d1\u9001\u6d88\u606f\u8bd5\u8bd5\u770b\uff1a</p> <p></p> <p>\u5982\u679c\u6211\u4eec\u4f7f\u7528\u4e4b\u524d\u81ea\u5b9a\u4e49\u7684<code>routingKey</code>\uff0c\u4f1a\u663e\u793a\u6ca1\u6709\u8def\u7531\uff0c\u8fd9\u662f\u56e0\u4e3a\u9ed8\u8ba4\u7684\u4ea4\u6362\u673a\u53ea\u4f1a\u627e\u5bf9\u5e94\u540d\u79f0\u7684\u6d88\u606f\u961f\u5217\uff0c\u6211\u4eec\u73b0\u5728\u5411<code>yyds</code>\u53d1\u9001\u4e00\u4e0b\u8bd5\u8bd5\u770b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6d88\u606f\u6210\u529f\u53d1\u5e03\u4e86\uff0c\u6211\u4eec\u6765\u63a5\u6536\u4e00\u4e0b\u770b\u770b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6210\u529f\u53d1\u9001\u5230\u6b64\u6d88\u606f\u961f\u5217\u4e2d\u4e86\u3002</p> <p>\u5f53\u7136\u9664\u4e86\u5728\u4ea4\u6362\u673a\u53d1\u9001\u6d88\u606f\u7ed9\u6d88\u606f\u961f\u5217\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u6d88\u606f\u961f\u5217\u8fd9\u91cc\u53d1\uff1a</p> <p></p> <p>\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u6ce8\u610f\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u662f\u5426\u5c06\u6d88\u606f\u6301\u4e45\u5316\uff0c\u5982\u679c\u662f\u6301\u4e45\u5316\u6d88\u606f\uff0c\u90a3\u4e48\u5c31\u7b97\u670d\u52a1\u5668\u91cd\u542f\uff0c\u6b64\u6d88\u606f\u4e5f\u4f1a\u4fdd\u5b58\u5728\u6d88\u606f\u961f\u5217\u4e2d\u3002</p> <p>\u6700\u540e\u5982\u679c\u6211\u4eec\u4e0d\u9700\u8981\u518d\u4f7f\u7528\u6b64\u6d88\u606f\u961f\u5217\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u624b\u52a8\u5bf9\u5176\u8fdb\u884c\u5220\u9664\u6216\u662f\u6e05\u7a7a\uff1a</p> <p></p> <p>\u70b9\u51fbDelete Queue\u5220\u9664\u6211\u4eec\u521a\u521a\u521b\u5efa\u597d\u7684<code>yyds</code>\u961f\u5217\uff0c\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u5bf9\u5e94\u6d88\u606f\u961f\u5217\u7684\u4e00\u4e9b\u7b80\u5355\u4f7f\u7528\uff0c\u5c31\u8bb2\u89e3\u5b8c\u6bd5\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#java","title":"\u4f7f\u7528Java\u64cd\u4f5c\u6d88\u606f\u961f\u5217","text":"<p>\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u901a\u8fc7Java\u8fde\u63a5\u5230RabbitMQ\u670d\u52a1\u5668\u5e76\u4f7f\u7528\u6d88\u606f\u961f\u5217\u8fdb\u884c\u6d88\u606f\u53d1\u9001\uff08\u8fd9\u91cc\u4e00\u8d77\u8bb2\u89e3\uff0c\u5305\u62ecJava\u57fa\u7840\u7248\u672c\u548cSpringBoot\u7248\u672c\uff09\uff0c\u9996\u5148\u6211\u4eec\u4f7f\u7528\u6700\u57fa\u672c\u7684Java\u5ba2\u6237\u7aef\u8fde\u63a5\u65b9\u5f0f\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.rabbitmq&lt;/groupId&gt;\n    &lt;artifactId&gt;amqp-client&lt;/artifactId&gt;\n    &lt;version&gt;5.14.2&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u4f9d\u8d56\u5bfc\u5165\u4e4b\u540e\uff0c\u6211\u4eec\u6765\u5b9e\u73b0\u4e00\u4e0b\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\uff0c\u9996\u5148\u662f\u751f\u4ea7\u8005\uff0c\u751f\u4ea7\u8005\u8d1f\u8d23\u5c06\u4fe1\u606f\u53d1\u9001\u5230\u6d88\u606f\u961f\u5217\uff1a</p> <pre><code>public static void main(String[] args) {\n    //\u4f7f\u7528ConnectionFactory\u6765\u521b\u5efa\u8fde\u63a5\n    ConnectionFactory factory = new ConnectionFactory();\n\n    //\u8bbe\u5b9a\u8fde\u63a5\u4fe1\u606f\uff0c\u57fa\u64cd\n    factory.setHost(\"192.168.0.12\");\n    factory.setPort(5672);  //\u6ce8\u610f\u8fd9\u91cc\u51995672\uff0c\u662famqp\u534f\u8bae\u7aef\u53e3\n    factory.setUsername(\"admin\");\n    factory.setPassword(\"admin\");\n    factory.setVirtualHost(\"/test\");\n\n        //\u521b\u5efa\u8fde\u63a5\n    try(Connection connection = factory.newConnection()){\n\n    }catch (Exception e){\n        e.printStackTrace();\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u5e76\u521b\u5efa\u6d88\u606f\u961f\u5217\uff08\u5b9e\u9645\u4e0a\u662f\u548c\u6211\u4eec\u5728\u7ba1\u7406\u9875\u9762\u521b\u5efa\u4e00\u6837\u7684\u6548\u679c\uff09\u5ba2\u6237\u7aef\u9700\u8981\u901a\u8fc7\u8fde\u63a5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u901a\u9053\uff08Channel\uff09\uff0c\u540c\u4e00\u4e2a\u8fde\u63a5\u4e0b\u53ef\u4ee5\u6709\u5f88\u591a\u4e2a\u901a\u9053\uff0c\u8fd9\u6837\u5c31\u4e0d\u7528\u521b\u5efa\u5f88\u591a\u4e2a\u8fde\u63a5\u4e5f\u80fd\u652f\u6301\u5206\u5f00\u53d1\u9001\u4e86\u3002</p> <pre><code>try(Connection connection = factory.newConnection();\n    Channel channel = connection.createChannel()){   //\u901a\u8fc7Connection\u521b\u5efa\u65b0\u7684Channel\n    //\u58f0\u660e\u961f\u5217\uff0c\u5982\u679c\u6b64\u961f\u5217\u4e0d\u5b58\u5728\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa\n    channel.queueDeclare(\"yyds\", false, false, false, null);\n    //\u5c06\u961f\u5217\u7ed1\u5b9a\u5230\u4ea4\u6362\u673a\n    channel.queueBind(\"yyds\", \"amq.direct\", \"my-yyds\");\n    //\u53d1\u5e03\u65b0\u7684\u6d88\u606f\uff0c\u6ce8\u610f\u6d88\u606f\u9700\u8981\u8f6c\u6362\u4e3abyte[]\n    channel.basicPublish(\"amq.direct\", \"my-yyds\", null, \"Hello World!\".getBytes());\n}catch (Exception e){\n    e.printStackTrace();\n}\n</code></pre> <p>\u5176\u4e2d<code>queueDeclare</code>\u65b9\u6cd5\u7684\u53c2\u6570\u5982\u4e0b\uff1a</p> <ul> <li>queue\uff1a\u961f\u5217\u7684\u540d\u79f0\uff08\u9ed8\u8ba4\u521b\u5efa\u540eroutingKey\u548c\u961f\u5217\u540d\u79f0\u4e00\u81f4\uff09</li> <li>durable\uff1a\u662f\u5426\u6301\u4e45\u5316\u3002</li> <li>exclusive\uff1a\u662f\u5426\u6392\u4ed6\uff0c\u5982\u679c\u4e00\u4e2a\u961f\u5217\u88ab\u58f0\u660e\u4e3a\u6392\u4ed6\u961f\u5217\uff0c\u8be5\u961f\u5217\u4ec5\u5bf9\u9996\u6b21\u58f0\u660e\u5b83\u7684\u8fde\u63a5\u53ef\u89c1\uff0c\u5e76\u5728\u8fde\u63a5\u65ad\u5f00\u65f6\u81ea\u52a8\u5220\u9664\u3002\u6392\u4ed6\u961f\u5217\u662f\u57fa\u4e8eConnection\u53ef\u89c1\uff0c\u540c\u4e00\u4e2aConnection\u7684\u4e0d\u540cChannel\u662f\u53ef\u4ee5\u540c\u65f6\u8bbf\u95ee\u540c\u4e00\u4e2a\u8fde\u63a5\u521b\u5efa\u7684\u6392\u4ed6\u961f\u5217\uff0c\u5e76\u4e14\uff0c\u5982\u679c\u4e00\u4e2aConnection\u5df2\u7ecf\u58f0\u660e\u4e86\u4e00\u4e2a\u6392\u4ed6\u961f\u5217\uff0c\u5176\u4ed6\u7684Connection\u662f\u4e0d\u5141\u8bb8\u5efa\u7acb\u540c\u540d\u7684\u6392\u4ed6\u961f\u5217\u7684\uff0c\u5373\u4f7f\u8be5\u961f\u5217\u662f\u6301\u4e45\u5316\u7684\uff0c\u4e00\u65e6Connection\u5173\u95ed\u6216\u8005\u5ba2\u6237\u7aef\u9000\u51fa\uff0c\u8be5\u6392\u4ed6\u961f\u5217\u90fd\u4f1a\u81ea\u52a8\u88ab\u5220\u9664\u3002</li> <li>autoDelete\uff1a\u662f\u5426\u81ea\u52a8\u5220\u9664\u3002</li> <li>arguments\uff1a\u8bbe\u7f6e\u961f\u5217\u7684\u5176\u4ed6\u4e00\u4e9b\u53c2\u6570\uff0c\u8fd9\u91cc\u6211\u4eec\u6682\u65f6\u4e0d\u9700\u8981\u4ec0\u4e48\u5176\u4ed6\u53c2\u6570\u3002</li> </ul> <p>\u5176\u4e2d<code>queueBind</code>\u65b9\u6cd5\u53c2\u6570\u5982\u4e0b\uff1a</p> <ul> <li>queue\uff1a\u9700\u8981\u7ed1\u5b9a\u7684\u961f\u5217\u540d\u79f0\u3002</li> <li>exchange\uff1a\u9700\u8981\u7ed1\u5b9a\u7684\u4ea4\u6362\u673a\u540d\u79f0\u3002</li> <li>routingKey\uff1a\u4e0d\u7528\u591a\u8bf4\u4e86\u5427\u3002</li> </ul> <p>\u5176\u4e2d<code>basicPublish</code>\u65b9\u6cd5\u7684\u53c2\u6570\u5982\u4e0b\uff1a</p> <ul> <li>exchange: \u5bf9\u5e94\u7684Exchange\u540d\u79f0\uff0c\u6211\u4eec\u8fd9\u91cc\u5c31\u4f7f\u7528\u7b2c\u4e8c\u4e2a\u76f4\u8fde\u4ea4\u6362\u673a\u3002</li> <li>routingKey\uff1a\u8fd9\u91cc\u6211\u4eec\u586b\u5199\u7ed1\u5b9a\u65f6\u6307\u5b9a\u7684routingKey\uff0c\u5176\u5b9e\u548c\u4e4b\u524d\u5728\u7ba1\u7406\u9875\u9762\u64cd\u4f5c\u4e00\u6837\u3002</li> <li>props\uff1a\u5176\u4ed6\u7684\u914d\u7f6e\u3002</li> <li>body\uff1a\u6d88\u606f\u672c\u4f53\u3002</li> </ul> <p>\u6267\u884c\u5b8c\u6210\u540e\uff0c\u53ef\u4ee5\u5728\u7ba1\u7406\u9875\u9762\u4e2d\u770b\u5230\u6211\u4eec\u521a\u521a\u521b\u5efa\u597d\u7684\u6d88\u606f\u961f\u5217\u4e86\uff1a</p> <p></p> <p>\u5e76\u4e14\u6b64\u6d88\u606f\u961f\u5217\u5df2\u7ecf\u6210\u529f\u4e0e<code>amq.direct</code>\u4ea4\u6362\u673a\u8fdb\u884c\u7ed1\u5b9a\uff1a</p> <p></p> <p>\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u7684\u6d88\u606f\u961f\u5217\u4e2d\u5df2\u7ecf\u5b58\u5728\u6570\u636e\u4e86\uff0c\u600e\u4e48\u5c06\u5176\u8bfb\u53d6\u51fa\u6765\u5462\uff1f\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u521b\u5efa\u4e00\u4e2a\u6d88\u8d39\u8005\uff1a</p> <pre><code>public static void main(String[] args) throws IOException, TimeoutException {\n    ConnectionFactory factory = new ConnectionFactory();\n    factory.setHost(\"10.37.129.4\");\n    factory.setPort(5672);\n    factory.setUsername(\"admin\");\n    factory.setPassword(\"admin\");\n    factory.setVirtualHost(\"/test\");\n\n    //\u8fd9\u91cc\u4e0d\u4f7f\u7528try-with-resource\uff0c\u56e0\u4e3a\u6d88\u8d39\u8005\u662f\u4e00\u76f4\u7b49\u5f85\u65b0\u7684\u6d88\u606f\u5230\u6765\uff0c\u7136\u540e\u6309\u7167\n    //\u6211\u4eec\u8bbe\u5b9a\u7684\u903b\u8f91\u8fdb\u884c\u5904\u7406\uff0c\u6240\u4ee5\u8fd9\u91cc\u4e0d\u80fd\u5728\u5b9a\u4e49\u5b8c\u6210\u4e4b\u540e\u5c31\u5173\u95ed\u8fde\u63a5\n    Connection connection = factory.newConnection();\n    Channel channel = connection.createChannel();\n\n    //\u521b\u5efa\u4e00\u4e2a\u57fa\u672c\u7684\u6d88\u8d39\u8005\n    channel.basicConsume(\"yyds\", false, (s, delivery) -&gt; {\n        System.out.println(new String(delivery.getBody()));\n        //basicAck\u662f\u786e\u8ba4\u5e94\u7b54\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u5f53\u524d\u7684\u6d88\u606f\u6807\u7b7e\uff0c\u540e\u9762\u7684\u53c2\u6570\u662f\n        //\u662f\u5426\u6279\u91cf\u5904\u7406\u6d88\u606f\u961f\u5217\u4e2d\u6240\u6709\u7684\u6d88\u606f\uff0c\u5982\u679c\u4e3afalse\u8868\u793a\u53ea\u5904\u7406\u5f53\u524d\u6d88\u606f\n        channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false);\n        //basicNack\u662f\u62d2\u7edd\u5e94\u7b54\uff0c\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u8868\u793a\u662f\u5426\u5c06\u5f53\u524d\u6d88\u606f\u653e\u56de\u961f\u5217\uff0c\u5982\u679c\n        //\u4e3afalse\uff0c\u90a3\u4e48\u6d88\u606f\u5c31\u4f1a\u88ab\u4e22\u5f03\n        //channel.basicNack(delivery.getEnvelope().getDeliveryTag(), false, false);\n        //\u8ddf\u4e0a\u9762\u4e00\u6837\uff0c\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u4e3afalse\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u91cc\u7701\u4e86\n        //channel.basicReject(delivery.getEnvelope().getDeliveryTag(), false);\n    }, s -&gt; {});\n}\n</code></pre> <p>\u5176\u4e2d<code>basicConsume</code>\u65b9\u6cd5\u53c2\u6570\u5982\u4e0b\uff1a</p> <ul> <li>queue  -  \u6d88\u606f\u961f\u5217\u540d\u79f0\uff0c\u76f4\u63a5\u6307\u5b9a\u3002</li> <li>autoAck - \u81ea\u52a8\u5e94\u7b54\uff0c\u6d88\u8d39\u8005\u4ece\u6d88\u606f\u961f\u5217\u53d6\u51fa\u6570\u636e\u540e\uff0c\u9700\u8981\u8ddf\u670d\u52a1\u5668\u8fdb\u884c\u786e\u8ba4\u5e94\u7b54\uff0c\u5f53\u670d\u52a1\u5668\u6536\u5230\u786e\u8ba4\u540e\uff0c\u4f1a\u81ea\u52a8\u5c06\u6d88\u606f\u5220\u9664\uff0c\u5982\u679c\u5f00\u542f\u81ea\u52a8\u5e94\u7b54\uff0c\u90a3\u4e48\u6d88\u606f\u53d1\u51fa\u540e\u4f1a\u76f4\u63a5\u5220\u9664\u3002</li> <li>deliver  -  \u6d88\u606f\u63a5\u6536\u540e\u7684\u51fd\u6570\u56de\u8c03\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u56de\u8c03\u4e2d\u5bf9\u6d88\u606f\u8fdb\u884c\u5904\u7406\uff0c\u5904\u7406\u5b8c\u6210\u540e\uff0c\u9700\u8981\u7ed9\u670d\u52a1\u5668\u786e\u8ba4\u5e94\u7b54\u3002</li> <li>cancel  -  \u5f53\u6d88\u8d39\u8005\u53d6\u6d88\u8ba2\u9605\u65f6\u8fdb\u884c\u7684\u51fd\u6570\u56de\u8c03\uff0c\u8fd9\u91cc\u6682\u65f6\u7528\u4e0d\u5230\u3002</li> </ul> <p>\u73b0\u5728\u6211\u4eec\u542f\u52a8\u4e00\u4e0b\u6d88\u8d39\u8005\uff0c\u53ef\u4ee5\u770b\u5230\u7acb\u5373\u8bfb\u53d6\u5230\u6211\u4eec\u521a\u521a\u63d2\u5165\u5230\u961f\u5217\u4e2d\u7684\u6570\u636e\uff1a</p> <p></p> <p>\u6211\u4eec\u73b0\u5728\u7ee7\u7eed\u5728\u6d88\u606f\u961f\u5217\u4e2d\u63d2\u5165\u65b0\u7684\u6570\u636e\uff0c\u8fd9\u91cc\u76f4\u63a5\u5728\u7f51\u9875\u4e0a\u8fdb\u884c\u64cd\u4f5c\u5c31\u884c\u4e86\uff0c\u540c\u6837\u7684\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u6d88\u8d39\u8005\u7aef\u63a5\u53d7\u5e76\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u628a\u521a\u521a\u521b\u5efa\u597d\u7684\u6d88\u606f\u961f\u5217\u5220\u9664\u3002</p> <p>\u5b98\u65b9\u6587\u6863\uff1ahttps://docs.spring.io/spring-amqp/docs/current/reference/html/</p> <p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86RabbitMQ\u7684\u5b89\u88c5\u548c\u7b80\u5355\u4f7f\u7528\uff0c\u5e76\u4e14\u901a\u8fc7Java\u8fde\u63a5\u5230\u670d\u52a1\u5668\u3002\u73b0\u5728\u6211\u4eec\u6765\u5c1d\u8bd5\u5728SpringBoot\u4e2d\u6574\u5408\u6d88\u606f\u961f\u5217\u5ba2\u6237\u7aef\uff0c\u9996\u5148\u662f\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u914d\u7f6eRabbitMQ\u7684\u5730\u5740\u7b49\u4fe1\u606f\uff1a</p> <pre><code>spring:\n  rabbitmq:\n    addresses: 192.168.0.4\n    username: admin\n    password: admin\n    virtual-host: /test\n</code></pre> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u6700\u57fa\u672c\u4fe1\u606f\u914d\u7f6e\uff0c\u73b0\u5728\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff0c\u5982\u4f55\u50cf\u4e4b\u524d\u4e00\u6837\u53bb\u58f0\u660e\u4e00\u4e2a\u6d88\u606f\u961f\u5217\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4e00\u4e2a\u914d\u7f6e\u7c7b\u5c31\u884c\u4e86\uff1a</p> <pre><code>@Configuration\npublic class RabbitConfiguration {\n    @Bean(\"directExchange\")  //\u5b9a\u4e49\u4ea4\u6362\u673aBean\uff0c\u53ef\u4ee5\u5f88\u591a\u4e2a\n    public Exchange exchange(){\n        return ExchangeBuilder.directExchange(\"amq.direct\").build();\n    }\n\n    @Bean(\"yydsQueue\")     //\u5b9a\u4e49\u6d88\u606f\u961f\u5217\n    public Queue queue(){\n        return QueueBuilder\n                        .nonDurable(\"yyds\")   //\u975e\u6301\u4e45\u5316\u7c7b\u578b\n                        .build();\n    }\n\n    @Bean(\"binding\")\n    public Binding binding(@Qualifier(\"directExchange\") Exchange exchange,\n                           @Qualifier(\"yydsQueue\") Queue queue){\n        //\u5c06\u6211\u4eec\u521a\u521a\u5b9a\u4e49\u7684\u4ea4\u6362\u673a\u548c\u961f\u5217\u8fdb\u884c\u7ed1\u5b9a\n        return BindingBuilder\n                .bind(queue)   //\u7ed1\u5b9a\u961f\u5217\n                .to(exchange)  //\u5230\u4ea4\u6362\u673a\n                .with(\"my-yyds\")   //\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684routingKey\n                .noargs();\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u521b\u5efa\u4e00\u4e2a\u751f\u4ea7\u8005\uff0c\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u7f16\u5199\u5728\u6d4b\u8bd5\u7528\u4f8b\u4e2d\uff1a</p> <pre><code>@SpringBootTest\nclass SpringCloudMqApplicationTests {\n\n    //RabbitTemplate\u4e3a\u6211\u4eec\u5c01\u88c5\u4e86\u5927\u91cf\u7684RabbitMQ\u64cd\u4f5c\uff0c\u5df2\u7ecf\u7531Starter\u63d0\u4f9b\uff0c\u56e0\u6b64\u76f4\u63a5\u6ce8\u5165\u4f7f\u7528\u5373\u53ef\n    @Resource\n    RabbitTemplate template;\n\n    @Test\n    void publisher() {\n        //\u4f7f\u7528convertAndSend\u65b9\u6cd5\u4e00\u6b65\u5230\u4f4d\uff0c\u53c2\u6570\u57fa\u672c\u548c\u4e4b\u524d\u662f\u4e00\u6837\u7684\n        //\u6700\u540e\u4e00\u4e2a\u6d88\u606f\u672c\u4f53\u53ef\u4ee5\u662fObject\u7c7b\u578b\uff0c\u771f\u662f\u5927\u5927\u7684\u65b9\u4fbf\n        template.convertAndSend(\"amq.direct\", \"my-yyds\", \"Hello World!\");\n    }\n\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u6765\u8fd0\u884c\u4e00\u4e0b\u8fd9\u4e2a\u6d4b\u8bd5\u7528\u4f8b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u540e\u53f0\u81ea\u52a8\u58f0\u660e\u4e86\u6211\u4eec\u521a\u521a\u5b9a\u4e49\u597d\u7684\u6d88\u606f\u961f\u5217\u548c\u4ea4\u6362\u673a\u4ee5\u53ca\u5bf9\u5e94\u7684\u7ed1\u5b9a\u5173\u7cfb\uff0c\u5e76\u4e14\u6211\u4eec\u7684\u6570\u636e\u4e5f\u662f\u6210\u529f\u63d2\u5165\u5230\u6d88\u606f\u961f\u5217\u4e2d\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u518d\u6765\u770b\u770b\u5982\u4f55\u521b\u5efa\u4e00\u4e2a\u6d88\u8d39\u8005\uff0c\u56e0\u4e3a\u6d88\u8d39\u8005\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u76f4\u7b49\u5f85\u6d88\u606f\u7136\u540e\u8fdb\u884c\u5904\u7406\u7684\u89d2\u8272\uff0c\u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u76d1\u542c\u5668\u5c31\u884c\u4e86\uff0c\u5b83\u4f1a\u4e00\u76f4\u7b49\u5f85\u6d88\u606f\u5230\u6765\u7136\u540e\u518d\u8fdb\u884c\u5904\u7406\uff1a</p> <pre><code>@Component  //\u6ce8\u518c\u4e3aBean\npublic class TestListener {\n\n    @RabbitListener(queues = \"yyds\")   //\u5b9a\u4e49\u6b64\u65b9\u6cd5\u4e3a\u961f\u5217yyds\u7684\u76d1\u542c\u5668\uff0c\u4e00\u65e6\u76d1\u542c\u5230\u65b0\u7684\u6d88\u606f\uff0c\u5c31\u4f1a\u63a5\u53d7\u5e76\u5904\u7406\n    public void test(Message message){\n        System.out.println(new String(message.getBody()));\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u542f\u52a8\u670d\u52a1\u5668\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u63a7\u5236\u53f0\u6210\u529f\u8f93\u51fa\u4e86\u6211\u4eec\u4e4b\u524d\u653e\u5165\u961f\u5217\u7684\u6d88\u606f\uff0c\u5e76\u4e14\u7ba1\u7406\u9875\u9762\u4e2d\u4e5f\u663e\u793a\u6b64\u6d88\u8d39\u8005\u5df2\u7ecf\u8fde\u63a5\u4e86\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u518d\u901a\u8fc7\u7ba1\u7406\u9875\u9762\u6dfb\u52a0\u65b0\u7684\u6d88\u606f\u770b\u770b\uff0c\u4e5f\u662f\u53ef\u4ee5\u6b63\u5e38\u8fdb\u884c\u63a5\u53d7\u7684\u3002</p> <p>\u5f53\u7136\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u786e\u4fdd\u6d88\u606f\u80fd\u591f\u88ab\u6d88\u8d39\u8005\u63a5\u53d7\u5e76\u5904\u7406\uff0c\u7136\u540e\u5f97\u5230\u6d88\u8d39\u8005\u7684\u53cd\u9988\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\uff1a</p> <pre><code>@Test\nvoid publisher() {\n    //\u4f1a\u7b49\u5f85\u6d88\u8d39\u8005\u6d88\u8d39\u7136\u540e\u8fd4\u56de\u54cd\u5e94\u7ed3\u679c\n    Object res = template.convertSendAndReceive(\"amq.direct\", \"my-yyds\", \"Hello World!\");\n    System.out.println(\"\u6536\u5230\u6d88\u8d39\u8005\u54cd\u5e94\uff1a\"+res);\n}\n</code></pre> <p>\u6d88\u8d39\u8005\u8fd9\u8fb9\u53ea\u9700\u8981\u8fd4\u56de\u4e00\u4e2a\u5bf9\u5e94\u7684\u7ed3\u679c\u5373\u53ef\uff1a</p> <pre><code>@RabbitListener(queues = \"yyds\")\npublic String receiver(String data){\n    System.out.println(\"\u4e00\u53f7\u6d88\u606f\u961f\u5217\u76d1\u542c\u5668 \"+data);\n    return \"\u6536\u5230!\";\n}\n</code></pre> <p>\u6d4b\u8bd5\u6ca1\u6709\u95ee\u9898\uff1a</p> <p></p> <p>\u90a3\u4e48\u5982\u679c\u6211\u4eec\u9700\u8981\u76f4\u63a5\u63a5\u6536\u4e00\u4e2aJSON\u683c\u5f0f\u7684\u6d88\u606f\uff0c\u5e76\u4e14\u5e0c\u671b\u76f4\u63a5\u83b7\u53d6\u5230\u5b9e\u4f53\u7c7b\u5462\uff1f</p> <pre><code>@Data\npublic class User {\n    int id;\n    String name;\n}\n</code></pre> <pre><code>@Configuration\npublic class RabbitConfiguration {\n    ...\n\n    @Bean(\"jacksonConverter\")   //\u76f4\u63a5\u521b\u5efa\u4e00\u4e2a\u7528\u4e8eJSON\u8f6c\u6362\u7684Bean\n    public Jackson2JsonMessageConverter converter(){\n        return new Jackson2JsonMessageConverter();\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u53ea\u9700\u8981\u6307\u5b9a\u8f6c\u6362\u5668\u5c31\u53ef\u4ee5\u4e86\uff1a</p> <pre><code>@Component\npublic class TestListener {\n\n    //\u6307\u5b9amessageConverter\u4e3a\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684Bean\u540d\u79f0\n    @RabbitListener(queues = \"yyds\", messageConverter = \"jacksonConverter\")\n    public void receiver(User user){  //\u76f4\u63a5\u63a5\u6536User\u7c7b\u578b\n        System.out.println(user);\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u76f4\u63a5\u5728\u7ba1\u7406\u9875\u9762\u53d1\u9001\uff1a</p> <pre><code>{\"id\":1,\"name\":\"LB\"}\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6210\u529f\u5b8c\u6210\u4e86\u8f6c\u6362\uff0c\u5e76\u8f93\u51fa\u4e86\u7528\u6237\u4fe1\u606f\uff1a</p> <p></p> <p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u53d1\u9001User\uff0c\u56e0\u4e3a\u6211\u4eec\u521a\u521a\u5df2\u7ecf\u914d\u7f6e\u4e86Jackson2JsonMessageConverter\u4e3aBean\uff0c\u6240\u4ee5\u76f4\u63a5\u4f7f\u7528\u5c31\u53ef\u4ee5\u4e86\uff1a</p> <pre><code>@Test\nvoid publisher() {\n    template.convertAndSend(\"amq.direct\", \"yyds\", new User());\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u540e\u53f0\u7684\u6570\u636e\u7c7b\u578b\u4e3a\uff1a</p> <p></p> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u901a\u8fc7SpringBoot\u5b9e\u73b0\u4e86RabbitMQ\u7684\u7b80\u5355\u4f7f\u7528\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_4","title":"\u6b7b\u4fe1\u961f\u5217","text":"<p>\u6d88\u606f\u961f\u5217\u4e2d\u7684\u6570\u636e\uff0c\u5982\u679c\u8fdf\u8fdf\u6ca1\u6709\u6d88\u8d39\u8005\u6765\u5904\u7406\uff0c\u90a3\u4e48\u5c31\u4f1a\u4e00\u76f4\u5360\u7528\u6d88\u606f\u961f\u5217\u7684\u7a7a\u95f4\u3002\u6bd4\u5982\u6211\u4eec\u6a21\u62df\u4e00\u4e0b\u62a2\u8f66\u7968\u7684\u573a\u666f\uff0c\u7528\u6237\u4e0b\u5355\u9ad8\u94c1\u7968\u4e4b\u540e\uff0c\u4f1a\u8fdb\u884c\u62a2\u5ea7\uff0c\u7136\u540e\u518d\u8fdb\u884c\u4ed8\u6b3e\uff0c\u4f46\u662f\u5982\u679c\u7528\u6237\u4e0b\u5355\u4e4b\u540e\u5e76\u6ca1\u6709\u53ca\u65f6\u7684\u4ed8\u6b3e\uff0c\u8fd9\u5f20\u7968\u4e0d\u53ef\u80fd\u4e00\u76f4\u8ba9\u8fd9\u4e2a\u7528\u6237\u5360\u7528\u7740\uff0c\u56e0\u4e3a\u4f60\u4e0d\u4e70\u522b\u4eba\u8fd8\u8981\u4e70\u5462\uff0c\u6240\u4ee5\u4f1a\u5728\u4e00\u6bb5\u65f6\u95f4\u540e\u8d85\u65f6\uff0c\u8ba9\u8fd9\u5f20\u7968\u53ef\u4ee5\u7ee7\u7eed\u88ab\u5176\u4ed6\u4eba\u8d2d\u4e70\u3002</p> <p>\u8fd9\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u6b7b\u4fe1\u961f\u5217\uff0c\u5c06\u90a3\u4e9b\u7528\u6237\u8d85\u65f6\u672a\u4ed8\u6b3e\u7684\u6216\u662f\u7528\u6237\u4e3b\u52a8\u53d6\u6d88\u7684\u8ba2\u5355\uff0c\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u5904\u7406\uff0c\u4ee5\u4e0b\u7c7b\u578b\u7684\u6d88\u606f\u90fd\u4f1a\u88ab\u5224\u5b9a\u4e3a\u6b7b\u4fe1\uff1a</p> <ul> <li>\u6d88\u606f\u88ab\u62d2\u7edd(basic.reject / basic.nack)\uff0c\u5e76\u4e14requeue = false</li> <li>\u6d88\u606fTTL\u8fc7\u671f</li> <li>\u961f\u5217\u8fbe\u5230\u6700\u5927\u957f\u5ea6</li> </ul> <p></p> <p>\u90a3\u4e48\u5982\u4f55\u6784\u5efa\u8fd9\u6837\u7684\u4e00\u79cd\u4f7f\u7528\u6a21\u5f0f\u5462\uff1f\u5b9e\u9645\u4e0a\u672c\u8d28\u5c31\u662f\u4e00\u4e2a\u6b7b\u4fe1\u4ea4\u6362\u673a+\u7ed1\u5b9a\u7684\u6b7b\u4fe1\u961f\u5217\uff0c\u5f53\u6b63\u5e38\u961f\u5217\u4e2d\u7684\u6d88\u606f\u88ab\u5224\u5b9a\u4e3a\u6b7b\u4fe1\u65f6\uff0c\u4f1a\u88ab\u53d1\u9001\u5230\u5bf9\u5e94\u7684\u6b7b\u4fe1\u4ea4\u6362\u673a\uff0c\u7136\u540e\u518d\u901a\u8fc7\u4ea4\u6362\u673a\u53d1\u9001\u5230\u6b7b\u4fe1\u961f\u5217\u4e2d\uff0c\u6b7b\u4fe1\u961f\u5217\u4e5f\u6709\u5bf9\u5e94\u7684\u6d88\u8d39\u8005\u53bb\u5904\u7406\u6d88\u606f\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u5728\u914d\u7f6e\u7c7b\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6b7b\u4fe1\u4ea4\u6362\u673a\u548c\u6b7b\u4fe1\u961f\u5217\uff0c\u5e76\u8fdb\u884c\u7ed1\u5b9a\uff1a</p> <pre><code>@Configuration\npublic class RabbitConfiguration {\n\n    @Bean(\"directDlExchange\")\n    public Exchange dlExchange(){\n        //\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6b7b\u4fe1\u4ea4\u6362\u673a\n        return ExchangeBuilder.directExchange(\"dlx.direct\").build();\n    }\n\n    @Bean(\"yydsDlQueue\")   //\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6b7b\u4fe1\u961f\u5217\n    public Queue dlQueue(){\n        return QueueBuilder\n                .nonDurable(\"dl-yyds\")\n                .build();\n    }\n\n    @Bean(\"dlBinding\")   //\u6b7b\u4fe1\u4ea4\u6362\u673a\u548c\u6b7b\u4fe1\u961f\u5217\u8fdb\u7ed1\u5b9a\n    public Binding dlBinding(@Qualifier(\"directDlExchange\") Exchange exchange,\n                           @Qualifier(\"yydsDlQueue\") Queue queue){\n        return BindingBuilder\n                .bind(queue)\n                .to(exchange)\n                .with(\"dl-yyds\")\n                .noargs();\n    }\n\n        ...\n\n    @Bean(\"yydsQueue\")\n    public Queue queue(){\n        return QueueBuilder\n                .nonDurable(\"yyds\")\n                .deadLetterExchange(\"dlx.direct\")   //\u6307\u5b9a\u6b7b\u4fe1\u4ea4\u6362\u673a\n                .deadLetterRoutingKey(\"dl-yyds\")   //\u6307\u5b9a\u6b7b\u4fe1RoutingKey\n                .build();\n    }\n\n    ...\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5c06\u76d1\u542c\u5668\u4fee\u6539\u4e3a\u6b7b\u4fe1\u961f\u5217\u76d1\u542c\uff1a</p> <pre><code>@Component\npublic class TestListener {\n    @RabbitListener(queues = \"dl-yyds\", messageConverter = \"jacksonConverter\")\n    public void receiver(User user){\n        System.out.println(user);\n    }\n}\n</code></pre> <p>\u914d\u7f6e\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u6765\u5c1d\u8bd5\u542f\u52a8\u4e00\u4e0b\u5427\uff0c\u6ce8\u610f\u542f\u52a8\u4e4b\u524d\u8bb0\u5f97\u628a\u4e4b\u524d\u7684\u961f\u5217\u7ed9\u5220\u4e86\uff0c\u8fd9\u91cc\u8981\u91cd\u65b0\u5b9a\u4e49\u3002</p> <p></p> <p>\u961f\u5217\u5217\u8868\u4e2d\u5df2\u7ecf\u51fa\u73b0\u4e86\u6211\u4eec\u521a\u521a\u5b9a\u4e49\u597d\u7684\u6b7b\u4fe1\u961f\u5217\uff0c\u5e76\u4e14yyds\u961f\u5217\u4e5f\u652f\u6301\u6b7b\u4fe1\u961f\u5217\u53d1\u9001\u529f\u80fd\u4e86\uff0c\u73b0\u5728\u6211\u4eec\u5c1d\u8bd5\u5411\u6b64\u961f\u5217\u53d1\u9001\u4e00\u4e2a\u6d88\u606f\uff0c\u4f46\u662f\u6211\u4eec\u5c06\u5176\u62d2\u7edd\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u62d2\u7edd\u540e\uff0c\u5982\u679c\u4e0d\u8ba9\u6d88\u606f\u91cd\u65b0\u6392\u961f\uff0c\u90a3\u4e48\u5c31\u4f1a\u53d8\u6210\u6b7b\u4fe1\uff0c\u76f4\u63a5\u88ab\u4e22\u8fdb\u6b7b\u4fe1\u961f\u5217\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u62d2\u7edd\u540e\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0cRabbitMQ\u652f\u6301\u5c06\u8d85\u8fc7\u4e00\u5b9a\u65f6\u95f4\u6ca1\u88ab\u6d88\u8d39\u7684\u6d88\u606f\u81ea\u52a8\u5220\u9664\uff0c\u8fd9\u9700\u8981\u6d88\u606f\u961f\u5217\u8bbe\u5b9aTTL\u503c\uff0c\u5982\u679c\u6d88\u606f\u7684\u5b58\u6d3b\u65f6\u95f4\u8d85\u8fc7\u4e86Time To Live\u503c\uff0c\u5c31\u4f1a\u88ab\u81ea\u52a8\u5220\u9664\uff0c\u81ea\u52a8\u5220\u9664\u540e\u7684\u6d88\u606f\u5982\u679c\u6709\u6b7b\u4fe1\u961f\u5217\uff0c\u90a3\u4e48\u5c31\u4f1a\u8fdb\u5165\u5230\u6b7b\u4fe1\u961f\u5217\u4e2d\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u5c06yyds\u6d88\u606f\u961f\u5217\u8bbe\u5b9aTTL\u503c\uff08\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\uff1a</p> <pre><code>@Bean(\"yydsQueue\")\npublic Queue queue(){\n    return QueueBuilder\n            .nonDurable(\"yyds\")\n            .deadLetterExchange(\"dlx.direct\")\n            .deadLetterRoutingKey(\"dl-yyds\")\n            .ttl(5000)   //\u5982\u679c5\u79d2\u6ca1\u5904\u7406\uff0c\u5c31\u81ea\u52a8\u5220\u9664\n            .build();\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u91cd\u542f\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u6ce8\u610f\u4fee\u6539\u4e86\u4e4b\u540e\u8bb0\u5f97\u5220\u9664\u4e4b\u524d\u7684yyds\u961f\u5217\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u73b0\u5728yyds\u961f\u5217\u5df2\u7ecf\u5177\u6709TTL\u7279\u6027\u4e86\uff0c\u6211\u4eec\u73b0\u5728\u6765\u63d2\u5165\u4e00\u4e2a\u65b0\u7684\u6d88\u606f\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6d88\u606f5\u79d2\u949f\u4e4b\u540e\u5c31\u4e0d\u89c1\u4e86\uff0c\u800c\u662f\u88ab\u4e22\u8fdb\u4e86\u6b7b\u4fe1\u961f\u5217\u4e2d\u3002</p> <p>\u6700\u540e\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u5f53\u6d88\u606f\u961f\u5217\u957f\u5ea6\u8fbe\u5230\u6700\u5927\u7684\u60c5\u51b5\uff0c\u73b0\u5728\u6211\u4eec\u5c06\u6d88\u606f\u961f\u5217\u7684\u957f\u5ea6\u8fdb\u884c\u9650\u5236\uff1a</p> <pre><code>@Bean(\"yydsQueue\")\npublic Queue queue(){\n    return QueueBuilder\n            .nonDurable(\"yyds\")\n            .deadLetterExchange(\"dlx.direct\")\n            .deadLetterRoutingKey(\"dl-yyds\")\n            .maxLength(3)   //\u5c06\u6700\u5927\u957f\u5ea6\u8bbe\u5b9a\u4e3a3\n            .build();\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u91cd\u542f\u4e00\u4e0b\uff0c\u7136\u540e\u5c1d\u8bd5\u8fde\u7eed\u63d2\u51654\u4e2a\u6d88\u606f\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230yyds\u6d88\u606f\u961f\u5217\u65b0\u589e\u4e86Limit\u7279\u6027\uff0c\u4e5f\u5c31\u662f\u9650\u5b9a\u957f\u5ea6\uff1a</p> <pre><code>@Test\nvoid publisher() {\n    for (int i = 0; i &lt; 4; i++) \n        template.convertAndSend(\"amq.direct\", \"my-yyds\", new User());\n}\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u56e0\u4e3a\u957f\u5ea6\u9650\u5236\u4e3a3\uff0c\u6240\u4ee5\u6709\u4e00\u4e2a\u6d88\u606f\u76f4\u63a5\u88ab\u4e22\u8fdb\u4e86\u6b7b\u4fe1\u961f\u5217\u4e2d\uff0c\u4e3a\u4e86\u80fd\u591f\u66f4\u76f4\u89c2\u5730\u89c2\u5bdf\u6d88\u606f\u961f\u5217\u7684\u673a\u5236\uff0c\u6211\u4eec\u4e3aUser\u7c7b\u65b0\u589e\u4e00\u4e2a\u65f6\u95f4\u5b57\u6bb5\uff1a</p> <pre><code>@Data\npublic class User {\n    int id;\n    String name;\n    String date = new Date().toString();\n}\n</code></pre> <p>\u63a5\u7740\u6bcf\u9694\u4e00\u79d2\u949f\u63d2\u5165\u4e00\u4e2a\uff1a</p> <pre><code>@Test\nvoid publisher() throws InterruptedException {\n    for (int i = 0; i &lt; 4; i++) {\n        Thread.sleep(1000);\n        template.convertAndSend(\"amq.direct\", \"my-yyds\", new User());\n    }\n}\n</code></pre> <p>\u518d\u6b21\u8fdb\u884c\u4e0a\u8ff0\u5b9e\u9a8c\uff0c\u53ef\u4ee5\u53d1\u73b0\u5982\u679c\u5230\u8fbe\u961f\u5217\u957f\u5ea6\u9650\u5236\uff0c\u90a3\u4e48\u6bcf\u6b21\u63d2\u5165\u90fd\u4f1a\u628a\u4f4d\u4e8e\u961f\u9996\u7684\u6d88\u606f\u4e22\u8fdb\u6b7b\u4fe1\u961f\u5217\uff0c\u6765\u817e\u51fa\u7a7a\u95f4\u7ed9\u65b0\u6765\u7684\u6d88\u606f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_5","title":"\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f","text":"<p>\u6ce8\u610f\uff1aXX\u6a21\u5f0f\u53ea\u662f\u4e00\u79cd\u8bbe\u8ba1\u601d\u8def\uff0c\u5e76\u4e0d\u662f\u6307\u7684\u5177\u4f53\u7684\u67d0\u79cd\u5b9e\u73b0\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u5b9e\u73b0XX\u6a21\u5f0f\u9700\u8981\u600e\u4e48\u53bb\u5199\u3002</p> <p>\u524d\u9762\u6211\u4eec\u4e86\u89e3\u4e86\u6700\u7b80\u7684\u4e00\u4e2a\u6d88\u8d39\u8005\u4e00\u4e2a\u751f\u4ea7\u8005\u7684\u6a21\u5f0f\uff0c\u63a5\u7740\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0b\u4e00\u4e2a\u751f\u4ea7\u8005\u591a\u4e2a\u6d88\u8d39\u8005\u7684\u60c5\u51b5\uff1a</p> <p></p> <p>\u5b9e\u9645\u4e0a\u8fd9\u79cd\u6a21\u5f0f\u5c31\u975e\u5e38\u9002\u5408\u591a\u4e2a\u5de5\u4eba\u7b49\u5f85\u65b0\u7684\u4efb\u52a1\u5230\u6765\u7684\u573a\u666f\uff0c\u6211\u4eec\u7684\u4efb\u52a1\u6709\u5f88\u591a\u4e2a\uff0c\u4e00\u4e2a\u4e00\u4e2a\u4e22\u8fdb\u6d88\u606f\u961f\u5217\uff0c\u800c\u6b64\u65f6\u5de5\u4eba\u6709\u5f88\u591a\u4e2a\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u4efb\u52a1\u5206\u914d\u4e2a\u5404\u4e2a\u5de5\u4eba\uff0c\u8ba9\u4ed6\u4eec\u5404\u81ea\u8d1f\u8d23\u4e00\u4e9b\u4efb\u52a1\uff0c\u5e76\u4e14\u505a\u7684\u5feb\u7684\u5de5\u4eba\u8fd8\u53ef\u4ee5\u505a\u5b8c\u6210\u4e00\u4e9b\uff08\u80fd\u8005\u591a\u52b3\uff09\u3002</p> <p>\u975e\u5e38\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u9700\u8981\u521b\u5efa\u4e24\u4e2a\u76d1\u542c\u5668\u5373\u53ef\uff1a</p> <pre><code>@Component\npublic class TestListener {\n    @RabbitListener(queues = \"yyds\")\n    public void receiver(String data){   //\u8fd9\u91cc\u76f4\u63a5\u63a5\u6536String\u7c7b\u578b\u7684\u6570\u636e\n        System.out.println(\"\u4e00\u53f7\u6d88\u606f\u961f\u5217\u76d1\u542c\u5668 \"+data);\n    }\n\n    @RabbitListener(queues = \"yyds\")\n    public void receiver2(String data){\n        System.out.println(\"\u4e8c\u53f7\u6d88\u606f\u961f\u5217\u76d1\u542c\u5668 \"+data);\n    }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u53d1\u9001\u6d88\u606f\u65f6\uff0c\u4f1a\u81ea\u52a8\u8fdb\u884c\u8f6e\u8be2\u5206\u53d1\uff1a</p> <p></p> <p>\u90a3\u4e48\u5982\u679c\u6211\u4eec\u4e00\u5f00\u59cb\u5c31\u5728\u6d88\u606f\u961f\u5217\u4e2d\u653e\u5165\u4e00\u90e8\u5206\u6d88\u606f\u5728\u5f00\u542f\u6d88\u8d39\u8005\u5462\uff1f</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u662f\u4e00\u5f00\u59cb\u5c31\u5b58\u5728\u6d88\u606f\uff0c\u4f1a\u88ab\u4e00\u4e2a\u6d88\u8d39\u8005\u4e00\u6b21\u6027\u5168\u90e8\u6d88\u8017\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u5bf9\u6d88\u8d39\u8005\u7684Prefetch count\uff08\u9884\u83b7\u53d6\u6570\u91cf\uff0c\u4e00\u6b21\u6027\u83b7\u53d6\u6d88\u606f\u7684\u6700\u5927\u6570\u91cf\uff09\u8fdb\u884c\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u73b0\u5728\u5e0c\u671b\u7684\u662f\u6d88\u8d39\u8005\u4e00\u6b21\u53ea\u80fd\u62ff\u4e00\u4e2a\u6d88\u606f\uff0c\u800c\u4e0d\u662f\u5c06\u6240\u6709\u7684\u6d88\u606f\u5168\u90e8\u90fd\u83b7\u53d6\u3002</p> <p></p> <p>\u56e0\u6b64\u6211\u4eec\u9700\u8981\u5bf9\u8fd9\u4e2a\u6570\u91cf\u8fdb\u884c\u4e00\u4e9b\u914d\u7f6e\uff0c\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u7c7b\u4e2d\u5b9a\u4e49\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684ListenerContainerFactory\uff0c\u53ef\u4ee5\u5728\u8fd9\u91cc\u8bbe\u5b9a\u6d88\u8d39\u8005Channel\u7684PrefetchCount\u7684\u5927\u5c0f\uff1a</p> <pre><code>@Resource\nprivate CachingConnectionFactory connectionFactory;\n\n@Bean(name = \"listenerContainer\")\npublic SimpleRabbitListenerContainerFactory listenerContainer(){\n    SimpleRabbitListenerContainerFactory factory = new SimpleRabbitListenerContainerFactory();\n    factory.setConnectionFactory(connectionFactory);\n    factory.setPrefetchCount(1);   //\u5c06PrefetchCount\u8bbe\u5b9a\u4e3a1\u8868\u793a\u4e00\u6b21\u53ea\u80fd\u53d6\u4e00\u4e2a\n    return factory;\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728\u76d1\u542c\u5668\u8fd9\u8fb9\u6307\u5b9a\u5373\u53ef\uff1a</p> <pre><code>@Component\npublic class TestListener {\n    @RabbitListener(queues = \"yyds\",  containerFactory = \"listenerContainer\")\n    public void receiver(String data){\n        System.out.println(\"\u4e00\u53f7\u6d88\u606f\u961f\u5217\u76d1\u542c\u5668 \"+data);\n    }\n\n    @RabbitListener(queues = \"yyds\", containerFactory = \"listenerContainer\")\n    public void receiver2(String data){\n        System.out.println(\"\u4e8c\u53f7\u6d88\u606f\u961f\u5217\u76d1\u542c\u5668 \"+data);\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u518d\u6b21\u542f\u52a8\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u770b\u5230PrefetchCount\u88ab\u9650\u5b9a\u4e3a1\u4e86\uff1a</p> <p></p> <p>\u518d\u6b21\u91cd\u590d\u4e0a\u8ff0\u7684\u5b9e\u73b0\uff0c\u53ef\u4ee5\u770b\u5230\u6d88\u606f\u4e0d\u4f1a\u88ab\u4e00\u53f7\u6d88\u8d39\u8005\u7ed9\u5168\u90e8\u62a2\u8d70\u4e86\uff1a</p> <p></p> <p>\u5f53\u7136\u9664\u4e86\u53bb\u5b9a\u4e49\u4e24\u4e2a\u76f8\u540c\u7684\u76d1\u542c\u5668\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5728\u6ce8\u89e3\u4e2d\u5b9a\u4e49\uff0c\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u9700\u898110\u4e2a\u540c\u6837\u7684\u6d88\u8d39\u8005\uff1a</p> <pre><code>@Component\npublic class TestListener {\n    @RabbitListener(queues = \"yyds\",  containerFactory = \"listenerContainer\", concurrency = \"10\")\n    public void receiver(String data){\n        System.out.println(\"\u4e00\u53f7\u6d88\u606f\u961f\u5217\u76d1\u542c\u5668 \"+data);\n    }\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u5728\u7ba1\u7406\u9875\u9762\u4e2d\u51fa\u73b0\u4e8610\u4e2a\u6d88\u8d39\u8005\uff1a</p> <p></p> <p>\u81f3\u6b64\uff0c\u6709\u5173\u5de5\u4f5c\u961f\u5217\u6a21\u5f0f\u5c31\u8bb2\u5230\u8fd9\u91cc\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_6","title":"\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86RabbitMQ\u5ba2\u6237\u7aef\u7684\u4e00\u4e9b\u57fa\u672c\u64cd\u4f5c\uff0c\u5305\u62ec\u666e\u901a\u7684\u6d88\u606f\u6a21\u5f0f\uff0c\u63a5\u7740\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0b\u5176\u4ed6\u7684\u6a21\u5f0f\uff0c\u9996\u5148\u662f\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\uff0c\u5b83\u652f\u6301\u591a\u79cd\u65b9\u5f0f\uff1a</p> <p></p> <p>\u6bd4\u5982\u6211\u4eec\u5728\u963f\u91cc\u4e91\u4e70\u4e86\u4e91\u670d\u52a1\u5668\uff0c\u4f46\u662f\u6700\u8fd1\u5feb\u5230\u671f\u4e86\uff0c\u90a3\u4e48\u5c31\u4f1a\u7ed9\u4f60\u7684\u624b\u673a\u3001\u90ae\u7bb1\u53d1\u9001\u6d88\u606f\uff0c\u544a\u8bc9\u4f60\u9700\u8981\u53bb\u7eed\u8d39\u4e86\uff0c\u4f46\u662f\u624b\u673a\u77ed\u4fe1\u548c\u90ae\u4ef6\u53d1\u9001\u5e76\u4e0d\u4e00\u5b9a\u662f\u540c\u4e00\u4e2a\u4e1a\u52a1\u63d0\u4f9b\u7684\uff0c\u4f46\u662f\u73b0\u5728\u6211\u4eec\u53c8\u5e0c\u671b\u80fd\u591f\u90fd\u53bb\u6267\u884c\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u7528\u5230\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\uff0c\u7b80\u800c\u8a00\u4e4b\u5c31\u662f\uff0c\u53d1\u5e03\u4e00\u6b21\uff0c\u6d88\u8d39\u591a\u4e2a\u3002</p> <p>\u5b9e\u73b0\u8fd9\u79cd\u6a21\u5f0f\u5176\u5b9e\u4e5f\u975e\u5e38\u7b80\u5355\uff0c\u4f46\u662f\u5982\u679c\u4f7f\u7528\u6211\u4eec\u4e4b\u524d\u7684\u76f4\u8fde\u4ea4\u6362\u673a\uff0c\u80af\u5b9a\u662f\u4e0d\u884c\u7684\uff0c\u6211\u4eec\u8fd9\u91cc\u9700\u8981\u7528\u5230\u53e6\u4e00\u79cd\u7c7b\u578b\u7684\u4ea4\u6362\u673a\uff0c\u53eb\u505a<code>fanout</code>\uff08\u6247\u51fa\uff09\u7c7b\u578b\uff0c\u8fd9\u65f6\u4e00\u79cd\u5e7f\u64ad\u7c7b\u578b\uff0c\u6d88\u606f\u4f1a\u88ab\u5e7f\u64ad\u5230\u6240\u6709\u4e0e\u6b64\u4ea4\u6362\u673a\u7ed1\u5b9a\u7684\u6d88\u606f\u961f\u5217\u4e2d\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u9ed8\u8ba4\u7684\u4ea4\u6362\u673a\uff1a</p> <p></p> <p>\u8fd9\u4e2a\u4ea4\u6362\u673a\u662f\u4e00\u4e2a<code>fanout</code>\u7c7b\u578b\u7684\u4ea4\u6362\u673a\uff0c\u6211\u4eec\u5c31\u662f\u8981\u5b83\u5c31\u884c\u4e86\uff1a</p> <pre><code>@Configuration\npublic class RabbitConfiguration {\n\n    @Bean(\"fanoutExchange\")\n    public Exchange exchange(){\n        //\u6ce8\u610f\u8fd9\u91cc\u662ffanoutExchange\n        return ExchangeBuilder.fanoutExchange(\"amq.fanout\").build();\n    }\n\n    @Bean(\"yydsQueue1\")\n    public Queue queue(){\n        return QueueBuilder.nonDurable(\"yyds1\").build();\n    }\n\n    @Bean(\"binding\")\n    public Binding binding(@Qualifier(\"fanoutExchange\") Exchange exchange,\n                           @Qualifier(\"yydsQueue1\") Queue queue){\n        return BindingBuilder\n                .bind(queue)\n                .to(exchange)\n                .with(\"yyds1\")\n                .noargs();\n    }\n\n    @Bean(\"yydsQueue2\")\n    public Queue queue2(){\n        return QueueBuilder.nonDurable(\"yyds2\").build();\n    }\n\n    @Bean(\"binding2\")\n    public Binding binding2(@Qualifier(\"fanoutExchange\") Exchange exchange,\n                           @Qualifier(\"yydsQueue2\") Queue queue){\n        return BindingBuilder\n                .bind(queue)\n                .to(exchange)\n                .with(\"yyds2\")\n                .noargs();\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u6211\u4eec\u5c06\u4e24\u4e2a\u961f\u5217\u90fd\u7ed1\u5b9a\u5230\u6b64\u4ea4\u6362\u673a\u4e0a\uff0c\u6211\u4eec\u5148\u542f\u52a8\u770b\u770b\u6548\u679c\uff1a</p> <p></p> <p>\u7ed1\u5b9a\u6ca1\u6709\u4ec0\u4e48\u95ee\u9898\uff0c\u63a5\u7740\u6211\u4eec\u641e\u4e24\u4e2a\u76d1\u542c\u5668\uff0c\u76d1\u542c\u4e00\u4e0b\u8fd9\u4e24\u4e2a\u961f\u5217\uff1a</p> <pre><code>@Component\npublic class TestListener {\n    @RabbitListener(queues = \"yyds1\")\n    public void receiver(String data){\n        System.out.println(\"\u4e00\u53f7\u6d88\u606f\u961f\u5217\u76d1\u542c\u5668 \"+data);\n    }\n\n    @RabbitListener(queues = \"yyds2\")\n    public void receiver2(String data){\n        System.out.println(\"\u4e8c\u53f7\u6d88\u606f\u961f\u5217\u76d1\u542c\u5668 \"+data);\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u901a\u8fc7\u4ea4\u6362\u673a\u53d1\u9001\u6d88\u606f\uff0c\u770b\u770b\u662f\u4e0d\u662f\u4e24\u4e2a\u76d1\u542c\u5668\u90fd\u4f1a\u63a5\u6536\u5230\u6d88\u606f\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u786e\u5b9e\u662f\u4e24\u4e2a\u6d88\u606f\u961f\u5217\u90fd\u80fd\u591f\u63a5\u53d7\u5230\u6b64\u6d88\u606f\uff1a</p> <p></p> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_7","title":"\u8def\u7531\u6a21\u5f0f","text":"<p>\u8def\u7531\u6a21\u5f0f\u5b9e\u9645\u4e0a\u6211\u4eec\u4e00\u5f00\u59cb\u5c31\u5df2\u7ecf\u5b9e\u73b0\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7ed1\u5b9a\u65f6\u6307\u5b9a\u60f3\u8981\u7684<code>routingKey</code>\u53ea\u6709\u751f\u4ea7\u8005\u53d1\u9001\u65f6\u6307\u5b9a\u4e86\u5bf9\u5e94\u7684<code>routingKey</code>\u624d\u80fd\u5230\u8fbe\u5bf9\u5e94\u7684\u961f\u5217\u3002</p> <p></p> <p>\u5f53\u7136\u9664\u4e86\u6211\u4eec\u4e4b\u524d\u7684\u4e00\u6b21\u7ed1\u5b9a\u4e4b\u5916\uff0c\u540c\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u53ef\u4ee5\u591a\u6b21\u7ed1\u5b9a\u5230\u4ea4\u6362\u673a\uff0c\u5e76\u4e14\u4f7f\u7528\u4e0d\u540c\u7684<code>routingKey</code>\uff0c\u8fd9\u6837\u53ea\u8981\u6ee1\u8db3\u5176\u4e2d\u4e00\u4e2a\u90fd\u53ef\u4ee5\u88ab\u53d1\u9001\u5230\u6b64\u6d88\u606f\u961f\u5217\u4e2d\uff1a</p> <pre><code>@Configuration\npublic class RabbitConfiguration {\n\n    @Bean(\"directExchange\")\n    public Exchange exchange(){\n        return ExchangeBuilder.directExchange(\"amq.direct\").build();\n    }\n\n    @Bean(\"yydsQueue\")\n    public Queue queue(){\n        return QueueBuilder.nonDurable(\"yyds\").build();\n    }\n\n    @Bean(\"binding\")   //\u4f7f\u7528yyds1\u7ed1\u5b9a\n    public Binding binding(@Qualifier(\"directExchange\") Exchange exchange,\n                           @Qualifier(\"yydsQueue\") Queue queue){\n        return BindingBuilder\n                .bind(queue)\n                .to(exchange)\n                .with(\"yyds1\")\n                .noargs();\n    }\n\n    @Bean(\"binding2\")   //\u4f7f\u7528yyds2\u7ed1\u5b9a\n    public Binding binding2(@Qualifier(\"directExchange\") Exchange exchange,\n                           @Qualifier(\"yydsQueue\") Queue queue){\n        return BindingBuilder\n                .bind(queue)\n                .to(exchange)\n                .with(\"yyds2\")\n                .noargs();\n    }\n}\n</code></pre> <p>\u542f\u52a8\u540e\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7ba1\u7406\u9762\u677f\u4e2d\u51fa\u73b0\u4e86\u4e24\u4e2a\u7ed1\u5b9a\u5173\u7cfb\uff1a</p> <p></p> <p>\u8fd9\u91cc\u53ef\u4ee5\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u968f\u4fbf\u4f7f\u7528\u54ea\u4e2a<code>routingKey</code>\u90fd\u53ef\u4ee5\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_8","title":"\u4e3b\u9898\u6a21\u5f0f","text":"<p>\u5b9e\u9645\u4e0a\u8fd9\u79cd\u6a21\u5f0f\u5c31\u662f\u4e00\u79cd\u6a21\u7cca\u5339\u914d\u7684\u6a21\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06<code>routingKey</code>\u4ee5\u6a21\u7cca\u5339\u914d\u7684\u65b9\u5f0f\u53bb\u8fdb\u884c\u8f6c\u53d1\u3002</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>*</code>\u6216<code>#</code>\u6765\u8868\u793a\uff1a</p> <ul> <li>* - \u8868\u793a\u4efb\u610f\u7684\u4e00\u4e2a\u5355\u8bcd</li> <li># - \u8868\u793a0\u4e2a\u6216\u591a\u4e2a\u5355\u8bcd</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <pre><code>@Configuration\npublic class RabbitConfiguration {\n\n    @Bean(\"topicExchange\")  //\u8fd9\u91cc\u4f7f\u7528\u9884\u7f6e\u7684Topic\u7c7b\u578b\u4ea4\u6362\u673a\n    public Exchange exchange(){\n        return ExchangeBuilder.topicExchange(\"amq.topic\").build();\n    }\n\n    @Bean(\"yydsQueue\")\n    public Queue queue(){\n        return QueueBuilder.nonDurable(\"yyds\").build();\n    }\n\n    @Bean(\"binding\")\n    public Binding binding2(@Qualifier(\"topicExchange\") Exchange exchange,\n                           @Qualifier(\"yydsQueue\") Queue queue){\n        return BindingBuilder\n                .bind(queue)\n                .to(exchange)\n                .with(\"*.test.*\")\n                .noargs();\n    }\n}\n</code></pre> <p>\u542f\u52a8\u9879\u76ee\uff0c\u53ef\u4ee5\u770b\u5230\u53ea\u8981\u662f\u6ee1\u8db3\u901a\u914d\u7b26\u6761\u4ef6\u7684\u90fd\u53ef\u4ee5\u6210\u529f\u8f6c\u53d1\u5230\u5bf9\u5e94\u7684\u6d88\u606f\u961f\u5217\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u53ef\u4ee5\u518d\u8bd5\u8bd5\u770b<code>#</code>\u901a\u914d\u7b26\u3002</p> <p>\u9664\u4e86\u6211\u4eec\u8fd9\u91cc\u4f7f\u7528\u7684\u9ed8\u8ba4\u4e3b\u9898\u4ea4\u6362\u673a\u4e4b\u5916\uff0c\u8fd8\u6709\u4e00\u4e2a\u53eb\u505a<code>amq.rabbitmq.trace</code>\u7684\u4ea4\u6362\u673a\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5b83\u4e5f\u662f<code>topic</code>\u7c7b\u578b\u7684\uff0c\u90a3\u4e48\u8fd9\u4e2a\u4ea4\u6362\u673a\u662f\u505a\u4ec0\u4e48\u7684\u5462\uff1f\u5b9e\u9645\u4e0a\u8fd9\u662f\u7528\u4e8e\u5e2e\u52a9\u6211\u4eec\u8bb0\u5f55\u548c\u8ffd\u8e2a\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4f7f\u7528\u6d88\u606f\u961f\u5217\u7684\u4ea4\u6362\u673a\uff0c\u5b83\u662f\u4e00\u4e2a\u5185\u90e8\u7684\u4ea4\u6362\u673a\uff0c\u90a3\u4e48\u5982\u679c\u4f7f\u7528\u5462\uff1f\u9996\u5148\u521b\u5efa\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u7528\u4e8e\u63a5\u6536\u8bb0\u5f55\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5728\u63a7\u5236\u53f0\u5c06\u865a\u62df\u4e3b\u673a<code>/test</code>\u7684\u8ffd\u8e2a\u529f\u80fd\u5f00\u542f\uff1a</p> <pre><code>sudo rabbitmqctl trace_on -p /test\n</code></pre> <p>\u5f00\u542f\u540e\uff0c\u6211\u4eec\u5c06\u6b64\u961f\u5217\u7ed1\u5b9a\u5230\u4e0a\u9762\u7684\u4ea4\u6362\u673a\u4e0a\uff1a</p> <p></p> <p></p> <p>\u7531\u4e8e\u53d1\u9001\u5230\u6b64\u4ea4\u6362\u673a\u4e0a\u7684<code>routingKey</code>\u4e3arouting key\u4e3a publish.\u4ea4\u6362\u673a\u540d\u79f0 \u548c deliver.\u961f\u5217\u540d\u79f0\uff0c\u5206\u522b\u5bf9\u5e94\u751f\u4ea7\u8005\u6295\u9012\u5230\u4ea4\u6362\u673a\u7684\u6d88\u606f\uff0c\u548c\u6d88\u8d39\u8005\u4ece\u961f\u5217\u4e0a\u83b7\u53d6\u7684\u6d88\u606f\uff0c\u56e0\u6b64\u8fd9\u91cc\u4f7f\u7528<code>#</code>\u901a\u914d\u7b26\u8fdb\u884c\u7ed1\u5b9a\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u6bd4\u5982\u8fd8\u662f\u5f80yyds\u961f\u5217\u53d1\u9001\u6d88\u606f\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5728\u53d1\u9001\u6d88\u606f\uff0c\u5e76\u4e14\u6d88\u8d39\u8005\u5df2\u7ecf\u5904\u7406\u4e4b\u540e\uff0c<code>trace</code>\u961f\u5217\u4e2d\u65b0\u589e\u4e86\u4e24\u6761\u6d88\u606f\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770b\u90fd\u662f\u4e9b\u4ec0\u4e48\u6d88\u606f\uff1a</p> <p></p> <p>\u901a\u8fc7\u8ffd\u8e2a\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u660e\u786e\u5730\u5f97\u77e5\u6d88\u606f\u53d1\u9001\u7684\u4ea4\u6362\u673a\u3001routingKey\u3001\u7528\u6237\u7b49\u4fe1\u606f\uff0c\u5305\u62ec\u4fe1\u606f\u672c\u8eab\uff0c\u540c\u6837\u7684\uff0c\u6d88\u8d39\u8005\u5728\u53d6\u51fa\u6570\u636e\u65f6\u4e5f\u6709\u8bb0\u5f55\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u660e\u786e\u6d88\u8d39\u8005\u7684\u5730\u5740\u3001\u7aef\u53e3\u3001\u5177\u4f53\u64cd\u4f5c\u7684\u961f\u5217\u4ee5\u53ca\u53d6\u51fa\u7684\u6d88\u606f\u4fe1\u606f\u7b49\u3002</p> <p>\u5230\u8fd9\u91cc\uff0c\u6211\u4eec\u5c31\u5df2\u7ecf\u4e86\u89e3\u4e863\u79cd\u7c7b\u578b\u7684\u4ea4\u6362\u673a\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_9","title":"\u7b2c\u56db\u79cd\u4ea4\u6362\u673a\u7c7b\u578b","text":"<p>\u901a\u8fc7\u524d\u9762\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u5df2\u7ecf\u4ecb\u7ecd\u4e86\u4e09\u79cd\u4ea4\u6362\u673a\u7c7b\u578b\uff0c\u73b0\u5728\u6211\u4eec\u6765\u4ecb\u7ecd\u4e00\u4e0b\u7b2c\u56db\u79cd\u4ea4\u6362\u673a\u7c7b\u578b<code>header</code>\uff0c\u5b83\u662f\u6839\u636e\u5934\u90e8\u4fe1\u606f\u6765\u51b3\u5b9a\u7684\uff0c\u5728\u6211\u4eec\u53d1\u9001\u7684\u6d88\u606f\u4e2d\u662f\u53ef\u4ee5\u643a\u5e26\u4e00\u4e9b\u5934\u90e8\u4fe1\u606f\u7684\uff08\u7c7b\u4f3c\u4e8eHTTP\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u8fd9\u4e9b\u5934\u90e8\u4fe1\u606f\u6765\u51b3\u5b9a\u8def\u7531\u5230\u54ea\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u4e2d\u3002</p> <pre><code>@Configuration\npublic class RabbitConfiguration {\n\n    @Bean(\"headerExchange\")  //\u6ce8\u610f\u8fd9\u91cc\u8fd4\u56de\u7684\u662fHeadersExchange\n    public HeadersExchange exchange(){\n        return ExchangeBuilder\n                .headersExchange(\"amq.headers\")  //RabbitMQ\u4e3a\u6211\u4eec\u9884\u7f6e\u4e86\u4e24\u4e2a\uff0c\u8fd9\u91cc\u7528\u7b2c\u4e00\u4e2a\u5c31\u884c\n                .build();\n    }\n\n    @Bean(\"yydsQueue\")\n    public Queue queue(){\n        return QueueBuilder.nonDurable(\"yyds\").build();\n    }\n\n    @Bean(\"binding\")\n    public Binding binding2(@Qualifier(\"headerExchange\") HeadersExchange exchange,  //\u8fd9\u91cc\u548c\u4e0a\u9762\u4e00\u6837\u7684\u7c7b\u578b\n                           @Qualifier(\"yydsQueue\") Queue queue){\n        return BindingBuilder\n                .bind(queue)\n                .to(exchange)   //\u4f7f\u7528HeadersExchange\u7684to\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8fdb\u884c\u8fdb\u4e00\u6b65\u914d\u7f6e\n                    //.whereAny(\"a\", \"b\").exist();   \u8fd9\u4e2a\u662f\u53ea\u8981\u5b58\u5728\u4efb\u610f\u4e00\u4e2a\u6307\u5b9a\u7684\u5934\u90e8Key\u5c31\u884c\n                //.whereAll(\"a\", \"b\").exist();   \u8fd9\u4e2a\u662f\u5fc5\u987b\u5b58\u5728\u6240\u6709\u6307\u5b9a\u7684\u7684\u5934\u90e8Key\n                .where(\"test\").matches(\"hello\");   //\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u9700\u8981\u6d88\u606f\u7684\u5934\u90e8\u4fe1\u606f\u4e2d\u5305\u542btest\uff0c\u5e76\u4e14\u503c\u4e3ahello\u624d\u80fd\u8f6c\u53d1\u7ed9\u6211\u4eec\u7684\u6d88\u606f\u961f\u5217\n                        //.whereAny(Collections.singletonMap(\"test\", \"hello\")).match();  \u4f20\u5165Map\u4e5f\u884c\uff0c\u6279\u91cf\u6307\u5b9a\u952e\u503c\u5bf9\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u6765\u542f\u52a8\u4e00\u4e0b\u8bd5\u8bd5\u770b\uff1a</p> <p></p> <p>\u7ed3\u679c\u53d1\u73b0\uff0c\u6d88\u606f\u53ef\u4ee5\u6210\u529f\u53d1\u9001\u5230\u6d88\u606f\u961f\u5217\uff0c\u8fd9\u5c31\u662f\u4f7f\u7528\u5934\u90e8\u4fe1\u606f\u8fdb\u884c\u8def\u7531\u3002</p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u4ecb\u7ecd\u5b8c\u4e86\u6240\u6709\u56db\u79cd\u7c7b\u578b\u7684\u4ea4\u6362\u673a\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#_10","title":"\u96c6\u7fa4\u642d\u5efa","text":"<p>\u524d\u9762\u6211\u4eec\u5bf9\u4e8eRabbitMQ\u7684\u76f8\u5173\u5185\u5bb9\u5df2\u7ecf\u57fa\u672c\u8bb2\u89e3\u5b8c\u6bd5\u4e86\uff0c\u6700\u540e\u6211\u4eec\u6765\u5c1d\u8bd5\u642d\u5efa\u4e00\u4e2a\u96c6\u7fa4\uff0c\u8ba9RabbitMQ\u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u590d\u5236\uff08\u955c\u50cf\u6a21\u5f0f\uff09\u7a0d\u5fae\u6709\u70b9\u9ebb\u70e6\uff0c\u8ddf\u7740\u89c6\u9891\u8d70\u5427\u3002</p> <p>\u53ef\u80fd\u4f1a\u7528\u5230\u7684\u4e00\u4e9b\u547d\u4ee4\uff1a</p> <pre><code>sudo rabbitmqctl stop_app\nsudo rabbitmqctl join_cluster rabbit@ubuntu-server\nsudo rabbitmqctl start_app\n</code></pre> <p>\u5b9e\u73b0\u590d\u5236\u5373\u53ef\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#springcloud","title":"SpringCloud \u6d88\u606f\u7ec4\u4ef6","text":"<p>\u524d\u9762\u6211\u4eec\u5df2\u7ecf\u5b66\u4e60\u4e86\u5982\u4f55\u4f7f\u7528RabbitMQ\u6d88\u606f\u961f\u5217\uff0c\u63a5\u7740\u6211\u4eec\u6765\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0bSpringCloud\u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u4e00\u4e9b\u6d88\u606f\u7ec4\u4ef6\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#springcloud-stream","title":"SpringCloud Stream","text":"<p>\u5b98\u65b9\u6587\u6863\uff1ahttps://docs.spring.io/spring-cloud-stream/docs/3.2.2/reference/html/</p> <p>\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u4e86RabbitMQ\uff0c\u4e86\u89e3\u4e86\u6d88\u606f\u961f\u5217\u76f8\u5173\u7684\u4e00\u4e9b\u64cd\u4f5c\uff0c\u4f46\u662f\u53ef\u80fd\u6211\u4eec\u4f1a\u9047\u5230\u4e0d\u540c\u7684\u7cfb\u7edf\u5728\u7528\u4e0d\u540c\u7684\u6d88\u606f\u961f\u5217\uff0c\u6bd4\u5982\u7cfb\u7edfA\u7528\u7684Kafka\u3001\u7cfb\u7edfB\u7528\u7684RabbitMQ\uff0c\u4f46\u662f\u6211\u4eec\u73b0\u5728\u53c8\u6ca1\u6709\u5b66\u4e60\u8fc7Kafka\uff0c\u90a3\u4e48\u600e\u4e48\u529e\u5462\uff1f\u6709\u6ca1\u6709\u4e00\u79cd\u65b9\u5f0f\u50cfJDBC\u4e00\u6837\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5173\u5fc3SQL\u548c\u4e1a\u52a1\u672c\u8eab\uff0c\u800c\u4e0d\u7528\u5173\u5fc3\u6570\u636e\u5e93\u7684\u5177\u4f53\u5b9e\u73b0\u5462\uff1f</p> <p>SpringCloud Stream\u80fd\u591f\u505a\u5230\uff0c\u5b83\u80fd\u591f\u5c4f\u853d\u5e95\u5c42\u5b9e\u73b0\uff0c\u6211\u4eec\u4f7f\u7528\u7edf\u4e00\u7684\u6d88\u606f\u961f\u5217\u64cd\u4f5c\u65b9\u5f0f\u5c31\u80fd\u64cd\u4f5c\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u6d88\u606f\u961f\u5217\u3002</p> <p></p> <p>\u5b83\u5c4f\u853d\u4e86RabbitMQ\u5e95\u5c42\u64cd\u4f5c\uff0c\u8ba9\u6211\u4eec\u4f7f\u7528\u7edf\u4e00\u7684Input\u548cOutput\u5f62\u5f0f\uff0c\u4ee5Binder\u4e3a\u4e2d\u95f4\u4ef6\uff0c\u8fd9\u6837\u5c31\u7b97\u6211\u4eec\u5207\u6362\u4e86\u4e0d\u540c\u7684\u6d88\u606f\u961f\u5217\uff0c\u4e5f\u65e0\u9700\u4fee\u6539\u4ee3\u7801\uff0c\u800c\u5177\u4f53\u67d0\u79cd\u6d88\u606f\u961f\u5217\u7684\u5e95\u5c42\u5b9e\u73b0\u662f\u4ea4\u7ed9Stream\u5728\u505a\u7684\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u9879\u76ee\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <p></p> <p>\u4f9d\u8d56\u5982\u4e0b\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n    &lt;version&gt;2021.0.1&lt;/version&gt;\n    &lt;type&gt;pom&lt;/type&gt;\n    &lt;scope&gt;import&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre> <pre><code>&lt;dependencies&gt;\n    &lt;!--  RabbitMQ\u7684Stream\u5b9e\u73b0  --&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-stream-rabbit&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre> <p>\u9996\u5148\u6211\u4eec\u6765\u7f16\u5199\u4e00\u4e0b\u751f\u4ea7\u8005\uff0c\u9996\u5148\u662f\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>server:\n  port: 8001\nspring:\n  cloud:\n    stream:\n      binders:   #\u6b64\u5904\u914d\u7f6e\u8981\u7ed1\u5b9a\u7684rabbitmq\u7684\u670d\u52a1\u4fe1\u606f\n        local-server: #\u7ed1\u5b9a\u540d\u79f0\uff0c\u968f\u4fbf\u8d77\u4e00\u4e2a\u5c31\u884c\n          type: rabbit #\u6d88\u606f\u7ec4\u4ef6\u7c7b\u578b\uff0c\u8fd9\u91cc\u4f7f\u7528\u7684\u662fRabbitMQ\uff0c\u5c31\u586b\u5199rabbit\n          environment:  #\u670d\u52a1\u5668\u76f8\u5173\u4fe1\u606f\uff0c\u6309\u7167\u4e0b\u9762\u7684\u65b9\u5f0f\u586b\u5199\u5c31\u884c\uff0c\u7206\u7ea2\u522b\u7ba1\n            spring:\n              rabbitmq:\n                host: 192.168.0.6\n                port: 5672\n                username: admin\n                password: admin\n                virtual-host: /test\n       bindings:\n        test-out-0:\n          destination: test.exchange\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u6765\u7f16\u5199\u4e00\u4e2aController\uff0c\u4e00\u4f1a\u8bbf\u95ee\u4e00\u6b21\u8fd9\u4e2a\u63a5\u53e3\uff0c\u5c31\u5411\u6d88\u606f\u961f\u5217\u53d1\u9001\u4e00\u4e2a\u6570\u636e\uff1a</p> <pre><code>@RestController\npublic class PublishController {\n\n    @Resource\n    StreamBridge bridge;  //\u901a\u8fc7bridge\u6765\u53d1\u9001\u6d88\u606f\n\n    @RequestMapping(\"/publish\")\n    public String publish(){\n        //\u7b2c\u4e00\u4e2a\u53c2\u6570\u5176\u5b9e\u5c31\u662fRabbitMQ\u7684\u4ea4\u6362\u673a\u540d\u79f0\uff08\u6570\u636e\u4f1a\u53d1\u9001\u7ed9\u8fd9\u4e2a\u4ea4\u6362\u673a\uff0c\u5230\u8fbe\u54ea\u4e2a\u6d88\u606f\u961f\u5217\uff0c\u4e0d\u7531\u6211\u4eec\u51b3\u5b9a\uff09\n        //\u8fd9\u4e2a\u4ea4\u6362\u673a\u7684\u547d\u540d\u7a0d\u5fae\u6709\u4e00\u4e9b\u89c4\u5219:\n        //\u8f93\u5165:    &lt;\u540d\u79f0&gt; + -in- + &lt;index&gt;\n        //\u8f93\u51fa:    &lt;\u540d\u79f0&gt; + -out- + &lt;index&gt;\n        //\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u8f93\u51fa\u7684\u65b9\u5f0f\uff0c\u6765\u5c06\u6570\u636e\u53d1\u9001\u5230\u6d88\u606f\u961f\u5217\uff0c\u6ce8\u610f\u8fd9\u91cc\u7684\u540d\u79f0\u4f1a\u548c\u4e4b\u540e\u7684\u6d88\u8d39\u8005Bean\u540d\u79f0\u8fdb\u884c\u5bf9\u5e94\n        bridge.send(\"test-out-0\", \"HelloWorld!\");\n        return \"\u6d88\u606f\u53d1\u9001\u6210\u529f\uff01\"+new Date();\n    }\n}\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u6765\u5c06\u751f\u4ea7\u8005\u542f\u52a8\u4e00\u4e0b\uff0c\u8bbf\u95ee\u4e00\u4e0b\u63a5\u53e3\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6d88\u606f\u6210\u529f\u53d1\u9001\uff0c\u6211\u4eec\u6765\u770b\u770bRabbitMQ\u8fd9\u8fb9\u7684\u60c5\u51b5\uff1a</p> <p></p> <p>\u65b0\u589e\u4e86\u4e00\u4e2a<code>test-in-0</code>\u4ea4\u6362\u673a\uff0c\u5e76\u4e14\u6b64\u4ea4\u6362\u673a\u662ftopic\u7c7b\u578b\u7684\uff1a</p> <p></p> <p>\u4f46\u662f\u76ee\u524d\u6ca1\u6709\u4efb\u4f55\u961f\u5217\u7ed1\u5b9a\u5230\u6b64\u4ea4\u6362\u673a\u4e0a\uff0c\u56e0\u6b64\u6211\u4eec\u521a\u521a\u53d1\u9001\u7684\u6d88\u606f\u5b9e\u9645\u4e0a\u662f\u6ca1\u6709\u7ed9\u5230\u4efb\u4f55\u961f\u5217\u7684\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u6765\u7f16\u5199\u4e00\u4e0b\u6d88\u8d39\u8005\uff0c\u6d88\u8d39\u8005\u7684\u7f16\u5199\u65b9\u5f0f\u6bd4\u8f83\u7279\u522b\uff0c\u53ea\u9700\u8981\u5b9a\u4e49\u4e00\u4e2aConsumer\u5c31\u53ef\u4ee5\u4e86\uff0c\u5176\u4ed6\u914d\u7f6e\u4fdd\u6301\u4e00\u81f4\uff1a</p> <pre><code>@Component\npublic class ConsumerComponent {\n\n    @Bean(\"test\")   //\u6ce8\u610f\u8fd9\u91cc\u9700\u8981\u586b\u5199\u6211\u4eec\u524d\u9762\u4ea4\u6362\u673a\u540d\u79f0\u4e2d\"\u540d\u79f0\"\uff0c\u8fd9\u6837\u751f\u4ea7\u8005\u53d1\u9001\u7684\u6570\u636e\u624d\u4f1a\u6b63\u786e\u5230\u8fbe\n    public Consumer&lt;String&gt; consumer(){\n        return System.out::println;\n    }\n}\n</code></pre> <p>\u914d\u7f6e\u4e2d\u9700\u8981\u4fee\u6539\u4e00\u4e0b\u76ee\u6807\u4ea4\u6362\u673a\uff1a</p> <pre><code>server:\n  port: 8002\nspring:\n  cloud:\n    stream:\n        ...\n      bindings:\n        #\u56e0\u4e3a\u6d88\u8d39\u8005\u662f\u8f93\u5165\uff0c\u9ed8\u8ba4\u540d\u79f0\u4e3a \u65b9\u6cd5\u540d-in-index\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u5176\u6307\u5b9a\u4e3a\u6211\u4eec\u521a\u521a\u5b9a\u4e49\u7684\u4ea4\u6362\u673a\n        test-in-0:\n          destination: test.exchange\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u76f4\u63a5\u542f\u52a8\u5c31\u53ef\u4ee5\u4e86\uff0c\u53ef\u4ee5\u770b\u5230\u542f\u52a8\u4e4b\u540e\uff0c\u81ea\u52a8\u4e3a\u6211\u4eec\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684\u961f\u5217\uff1a</p> <p></p> <p>\u800c\u8fd9\u4e2a\u961f\u5217\u5b9e\u9645\u4e0a\u5c31\u662f\u6211\u4eec\u6d88\u8d39\u8005\u7b49\u5f85\u6570\u636e\u5230\u8fbe\u7684\u961f\u5217\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u961f\u5217\u76f4\u63a5\u7ed1\u5b9a\u5230\u4e86\u6211\u4eec\u521a\u521a\u521b\u5efa\u7684\u4ea4\u6362\u673a\u4e0a\uff0c\u5e76\u4e14<code>routingKey</code>\u662f\u76f4\u63a5\u5199\u7684<code>#</code>\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u4f1a\u6d88\u606f\u4f1a\u76f4\u63a5\u8fc7\u6765\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u518d\u6765\u8bbf\u95ee\u4e00\u4e9b\u6d88\u606f\u53d1\u9001\u63a5\u53e3\uff1a</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6d88\u8d39\u8005\u6210\u529f\u5730\u8fdb\u884c\u6d88\u8d39\u4e86\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u901a\u8fc7\u4f7f\u7528SpringCloud Stream\u6765\u5c4f\u853d\u6389\u5e95\u5c42RabbitMQ\u6765\u76f4\u63a5\u8fdb\u884c\u6d88\u606f\u7684\u64cd\u4f5c\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCloud%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/#springcloud-bus","title":"SpringCloud Bus","text":"<p>\u5b98\u65b9\u6587\u6863\uff1ahttps://cloud.spring.io/spring-cloud-bus/reference/html/</p> <p>\u5b9e\u9645\u4e0a\u5b83\u5c31\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u6d88\u606f\u603b\u7ebf\uff0c\u53ef\u7528\u4e8e\u5411\u5404\u4e2a\u670d\u52a1\u5e7f\u64ad\u67d0\u4e9b\u72b6\u6001\u7684\u66f4\u6539\uff08\u6bd4\u5982\u4e91\u7aef\u914d\u7f6e\u66f4\u6539\uff0c\u53ef\u4ee5\u7ed3\u5408Config\u7ec4\u4ef6\u5b9e\u73b0\u52a8\u6001\u66f4\u65b0\u914d\u7f6e\uff0c\u5f53\u7136\u6211\u4eec\u524d\u9762\u5b66\u4e60\u7684Nacos\u5176\u5b9e\u5df2\u7ecf\u5305\u542b\u8fd9\u4e2a\u529f\u80fd\u4e86\uff09\u6216\u5176\u4ed6\u7ba1\u7406\u6307\u4ee4\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u4e5f\u662f\u7b80\u5355\u4f7f\u7528\u4e00\u4e0b\u5427\uff0cBus\u9700\u8981\u57fa\u4e8e\u4e00\u4e2a\u5177\u4f53\u7684\u6d88\u606f\u961f\u5217\u5b9e\u73b0\uff0c\u6bd4\u5982RabbitMQ\u6216\u662fKafka\uff0c\u8fd9\u91cc\u6211\u4eec\u4f9d\u7136\u4f7f\u7528RabbitMQ\u3002</p> <p>\u6211\u4eec\u5c06\u6700\u5f00\u59cb\u7684\u5fae\u670d\u52a1\u62c6\u5206\u9879\u76ee\u7ee7\u7eed\u4f7f\u7528\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u501f\u9605\u670d\u52a1\u7684\u67d0\u4e2a\u63a5\u53e3\u8c03\u7528\u65f6\uff0c\u80fd\u591f\u7ed9\u7528\u6237\u670d\u52a1\u548c\u56fe\u4e66\u670d\u52a1\u53d1\u9001\u4e00\u4e2a\u901a\u77e5\uff0c\u9996\u5148\u662f\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-bus-amqp&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u53ea\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5c06RabbitMQ\u7684\u76f8\u5173\u4fe1\u606f\u914d\u7f6e\uff1a</p> <pre><code>spring:\n  rabbitmq:\n    addresses: 192.168.0.6\n    username: admin\n    password: admin\n    virtual-host: /test\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: \"*\"    #\u66b4\u9732\u7aef\u70b9\uff0c\u4e00\u4f1a\u7528\u4e8e\u63d0\u9192\u5237\u65b0\n</code></pre> <p>\u7136\u540e\u542f\u52a8\u6211\u4eec\u7684\u4e09\u4e2a\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u7ba1\u7406\u9762\u677f\u4e2d\uff1a</p> <p></p> <p>\u65b0\u589e\u4e86springCloudBug\u8fd9\u6837\u4e00\u4e2a\u4ea4\u6362\u673a\uff0c\u5e76\u4e14\uff1a</p> <p></p> <p>\u81ea\u52a8\u751f\u6210\u4e86\u5404\u81ea\u7684\u6d88\u606f\u961f\u5217\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u76d1\u542c\u5e76\u63a5\u6536\u5230\u6d88\u606f\u4e86\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u8bbf\u95ee\u4e00\u4e2a\u7aef\u53e3\uff1a</p> <p></p> <p>\u6b64\u7aef\u53e3\u662f\u7528\u4e8e\u901a\u77e5\u522b\u4eba\u8fdb\u884c\u5237\u65b0\uff0c\u53ef\u4ee5\u770b\u5230\u8c03\u7528\u4e4b\u540e\uff0c\u6d88\u606f\u961f\u5217\u4e2d\u6210\u529f\u51fa\u73b0\u4e86\u4e00\u6b21\u6d88\u8d39\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u7ed3\u5408\u4e4b\u524d\u4f7f\u7528\u7684Config\u914d\u7f6e\u4e2d\u5fc3\uff0c\u6765\u770b\u770b\u662f\u4e0d\u662f\u53ef\u4ee5\u505a\u5230\u901a\u77e5\u4e4b\u540e\u6240\u6709\u7684\u914d\u7f6e\u52a8\u6001\u5237\u65b0\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/","title":"SpringCould\u7b14\u8bb0\uff08\u4e8c\uff09","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_1","title":"\u5fae\u670d\u52a1\u8fdb\u9636","text":"<p>\u524d\u9762\u6211\u4eec\u4e86\u89e3\u4e86\u5fae\u670d\u52a1\u7684\u4e00\u5957\u89e3\u51b3\u65b9\u6848\uff0c\u4f46\u662f\u5b83\u662f\u57fa\u4e8eNetflix\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u53d1\u73b0\uff0c\u5f88\u591a\u6846\u67b6\u90fd\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\u4e86\uff0c\u6765\u770b\u770b\u76ee\u524d\u6211\u4eec\u6240\u8ba4\u8bc6\u5230\u7684SpringCloud\u5404\u5927\u7ec4\u4ef6\u7684\u7ef4\u62a4\u60c5\u51b5\uff1a</p> <ul> <li>\u6ce8\u518c\u4e2d\u5fc3\uff1aEureka\uff08\u5c5e\u4e8eNetflix\uff0c2.x\u7248\u672c\u4e0d\u518d\u5f00\u6e90\uff0c1.x\u7248\u672c\u4ecd\u5728\u66f4\u65b0\uff09</li> <li>\u670d\u52a1\u8c03\u7528\uff1aRibbon\uff08\u5c5e\u4e8eNetflix\uff0c\u505c\u6b62\u66f4\u65b0\uff0c\u5df2\u7ecf\u5f7b\u5e95\u88ab\u79fb\u9664\uff09\u3001SpringCloud Loadbalancer\uff08\u5c5e\u4e8eSpringCloud\u5b98\u65b9\uff0c\u76ee\u524d\u7684\u9ed8\u8ba4\u65b9\u6848\uff09</li> <li>\u670d\u52a1\u964d\u7ea7\uff1aHystrix\uff08\u5c5e\u4e8eNetflix\uff0c\u505c\u6b62\u66f4\u65b0\uff0c\u5df2\u7ecf\u5f7b\u5e95\u88ab\u79fb\u9664\uff09</li> <li>\u8def\u7531\u7f51\u5173\uff1aZuul\uff08\u5c5e\u4e8eNetflix\uff0c\u505c\u6b62\u66f4\u65b0\uff0c\u5df2\u7ecf\u5f7b\u5e95\u88ab\u79fb\u9664\uff09\u3001Gateway\uff08\u5c5e\u4e8eSpringCloud\u5b98\u65b9\uff0c\u63a8\u8350\u65b9\u6848\uff09</li> <li>\u914d\u7f6e\u4e2d\u5fc3\uff1aConfig\uff08\u5c5e\u4e8eSpringCloud\u5b98\u65b9\uff09</li> </ul> <p>\u53ef\u89c1\uff0c\u6211\u4eec\u4e4b\u524d\u4f7f\u7528\u7684\u6574\u5957\u89e3\u51b3\u65b9\u6848\u4e2d\uff0c\u8d85\u8fc7\u534a\u6570\u7684\u7ec4\u4ef6\u90fd\u5df2\u7ecf\u5904\u4e8e\u4e0d\u53ef\u7528\u72b6\u6001\uff0c\u5e76\u4e14\u90e8\u5206\u7ec4\u4ef6\u90fd\u662fSpringCloud\u5b98\u65b9\u51fa\u624b\u63d0\u4f9b\u6846\u67b6\u8fdb\u884c\u89e3\u51b3\uff0c\u56e0\u6b64\uff0c\u5bfb\u627e\u4e00\u5957\u66f4\u597d\u7684\u89e3\u51b3\u65b9\u6848\u52bf\u5728\u5fc5\u884c\uff0c\u4e5f\u5c31\u5f15\u51fa\u4e86\u6211\u4eec\u672c\u7ae0\u7684\u4e3b\u89d2\uff1aSpringCloud Alibaba</p> <p>\u963f\u91cc\u5df4\u5df4\u4f5c\u4e3a\u4e1a\u754c\u7684\u4e92\u8054\u7f51\u5927\u5382\uff0c\u7ed9\u51fa\u4e86\u4e00\u5957\u5168\u65b0\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u5b98\u65b9\u7f51\u7ad9\uff08\u4e2d\u6587\uff09\uff1ahttps://spring-cloud-alibaba-group.github.io/github-pages/2021/zh-cn/index.html</p> <p>Spring Cloud Alibaba \u81f4\u529b\u4e8e\u63d0\u4f9b\u5fae\u670d\u52a1\u5f00\u53d1\u7684\u4e00\u7ad9\u5f0f\u89e3\u51b3\u65b9\u6848\u3002\u6b64\u9879\u76ee\u5305\u542b\u5f00\u53d1\u5206\u5e03\u5f0f\u5e94\u7528\u670d\u52a1\u7684\u5fc5\u9700\u7ec4\u4ef6\uff0c\u65b9\u4fbf\u5f00\u53d1\u8005\u901a\u8fc7 Spring Cloud \u7f16\u7a0b\u6a21\u578b\u8f7b\u677e\u4f7f\u7528\u8fd9\u4e9b\u7ec4\u4ef6\u6765\u5f00\u53d1\u5206\u5e03\u5f0f\u5e94\u7528\u670d\u52a1\u3002</p> <p>\u4f9d\u6258 Spring Cloud Alibaba\uff0c\u60a8\u53ea\u9700\u8981\u6dfb\u52a0\u4e00\u4e9b\u6ce8\u89e3\u548c\u5c11\u91cf\u914d\u7f6e\uff0c\u5c31\u53ef\u4ee5\u5c06 Spring Cloud \u5e94\u7528\u63a5\u5165\u963f\u91cc\u5206\u5e03\u5f0f\u5e94\u7528\u89e3\u51b3\u65b9\u6848\uff0c\u901a\u8fc7\u963f\u91cc\u4e2d\u95f4\u4ef6\u6765\u8fc5\u901f\u642d\u5efa\u5206\u5e03\u5f0f\u5e94\u7528\u7cfb\u7edf\u3002</p> <p>\u76ee\u524d Spring Cloud Alibaba \u63d0\u4f9b\u4e86\u5982\u4e0b\u529f\u80fd:</p> <ol> <li>\u670d\u52a1\u9650\u6d41\u964d\u7ea7\uff1a\u652f\u6301 WebServlet\u3001WebFlux, OpenFeign\u3001RestTemplate\u3001Dubbo \u9650\u6d41\u964d\u7ea7\u529f\u80fd\u7684\u63a5\u5165\uff0c\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u901a\u8fc7\u63a7\u5236\u53f0\u5b9e\u65f6\u4fee\u6539\u9650\u6d41\u964d\u7ea7\u89c4\u5219\uff0c\u8fd8\u652f\u6301\u67e5\u770b\u9650\u6d41\u964d\u7ea7 Metrics \u76d1\u63a7\u3002</li> <li>\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\uff1a\u9002\u914d Spring Cloud \u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\u6807\u51c6\uff0c\u9ed8\u8ba4\u96c6\u6210\u4e86 Ribbon \u7684\u652f\u6301\u3002</li> <li>\u5206\u5e03\u5f0f\u914d\u7f6e\u7ba1\u7406\uff1a\u652f\u6301\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u5916\u90e8\u5316\u914d\u7f6e\uff0c\u914d\u7f6e\u66f4\u6539\u65f6\u81ea\u52a8\u5237\u65b0\u3002</li> <li>Rpc\u670d\u52a1\uff1a\u6269\u5c55 Spring Cloud \u5ba2\u6237\u7aef RestTemplate \u548c OpenFeign\uff0c\u652f\u6301\u8c03\u7528 Dubbo RPC \u670d\u52a1</li> <li>\u6d88\u606f\u9a71\u52a8\u80fd\u529b\uff1a\u57fa\u4e8e Spring Cloud Stream \u4e3a\u5fae\u670d\u52a1\u5e94\u7528\u6784\u5efa\u6d88\u606f\u9a71\u52a8\u80fd\u529b\u3002</li> <li>\u5206\u5e03\u5f0f\u4e8b\u52a1\uff1a\u4f7f\u7528 @GlobalTransactional \u6ce8\u89e3\uff0c \u9ad8\u6548\u5e76\u4e14\u5bf9\u4e1a\u52a1\u96f6\u4fb5\u5165\u5730\u89e3\u51b3\u5206\u5e03\u5f0f\u4e8b\u52a1\u95ee\u9898\u3002</li> <li>\u963f\u91cc\u4e91\u5bf9\u8c61\u5b58\u50a8\uff1a\u963f\u91cc\u4e91\u63d0\u4f9b\u7684\u6d77\u91cf\u3001\u5b89\u5168\u3001\u4f4e\u6210\u672c\u3001\u9ad8\u53ef\u9760\u7684\u4e91\u5b58\u50a8\u670d\u52a1\u3002\u652f\u6301\u5728\u4efb\u4f55\u5e94\u7528\u3001\u4efb\u4f55\u65f6\u95f4\u3001\u4efb\u4f55\u5730\u70b9\u5b58\u50a8\u548c\u8bbf\u95ee\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e\u3002</li> <li>\u5206\u5e03\u5f0f\u4efb\u52a1\u8c03\u5ea6\uff1a\u63d0\u4f9b\u79d2\u7ea7\u3001\u7cbe\u51c6\u3001\u9ad8\u53ef\u9760\u3001\u9ad8\u53ef\u7528\u7684\u5b9a\u65f6\uff08\u57fa\u4e8e Cron \u8868\u8fbe\u5f0f\uff09\u4efb\u52a1\u8c03\u5ea6\u670d\u52a1\u3002\u540c\u65f6\u63d0\u4f9b\u5206\u5e03\u5f0f\u7684\u4efb\u52a1\u6267\u884c\u6a21\u578b\uff0c\u5982\u7f51\u683c\u4efb\u52a1\u3002\u7f51\u683c\u4efb\u52a1\u652f\u6301\u6d77\u91cf\u5b50\u4efb\u52a1\u5747\u5300\u5206\u914d\u5230\u6240\u6709 Worker\uff08schedulerx-client\uff09\u4e0a\u6267\u884c\u3002</li> <li>\u963f\u91cc\u4e91\u77ed\u4fe1\u670d\u52a1\uff1a\u8986\u76d6\u5168\u7403\u7684\u77ed\u4fe1\u670d\u52a1\uff0c\u53cb\u597d\u3001\u9ad8\u6548\u3001\u667a\u80fd\u7684\u4e92\u8054\u5316\u901a\u8baf\u80fd\u529b\uff0c\u5e2e\u52a9\u4f01\u4e1a\u8fc5\u901f\u642d\u5efa\u5ba2\u6237\u89e6\u8fbe\u901a\u9053\u3002</li> </ol> <p>\u53ef\u4ee5\u770b\u5230\uff0cSpringCloudAlibaba\u5b9e\u9645\u4e0a\u662f\u5bf9\u6211\u4eec\u7684SpringCloud\u7ec4\u4ef6\u589e\u5f3a\u529f\u80fd\uff0c\u662fSpringCloud\u7684\u589e\u5f3a\u6846\u67b6\uff0c\u53ef\u4ee5\u517c\u5bb9SpringCloud\u539f\u751f\u7ec4\u4ef6\u548cSpringCloudAlibaba\u7684\u7ec4\u4ef6\u3002</p> <p>\u5f00\u59cb\u5b66\u4e60\u4e4b\u524d\uff0c\u628a\u6211\u4eec\u4e4b\u524d\u6253\u5305\u597d\u7684\u62c6\u5206\u9879\u76ee\u89e3\u538b\uff0c\u6211\u4eec\u5c06\u57fa\u4e8e\u5b83\u8fdb\u884c\u8bb2\u89e3\u3002</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#nacos","title":"Nacos \u66f4\u52a0\u5168\u80fd\u7684\u6ce8\u518c\u4e2d\u5fc3","text":"<p>Nacos\uff08Naming Configuration Service\uff09\u662f\u4e00\u6b3e\u963f\u91cc\u5df4\u5df4\u5f00\u6e90\u7684\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\u3001\u914d\u7f6e\u7ba1\u7406\u7684\u7ec4\u4ef6\uff0c\u76f8\u5f53\u4e8e\u662fEureka+Config\u7684\u7ec4\u5408\u5f62\u6001\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_2","title":"\u5b89\u88c5\u4e0e\u90e8\u7f72","text":"<p>Nacos\u670d\u52a1\u5668\u662f\u72ec\u7acb\u5b89\u88c5\u90e8\u7f72\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u4e0b\u8f7d\u6700\u65b0\u7684Nacos\u670d\u52a1\u7aef\u7a0b\u5e8f\uff0c\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/alibaba/nacos\uff0c\u8fde\u4e0d\u4e0a\u53ef\u4ee5\u5230\u89c6\u9891\u4e0b\u65b9\u4e91\u76d8\u4e2d\u4e0b\u8f7d\u3002</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u76ee\u524d\u6700\u65b0\u7684\u7248\u672c\u662f<code>1.4.3</code>\u7248\u672c\uff082022\u5e742\u670827\u65e5\u53d1\u5e03\u7684\uff09\uff0c\u6211\u4eec\u76f4\u63a5\u4e0b\u8f7d<code>zip</code>\u6587\u4ef6\u5373\u53ef\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u5c06\u6587\u4ef6\u8fdb\u884c\u89e3\u538b\uff0c\u5f97\u5230\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <p></p> <p>\u6211\u4eec\u76f4\u63a5\u5c06\u5176\u62d6\u5165\u5230\u9879\u76ee\u6587\u4ef6\u5939\u4e0b\uff0c\u4fbf\u4e8e\u6211\u4eec\u4e00\u4f1a\u5728IDEA\u5185\u90e8\u542f\u52a8\uff0c\u63a5\u7740\u6dfb\u52a0\u8fd0\u884c\u914d\u7f6e\uff1a</p> <p></p> <p>\u5176\u4e2d<code>-m standalone</code>\u8868\u793a\u5355\u8282\u70b9\u6a21\u5f0f\uff0cMac\u548cLinux\u4e0b\u8bb0\u5f97\u5c06\u89e3\u91ca\u5668\u8bbe\u5b9a\u4e3a<code>/bin/bash</code>\uff0c\u7531\u4e8eNacos\u5728Mac/Linux\u9ed8\u8ba4\u662f\u540e\u53f0\u542f\u52a8\u6a21\u5f0f\uff0c\u6211\u4eec\u4fee\u6539\u4e00\u4e0b\u5b83\u7684bash\u6587\u4ef6\uff0c\u8ba9\u5b83\u53d8\u6210\u524d\u53f0\u542f\u52a8\uff0c\u8fd9\u6837IDEA\u5173\u95ed\u4e86Nacos\u5c31\u81ea\u52a8\u5173\u95ed\u4e86\uff0c\u5426\u5219\u5f00\u53d1\u73af\u5883\u4e0b\u5f88\u5bb9\u6613\u5fd8\u8bb0\u5173\uff1a</p> <pre><code># \u6ce8\u91ca\u6389 nohup $JAVA ${JAVA_OPT} nacos.nacos &gt;&gt; ${BASE_DIR}/logs/start.out 2&gt;&amp;1 &amp;\n# \u66ff\u6362\u6210\u4e0b\u9762\u7684\n$JAVA ${JAVA_OPT} nacos.nacos\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u70b9\u51fb\u542f\u52a8\uff1a</p> <p></p> <p>OK\uff0c\u542f\u52a8\u6210\u529f\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u7684\u7ba1\u7406\u9875\u9762\u5730\u5740\u4e5f\u662f\u7ed9\u6211\u4eec\u8d34\u51fa\u6765\u4e86\uff1a http://localhost:8848/nacos/index.html\uff0c\u8bbf\u95ee\u8fd9\u4e2a\u5730\u5740\uff1a</p> <p></p> <p>\u9ed8\u8ba4\u7684\u7528\u6237\u540d\u548c\u7ba1\u7406\u5458\u5bc6\u7801\u90fd\u662f<code>nacos</code>\uff0c\u76f4\u63a5\u767b\u9646\u5373\u53ef\uff0c\u53ef\u4ee5\u770b\u5230\u8fdb\u5165\u7ba1\u7406\u9875\u9762\u4e4b\u540e\u529f\u80fd\u4e5f\u662f\u76f8\u5f53\u4e30\u5bcc\uff1a</p> <p></p> <p>\u81f3\u6b64\uff0cNacos\u7684\u5b89\u88c5\u4e0e\u90e8\u7f72\u5b8c\u6210\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_3","title":"\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0","text":"<p>\u73b0\u5728\u6211\u4eec\u8981\u5b9e\u73b0\u57fa\u4e8eNacos\u7684\u670d\u52a1\u6ce8\u518c\u4e0e\u53d1\u73b0\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u5bfc\u5165SpringCloudAlibaba\u76f8\u5173\u7684\u4f9d\u8d56\uff0c\u6211\u4eec\u5728\u7236\u5de5\u7a0b\u5c06\u4f9d\u8d56\u8fdb\u884c\u7ba1\u7406\uff1a</p> <pre><code>&lt;dependencyManagement&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;\n            &lt;version&gt;2.2.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;!-- \u8fd9\u91cc\u5f15\u5165\u6700\u65b0\u7684SpringCloud\u4f9d\u8d56 --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n            &lt;version&gt;2021.0.1&lt;/version&gt;\n            &lt;type&gt;pom&lt;/type&gt;\n            &lt;scope&gt;import&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n          &lt;!-- \u8fd9\u91cc\u5f15\u5165\u6700\u65b0\u7684SpringCloudAlibaba\u4f9d\u8d56\uff0c2021.0.1.0\u7248\u672c\u652f\u6301SpringBoot2.6.X --&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;\n            &lt;version&gt;2021.0.1.0&lt;/version&gt;\n            &lt;type&gt;pom&lt;/type&gt;\n            &lt;scope&gt;import&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/dependencyManagement&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u5b50\u9879\u76ee\u4e2d\u6dfb\u52a0\u670d\u52a1\u53d1\u73b0\u4f9d\u8d56\u4e86\uff0c\u6bd4\u5982\u6211\u4eec\u4ee5\u56fe\u4e66\u670d\u52a1\u4e3a\u4f8b\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u548c\u6ce8\u518c\u5230Eureka\u4e00\u6837\uff0c\u6211\u4eec\u4e5f\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6eNacos\u6ce8\u518c\u4e2d\u5fc3\u7684\u5730\u5740\uff1a</p> <pre><code>server:\n    # \u4e4b\u540e\u6240\u6709\u7684\u56fe\u4e66\u670d\u52a1\u8282\u70b9\u5c3181XX\u7aef\u53e3\n  port: 8101\nspring:\n  datasource:\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    url: jdbc:mysql://cloudstudy.mysql.cn-chengdu.rds.aliyuncs.com:3306/cloudstudy\n    username: test\n    password: 123456\n  # \u5e94\u7528\u540d\u79f0 bookservice\n  application:\n    name: bookservice\n  cloud:\n    nacos:\n      discovery:\n        # \u914d\u7f6eNacos\u6ce8\u518c\u4e2d\u5fc3\u5730\u5740\n        server-addr: localhost:8848\n</code></pre> <p>\u63a5\u7740\u542f\u52a8\u6211\u4eec\u7684\u56fe\u4e66\u670d\u52a1\uff0c\u53ef\u4ee5\u5728Nacos\u7684\u670d\u52a1\u5217\u8868\u4e2d\u627e\u5230\uff1a</p> <p></p> <p>\u6309\u7167\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u63a5\u7740\u5c06\u53e6\u5916\u4e24\u4e2a\u670d\u52a1\u4e5f\u6ce8\u518c\u5230Nacos\u4e2d\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u4f7f\u7528OpenFeign\uff0c\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\u8fdc\u7a0b\u8c03\u7528\u4ee5\u53ca\u8d1f\u8f7d\u5747\u8861\uff0c\u5bfc\u5165\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;!-- \u8fd9\u91cc\u9700\u8981\u5355\u72ec\u5bfc\u5165LoadBalancer\u4f9d\u8d56 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-loadbalancer&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7f16\u5199\u63a5\u53e3\uff1a</p> <pre><code>@FeignClient(\"userservice\")\npublic interface UserClient {\n\n    @RequestMapping(\"/user/{uid}\")\n    User getUserById(@PathVariable(\"uid\") int uid);\n}\n</code></pre> <pre><code>@FeignClient(\"bookservice\")\npublic interface BookClient {\n\n    @RequestMapping(\"/book/{bid}\")\n    Book getBookById(@PathVariable(\"bid\") int bid);\n}\n</code></pre> <pre><code>@Service\npublic class BorrowServiceImpl implements BorrowService{\n\n    @Resource\n    BorrowMapper mapper;\n\n    @Resource\n    UserClient userClient;\n\n    @Resource\n    BookClient bookClient;\n\n    @Override\n    public UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n        List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n        User user = userClient.getUserById(uid);\n        List&lt;Book&gt; bookList = borrow\n                .stream()\n                .map(b -&gt; bookClient.getBookById(b.getBid()))\n                .collect(Collectors.toList());\n        return new UserBorrowDetail(user, bookList);\n    }\n}\n</code></pre> <pre><code>@EnableFeignClients\n@SpringBootApplication\npublic class BorrowApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(BorrowApplication.class, args);\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u8fdb\u884c\u6d4b\u8bd5\uff1a</p> <p></p> <p>\u6d4b\u8bd5\u6b63\u5e38\uff0c\u53ef\u4ee5\u81ea\u52a8\u53d1\u73b0\u670d\u52a1\uff0c\u63a5\u7740\u6211\u4eec\u6765\u591a\u914d\u7f6e\u51e0\u4e2a\u5b9e\u4f8b\uff0c\u53bb\u6389\u56fe\u4e66\u670d\u52a1\u548c\u7528\u6237\u670d\u52a1\u7684\u7aef\u53e3\u914d\u7f6e\uff1a</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u5728\u56fe\u4e66\u670d\u52a1\u548c\u7528\u6237\u670d\u52a1\u4e2d\u6dfb\u52a0\u4e00\u53e5\u6253\u5370\u65b9\u4fbf\u4e4b\u540e\u67e5\u770b\uff1a</p> <pre><code>@RequestMapping(\"/user/{uid}\")\npublic User findUserById(@PathVariable(\"uid\") int uid){\n    System.out.println(\"\u8c03\u7528\u7528\u6237\u670d\u52a1\");\n    return service.getUserById(uid);\n}\n</code></pre> <p>\u73b0\u5728\u5c06\u5168\u90e8\u670d\u52a1\u542f\u52a8\uff1a </p> <p>\u53ef\u4ee5\u770b\u5230Nacos\u4e2d\u7684\u5b9e\u4f8b\u6570\u91cf\u5df2\u7ecf\u663e\u793a\u4e3a<code>2</code>\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u8c03\u7528\u501f\u9605\u670d\u52a1\uff0c\u770b\u770b\u80fd\u5426\u8d1f\u8f7d\u5747\u8861\u8fdc\u7a0b\u8c03\u7528\uff1a</p> <p></p> <p></p> <p>OK\uff0c\u8d1f\u8f7d\u5747\u8861\u8fdc\u7a0b\u8c03\u7528\u6ca1\u6709\u95ee\u9898\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u5b9e\u73b0\u4e86\u57fa\u4e8eNacos\u7684\u670d\u52a1\u7684\u6ce8\u518c\u4e0e\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0a\u5927\u81f4\u6d41\u7a0b\u4e0eEureka\u4e00\u81f4\u3002</p> <p>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cNacos\u533a\u5206\u4e86\u4e34\u65f6\u5b9e\u4f8b\u548c\u975e\u4e34\u65f6\u5b9e\u4f8b\uff1a</p> <p></p> <p>\u90a3\u4e48\u4e34\u65f6\u548c\u975e\u4e34\u65f6\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f</p> <ul> <li>\u4e34\u65f6\u5b9e\u4f8b\uff1a\u548cEureka\u4e00\u6837\uff0c\u91c7\u7528\u5fc3\u8df3\u673a\u5236\u5411Nacos\u53d1\u9001\u8bf7\u6c42\u4fdd\u6301\u5728\u7ebf\u72b6\u6001\uff0c\u4e00\u65e6\u5fc3\u8df3\u505c\u6b62\uff0c\u4ee3\u8868\u5b9e\u4f8b\u4e0b\u7ebf\uff0c\u4e0d\u4fdd\u7559\u5b9e\u4f8b\u4fe1\u606f\u3002</li> <li>\u975e\u4e34\u65f6\u5b9e\u4f8b\uff1a\u7531Nacos\u4e3b\u52a8\u8fdb\u884c\u8054\u7cfb\uff0c\u5982\u679c\u8fde\u63a5\u5931\u8d25\uff0c\u90a3\u4e48\u4e0d\u4f1a\u79fb\u9664\u5b9e\u4f8b\u4fe1\u606f\uff0c\u800c\u662f\u5c06\u5065\u5eb7\u72b6\u6001\u8bbe\u5b9a\u4e3afalse\uff0c\u76f8\u5f53\u4e8e\u4f1a\u5bf9\u67d0\u4e2a\u5b9e\u4f8b\u72b6\u6001\u6301\u7eed\u5730\u8fdb\u884c\u76d1\u63a7\u3002</li> </ul> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u4fee\u6539\u4e34\u65f6\u5b9e\u4f8b\uff1a</p> <pre><code>spring:\n  application:\n    name: borrowservice\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n        # \u5c06ephemeral\u4fee\u6539\u4e3afalse\uff0c\u8868\u793a\u975e\u4e34\u65f6\u5b9e\u4f8b\n        ephemeral: false\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728Nacos\u4e2d\u67e5\u770b\uff0c\u53ef\u4ee5\u53d1\u73b0\u5b9e\u4f8b\u5df2\u7ecf\u4e0d\u662f\u4e34\u65f6\u7684\u4e86\uff1a</p> <p></p> <p>\u5982\u679c\u8fd9\u65f6\u6211\u4eec\u5173\u95ed\u6b64\u5b9e\u4f8b\uff0c\u90a3\u4e48\u4f1a\u53d8\u6210\u8fd9\u6837\uff1a</p> <p></p> <p>\u53ea\u662f\u5c06\u5065\u5eb7\u72b6\u6001\u53d8\u4e3afalse\uff0c\u800c\u4e0d\u4f1a\u5220\u9664\u5b9e\u4f8b\u7684\u4fe1\u606f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_4","title":"\u96c6\u7fa4\u5206\u533a","text":"<p>\u5b9e\u9645\u4e0a\u96c6\u7fa4\u5206\u533a\u6982\u5ff5\u5728\u4e4b\u524d\u7684Eureka\u4e2d\u4e5f\u6709\u51fa\u73b0\uff0c\u6bd4\u5982\uff1a</p> <pre><code>eureka:\n  client:\n        fetch-registry: false\n    register-with-eureka: false\n    service-url:\n      defaultZone: http://localhost:8888/eureka\n      # \u8fd9\u4e2adefaultZone\u662f\u4e2a\u5565\u73a9\u610f\uff0c\u4e3a\u4ec0\u4e48\u8981\u7528\u8fd9\u4e2a\u540d\u79f0\uff1f\u4e3a\u4ec0\u4e48\u8981\u8981\u7528\u8fd9\u6837\u7684\u5f62\u5f0f\u6765\u58f0\u660e\u6ce8\u518c\u4e2d\u5fc3\uff1f\n</code></pre> <p>\u5728\u4e00\u4e2a\u5206\u5e03\u5f0f\u5e94\u7528\u4e2d\uff0c\u76f8\u540c\u670d\u52a1\u7684\u5b9e\u4f8b\u53ef\u80fd\u4f1a\u5728\u4e0d\u540c\u7684\u673a\u5668\u3001\u4f4d\u7f6e\u4e0a\u542f\u52a8\uff0c\u6bd4\u5982\u6211\u4eec\u7684\u7528\u6237\u7ba1\u7406\u670d\u52a1\uff0c\u53ef\u80fd\u5728\u6210\u90fd\u67091\u53f0\u670d\u52a1\u5668\u90e8\u7f72\u3001\u91cd\u5e86\u6709\u4e00\u53f0\u670d\u52a1\u5668\u90e8\u7f72\uff0c\u800c\u8fd9\u65f6\uff0c\u6211\u4eec\u5728\u6210\u90fd\u7684\u670d\u52a1\u5668\u4e0a\u542f\u52a8\u4e86\u501f\u9605\u670d\u52a1\uff0c\u90a3\u4e48\u5982\u679c\u6211\u4eec\u7684\u501f\u9605\u670d\u52a1\u73b0\u5728\u8981\u8c03\u7528\u7528\u6237\u670d\u52a1\uff0c\u5c31\u5e94\u8be5\u4f18\u5148\u9009\u62e9\u540c\u4e00\u4e2a\u533a\u57df\u7684\u7528\u6237\u670d\u52a1\u8fdb\u884c\u8c03\u7528\uff0c\u8fd9\u6837\u4f1a\u4f7f\u5f97\u54cd\u5e94\u901f\u5ea6\u66f4\u5feb\u3002</p> <p></p> <p>\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u90e8\u7f72\u5728\u4e0d\u540c\u673a\u623f\u7684\u670d\u52a1\u8fdb\u884c\u5206\u533a\uff0c\u53ef\u4ee5\u770b\u5230\u5b9e\u4f8b\u7684\u5206\u533a\u662f\u9ed8\u8ba4\uff1a</p> <p></p> <p>\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u4fee\u6539\uff1a</p> <pre><code>spring:\n  application:\n    name: borrowservice\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n        # \u4fee\u6539\u4e3a\u91cd\u5e86\u5730\u533a\u7684\u96c6\u7fa4\n        cluster-name: Chongqing\n</code></pre> <p>\u5f53\u7136\u7531\u4e8e\u6211\u4eec\u8fd9\u91cc\u4f7f\u7528\u7684\u662f\u4e0d\u540c\u7684\u542f\u52a8\u914d\u7f6e\uff0c\u76f4\u63a5\u5728\u542f\u52a8\u914d\u7f6e\u4e2d\u6dfb\u52a0\u73af\u5883\u53d8\u91cf<code>spring.cloud.nacos.discovery.cluster-name</code>\u4e5f\u884c\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u7528\u6237\u670d\u52a1\u548c\u56fe\u4e66\u670d\u52a1\u4e24\u4e2a\u533a\u57df\u90fd\u5206\u914d\u4e00\u4e2a\uff0c\u501f\u9605\u670d\u52a1\u5c31\u914d\u7f6e\u4e3a\u6210\u90fd\u5730\u533a\uff1a</p> <p></p> <p>\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\uff0c\u6211\u4eec\u6765\u5c1d\u8bd5\u91cd\u65b0\u542f\u52a8\u4e00\u4e0b\uff08Nacos\u4e5f\u8981\u91cd\u542f\uff09\uff0c\u89c2\u5bdfNacos\u4e2d\u96c6\u7fa4\u5206\u5e03\u60c5\u51b5\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u73b0\u5728\u6709\u4e24\u4e2a\u96c6\u7fa4\uff0c\u5e76\u4e14\u90fd\u6709\u4e00\u4e2a\u5b9e\u4f8b\u6b63\u5728\u8fd0\u884c\u3002\u6211\u4eec\u63a5\u7740\u53bb\u8c03\u7528\u501f\u9605\u670d\u52a1\uff0c\u4f46\u662f\u53d1\u73b0\u5e76\u6ca1\u6709\u6309\u7167\u533a\u57df\u8fdb\u884c\u4f18\u5148\u8c03\u7528\uff0c\u800c\u4f9d\u7136\u4f7f\u7528\u7684\u662f\u8f6e\u8be2\u6a21\u5f0f\u7684\u8d1f\u8f7d\u5747\u8861\u8c03\u7528\u3002</p> <p>\u6211\u4eec\u5fc5\u987b\u8981\u63d0\u4f9bNacos\u7684\u8d1f\u8f7d\u5747\u8861\u5b9e\u73b0\u624d\u80fd\u5f00\u542f\u533a\u57df\u4f18\u5148\u8c03\u7528\u673a\u5236\uff0c\u53ea\u9700\u8981\u5728\u914d\u5236\u6587\u4ef6\u4e2d\u8fdb\u884c\u4fee\u6539\u5373\u53ef\uff1a</p> <pre><code>spring:\n  application:\n    name: borrowservice\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n        cluster-name: Chengdu\n    # \u5c06loadbalancer\u7684nacos\u652f\u6301\u5f00\u542f\uff0c\u96c6\u6210Nacos\u8d1f\u8f7d\u5747\u8861\n    loadbalancer:\n      nacos:\n        enabled: true\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u91cd\u542f\u501f\u9605\u670d\u52a1\uff0c\u4f1a\u53d1\u73b0\u4f18\u5148\u8c03\u7528\u7684\u662f\u540c\u533a\u57df\u7684\u7528\u6237\u548c\u56fe\u4e66\u670d\u52a1\uff0c\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5c06\u6210\u90fd\u5730\u533a\u7684\u670d\u52a1\u4e0b\u7ebf\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u4e0b\u7ebf\u4e4b\u540e\uff0c\u7531\u4e8e\u672c\u533a\u57df\u5185\u6ca1\u6709\u53ef\u7528\u670d\u52a1\u4e86\uff0c\u501f\u9605\u670d\u52a1\u5c06\u4f1a\u8c03\u7528\u91cd\u5e86\u533a\u57df\u7684\u7528\u6237\u670d\u52a1\u3002</p> <p>\u9664\u4e86\u6839\u636e\u533a\u57df\u4f18\u5148\u8c03\u7528\u4e4b\u5916\uff0c\u540c\u4e00\u4e2a\u533a\u57df\u5185\u7684\u5b9e\u4f8b\u4e5f\u53ef\u4ee5\u5355\u72ec\u8bbe\u7f6e\u6743\u91cd\uff0cNacos\u4f1a\u4f18\u5148\u9009\u62e9\u6743\u91cd\u66f4\u5927\u7684\u5b9e\u4f8b\u8fdb\u884c\u8c03\u7528\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728\u7ba1\u7406\u9875\u9762\u4e2d\u8fdb\u884c\u914d\u7f6e\uff1a</p> <p></p> <p>\u6216\u662f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8fdb\u884c\u914d\u7f6e\uff1a</p> <pre><code>spring:\n  application:\n    name: borrowservice\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n        cluster-name: Chengdu\n        # \u6743\u91cd\u5927\u5c0f\uff0c\u8d8a\u5927\u8d8a\u4f18\u5148\u8c03\u7528\uff0c\u9ed8\u8ba4\u4e3a1\n        weight: 0.5\n</code></pre> <p>\u901a\u8fc7\u914d\u7f6e\u6743\u91cd\uff0c\u67d0\u4e9b\u6027\u80fd\u4e0d\u592a\u597d\u7684\u673a\u5668\u5c31\u80fd\u591f\u66f4\u5c11\u5730\u88ab\u4f7f\u7528\uff0c\u800c\u66f4\u591a\u7684\u4f7f\u7528\u90a3\u4e9b\u7f51\u7edc\u826f\u597d\u6027\u80fd\u66f4\u9ad8\u7684\u4e3b\u673a\u4e0a\u7684\u5b9e\u4f8b\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_5","title":"\u914d\u7f6e\u4e2d\u5fc3","text":"<p>\u524d\u9762\u6211\u4eec\u5b66\u4e60\u4e86SpringCloud Config\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u670d\u52a1\u6765\u52a0\u8f7d\u8fdc\u7a0b\u914d\u7f6e\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u8fdc\u7aef\u96c6\u4e2d\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u5b9e\u9645\u4e0a\u6211\u4eec\u53ef\u4ee5\u5728<code>bootstrap.yml</code>\u4e2d\u914d\u7f6e\u8fdc\u7a0b\u914d\u7f6e\u6587\u4ef6\u83b7\u53d6\uff0c\u7136\u540e\u518d\u8fdb\u5165\u5230\u914d\u7f6e\u6587\u4ef6\u52a0\u8f7d\u73af\u8282\uff0c\u800cNacos\u4e5f\u652f\u6301\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u4f7f\u7528\u65b9\u5f0f\u4e5f\u6bd4\u8f83\u7c7b\u4f3c\uff0c\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u60f3\u8981\u5c06\u501f\u9605\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\u653e\u5230Nacos\u8fdb\u884c\u7ba1\u7406\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u5728Nacos\u4e2d\u521b\u5efa\u914d\u7f6e\u6587\u4ef6\uff1a</p> <p></p> <p>\u5c06\u501f\u9605\u670d\u52a1\u7684\u914d\u7f6e\u6587\u4ef6\u5168\u90e8\uff08\u5f53\u7136\u6b63\u5e38\u60c5\u51b5\u4e0b\u662f\u4e0d\u4f1a\u5168\u90e8CV\u7684\uff0c\u53ea\u4f1a\u590d\u5236\u90a3\u4e9b\u9700\u8981\u7ecf\u5e38\u4fee\u6539\u7684\u90e8\u5206\uff0c\u8fd9\u91cc\u4e3a\u4e86\u7701\u4e8b\u5c31\u76f4\u63a5\u5168\u90e8CV\u4e86\uff09\u590d\u5236\u8fc7\u6765\uff0c\u6ce8\u610fData ID\u7684\u683c\u5f0f\u8ddf\u6211\u4eec\u4e4b\u524d\u4e00\u6837\uff0c<code>\u5e94\u7528\u540d\u79f0-\u73af\u5883.yml</code>\uff0c\u5982\u679c\u53ea\u7f16\u5199\u5e94\u7528\u540d\u79f0\uff0c\u90a3\u4e48\u4ee3\u8868\u6b64\u914d\u7f6e\u6587\u4ef6\u65e0\u8bba\u5728\u4ec0\u4e48\u73af\u5883\u4e0b\u90fd\u4f1a\u4f7f\u7528\uff0c\u7136\u540e\u6bcf\u4e2a\u914d\u7f6e\u6587\u4ef6\u90fd\u53ef\u4ee5\u8fdb\u884c\u5206\u7ec4\uff0c\u4e5f\u7b97\u662f\u4e00\u79cd\u5206\u7c7b\u65b9\u5f0f\uff1a</p> <p></p> <p>\u5b8c\u6210\u4e4b\u540e\u70b9\u51fb\u53d1\u5e03\u5373\u53ef\uff1a</p> <p></p> <p>\u7136\u540e\u5728\u9879\u76ee\u4e2d\u5bfc\u5165\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728\u501f\u9605\u670d\u52a1\u4e2d\u6dfb\u52a0<code>bootstrap.yml</code>\u6587\u4ef6\uff1a</p> <pre><code>spring:\n  application:\n    # \u670d\u52a1\u540d\u79f0\u548c\u914d\u7f6e\u6587\u4ef6\u4fdd\u6301\u4e00\u81f4\n    name: borrowservice\n  profiles:\n    # \u73af\u5883\u4e5f\u662f\u548c\u914d\u7f6e\u6587\u4ef6\u4fdd\u6301\u4e00\u81f4\n    active: dev\n  cloud:\n    nacos:\n      config:\n        # \u914d\u7f6e\u6587\u4ef6\u540e\u7f00\u540d\n        file-extension: yml\n        # \u914d\u7f6e\u4e2d\u5fc3\u670d\u52a1\u5668\u5730\u5740\uff0c\u4e5f\u5c31\u662fNacos\u5730\u5740\n        server-addr: localhost:8848\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u542f\u52a8\u670d\u52a1\u8bd5\u8bd5\u770b\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6210\u529f\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u5e76\u542f\u52a8\u4e86\uff0c\u5b9e\u9645\u4e0a\u4f7f\u7528\u4e0a\u6765\u8bf4\u8ddf\u4e4b\u524d\u7684Config\u662f\u57fa\u672c\u4e00\u81f4\u7684\u3002</p> <p>Nacos\u8fd8\u652f\u6301\u914d\u7f6e\u6587\u4ef6\u7684\u70ed\u66f4\u65b0\uff0c\u6bd4\u5982\u6211\u4eec\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5c5e\u6027\uff0c\u800c\u8fd9\u4e2a\u65f6\u5019\u53ef\u80fd\u9700\u8981\u5b9e\u65f6\u4fee\u6539\uff0c\u5e76\u5728\u540e\u7aef\u5b9e\u65f6\u66f4\u65b0\uff0c\u90a3\u4e48\u8fd9\u79cd\u8be5\u600e\u4e48\u5b9e\u73b0\u5462\uff1f\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684Controller\uff1a</p> <pre><code>@RestController\npublic class TestController {\n\n    @Value(\"${test.txt}\")  //\u6211\u4eec\u4ece\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bfb\u53d6test.txt\u7684\u5b57\u7b26\u4e32\u503c\uff0c\u4f5c\u4e3atest\u63a5\u53e3\u7684\u8fd4\u56de\u503c\n    String txt;\n\n    @RequestMapping(\"/test\")\n    public String test(){\n        return txt;\n    }\n}\n</code></pre> <p>\u6211\u4eec\u4fee\u6539\u4e00\u4e0b\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u91cd\u542f\u670d\u52a1\u5668\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u53ef\u4ee5\u6b63\u5e38\u8bfb\u53d6\u4e86\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u5c06\u914d\u7f6e\u6587\u4ef6\u7684\u503c\u8fdb\u884c\u4fee\u6539\uff1a</p> <p></p> <p>\u518d\u6b21\u8bbf\u95ee\u63a5\u53e3\uff0c\u4f1a\u53d1\u73b0\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff1a</p> <p></p> <p>\u4f46\u662f\u540e\u53f0\u662f\u6210\u529f\u68c0\u6d4b\u5230\u503c\u66f4\u65b0\u4e86\uff0c\u4f46\u662f\u503c\u5374\u6ca1\u6539\u53d8\uff1a</p> <p></p> <p>\u90a3\u4e48\u5982\u4f55\u624d\u80fd\u5b9e\u73b0\u914d\u7f6e\u70ed\u66f4\u65b0\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u50cf\u4e0b\u9762\u8fd9\u6837\uff1a</p> <pre><code>@RestController\n@RefreshScope   //\u6dfb\u52a0\u6b64\u6ce8\u89e3\u5c31\u80fd\u5b9e\u73b0\u81ea\u52a8\u5237\u65b0\u4e86\npublic class TestController {\n\n    @Value(\"${test.txt}\")\n    String txt;\n\n    @RequestMapping(\"/test\")\n    public String test(){\n        return txt;\n    }\n}\n</code></pre> <p>\u91cd\u542f\u670d\u52a1\u5668\uff0c\u518d\u6b21\u91cd\u590d\u4e0a\u8ff0\u5b9e\u9a8c\uff0c\u6210\u529f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_6","title":"\u547d\u540d\u7a7a\u95f4","text":"<p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u914d\u7f6e\u6587\u4ef6\u6216\u662f\u670d\u52a1\u5b9e\u4f8b\u5212\u5206\u5230\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u5176\u5b9e\u5c31\u662f\u533a\u5206\u5f00\u53d1\u3001\u751f\u4ea7\u73af\u5883\u6216\u662f\u5f15\u7528\u5f52\u5c5e\u4e4b\u7c7b\u7684\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u547d\u540d\u7a7a\u95f4\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5728dev\u547d\u540d\u7a7a\u95f4\u4e0b\uff0c\u6ca1\u6709\u4efb\u4f55\u914d\u7f6e\u6587\u4ef6\u548c\u670d\u52a1\uff1a</p> <p></p> <p>\u6211\u4eec\u5728\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4\u4e0b\uff0c\u5b9e\u4f8b\u548c\u914d\u7f6e\u90fd\u662f\u76f8\u4e92\u4e4b\u95f4\u9694\u79bb\u7684\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u5f53\u524d\u7684\u547d\u540d\u7a7a\u95f4\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_7","title":"\u5b9e\u73b0\u9ad8\u53ef\u7528","text":"<p>\u7531\u4e8eNacos\u6682\u4e0d\u652f\u6301Arm\u67b6\u6784\u82af\u7247\u7684Mac\u96c6\u7fa4\u642d\u5efa\uff0c\u672c\u5c0f\u8282\u7528Linxu\u4e91\u4e3b\u673a\uff08Nacos\u6bd4\u8f83\u5403\u5185\u5b58\uff0c2\u4e2aNacos\u670d\u52a1\u5668\u96c6\u7fa4\uff0c\u81f3\u5c112G\u5185\u5b58\uff09\u73af\u5883\u6f14\u793a\u3002</p> <p>\u901a\u8fc7\u524d\u9762\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u5982\u4f55\u4f7f\u7528Nacos\u4ee5\u53caNacos\u7684\u529f\u80fd\u7b49\uff0c\u6700\u540e\u6211\u4eec\u6765\u770b\u770b\uff0c\u5982\u679c\u50cf\u4e4b\u524dEureka\u4e00\u6837\uff0c\u642d\u5efaNacos\u96c6\u7fa4\uff0c\u5b9e\u73b0\u9ad8\u53ef\u7528\u3002</p> <p>\u5b98\u65b9\u65b9\u6848\uff1ahttps://nacos.io/zh-cn/docs/cluster-mode-quick-start.html</p> <p></p> <p>http://ip1:port/openAPI \u76f4\u8fdeip\u6a21\u5f0f\uff0c\u673a\u5668\u6302\u5219\u9700\u8981\u4fee\u6539ip\u624d\u53ef\u4ee5\u4f7f\u7528\u3002</p> <p>http://SLB:port/openAPI \u6302\u8f7dSLB\u6a21\u5f0f(\u5185\u7f51SLB\uff0c\u4e0d\u53ef\u66b4\u9732\u5230\u516c\u7f51\uff0c\u4ee5\u514d\u5e26\u6765\u5b89\u5168\u98ce\u9669)\uff0c\u76f4\u8fdeSLB\u5373\u53ef\uff0c\u4e0b\u9762\u6302server\u771f\u5b9eip\uff0c\u53ef\u8bfb\u6027\u4e0d\u597d\u3002</p> <p>http://nacos.com:port/openAPI \u57df\u540d + SLB\u6a21\u5f0f(\u5185\u7f51SLB\uff0c\u4e0d\u53ef\u66b4\u9732\u5230\u516c\u7f51\uff0c\u4ee5\u514d\u5e26\u6765\u5b89\u5168\u98ce\u9669)\uff0c\u53ef\u8bfb\u6027\u597d\uff0c\u800c\u4e14\u6362ip\u65b9\u4fbf\uff0c\u63a8\u8350\u6a21\u5f0f</p> <p>\u6211\u4eec\u6765\u770b\u770b\u5b83\u7684\u67b6\u6784\u8bbe\u8ba1\uff0c\u5b83\u63a8\u8350\u6211\u4eec\u5728\u6240\u6709\u7684Nacos\u670d\u52a1\u7aef\u4e4b\u524d\u5efa\u7acb\u4e00\u4e2a\u8d1f\u8f7d\u5747\u8861\uff0c\u6211\u4eec\u901a\u8fc7\u8bbf\u95ee\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\u6765\u95f4\u63a5\u8bbf\u95ee\u5230\u5404\u4e2aNacos\u670d\u52a1\u5668\u3002\u5b9e\u9645\u4e0a\u5c31\uff0c\u662f\u6bd4\u5982\u6709\u4e09\u4e2aNacos\u670d\u52a1\u5668\u505a\u96c6\u7fa4\uff0c\u4f46\u662f\u6bcf\u4e2a\u670d\u52a1\u4e0d\u53ef\u80fd\u628a\u6bcf\u4e2aNacos\u90fd\u53bb\u8bbf\u95ee\u4e00\u6b21\u8fdb\u884c\u6ce8\u518c\uff0c\u5b9e\u9645\u4e0a\u53ea\u9700\u8981\u5728\u4efb\u610f\u4e00\u53f0Nacos\u670d\u52a1\u5668\u4e0a\u6ce8\u518c\u5373\u53ef\uff0cNacos\u670d\u52a1\u5668\u4e4b\u95f4\u4f1a\u81ea\u52a8\u540c\u6b65\u4fe1\u606f\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u968f\u4fbf\u6307\u5b9a\u4e00\u53f0Nacos\u670d\u52a1\u5668\u8fdb\u884c\u6ce8\u518c\uff0c\u5982\u679c\u8fd9\u53f0Nacos\u670d\u52a1\u5668\u6302\u4e86\uff0c\u4f46\u662f\u5176\u4ed6Nacos\u670d\u52a1\u5668\u6ca1\u6302\uff0c\u8fd9\u6837\u5c31\u6ca1\u529e\u6cd5\u5b8c\u6210\u6ce8\u518c\u4e86\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u6574\u4e2a\u96c6\u7fa4\u8fd8\u662f\u53ef\u7528\u7684\u72b6\u6001\u3002</p> <p>\u6240\u4ee5\u8fd9\u91cc\u5c31\u9700\u8981\u5728\u6240\u6709Nacos\u670d\u52a1\u5668\u4e4b\u524d\u642d\u5efa\u4e00\u4e2aSLB\uff08\u670d\u52a1\u5668\u8d1f\u8f7d\u5747\u8861\uff09\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u4e0a\u9762\u7684\u95ee\u9898\u4e86\u3002\u4f46\u662f\u6211\u4eec\u77e5\u9053\uff0c\u5982\u679c\u8981\u5b9e\u73b0\u5916\u754c\u5bf9\u670d\u52a1\u8bbf\u95ee\u7684\u8d1f\u8f7d\u5747\u8861\uff0c\u6211\u4eec\u5c31\u5f97\u7528\u6bd4\u5982\u4e4b\u524d\u8bf4\u5230\u7684Gateway\u6765\u5b9e\u73b0\uff0c\u800c\u8fd9\u91cc\u5b9e\u9645\u4e0a\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u66f4\u52a0\u65b9\u4fbf\u7684\u5de5\u5177\uff1aNginx\uff0c\u6765\u5b9e\u73b0\uff08\u4e4b\u524d\u6211\u4eec\u6ca1\u8bb2\u8fc7\uff0c\u4f46\u662f\u4f7f\u7528\u8d77\u6765\u5f88\u7b80\u5355\uff0c\u653e\u5fc3\u540e\u9762\u4f1a\u5e26\u7740\u5927\u5bb6\u4f7f\u7528\uff09</p> <p>\u5173\u4e8eSLB\u6700\u4e0a\u65b9\u8fd8\u6709\u4e00\u4e2aDNS\uff08\u6211\u4eec\u5728<code>\u8ba1\u7b97\u673a\u7f51\u7edc</code>\u8fd9\u95e8\u8bfe\u7a0b\u4e2d\u5b66\u4e60\u8fc7\uff09\uff0c\u8fd9\u4e2a\u662f\u56e0\u4e3aSLB\u662f\u88f8IP\uff0c\u5982\u679cSLB\u670d\u52a1\u5668\u4fee\u6539\u4e86\u5730\u5740\uff0c\u90a3\u4e48\u6240\u6709\u5fae\u670d\u52a1\u6ce8\u518c\u7684\u5730\u5740\u4e5f\u5f97\u6539\uff0c\u6240\u4ee5\u8fd9\u91cc\u662f\u901a\u8fc7\u52a0\u57df\u540d\uff0c\u901a\u8fc7\u57df\u540d\u6765\u8bbf\u95ee\uff0c\u8ba9DNS\u53bb\u89e3\u6790\u771f\u5b9eIP\uff0c\u8fd9\u6837\u5c31\u7b97\u6539\u53d8IP\uff0c\u53ea\u9700\u8981\u4fee\u6539\u57df\u540d\u89e3\u6790\u8bb0\u5f55\u5373\u53ef\uff0c\u57df\u540d\u5730\u5740\u662f\u4e0d\u4f1a\u53d8\u5316\u7684\u3002</p> <p>\u6700\u540e\u5c31\u662fNacos\u7684\u6570\u636e\u5b58\u50a8\u6a21\u5f0f\uff0c\u5728\u5355\u8282\u70b9\u7684\u60c5\u51b5\u4e0b\uff0cNacos\u5b9e\u9645\u4e0a\u662f\u5c06\u6570\u636e\u5b58\u653e\u5728\u81ea\u5e26\u7684\u4e00\u4e2a\u5d4c\u5165\u5f0f\u6570\u636e\u5e93\u4e2d\uff1a</p> <p></p> <p>\u800c\u8fd9\u79cd\u6a21\u5f0f\u53ea\u9002\u7528\u4e8e\u5355\u8282\u70b9\uff0c\u5728\u591a\u8282\u70b9\u96c6\u7fa4\u6a21\u5f0f\u4e0b\uff0c\u80af\u5b9a\u662f\u4e0d\u80fd\u5404\u5b58\u5404\u7684\uff0c\u6240\u4ee5\uff0cNacos\u63d0\u4f9b\u4e86MySQL\u7edf\u4e00\u5b58\u50a8\u652f\u6301\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8ba9\u6240\u6709\u7684Nacos\u670d\u52a1\u5668\u8fde\u63a5MySQL\u8fdb\u884c\u6570\u636e\u5b58\u50a8\u5373\u53ef\uff0c\u5b98\u65b9\u4e5f\u63d0\u4f9b\u597d\u4e86SQL\u6587\u4ef6\u3002</p> <p>\u73b0\u5728\u5c31\u53ef\u4ee5\u5f00\u59cb\u4e86\uff0c\u7b2c\u4e00\u6b65\uff0c\u6211\u4eec\u76f4\u63a5\u5bfc\u5165\u6570\u636e\u5e93\u5373\u53ef\uff0c\u6587\u4ef6\u5728conf\u76ee\u5f55\u4e2d\uff1a</p> <p></p> <p>\u6211\u4eec\u6765\u5c06\u5176\u5bfc\u5165\u5230\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u770b\u5230\u751f\u6210\u4e86\u5f88\u591a\u7684\u8868\uff1a</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u6765\u521b\u5efa\u4e24\u4e2aNacos\u670d\u52a1\u5668\uff0c\u505a\u4e00\u4e2a\u8ff7\u4f60\u7684\u96c6\u7fa4\uff0c\u8fd9\u91cc\u4f7f\u7528<code>scp</code>\u547d\u4ee4\u5c06nacos\u670d\u52a1\u7aef\u4e0a\u4f20\u5230Linux\u670d\u52a1\u5668\uff08\u6ce8\u610f\u9700\u8981\u63d0\u524d\u5b89\u88c5\u597dJRE 8\u6216\u66f4\u9ad8\u7248\u672c\u7684\u73af\u5883\uff09\uff1a</p> <p></p> <p>\u89e3\u538b\u4e4b\u540e\uff0c\u6211\u4eec\u5bf9\u5176\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u4fee\u6539\uff0c\u9996\u5148\u662f<code>application.properties</code>\u914d\u7f6e\u6587\u4ef6\uff0c\u4fee\u6539\u4ee5\u4e0b\u5185\u5bb9\uff0c\u5305\u62ecMySQL\u670d\u52a1\u5668\u7684\u4fe1\u606f\uff1a</p> <pre><code>### Default web server port:\nserver.port=8801\n\n#*************** Config Module Related Configurations ***************#\n### If use MySQL as datasource:\nspring.datasource.platform=mysql\n\n### Count of DB:\ndb.num=1\n\n### Connect URL of DB:\ndb.url.0=jdbc:mysql://cloudstudy.mysql.cn-chengdu.rds.aliyuncs.com:3306/nacos?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC\ndb.user.0=nacos\ndb.password.0=nacos\n</code></pre> <p>\u7136\u540e\u4fee\u6539\u96c6\u7fa4\u914d\u7f6e\uff0c\u8fd9\u91cc\u9700\u8981\u91cd\u547d\u540d\u4e00\u4e0b\uff1a</p> <p></p> <p>\u7aef\u53e3\u8bb0\u5f97\u4f7f\u7528\u5185\u7f51IP\u5730\u5740\uff1a</p> <p></p> <p>\u6700\u540e\u6211\u4eec\u4fee\u6539\u4e00\u4e0bNacos\u7684\u5185\u5b58\u5206\u914d\u4ee5\u53ca\u524d\u53f0\u542f\u52a8\uff0c\u76f4\u63a5\u4fee\u6539<code>startup.sh</code>\u6587\u4ef6\uff08\u5185\u5b58\u6709\u9650\uff0c\u73a9\u4e0d\u8d77\u9ad8\u7684\uff09\uff1a</p> <p></p> <p>\u4fdd\u5b58\u4e4b\u540e\uff0c\u5c06nacos\u590d\u5236\u4e00\u4efd\uff0c\u5e76\u5c06\u7aef\u53e3\u4fee\u6539\u4e3a8802\uff0c\u63a5\u7740\u542f\u52a8\u8fd9\u4e24\u4e2aNacos\u670d\u52a1\u5668\u3002</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u6253\u5f00\u7ba1\u7406\u9762\u677f\uff0c\u53ef\u4ee5\u770b\u5230\u4e24\u4e2a\u8282\u70b9\u90fd\u5df2\u7ecf\u542f\u52a8\u4e86\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u7b2c\u4e8c\u6b65\u5c31\u5b8c\u6210\u4e86\uff0c\u63a5\u7740\u6211\u4eec\u9700\u8981\u6dfb\u52a0\u4e00\u4e2aSLB\uff0c\u8fd9\u91cc\u6211\u4eec\u7528Nginx\u505a\u53cd\u5411\u4ee3\u7406\uff1a</p> <p>Nginx (engine x) \u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684HTTP\u548c\u53cd\u5411\u4ee3\u7406web\u670d\u52a1\u5668\uff0c\u540c\u65f6\u4e5f\u63d0\u4f9b\u4e86IMAP/POP3/SMTP\u670d\u52a1\u3002\u5b83\u76f8\u5f53\u4e8e\u5728\u5185\u7f51\u4e0e\u5916\u7f51\u4e4b\u95f4\u5f62\u6210\u4e00\u4e2a\u7f51\u5173\uff0c\u6240\u6709\u7684\u8bf7\u6c42\u90fd\u53ef\u4ee5\u7531Nginx\u670d\u52a1\u5668\u8f6c\u4ea4\u7ed9\u5185\u7f51\u7684\u5176\u4ed6\u670d\u52a1\u5668\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u5b89\u88c5\uff1a</p> <pre><code> sudo apt install nginx\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u76f4\u63a5\u8bf7\u6c4280\u7aef\u53e3\u4e4b\u540e\u5f97\u5230\uff0c\u8868\u793a\u5b89\u88c5\u6210\u529f\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u9700\u8981\u8ba9\u5176\u4ee3\u7406\u6211\u4eec\u521a\u521a\u542f\u52a8\u7684\u4e24\u4e2aNacos\u670d\u52a1\u5668\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u5176\u8fdb\u884c\u4e00\u4e9b\u914d\u7f6e\u3002\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e<code>/etc/nginx/nginx.conf</code>\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <pre><code>#\u6dfb\u52a0\u6211\u4eec\u5728\u4e0a\u6e38\u521a\u521a\u521b\u5efa\u597d\u7684\u4e24\u4e2anacos\u670d\u52a1\u5668\nupstream nacos-server {\n        server 10.0.0.12:8801;\n        server 10.0.0.12:8802;\n}\n\nserver {\n        listen   80;\n        server_name  1.14.121.107;\n\n        location /nacos {\n                proxy_pass http://nacos-server;\n        }\n}\n</code></pre> <p>\u91cd\u542fNginx\u670d\u52a1\u5668\uff0c\u6210\u529f\u8fde\u63a5\uff1a</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u5c06\u6240\u6709\u7684\u670d\u52a1\u5168\u90e8\u4fee\u6539\u4e3a\u4e91\u670d\u52a1\u5668\u4e0aNacos\u7684\u5730\u5740\uff0c\u542f\u52a8\u8bd5\u8bd5\u770b\u3002</p> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u642d\u5efa\u597d\u4e86Nacos\u96c6\u7fa4\u3002</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#sentinel","title":"Sentinel \u6d41\u91cf\u9632\u536b\u5175","text":"<p>\u6ce8\u610f\uff1a\u8fd9\u4e00\u7ae0\u6709\u70b9\u5c0f\u7ed5\uff0c\u601d\u8def\u7406\u6e05\u3002</p> <p>\u7ecf\u8fc7\u4e4b\u524d\u7684\u5b66\u4e60\uff0c\u6211\u4eec\u4e86\u89e3\u4e86\u5fae\u670d\u52a1\u5b58\u5728\u7684\u96ea\u5d29\u95ee\u9898\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a\u5fae\u670d\u52a1\u51fa\u73b0\u95ee\u9898\uff0c\u6709\u53ef\u80fd\u5bfc\u81f4\u6574\u4e2a\u94fe\u8def\u76f4\u63a5\u4e0d\u53ef\u7528\uff0c\u8fd9\u79cd\u65f6\u5019\u6211\u4eec\u5c31\u9700\u8981\u8fdb\u884c\u53ca\u65f6\u7684\u7194\u65ad\u548c\u964d\u7ea7\uff0c\u8fd9\u4e9b\u7b56\u7565\uff0c\u6211\u4eec\u4e4b\u524d\u901a\u8fc7\u4f7f\u7528Hystrix\u6765\u5b9e\u73b0\u3002</p> <p>SpringCloud Alibaba\u4e5f\u6709\u81ea\u5df1\u7684\u5fae\u670d\u52a1\u5bb9\u9519\u7ec4\u4ef6\uff0c\u4f46\u662f\u5b83\u76f8\u6bd4Hystrix\u66f4\u52a0\u7684\u5f3a\u5927\u3002</p> <p>\u968f\u7740\u5fae\u670d\u52a1\u7684\u6d41\u884c\uff0c\u670d\u52a1\u548c\u670d\u52a1\u4e4b\u95f4\u7684\u7a33\u5b9a\u6027\u53d8\u5f97\u8d8a\u6765\u8d8a\u91cd\u8981\u3002Sentinel \u4ee5\u6d41\u91cf\u4e3a\u5207\u5165\u70b9\uff0c\u4ece\u6d41\u91cf\u63a7\u5236\u3001\u7194\u65ad\u964d\u7ea7\u3001\u7cfb\u7edf\u8d1f\u8f7d\u4fdd\u62a4\u7b49\u591a\u4e2a\u7ef4\u5ea6\u4fdd\u62a4\u670d\u52a1\u7684\u7a33\u5b9a\u6027\u3002</p> <p>Sentinel \u5177\u6709\u4ee5\u4e0b\u7279\u5f81:</p> <ul> <li>\u4e30\u5bcc\u7684\u5e94\u7528\u573a\u666f\uff1aSentinel \u627f\u63a5\u4e86\u963f\u91cc\u5df4\u5df4\u8fd1 10 \u5e74\u7684\u53cc\u5341\u4e00\u5927\u4fc3\u6d41\u91cf\u7684\u6838\u5fc3\u573a\u666f\uff0c\u4f8b\u5982\u79d2\u6740\uff08\u5373\u7a81\u53d1\u6d41\u91cf\u63a7\u5236\u5728\u7cfb\u7edf\u5bb9\u91cf\u53ef\u4ee5\u627f\u53d7\u7684\u8303\u56f4\uff09\u3001\u6d88\u606f\u524a\u5cf0\u586b\u8c37\u3001\u96c6\u7fa4\u6d41\u91cf\u63a7\u5236\u3001\u5b9e\u65f6\u7194\u65ad\u4e0b\u6e38\u4e0d\u53ef\u7528\u5e94\u7528\u7b49\u3002</li> <li>\u5b8c\u5907\u7684\u5b9e\u65f6\u76d1\u63a7\uff1aSentinel \u540c\u65f6\u63d0\u4f9b\u5b9e\u65f6\u7684\u76d1\u63a7\u529f\u80fd\u3002\u60a8\u53ef\u4ee5\u5728\u63a7\u5236\u53f0\u4e2d\u770b\u5230\u63a5\u5165\u5e94\u7528\u7684\u5355\u53f0\u673a\u5668\u79d2\u7ea7\u6570\u636e\uff0c\u751a\u81f3 500 \u53f0\u4ee5\u4e0b\u89c4\u6a21\u7684\u96c6\u7fa4\u7684\u6c47\u603b\u8fd0\u884c\u60c5\u51b5\u3002</li> <li>\u5e7f\u6cdb\u7684\u5f00\u6e90\u751f\u6001\uff1aSentinel \u63d0\u4f9b\u5f00\u7bb1\u5373\u7528\u7684\u4e0e\u5176\u5b83\u5f00\u6e90\u6846\u67b6/\u5e93\u7684\u6574\u5408\u6a21\u5757\uff0c\u4f8b\u5982\u4e0e Spring Cloud\u3001Apache Dubbo\u3001gRPC\u3001Quarkus \u7684\u6574\u5408\u3002\u60a8\u53ea\u9700\u8981\u5f15\u5165\u76f8\u5e94\u7684\u4f9d\u8d56\u5e76\u8fdb\u884c\u7b80\u5355\u7684\u914d\u7f6e\u5373\u53ef\u5feb\u901f\u5730\u63a5\u5165 Sentinel\u3002\u540c\u65f6 Sentinel \u63d0\u4f9b Java/Go/C++ \u7b49\u591a\u8bed\u8a00\u7684\u539f\u751f\u5b9e\u73b0\u3002</li> <li>\u5b8c\u5584\u7684 SPI \u6269\u5c55\u673a\u5236\uff1aSentinel \u63d0\u4f9b\u7b80\u5355\u6613\u7528\u3001\u5b8c\u5584\u7684 SPI \u6269\u5c55\u63a5\u53e3\u3002\u60a8\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0\u6269\u5c55\u63a5\u53e3\u6765\u5feb\u901f\u5730\u5b9a\u5236\u903b\u8f91\u3002\u4f8b\u5982\u5b9a\u5236\u89c4\u5219\u7ba1\u7406\u3001\u9002\u914d\u52a8\u6001\u6570\u636e\u6e90\u7b49\u3002</li> </ul>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_8","title":"\u5b89\u88c5\u4e0e\u90e8\u7f72","text":"<p>\u548cNacos\u4e00\u6837\uff0c\u5b83\u662f\u72ec\u7acb\u5b89\u88c5\u548c\u90e8\u7f72\u7684\uff0c\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/alibaba/Sentinel/releases</p> <p></p> <p>\u6ce8\u610f\u4e0b\u8f7d\u4e0b\u6765\u4e4b\u540e\u662f\u4e00\u4e2a<code>jar</code>\u6587\u4ef6\uff08\u5176\u5b9e\u5c31\u662f\u4e2aSpringBoot\u9879\u76ee\uff09\uff0c\u6211\u4eec\u9700\u8981\u5728IDEA\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u8fd0\u884c\u914d\u7f6e\uff1a</p> <p></p> <p>\u63a5\u7740\u5c31\u53ef\u4ee5\u76f4\u63a5\u542f\u52a8\u5566\uff0c\u5f53\u7136\u9ed8\u8ba4\u7aef\u53e3\u5360\u75288080\uff0c\u5982\u679c\u9700\u8981\u4fee\u6539\uff0c\u53ef\u4ee5\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\uff1a</p> <p></p> <p>\u542f\u52a8\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u8bbf\u95ee\u5230Sentinel\u7684\u76d1\u63a7\u9875\u9762\u4e86\uff0c\u7528\u6237\u540d\u548c\u5bc6\u7801\u90fd\u662f<code>sentinel</code>\uff0c\u5730\u5740\uff1ahttp://localhost:8858/#/dashboard</p> <p></p> <p>\u8fd9\u6837\u5c31\u6210\u529f\u5f00\u542f\u76d1\u63a7\u9875\u9762\u4e86\uff0c\u63a5\u7740\u6211\u4eec\u9700\u8981\u8ba9\u6211\u4eec\u7684\u670d\u52a1\u8fde\u63a5\u5230Sentinel\u63a7\u5236\u53f0\uff0c\u8001\u89c4\u77e9\uff0c\u5bfc\u5165\u4f9d\u8d56\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7136\u540e\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0Sentinel\u76f8\u5173\u4fe1\u606f\uff08\u5b9e\u9645\u4e0aSentinel\u662f\u672c\u5730\u5728\u8fdb\u884c\u7ba1\u7406\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u8fde\u63a5\u5230\u76d1\u63a7\u9875\u9762\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u56fe\u5f62\u5316\u64cd\u4f5c\u4e86\uff09\uff1a</p> <pre><code>spring:\n  application:\n    name: userservice\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n    sentinel:\n      transport:\n        # \u6dfb\u52a0\u76d1\u63a7\u9875\u9762\u5730\u5740\u5373\u53ef\n        dashboard: localhost:8858\n</code></pre> <p>\u73b0\u5728\u542f\u52a8\u6211\u4eec\u7684\u670d\u52a1\uff0c\u7136\u540e\u8bbf\u95ee\u4e00\u6b21\u670d\u52a1\uff0c\u8fd9\u6837Sentinel\u4e2d\u5c31\u4f1a\u5b58\u5728\u4fe1\u606f\u4e86\uff08\u61d2\u52a0\u8f7d\u673a\u5236\uff0c\u4e0d\u4f1a\u4e00\u4e0a\u6765\u5c31\u52a0\u8f7d\uff09\uff1a</p> <p></p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u5c31\u53ef\u4ee5\u5728Sentinel\u63a7\u5236\u53f0\u4e2d\u5bf9\u6211\u4eec\u7684\u670d\u52a1\u8fd0\u884c\u60c5\u51b5\u8fdb\u884c\u5b9e\u65f6\u76d1\u63a7\u4e86\uff0c\u53ef\u4ee5\u770b\u5230\u76d1\u63a7\u7684\u5185\u5bb9\u975e\u5e38\u7684\u591a\uff0c\u5305\u62ec\u65f6\u95f4\u70b9\u3001QPS(\u6bcf\u79d2\u67e5\u8be2\u7387)\u3001\u54cd\u5e94\u65f6\u95f4\u7b49\u6570\u636e\u3002</p> <p>\u6309\u7167\u4e0a\u9762\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u5c06\u6240\u6709\u7684\u670d\u52a1\u5168\u90e8\u8fde\u63a5\u5230Sentinel\u7ba1\u7406\u9762\u677f\u4e2d\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_9","title":"\u6d41\u91cf\u63a7\u5236","text":"<p>\u524d\u9762\u6211\u4eec\u5b8c\u6210\u4e86\u5bf9Sentinel\u7684\u642d\u5efa\u4e0e\u8fde\u63a5\uff0c\u63a5\u7740\u6211\u4eec\u6765\u770b\u770bSentinel\u7684\u7b2c\u4e00\u4e2a\u529f\u80fd\uff0c\u6d41\u91cf\u63a7\u5236\u3002</p> <p>\u6211\u4eec\u7684\u673a\u5668\u4e0d\u53ef\u80fd\u65e0\u9650\u5236\u7684\u63a5\u53d7\u548c\u5904\u7406\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5982\u679c\u4e0d\u52a0\u4ee5\u9650\u5236\uff0c\u5f53\u53d1\u751f\u9ad8\u5e76\u53d1\u60c5\u51b5\u65f6\uff0c\u7cfb\u7edf\u8d44\u6e90\u5c06\u5f88\u5feb\u88ab\u8017\u5c3d\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6dfb\u52a0\u6d41\u91cf\u63a7\u5236\uff08\u4e5f\u53ef\u4ee5\u8bf4\u662f\u9650\u6d41\uff09\u5f53\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u6d41\u91cf\u5230\u8fbe\u4e00\u5b9a\u7684\u9608\u503c\u7684\u65f6\u5019\uff0c\u65b0\u7684\u8bf7\u6c42\u5c06\u4e0d\u518d\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u6837\u4e0d\u4ec5\u53ef\u4ee5\u5408\u7406\u5730\u5e94\u5bf9\u9ad8\u5e76\u53d1\u8bf7\u6c42\uff0c\u540c\u65f6\u4e5f\u80fd\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u4fdd\u62a4\u670d\u52a1\u5668\u4e0d\u53d7\u5230\u5916\u754c\u7684\u6076\u610f\u653b\u51fb\u3002</p> <p>\u90a3\u4e48\u8981\u5b9e\u73b0\u9650\u6d41\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u8be5\u91c7\u53d6\u4ec0\u4e48\u6837\u7684\u7b56\u7565\u5462\uff1f</p> <ul> <li>\u65b9\u6848\u4e00\uff1a\u5feb\u901f\u62d2\u7edd\uff0c\u65e2\u7136\u4e0d\u518d\u63a5\u53d7\u65b0\u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u62d2\u7edd\u4fe1\u606f\uff0c\u544a\u8bc9\u7528\u6237\u8bbf\u95ee\u9891\u7387\u8fc7\u9ad8\u3002</li> <li>\u65b9\u6848\u4e8c\uff1a\u9884\u70ed\uff0c\u4f9d\u7136\u57fa\u4e8e\u65b9\u6848\u4e00\uff0c\u4f46\u662f\u7531\u4e8e\u67d0\u4e9b\u60c5\u51b5\u4e0b\u9ad8\u5e76\u53d1\u8bf7\u6c42\u662f\u5728\u67d0\u4e00\u65f6\u523b\u7a81\u7136\u5230\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u7f13\u6162\u5730\u5c06\u9608\u503c\u63d0\u9ad8\u5230\u6307\u5b9a\u9608\u503c\uff0c\u5f62\u6210\u4e00\u4e2a\u7f13\u51b2\u4fdd\u62a4\u3002</li> <li>\u65b9\u6848\u4e09\uff1a\u6392\u961f\u7b49\u5f85\uff0c\u4e0d\u63a5\u53d7\u65b0\u7684\u8bf7\u6c42\uff0c\u4f46\u662f\u4e5f\u4e0d\u76f4\u63a5\u62d2\u7edd\uff0c\u800c\u662f\u8fdb\u961f\u5217\u5148\u7b49\u4e00\u4e0b\uff0c\u5982\u679c\u89c4\u5b9a\u65f6\u95f4\u5185\u80fd\u591f\u6267\u884c\uff0c\u90a3\u4e48\u5c31\u6267\u884c\uff0c\u8981\u662f\u8d85\u65f6\u5c31\u7b97\u4e86\u3002</li> </ul> <p>\u9488\u5bf9\u4e8e\u662f\u5426\u8d85\u8fc7\u6d41\u91cf\u9608\u503c\u7684\u5224\u65ad\uff0c\u8fd9\u91cc\u6211\u4eec\u63d04\u79cd\u7b97\u6cd5\uff1a</p> <ol> <li>\u6f0f\u6876\u7b97\u6cd5</li> </ol> <p>\u987e\u540d\u601d\u4e49\uff0c\u5c31\u50cf\u4e00\u4e2a\u6876\u5f00\u4e86\u4e00\u4e2a\u5c0f\u5b54\uff0c\u6c34\u6d41\u8fdb\u6876\u4e2d\u7684\u901f\u5ea6\u80af\u5b9a\u662f\u8fdc\u5927\u4e8e\u6c34\u6d41\u51fa\u6876\u7684\u901f\u5ea6\u7684\uff0c\u8fd9\u4e5f\u662f\u6700\u7b80\u5355\u7684\u4e00\u79cd\u9650\u6d41\u601d\u8def\uff1a</p> <p></p> <p>\u6211\u4eec\u77e5\u9053\uff0c\u6876\u662f\u6709\u5bb9\u91cf\u7684\uff0c\u6240\u4ee5\u5f53\u6876\u7684\u5bb9\u91cf\u5df2\u6ee1\u65f6\uff0c\u5c31\u88c5\u4e0d\u4e0b\u6c34\u4e86\uff0c\u8fd9\u65f6\u5c31\u53ea\u6709\u4e22\u5f03\u8bf7\u6c42\u4e86\u3002</p> <p>\u5229\u7528\u8fd9\u79cd\u601d\u60f3\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5199\u51fa\u4e00\u4e2a\u7b80\u5355\u7684\u9650\u6d41\u7b97\u6cd5\u3002</p> <ol> <li>\u4ee4\u724c\u6876\u7b97\u6cd5</li> </ol> <p>\u53ea\u80fd\u8bf4\u6709\u70b9\u50cf\u4fe1\u53f7\u91cf\u673a\u5236\u3002\u73b0\u5728\u6709\u4e00\u4e2a\u4ee4\u724c\u6876\uff0c\u8fd9\u4e2a\u6876\u662f\u4e13\u95e8\u5b58\u653e\u4ee4\u724c\u7684\uff0c\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u5c31\u5411\u6876\u4e2d\u4e22\u5165\u4e00\u4e2a\u4ee4\u724c\uff08\u901f\u5ea6\u7531\u6211\u4eec\u6307\u5b9a\uff09\u5f53\u65b0\u7684\u8bf7\u6c42\u5230\u8fbe\u65f6\uff0c\u5c06\u4ece\u6876\u4e2d\u5220\u9664\u4ee4\u724c\uff0c\u63a5\u7740\u8bf7\u6c42\u5c31\u53ef\u4ee5\u901a\u8fc7\u5e76\u7ed9\u5230\u670d\u52a1\uff0c\u4f46\u662f\u5982\u679c\u6876\u4e2d\u7684\u4ee4\u724c\u6570\u91cf\u4e0d\u8db3\uff0c\u90a3\u4e48\u4e0d\u4f1a\u5220\u9664\u4ee4\u724c\uff0c\u800c\u662f\u8ba9\u6b64\u6570\u636e\u5305\u7b49\u5f85\u3002</p> <p></p> <p>\u53ef\u4ee5\u8bd5\u60f3\u4e00\u4e0b\uff0c\u5f53\u6d41\u91cf\u4e0b\u964d\u65f6\uff0c\u4ee4\u724c\u6876\u4e2d\u7684\u4ee4\u724c\u4f1a\u9010\u6e10\u79ef\u7d2f\uff0c\u8fd9\u6837\u5982\u679c\u7a81\u7136\u51fa\u73b0\u9ad8\u5e76\u53d1\uff0c\u90a3\u4e48\u5c31\u80fd\u5728\u77ed\u65f6\u95f4\u5185\u62ff\u5230\u5927\u91cf\u7684\u4ee4\u724c\u3002</p> <ol> <li>\u56fa\u5b9a\u65f6\u95f4\u7a97\u53e3\u7b97\u6cd5</li> </ol> <p>\u6211\u4eec\u53ef\u4ee5\u5bf9\u67d0\u4e00\u4e2a\u65f6\u95f4\u6bb5\u5185\u7684\u8bf7\u6c42\u8fdb\u884c\u7edf\u8ba1\u548c\u8ba1\u6570\uff0c\u6bd4\u5982\u5728<code>14:15</code>\u5230<code>14:16</code>\u8fd9\u4e00\u5206\u949f\u5185\uff0c\u8bf7\u6c42\u91cf\u4e0d\u80fd\u8d85\u8fc7<code>100</code>\uff0c\u4e5f\u5c31\u662f\u4e00\u5206\u949f\u4e4b\u5185\u4e0d\u80fd\u8d85\u8fc7<code>100</code>\u6b21\u8bf7\u6c42\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u50cf\u4e0b\u9762\u8fd9\u6837\u8fdb\u884c\u5212\u5206\uff1a</p> <p></p> <p>\u867d\u7136\u8fd9\u79cd\u6a21\u5f0f\u770b\u4f3c\u6bd4\u8f83\u5408\u7406\uff0c\u4f46\u662f\u8bd5\u60f3\u4e00\u4e0b\u8fd9\u79cd\u60c5\u51b5\uff1a</p> <ul> <li>14:15:59\u7684\u65f6\u5019\u6765\u4e86100\u4e2a\u8bf7\u6c42</li> <li>14:16:01\u7684\u65f6\u5019\u53c8\u6765\u4e86100\u4e2a\u8bf7\u6c42</li> </ul> <p>\u51fa\u73b0\u4e0a\u9762\u8fd9\u79cd\u60c5\u51b5\uff0c\u7b26\u5408\u56fa\u5b9a\u65f6\u95f4\u7a97\u53e3\u7b97\u6cd5\u7684\u89c4\u5219\uff0c\u6240\u4ee5\u8fd9200\u4e2a\u8bf7\u6c42\u90fd\u80fd\u6b63\u5e38\u63a5\u53d7\uff0c\u4f46\u662f\uff0c\u5982\u679c\u4f60\u53cd\u5e94\u6bd4\u8f83\u5feb\uff0c\u5e94\u8be5\u53d1\u73b0\u4e86\uff0c\u6211\u4eec\u5176\u5b9e\u5e0c\u671b\u7684\u662f60\u79d2\u5185\u53ea\u6709100\u4e2a\u8bf7\u6c42\uff0c\u4f46\u662f\u8fd9\u79cd\u60c5\u51b5\u5374\u662f\u57283\u79d2\u5185\u51fa\u73b0\u4e86200\u4e2a\u8bf7\u6c42\uff0c\u5f88\u660e\u663e\u5df2\u7ecf\u8fdd\u80cc\u4e86\u6211\u4eec\u7684\u521d\u8877\u3002</p> <p>\u56e0\u6b64\uff0c\u5f53\u9047\u5230\u4e34\u754c\u70b9\u65f6\uff0c\u56fa\u5b9a\u65f6\u95f4\u7a97\u53e3\u7b97\u6cd5\u5b58\u5728\u5b89\u5168\u9690\u60a3\u3002</p> <ol> <li>\u6ed1\u52a8\u65f6\u95f4\u7a97\u53e3\u7b97\u6cd5</li> </ol> <p>\u76f8\u5bf9\u4e8e\u56fa\u5b9a\u7a97\u53e3\u7b97\u6cd5\uff0c\u6ed1\u52a8\u65f6\u95f4\u7a97\u53e3\u7b97\u6cd5\u66f4\u52a0\u7075\u6d3b\uff0c\u5b83\u4f1a\u52a8\u6001\u79fb\u52a8\u7a97\u53e3\uff0c\u91cd\u65b0\u8fdb\u884c\u8ba1\u7b97\uff1a</p> <p></p> <p>\u867d\u7136\u8fd9\u6837\u80fd\u591f\u907f\u514d\u56fa\u5b9a\u65f6\u95f4\u7a97\u53e3\u7684\u4e34\u754c\u95ee\u9898\uff0c\u4f46\u662f\u8fd9\u6837\u663e\u7136\u662f\u6bd4\u56fa\u5b9a\u7a97\u53e3\u66f4\u52a0\u8017\u65f6\u7684\u3002</p> <p>\u597d\u4e86\uff0c\u4e86\u89e3\u5b8c\u4e86\u6211\u4eec\u7684\u9650\u6d41\u7b56\u7565\u548c\u5224\u5b9a\u65b9\u6cd5\u4e4b\u540e\uff0c\u6211\u4eec\u5728Sentinel\u4e2d\u8fdb\u884c\u5b9e\u9645\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u6253\u5f00\u7ba1\u7406\u9875\u9762\u7684\u7c07\u70b9\u94fe\u8def\u6a21\u5757\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6f14\u793a\u5bf9\u6211\u4eec\u7684\u501f\u9605\u63a5\u53e3\u8fdb\u884c\u9650\u6d41\uff0c\u70b9\u51fb<code>\u6d41\u63a7</code>\uff0c\u4f1a\u770b\u5230\u8ba9\u6211\u4eec\u6dfb\u52a0\u6d41\u63a7\u89c4\u5219\uff1a</p> <ul> <li>\u9608\u503c\u7c7b\u578b\uff1aQPS\u5c31\u662f\u6bcf\u79d2\u949f\u7684\u8bf7\u6c42\u6570\u91cf\uff0c\u5e76\u53d1\u7ebf\u7a0b\u6570\u662f\u6309\u670d\u52a1\u5f53\u524d\u4f7f\u7528\u7684\u7ebf\u7a0b\u6570\u636e\u8fdb\u884c\u7edf\u8ba1\u7684\u3002</li> <li>\u6d41\u63a7\u6a21\u5f0f\uff1a\u5f53\u8fbe\u5230\u9608\u503c\u65f6\uff0c\u6d41\u63a7\u7684\u5bf9\u8c61\uff0c\u8fd9\u91cc\u6682\u65f6\u53ea\u7528\u76f4\u63a5\u3002</li> <li>\u6d41\u63a7\u6548\u679c\uff1a\u5c31\u662f\u6211\u4eec\u4e0a\u9762\u6240\u8bf4\u7684\u4e09\u79cd\u65b9\u6848\u3002</li> </ul> <p>\u8fd9\u91cc\u6211\u4eec\u9009\u62e9<code>QPS</code>\u3001\u9608\u503c\u8bbe\u5b9a\u4e3a<code>1</code>\uff0c\u6d41\u63a7\u6a21\u5f0f\u9009\u62e9<code>\u76f4\u63a5</code>\u3001\u6d41\u63a7\u6548\u679c\u9009\u62e9<code>\u5feb\u901f\u5931\u8d25</code>\uff0c\u53ef\u4ee5\u770b\u5230\uff0c\u5f53\u6211\u4eec\u5feb\u901f\u5730\u8fdb\u884c\u8bf7\u6c42\u65f6\uff0c\u4f1a\u76f4\u63a5\u8fd4\u56de\u5931\u8d25\u4fe1\u606f\uff1a</p> <p></p> <p>\u8fd9\u91cc\u5404\u4f4d\u6700\u597d\u81ea\u884c\u5c1d\u8bd5\u4e00\u4e0b\u5176\u4ed6\u7684\u6d41\u63a7\u6548\u679c\uff0c\u719f\u6089\u548c\u52a0\u6df1\u5370\u8c61\u3002</p> <p>\u6700\u540e\u6211\u4eec\u6765\u770b\u770b\u8fd9\u4e9b\u6d41\u63a7\u6a21\u5f0f\u6709\u4ec0\u4e48\u533a\u522b\uff1a</p> <ul> <li>\u76f4\u63a5\uff1a\u53ea\u9488\u5bf9\u4e8e\u5f53\u524d\u63a5\u53e3\u3002</li> <li>\u5173\u8054\uff1a\u5f53\u5176\u4ed6\u63a5\u53e3\u8d85\u8fc7\u9608\u503c\u65f6\uff0c\u4f1a\u5bfc\u81f4\u5f53\u524d\u63a5\u53e3\u88ab\u9650\u6d41\u3002</li> <li>\u94fe\u8def\uff1a\u66f4\u7ec6\u7c92\u5ea6\u7684\u9650\u6d41\uff0c\u80fd\u7cbe\u786e\u5230\u5177\u4f53\u7684\u65b9\u6cd5\u3002</li> </ul> <p>\u6211\u4eec\u9996\u5148\u6765\u770b\u770b\u5173\u8054\uff0c\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u5bf9\u81ea\u5e26\u7684<code>/error</code>\u63a5\u53e3\u8fdb\u884c\u9650\u6d41\uff1a</p> <p></p> <p>\u6ce8\u610f\u9650\u6d41\u662f\u4f5c\u7528\u4e8e\u5173\u8054\u8d44\u6e90\u7684\uff0c\u4e00\u65e6\u53d1\u73b0\u5173\u8054\u8d44\u6e90\u8d85\u8fc7\u9608\u503c\uff0c\u90a3\u4e48\u5c31\u4f1a\u5bf9\u5f53\u524d\u7684\u8d44\u6e90\u8fdb\u884c\u9650\u6d41\uff0c\u6211\u4eec\u73b0\u5728\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u8fd9\u91cc\u4f7f\u7528PostMan\u7684Runner\u8fde\u7eed\u5bf9\u5173\u8054\u8d44\u6e90\u53d1\u8d77\u8bf7\u6c42\uff1a</p> <p></p> <p>\u5f00\u542fPostman\uff0c\u7136\u540e\u6211\u4eec\u4f1a\u53d1\u73b0\u501f\u9605\u670d\u52a1\u5df2\u7ecf\u51c9\u51c9\uff1a</p> <p></p> <p>\u5f53\u6211\u4eec\u5173\u95ed\u6389Postman\u7684\u4efb\u52a1\u540e\uff0c\u6062\u590d\u6b63\u5e38\u3002</p> <p>\u6700\u540e\u6211\u4eec\u6765\u8bb2\u89e3\u4e00\u4e0b\u94fe\u8def\u6a21\u5f0f\uff0c\u5b83\u80fd\u591f\u66f4\u52a0\u7cbe\u51c6\u7684\u8fdb\u884c\u6d41\u91cf\u63a7\u5236\uff0c\u94fe\u8def\u6d41\u63a7\u6a21\u5f0f\u6307\u7684\u662f\uff0c\u5f53\u4ece\u6307\u5b9a\u63a5\u53e3\u8fc7\u6765\u7684\u8d44\u6e90\u8bf7\u6c42\u8fbe\u5230\u9650\u6d41\u6761\u4ef6\u65f6\uff0c\u5f00\u542f\u9650\u6d41\uff0c\u8fd9\u91cc\u5f97\u5148\u8bb2\u89e3\u4e00\u4e0b<code>@SentinelResource</code>\u7684\u4f7f\u7528\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u5bf9\u67d0\u4e00\u4e2a\u65b9\u6cd5\u8fdb\u884c\u9650\u6d41\u63a7\u5236\uff0c\u65e0\u8bba\u662f\u8c01\u5728\u4f55\u5904\u8c03\u7528\u4e86\u5b83\uff0c\u8fd9\u91cc\u9700\u8981\u4f7f\u7528\u5230<code>@SentinelResource</code>\uff0c\u4e00\u65e6\u65b9\u6cd5\u88ab\u6807\u6ce8\uff0c\u90a3\u4e48\u5c31\u4f1a\u8fdb\u884c\u76d1\u63a7\uff0c\u6bd4\u5982\u6211\u4eec\u8fd9\u91cc\u521b\u5efa\u4e24\u4e2a\u8bf7\u6c42\u6620\u5c04\uff0c\u90fd\u6765\u8c03\u7528Service\u7684\u88ab\u76d1\u63a7\u65b9\u6cd5\uff1a</p> <pre><code>@RestController\npublic class BorrowController {\n\n    @Resource\n    BorrowService service;\n\n    @RequestMapping(\"/borrow/{uid}\")\n    UserBorrowDetail findUserBorrows(@PathVariable(\"uid\") int uid){\n        return service.getUserBorrowDetailByUid(uid);\n    }\n\n    @RequestMapping(\"/borrow2/{uid}\")\n    UserBorrowDetail findUserBorrows2(@PathVariable(\"uid\") int uid){\n        return service.getUserBorrowDetailByUid(uid);\n    }\n}\n</code></pre> <pre><code>@Service\npublic class BorrowServiceImpl implements BorrowService{\n\n    @Resource\n    BorrowMapper mapper;\n\n    @Resource\n    UserClient userClient;\n\n    @Resource\n    BookClient bookClient;\n\n    @Override\n    @SentinelResource(\"getBorrow\")   //\u76d1\u63a7\u6b64\u65b9\u6cd5\uff0c\u65e0\u8bba\u88ab\u8c01\u6267\u884c\u90fd\u5728\u76d1\u63a7\u8303\u56f4\u5185\uff0c\u8fd9\u91cc\u7ed9\u7684value\u662f\u81ea\u5b9a\u4e49\u540d\u79f0\uff0c\u8fd9\u4e2a\u6ce8\u89e3\u53ef\u4ee5\u52a0\u5728\u4efb\u4f55\u65b9\u6cd5\u4e0a\uff0c\u5305\u62ecController\u4e2d\u7684\u8bf7\u6c42\u6620\u5c04\u65b9\u6cd5\uff0c\u8ddfHystrixCommand\u8d3c\u50cf\n    public UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n        List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n        User user = userClient.getUserById(uid);\n        List&lt;Book&gt; bookList = borrow\n                .stream()\n                .map(b -&gt; bookClient.getBookById(b.getBid()))\n                .collect(Collectors.toList());\n        return new UserBorrowDetail(user, bookList);\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6dfb\u52a0\u914d\u7f6e\uff1a</p> <pre><code>spring:\n  application:\n    name: borrowservice\n  cloud:\n    sentinel:\n      transport:\n        dashboard: localhost:8858\n      # \u5173\u95edContext\u6536\u655b\uff0c\u8fd9\u6837\u88ab\u76d1\u63a7\u65b9\u6cd5\u53ef\u4ee5\u8fdb\u884c\u4e0d\u540c\u94fe\u8def\u7684\u5355\u72ec\u63a7\u5236\n      web-context-unify: false\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u5728Sentinel\u63a7\u5236\u53f0\u4e2d\u6dfb\u52a0\u6d41\u63a7\u89c4\u5219\uff0c\u6ce8\u610f\u662f\u9488\u5bf9\u6b64\u65b9\u6cd5\uff0c\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u81ea\u52a8\u8bc6\u522b\u5230borrow\u63a5\u53e3\u4e0b\u8c03\u7528\u4e86\u8fd9\u4e2a\u65b9\u6cd5\uff1a</p> <p></p> <p>\u6700\u540e\u6211\u4eec\u5728\u6d4f\u89c8\u5668\u4e2d\u5bf9\u8fd9\u4e24\u4e2a\u63a5\u53e3\u90fd\u8fdb\u884c\u6d4b\u8bd5\uff0c\u4f1a\u53d1\u73b0\uff0c\u65e0\u8bba\u8bf7\u6c42\u54ea\u4e2a\u63a5\u53e3\uff0c\u53ea\u8981\u8c03\u7528\u4e86Service\u4e2d\u7684<code>getUserBorrowDetailByUid</code>\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u90fd\u4f1a\u88ab\u9650\u6d41\u3002\u6ce8\u610f\u9650\u6d41\u7684\u5f62\u5f0f\u662f\u540e\u53f0\u76f4\u63a5\u629b\u51fa\u5f02\u5e38\uff0c\u81f3\u4e8e\u600e\u4e48\u5904\u7406\u6211\u4eec\u540e\u9762\u518d\u8bf4\u3002</p> <p>\u90a3\u4e48\u8fd9\u4e2a\u94fe\u8def\u9009\u9879\u5b9e\u9645\u4e0a\u5c31\u662f\u51b3\u5b9a\u53ea\u9650\u6d41\u4ece\u54ea\u4e2a\u65b9\u5411\u6765\u7684\u8c03\u7528\uff0c\u6bd4\u5982\u6211\u4eec\u53ea\u5bf9<code>borrow2</code>\u8fd9\u4e2a\u63a5\u53e3\u5bf9<code>getUserBorrowDetailByUid</code>\u65b9\u6cd5\u7684\u8c03\u7528\u8fdb\u884c\u9650\u6d41\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u4e3a\u5176\u6307\u5b9a\u94fe\u8def\uff1a</p> <p></p> <p>\u7136\u540e\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u9650\u6d41\u6548\u679c\u53ea\u5bf9\u6211\u4eec\u914d\u7f6e\u7684\u94fe\u8def\u63a5\u53e3\u6709\u6548\uff0c\u800c\u5176\u4ed6\u94fe\u8def\u662f\u4e0d\u4f1a\u88ab\u9650\u6d41\u7684\u3002</p> <p>\u9664\u4e86\u76f4\u63a5\u5bf9\u63a5\u53e3\u8fdb\u884c\u9650\u6d41\u89c4\u5219\u63a7\u5236\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u6839\u636e\u5f53\u524d\u7cfb\u7edf\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\uff0c\u51b3\u5b9a\u662f\u5426\u8fdb\u884c\u9650\u6d41\uff1a</p> <p></p> <p>\u7cfb\u7edf\u89c4\u5219\u652f\u6301\u4ee5\u4e0b\u7684\u6a21\u5f0f\uff1a</p> <ul> <li>Load \u81ea\u9002\u5e94\uff08\u4ec5\u5bf9 Linux/Unix-like \u673a\u5668\u751f\u6548\uff09\uff1a\u7cfb\u7edf\u7684 load1 \u4f5c\u4e3a\u542f\u53d1\u6307\u6807\uff0c\u8fdb\u884c\u81ea\u9002\u5e94\u7cfb\u7edf\u4fdd\u62a4\u3002\u5f53\u7cfb\u7edf load1 \u8d85\u8fc7\u8bbe\u5b9a\u7684\u542f\u53d1\u503c\uff0c\u4e14\u7cfb\u7edf\u5f53\u524d\u7684\u5e76\u53d1\u7ebf\u7a0b\u6570\u8d85\u8fc7\u4f30\u7b97\u7684\u7cfb\u7edf\u5bb9\u91cf\u65f6\u624d\u4f1a\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4\uff08BBR \u9636\u6bb5\uff09\u3002\u7cfb\u7edf\u5bb9\u91cf\u7531\u7cfb\u7edf\u7684 <code>maxQps * minRt</code> \u4f30\u7b97\u5f97\u51fa\u3002\u8bbe\u5b9a\u53c2\u8003\u503c\u4e00\u822c\u662f <code>CPU cores * 2.5</code>\u3002</li> <li>CPU usage\uff081.5.0+ \u7248\u672c\uff09\uff1a\u5f53\u7cfb\u7edf CPU \u4f7f\u7528\u7387\u8d85\u8fc7\u9608\u503c\u5373\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4\uff08\u53d6\u503c\u8303\u56f4 0.0-1.0\uff09\uff0c\u6bd4\u8f83\u7075\u654f\u3002</li> <li>\u5e73\u5747 RT\uff1a\u5f53\u5355\u53f0\u673a\u5668\u4e0a\u6240\u6709\u5165\u53e3\u6d41\u91cf\u7684\u5e73\u5747 RT \u8fbe\u5230\u9608\u503c\u5373\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4\uff0c\u5355\u4f4d\u662f\u6beb\u79d2\u3002</li> <li>\u5e76\u53d1\u7ebf\u7a0b\u6570\uff1a\u5f53\u5355\u53f0\u673a\u5668\u4e0a\u6240\u6709\u5165\u53e3\u6d41\u91cf\u7684\u5e76\u53d1\u7ebf\u7a0b\u6570\u8fbe\u5230\u9608\u503c\u5373\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4\u3002</li> <li>\u5165\u53e3 QPS\uff1a\u5f53\u5355\u53f0\u673a\u5668\u4e0a\u6240\u6709\u5165\u53e3\u6d41\u91cf\u7684 QPS \u8fbe\u5230\u9608\u503c\u5373\u89e6\u53d1\u7cfb\u7edf\u4fdd\u62a4\u3002</li> </ul> <p>\u8fd9\u91cc\u5c31\u4e0d\u8fdb\u884c\u6f14\u793a\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_10","title":"\u9650\u6d41\u548c\u5f02\u5e38\u5904\u7406","text":"<p>\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u5982\u4f55\u8fdb\u884c\u9650\u6d41\u64cd\u4f5c\uff0c\u90a3\u4e48\u9650\u6d41\u72b6\u6001\u4e0b\u7684\u8fd4\u56de\u7ed3\u679c\u8be5\u600e\u4e48\u4fee\u6539\u5462\uff0c\u6211\u4eec\u770b\u5230\u88ab\u9650\u6d41\u4e4b\u540e\u8fd4\u56de\u7684\u662fSentinel\u9ed8\u8ba4\u7684\u6570\u636e\uff0c\u73b0\u5728\u6211\u4eec\u5e0c\u671b\u81ea\u5b9a\u4e49\u6539\u5982\u4f55\u64cd\u4f5c\uff1f</p> <p>\u8fd9\u91cc\u6211\u4eec\u5148\u521b\u5efa\u597d\u88ab\u9650\u6d41\u72b6\u6001\u4e0b\u9700\u8981\u8fd4\u56de\u7684\u5185\u5bb9\uff0c\u5b9a\u4e49\u4e00\u4e2a\u8bf7\u6c42\u6620\u5c04\uff1a</p> <pre><code>@RequestMapping(\"/blocked\")\nJSONObject blocked(){\n    JSONObject object = new JSONObject();\n    object.put(\"code\", 403);\n    object.put(\"success\", false);\n    object.put(\"massage\", \"\u60a8\u7684\u8bf7\u6c42\u9891\u7387\u8fc7\u5feb\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01\");\n    return object;\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5c06\u6b64\u9875\u9762\u8bbe\u5b9a\u4e3a\u9650\u6d41\u9875\u9762\uff1a</p> <pre><code>spring:\n  cloud:\n    sentinel:\n      transport:\n        dashboard: localhost:8858\n      # \u5c06\u521a\u521a\u7f16\u5199\u7684\u8bf7\u6c42\u6620\u5c04\u8bbe\u5b9a\u4e3a\u9650\u6d41\u9875\u9762\n      block-page: /blocked\n</code></pre> <p>\u8fd9\u6837\uff0c\u5f53\u88ab\u9650\u6d41\u65f6\uff0c\u5c31\u4f1a\u88ab\u91cd\u5b9a\u5411\u5230\u6307\u5b9a\u9875\u9762\uff1a</p> <p></p> <p>\u90a3\u4e48\uff0c\u5bf9\u4e8e\u65b9\u6cd5\u7ea7\u522b\u7684\u9650\u6d41\u5462\uff1f\u7ecf\u8fc7\u524d\u9762\u7684\u5b66\u4e60\u6211\u4eec\u77e5\u9053\uff0c\u5f53\u67d0\u4e2a\u65b9\u6cd5\u88ab\u9650\u6d41\u65f6\uff0c\u4f1a\u76f4\u63a5\u5728\u540e\u53f0\u629b\u51fa\u5f02\u5e38\uff0c\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u6211\u4eec\u8be5\u600e\u4e48\u5904\u7406\u5462\uff0c\u6bd4\u5982\u6211\u4eec\u4e4b\u524d\u5728Hystrix\u4e2d\u53ef\u4ee5\u76f4\u63a5\u6dfb\u52a0\u4e00\u4e2a\u66ff\u4ee3\u65b9\u6848\uff0c\u8fd9\u6837\u5f53\u51fa\u73b0\u5f02\u5e38\u65f6\u4f1a\u76f4\u63a5\u6267\u884c\u6211\u4eec\u7684\u66ff\u4ee3\u65b9\u6cd5\u5e76\u8fd4\u56de\uff0cSentinel\u4e5f\u53ef\u4ee5\u3002</p> <p>\u6bd4\u5982\u6211\u4eec\u8fd8\u662f\u5728<code>getUserBorrowDetailByUid</code>\u65b9\u6cd5\u4e0a\u8fdb\u884c\u914d\u7f6e\uff1a</p> <pre><code>@Override\n@SentinelResource(value = \"getBorrow\", blockHandler = \"blocked\")   //\u6307\u5b9ablockHandler\uff0c\u4e5f\u5c31\u662f\u88ab\u9650\u6d41\u4e4b\u540e\u7684\u66ff\u4ee3\u89e3\u51b3\u65b9\u6848\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u7684\u629b\u51fa\u5f02\u5e38\u7684\u5f62\u5f0f\u4e86\npublic UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n    List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n    User user = userClient.getUserById(uid);\n    List&lt;Book&gt; bookList = borrow\n            .stream()\n            .map(b -&gt; bookClient.getBookById(b.getBid()))\n            .collect(Collectors.toList());\n    return new UserBorrowDetail(user, bookList);\n}\n\n//\u66ff\u4ee3\u65b9\u6848\uff0c\u6ce8\u610f\u53c2\u6570\u548c\u8fd4\u56de\u503c\u9700\u8981\u4fdd\u6301\u4e00\u81f4\uff0c\u5e76\u4e14\u53c2\u6570\u6700\u540e\u8fd8\u9700\u8981\u989d\u5916\u6dfb\u52a0\u4e00\u4e2aBlockException\npublic UserBorrowDetail blocked(int uid, BlockException e) {\n    return new UserBorrowDetail(null, Collections.emptyList());\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u4e00\u65e6\u88ab\u9650\u6d41\u5c06\u6267\u884c\u66ff\u4ee3\u65b9\u6848\uff0c\u6700\u540e\u8fd4\u56de\u7684\u7ed3\u679c\u5c31\u662f\uff1a</p> <p></p> <p>\u6ce8\u610f<code>blockHandler</code>\u53ea\u80fd\u5904\u7406\u9650\u6d41\u60c5\u51b5\u4e0b\u629b\u51fa\u7684\u5f02\u5e38\uff0c\u5305\u62ec\u4e0b\u9762\u5373\u5c06\u8981\u4ecb\u7ecd\u7684\u70ed\u70b9\u53c2\u6570\u9650\u6d41\u4e5f\u662f\u540c\u7406\uff0c\u5982\u679c\u662f\u65b9\u6cd5\u672c\u8eab\u629b\u51fa\u7684\u5176\u4ed6\u7c7b\u578b\u5f02\u5e38\uff0c\u4e0d\u5728\u7ba1\u63a7\u8303\u56f4\u5185\uff0c\u4f46\u662f\u53ef\u4ee5\u901a\u8fc7\u5176\u4ed6\u53c2\u6570\u8fdb\u884c\u5904\u7406\uff1a</p> <pre><code>@RequestMapping(\"/test\")\n@SentinelResource(value = \"test\",\n        fallback = \"except\",    //fallback\u6307\u5b9a\u51fa\u73b0\u5f02\u5e38\u65f6\u7684\u66ff\u4ee3\u65b9\u6848\n        exceptionsToIgnore = IOException.class)  //\u5ffd\u7565\u90a3\u4e9b\u5f02\u5e38\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e9b\u5f02\u5e38\u51fa\u73b0\u65f6\u4e0d\u4f7f\u7528\u66ff\u4ee3\u65b9\u6848\nString test(){\n    throw new RuntimeException(\"HelloWorld\uff01\");\n}\n\n//\u66ff\u4ee3\u65b9\u6cd5\u5fc5\u987b\u548c\u539f\u65b9\u6cd5\u8fd4\u56de\u503c\u548c\u53c2\u6570\u4e00\u81f4\uff0c\u6700\u540e\u53ef\u4ee5\u6dfb\u52a0\u4e00\u4e2aThrowable\u4f5c\u4e3a\u53c2\u6570\u63a5\u53d7\u5f02\u5e38\nString except(Throwable t){\n    return t.getMessage();\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u5176\u4ed6\u7684\u5f02\u5e38\u4e5f\u53ef\u4ee5\u6709\u66ff\u4ee3\u65b9\u6848\u4e86\uff1a</p> <p></p> <p>\u7279\u522b\u6ce8\u610f\u8fd9\u79cd\u65b9\u5f0f\u4f1a\u5728\u6ca1\u6709\u914d\u7f6e<code>blockHandler</code>\u7684\u60c5\u51b5\u4e0b\uff0c\u5c06Sentinel\u673a\u5236\u5185\uff08\u4e5f\u5c31\u662f\u9650\u6d41\u7684\u5f02\u5e38\uff09\u7684\u5f02\u5e38\u4e5f\u4e00\u5e76\u5904\u7406\u4e86\uff0c\u5982\u679c\u914d\u7f6e\u4e86<code>blockHandler</code>\uff0c\u90a3\u4e48\u5728\u51fa\u73b0\u9650\u6d41\u65f6\uff0c\u4f9d\u7136\u53ea\u4f1a\u6267\u884c<code>blockHandler</code>\u6307\u5b9a\u7684\u66ff\u4ee3\u65b9\u6848\uff08\u56e0\u4e3a\u9650\u6d41\u662f\u5728\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\u8fdb\u884c\u7684\uff09</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_11","title":"\u70ed\u70b9\u53c2\u6570\u9650\u6d41","text":"<p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u5bf9\u67d0\u4e00\u70ed\u70b9\u6570\u636e\u8fdb\u884c\u7cbe\u51c6\u9650\u6d41\uff0c\u6bd4\u5982\u5728\u67d0\u4e00\u65f6\u523b\uff0c\u4e0d\u540c\u53c2\u6570\u88ab\u643a\u5e26\u8bbf\u95ee\u7684\u9891\u7387\u662f\u4e0d\u4e00\u6837\u7684\uff1a</p> <ul> <li>http://localhost:8301/test?a=10  \u8bbf\u95ee100\u6b21</li> <li>http://localhost:8301/test?b=10  \u8bbf\u95ee0\u6b21</li> <li>http://localhost:8301/test?c=10  \u8bbf\u95ee3\u6b21</li> </ul> <p>\u7531\u4e8e\u643a\u5e26\u53c2\u6570<code>a</code>\u7684\u8bf7\u6c42\u6bd4\u8f83\u591a\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u53ea\u5bf9\u643a\u5e26\u53c2\u6570<code>a</code>\u7684\u8bf7\u6c42\u8fdb\u884c\u9650\u6d41\u3002</p> <p>\u8fd9\u91cc\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6d4b\u8bd5\u8bf7\u6c42\u6620\u5c04\uff1a</p> <pre><code>@RequestMapping(\"/test\")\n@SentinelResource(\"test\")   //\u6ce8\u610f\u8fd9\u91cc\u9700\u8981\u6dfb\u52a0@SentinelResource\u624d\u53ef\u4ee5\uff0c\u7528\u6237\u8d44\u6e90\u540d\u79f0\u5c31\u4f7f\u7528\u8fd9\u91cc\u5b9a\u4e49\u7684\u8d44\u6e90\u540d\u79f0\nString findUserBorrows2(@RequestParam(value = \"a\", required = false) int a,\n                        @RequestParam(value = \"b\", required = false) int b,\n                        @RequestParam(value = \"c\",required = false) int c) {\n    return \"\u8bf7\u6c42\u6210\u529f\uff01a = \"+a+\", b = \"+b+\", c = \"+c;\n}\n</code></pre> <p>\u542f\u52a8\u4e4b\u540e\uff0c\u6211\u4eec\u5728Sentinel\u91cc\u9762\u8fdb\u884c\u70ed\u70b9\u914d\u7f6e\uff1a</p> <p></p> <p>\u7136\u540e\u5f00\u59cb\u8bbf\u95ee\u6211\u4eec\u7684\u6d4b\u8bd5\u63a5\u53e3\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u643a\u5e26\u53c2\u6570a\u65f6\uff0c\u5f53\u8bbf\u95ee\u9891\u7387\u8d85\u8fc7\u8bbe\u5b9a\u503c\uff0c\u5c31\u4f1a\u76f4\u63a5\u88ab\u9650\u6d41\uff0c\u8fd9\u91cc\u662f\u76f4\u63a5\u5728\u540e\u53f0\u629b\u51fa\u5f02\u5e38\uff1a</p> <p></p> <p></p> <p>\u800c\u6211\u4eec\u4f7f\u7528\u5176\u4ed6\u53c2\u6570\u6216\u662f\u4e0d\u5e26<code>a</code>\u53c2\u6570\uff0c\u90a3\u4e48\u5c31\u4e0d\u4f1a\u51fa\u73b0\u8fd9\u79cd\u95ee\u9898\u4e86\uff1a</p> <p></p> <p>\u9664\u4e86\u76f4\u63a5\u5bf9\u67d0\u4e2a\u53c2\u6570\u7cbe\u51c6\u9650\u6d41\u5916\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5bf9\u53c2\u6570\u643a\u5e26\u7684\u6307\u5b9a\u503c\u5355\u72ec\u8bbe\u5b9a\u9608\u503c\uff0c\u6bd4\u5982\u6211\u4eec\u73b0\u5728\u4e0d\u4ec5\u5e0c\u671b\u5bf9\u53c2\u6570<code>a</code>\u9650\u6d41\uff0c\u800c\u4e14\u8fd8\u5e0c\u671b\u5f53\u53c2\u6570<code>a</code>\u7684\u503c\u4e3a10\u65f6\uff0cQPS\u8fbe\u52305\u518d\u8fdb\u884c\u9650\u6d41\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u8bbe\u5b9a\u4f8b\u5916\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u5f53\u8bf7\u6c42\u643a\u5e26\u53c2\u6570<code>a</code>\uff0c\u4e14\u53c2\u6570<code>a</code>\u7684\u503c\u4e3a10\u65f6\uff0c\u9608\u503c\u5c06\u6309\u7167\u6211\u4eec\u6307\u5b9a\u7684\u7279\u4f8b\u8fdb\u884c\u8ba1\u7b97\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_12","title":"\u670d\u52a1\u7194\u65ad\u548c\u964d\u7ea7","text":"<p>\u8fd8\u8bb0\u5f97\u6211\u4eec\u524d\u6240\u8bf4\u7684\u670d\u52a1\u964d\u7ea7\u5417\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u9700\u8981\u5728\u6574\u4e2a\u5fae\u670d\u52a1\u8c03\u7528\u94fe\u8def\u51fa\u73b0\u95ee\u9898\u7684\u65f6\u5019\uff0c\u53ca\u65f6\u5bf9\u670d\u52a1\u8fdb\u884c\u964d\u7ea7\uff0c\u4ee5\u9632\u6b62\u95ee\u9898\u8fdb\u4e00\u6b65\u6076\u5316\u3002</p> <p></p> <p>\u90a3\u4e48\uff0c\u5404\u4f4d\u662f\u5426\u6709\u601d\u8003\u8fc7\uff0c\u5982\u679c\u5728\u67d0\u4e00\u65f6\u523b\uff0c\u670d\u52a1B\u51fa\u73b0\u6545\u969c\uff08\u53ef\u80fd\u5c31\u5361\u5728\u90a3\u91cc\u4e86\uff09\uff0c\u800c\u8fd9\u65f6\u670d\u52a1A\u4f9d\u7136\u6709\u5927\u91cf\u7684\u8bf7\u6c42\uff0c\u5728\u8c03\u7528\u670d\u52a1B\uff0c\u90a3\u4e48\uff0c\u7531\u4e8e\u670d\u52a1A\u6ca1\u529e\u6cd5\u518d\u77ed\u65f6\u95f4\u5185\u5b8c\u6210\u5904\u7406\uff0c\u65b0\u6765\u7684\u8bf7\u6c42\u5c31\u4f1a\u5bfc\u81f4\u7ebf\u7a0b\u6570\u4e0d\u65ad\u5730\u589e\u52a0\uff0c\u8fd9\u6837\uff0cCPU\u7684\u8d44\u6e90\u5f88\u5feb\u5c31\u4f1a\u88ab\u8017\u5c3d\u3002</p> <p>\u90a3\u4e48\u8981\u9632\u6b62\u8fd9\u79cd\u60c5\u51b5\uff0c\u5c31\u53ea\u80fd\u8fdb\u884c\u9694\u79bb\u4e86\uff0c\u8fd9\u91cc\u6211\u4eec\u63d0\u4e24\u79cd\u9694\u79bb\u65b9\u6848\uff1a</p> <ol> <li>\u7ebf\u7a0b\u6c60\u9694\u79bb</li> </ol> <p>\u7ebf\u7a0b\u6c60\u9694\u79bb\u5b9e\u9645\u4e0a\u5c31\u662f\u5bf9\u6bcf\u4e2a\u670d\u52a1\u7684\u8fdc\u7a0b\u8c03\u7528\u5355\u72ec\u5f00\u653e\u7ebf\u7a0b\u6c60\uff0c\u6bd4\u5982\u670d\u52a1A\u8981\u8c03\u7528\u670d\u52a1B\uff0c\u90a3\u4e48\u53ea\u57fa\u4e8e\u56fa\u5b9a\u6570\u91cf\u7684\u7ebf\u7a0b\u6c60\uff0c\u8fd9\u6837\u5373\u4f7f\u5728\u77ed\u65f6\u95f4\u5185\u51fa\u73b0\u5927\u91cf\u8bf7\u6c42\uff0c\u7531\u4e8e\u6ca1\u6709\u7ebf\u7a0b\u53ef\u4ee5\u5206\u914d\uff0c\u6240\u4ee5\u5c31\u4e0d\u4f1a\u5bfc\u81f4\u8d44\u6e90\u8017\u5c3d\u4e86\u3002</p> <p></p> <ol> <li>\u4fe1\u53f7\u91cf\u9694\u79bb</li> </ol> <p>\u4fe1\u53f7\u91cf\u9694\u79bb\u662f\u4f7f\u7528<code>Semaphore</code>\u7c7b\u5b9e\u73b0\u7684\uff08\u5982\u679c\u4e0d\u4e86\u89e3\uff0c\u53ef\u4ee5\u89c2\u770b\u672c\u7cfb\u5217 \u5e76\u53d1\u7f16\u7a0b\u7bc7 \u89c6\u9891\u6559\u7a0b\uff09\uff0c\u601d\u60f3\u57fa\u672c\u4e0a\u4e0e\u4e0a\u9762\u662f\u76f8\u540c\u7684\uff0c\u4e5f\u662f\u9650\u5b9a\u6307\u5b9a\u7684\u7ebf\u7a0b\u6570\u91cf\u80fd\u591f\u540c\u65f6\u8fdb\u884c\u670d\u52a1\u8c03\u7528\uff0c\u4f46\u662f\u5b83\u76f8\u5bf9\u4e8e\u7ebf\u7a0b\u6c60\u9694\u79bb\uff0c\u5f00\u9500\u4f1a\u66f4\u5c0f\u4e00\u4e9b\uff0c\u4f7f\u7528\u6548\u679c\u540c\u6837\u4f18\u79c0\uff0c\u4e5f\u652f\u6301\u8d85\u65f6\u7b49\u3002</p> <p>Sentinel\u4e5f\u6b63\u662f\u91c7\u7528\u7684\u8fd9\u79cd\u65b9\u6848\u5b9e\u73b0\u9694\u79bb\u7684\u3002</p> <p>\u597d\u4e86\uff0c\u8bf4\u56de\u6211\u4eec\u7684\u7194\u65ad\u548c\u964d\u7ea7\uff0c\u5f53\u4e0b\u6e38\u670d\u52a1\u56e0\u4e3a\u67d0\u79cd\u539f\u56e0\u53d8\u5f97\u4e0d\u53ef\u7528\u6216\u54cd\u5e94\u8fc7\u6162\u65f6\uff0c\u4e0a\u6e38\u670d\u52a1\u4e3a\u4e86\u4fdd\u8bc1\u81ea\u5df1\u6574\u4f53\u670d\u52a1\u7684\u53ef\u7528\u6027\uff0c\u4e0d\u518d\u7ee7\u7eed\u8c03\u7528\u76ee\u6807\u670d\u52a1\u800c\u662f\u5feb\u901f\u8fd4\u56de\u6216\u662f\u6267\u884c\u81ea\u5df1\u7684\u66ff\u4ee3\u65b9\u6848\uff0c\u8fd9\u4fbf\u662f\u670d\u52a1\u964d\u7ea7\u3002</p> <p></p> <p>\u6574\u4e2a\u8fc7\u7a0b\u5206\u4e3a\u4e09\u4e2a\u72b6\u6001\uff1a</p> <ul> <li>\u5173\u95ed\uff1a\u7194\u65ad\u5668\u4e0d\u5de5\u4f5c\uff0c\u6240\u6709\u8bf7\u6c42\u5168\u90e8\u8be5\u5e72\u561b\u5e72\u561b\u3002</li> <li>\u6253\u5f00\uff1a\u7194\u65ad\u5668\u5de5\u4f5c\uff0c\u6240\u6709\u8bf7\u6c42\u4e00\u5f8b\u964d\u7ea7\u5904\u7406\u3002</li> <li>\u534a\u5f00\uff1a\u5c1d\u8bd5\u8fdb\u884c\u4e00\u4e0b\u4e0b\u6b63\u5e38\u6d41\u7a0b\uff0c\u8981\u662f\u8fd8\u4e0d\u884c\u7ee7\u7eed\u4fdd\u6301\u6253\u5f00\u72b6\u6001\uff0c\u5426\u5219\u5173\u95ed\u3002</li> </ul> <p>\u90a3\u4e48\u6211\u4eec\u6765\u770b\u770bSentinel\u4e2d\u5982\u4f55\u8fdb\u884c\u7194\u65ad\u548c\u964d\u7ea7\u64cd\u4f5c\uff0c\u6253\u5f00\u7ba1\u7406\u9875\u9762\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u7531\u65b0\u589e\u7194\u65ad\u89c4\u5219\uff1a</p> <p></p> <p>\u5176\u4e2d\uff0c\u7194\u65ad\u7b56\u7565\u6709\u4e09\u79cd\u6a21\u5f0f\uff1a</p> <ol> <li>\u6162\u8c03\u7528\u6bd4\u4f8b\uff1a\u5982\u679c\u51fa\u73b0\u90a3\u79cd\u534a\u5929\u90fd\u5904\u7406\u4e0d\u5b8c\u7684\u8c03\u7528\uff0c\u6709\u53ef\u80fd\u5c31\u662f\u670d\u52a1\u51fa\u73b0\u6545\u969c\uff0c\u5bfc\u81f4\u5361\u987f\uff0c\u8fd9\u4e2a\u9009\u9879\u662f\u6309\u7167\u6700\u5927\u54cd\u5e94\u65f6\u95f4\uff08RT\uff09\u8fdb\u884c\u5224\u5b9a\uff0c\u5982\u679c\u4e00\u6b21\u8bf7\u6c42\u7684\u5904\u7406\u65f6\u95f4\u8d85\u8fc7\u4e86\u6307\u5b9a\u7684RT\uff0c\u90a3\u4e48\u5c31\u88ab\u5224\u5b9a\u4e3a<code>\u6162\u8c03\u7528</code>\uff0c\u5728\u4e00\u4e2a\u7edf\u8ba1\u65f6\u957f\u5185\uff0c\u5982\u679c\u8bf7\u6c42\u6570\u76ee\u5927\u4e8e\u6700\u5c0f\u8bf7\u6c42\u6570\u76ee\uff0c\u5e76\u4e14\u88ab\u5224\u5b9a\u4e3a<code>\u6162\u8c03\u7528</code>\u7684\u8bf7\u6c42\u6bd4\u4f8b\u5df2\u7ecf\u8d85\u8fc7\u9608\u503c\uff0c\u5c06\u89e6\u53d1\u7194\u65ad\u3002\u7ecf\u8fc7\u7194\u65ad\u65f6\u957f\u4e4b\u540e\uff0c\u5c06\u4f1a\u8fdb\u5165\u5230\u534a\u5f00\u72b6\u6001\u8fdb\u884c\u8bd5\u63a2\uff08\u8fd9\u91cc\u548cHystrix\u4e00\u81f4\uff09</li> </ol> <p>\u7136\u540e\u4fee\u6539\u4e00\u4e0b\u63a5\u53e3\u7684\u6267\u884c\uff0c\u6211\u4eec\u6a21\u62df\u4e00\u4e0b\u6162\u8c03\u7528\uff1a</p> <pre><code>@RequestMapping(\"/borrow2/{uid}\")\nUserBorrowDetail findUserBorrows2(@PathVariable(\"uid\") int uid) throws InterruptedException {\n    Thread.sleep(1000);\n    return null;\n}\n</code></pre> <p>\u91cd\u542f\uff0c\u7136\u540e\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7194\u65ad\u89c4\u5219\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8d85\u65f6\u76f4\u63a5\u89e6\u53d1\u4e86\u7194\u65ad\uff0c\u8fdb\u5165\u5230\u963b\u6b62\u9875\u9762\uff1a</p> <p></p> <ol> <li>\u5f02\u5e38\u6bd4\u4f8b\uff1a\u8fd9\u4e2a\u4e0e\u6162\u8c03\u7528\u6bd4\u4f8b\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u8fd9\u91cc\u5224\u65ad\u7684\u662f\u51fa\u73b0\u5f02\u5e38\u7684\u6b21\u6570\uff0c\u4e0e\u4e0a\u9762\u4e00\u6837\uff0c\u6211\u4eec\u4e5f\u6765\u8fdb\u884c\u4e00\u4e9b\u5c0f\u6d4b\u8bd5\uff1a</li> </ol> <pre><code>@RequestMapping(\"/borrow2/{uid}\")\nUserBorrowDetail findUserBorrows2(@PathVariable(\"uid\") int uid) {\n    throw new RuntimeException();\n}\n</code></pre> <p>\u542f\u52a8\u670d\u52a1\u5668\uff0c\u63a5\u7740\u6dfb\u52a0\u6211\u4eec\u7684\u7194\u65ad\u89c4\u5219\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u8fdb\u884c\u8bbf\u95ee\uff0c\u4f1a\u53d1\u73b0\u540e\u53f0\u75af\u72c2\u62a5\u9519\uff0c\u7136\u540e\u5c31\u7194\u65ad\u4e86\uff1a</p> <p></p> <p></p> <ol> <li>\u5f02\u5e38\u6570\uff1a\u8fd9\u4e2a\u548c\u4e0a\u9762\u7684\u552f\u4e00\u533a\u522b\u5c31\u662f\uff0c\u53ea\u8981\u8fbe\u5230\u6307\u5b9a\u7684\u5f02\u5e38\u6570\u91cf\uff0c\u5c31\u7194\u65ad\uff0c\u8fd9\u91cc\u6211\u4eec\u4fee\u6539\u4e00\u4e0b\u7194\u65ad\u89c4\u5219\uff1a</li> </ol> <p></p> <p>\u73b0\u5728\u6211\u4eec\u518d\u6b21\u4e0d\u65ad\u8bbf\u95ee\u6b64\u63a5\u53e3\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u6548\u679c\u8ddf\u4e4b\u524d\u5176\u5b9e\u662f\u5dee\u4e0d\u591a\u7684\uff0c\u53ea\u662f\u5224\u65ad\u7684\u7b56\u7565\u7a0d\u5fae\u4e0d\u540c\u7f62\u4e86\uff1a</p> <p></p> <p>\u90a3\u4e48\u7194\u65ad\u89c4\u5219\u5982\u4f55\u8bbe\u5b9a\u6211\u4eec\u4e86\u89e3\u4e86\uff0c\u90a3\u4e48\uff0c\u5982\u4f55\u81ea\u5b9a\u4e49\u670d\u52a1\u964d\u7ea7\u5462\uff1f\u4e4b\u524d\u5728\u4f7f\u7528Hystrix\u7684\u65f6\u5019\uff0c\u5982\u679c\u51fa\u73b0\u5f02\u5e38\uff0c\u53ef\u4ee5\u6267\u884c\u6211\u4eec\u7684\u66ff\u4ee3\u65b9\u6848\uff0cSentinel\u4e5f\u662f\u53ef\u4ee5\u7684\u3002</p> <p>\u540c\u6837\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728<code>@SentinelResource</code>\u4e2d\u914d\u7f6e<code>blockHandler</code>\u53c2\u6570\uff08\u90a3\u8fd9\u91cc\u8ddf\u524d\u9762\u90a3\u4e2a\u65b9\u6cd5\u9650\u6d41\u7684\u914d\u7f6e\u4e0d\u662f\u4e00\u6bdb\u4e00\u6837\u5417\uff1f\u6ca1\u9519\uff0c\u56e0\u4e3a\u5982\u679c\u6dfb\u52a0\u4e86<code>@SentinelResource</code>\u6ce8\u89e3\uff0c\u90a3\u4e48\u8fd9\u91cc\u4f1a\u8fdb\u884c\u65b9\u6cd5\u7ea7\u522b\u7ec6\u7c92\u5ea6\u7684\u9650\u5236\uff0c\u548c\u4e4b\u524d\u65b9\u6cd5\u7ea7\u522b\u9650\u6d41\u4e00\u6837\uff0c\u4f1a\u5728\u964d\u7ea7\u4e4b\u540e\u76f4\u63a5\u629b\u51fa\u5f02\u5e38\uff0c\u5982\u679c\u4e0d\u6dfb\u52a0\u5219\u8fd4\u56de\u9ed8\u8ba4\u7684\u9650\u6d41\u9875\u9762\uff0c<code>blockHandler</code>\u7684\u76ee\u7684\u5c31\u662f\u5904\u7406\u8fd9\u79cdSentinel\u673a\u5236\u4e0a\u7684\u5f02\u5e38\uff0c\u6240\u4ee5\u8fd9\u91cc\u5176\u5b9e\u548c\u4e4b\u524d\u7684\u9650\u6d41\u914d\u7f6e\u662f\u4e00\u4e2a\u9053\u7406\uff0c\u56e0\u6b64\u4e0b\u9762\u7194\u65ad\u914d\u7f6e\u4e5f\u5e94\u8be5\u5bf9<code>value</code>\u81ea\u5b9a\u4e49\u540d\u79f0\u7684\u8d44\u6e90\u8fdb\u884c\u914d\u7f6e\uff0c\u624d\u80fd\u4f5c\u7528\u5230\u6b64\u65b9\u6cd5\u4e0a\uff09\uff1a</p> <pre><code>@RequestMapping(\"/borrow2/{uid}\")\n@SentinelResource(value = \"findUserBorrows2\", blockHandler = \"test\")\nUserBorrowDetail findUserBorrows2(@PathVariable(\"uid\") int uid) {\n    throw new RuntimeException();\n}\n\nUserBorrowDetail test(int uid, BlockException e){\n    return new UserBorrowDetail(new User(), Collections.emptyList());\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u5bf9\u8fdb\u884c\u7194\u65ad\u914d\u7f6e\uff0c\u6ce8\u610f\u662f\u5bf9\u6211\u4eec\u6dfb\u52a0\u7684<code>@SentinelResource</code>\u4e2d\u6307\u5b9a\u540d\u79f0\u7684<code>findUserBorrows2</code>\u8fdb\u884c\u914d\u7f6e\uff1a</p> <p></p> <p>OK\uff0c\u53ef\u4ee5\u770b\u5230\u7194\u65ad\u4e4b\u540e\uff0c\u670d\u52a1\u964d\u7ea7\u4e4b\u540e\u7684\u6548\u679c\uff1a</p> <p></p> <p>\u6700\u540e\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u5982\u4f55\u8ba9Feign\u7684\u4e5f\u652f\u6301Sentinel\uff0c\u524d\u9762\u6211\u4eec\u4f7f\u7528Hystrix\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u5bf9Feign\u7684\u6bcf\u4e2a\u63a5\u53e3\u8c03\u7528\u5355\u72ec\u8fdb\u884c\u670d\u52a1\u964d\u7ea7\uff0c\u800c\u4f7f\u7528Sentinel\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5f00\u542f\u652f\u6301\uff1a</p> <pre><code>feign:\n  sentinel:\n    enabled: true\n</code></pre> <p>\u4e4b\u540e\u7684\u6b65\u9aa4\u5176\u5b9e\u548c\u4e4b\u524d\u662f\u4e00\u6a21\u4e00\u6837\u7684\uff0c\u9996\u5148\u521b\u5efa\u5b9e\u73b0\u7c7b\uff1a</p> <pre><code>@Component\npublic class UserClientFallback implements UserClient{\n    @Override\n    public User getUserById(int uid) {\n        User user = new User();\n        user.setName(\"\u6211\u662f\u66ff\u4ee3\u65b9\u6848\");\n        return user;\n    }\n}\n</code></pre> <p>\u7136\u540e\u76f4\u63a5\u542f\u52a8\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e2d\u9014\u7684\u65f6\u5019\u6211\u4eec\u5427\u7528\u6237\u670d\u52a1\u5168\u90e8\u4e0b\u6389\uff0c\u53ef\u4ee5\u770b\u5230\u6b63\u5e38\u4f7f\u7528\u66ff\u4ee3\u65b9\u6848\uff1a</p> <p></p> <p>\u8fd9\u6837Feign\u7684\u914d\u7f6e\u5c31OK\u4e86\uff0c\u90a3\u4e48\u4f20\u7edf\u7684RestTemplate\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>@SentinelRestTemplate</code>\u6ce8\u89e3\u5b9e\u73b0\uff1a</p> <pre><code>  @Bean\n  @LoadBalanced\n  @SentinelRestTemplate(blockHandler = \"handleException\", blockHandlerClass = ExceptionUtil.class,\n      fallback = \"fallback\", fallbackClass = ExceptionUtil.class) //\u8fd9\u91cc\u540c\u6837\u53ef\u4ee5\u8bbe\u5b9afallback\u7b49\u53c2\u6570\n  public RestTemplate restTemplate() {\n    return new RestTemplate();\n  }\n</code></pre> <p>\u8fd9\u91cc\u5c31\u4e0d\u591a\u505a\u8d58\u8ff0\u4e86\u3002</p> <p></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#seata","title":"Seata\u4e0e\u5206\u5e03\u5f0f\u4e8b\u52a1","text":"<p>\u91cd\u96be\u70b9\u5185\u5bb9\uff0c\u5751\u4e5f\u591a\u5f97\u79bb\u8c31\uff0c\u6700\u597d\u4fdd\u6301\u8ddfUP\u4e00\u6837\u7684\u7248\u672c\uff0c\u5b98\u65b9\u6587\u6863\uff1ahttps://seata.io/zh-cn/docs/overview/what-is-seata.html</p> <p>\u5728\u524d\u9762\u7684\u9636\u6bb5\u4e2d\uff0c\u6211\u4eec\u5b66\u4e60\u8fc7\u4e8b\u52a1\uff0c\u8fd8\u8bb0\u5f97\u6211\u4eec\u4e4b\u524d\u8c08\u5230\u7684\u6570\u636e\u5e93\u4e8b\u52a1\u7684\u7279\u6027\u5417\uff1f</p> <ul> <li>\u539f\u5b50\u6027\uff1a\u4e00\u4e2a\u4e8b\u52a1\uff08transaction\uff09\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u8981\u4e48\u5168\u90e8\u5b8c\u6210\uff0c\u8981\u4e48\u5168\u90e8\u4e0d\u5b8c\u6210\uff0c\u4e0d\u4f1a\u7ed3\u675f\u5728\u4e2d\u95f4\u67d0\u4e2a\u73af\u8282\u3002\u4e8b\u52a1\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u53d1\u751f\u9519\u8bef\uff0c\u4f1a\u88ab\u56de\u6eda\uff08Rollback\uff09\u5230\u4e8b\u52a1\u5f00\u59cb\u524d\u7684\u72b6\u6001\uff0c\u5c31\u50cf\u8fd9\u4e2a\u4e8b\u52a1\u4ece\u6765\u6ca1\u6709\u6267\u884c\u8fc7\u4e00\u6837\u3002</li> <li>\u4e00\u81f4\u6027\uff1a\u5728\u4e8b\u52a1\u5f00\u59cb\u4e4b\u524d\u548c\u4e8b\u52a1\u7ed3\u675f\u4ee5\u540e\uff0c\u6570\u636e\u5e93\u7684\u5b8c\u6574\u6027\u6ca1\u6709\u88ab\u7834\u574f\u3002\u8fd9\u8868\u793a\u5199\u5165\u7684\u8d44\u6599\u5fc5\u987b\u5b8c\u5168\u7b26\u5408\u6240\u6709\u7684\u9884\u8bbe\u89c4\u5219\uff0c\u8fd9\u5305\u542b\u8d44\u6599\u7684\u7cbe\u786e\u5ea6\u3001\u4e32\u8054\u6027\u4ee5\u53ca\u540e\u7eed\u6570\u636e\u5e93\u53ef\u4ee5\u81ea\u53d1\u6027\u5730\u5b8c\u6210\u9884\u5b9a\u7684\u5de5\u4f5c\u3002</li> <li>\u9694\u79bb\u6027\uff1a\u6570\u636e\u5e93\u5141\u8bb8\u591a\u4e2a\u5e76\u53d1\u4e8b\u52a1\u540c\u65f6\u5bf9\u5176\u6570\u636e\u8fdb\u884c\u8bfb\u5199\u548c\u4fee\u6539\u7684\u80fd\u529b\uff0c\u9694\u79bb\u6027\u53ef\u4ee5\u9632\u6b62\u591a\u4e2a\u4e8b\u52a1\u5e76\u53d1\u6267\u884c\u65f6\u7531\u4e8e\u4ea4\u53c9\u6267\u884c\u800c\u5bfc\u81f4\u6570\u636e\u7684\u4e0d\u4e00\u81f4\u3002\u4e8b\u52a1\u9694\u79bb\u5206\u4e3a\u4e0d\u540c\u7ea7\u522b\uff0c\u5305\u62ec\u8bfb\u672a\u63d0\u4ea4\uff08Read uncommitted\uff09\u3001\u8bfb\u5df2\u63d0\u4ea4\uff08read committed\uff09\u3001\u53ef\u91cd\u590d\u8bfb\uff08repeatable read\uff09\u548c\u4e32\u884c\u5316\uff08Serializable\uff09\u3002</li> <li>\u6301\u4e45\u6027\uff1a\u4e8b\u52a1\u5904\u7406\u7ed3\u675f\u540e\uff0c\u5bf9\u6570\u636e\u7684\u4fee\u6539\u5c31\u662f\u6c38\u4e45\u7684\uff0c\u5373\u4fbf\u7cfb\u7edf\u6545\u969c\u4e5f\u4e0d\u4f1a\u4e22\u5931\u3002</li> </ul> <p>\u90a3\u4e48\u5404\u4f4d\u8bd5\u60f3\u4e00\u4e0b\uff0c\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e0b\uff0c\u6709\u53ef\u80fd\u51fa\u73b0\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff0c\u6bd4\u5982\u6211\u4eec\u4e0b\u5355\u8d2d\u7269\uff0c\u90a3\u4e48\u6574\u4e2a\u6d41\u7a0b\u53ef\u80fd\u662f\u8fd9\u6837\u7684\uff1a\u5148\u8c03\u7528\u5e93\u5b58\u670d\u52a1\u5bf9\u5e93\u5b58\u8fdb\u884c\u51cf\u6263 -&gt; \u7136\u540e\u8ba2\u5355\u670d\u52a1\u5f00\u59cb\u4e0b\u5355 -&gt; \u6700\u540e\u7528\u6237\u8d26\u6237\u670d\u52a1\u8fdb\u884c\u6263\u6b3e\uff0c\u867d\u7136\u770b\u4f3c\u662f\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u4e00\u4e2a\u6d41\u7a0b\uff0c\u4f46\u662f\u5982\u679c\u6ca1\u6709\u4e8b\u52a1\u7684\u52a0\u6301\uff0c\u5f88\u6709\u53ef\u80fd\u4f1a\u7531\u4e8e\u4e2d\u9014\u51fa\u9519\uff0c\u6bd4\u5982\u6574\u4e2a\u6d41\u7a0b\u4e2d\u8ba2\u5355\u670d\u52a1\u51fa\u73b0\u95ee\u9898\uff0c\u90a3\u4e48\u5c31\u4f1a\u5bfc\u81f4\u5e93\u5b58\u6263\u4e86\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8fd9\u4e2a\u8ba2\u5355\u5e76\u6ca1\u6709\u751f\u6210\uff0c\u7528\u6237\u4e5f\u6ca1\u6709\u4ed8\u6b3e\u3002</p> <p></p> <p>\u4e0a\u9762\u8fd9\u79cd\u60c5\u51b5\u65f6\u95f4\u5c31\u662f\u4e00\u79cd\u591a\u670d\u52a1\u591a\u6570\u636e\u6e90\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u6a21\u578b\uff08\u6bd4\u8f83\u5e38\u89c1\uff09\uff0c\u56e0\u6b64\uff0c\u4e3a\u4e86\u89e3\u51b3\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u5c31\u5f97\u5b9e\u73b0\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u8ba9\u8fd9\u6574\u4e2a\u6d41\u7a0b\u4fdd\u8bc1\u539f\u5b50\u6027\u3002</p> <p>SpringCloud Alibaba\u4e3a\u6211\u4eec\u63d0\u4f9b\u4e86\u7528\u4e8e\u5904\u7406\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u7ec4\u4ef6Seata\u3002</p> <p></p> <p>Seata \u662f\u4e00\u6b3e\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u89e3\u51b3\u65b9\u6848\uff0c\u81f4\u529b\u4e8e\u63d0\u4f9b\u9ad8\u6027\u80fd\u548c\u7b80\u5355\u6613\u7528\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u670d\u52a1\u3002Seata \u5c06\u4e3a\u7528\u6237\u63d0\u4f9b\u4e86 AT\u3001TCC\u3001SAGA \u548c XA \u4e8b\u52a1\u6a21\u5f0f\uff0c\u4e3a\u7528\u6237\u6253\u9020\u4e00\u7ad9\u5f0f\u7684\u5206\u5e03\u5f0f\u89e3\u51b3\u65b9\u6848\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c\u5c31\u662f\u591a\u4e86\u4e00\u4e2a\u4e2d\u95f4\u4eba\u6765\u534f\u8c03\u6240\u6709\u670d\u52a1\u7684\u4e8b\u52a1\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_13","title":"\u9879\u76ee\u73af\u5883\u642d\u5efa","text":"<p>\u8fd9\u91cc\u6211\u4eec\u5bf9\u6211\u4eec\u4e4b\u524d\u7684\u56fe\u4e66\u7ba1\u7406\u7cfb\u7edf\u8fdb\u884c\u5347\u7ea7\uff1a</p> <ul> <li>\u6bcf\u4e2a\u7528\u6237\u6700\u591a\u53ea\u80fd\u540c\u65f6\u501f\u96052\u672c\u4e0d\u540c\u7684\u4e66\u3002</li> <li>\u56fe\u4e66\u9986\u4e2d\u6240\u6709\u7684\u4e66\u90fd\u67093\u672c\u3002</li> <li>\u7528\u6237\u501f\u4e66\u6d41\u7a0b\uff1a\u5148\u8c03\u7528\u56fe\u4e66\u670d\u52a1\u4e66\u7c4d\u6570\u91cf-1 -&gt;  \u6dfb\u52a0\u501f\u9605\u8bb0\u5f55  -&gt;  \u8c03\u7528\u7528\u6237\u670d\u52a1\u7528\u6237\u53ef\u501f\u9605\u6570\u91cf-1</li> </ul> <p>\u90a3\u4e48\u9996\u5148\u6211\u4eec\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u4fee\u6539\uff0c\u8fd9\u91cc\u4e3a\u4e86\u7b80\u4fbf\uff0c\u5c31\u76f4\u63a5\u5728\u7528\u6237\u8868\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5b57\u6bb5\u7528\u4e8e\u5b58\u50a8\u7528\u6237\u80fd\u591f\u501f\u9605\u7684\u4e66\u7c4d\u6570\u91cf\uff1a</p> <p></p> <p>\u7136\u540e\u4fee\u6539\u4e66\u7c4d\u4fe1\u606f\uff0c\u4e5f\u662f\u76f4\u63a5\u6dfb\u52a0\u4e00\u4e2a\u5b57\u6bb5\u7528\u4e8e\u8bb0\u5f55\u5269\u4f59\u6570\u91cf\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u53bb\u7f16\u5199\u4e00\u4e0b\u5bf9\u5e94\u7684\u670d\u52a1\u5427\uff0c\u9996\u5148\u662f\u7528\u6237\u670d\u52a1\uff1a</p> <pre><code>@Mapper\npublic interface UserMapper {\n    @Select(\"select * from DB_USER where uid = #{uid}\")\n    User getUserById(int uid);\n\n    @Select(\"select book_count from DB_USER where uid = #{uid}\")\n    int getUserBookRemain(int uid);\n\n    @Update(\"update DB_USER set book_count = #{count} where uid = #{uid}\")\n    int updateBookCount(int uid, int count);\n}\n</code></pre> <pre><code>@Service\npublic class UserServiceImpl implements UserService {\n\n    @Resource\n    UserMapper mapper;\n\n    @Override\n    public User getUserById(int uid) {\n        return mapper.getUserById(uid);\n    }\n\n    @Override\n    public int getRemain(int uid) {\n        return mapper.getUserBookRemain(uid);\n    }\n\n    @Override\n    public boolean setRemain(int uid, int count) {\n        return mapper.updateBookCount(uid, count) &gt; 0;\n    }\n}\n</code></pre> <pre><code>@RestController\npublic class UserController {\n\n    @Resource\n    UserService service;\n\n    @RequestMapping(\"/user/{uid}\")\n    public User findUserById(@PathVariable(\"uid\") int uid){\n        return service.getUserById(uid);\n    }\n\n    @RequestMapping(\"/user/remain/{uid}\")\n    public int userRemain(@PathVariable(\"uid\") int uid){\n        return service.getRemain(uid);\n    }\n\n    @RequestMapping(\"/user/borrow/{uid}\")\n    public boolean userBorrow(@PathVariable(\"uid\") int uid){\n        int remain = service.getRemain(uid);\n        return service.setRemain(uid, remain - 1);\n    }\n}\n</code></pre> <p>\u7136\u540e\u662f\u56fe\u4e66\u670d\u52a1\uff0c\u5176\u5b9e\u8ddf\u7528\u6237\u670d\u52a1\u5dee\u4e0d\u591a\uff1a</p> <pre><code>@Mapper\npublic interface BookMapper {\n\n    @Select(\"select * from DB_BOOK where bid = #{bid}\")\n    Book getBookById(int bid);\n\n    @Select(\"select count from DB_BOOK  where bid = #{bid}\")\n    int getRemain(int bid);\n\n    @Update(\"update DB_BOOK set count = #{count}  where bid = #{bid}\")\n    int setRemain(int bid, int count);\n}\n</code></pre> <pre><code>@Service\npublic class BookServiceImpl implements BookService {\n\n    @Resource\n    BookMapper mapper;\n\n    @Override\n    public Book getBookById(int bid) {\n        return mapper.getBookById(bid);\n    }\n\n    @Override\n    public boolean setRemain(int bid, int count) {\n        return mapper.setRemain(bid, count) &gt; 0;\n    }\n\n    @Override\n    public int getRemain(int bid) {\n        return mapper.getRemain(bid);\n    }\n}\n</code></pre> <pre><code>@RestController\npublic class BookController {\n\n    @Resource\n    BookService service;\n\n    @RequestMapping(\"/book/{bid}\")\n    Book findBookById(@PathVariable(\"bid\") int bid){\n        return service.getBookById(bid);\n    }\n\n    @RequestMapping(\"/book/remain/{bid}\")\n    public int bookRemain(@PathVariable(\"bid\") int uid){\n        return service.getRemain(uid);\n    }\n\n    @RequestMapping(\"/book/borrow/{bid}\")\n    public boolean bookBorrow(@PathVariable(\"bid\") int uid){\n        int remain = service.getRemain(uid);\n        return service.setRemain(uid, remain - 1);\n    }\n}\n</code></pre> <p>\u6700\u540e\u5b8c\u5584\u6211\u4eec\u7684\u501f\u9605\u670d\u52a1\uff1a</p> <pre><code>@FeignClient(value = \"userservice\")\npublic interface UserClient {\n\n    @RequestMapping(\"/user/{uid}\")\n    User getUserById(@PathVariable(\"uid\") int uid);\n\n    @RequestMapping(\"/user/borrow/{uid}\")\n    boolean userBorrow(@PathVariable(\"uid\") int uid);\n\n    @RequestMapping(\"/user/remain/{uid}\")\n    int userRemain(@PathVariable(\"uid\") int uid);\n}\n</code></pre> <pre><code>@FeignClient(\"bookservice\")\npublic interface BookClient {\n\n    @RequestMapping(\"/book/{bid}\")\n    Book getBookById(@PathVariable(\"bid\") int bid);\n\n    @RequestMapping(\"/book/borrow/{bid}\")\n    boolean bookBorrow(@PathVariable(\"bid\") int bid);\n\n    @RequestMapping(\"/book/remain/{bid}\")\n    int bookRemain(@PathVariable(\"bid\") int bid);\n}\n</code></pre> <pre><code>@RestController\npublic class BorrowController {\n\n    @Resource\n    BorrowService service;\n\n    @RequestMapping(\"/borrow/{uid}\")\n    UserBorrowDetail findUserBorrows(@PathVariable(\"uid\") int uid){\n        return service.getUserBorrowDetailByUid(uid);\n    }\n\n    @RequestMapping(\"/borrow/take/{uid}/{bid}\")\n    JSONObject borrow(@PathVariable(\"uid\") int uid,\n                      @PathVariable(\"bid\") int bid){\n        service.doBorrow(uid, bid);\n\n        JSONObject object = new JSONObject();\n        object.put(\"code\", \"200\");\n        object.put(\"success\", false);\n        object.put(\"message\", \"\u501f\u9605\u6210\u529f\uff01\");\n        return object;\n    }\n}\n</code></pre> <pre><code>@Service\npublic class BorrowServiceImpl implements BorrowService{\n\n    @Resource\n    BorrowMapper mapper;\n\n    @Resource\n    UserClient userClient;\n\n    @Resource\n    BookClient bookClient;\n\n    @Override\n    public UserBorrowDetail getUserBorrowDetailByUid(int uid) {\n        List&lt;Borrow&gt; borrow = mapper.getBorrowsByUid(uid);\n        User user = userClient.getUserById(uid);\n        List&lt;Book&gt; bookList = borrow\n                .stream()\n                .map(b -&gt; bookClient.getBookById(b.getBid()))\n                .collect(Collectors.toList());\n        return new UserBorrowDetail(user, bookList);\n    }\n\n    @Override\n    public boolean doBorrow(int uid, int bid) {\n        //1. \u5224\u65ad\u56fe\u4e66\u548c\u7528\u6237\u662f\u5426\u90fd\u652f\u6301\u501f\u9605\n        if(bookClient.bookRemain(bid) &lt; 1)\n            throw new RuntimeException(\"\u56fe\u4e66\u6570\u91cf\u4e0d\u8db3\");\n        if(userClient.userRemain(uid) &lt; 1)\n            throw new RuntimeException(\"\u7528\u6237\u501f\u9605\u91cf\u4e0d\u8db3\");\n        //2. \u9996\u5148\u5c06\u56fe\u4e66\u7684\u6570\u91cf-1\n        if(!bookClient.bookBorrow(bid))\n            throw new RuntimeException(\"\u5728\u501f\u9605\u56fe\u4e66\u65f6\u51fa\u73b0\u9519\u8bef\uff01\");\n        //3. \u6dfb\u52a0\u501f\u9605\u4fe1\u606f\n        if(mapper.getBorrow(uid, bid) != null)\n            throw new RuntimeException(\"\u6b64\u4e66\u7c4d\u5df2\u7ecf\u88ab\u6b64\u7528\u6237\u501f\u9605\u4e86\uff01\");\n        if(mapper.addBorrow(uid, bid) &lt;= 0)\n            throw new RuntimeException(\"\u5728\u5f55\u5165\u501f\u9605\u4fe1\u606f\u65f6\u51fa\u73b0\u9519\u8bef\uff01\");\n        //4. \u7528\u6237\u53ef\u501f\u9605-1\n        if(!userClient.userBorrow(uid))\n            throw new RuntimeException(\"\u5728\u501f\u9605\u65f6\u51fa\u73b0\u9519\u8bef\uff01\");\n        //\u5b8c\u6210\n        return true;\n    }\n}\n</code></pre> <p>\u8fd9\u6837\uff0c\u53ea\u8981\u6211\u4eec\u7684\u56fe\u4e66\u501f\u9605\u8fc7\u7a0b\u4e2d\u4efb\u4f55\u4e00\u6b65\u51fa\u73b0\u95ee\u9898\uff0c\u90fd\u4f1a\u629b\u51fa\u5f02\u5e38\u3002</p> <p>\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\uff1a</p> <p></p> <p>\u518d\u6b21\u5c1d\u8bd5\u501f\u9605\uff0c\u540e\u53f0\u4f1a\u76f4\u63a5\u62a5\u9519\uff1a</p> <p></p> <p>\u629b\u51fa\u5f02\u5e38\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u95ee\u9898\uff0c\u501f\u9605\u4fe1\u606f\u6dfb\u52a0\u5931\u8d25\u4e86\uff0c\u4f46\u662f\u56fe\u4e66\u7684\u6570\u91cf\u4f9d\u7136\u88ab-1\uff0c\u4e5f\u5c31\u662f\u8bf4\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u662f\u5e0c\u671b\u4e2d\u9014\u51fa\u73b0\u5f02\u5e38\u4e4b\u540e\uff0c\u4e4b\u524d\u7684\u64cd\u4f5c\u5168\u90e8\u56de\u6eda\u7684\uff1a</p> <p></p> <p>\u800c\u8fd9\u91cc\u7531\u4e8e\u662f\u5728\u53e6\u4e00\u4e2a\u670d\u52a1\u4e2d\u8fdb\u884c\u7684\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u6240\u4ee5\u4f20\u7edf\u7684<code>@Transactional</code>\u6ce8\u89e3\u65e0\u6548\uff0c\u8fd9\u65f6\u5c31\u5f97\u501f\u52a9Seata\u63d0\u4f9b\u5206\u5e03\u5f0f\u4e8b\u52a1\u4e86\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#_14","title":"\u5206\u5e03\u5f0f\u4e8b\u52a1\u89e3\u51b3\u65b9\u6848","text":"<p>\u8981\u5f00\u59cb\u5b9e\u73b0\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u6211\u4eec\u5f97\u5148\u4ece\u7406\u8bba\u4e0a\u5f00\u59cb\u4e0b\u624b\uff0c\u6211\u4eec\u6765\u4e86\u89e3\u4e00\u4e0b\u5e38\u7528\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u89e3\u51b3\u65b9\u6848\u3002</p> <ol> <li>XA\u5206\u5e03\u5f0f\u4e8b\u52a1\u534f\u8bae - 2PC\uff08\u4e24\u9636\u6bb5\u63d0\u4ea4\u5b9e\u73b0\uff09</li> </ol> <p>\u8fd9\u91cc\u7684PC\u5b9e\u9645\u4e0a\u6307\u7684\u662fPrepare\u548cCommit\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\uff0c\u4e00\u4e2a\u662f\u51c6\u5907\u4e00\u4e2a\u662f\u63d0\u4ea4\uff0c\u6574\u4e2a\u8fc7\u7a0b\u7684\u53c2\u4e0e\u8005\u4e00\u5171\u6709\u4e24\u4e2a\u89d2\u8272\uff0c\u4e00\u4e2a\u662f\u4e8b\u52a1\u7684\u6267\u884c\u8005\uff0c\u4e00\u4e2a\u662f\u4e8b\u52a1\u7684\u534f\u8c03\u8005\uff0c\u5b9e\u9645\u4e0a\u6574\u4e2a\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u8fd0\u4f5c\u90fd\u9700\u8981\u4f9d\u9760\u534f\u8c03\u8005\u6765\u7ef4\u6301\uff1a</p> <p></p> <p>\u5728\u51c6\u5907\u548c\u63d0\u4ea4\u9636\u6bb5\uff0c\u4f1a\u8fdb\u884c\uff1a</p> <ul> <li> <p>\u51c6\u5907\u9636\u6bb5\uff1a</p> <p>\u4e00\u4e2a\u5206\u5e03\u5f0f\u4e8b\u52a1\u662f\u7531\u534f\u8c03\u8005\u6765\u5f00\u542f\u7684\uff0c\u9996\u5148\u534f\u8c03\u8005\u4f1a\u5411\u6240\u6709\u7684\u4e8b\u52a1\u6267\u884c\u8005\u53d1\u9001\u4e8b\u52a1\u5185\u5bb9\uff0c\u7b49\u5f85\u6240\u6709\u7684\u4e8b\u52a1\u6267\u884c\u8005\u7b54\u590d\u3002</p> <p>\u5404\u4e2a\u4e8b\u52a1\u6267\u884c\u8005\u5f00\u59cb\u6267\u884c\u4e8b\u52a1\u64cd\u4f5c\uff0c\u4f46\u662f\u4e0d\u8fdb\u884c\u63d0\u4ea4\uff0c\u5e76\u5c06undo\u548credo\u4fe1\u606f\u8bb0\u5f55\u5230\u4e8b\u52a1\u65e5\u5fd7\u4e2d\u3002</p> <p>\u5982\u679c\u4e8b\u52a1\u6267\u884c\u8005\u6267\u884c\u4e8b\u52a1\u6210\u529f\uff0c\u90a3\u4e48\u5c31\u544a\u8bc9\u534f\u8c03\u8005\u6210\u529fYes\uff0c\u5426\u5219\u544a\u8bc9\u534f\u8c03\u8005\u5931\u8d25No\uff0c\u4e0d\u80fd\u63d0\u4ea4\u4e8b\u52a1\u3002</p> </li> <li> <p>\u63d0\u4ea4\u9636\u6bb5\uff1a</p> <p>\u5f53\u6240\u6709\u7684\u6267\u884c\u8005\u90fd\u53cd\u9988\u5b8c\u6210\u4e4b\u540e\uff0c\u8fdb\u5165\u7b2c\u4e8c\u9636\u6bb5\u3002</p> <p>\u534f\u8c03\u8005\u4f1a\u68c0\u67e5\u5404\u4e2a\u6267\u884c\u8005\u7684\u53cd\u9988\u5185\u5bb9\uff0c\u5982\u679c\u6240\u6709\u7684\u6267\u884c\u8005\u90fd\u8fd4\u56de\u6210\u529f\uff0c\u90a3\u4e48\u5c31\u544a\u8bc9\u6240\u6709\u7684\u6267\u884c\u8005\u53ef\u4ee5\u63d0\u4ea4\u4e8b\u52a1\u4e86\uff0c\u6700\u540e\u518d\u91ca\u653e\u9501\u8d44\u6e90\u3002</p> <p>\u5982\u679c\u6709\u81f3\u5c11\u4e00\u4e2a\u6267\u884c\u8005\u8fd4\u56de\u5931\u8d25\u6216\u662f\u8d85\u65f6\uff0c\u90a3\u4e48\u5c31\u8ba9\u6240\u6709\u7684\u6267\u884c\u8005\u90fd\u56de\u6eda\uff0c\u5206\u5e03\u5f0f\u4e8b\u52a1\u6267\u884c\u5931\u8d25\u3002</p> </li> </ul> <p>\u867d\u7136\u8fd9\u79cd\u65b9\u5f0f\u770b\u8d77\u6765\u6bd4\u8f83\u7b80\u5355\uff0c\u4f46\u662f\u5b58\u5728\u4ee5\u4e0b\u51e0\u4e2a\u95ee\u9898\uff1a</p> <ul> <li>\u4e8b\u52a1\u534f\u8c03\u8005\u662f\u975e\u5e38\u6838\u5fc3\u7684\u89d2\u8272\uff0c\u4e00\u65e6\u51fa\u73b0\u95ee\u9898\uff0c\u5c06\u5bfc\u81f4\u6574\u4e2a\u5206\u5e03\u5f0f\u4e8b\u52a1\u4e0d\u80fd\u6b63\u5e38\u8fd0\u884c\u3002</li> <li> <p>\u5982\u679c\u63d0\u4ea4\u9636\u6bb5\u53d1\u751f\u7f51\u7edc\u95ee\u9898\uff0c\u5bfc\u81f4\u67d0\u4e9b\u4e8b\u52a1\u6267\u884c\u8005\u6ca1\u6709\u6536\u5230\u534f\u8c03\u8005\u53d1\u6765\u7684\u63d0\u4ea4\u547d\u4ee4\uff0c\u5c06\u5bfc\u81f4\u67d0\u4e9b\u6267\u884c\u8005\u63d0\u4ea4\u67d0\u4e9b\u6267\u884c\u8005\u6ca1\u63d0\u4ea4\uff0c\u8fd9\u6837\u80af\u5b9a\u662f\u4e0d\u884c\u7684\u3002</p> </li> <li> <p>XA\u5206\u5e03\u5f0f\u4e8b\u52a1\u534f\u8bae - 3PC\uff08\u4e09\u9636\u6bb5\u63d0\u4ea4\u5b9e\u73b0\uff09</p> </li> </ul> <p>\u4e09\u9636\u6bb5\u63d0\u4ea4\u662f\u5728\u4e8c\u9636\u6bb5\u63d0\u4ea4\u57fa\u7840\u4e0a\u7684\u6539\u8fdb\u7248\u672c\uff0c\u4e3b\u8981\u662f\u52a0\u5165\u4e86\u8d85\u65f6\u673a\u5236\uff0c\u540c\u65f6\u5728\u534f\u8c03\u8005\u548c\u6267\u884c\u8005\u4e2d\u90fd\u5f15\u5165\u4e86\u8d85\u65f6\u673a\u5236\u3002</p> <p>\u4e09\u4e2a\u9636\u6bb5\u5206\u522b\u8fdb\u884c\uff1a</p> <ul> <li> <p>CanCommit\u9636\u6bb5\uff1a</p> <p>\u534f\u8c03\u8005\u5411\u6267\u884c\u8005\u53d1\u9001CanCommit\u8bf7\u6c42\uff0c\u8be2\u95ee\u662f\u5426\u53ef\u4ee5\u6267\u884c\u4e8b\u52a1\u63d0\u4ea4\u64cd\u4f5c\uff0c\u7136\u540e\u5f00\u59cb\u7b49\u5f85\u6267\u884c\u8005\u7684\u54cd\u5e94\u3002</p> <p>\u6267\u884c\u8005\u63a5\u6536\u5230\u8bf7\u6c42\u4e4b\u540e\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u5176\u81ea\u8eab\u8ba4\u4e3a\u53ef\u4ee5\u987a\u5229\u6267\u884c\u4e8b\u52a1\uff0c\u5219\u8fd4\u56deYes\u54cd\u5e94\uff0c\u5e76\u8fdb\u5165\u9884\u5907\u72b6\u6001\uff0c\u5426\u5219\u8fd4\u56deNo</p> </li> <li> <p>PreCommit\u9636\u6bb5\uff1a</p> <p>\u534f\u8c03\u8005\u6839\u636e\u6267\u884c\u8005\u7684\u53cd\u5e94\u60c5\u51b5\u6765\u51b3\u5b9a\u662f\u5426\u53ef\u4ee5\u8fdb\u5165\u7b2c\u4e8c\u9636\u6bb5\u4e8b\u52a1\u7684PreCommit\u64cd\u4f5c\u3002</p> <p>\u5982\u679c\u6240\u6709\u7684\u6267\u884c\u8005\u90fd\u8fd4\u56deYes\uff0c\u5219\u534f\u8c03\u8005\u5411\u6240\u6709\u6267\u884c\u8005\u53d1\u9001PreCommit\u8bf7\u6c42\uff0c\u5e76\u8fdb\u5165Prepared\u9636\u6bb5\uff0c\u6267\u884c\u8005\u63a5\u6536\u5230\u8bf7\u6c42\u540e\uff0c\u4f1a\u6267\u884c\u4e8b\u52a1\u64cd\u4f5c\uff0c\u5e76\u5c06undo\u548credo\u4fe1\u606f\u8bb0\u5f55\u5230\u4e8b\u52a1\u65e5\u5fd7\u4e2d\uff0c\u5982\u679c\u6210\u529f\u6267\u884c\uff0c\u5219\u8fd4\u56de\u6210\u529f\u54cd\u5e94\u3002</p> <p>\u5982\u679c\u6240\u6709\u7684\u6267\u884c\u8005\u81f3\u5c11\u6709\u4e00\u4e2a\u8fd4\u56deNo\uff0c\u5219\u534f\u8c03\u8005\u5411\u6240\u6709\u6267\u884c\u8005\u53d1\u9001abort\u8bf7\u6c42\uff0c\u6240\u6709\u7684\u6267\u884c\u8005\u5728\u6536\u5230\u8bf7\u6c42\u6216\u662f\u8d85\u8fc7\u4e00\u6bb5\u65f6\u95f4\u6ca1\u6709\u6536\u5230\u4efb\u4f55\u8bf7\u6c42\u65f6\uff0c\u4f1a\u76f4\u63a5\u4e2d\u65ad\u4e8b\u52a1\u3002</p> </li> <li> <p>DoCommit\u9636\u6bb5\uff1a</p> <p>\u8be5\u9636\u6bb5\u8fdb\u884c\u771f\u6b63\u7684\u4e8b\u52a1\u63d0\u4ea4\u3002</p> <p>\u534f\u8c03\u8005\u63a5\u6536\u5230\u6240\u6709\u6267\u884c\u8005\u53d1\u9001\u7684\u6210\u529f\u54cd\u5e94\uff0c\u90a3\u4e48\u4ed6\u5c06\u4ecePreCommit\u72b6\u6001\u8fdb\u5165\u5230DoCommit\u72b6\u6001\uff0c\u5e76\u5411\u6240\u6709\u6267\u884c\u8005\u53d1\u9001doCommit\u8bf7\u6c42\uff0c\u6267\u884c\u8005\u63a5\u6536\u5230doCommit\u8bf7\u6c42\u4e4b\u540e\uff0c\u5f00\u59cb\u6267\u884c\u4e8b\u52a1\u63d0\u4ea4\uff0c\u5e76\u5728\u5b8c\u6210\u4e8b\u52a1\u63d0\u4ea4\u4e4b\u540e\u91ca\u653e\u6240\u6709\u4e8b\u52a1\u8d44\u6e90\uff0c\u5e76\u6700\u540e\u5411\u534f\u8c03\u8005\u53d1\u9001\u786e\u8ba4\u54cd\u5e94\uff0c\u534f\u8c03\u8005\u63a5\u6536\u5230\u6240\u6709\u6267\u884c\u8005\u7684\u786e\u8ba4\u54cd\u5e94\u4e4b\u540e\uff0c\u5b8c\u6210\u4e8b\u52a1\uff08\u5982\u679c\u56e0\u4e3a\u7f51\u7edc\u95ee\u9898\u5bfc\u81f4\u6267\u884c\u8005\u6ca1\u6709\u6536\u5230doCommit\u8bf7\u6c42\uff0c\u6267\u884c\u8005\u4f1a\u5728\u8d85\u65f6\u4e4b\u540e\u76f4\u63a5\u63d0\u4ea4\u4e8b\u52a1\uff0c\u867d\u7136\u6267\u884c\u8005\u53ea\u662f\u731c\u6d4b\u534f\u8c03\u8005\u8fd4\u56de\u7684\u662fdoCommit\u8bf7\u6c42\uff0c\u4f46\u662f\u56e0\u4e3a\u524d\u9762\u7684\u4e24\u4e2a\u6d41\u7a0b\u90fd\u6b63\u5e38\u6267\u884c\uff0c\u6240\u4ee5\u80fd\u591f\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u8ba4\u4e3a\u672c\u6b21\u4e8b\u52a1\u662f\u6210\u529f\u7684\uff0c\u56e0\u6b64\u4f1a\u76f4\u63a5\u63d0\u4ea4\uff09</p> <p>\u534f\u8c03\u8005\u6ca1\u6709\u63a5\u6536\u81f3\u5c11\u4e00\u4e2a\u6267\u884c\u8005\u53d1\u9001\u7684\u6210\u529f\u54cd\u5e94\uff08\u4e5f\u53ef\u80fd\u662f\u54cd\u5e94\u8d85\u65f6\uff09\uff0c\u90a3\u4e48\u5c31\u4f1a\u6267\u884c\u4e2d\u65ad\u4e8b\u52a1\uff0c\u534f\u8c03\u8005\u4f1a\u5411\u6240\u6709\u6267\u884c\u8005\u53d1\u9001abort\u8bf7\u6c42\uff0c\u6267\u884c\u8005\u63a5\u6536\u5230abort\u8bf7\u6c42\u4e4b\u540e\uff0c\u5229\u7528\u5176\u5728PreCommit\u9636\u6bb5\u8bb0\u5f55\u7684undo\u4fe1\u606f\u6765\u6267\u884c\u4e8b\u52a1\u7684\u56de\u6eda\u64cd\u4f5c\uff0c\u5e76\u5728\u5b8c\u6210\u56de\u6eda\u4e4b\u540e\u91ca\u653e\u6240\u6709\u7684\u4e8b\u52a1\u8d44\u6e90\uff0c\u6267\u884c\u8005\u5b8c\u6210\u4e8b\u52a1\u56de\u6eda\u4e4b\u540e\uff0c\u5411\u534f\u8c03\u8005\u53d1\u9001\u786e\u8ba4\u6d88\u606f\uff0c \u534f\u8c03\u8005\u63a5\u6536\u5230\u53c2\u4e0e\u8005\u53cd\u9988\u7684\u786e\u8ba4\u6d88\u606f\u4e4b\u540e\uff0c\u6267\u884c\u4e8b\u52a1\u7684\u4e2d\u65ad\u3002</p> </li> </ul> <p>\u76f8\u6bd4\u4e24\u9636\u6bb5\u63d0\u4ea4\uff0c\u4e09\u9636\u6bb5\u63d0\u4ea4\u7684\u4f18\u52bf\u662f\u663e\u800c\u6613\u89c1\u7684\uff0c\u5f53\u7136\u4e5f\u6709\u7f3a\u70b9\uff1a</p> <ul> <li>3PC\u57282PC\u7684\u7b2c\u4e00\u9636\u6bb5\u548c\u7b2c\u4e8c\u9636\u6bb5\u4e2d\u63d2\u5165\u4e00\u4e2a\u51c6\u5907\u9636\u6bb5\uff0c\u4fdd\u8bc1\u4e86\u5728\u6700\u540e\u63d0\u4ea4\u9636\u6bb5\u4e4b\u524d\u5404\u53c2\u4e0e\u8282\u70b9\u7684\u72b6\u6001\u662f\u4e00\u81f4\u7684\u3002</li> <li>\u4e00\u65e6\u53c2\u4e0e\u8005\u65e0\u6cd5\u53ca\u65f6\u6536\u5230\u6765\u81ea\u534f\u8c03\u8005\u7684\u4fe1\u606f\u4e4b\u540e\uff0c\u4f1a\u9ed8\u8ba4\u6267\u884cCommit\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u56e0\u4e3a\u534f\u8c03\u8005\u5355\u65b9\u9762\u7684\u6545\u969c\u5bfc\u81f4\u5168\u5c40\u51fa\u73b0\u95ee\u9898\u3002</li> <li> <p>\u4f46\u662f\u6211\u4eec\u77e5\u9053\uff0c\u5b9e\u9645\u4e0a\u8d85\u65f6\u4e4b\u540e\u7684Commit\u51b3\u7b56\u672c\u8d28\u4e0a\u5c31\u662f\u4e00\u4e2a\u8d4c\u6ce8\u7f62\u4e86\uff0c\u5982\u679c\u6b64\u65f6\u534f\u8c03\u8005\u53d1\u9001\u7684\u662fabort\u8bf7\u6c42\u4f46\u662f\u8d85\u65f6\u672a\u63a5\u6536\uff0c\u90a3\u4e48\u5c31\u4f1a\u76f4\u63a5\u5bfc\u81f4\u6570\u636e\u4e00\u81f4\u6027\u95ee\u9898\u3002</p> </li> <li> <p>TCC\uff08\u8865\u507f\u4e8b\u52a1\uff09</p> </li> </ul> <p>\u8865\u507f\u4e8b\u52a1TCC\u5c31\u662fTry\u3001Confirm\u3001Cancel\uff0c\u5b83\u5bf9\u4e1a\u52a1\u6709\u4fb5\u5165\u6027\uff0c\u4e00\u5171\u5206\u4e3a\u4e09\u4e2a\u9636\u6bb5\uff0c\u6211\u4eec\u4f9d\u6b21\u6765\u89e3\u8bfb\u4e00\u4e0b\u3002</p> <ul> <li> <p>Try\u9636\u6bb5\uff1a</p> <p>\u6bd4\u5982\u6211\u4eec\u9700\u8981\u5728\u501f\u4e66\u65f6\uff0c\u5c06\u4e66\u7c4d\u7684\u5e93\u5b58<code>-1</code>\uff0c\u5e76\u4e14\u7528\u6237\u7684\u501f\u9605\u91cf\u4e5f<code>-1</code>\uff0c\u4f46\u662f\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u9664\u4e86\u76f4\u63a5\u5bf9\u5e93\u5b58\u548c\u501f\u9605\u91cf\u8fdb\u884c\u4fee\u6539\u4e4b\u5916\uff0c\u8fd8\u9700\u8981\u5c06\u51cf\u53bb\u7684\u503c\uff0c\u5355\u72ec\u5b58\u653e\u5230\u51bb\u7ed3\u8868\u4e2d\uff0c\u4f46\u662f\u6b64\u65f6\u4e0d\u4f1a\u521b\u5efa\u501f\u9605\u4fe1\u606f\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ea\u662f\u9884\u5148\u628a\u5173\u952e\u7684\u4e1c\u897f\u7ed9\u5904\u7406\u4e86\uff0c\u9884\u7559\u4e1a\u52a1\u8d44\u6e90\u51fa\u6765\u3002</p> </li> <li> <p>Confirm\u9636\u6bb5\uff1a</p> <p>\u5982\u679cTry\u6267\u884c\u6210\u529f\u65e0\u8bef\uff0c\u90a3\u4e48\u5c31\u8fdb\u5165\u5230Confirm\u9636\u6bb5\uff0c\u63a5\u7740\u4e4b\u524d\uff0c\u6211\u4eec\u5c31\u8be5\u521b\u5efa\u501f\u9605\u4fe1\u606f\u4e86\uff0c\u53ea\u80fd\u4f7f\u7528Try\u9636\u6bb5\u9884\u7559\u7684\u4e1a\u52a1\u8d44\u6e90\uff0c\u5982\u679c\u521b\u5efa\u6210\u529f\uff0c\u90a3\u4e48\u5c31\u5bf9Try\u9636\u6bb5\u51bb\u7ed3\u7684\u503c\uff0c\u8fdb\u884c\u89e3\u51bb\uff0c\u6574\u4e2a\u6d41\u7a0b\u5c31\u5b8c\u6210\u4e86\u3002\u5f53\u7136\uff0c\u5982\u679c\u5931\u8d25\u4e86\uff0c\u90a3\u4e48\u8fdb\u5165\u5230Cancel\u9636\u6bb5\u3002</p> </li> <li> <p>Cancel\u9636\u6bb5\uff1a</p> <p>\u4e0d\u7528\u731c\u4e86\uff0c\u90a3\u80af\u5b9a\u662f\u628a\u51bb\u7ed3\u7684\u4e1c\u897f\u8fd8\u7ed9\u4eba\u5bb6\uff0c\u56e0\u4e3a\u6574\u4e2a\u501f\u9605\u64cd\u4f5c\u538b\u6839\u5c31\u6ca1\u6210\u529f\u3002\u5c31\u50cf\u4f60\u4ed8\u4e86\u6b3e\u4e70\u4e86\u4e1c\u897f\u4f46\u662f\u7f51\u7edc\u95ee\u9898\uff0c\u5bfc\u81f4\u4ea4\u6613\u5931\u8d25\uff0c\u94b1\u4e0d\u53ef\u80fd\u4e0d\u8fd8\u7ed9\u4f60\u5427\u3002</p> </li> </ul> <p>\u8ddfXA\u534f\u8bae\u76f8\u6bd4\uff0cTCC\u5c31\u6ca1\u6709\u534f\u8c03\u8005\u8fd9\u4e00\u89d2\u8272\u7684\u53c2\u4e0e\u4e86\uff0c\u800c\u662f\u81ea\u4e3b\u901a\u8fc7\u4e0a\u4e00\u9636\u6bb5\u7684\u6267\u884c\u60c5\u51b5\u6765\u786e\u4fdd\u6b63\u5e38\uff0c\u5145\u5206\u5229\u7528\u4e86\u96c6\u7fa4\u7684\u4f18\u52bf\uff0c\u6027\u80fd\u4e5f\u662f\u6709\u5f88\u5927\u7684\u63d0\u5347\u3002\u4f46\u662f\u7f3a\u70b9\u4e5f\u5f88\u660e\u663e\uff0c\u5b83\u4e0e\u4e1a\u52a1\u5177\u6709\u4e00\u5b9a\u7684\u5173\u8054\u6027\uff0c\u9700\u8981\u5f00\u53d1\u8005\u53bb\u7f16\u5199\u66f4\u591a\u7684\u8865\u507f\u4ee3\u7801\uff0c\u540c\u65f6\u5e76\u4e0d\u4e00\u5b9a\u6240\u6709\u7684\u4e1a\u52a1\u6d41\u7a0b\u90fd\u9002\u7528\u4e8e\u8fd9\u79cd\u5f62\u5f0f\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#seata_1","title":"Seata\u673a\u5236\u7b80\u4ecb","text":"<p>\u524d\u9762\u6211\u4eec\u4e86\u89e3\u4e86\u4e00\u4e9b\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u770b\u4e00\u4e0bSeata\u662f\u5982\u4f55\u8fdb\u884c\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u5904\u7406\u7684\u3002</p> <p></p> <p>\u5b98\u7f51\u7ed9\u51fa\u7684\u662f\u8fd9\u6837\u7684\u4e00\u4e2a\u67b6\u6784\u56fe\uff0c\u90a3\u4e48\u56fe\u4e2d\u7684RM\u3001TM\u3001TC\u4ee3\u8868\u7740\u4ec0\u4e48\u610f\u601d\u5462\uff1f</p> <ul> <li>RM\uff08Resource Manager\uff09\uff1a\u7528\u4e8e\u76f4\u63a5\u6267\u884c\u672c\u5730\u4e8b\u52a1\u7684\u63d0\u4ea4\u548c\u56de\u6eda\u3002</li> <li>TM\uff08Transaction Manager\uff09\uff1aTM\u662f\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u6838\u5fc3\u7ba1\u7406\u8005\u3002\u6bd4\u5982\u73b0\u5728\u6211\u4eec\u9700\u8981\u5728\u501f\u9605\u670d\u52a1\u4e2d\u5f00\u542f\u5168\u5c40\u4e8b\u52a1\uff0c\u6765\u8ba9\u5176\u81ea\u8eab\u3001\u56fe\u4e66\u670d\u52a1\u3001\u7528\u6237\u670d\u52a1\u90fd\u53c2\u4e0e\u8fdb\u6765\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u822c\u5168\u5c40\u4e8b\u52a1\u53d1\u8d77\u8005\u5c31\u662fTM\u3002</li> <li>TC\uff08Transaction Manager\uff09\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u7684Seata\u670d\u52a1\u5668\uff0c\u7528\u4e8e\u5168\u5c40\u63a7\u5236\uff0c\u6bd4\u5982\u5728XA\u6a21\u5f0f\u4e0b\u5c31\u662f\u4e00\u4e2a\u534f\u8c03\u8005\u7684\u89d2\u8272\uff0c\u800c\u4e00\u4e2a\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u542f\u52a8\u5c31\u662f\u7531TM\u5411TC\u53d1\u8d77\u8bf7\u6c42\uff0cTC\u518d\u6765\u4e0e\u5176\u4ed6\u7684RM\u8fdb\u884c\u534f\u8c03\u64cd\u4f5c\u3002</li> </ul> <p>TM\u8bf7\u6c42TC\u5f00\u542f\u4e00\u4e2a\u5168\u5c40\u4e8b\u52a1\uff0cTC\u4f1a\u751f\u6210\u4e00\u4e2aXID\u4f5c\u4e3a\u8be5\u5168\u5c40\u4e8b\u52a1\u7684\u7f16\u53f7\uff0cXID\u4f1a\u5728\u5fae\u670d\u52a1\u7684\u8c03\u7528\u94fe\u8def\u4e2d\u4f20\u64ad\uff0c\u4fdd\u8bc1\u5c06\u591a\u4e2a\u5fae\u670d\u52a1\u7684\u5b50\u4e8b\u52a1\u5173\u8054\u5728\u4e00\u8d77\uff1bRM\u8bf7\u6c42TC\u5c06\u672c\u5730\u4e8b\u52a1\u6ce8\u518c\u4e3a\u5168\u5c40\u4e8b\u52a1\u7684\u5206\u652f\u4e8b\u52a1\uff0c\u901a\u8fc7\u5168\u5c40\u4e8b\u52a1\u7684XID\u8fdb\u884c\u5173\u8054\uff1bTM\u8bf7\u6c42TC\u544a\u8bc9XID\u5bf9\u5e94\u7684\u5168\u5c40\u4e8b\u52a1\u662f\u8fdb\u884c\u63d0\u4ea4\u8fd8\u662f\u56de\u6eda\uff1bTC\u9a71\u52a8RM\u5c06XID\u5bf9\u5e94\u7684\u81ea\u5df1\u7684\u672c\u5730\u4e8b\u52a1\u8fdb\u884c\u63d0\u4ea4\u8fd8\u662f\u56de\u6eda\uff1b</p> <p>Seata\u652f\u63014\u79cd\u4e8b\u52a1\u6a21\u5f0f\uff0c\u5b98\u7f51\u6587\u6863\uff1ahttps://seata.io/zh-cn/docs/overview/what-is-seata.html</p> <ul> <li> <p>AT\uff1a\u672c\u8d28\u4e0a\u5c31\u662f2PC\u7684\u5347\u7ea7\u7248\uff0c\u5728 AT \u6a21\u5f0f\u4e0b\uff0c\u7528\u6237\u53ea\u9700\u5173\u5fc3\u81ea\u5df1\u7684 \u201c\u4e1a\u52a1SQL\u201d</p> </li> <li> <p>\u4e00\u9636\u6bb5\uff0cSeata \u4f1a\u62e6\u622a\u201c\u4e1a\u52a1 SQL\u201d\uff0c\u9996\u5148\u89e3\u6790 SQL \u8bed\u4e49\uff0c\u627e\u5230\u201c\u4e1a\u52a1 SQL\u201d\u8981\u66f4\u65b0\u7684\u4e1a\u52a1\u6570\u636e\uff0c\u5728\u4e1a\u52a1\u6570\u636e\u88ab\u66f4\u65b0\u524d\uff0c\u5c06\u5176\u4fdd\u5b58\u6210\u201cbefore image\u201d\uff0c\u7136\u540e\u6267\u884c\u201c\u4e1a\u52a1 SQL\u201d\u66f4\u65b0\u4e1a\u52a1\u6570\u636e\uff0c\u5728\u4e1a\u52a1\u6570\u636e\u66f4\u65b0\u4e4b\u540e\uff0c\u518d\u5c06\u5176\u4fdd\u5b58\u6210\u201cafter image\u201d\uff0c\u6700\u540e\u751f\u6210\u884c\u9501\u3002\u4ee5\u4e0a\u64cd\u4f5c\u5168\u90e8\u5728\u4e00\u4e2a\u6570\u636e\u5e93\u4e8b\u52a1\u5185\u5b8c\u6210\uff0c\u8fd9\u6837\u4fdd\u8bc1\u4e86\u4e00\u9636\u6bb5\u64cd\u4f5c\u7684\u539f\u5b50\u6027\u3002</p> </li> <li> <p>\u4e8c\u9636\u6bb5\u5982\u679c\u786e\u8ba4\u63d0\u4ea4\u7684\u8bdd\uff0c\u56e0\u4e3a\u201c\u4e1a\u52a1 SQL\u201d\u5728\u4e00\u9636\u6bb5\u5df2\u7ecf\u63d0\u4ea4\u81f3\u6570\u636e\u5e93\uff0c \u6240\u4ee5 Seata \u6846\u67b6\u53ea\u9700\u5c06\u4e00\u9636\u6bb5\u4fdd\u5b58\u7684\u5feb\u7167\u6570\u636e\u548c\u884c\u9501\u5220\u6389\uff0c\u5b8c\u6210\u6570\u636e\u6e05\u7406\u5373\u53ef\uff0c\u5f53\u7136\u5982\u679c\u9700\u8981\u56de\u6eda\uff0c\u90a3\u4e48\u5c31\u7528\u201cbefore image\u201d\u8fd8\u539f\u4e1a\u52a1\u6570\u636e\uff1b\u4f46\u5728\u8fd8\u539f\u524d\u8981\u9996\u5148\u8981\u6821\u9a8c\u810f\u5199\uff0c\u5bf9\u6bd4\u201c\u6570\u636e\u5e93\u5f53\u524d\u4e1a\u52a1\u6570\u636e\u201d\u548c \u201cafter image\u201d\uff0c\u5982\u679c\u4e24\u4efd\u6570\u636e\u5b8c\u5168\u4e00\u81f4\u5c31\u8bf4\u660e\u6ca1\u6709\u810f\u5199\uff0c\u53ef\u4ee5\u8fd8\u539f\u4e1a\u52a1\u6570\u636e\uff0c\u5982\u679c\u4e0d\u4e00\u81f4\u5c31\u8bf4\u660e\u6709\u810f\u5199\uff0c\u51fa\u73b0\u810f\u5199\u5c31\u9700\u8981\u8f6c\u4eba\u5de5\u5904\u7406\u3002</p> </li> <li> <p>TCC\uff1a\u548c\u6211\u4eec\u4e0a\u9762\u8bb2\u89e3\u7684\u601d\u8def\u662f\u4e00\u6837\u7684\u3002</p> </li> <li> <p>XA\uff1a\u540c\u4e0a\uff0c\u4f46\u662f\u8981\u6c42\u6570\u636e\u5e93\u672c\u8eab\u652f\u6301\u8fd9\u79cd\u6a21\u5f0f\u624d\u53ef\u4ee5\u3002</p> </li> <li> <p>Saga\uff1a\u7528\u4e8e\u5904\u7406\u957f\u4e8b\u52a1\uff0c\u6bcf\u4e2a\u6267\u884c\u8005\u9700\u8981\u5b9e\u73b0\u4e8b\u52a1\u7684\u6b63\u5411\u64cd\u4f5c\u548c\u8865\u507f\u64cd\u4f5c\uff1a</p> </li> </ul> <p></p> <p>\u90a3\u4e48\uff0c\u4ee5AT\u6a21\u5f0f\u4e3a\u4f8b\uff0c\u6211\u4eec\u7684\u7a0b\u5e8f\u5982\u4f55\u624d\u80fd\u505a\u5230\u4e0d\u5bf9\u4e1a\u52a1\u8fdb\u884c\u4fb5\u5165\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u5206\u5e03\u5f0f\u4e8b\u52a1\u5462\uff1f\u5b9e\u9645\u4e0a\uff0cSeata\u5ba2\u6237\u7aef\uff0c\u662f\u901a\u8fc7\u5bf9\u6570\u636e\u6e90\u8fdb\u884c\u4ee3\u7406\u5b9e\u73b0\u7684\uff0c\u4f7f\u7528\u7684\u662fDataSourceProxy\u7c7b\uff0c\u6240\u4ee5\u5728\u7a0b\u5e8f\u8fd9\u8fb9\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5c06\u5bf9\u5e94\u7684\u4ee3\u7406\u7c7b\u6ce8\u518c\u4e3aBean\u5373\u53ef\uff080.9\u7248\u672c\u4e4b\u540e\u652f\u6301\u81ea\u52a8\u8fdb\u884c\u4ee3\u7406\uff0c\u4e0d\u7528\u6211\u4eec\u624b\u52a8\u64cd\u4f5c\uff09</p> <p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5c31\u4ee5AT\u6a21\u5f0f\u4e3a\u4f8b\u8fdb\u884c\u8bb2\u89e3\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#file","title":"\u4f7f\u7528file\u6a21\u5f0f\u90e8\u7f72","text":"<p>Seata\u4e5f\u662f\u4ee5\u670d\u52a1\u7aef\u5f62\u5f0f\u8fdb\u884c\u90e8\u7f72\u7684\uff0c\u7136\u540e\u6bcf\u4e2a\u670d\u52a1\u90fd\u662f\u5ba2\u6237\u7aef\uff0c\u670d\u52a1\u7aef\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/seata/seata/releases/download/v1.4.2/seata-server-1.4.2.zip</p> <p>\u628a\u6e90\u7801\u4e5f\u4e0b\u8f7d\u4e00\u4e0b\uff1ahttps://github.com/seata/seata/archive/refs/heads/develop.zip</p> <p>\u4e0b\u8f7d\u5b8c\u6210\u4e4b\u540e\uff0c\u653e\u5165\u5230IDEA\u9879\u76ee\u76ee\u5f55\u4e2d\uff0c\u6dfb\u52a0\u542f\u52a8\u914d\u7f6e\uff0c\u8fd9\u91cc\u7aef\u53e3\u4f7f\u75288868\uff1a</p> <p></p> <p>Seata\u670d\u52a1\u7aef\u652f\u6301\u672c\u5730\u90e8\u7f72\u6216\u662f\u57fa\u4e8e\u6ce8\u518c\u53d1\u73b0\u4e2d\u5fc3\u90e8\u7f72\uff08\u6bd4\u5982Nacos\u3001Eureka\u7b49\uff09\uff0c\u8fd9\u91cc\u6211\u4eec\u9996\u5148\u6f14\u793a\u4e00\u4e0b\u6700\u7b80\u5355\u7684\u672c\u5730\u90e8\u7f72\uff0c\u4e0d\u9700\u8981\u5bf9Seata\u7684\u914d\u7f6e\u6587\u4ef6\u505a\u4efb\u4f55\u4fee\u6539\u3002</p> <p>Seata\u5b58\u5728\u7740\u4e8b\u52a1\u5206\u7ec4\u673a\u5236\uff1a</p> <ul> <li>\u4e8b\u52a1\u5206\u7ec4\uff1aseata\u7684\u8d44\u6e90\u903b\u8f91\uff0c\u53ef\u4ee5\u6309\u5fae\u670d\u52a1\u7684\u9700\u8981\uff0c\u5728\u5e94\u7528\u7a0b\u5e8f\uff08\u5ba2\u6237\u7aef\uff09\u5bf9\u81ea\u884c\u5b9a\u4e49\u4e8b\u52a1\u5206\u7ec4\uff0c\u6bcf\u7ec4\u53d6\u4e00\u4e2a\u540d\u5b57\u3002</li> <li>\u96c6\u7fa4\uff1aseata-server\u670d\u52a1\u7aef\u4e00\u4e2a\u6216\u591a\u4e2a\u8282\u70b9\u7ec4\u6210\u7684\u96c6\u7fa4cluster\u3002 \u5e94\u7528\u7a0b\u5e8f\uff08\u5ba2\u6237\u7aef\uff09\u4f7f\u7528\u65f6\u9700\u8981\u6307\u5b9a\u4e8b\u52a1\u903b\u8f91\u5206\u7ec4\u4e0eSeata\u670d\u52a1\u7aef\u96c6\u7fa4\uff08\u9ed8\u8ba4\u4e3adefault\uff09\u7684\u6620\u5c04\u5173\u7cfb\u3002</li> </ul> <p>\u4e3a\u5565\u8981\u8bbe\u8ba1\u6210\u901a\u8fc7\u4e8b\u52a1\u5206\u7ec4\u518d\u76f4\u63a5\u6620\u5c04\u5230\u96c6\u7fa4\uff1f\u5e72\u561b\u4e0d\u76f4\u63a5\u6307\u5b9a\u96c6\u7fa4\u5462\uff1f\u83b7\u53d6\u4e8b\u52a1\u5206\u7ec4\u5230\u6620\u5c04\u96c6\u7fa4\u7684\u914d\u7f6e\u3002\u8fd9\u6837\u8bbe\u8ba1\u540e\uff0c\u4e8b\u52a1\u5206\u7ec4\u53ef\u4ee5\u4f5c\u4e3a\u8d44\u6e90\u7684\u903b\u8f91\u9694\u79bb\u5355\u4f4d\uff0c\u51fa\u73b0\u67d0\u96c6\u7fa4\u6545\u969c\u65f6\u53ef\u4ee5\u5feb\u901ffailover\uff0c\u53ea\u5207\u6362\u5bf9\u5e94\u5206\u7ec4\uff0c\u53ef\u4ee5\u628a\u6545\u969c\u7f29\u51cf\u5230\u670d\u52a1\u7ea7\u522b\uff0c\u4f46\u524d\u63d0\u4e5f\u662f\u4f60\u6709\u8db3\u591fserver\u96c6\u7fa4\u3002</p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5c06\u6211\u4eec\u7684\u5404\u4e2a\u670d\u52a1\u4f5c\u4e3aSeate\u7684\u5ba2\u6237\u7aef\uff0c\u53ea\u9700\u8981\u5bfc\u5165\u4f9d\u8d56\u5373\u53ef\uff1a</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u7136\u540e\u6dfb\u52a0\u914d\u7f6e\uff1a</p> <pre><code>seata:\n  service:\n    vgroup-mapping:\n        # \u8fd9\u91cc\u9700\u8981\u5bf9\u4e8b\u52a1\u7ec4\u505a\u6620\u5c04\uff0c\u9ed8\u8ba4\u7684\u5206\u7ec4\u540d\u4e3a \u5e94\u7528\u540d\u79f0-seata-service-group\uff0c\u5c06\u5176\u6620\u5c04\u5230default\u96c6\u7fa4\n        # \u8fd9\u4e2a\u5f88\u5173\u952e\uff0c\u4e00\u5b9a\u8981\u914d\u7f6e\u5bf9\uff0c\u4e0d\u7136\u4f1a\u627e\u4e0d\u5230\u670d\u52a1\n      bookservice-seata-service-group: default\n    grouplist:\n      default: localhost:8868\n</code></pre> <p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u542f\u52a8\u4e86\uff0c\u4f46\u662f\u6ce8\u610f\u73b0\u5728\u53ea\u662f\u5355\u7eaf\u5730\u8fde\u63a5\u4e0a\uff0c\u5e76\u6ca1\u6709\u5f00\u542f\u4efb\u4f55\u7684\u5206\u5e03\u5f0f\u4e8b\u52a1\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u63a5\u7740\u6765\u914d\u7f6e\u5f00\u542f\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u9996\u5148\u5728\u542f\u52a8\u7c7b\u6dfb\u52a0\u6ce8\u89e3\uff0c\u6b64\u6ce8\u89e3\u4f1a\u6dfb\u52a0\u4e00\u4e2a\u540e\u7f6e\u5904\u7406\u5668\u5c06\u6570\u636e\u6e90\u5c01\u88c5\u4e3a\u652f\u6301\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u4ee3\u7406\u6570\u636e\u6e90\uff08\u867d\u7136\u5b98\u65b9\u8868\u793a\u914d\u7f6e\u6587\u4ef6\u4e2d\u5df2\u7ecf\u9ed8\u8ba4\u5f00\u542f\u4e86\u81ea\u52a8\u4ee3\u7406\uff0c\u4f46\u662fUP\u4e3b\u5b9e\u6d4b1.4.2\u7248\u672c\u4e0b\u53ea\u80fd\u6253\u6ce8\u89e3\u7684\u65b9\u5f0f\u624d\u80fd\u751f\u6548\uff09\uff1a</p> <pre><code>@EnableAutoDataSourceProxy\n@SpringBootApplication\npublic class BookApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(BookApplication.class, args);\n    }\n}\n</code></pre> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5728\u5f00\u542f\u5206\u5e03\u5f0f\u4e8b\u52a1\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0<code>@GlobalTransactional</code>\u6ce8\u89e3\uff1a</p> <pre><code>@GlobalTransactional\n@Override\npublic boolean doBorrow(int uid, int bid) {\n    //\u8fd9\u91cc\u6253\u5370\u4e00\u4e0bXID\u770b\u770b\uff0c\u5176\u4ed6\u7684\u670d\u52a1\u4e1a\u6dfb\u52a0\u8fd9\u6837\u4e00\u4e2a\u6253\u5370\uff0c\u5982\u679c\u4e00\u4f1a\u90fd\u6253\u5370\u7684\u662f\u540c\u4e00\u4e2aXID\uff0c\u8868\u793a\u4f7f\u7528\u7684\u5c31\u662f\u540c\u4e00\u4e2a\u4e8b\u52a1\n    System.out.println(RootContext.getXID());\n    if(bookClient.bookRemain(bid) &lt; 1)\n        throw new RuntimeException(\"\u56fe\u4e66\u6570\u91cf\u4e0d\u8db3\");\n    if(userClient.userRemain(uid) &lt; 1)\n        throw new RuntimeException(\"\u7528\u6237\u501f\u9605\u91cf\u4e0d\u8db3\");\n    if(!bookClient.bookBorrow(bid))\n        throw new RuntimeException(\"\u5728\u501f\u9605\u56fe\u4e66\u65f6\u51fa\u73b0\u9519\u8bef\uff01\");\n    if(mapper.getBorrow(uid, bid) != null)\n        throw new RuntimeException(\"\u6b64\u4e66\u7c4d\u5df2\u7ecf\u88ab\u6b64\u7528\u6237\u501f\u9605\u4e86\uff01\");\n    if(mapper.addBorrow(uid, bid) &lt;= 0)\n        throw new RuntimeException(\"\u5728\u5f55\u5165\u501f\u9605\u4fe1\u606f\u65f6\u51fa\u73b0\u9519\u8bef\uff01\");\n    if(!userClient.userBorrow(uid))\n        throw new RuntimeException(\"\u5728\u501f\u9605\u65f6\u51fa\u73b0\u9519\u8bef\uff01\");\n    return true;\n}\n</code></pre> <p>\u8fd8\u6ca1\u7ed3\u675f\uff0c\u6211\u4eec\u524d\u9762\u8bf4\u4e86\uff0cSeata\u4f1a\u5206\u6790\u4fee\u6539\u6570\u636e\u7684sql\uff0c\u540c\u65f6\u751f\u6210\u5bf9\u5e94\u7684\u53cd\u5411\u56de\u6edaSQL\uff0c\u8fd9\u4e2a\u56de\u6eda\u8bb0\u5f55\u4f1a\u5b58\u653e\u5728undo_log \u8868\u4e2d\u3002\u6240\u4ee5\u8981\u6c42\u6bcf\u4e00\u4e2aClient \u90fd\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684undo_log\u8868\uff08\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e2a\u670d\u52a1\u8fde\u63a5\u7684\u6570\u636e\u5e93\u90fd\u9700\u8981\u521b\u5efa\u8fd9\u6837\u4e00\u4e2a\u8868\uff0c\u8fd9\u91cc\u7531\u4e8e\u6211\u4eec\u4e09\u4e2a\u670d\u52a1\u90fd\u7528\u7684\u540c\u4e00\u4e2a\u6570\u636e\u5e93\uff0c\u6240\u4ee5\u8bf4\u5c31\u53ea\u7528\u5728\u8fd9\u4e2a\u6570\u636e\u5e93\u4e2d\u521b\u5efaundo_log\u8868\u5373\u53ef\uff09\uff0c\u8868SQL\u5b9a\u4e49\u5982\u4e0b\uff1a</p> <pre><code>CREATE TABLE `undo_log`\n(\n  `id`            BIGINT(20)   NOT NULL AUTO_INCREMENT,\n  `branch_id`     BIGINT(20)   NOT NULL,\n  `xid`           VARCHAR(100) NOT NULL,\n  `context`       VARCHAR(128) NOT NULL,\n  `rollback_info` LONGBLOB     NOT NULL,\n  `log_status`    INT(11)      NOT NULL,\n  `log_created`   DATETIME     NOT NULL,\n  `log_modified`  DATETIME     NOT NULL,\n  `ext`           VARCHAR(100) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `ux_undo_log` (`xid`, `branch_id`)\n) ENGINE = InnoDB\n  AUTO_INCREMENT = 1\n  DEFAULT CHARSET = utf8;\n</code></pre> <p>\u521b\u5efa\u5b8c\u6210\u4e4b\u540e\uff0c\u6211\u4eec\u73b0\u5728\u5c31\u53ef\u4ee5\u542f\u52a8\u4e09\u4e2a\u670d\u52a1\u4e86\uff0c\u6211\u4eec\u6765\u6d4b\u8bd5\u4e00\u4e0b\u5f53\u51fa\u73b0\u5f02\u5e38\u7684\u65f6\u5019\u662f\u4e0d\u662f\u4f1a\u6b63\u5e38\u56de\u6eda\uff1a</p> <p></p> <p></p> <p>\u9996\u5148\u7b2c\u4e00\u6b21\u80af\u5b9a\u662f\u6b63\u5e38\u5b8c\u6210\u501f\u9605\u64cd\u4f5c\u7684\uff0c\u63a5\u7740\u6211\u4eec\u518d\u6b21\u8fdb\u884c\u8bf7\u6c42\uff0c\u80af\u5b9a\u4f1a\u51fa\u73b0\u5f02\u5e38\uff1a</p> <p></p> <p></p> <p>\u5982\u679c\u80fd\u5728\u6808\u8ffd\u8e2a\u4fe1\u606f\u4e2d\u770b\u5230seata\u76f8\u5173\u7684\u5305\uff0c\u90a3\u4e48\u8bf4\u660e\u5206\u5e03\u5f0f\u4e8b\u52a1\u5df2\u7ecf\u5f00\u59cb\u5de5\u4f5c\u4e86\uff0c\u901a\u8fc7\u65e5\u5fd7\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u51fa\u73b0\u4e86\u56de\u6eda\u64cd\u4f5c\uff1a</p> <p></p> <p>\u5e76\u4e14\u6570\u636e\u5e93\u4e2d\u786e\u5b9e\u662f\u56de\u6eda\u4e86\u6263\u9664\u64cd\u4f5c\uff1a</p> <p></p> <p>\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u901a\u8fc7Seata\u7b80\u5355\u5730\u5b9e\u73b0\u4e86\u5206\u5e03\u5f0f\u4e8b\u52a1\u3002</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/SpringCloud/SpringCould%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/#nacos_1","title":"\u4f7f\u7528nacos\u6a21\u5f0f\u90e8\u7f72","text":"<p>\u524d\u9762\u6211\u4eec\u5b9e\u73b0\u4e86\u672c\u5730Seata\u670d\u52a1\u7684file\u6a21\u5f0f\u90e8\u7f72\uff0c\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u8ba9\u5176\u914d\u5408Nacos\u8fdb\u884c\u90e8\u7f72\uff0c\u5229\u7528Nacos\u7684\u914d\u7f6e\u7ba1\u7406\u548c\u670d\u52a1\u53d1\u73b0\u673a\u5236\uff0cSeata\u80fd\u591f\u66f4\u597d\u5730\u5de5\u4f5c\u3002</p> <p>\u6211\u4eec\u5148\u5355\u72ec\u4e3aSeata\u914d\u7f6e\u4e00\u4e2a\u547d\u540d\u7a7a\u95f4\uff1a</p> <p></p> <p>\u6211\u4eec\u6253\u5f00<code>conf</code>\u76ee\u5f55\u4e2d\u7684<code>registry.conf</code>\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>registry {\n    # \u6ce8\u518c\u914d\u7f6e\n    # \u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u53ef\u4ee5\u9009\u62e9\u7c7b\u578b\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u666e\u901a\u7684file\u7c7b\u578b\uff0c\u4e5f\u5c31\u662f\u672c\u5730\u6587\u4ef6\u7684\u5f62\u5f0f\u8fdb\u884c\u6ce8\u518c\u914d\u7f6e\n    # \u652f\u6301\u7684\u7c7b\u578b\u5982\u4e0b\uff0c\u5bf9\u5e94\u7684\u7c7b\u578b\u5728\u4e0b\u9762\u90fd\u6709\u5bf9\u5e94\u7684\u914d\u7f6e\n  # file \u3001nacos \u3001eureka\u3001redis\u3001zk\u3001consul\u3001etcd3\u3001sofa\n  type = \"nacos\"\n\n    # \u91c7\u7528nacos\u65b9\u5f0f\u4f1a\u5c06seata\u670d\u52a1\u7aef\u4e5f\u6ce8\u518c\u5230nacos\u4e2d\uff0c\u8fd9\u6837\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u5229\u7528\u670d\u52a1\u53d1\u73b0\u81ea\u52a8\u627e\u5230seata\u670d\u52a1\n    # \u5c31\u4e0d\u9700\u8981\u6211\u4eec\u624b\u52a8\u6307\u5b9aIP\u548c\u7aef\u53e3\u4e86\uff0c\u4e0d\u8fc7\u770b\u4f3c\u65b9\u4fbf\uff0c\u5751\u5012\u662f\u4e0d\u5c11\uff0c\u540e\u9762\u518d\u8bf4\n  nacos {\n    # \u5e94\u7528\u540d\u79f0\uff0c\u8fd9\u91cc\u9ed8\u8ba4\u5c31\u884c\n    application = \"seata-server\"\n    # Nacos\u670d\u52a1\u5668\u5730\u5740\n    serverAddr = \"localhost:8848\"\n    # \u8fd9\u91cc\u4f7f\u7528\u7684\u662fSEATA_GROUP\u7ec4\uff0c\u4e00\u4f1a\u6ce8\u518c\u5230Nacos\u4e2d\u5c31\u662f\u8fd9\u4e2a\u7ec4\n    group = \"SEATA_GROUP\"\n    # \u8fd9\u91cc\u5c31\u4f7f\u7528\u6211\u4eec\u4e0a\u9762\u5355\u72ec\u4e3aseata\u914d\u7f6e\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u6ce8\u610f\u586b\u7684\u662fID\n    namespace = \"89fc2145-4676-48b8-9edd-29e867879bcb\"\n    # \u96c6\u7fa4\u540d\u79f0\uff0c\u8fd9\u91cc\u8fd8\u662f\u4f7f\u7528default\n    cluster = \"default\"\n    # Nacos\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\n    username = \"nacos\"\n    password = \"nacos\"\n  }\n    #...\n</code></pre> <p>\u6ce8\u518c\u4fe1\u606f\u914d\u7f6e\u5b8c\u6210\u4e4b\u540e\uff0c\u63a5\u7740\u6211\u4eec\u9700\u8981\u5c06\u914d\u7f6e\u6587\u4ef6\u4e5f\u653e\u5230Nacos\u4e2d\uff0c\u8ba9Nacos\u7ba1\u7406\u914d\u7f6e\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u914d\u7f6e\u8fdb\u884c\u70ed\u66f4\u65b0\u4e86\uff0c\u4e00\u65e6\u73af\u5883\u9700\u8981\u53d8\u5316\uff0c\u53ea\u9700\u8981\u76f4\u63a5\u5728Nacos\u4e2d\u4fee\u6539\u5373\u53ef\u3002</p> <pre><code>config {\n    # \u8fd9\u91cc\u6211\u4eec\u4e5f\u4f7f\u7528nacos\n  # file\u3001nacos \u3001apollo\u3001zk\u3001consul\u3001etcd3\n  type = \"nacos\"\n\n  nacos {\n    # \u8ddf\u4e0a\u9762\u4e00\u6837\u7684\u914d\u6cd5\n    serverAddr = \"127.0.0.1:8848\"\n    namespace = \"89fc2145-4676-48b8-9edd-29e867879bcb\"\n    group = \"SEATA_GROUP\"\n    username = \"nacos\"\n    password = \"nacos\"\n    # \u8fd9\u4e2a\u4e0d\u7528\u6539\uff0c\u9ed8\u8ba4\u5c31\u884c\n    dataId = \"seataServer.properties\"\n  }\n</code></pre> <p>\u63a5\u7740\uff0c\u6211\u4eec\u9700\u8981\u5c06\u914d\u7f6e\u5bfc\u5165\u5230Nacos\u4e2d\uff0c\u6211\u4eec\u6253\u5f00\u4e00\u5f00\u59cb\u4e0b\u8f7d\u7684\u6e90\u7801<code>script/config-center/nacos</code>\u76ee\u5f55\uff0c\u8fd9\u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u4e0a\u4f20\u811a\u672c\uff0c\u6211\u4eec\u76f4\u63a5\u8fd0\u884c\u5373\u53ef\uff08windows\u4e0b\u6ca1\u5bf9\u5e94\u7684bat\u5c31\u5f88\u86cb\u75bc\uff0c\u53ef\u4ee5\u4f7f\u7528git\u547d\u4ee4\u884c\u6765\u8fd0\u884c\u4e00\u4e0b\uff09\uff0c\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528\u8fd9\u4e2a\u53ef\u4ea4\u4e92\u7684\u7248\u672c\uff1a</p> <p></p> <p>\u6309\u7167\u63d0\u793a\u8f93\u5165\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e0d\u8f93\u5165\u5c31\u4f7f\u7528\u7684\u9ed8\u8ba4\u503c\uff0c\u4e0d\u77e5\u9053\u4e3a\u5565\u6700\u65b0\u7248\u672c\u6709\u56db\u4e2a\u56e0\u4e3a\u53c2\u6570\u8fc7\u957f\u8fd8\u5bfc\u5165\u5931\u8d25\u4e86\uff0c\u5c31\u79bb\u8c31\uff0c\u4e0d\u8fc7\u4e0d\u5f71\u54cd\u3002</p> <p>\u5bfc\u5165\u6210\u529f\u4e4b\u540e\uff0c\u53ef\u4ee5\u5728\u5bf9\u5e94\u7684\u547d\u540d\u7a7a\u95f4\u4e0b\u770b\u5230\u5bf9\u5e94\u7684\u914d\u7f6e\uff08\u4e3a\u5565\u975e\u8981\u4e00\u4e2a\u4e00\u4e2a\u914d\u7f6e\u9879\u5355\u72ec\u641e\uff0c\u5c31\u4e0d\u80fd\u5199\u4e00\u8d77\u5417\uff09\uff1a</p> <p></p> <p>\u6ce8\u610f\uff0c\u8fd8\u6ca1\u5b8c\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u5c06\u5bf9\u5e94\u7684\u4e8b\u52a1\u7ec4\u6620\u5c04\u914d\u7f6e\u4e5f\u6dfb\u52a0\u4e0a\uff0cDataId\u683c\u5f0f\u4e3a<code>service.vgroupMapping.\u4e8b\u52a1\u7ec4\u540d\u79f0</code>\uff0c\u6bd4\u5982\u6211\u4eec\u5c31\u4f7f\u7528\u9ed8\u8ba4\u7684\u540d\u79f0\uff0c\u503c\u5168\u90e8\u4f9d\u7136\u4f7f\u7528default\u5373\u53ef\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u5c31\u5b8c\u6210\u4e86\u670d\u52a1\u7aef\u7684Nacos\u914d\u7f6e\uff0c\u63a5\u7740\u6211\u4eec\u9700\u8981\u5bf9\u5ba2\u6237\u7aef\u4e5f\u8fdb\u884cNacos\u914d\u7f6e\uff1a</p> <pre><code>seata:\n    # \u6ce8\u518c\n  registry:\n    # \u4f7f\u7528Nacos\n    type: nacos\n    nacos:\n        # \u4f7f\u7528Seata\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u8fd9\u6837\u624d\u80fd\u6b63\u786e\u627e\u5230Seata\u670d\u52a1\uff0c\u7531\u4e8e\u7ec4\u4f7f\u7528\u7684\u662fSEATA_GROUP\uff0c\u914d\u7f6e\u9ed8\u8ba4\u503c\u5c31\u662f\uff0c\u5c31\u4e0d\u7528\u914d\u4e86\n      namespace: 89fc2145-4676-48b8-9edd-29e867879bcb\n      username: nacos\n      password: nacos\n  # \u914d\u7f6e\n  config:\n    type: nacos\n    nacos:\n      namespace: 89fc2145-4676-48b8-9edd-29e867879bcb\n      username: nacos\n      password: nacos\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u5c31\u53ef\u4ee5\u542f\u52a8\u8fd9\u4e09\u4e2a\u670d\u52a1\u4e86\uff0c\u53ef\u4ee5\u5728Nacos\u4e2d\u770b\u5230Seata\u4ee5\u53ca\u4e09\u4e2a\u670d\u52a1\u90fd\u6b63\u5e38\u6ce8\u518c\u4e86\uff1a</p> <p></p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbf\u95ee\u4e00\u4e0b\u670d\u52a1\u8bd5\u8bd5\u770b\u4e86\uff1a</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6548\u679c\u548c\u4e0a\u9762\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u8fc7\u73b0\u5728\u6211\u4eec\u7684\u6ce8\u518c\u548c\u914d\u7f6e\u90fd\u7ee7\u627f\u5728Nacos\u4e2d\u8fdb\u884c\u4e86\u3002</p> <p>\u6211\u4eec\u8fd8\u53ef\u4ee5\u914d\u7f6e\u4e00\u4e0b\u4e8b\u52a1\u4f1a\u8bdd\u4fe1\u606f\u7684\u5b58\u50a8\u65b9\u5f0f\uff0c\u9ed8\u8ba4\u662ffile\u7c7b\u578b\uff0c\u90a3\u4e48\u5c31\u4f1a\u5728\u8fd0\u884c\u76ee\u5f55\u4e0b\u521b\u5efa<code>file_store</code>\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u642c\u5230\u6570\u636e\u5e93\u4e2d\u5b58\u50a8\uff0c\u53ea\u9700\u8981\u4fee\u6539\u4e00\u4e0b\u914d\u7f6e\u5373\u53ef\uff1a</p> <p></p> <p>\u5c06<code>store.session.mode</code>\u548c<code>store.mode</code>\u7684\u503c\u4fee\u6539\u4e3a<code>db</code></p> <p>\u63a5\u7740\u6211\u4eec\u5bf9\u6570\u636e\u5e93\u4fe1\u606f\u8fdb\u884c\u4e00\u4e0b\u914d\u7f6e\uff1a</p> <ul> <li>\u6570\u636e\u5e93\u9a71\u52a8</li> <li>\u6570\u636e\u5e93URL</li> <li>\u6570\u636e\u5e93\u7528\u6237\u540d\u5bc6\u7801</li> </ul> <p>\u5176\u4ed6\u7684\u9ed8\u8ba4\u5373\u53ef\uff1a</p> <p></p> <p>\u63a5\u7740\u6211\u4eec\u9700\u8981\u5c06\u5bf9\u5e94\u7684\u6570\u636e\u5e93\u8fdb\u884c\u521b\u5efa\uff0c\u521b\u5efaseata\u6570\u636e\u5e93\uff0c\u7136\u540e\u76f4\u63a5CV\u4ee5\u4e0b\u8bed\u53e5\uff1a</p> <pre><code>-- -------------------------------- The script used when storeMode is 'db' --------------------------------\n-- the table to store GlobalSession data\nCREATE TABLE IF NOT EXISTS `global_table`\n(\n    `xid`                       VARCHAR(128) NOT NULL,\n    `transaction_id`            BIGINT,\n    `status`                    TINYINT      NOT NULL,\n    `application_id`            VARCHAR(32),\n    `transaction_service_group` VARCHAR(32),\n    `transaction_name`          VARCHAR(128),\n    `timeout`                   INT,\n    `begin_time`                BIGINT,\n    `application_data`          VARCHAR(2000),\n    `gmt_create`                DATETIME,\n    `gmt_modified`              DATETIME,\n    PRIMARY KEY (`xid`),\n    KEY `idx_status_gmt_modified` (`status` , `gmt_modified`),\n    KEY `idx_transaction_id` (`transaction_id`)\n) ENGINE = InnoDB\n  DEFAULT CHARSET = utf8mb4;\n\n-- the table to store BranchSession data\nCREATE TABLE IF NOT EXISTS `branch_table`\n(\n    `branch_id`         BIGINT       NOT NULL,\n    `xid`               VARCHAR(128) NOT NULL,\n    `transaction_id`    BIGINT,\n    `resource_group_id` VARCHAR(32),\n    `resource_id`       VARCHAR(256),\n    `branch_type`       VARCHAR(8),\n    `status`            TINYINT,\n    `client_id`         VARCHAR(64),\n    `application_data`  VARCHAR(2000),\n    `gmt_create`        DATETIME(6),\n    `gmt_modified`      DATETIME(6),\n    PRIMARY KEY (`branch_id`),\n    KEY `idx_xid` (`xid`)\n) ENGINE = InnoDB\n  DEFAULT CHARSET = utf8mb4;\n\n-- the table to store lock data\nCREATE TABLE IF NOT EXISTS `lock_table`\n(\n    `row_key`        VARCHAR(128) NOT NULL,\n    `xid`            VARCHAR(128),\n    `transaction_id` BIGINT,\n    `branch_id`      BIGINT       NOT NULL,\n    `resource_id`    VARCHAR(256),\n    `table_name`     VARCHAR(32),\n    `pk`             VARCHAR(36),\n    `status`         TINYINT      NOT NULL DEFAULT '0' COMMENT '0:locked ,1:rollbacking',\n    `gmt_create`     DATETIME,\n    `gmt_modified`   DATETIME,\n    PRIMARY KEY (`row_key`),\n    KEY `idx_status` (`status`),\n    KEY `idx_branch_id` (`branch_id`)\n) ENGINE = InnoDB\n  DEFAULT CHARSET = utf8mb4;\n\nCREATE TABLE IF NOT EXISTS `distributed_lock`\n(\n    `lock_key`       CHAR(20) NOT NULL,\n    `lock_value`     VARCHAR(20) NOT NULL,\n    `expire`         BIGINT,\n    primary key (`lock_key`)\n) ENGINE = InnoDB\n  DEFAULT CHARSET = utf8mb4;\n\nINSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES ('HandleAllSession', ' ', 0);\n</code></pre> <p></p> <p>\u5b8c\u6210\u4e4b\u540e\uff0c\u91cd\u542fSeata\u670d\u52a1\u7aef\u5373\u53ef\uff1a</p> <p></p> <p>\u770b\u5230\u4e86\u6570\u636e\u6e90\u521d\u59cb\u5316\u6210\u529f\uff0c\u73b0\u5728\u5df2\u7ecf\u5728\u4f7f\u7528\u6570\u636e\u5e93\u8fdb\u884c\u4f1a\u8bdd\u5b58\u50a8\u4e86\u3002</p> <p>\u5982\u679cSeata\u670d\u52a1\u7aef\u51fa\u73b0\u62a5\u9519\uff0c\u53ef\u80fd\u662f\u6211\u4eec\u81ea\u5b9a\u4e49\u4e8b\u52a1\u7ec4\u7684\u540d\u79f0\u592a\u957f\u4e86\uff1a</p> <p></p> <p>\u5c06<code>globle_table</code>\u8868\u7684\u5b57\u6bb5<code>transaction_server_group</code>\u957f\u5ea6\u9002\u5f53\u589e\u52a0\u4e00\u4e0b\u5373\u53ef\uff1a</p> <p></p> <p>\u5230\u6b64\uff0c\u5173\u4e8e\u57fa\u4e8enacos\u6a21\u5f0f\u4e0b\u7684Seata\u90e8\u7f72\uff0c\u5c31\u5b8c\u6210\u4e86\u3002</p> <p>\u867d\u7136\u6211\u4eec\u8fd9\u91cc\u5b9e\u73b0\u4e86\u5206\u5e03\u5f0f\u4e8b\u52a1\uff0c\u4f46\u662f\u8fd8\u662f\u7ed9\u5404\u4f4d\u540c\u5b66\u63d0\u51fa\u4e00\u4e2a\u95ee\u9898\uff08\u53ef\u4ee5\u628a\u81ea\u5df1\u6240\u8ba4\u4e3a\u7684\u7ed3\u679c\u6253\u5728\u5f39\u5e55\u4e0a\uff09\uff0c\u5c31\u6211\u4eec\u76ee\u524d\u8fd9\u6837\u7684\u7a0b\u5e8f\u8bbe\u8ba1\uff0c\u5728\u9ad8\u5e76\u53d1\u4e0b\uff0c\u771f\u7684\u5b89\u5168\u5417\uff1f\u6bd4\u5982\u540c\u4e00\u65f6\u95f4100\u4e2a\u540c\u5b66\u62a2\u540c\u4e00\u4e2a\u4e66\uff0c\u4f46\u662f\u6211\u4eec\u77e5\u9053\u540c\u4e00\u4e2a\u4e66\u5c31\u53ea\u67093\u672c\uff0c\u5982\u679c\u8fd9\u65f6\u771f\u7684\u540c\u65f6\u6765\u4e86100\u4e2a\u8bf7\u6c42\u8981\u501f\u4e66\uff0c\u4f1a\u6b63\u5e38\u5730\u53ea\u501f\u51fa3\u672c\u4e66\u5417\uff1f\u5982\u679c\u4e0d\u6b63\u5e38\uff0c\u8be5\u5982\u4f55\u5904\u7406\uff1f</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/etcd/etcd%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/","title":"etcd\u57fa\u672c\u4f7f\u7528","text":"<p>\u542f\u52a8etcd</p> <pre><code>etcd\n</code></pre> <p>\u67e5\u770betcd\u8282\u70b9\u7684\u72b6\u6001</p> <pre><code>etcdctl endpoint status --cluster\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin%20%2B%20Gorm/","title":"Gin + Gorm","text":"<p>Gin + Gorm\u5b9e\u6218CRUD</p> <pre><code>package main  \n\nimport (  \n    \"fmt\"  \n    \"github.com/gin-gonic/gin\"\n    \"gorm.io/driver/mysql\"\n    \"gorm.io/gorm\"   \n    \"gorm.io/gorm/schema\"   \n    \"net/http\"   \n    \"time\"\n)  \n\nfunc main() {  \n   dsn := \"root:SHILIub99325@tcp(127.0.0.1:3307)/go_database?charset=utf8mb4&amp;parseTime=True&amp;loc=Local\"  \n    db, err := gorm.Open(mysql.Open(dsn), &amp;gorm.Config{  \n        Logger:logger.Default.LogMode(logger.Info), //\u8bbe\u7f6elog\u7684\u6a21\u5f0f\n        NamingStrategy: schema.NamingStrategy{  \n            SingularTable: true,  //\u8868\u540d\u4e0d\u52a0s\n        },  \n    })  \n\n    fmt.Println(\"database = \", db)  \n    fmt.Println(\"error = \", err)  \n\n    // \u8fde\u63a5\u6c60  \n    sqlDB, err := db.DB()  \n\n    // \u8bbe\u7f6e\u7a7a\u95f2\u8fde\u63a5\u6c60\u4e2d\u7684\u6700\u5927\u6570\u91cf  \n    sqlDB.SetMaxIdleConns(10)  \n    // \u8bbe\u7f6e\u6253\u5f00\u6570\u636e\u5e93\u8fde\u63a5\u7684\u6700\u5927\u6570\u91cf  \n    sqlDB.SetMaxOpenConns(100)  \n    // \u8bbe\u7f6e\u8fde\u63a5\u53ef\u590d\u7528\u7684\u6700\u5927\u65f6\u95f4  \n    sqlDB.SetConnMaxLifetime(10 * time.Second)  \n\n    // \u7ed3\u6784\u4f53  \n    type List struct {  \n        gorm.Model        //\u4e3b\u952e  \n        Name       string `gorm:\"type:varchar(20); not null\" json:\"name\" binding:\"required\"`  \n        State      string `gorm:\"type:varchar(20); not null\" json:\"state\" binding:\"required\"`  \n        Phone      string `gorm:\"type:varchar(20); not null\" json:\"phone\" binding:\"required\"`  \n        Email      string `gorm:\"type:varchar(40); not null\" json:\"email\" binding:\"required\"`  \n        Address    string `gorm:\"type:varchar(200); not null\" json:\"address\" binding:\"required\"`  \n    }  \n\n    // \u8fc1\u79fb  \n    db.AutoMigrate(&amp;List{})  \n\n    r := gin.Default()  \n    // \u6d4b\u8bd5  \n    //r.GET(\"/\", func(c *gin.Context) {  \n    //    c.IndentedJSON(http.StatusOK, gin.H{    //        \"message\": \"\u8bf7\u6c42\u6210\u529f\",  \n    //    })    //})  \n    // \u589e  \n    r.POST(\"/user/add\", func(c *gin.Context) {  \n        var data List  \n        err := c.ShouldBindJSON(&amp;data)  \n        if err != nil {  \n            c.JSON(200, gin.H{  \n                \"msg\":  \"\u6dfb\u52a0\u5931\u8d25\",  \n                \"data\": gin.H{},  \n                \"code\": \"400\",  \n            })  \n        } else {  \n            db.Create(&amp;data)  \n            c.JSON(200, gin.H{  \n                \"msg\":  \"success\",  \n                \"data\": data,  \n                \"code\": \"200\",  \n            })  \n        }  \n\n    })  \n\n    // \u5220  \n\n    r.DELETE(\"/user/delete/:id\", func(c *gin.Context) {  \n        var data []List  \n\n        id := c.Param(\"id\")  \n\n        db.Where(\"id = ?\", id).Find(&amp;data)  \n\n        if len(data) == 0 {  \n            c.JSON(http.StatusOK, gin.H{  \n                \"msg\":  \"\u672a\u67e5\u627e\u5230\u76f8\u5173\u5185\u5bb9\uff0c\u5220\u9664\u5931\u8d25\",  \n                \"code\": \"400\",  \n            })  \n        } else {  \n            db.Delete(&amp;data)  \n            c.JSON(http.StatusOK, gin.H{  \n                \"msg\":  \"\u5220\u9664\u6210\u529f\",  \n                \"code\": 200,  \n            })  \n        }  \n    })  \n\n    // \u6539  \n    r.PUT(\"/user/update/:id\", func(c *gin.Context) {  \n        var data List  \n        id := c.Param(\"id\")  \n\n        db.Select(\"id\").Where(\"id = ?\", id).Find(&amp;data)  \n        if data.ID == 0 {  \n            c.JSON(http.StatusOK, gin.H{  \n                \"msg\":  \"\u7528\u6237id\u6ca1\u6709\u627e\u5230\",  \n                \"code\": 400,  \n            })  \n        } else {  \n\n            err := c.ShouldBindJSON(&amp;data)  \n            if err != nil {  \n                c.JSON(http.StatusOK, gin.H{  \n                    \"mag\":  \"\u4fee\u6539\u5931\u8d25\",  \n                    \"code\": 400,  \n                })  \n            } else {  \n                db.Where(\"id = ?\", id).Updates(&amp;data)  \n                c.JSON(http.StatusOK, gin.H{  \n                    \"msg\":  \"\u4fee\u6539\u6210\u529f\",  \n                    \"code\": 200,  \n                })  \n            }  \n\n        }    })  \n\n    // \u67e5  \n    r.GET(\"/user/list/:name\", func(c *gin.Context) {  \n        name := c.Param(\"name\")  \n        var dataList []List  \n\n        db.Where(\"name = ?\", name).Find(&amp;dataList)  \n\n        if len(dataList) == 0 {  \n            c.JSON(http.StatusOK, gin.H{  \n                \"msg\":  \"\u672a\u67e5\u627e\u5230\u76f8\u5173\u5185\u5bb9\",  \n                \"data\": gin.H{},  \n                \"code\": 400,  \n            })  \n        } else {  \n            c.JSON(http.StatusOK, gin.H{  \n                \"msg\":  \"\u67e5\u8be2\u6210\u529f\",  \n                \"data\": dataList,  \n                \"code\": 200,  \n            })  \n        }  \n\n    })  \n    // \u5206\u9875\u67e5\u627e\n    // https://juejin.cn/post/7192053234620432441\n\n\n\n\n    r.Run(\":8080\")  \n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin-Gorm-Todo_List/","title":"Todo-List","text":"<p>\u6280\u672f\u6808 gin + gorm</p> <pre><code>Gin-Grom-TodoList/\n\u251c\u2500\u2500 api // api\n\u251c\u2500\u2500 cache\n\u251c\u2500\u2500 conf\n\u251c\u2500\u2500 middleware\n\u251c\u2500\u2500 model\n\u251c\u2500\u2500 pkg\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 err\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 utils\n\u251c\u2500\u2500 routes\n\u251c\u2500\u2500 serializer\n\u251c\u2500\u2500 service\n\u2514\u2500\u2500 test\n</code></pre> <p>\u9879\u76ee\u7ed3\u6784\u56fe  <pre><code>graph LR\n\n    \u6570\u636e\u5e93[(\u6570\u636e\u5e93)]\n\n    subgraph \u524d\u7aef\n\n        \u53d1\u9001\u6570\u636e\n        \u63a5\u6536\u6570\u636e\n    end \n\n    subgraph \u4e2d\u95f4\u4ef6:middleware\n        jwt([jwt])\n    end\n\n    subgraph \u670d\u52a1\u5c42\n        service --- user\u903b\u8f91\n        service --- task\u903b\u8f91\n        user\u903b\u8f91\n        task\u903b\u8f91 \n    end\n\n    subgraph Gin\n    router\n    api\n    \u670d\u52a1\u5c42\n    end\n\n\n\n    \u5e8f\u5217\u5316(\u5e8f\u5217\u5316:serializer)\n    \u5e8f\u5217\u5316 ---&gt; \u63a5\u6536\u6570\u636e \n\n    \u53d1\u9001\u6570\u636e ---&gt; router\n\n\n    service ---&gt;gorm\n\n    jwt -.\u751f\u6210Token.-&gt; gorm\n    gorm(gorm:model)\n\n    gorm ---&gt; \u6570\u636e\u5e93\n\n    user\u903b\u8f91 -.-&gt; jwt\n\n    service --&gt; \u5e8f\u5217\u5316\n\n\n    router --&gt; api\n\n    api  --&gt; service \n\n    style service fill:#ff6188\n\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin-Gorm-Todo_List/#_1","title":"\u52a0\u5bc6\u5bc6\u7801","text":"<pre><code>// \u9a8c\u8bc1\u5bc6\u7801  \n\nfunc (user *User) CheckPassword(password string) bool {  \n   err := bcrypt.CompareHashAndPassword([]byte(user.PasswordDigit), []byte(password))  \n   return err == nil  \n}  \n\n// \u52a0\u5bc6  \n\nfunc (user *User) SetPassword(password string) error {  \n   bytes, err := bcrypt.GenerateFromPassword([]byte(password), 12)  \n   if err != nil {  \n      return err  \n   }  \n   user.PasswordDigit = string(bytes)  \n   return nil  \n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin-Gorm-Todo_List/#jwt","title":"jwt \u5904\u7406\u903b\u8f91","text":"<ul> <li>\u7528\u6237\u4f7f\u7528\u7528\u6237\u540d\u5bc6\u7801\u6765\u8bf7\u6c42\u670d\u52a1\u5668</li> <li>\u670d\u52a1\u5668\u8fdb\u884c\u9a8c\u8bc1\u7528\u6237\u7684\u4fe1\u606f</li> <li>\u670d\u52a1\u5668\u901a\u8fc7\u9a8c\u8bc1\u53d1\u9001\u7ed9\u7528\u6237\u4e00\u4e2atoken</li> <li>\u5ba2\u6237\u7aef\u5b58\u50a8token\uff0c\u5e76\u5728\u6bcf\u6b21\u8bf7\u6c42\u65f6\u9644\u9001\u4e0a\u8fd9\u4e2atoken\u503c</li> <li>\u670d\u52a1\u7aef\u9a8c\u8bc1token\u503c\uff0c\u5e76\u8fd4\u56de\u6570\u636e</li> </ul> <p>\u8fd9\u4e2atoken\u5fc5\u987b\u8981\u5728\u6bcf\u6b21\u8bf7\u6c42\u65f6\u4f20\u9012\u7ed9\u670d\u52a1\u7aef\uff0c\u5b83\u5e94\u8be5\u4fdd\u5b58\u5728\u8bf7\u6c42\u5934\u91cc\uff0c \u53e6\u5916\uff0c\u670d\u52a1\u7aef\u8981\u652f\u6301<code>CORS(\u8de8\u6765\u6e90\u8d44\u6e90\u5171\u4eab)</code>\u7b56\u7565\uff0c\u4e00\u822c\u6211\u4eec\u5728\u670d\u52a1\u7aef\u8fd9\u4e48\u505a\u5c31\u53ef\u4ee5\u4e86<code>Access-Control-Allow-Origin: *</code>\u3002</p> <pre><code>func GenerateToken(id uint, username string, authority int) (string, error) {  \n\n   expireTime := time.Now().Add(24 * time.Hour)  // \u8fc7\u671f\u65f6\u95f4\n\n   claims := Claims{  \n      Id:        id,  \n      UserName:  username,  \n      Authority: authority,  \n      RegisteredClaims: jwt.RegisteredClaims{  \n         ExpiresAt: jwt.NewNumericDate(expireTime),  \n         Issuer:    \"todo_list\",  \n      },   \n    }  \n   tokenClaims := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)  \n   token, err := tokenClaims.SignedString(JwtSecret)  \n   return token, err  \n}  \n\n// \u9a8c\u8bc1TOKEN  \n\nfunc ParseToken(token string) (*Claims, error) {  \n   tokenClaims, err := jwt.ParseWithClaims(token, &amp;Claims{}, func(token *jwt.Token) (interface{}, error) {  \n      return JwtSecret, nil  \n   })  \n   if tokenClaims != nil {  \n      if claims, ok := tokenClaims.Claims.(*Claims); ok &amp;&amp; tokenClaims.Valid {  \n         return claims, nil  \n      }  \n   }  \n   return nil, err  \n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin/","title":"Gin","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin/#_1","title":"\u57fa\u7840","text":"<p>Gin \u793a\u4f8b1</p> <pre><code>func solveFunc(c *gin.Context) {\n\n}\n\nfunc main () {\n    r := gin.Default()\n    r.GET(\"\\info\",solveFunc)\n\n    r.Run(\":8080\")\n}\n</code></pre> <p>Gin \u793a\u4f8b2</p> <p><pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"net/http\"\n\n    \"github.com/gin-gonic/gin\"\n    \"github.com/thinkerou/favicon\"\n)\n\n// \u4e2d\u95f4\u4ef6\uff08\u62e6\u622a\u5668\uff09\uff0c\u529f\u80fd\uff1a\u9884\u5904\u7406\uff0c\u767b\u5f55\u6388\u6743\u3001\u9a8c\u8bc1\u3001\u5206\u9875\u3001\u8017\u65f6\u7edf\u8ba1...\n// func myHandler() gin.HandlerFunc {\n//  return func(ctx *gin.Context) {\n//      // \u901a\u8fc7\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\uff0c\u8bbe\u7f6e\u7684\u503c\uff0c\u5728\u540e\u7eed\u5904\u7406\u53ea\u8981\u8c03\u7528\u4e86\u8fd9\u4e2a\u4e2d\u95f4\u4ef6\u7684\u90fd\u53ef\u4ee5\u62ff\u5230\u8fd9\u91cc\u7684\u53c2\u6570\n//      ctx.Set(\"usersesion\", \"userid-1\")\n//      ctx.Next()  // \u653e\u884c\n//      ctx.Abort() // \u963b\u6b62\n//  }\n// }\n\nfunc main() {\n    // \u521b\u5efa\u4e00\u4e2a\u670d\u52a1\n    ginServer := gin.Default()\n    ginServer.Use(favicon.New(\"./Arctime.ico\")) // \u8fd9\u91cc\u5982\u679c\u6dfb\u52a0\u4e86\u4e1c\u897f\u7136\u540e\u518d\u8fd0\u884c\u6ca1\u6709\u53d8\u5316\uff0c\u8bf7\u91cd\u542f\u6d4f\u89c8\u5668\uff0c\u6d4f\u89c8\u5668\u6709\u7f13\u5b58\n\n    // \u52a0\u8f7d\u9759\u6001\u9875\u9762\n    ginServer.LoadHTMLGlob(\"templates/*\") // \u4e00\u79cd\u662f\u5168\u5c40\u52a0\u8f7d\uff0c\u4e00\u79cd\u662f\u52a0\u8f7d\u6307\u5b9a\u7684\u6587\u4ef6\n\n    // \u52a0\u8f7d\u8d44\u6e90\u6587\u4ef6\n    ginServer.Static(\"/static\", \"./static\")\n\n    // \u76f8\u5e94\u4e00\u4e2a\u9875\u9762\u7ed9\u524d\u7aef\n\n    ginServer.GET(\"/index\", func(ctx *gin.Context) {\n        ctx.HTML(http.StatusOK, \"index.html\", gin.H{\n            \"msg\": \"This data is come from Go background.\",\n        })\n    })\n\n    // \u80fd\u52a0\u8f7d\u9759\u6001\u9875\u9762\u4e5f\u53ef\u4ee5\u52a0\u8f7d\u6d4b\u8bd5\u6587\u4ef6\n\n    // \u83b7\u53d6\u8bf7\u6c42\u4e2d\u7684\u53c2\u6570\n\n    // \u4f20\u7edf\u65b9\u5f0f\uff1ausl?userid=xxx&amp;username=conqueror712\n    // Restful\u65b9\u5f0f\uff1a/user/info/1/conqueror712\n\n    // \u4e0b\u9762\u662f\u4f20\u7edf\u65b9\u5f0f\u7684\u4f8b\u5b50\n    ginServer.GET(\"/user/info\", func(context *gin.Context) { // \u8fd9\u4e2a\u683c\u5f0f\u662f\u56fa\u5b9a\u7684\n        userid := context.Query(\"userid\")\n        username := context.Query(\"username\")\n        // \u62ff\u5230\u4e4b\u540e\u8fd4\u56de\u7ed9\u524d\u7aef\n        context.JSON(http.StatusOK, gin.H{\n            \"userid\":   userid,\n            \"username\": username,\n        })\n    })\n    // \u6b64\u65f6\u6267\u884c\u4ee3\u7801\u4e4b\u540e\uff0c\u5728\u6d4f\u89c8\u5668\u4e2d\u53ef\u4ee5\u8f93\u5165http://localhost:8081/user/info?userid=111&amp;username=666\n    // \u5c31\u53ef\u4ee5\u770b\u5230\u8fd4\u56de\u4e86JSON\u683c\u5f0f\u7684\u6570\u636e\n\n    // \u4e0b\u9762\u662fRestful\u65b9\u5f0f\u7684\u4f8b\u5b50\n    ginServer.GET(\"/user/info/:userid/:username\", func(context *gin.Context) {\n        userid := context.Param(\"userid\")\n        username := context.Param(\"username\")\n        // \u8fd8\u662f\u4e00\u6837\uff0c\u8fd4\u56de\u7ed9\u524d\u7aef\n        context.JSON(http.StatusOK, gin.H{\n            \"userid\":   userid,\n            \"username\": username,\n        })\n    })\n    // \u6307\u5b9a\u4ee3\u7801\u540e\uff0c\u53ea\u9700\u8981\u5728\u6d4f\u89c8\u5668\u4e2dhttp://localhost:8081/user/info/111/555\n    // \u5c31\u53ef\u4ee5\u770b\u5230\u8fd4\u56de\u4e86JSON\u6570\u636e\u4e86\uff0c\u975e\u5e38\u65b9\u4fbf\u7b80\u6d01\n\n    // \u5e8f\u5217\u5316\n    // \u524d\u7aef\u7ed9\u540e\u7aef\u4f20\u9012JSON\n    ginServer.POST(\"/json\", func(ctx *gin.Context) {\n        // request.body\n        data, _ := ctx.GetRawData()\n        var m map[string]interface{} // Go\u8bed\u8a00\u4e2dobject\u4e00\u822c\u7528\u7a7a\u63a5\u53e3\u6765\u8868\u793a\uff0c\u53ef\u4ee5\u63a5\u6536anything\n        // \u987a\u5e26\u4e00\u63d0\uff0c1.18\u4ee5\u4e0a\uff0cinterface\u53ef\u4ee5\u76f4\u63a5\u6539\u6210any\n        _ = json.Unmarshal(data, &amp;m)\n        ctx.JSON(http.StatusOK, m)\n    })\n    // \u7528apipost\u6216\u8005postman\u5199\u4e00\u6bb5json\u4f20\u5230localhost:8081/json\u91cc\u5c31\u53ef\u4ee5\u4e86\n    /*\n        json\u793a\u4f8b\uff1a\n        {\n            \"name\": \"Conqueror712\",\n            \"age\": 666,\n            \"address\": \"Mars\"\n        }\n    */\n    // \u770b\u5230\u540e\u7aef\u7684\u5b9e\u65f6\u54cd\u5e94\u91cc\u9762\u63a5\u6536\u5230\u6570\u636e\u5c31\u53ef\u4ee5\u4e86\n\n    // \u5904\u7406\u8868\u5355\u8bf7\u6c42 \u8fd9\u4e9b\u90fd\u662f\u652f\u6301\u51fd\u6570\u5f0f\u7f16\u7a0b\uff0cGo\u8bed\u8a00\u7279\u6027\uff0c\u53ef\u4ee5\u628a\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\u4f20\u8fdb\u6765\n    ginServer.POST(\"/user/add\", func(ctx *gin.Context) {\n        username := ctx.PostForm(\"username\")\n        password := ctx.PostForm(\"password\")\n        ctx.JSON(http.StatusOK, gin.H{\n            \"msg\":      \"ok\",\n            \"username\": username,\n            \"password\": password,\n        })\n    })\n\n    // \u8def\u7531\n    ginServer.GET(\"/test\", func(ctx *gin.Context) {\n        // \u91cd\u5b9a\u5411 -&gt; 301\n        ctx.Redirect(301, \"https://conqueror712.gitee.io/conqueror712.gitee.io/\")\n    })\n    // http://localhost:8081/test\n\n    // 404\n    ginServer.NoRoute(func(ctx *gin.Context) {\n        ctx.HTML(404, \"404.html\", nil)\n    })\n\n    // \u8def\u7531\u7ec4\u6682\u7565\n\n    // \u670d\u52a1\u5668\u7aef\u53e3\uff0c\u7528\u670d\u52a1\u5668\u7aef\u53e3\u6765\u8bbf\u95ee\u5730\u5740\n    ginServer.Run(\":8081\") // \u4e0d\u5199\u7684\u8bdd\u9ed8\u8ba4\u662f8080\uff0c\u4e5f\u53ef\u4ee5\u66f4\u6539\n}\n</code></pre> Gin\u6837\u4f8b</p> <p>API\u7528\u6cd5\u793a\u4f8b\uff1a<code>https://gin-gonic.com/zh-cn/docs/examples/</code></p> <p><code>gin.Context</code>\u662fgin\u6700\u91cd\u8981\u7684\u4e00\u90e8\u5206\uff0c\u5b83\u80fd\u4f20\u9012request\u4fe1\u606f\u3001\u9a8c\u8bc1\u548c\u5e8f\u5217\u5316JSON....</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin/#restful","title":"\u5b9e\u73b0RESTful\u5f62\u5f0f","text":"<pre><code>// declaration of album  \ntype album struct {  \n    ID     string  `json:\"id\"`  \n    Title  string  `json:\"title\"`  \n    Artist string  `json:\"artist\"`  \n    Price  float64 `json:\"price\"`  \n}  \n\n// albums slice to seed record album data.\nvar albums = []album {  \n    {ID: \"1\", Title: \"Blue Train\", Artist: \"John Coltrane\", Price: 56.99},  \n    {ID: \"2\", Title: \"Jeru\", Artist: \"Gerry Mulligan\", Price: 17.99},  \n    {ID: \"3\", Title: \"Sarah Vaughan and Clifford Brown\", Artist: \"Sarah Vaughan\", Price: 39.99},  \n}  \n\nfunc getAlbums(c *gin.Context) {  \n    c.IndentedJSON(http.StatusOK, albums)  \n}  \n\nfunc postAlbums(c *gin.Context) {  \n    var newAlbum album  \n    // \u7ed1\u5b9aJSON  \n    if err := c.BindJSON(&amp;newAlbum); err != nil {  \n        fmt.Println(\"BindJSON error\", err)  \n    }  \n\n    albums = append(albums, newAlbum)  \n    c.IndentedJSON(http.StatusCreated, newAlbum)  \n\n}  \n\nfunc getAlbumByID(c *gin.Context) {  \n    id := c.Param(\"id\")  \n\n    for _, a := range albums {  \n        if a.ID == id {  \n            c.IndentedJSON(http.StatusOK, a)  \n            return  \n        }  \n    }    c.IndentedJSON(http.StatusNotFound, gin.H{\"message\": \"album not found\"})  \n}  \n\nfunc main() {  \n    router := gin.Default()  \n    router.GET(\"/albums\", getAlbums)  \n    router.GET(\"/albums/:id\", getAlbumByID)  \n    router.POST(\"/albums\", postAlbums)  \n\n    router.Run(\"localhost:8080\")  \n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin/#gorm","title":"\u4e0eGorm\u5171\u540c\u4f7f\u7528","text":"<p>Gorm\u6837\u4f8b Gin + Gorm</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin/#other","title":"other","text":"<p><code>BindJSON()</code> \u548c <code>shouldBindJSON()</code> \u533a\u522b</p> <p><code>BindJSON()</code> \u662f <code>c.MustBindWith(obj, binding.JSON)</code> \u7684\u7b80\u5199 <code>shouldBindJSON()</code> \u662f <code>c.ShouldBindWith(obj, binding.JSON)</code> \u7684\u7b80\u5199</p> <p><code>BindJSON()</code> \u4f1a\u5728header\u4e2d\u5199\u4e00\u4e2a400\u7684\u72b6\u6001\u7801\uff0c\u800c<code>shouldBindJSON()</code>\u4e0d\u4f1a</p> <p>\u53c2\u8003: Gin + Gorm\u5b9e\u6218CRUD\u4e28\u5b66\u4e60\u8bb0\u5f55 - \u6398\u91d1 (juejin.cn)</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gin%E6%A0%B7%E4%BE%8B/","title":"Gin\u6837\u4f8b","text":"<pre><code>package main  \n\nimport (  \n   \"net/http\"  \n\n   \"github.com/gin-gonic/gin\")  \n\nvar db = make(map[string]string)  \n\nfunc setupRouter() *gin.Engine {  \n   // Disable Console Color  \n   // gin.DisableConsoleColor()   r := gin.Default()  \n\n   // Ping test  \n   r.GET(\"/ping\", func(c *gin.Context) {  \n      c.String(http.StatusOK, \"pong\")  \n   })  \n   // Get user value  \n   r.GET(\"/user/:name\", func(c *gin.Context) {  \n      user := c.Params.ByName(\"name\")  \n      value, ok := db[user]  \n      if ok {  \n         c.JSON(http.StatusOK, gin.H{\"user\": user, \"value\": value})  \n      } else {  \n         c.JSON(http.StatusOK, gin.H{\"user\": user, \"status\": \"no value\"})  \n      }   })  \n   // Authorized group (uses gin.BasicAuth() middleware)  \n   // Same than:   // authorized := r.Group(\"/\")   // authorized.Use(gin.BasicAuth(gin.Credentials{   //   \"foo\":  \"bar\",   //   \"manu\": \"123\",   //}))   authorized := r.Group(\"/\", gin.BasicAuth(gin.Accounts{  \n      \"foo\":  \"bar\", // user:foo password:bar  \n      \"manu\": \"123\", // user:manu password:123  \n   }))  \n\n   /* example curl for /admin with basicauth header  \n      Zm9vOmJhcg== is base64(\"foo:bar\")  \n      curl -X POST \\      http://localhost:8080/admin \\      -H 'authorization: Basic Zm9vOmJhcg==' \\      -H 'content-type: application/json' \\      -d '{\"value\":\"bar\"}'   */   \n\n      authorized.POST(\"admin\", func(c *gin.Context) {  \n      user := c.MustGet(gin.AuthUserKey).(string)  \n\n      // Parse JSON  \n      var json struct {  \n         Value string `json:\"value\" binding:\"required\"`  \n      }  \n\n      if c.Bind(&amp;json) == nil {  \n         db[user] = json.Value  \n         c.JSON(http.StatusOK, gin.H{\"status\": \"ok\"})  \n      }   })  \n   return r  \n}  \n\nfunc main() {  \n   r := setupRouter()  \n   // Listen and Server in 0.0.0.0:8080  \n   r.Run(\":8080\")  \n}\n</code></pre> <pre><code>package main\n\nimport \"github.com/gin-gonic/gin\"\n\nfunc main() {\n    r := gin.Default()\n    r.GET(\"/ping\", func(c *gin.Context) {\n        c.JSON(200, gin.H{\n            \"message\": \"pong\",\n        })\n    })\n    r.Run() // \u76d1\u542c\u5e76\u5728 0.0.0.0:8080 \u4e0a\u542f\u52a8\u670d\u52a1\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/Gorm%E6%A0%B7%E4%BE%8B/","title":"Gorm\u6837\u4f8b","text":"<p>\u57fa\u7840 <pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"strconv\"\n\n    \"gorm.io/driver/mysql\"\n    \"gorm.io/gorm\"\n)\n\ntype People struct {\n    Name string\n    Age  uint\n}\n\n// \u5b9e\u73b0\u63a5\u53e3 \u5b9a\u4e49\u8868\u540d\nfunc (p People) TableName() string {\n    return \"ppp\"\n}\n\nfunc main() {\n\n    dsn := \"root:SHILIub99325@tcp(127.0.0.1:3307)/go_database?charset=utf8mb4&amp;parseTime=True&amp;loc=Local\"\n    db, err := gorm.Open(mysql.Open(dsn),&amp;gorm.Config{\n        Logger:logger.Default.LogMode(logger.Info), //\u8bbe\u7f6elog\u7684\u6a21\u5f0f\n        })\n\n    if err != nil {\n        fmt.Println(\"failed to connect database.\")\n    }\n\n    //  \u8fc1\u79fb schema | \u5982\u679c\u6ca1\u6709\u8868\u4f1a\u81ea\u52a8\u521b\u5efa\n    db.AutoMigrate(&amp;People{}) \n\n    var peoples []People\n\n    db.Create(&amp;People{Name: \"\u5c0f\u660e\", Age: 12890}) //\u63d2\u5165\n    for i := 0; i &lt; 5; i++ {\n        name := strconv.Itoa(i)\n        rand.Seed(int64(i))\n        age := rand.Intn(100)\n        peoples = append(peoples, People{Name: name, Age: uint(age)})\n    }\n\n    db.Create(peoples) //\u5207\u7247\n\n    var people People\n    db.First(&amp;people, 1)\n\n    fmt.Printf(\"%v\\n\", people) // \u6839\u636e\u6574\u578b\u4e3b\u952e\u67e5\u627e\n\n}\n</code></pre></p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/%E4%B8%8A%E4%BC%A0%E3%80%81%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/","title":"\u4e0a\u4f20\u3001\u4e0b\u8f7d\u6587\u4ef6","text":"<p>https://gin-gonic.com/zh-cn/docs/examples/upload-file/</p>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/%E4%B8%8A%E4%BC%A0%E3%80%81%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_2","title":"\u4e0a\u4f20\u6587\u4ef6","text":"<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/gin-gonic/gin\"\n\n)\n\nfunc main() {\n    r := gin.Default()\n    // \u4e3a multipart forms \u8bbe\u7f6e\u8f83\u4f4e\u7684\u5185\u5b58\u9650\u5236 (\u9ed8\u8ba4\u662f 32 MiB)\n    r.MaxMultipartMemory = 8 &lt;&lt; 20 // 8 MiB\n    r.POST(\"/upload\",func(c *gin.Context)  {\n        // \u5355\u6587\u4ef6\n        file,_ := c.FormFile(\"file\")\n        log.Println(file.Filename)\n\n        dst := \"./\" + file.Filename\n\n        // \u4fdd\u5b58\u6587\u4ef6\n        c.SaveUploadedFile(file,dst)\n\n        c.JSON(200,gin.H{\n            \"msg\":file,\n        })\n\n    })\n\n    r.Run(\":8080\")\n}\n</code></pre>"},{"location":"Web%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/gin/%E4%B8%8A%E4%BC%A0%E3%80%81%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/#_3","title":"\u4e0b\u8f7d\u6587\u4ef6","text":""},{"location":"Web%E5%BC%80%E5%8F%91/%E6%95%B0%E6%8D%AE%E5%BA%93/build%20a%20simple%20database/","title":"build a simple database","text":""},{"location":"%E5%85%B6%E4%BB%96/CMU15445/CMU-15-445-spring2023%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/","title":"CMU15445\u901a\u5173\u8bb0\u5f55","text":"<p>tip\uff1a \u5c06 <code>build/compilr_commands.json</code> \u653e\uff08\u94fe\u63a5\uff09\u5728\u6839\u76ee\u5f55\uff0cvscode\u7684\u63d2\u4ef6clangd\u53ef\u4ee5\u5bf9\u9879\u76ee\u8fdb\u884c\u5206\u6790\u7d22\u5f15\uff0c\u5c31\u6709\u8865\u5168\u3001\u63d0\u793a\u4e86</p>"},{"location":"%E5%85%B6%E4%BB%96/CMU15445/CMU-15-445-spring2023%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/#p0","title":"p0","text":"<p>\u9879\u76ee\u7ed3\u6784</p> <pre><code>.\n|-- CMakeLists.txt\n|-- Dockerfile\n|-- LICENSE\n|-- README.md\n|-- Vagrantfile\n|-- build\n|-- logo\n|-- src\n|-- test\n|-- third_party\n`-- tools\n\n\nsrc\n|-- CMakeLists.txt\n|-- binder\n|-- buffer\n|-- catalog\n|-- common\n|-- concurrency\n|-- container\n|-- execution\n|-- include\n|-- optimizer\n|-- planner\n|-- primer\n|-- recovery\n|-- storage\n`-- type\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/CMU15445/CMU-15-445-spring2023%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/#p1","title":"p1","text":"<p>LRU-K \u7b97\u6cd5</p>"},{"location":"%E5%85%B6%E4%BB%96/CMU15445/CMU-15-445-spring2023%E9%80%9A%E5%85%B3%E8%AE%B0%E5%BD%95/#p2","title":"p2","text":""},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/","title":"\u7a0b\u5e8f\u7684\u673a\u5668\u7ea7\u8868\u793a","text":"<ul> <li>\u7a0b\u5e8f\u8ba1\u6570\u5668 - PC</li> <li>\u6574\u6570\u5bc4\u5b58\u5668</li> <li>\u6761\u4ef6\u7801\u5bc4\u5b58\u5668</li> <li>\u4e00\u7ec4\u5411\u91cf\u5bc4\u5b58\u5668</li> </ul>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_2","title":"\u6c47\u7f16\u6307\u4ee4","text":"<p>\u6b64\u5904\u5bc4\u5b58\u5668\u8ba8\u8bba\u7684\u90fd\u662f\u6574\u6570</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_3","title":"\u5927\u5c0f","text":"<p>movb \u4f20\u9001\u5b57\u8282  movw \u4f20\u9001\u5b57 movl \u4f20\u9001\u53cc\u5b57 movq \u4f20\u9001\u56db\u5b57</p> <p></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_4","title":"\u8bbf\u95ee","text":"<p>\u5f53\u8fd9\u4e9b\u6307\u4ee4\u4ee5\u5bc4\u5b58\u5668\u4f5c\u4e3a\u76ee\u6807\u65f6\uff0c\u5bf9\u4e8e\u751f\u6210\u5c0f\u4e8e 8 \u5b57\u8282\u7ed3\u679c\u7684\u6307\u4ee4\uff0c\u5bc4\u5b58\u5668\u4e2d\u5269\u4e0b\u7684\u5b57\u8282\u4f1a\u600e\u4e48\u6837\uff0c\u5bf9\u6b64\u6709\u4e24\u6761\u89c4\u5219\uff1a - \u751f\u6210 1 \u5b57\u8282\u548c 2 \u5b57\u8282\u6570\u5b57\u7684\u6307\u4ee4\u4f1a\u4fdd\u6301\u5269\u4e0b\u7684==\u5b57\u8282\u4e0d\u53d8==\uff1b - \u751f\u6210 4 \u5b57\u8282\u6570\u5b57\u7684\u6307\u4ee4\u4f1a\u628a==\u9ad8\u4f4d 4 \u4e2a\u5b57\u8282\u7f6e\u4e3a 0==\u3002</p> <p>\u5927\u591a\u6570\u6307\u4ee4\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u64cd\u4f5c\u6570\uff0c\u64cd\u4f5c\u6570\u7684\u7c7b\u578b\u6709\uff1a 1. \u7acb\u5373\u6570 \uff08\u5e38\u6570\u503c\uff09     -  \u7acb\u5373\u6570\u7684\u4e66\u5199\u65b9\u5f0f\u4e3a\uff1a$ + num \u5982\uff1a\\(-577\u3001\\)0x1f 2. \u5bc4\u5b58\u5668  \uff08\u5bc4\u5b58\u5668\u4e2d\u7684\u5185\u5bb9\uff09 3. \u5185\u5b58\u5f15\u7528 \uff08\u6839\u636e\u8ba1\u7b97\u51fa\u6765\u7684\u5730\u5740\u8bbf\u95ee\u5185\u5b58\u4f4d\u7f6e\uff09</p> <p>\u6709\u591a\u79cd\u5bfb\u5740\u6a21\u5f0f\uff0c\u5176\u4e2d\\(Imm(r_b, r_i, s)\\) \u8868\u793a\u7684\u662f\u6700\u4e3a\u5e38\u7528\u7684\u6a21\u5f0f\u3002</p> <p>\u8fd9\u6837\u7684\u5f15\u7528\u5206\u4e3a4\u4e2a\u90e8\u5206\uff1a \u7acb\u5373\u6570\u504f\u79fb\\(Imm\\)\uff0c\u4e00\u4e2a\u57fa\u5740\u5bc4\u5b58\u5668\\(r_b\\)\uff0c\u4e00\u4e2a\u53d8\u5740\u5bc4\u5b58\u5668\\(r_i\\)\u548c\u4e00\u4e2a\u6bd4\u4f8b\u56e0\u5b50\\(s\\)\uff0c\u8fd9\u91cc\\(s\\)\u5fc5\u987b\u662f1\u30012\u30014\u6216\u80058\u3002 \u57fa\u5740\u548c\u53d8\u5740\u5bc4\u5b58\u5668\u90fd\u5fc5\u987b\u662f 64 \u4f4d\u5bc4\u5b58\u5668\u3002 \u6709\u6548\u5730\u5740\u88ab\u8ba1\u7b97\u4e3a\\(Imm+R[r_b]+R[r_i]+s\\)\u3002\u5176\u4ed6\u5f62\u5f0f\u90fd\u662f\u8be5\u901a\u7528\u5f62\u5f0f\u7684\u7279\u6b8a\u60c5\u51b5\u3002</p> <p></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_5","title":"\u6570\u636e\u4f20\u9001\u6307\u4ee4","text":"<p>movabsq \u5904\u740664\u4f4d\u6570\u636e \u5e76\u4e14\u53ea\u80fd\u4ee5\u5bc4\u5b58\u5668\u4f5c\u4e3a\u76ee\u7684</p> <p>MOV  S, D \u6548\u679c: D &lt;-- S</p> <p></p> <p>MOVZ \u4f1a\u5c06\u76ee\u7684\u4e2d\u7684\u5269\u4f59\u5b57\u8282\u586b\u5145\u4e3a0 MOVS \u4f1a\u901a\u8fc7\u7b26\u53f7\u4f4d\u62d3\u5c55\u6765\u586b\u5145\u3002\u5c06\u6e90\u64cd\u4f5c\u7684\u6700\u9ad8\u4f4d\u8fdb\u884c\u590d\u5236</p> <p></p> <p></p> <p>example: mov (%rdi), %rax (%rdi) \u8bbf\u95ee\u5bc4\u5b58\u5668\u6240\u6307\u5411\u7684\u7a7a\u95f4 %rdi    \u8bbf\u95ee\u5bc4\u5b58\u5668</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_6","title":"\u6808\u64cd\u4f5c","text":"<p>\u6808\u7684\u64cd\u4f5c\uff1a <pre><code>pushq S\npopq  D\n</code></pre> \u6808\u6307\u9488 %rsp \u4fdd\u5b58\u7740\u6808\u9876\u5143\u7d20\u7684\u5730\u5740</p> <p>\u56e0\u6b64<code>pushq %rbq</code> \u7b49\u4ef7\u4e8e <pre><code>subq $8, %rsp\nmovq %rbq,(%rsp)\n</code></pre> \u533a\u522b\u662f pushq \u6307\u4ee4\u7f16\u7801\u4e3a1\u4e2a\u5b57\u8282\uff0c\u800c\u8fd9\u4e24\u884c\u6307\u4ee4\u4e00\u5171\u9700\u89818\u5b57\u8282</p> <p></p> <p><code>popq %rax</code>\u7b49\u4ef7\u4e8e <pre><code>movq (%rsp),%rax\naddq $8, %rsp\n</code></pre></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_7","title":"\u7b97\u6570\u548c\u903b\u8f91\u64cd\u4f5c","text":"<p>\u8fd9\u4e9b\u64cd\u4f5c\u5206\u4e3a\u56db\u7ec4\uff1a\u52a0\u8f7d\u6709\u6548\u5730\u5740\u3001\u4e00\u5143\u64cd\u4f5c\u3001\u4e8c\u5143\u64cd\u4f5c\u548c\u79fb\u4f4d\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_8","title":"\u52a0\u8f7d\u6709\u6548\u5730\u5740","text":"<p>leaq \u5b9e\u9645\u4e0a\u662fmovq\u7684\u53d8\u5f62\uff0c\u6307\u4ee4\u5f62\u5f0f\u662f\u4ece\u5185\u5b58\u8bfb\u6570\u636e\u5230\u5bc4\u5b58\u5668</p> <p>(xxx\uff0cxxx)\u5e76\u975e\u53d6\u5730\u5740 \u8be5\u6307\u4ee4\u5e76\u4e0d\u662f\u4ece\u6307\u5b9a\u7684\u4f4d\u7f6e\u8bfb\u5165\u6570\u636e\uff0c\u800c\u662f\u5c06==\u6709\u6548\u5730\u5740==\u5199\u4eba\u5230\u76ee\u7684\u64cd\u4f5c\u6570\u3002</p> <p>\u5982\u679c\u5bc4\u5b58\u5668%rdx\u7684\u503c\u4e3ax\uff0c\u90a3\u4e48\u6307\u4ee4<code>leaq 7(%rdx, %rdx, 4), %rax</code>\uff0c\u5c06\u4f1a\u8bbe\u7f6e\u5bc4\u5b58\u5668%rax \u7684\u503c\u4e3a 5x+7</p> <p>leaq\u6307\u4ee4\u80fd\u6267\u884c\u52a0\u6cd5\u548c\u6709\u9650\u5f62\u5f0f\u7684\u4e58\u6cd5\uff0c\u9002\u5408\u7b80\u5355\u7684\u7b97\u6570\u8868\u8fbe\u5f0f</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_9","title":"\u4e00\u5143\u548c\u4e8c\u5143\u64cd\u4f5c","text":"<p>\u56fe\u4e2d\u7b2c\u4e8c\u7ec4\u7684\u64cd\u4f5c\u662f\u4e00\u5143\u64cd\u4f5c\uff0c\u65e2\u662f\u6e90\u53c8\u662f\u76ee\u7684\u3002\u8be5\u64cd\u4f5c\u6570\u53ef\u4ee5\u8bf4\u4e00\u4e2a\u5bc4\u5b58\u5668\uff0c\u4e5f\u53ef\u4ee5\u662f\u5185\u5b58\u4f4d\u7f6e\u3002 incq(%rsp)\u4f1a\u4f7f\u6808\u9876\u76848\u5b57\u8282\u5143\u7d20+1\uff0c\u7c7b\u4f3c\u4e8e ++</p> <p>\u56fe\u4e2d\u7b2c\u4e09\u7ec4\u662f\u4e8c\u5143\u64cd\u4f5c\uff0c\u7b2c\u4e8c\u4e2a\u64cd\u4f5c\u6570 \u65e2\u662f\u6e90\u53c8\u662f\u76ee\u7684\u3002\u6240\u4ee5\u8fd9\u7c7b\u4f3c\u4e8e +=  \u4f46\u9700\u8981\u6ce8\u610f\u6e90\u64cd\u4f5c\u6570\u662f\u7b2c\u4e00\u4e2a\uff0c\u76ee\u7684\u64cd\u4f5c\u6570\u662f\u7b2c\u4e8c\u4e2a \u7b2c\u4e00\u4e2a\u64cd\u4f5c\u6570\u53ef\u4ee5\u662f\u7acb\u5373\u6570\uff0c\u4f46\u7b2c\u4e8c\u4e2a\u4e0d\u53ef\u4ee5\u3002 <code>subq %rax, %rdx</code> \u4f7f\u5bc4\u5b58\u5668%rdx\u7684\u503c\u51cf\u53bb%rax \u4e2d\u7684\u503c, \u5373%rdx-=%rax</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_10","title":"\u79fb\u4f4d\u64cd\u4f5c","text":"<p>\u6700\u540e\u4e00\u7ec4\u662f\u79fb\u4f4d\u64cd\u4f5c\u3002\u9996\u5148\u7ed9\u51fa\u79fb\u4f4d\u91cf\uff0c\u7136\u540e\u662f\u8981\u79fb\u4f4d\u7684\u6570\u3002 \u79fb\u4f4d\u91cf\u53ef\u4ee5\u662f\u4e00\u4e2a\u7acb\u5373\u6570\uff0c\u6216\u8005\u653e\u5728\u5355\u5b57\u8282\u5bc4\u5b58\u5668%cl \u4e2d(\u8fd9\u4e9b\u6307\u4ee4\u53ea\u80fd\u4f7f\u7528\u8fd9\u4e2a\u5bc4\u5b58\u5668)</p> <p>[!info] \u7b97\u672f\u79fb\u4f4d\u4f1a\u586b\u4e0a\u7b26\u53f7\u4f4d\uff0c\u800c\u903b\u8f91\u79fb\u4f4d\u53ea\u586b\u4e0a0 \u56e0\u6b64\u53ea\u6709\u53f3\u79fb\u5b58\u5728\u8fd9\u79cd\u533a\u5206</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_11","title":"\u7279\u6b8a\u7684\u7b97\u672f\u64cd\u4f5c","text":"<p>imulq == \u8865\u7801\u4e58\u6cd5</p> <p>CSAPP P134: \u5982\u4f55\u5b9e\u73b064\u4f4d * 64\u4f4d = 128 \u4f4d</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_12","title":"\u63a7\u5236","text":""},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_13","title":"\u6761\u4ef6\u7801","text":"<p>\u5e38\u7528\u7684\u6761\u4ef6\u7801\u6709 CF\uff1a\u8fdb\u4f4d\u6807\u5fd7\u3002\u6700\u8fd1\u7684\u64cd\u4f5c\u4f7f\u6700\u9ad8\u4f4d\u4ea7\u751f\u4e86\u8fdb\u4f4d\u3002\u53ef\u7528\u6765\u68c0\u67e5\u65e0\u7b26\u53f7\u64cd\u4f5c\u7684\u6ea2\u51fa  ZF\uff1a\u96f6\u6807\u5fd7\u3002\u6700\u8fd1\u7684\u64cd\u4f5c\u5f97\u51fa\u7684\u7ed3\u679c\u4e3a 0 \u3002 SF\uff1a\u7b26\u53f7\u6807\u5fd7\u3002\u6700\u8fd1\u7684\u64cd\u4f5c\u5f97\u5230\u7684\u7ed3\u679c\u4e3a\u8d1f\u6570\u3002 OF\uff1a\u6ea2\u51fa\u6807\u5fd7\u3002\u6700\u8fd1\u7684\u64cd\u4f5c\u5bfc\u81f4\u4e00\u4e2a\u8865\u7801\u6ea2\u51fa\u2014\u2014\u6b63\u6ea2\u51fa\u6216\u8d1f\u6ea2\u51fa\u3002 leaq\u4e0d\u4f1a\u6539\u53d8\u4efb\u4f55\u6761\u4ef6\u7801\uff0c\u56e0\u4e3aleaq\u662f\u7528\u4e8e\u5730\u5740\u8ba1\u7b97\u3002 \u4f46Picture/Screenshot_20230225_145404.jpg\u4e2d\u7684\u6240\u6709\u6307\u4ee4\u90fd\u4f1a\u8bbe\u7f6e\u6761\u4ef6\u7801\u3002</p> <p> \u9664\u4e86\u4e4b\u524d\u56fe\u7247\u5c55\u793a\u7684\u6307\u4ee4\u4f1a\u8bbe\u7f6e\u6761\u4ef6\u7801\uff0c\u4e0a\u56fe\u4e2d\u7684\u6307\u4ee4\u4e5f\u4f1a\u5c55\u793a\u6761\u4ef6\u7801\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_14","title":"\u8bbf\u95ee\u6761\u4ef6\u7801","text":"<p>\u6761\u4ef6\u7801\u901a\u5e38\u4e0d\u4f1a\u76f4\u63a5\u8bfb\u53d6\uff0c\u5e38\u7528\u7684\u4f7f\u7528\u65b9\u6cd5\u6709\u4e09\u79cd\uff1a 1. \u6839\u636e\u6761\u4ef6\u7801\u7684\u67d0\u79cd\u7ec4\u5408\uff0c\u5c06\u67d0\u4e2a\u5b57\u8282\u8bbe\u7f6e\u4e3a0\u62161\u3002 2. \u6761\u4ef6\u8df3\u8f6c\u5230\u7a0b\u5e8f\u7684\u5176\u4ed6\u7684\u90e8\u5206\u3002 3. \u6709\u6761\u4ef6\u5730\u4f20\u9001\u6570\u636e\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#set","title":"set\u6307\u4ee4","text":"<p>set\u6307\u4ee4\u7684\u540e\u7f00\u5e76\u4e0d\u8868\u793a\u5b57\u8282\u5927\u5c0f\uff0c\u800c\u662f\u8868\u793a\u4e0d\u540c\u7684\u6761\u4ef6 setl set less setb set below </p> <p></p> <pre><code>cmpq %rsi, %rdi\nsetl %al\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_15","title":"\u8df3\u8f6c\u6307\u4ee4","text":"<p>jmp\u6307\u4ee4\u901a\u5e38\u9700\u8981\u4e00\u4e2a\u6807\u53f7(label)\u6307\u660e\u3002 jmp\u6307\u4ee4\u662f\u65e0\u6761\u4ef6\u8df3\u8f6c\u3002 \u5b83\u53ef\u4ee5\u662f\u76f4\u63a5\u8df3\u8f6c\uff0c\u5373\u8df3\u8f6c\u76ee\u6807\u662f\u4f5c\u4e3a\u6307\u4ee4\u7684\u4e00\u90e8\u5206\u7f16\u7801\u7684\uff1b \u4e5f\u53ef\u4ee5\u662f\u95f4\u63a5\u8df3\u8f6c\uff0c\u5373\u8df3\u8f6c\u76ee\u6807\u662f\u4ece\u5bc4\u5b58\u5668\u6216\u5185\u5b58\u4f4d\u7f6e\u4e2d\u8bfb\u51fa\u7684\u3002 <code>jmp *%rax</code>   \u7528\u5bc4\u5b58\u5668%rax\u4e2d\u7684\u503c\u4f5c\u4e3a\u8df3\u8f6c\u76ee\u6807\u3002 <code>jmp *(%rax)</code> \u7528\u5bc4\u5b58\u5668%rax\u4e2d\u7684\u503c\u4f5c\u4e3a\u8bfb\u5730\u5740\uff0c\u4ece\u5185\u5b58\u4e2d\u8bfb\u51fa\u8df3\u8f6c\u76ee\u6807\u3002</p> <p></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_16","title":"\u8df3\u8f6c\u6307\u4ee4\u7684\u7f16\u7801","text":"<p>CSAPP P140</p> <p>\u8df3\u8f6c\u7684\u65b9\u6cd5 1. \u7ed9\u51faPC-relative\uff0c\u5730\u5740\u504f\u79fb\u91cf1\u30012\u30014\u5b57\u8282 2. \u7ed9\u51fa\u7edd\u5bf9\u5730\u5740\uff0c\u5730\u5740\u504f\u79fb\u91cf4\u5b57\u8282</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_17","title":"\u7528\u6761\u4ef6\u63a7\u5236\u6765\u5b9e\u73b0\u6761\u4ef6\u5206\u652f","text":"<p>\u5b9e\u73b0\u6761\u4ef6\u64cd\u4f5c\u7684\u4f20\u7edf\u65b9\u6cd5\u662f\u4f7f\u7528\u63a7\u5236\u7684\u6761\u4ef6\u8f6c\u79fb\uff0c\u5f53\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u7a0b\u5e8f\u6cbf\u7740\u8fd9\u6761\u6267\u884c\u8def\u5f84\u6267\u884c\uff0c\u5982\u679c\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u5c31\u6267\u884c\u53e6\u4e00\u6761\u8def\u5f84\u3002</p> <p>\u4f7f\u7528\u6570\u636e\u7684\u6761\u4ef6\u8f6c\u79fb\uff0c\u8fd9\u79cd\u65b9\u6cd5\u5148\u8ba1\u7b97\u4e00\u4e2a\u6761\u4ef6\u64cd\u4f5c\u7684\u4e24\u4e2a\u7ed3\u679c\uff0c\u518d\u6839\u636e\u6761\u4ef6\u662f\u5426\u6ee1\u8db3\u4ece\u4e2d\u9009\u62e9\u4e00\u4e2a\u3002\u53ea\u6709\u518d\u4e00\u4e9b\u53d7\u9650\u5236\u7684\u60c5\u51b5\u4e2d\uff0c\u8fd9\u79cd\u7b56\u7565\u624d\u53ef\u884c\u3002\u4f46\u5982\u679c\u53ef\u884c\uff0c\u5c31\u53ef\u4ee5\u7528\u7b80\u5355\u7684\u4e00\u6761\u6761\u4ef6\u4f20\u9001\u6307\u4ee4\u5b9e\u73b0\u5b83\u3002\u800c\u6761\u4ef6\u4f20\u9001\u6307\u4ee4\u66f4\u52a0\u7b26\u5408\u73b0\u4ee3\u5904\u7406\u5668\u7684\u6027\u80fd\u7279\u6027\u3002</p> <p></p> <p></p> <p>\u57fa\u4e8e\u6761\u4ef6\u6570\u636e\u4f20\u9001\u7684\u4ee3\u7801\u4f1a\u6bd4\u57fa\u4e8e\u6761\u4ef6\u63a7\u5236\u8f6c\u79fb\u7684\u4ee3\u7801\u6027\u80fd\u8981\u597d\uff0c\u56e0\u4e3a\u5904\u7406\u5668\u901a\u8fc7\u4f7f\u7528\u6d41\u6c34\u7ebf\u6765\u83b7\u5f97\u9ad8\u6027\u80fd</p> <p>\u4e3a\u4e86\u7406\u89e3\u4e3a\u4ec0\u4e48\u57fa\u4e8e\u6761\u4ef6\u6570\u636e\u4f20\u9001\u7684\u4ee3\u7801\u4f1a\u6bd4\u57fa\u4e8e\u6761\u4ef6\u63a7\u5236\u8f6c\u79fb\u7684\u4ee3\u7801\uff08\u5982\u56fe3-16\u4e2d\u90a3\u6837\uff09\u6027\u80fd\u8981\u597d\uff0c\u6211\u4eec\u5fc5\u987b\u4e86\u89e3\u4e00\u4e9b\u5173\u4e8e\u73b0\u4ee3\u5904\u7406\u5668\u5982\u4f55\u8fd0\u884c\u7684\u77e5\u8bc6\u3002 \u6b63\u5982\u6211\u4eec\u5c06\u5728\u7b2c4\u7ae0\u548c\u7b2c5\u7ae0\u4e2d\u770b\u5230\u7684\uff0c\u5904\u7406\u5668\u901a\u8fc7\u4f7f\u7528\u6d41\u6c34\u7ebf (pipelining) \u6765\u83b7\u5f97\u9ad8\u6027\u80fd\uff0c\u5728\u6d41\u6c34\u7ebf\u4e2d\uff0c\u4e00\u6761\u6307\u4ee4\u7684\u5904\u7406\u8981\u7ecf\u8fc7\u4e00\u7cfb\u5217\u7684\u9636\u6bb5\uff0c\u6bcf\u4e2a\u9636\u6bb5\u6267\u884c\u6240\u9700\u64cd\u4f5c\u7684\u4e00\u5c0f\u90e8\u5206\uff08\u4f8b\u5982\uff0c\u4ece\u5185\u5b58\u53d6\u6307\u4ee4\u3001\u786e\u5b9a\u6307\u4ee4\u7c7b\u578b\u3001\u4ece\u5185\u5b58\u8bfb\u6570\u636e\u3001\u6267\u884c\u7b97\u672f\u8fd0\u7b97\u3001\u5411\u5185\u5b58\u5199\u6570\u636e\uff0c\u4ee5\u53ca\u66f4\u65b0\u7a0b\u5e8f\u8ba1\u6570\u5668\uff09\u3002 \u8fd9\u79cd\u65b9\u6cd5\u901a\u8fc7\u91cd\u53e0\u8fde\u7eed\u6307\u4ee4\u7684\u6b65\u9aa4\u6765\u83b7\u5f97\u9ad8\u6027\u80fd\uff0c \u4f8b\u5982\uff0c\u5728\u53d6\u4e00\u6761\u6307\u4ee4\u7684\u540c\u65f6\uff0c\u6267\u884c\u5b83\u524d\u9762\u4e00\u6761\u6307\u4ee4\u7684\u7b97\u672f\u8fd0\u7b97\u3002\u8981\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u8981\u6c42\u80fd\u591f\u4e8b\u5148\u786e\u5b9a\u8981\u6267\u884c\u7684\u6307\u4ee4\u5e8f\u5217\uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u6301\u6d41\u6c34\u7ebf\u4e2d\u5145\u6ee1\u4e86\u5f85\u6267\u884c\u7684\u6307\u4ee4 \u3002\u5f53\u673a\u5668\u9047\u5230\u6761\u4ef6\u8df3\u8f6c\uff08\u4e5f\u79f0\u4e3a\u201c\u5206\u652f\")\u65f6\uff0c\u53ea\u6709\u5f53\u5206\u652f\u6761\u4ef6\u6c42\u503c\u5b8c\u6210\u4e4b\u540e\uff0c\u624d\u80fd\u51b3\u5b9a\u5206\u652f\u5f80\u54ea\u8fb9\u8d70\u3002 \u5904\u7406\u5668\u91c7\u7528\u975e\u5e38\u7cbe\u5bc6\u7684\u5206\u652f\u9884\u6d4b\u903b\u8f91\u6765\u731c\u6d4b\u6bcf\u6761\u8df3\u8f6c\u6307\u4ee4\u662f\u5426\u4f1a\u6267\u884c \u3002\u53ea\u8981\u5b83\u7684\u731c\u6d4b\u8fd8\u6bd4\u8f83\u53ef\u9760\uff08\u73b0\u4ee3\u5fae\u5904\u7406\u5668\u8bbe\u8ba1\u8bd5\u56fe\u8fbe\u523090% \u4ee5\u4e0a\u7684\u6210\u529f\u7387\uff09\uff0c\u6307\u4ee4\u6d41\u6c34\u7ebf\u4e2d\u5c31\u4f1a\u5145\u6ee1\u7740\u6307\u4ee4\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u9519\u8bef\u9884\u6d4b\u4e00\u4e2a\u8df3\u8f6c\uff0c\u8981\u6c42\u5904\u7406\u5668\u4e22\u6389\u5b83\u4e3a\u8be5\u8df3\u8f6c\u6307\u4ee4\u540e\u6240\u6709\u6307\u4ee4\u5df1\u505a\u7684\u5de5\u4f5c\uff0c\u7136\u540e\u518d\u5f00\u59cb\u7528\u4ece\u6b63\u786e\u4f4d\u7f6e\u5904\u8d77\u59cb\u7684\u6307\u4ee4\u53bb\u586b\u5145\u6d41\u6c34\u7ebf\u3002\u6b63\u5982\u6211\u4eec\u4f1a\u770b\u5230\u7684\uff0c\u8fd9\u6837\u4e00\u4e2a\u9519\u8bef\u9884\u6d4b\u4f1a\u62db\u81f4\u5f88\u4e25\u91cd\u7684\u60e9\u7f5a\uff0c\u6d6a\u8d39\u5927\u7ea6 15~30 \u4e2a\u65f6\u949f\u5468\u671f\uff0c\u5bfc\u81f4\u7a0b\u5e8f\u6027\u80fd\u4e25\u91cd\u4e0b\u964d\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_18","title":"\u6761\u4ef6\u4f20\u9001\u6307\u4ee4","text":"<p>\u5e76\u975e\u6240\u6709\u7684\u6761\u4ef6\u4f20\u9001\u8868\u8fbe\u5f0f\u90fd\u53ef\u4ee5\u7528\u6761\u4ef6\u4f20\u9001\u6765\u7f16\u8bd1\u3002\u4f7f\u7528\u6761\u4ef6\u4f20\u9001\u4e5f\u4e0d\u603b\u662f\u4f1a\u63d0\u9ad8\u4ee3\u7801\u7684\u6548\u7387\u3002\u6bd4\u5982\u8fd0\u7b97\u5206\u652f\u7ed3\u679c\u53ef\u80fd\u8017\u8d39\u5927\u91cf\u65f6\u95f4\u3002\u4f46\u6700\u540e\u5e76\u4e0d\u9700\u8981\u8fd9\u6761\u5206\u652f\u3002\u800c\u7f16\u8bd1\u5668\u4e5f\u5f88\u5c11\u4f7f\u7528\u6761\u4ef6\u4f20\u9001\uff0c\u9664\u975e\u8ba1\u7b97\u7b80\u5355\u3002</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u6761\u4ef6\u6570\u636e\u4f20\u9001\u63d0\u4f9b\u4e86\u4e00\u79cd\u7528\u6761\u4ef6\u63a7\u5236\u8f6c\u79fb\u6765\u5b9e\u73b0\u6761\u4ef6\u64cd\u4f5c\u7684\u66ff\u4ee3\u7b56\u7565\u3002\u5b83\u4eec\u53ea\u80fd\u7528\u4e8e\u975e\u5e38\u53d7\u9650\u5236\u7684\u60c5\u51b5\uff0c\u4f46\u662f\u8fd9\u4e9b\u60c5\u51b5\u8fd8\u662f\u76f8\u5f53\u5e38\u89c1\u7684\uff0c\u800c\u4e14\u4e0e\u73b0\u4ee3\u5904\u7406\u5668\u7684\u8fd0\u884c\u65b9\u5f0f\u66f4\u5951\u5408\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_19","title":"\u5faa\u73af","text":"<p>for\uff1a p157</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#switch","title":"switch \u8bed\u53e5","text":"<p>\u901a\u8fc7\u4f7f\u7528\u8df3\u8f6c\u8868(jump table)\uff0c\u4f7f\u5f97\u8df3\u8f6c\u66f4\u52a0\u9ad8\u6548\u3002</p> <p></p> <p></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_20","title":"\u8fc7\u7a0b","text":""},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_21","title":"\u8fd0\u884c\u65f6\u6808","text":""},{"location":"%E5%85%B6%E4%BB%96/CSAPP/3.%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA/#_22","title":"\u8f6c\u79fb\u63a7\u5236","text":""},{"location":"%E5%85%B6%E4%BB%96/CSAPP/bomb%20lab/","title":"Bomb lab","text":"<p>bomb lab</p> <p>disassemble \u53cd\u6c47\u7f16</p> <p></p> <p></p> <p></p> <p>\u5728x86\u6c47\u7f16\u4e2d\uff0c\u4ee5\u4e0b\u662f\u5e38\u89c1\u7684\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4\u7684\u542b\u4e49\uff1a</p> <ol> <li> <p><code>je</code>\uff1a\u4ee3\u8868\"\u7b49\u4e8e\"\u3002\u5b83\u7528\u4e8e\u5728\u524d\u4e00\u4e2a\u6bd4\u8f83\u6307\u4ee4\u7684\u7ed3\u679c\u4e3a\u76f8\u7b49\u65f6\u8df3\u8f6c\u6267\u884c\u6307\u5b9a\u7684\u4ee3\u7801\u3002</p> </li> <li> <p><code>jbe</code>\uff1a\u4ee3\u8868\"\u4ee5\u4e0b\u6216\u7b49\u4e8e\"\u3002\u5b83\u7528\u4e8e\u5728\u524d\u4e00\u4e2a\u65e0\u7b26\u53f7\u6bd4\u8f83\u6307\u4ee4\u7684\u7ed3\u679c\u4e3a\u65e0\u7b26\u53f7\u6570\u5c0f\u4e8e\u7b49\u4e8e\u65f6\u8df3\u8f6c\u6267\u884c\u6307\u5b9a\u7684\u4ee3\u7801\u3002</p> </li> <li> <p><code>jle</code>\uff1a\u4ee3\u8868\"\u5c0f\u4e8e\u7b49\u4e8e\"\u3002\u5b83\u7528\u4e8e\u5728\u524d\u4e00\u4e2a\u6709\u7b26\u53f7\u6bd4\u8f83\u6307\u4ee4\u7684\u7ed3\u679c\u4e3a\u6709\u7b26\u53f7\u6570\u5c0f\u4e8e\u7b49\u4e8e\u65f6\u8df3\u8f6c\u6267\u884c\u6307\u5b9a\u7684\u4ee3\u7801\u3002</p> </li> <li> <p><code>jne</code>\uff1a\u4ee3\u8868\"\u4e0d\u7b49\u4e8e\"\u3002\u5b83\u7528\u4e8e\u5728\u524d\u4e00\u4e2a\u6bd4\u8f83\u6307\u4ee4\u7684\u7ed3\u679c\u4e3a\u4e0d\u76f8\u7b49\u65f6\u8df3\u8f6c\u6267\u884c\u6307\u5b9a\u7684\u4ee3\u7801\u3002</p> </li> </ol> <p>phase_1</p> <p>\u4f7f\u7528x/s\u67e5\u770b0x402400\u7684\u503c</p> <pre><code>Border relations with Canada have never been better.\n</code></pre> <p>phase_2</p> <ul> <li>\"push %rbp\"\uff1a\u5c06\u5bc4\u5b58\u5668%rbp\u7684\u5185\u5bb9\u538b\u5165\u6808\u9876\u3002%rbp\u662f\u57fa\u5740\u6307\u9488\u5bc4\u5b58\u5668\uff0c\u901a\u5e38\u7528\u4e8e\u4fdd\u5b58\u51fd\u6570\u7684\u57fa\u5740\u3002</li> <li>\"push %rbx\"\uff1a\u5c06\u5bc4\u5b58\u5668%rbx\u7684\u5185\u5bb9\u538b\u5165\u6808\u9876\u3002%rbx\u662f\u901a\u7528\u5bc4\u5b58\u5668\uff0c\u53ef\u4ee5\u7528\u4e8e\u5b58\u50a8\u4e34\u65f6\u6570\u636e\u6216\u4f5c\u4e3a\u6307\u9488\u3002</li> <li>\"sub $0x28,%rsp\": \u6307\u4ee4\u5c06\u6808\u6307\u9488<code>%rsp</code>\u5411\u4f4e\u5730\u5740\u65b9\u5411\u79fb\u52a828\u4e2a\u5b57\u8282\uff0c\u4e3a\u5c40\u90e8\u53d8\u91cf\u548c\u5176\u4ed6\u4e34\u65f6\u6570\u636e\u5206\u914d\u7a7a\u95f4\u3002\u8fd9\u91cc\u4f7f\u7528\u8d1f\u503c\u8868\u793a\u5411\u4e0b\u6269\u5c55\u6808\u7a7a\u95f4\u3002</li> </ul> <p>\u7efc\u5408\u8d77\u6765\uff0c\u8fd9\u6bb5\u4ee3\u7801\u7684\u4f5c\u7528\u662f\u4fdd\u5b58\u8c03\u7528\u51fd\u6570\u524d\u7684\u5bc4\u5b58\u5668\u72b6\u6001\uff0c\u5e76\u4e3a\u5c40\u90e8\u53d8\u91cf\u5206\u914d\u4e00\u4e9b\u6808\u5185\u5b58\u7a7a\u95f4\u3002\u5728\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u901a\u8fc7\u76f8\u5e94\u7684\u6307\u4ee4\u53ef\u4ee5\u6062\u590d\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u5e76\u91ca\u653e\u4e4b\u524d\u5206\u914d\u7684\u6808\u7a7a\u95f4\u3002</p> <pre><code>Dump of assembler code for function phase_2:\n   0x0000000000400efc &lt;+0&gt;:     push   %rbp\n   0x0000000000400efd &lt;+1&gt;:     push   %rbx\n   0x0000000000400efe &lt;+2&gt;:     sub    $0x28,%rsp\n   0x0000000000400f02 &lt;+6&gt;:     mov    %rsp,%rsi\n   0x0000000000400f05 &lt;+9&gt;:     callq  0x40145c &lt;read_six_numbers&gt;\n   0x0000000000400f0a &lt;+14&gt;:    cmpl   $0x1,(%rsp)\n   0x0000000000400f0e &lt;+18&gt;:    je     0x400f30 &lt;phase_2+52&gt;\n   0x0000000000400f10 &lt;+20&gt;:    callq  0x40143a &lt;explode_bomb&gt;\n   0x0000000000400f15 &lt;+25&gt;:    jmp    0x400f30 &lt;phase_2+52&gt;\n   0x0000000000400f17 &lt;+27&gt;:    mov    -0x4(%rbx),%eax\n   0x0000000000400f1a &lt;+30&gt;:    add    %eax,%eax\n   0x0000000000400f1c &lt;+32&gt;:    cmp    %eax,(%rbx)\n   0x0000000000400f1e &lt;+34&gt;:    je     0x400f25 &lt;phase_2+41&gt;\n   0x0000000000400f20 &lt;+36&gt;:    callq  0x40143a &lt;explode_bomb&gt;\n   0x0000000000400f25 &lt;+41&gt;:    add    $0x4,%rbx\n   0x0000000000400f29 &lt;+45&gt;:    cmp    %rbp,%rbx\n   0x0000000000400f2c &lt;+48&gt;:    jne    0x400f17 &lt;phase_2+27&gt;\n   0x0000000000400f2e &lt;+50&gt;:    jmp    0x400f3c &lt;phase_2+64&gt;\n   0x0000000000400f30 &lt;+52&gt;:    lea    0x4(%rsp),%rbx\n   0x0000000000400f35 &lt;+57&gt;:    lea    0x18(%rsp),%rbp\n   0x0000000000400f3a &lt;+62&gt;:    jmp    0x400f17 &lt;phase_2+27&gt;\n   0x0000000000400f3c &lt;+64&gt;:    add    $0x28,%rsp\n   0x0000000000400f40 &lt;+68&gt;:    pop    %rbx\n   0x0000000000400f41 &lt;+69&gt;:    pop    %rbp\n   0x0000000000400f42 &lt;+70&gt;:    retq   \nEnd of assembler dump.\n</code></pre> <pre><code>(gdb) disas read_six_numbers \nDump of assembler code for function read_six_numbers:\n   0x000000000040145c &lt;+0&gt;:     sub    $0x18,%rsp\n   0x0000000000401460 &lt;+4&gt;:     mov    %rsi,%rdx\n   0x0000000000401463 &lt;+7&gt;:     lea    0x4(%rsi),%rcx\n   0x0000000000401467 &lt;+11&gt;:    lea    0x14(%rsi),%rax\n   0x000000000040146b &lt;+15&gt;:    mov    %rax,0x8(%rsp)\n   0x0000000000401470 &lt;+20&gt;:    lea    0x10(%rsi),%rax\n   0x0000000000401474 &lt;+24&gt;:    mov    %rax,(%rsp)\n   0x0000000000401478 &lt;+28&gt;:    lea    0xc(%rsi),%r9\n   0x000000000040147c &lt;+32&gt;:    lea    0x8(%rsi),%r8\n   0x0000000000401480 &lt;+36&gt;:    mov    $0x4025c3,%esi\n   0x0000000000401485 &lt;+41&gt;:    mov    $0x0,%eax\n   0x000000000040148a &lt;+46&gt;:    callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;\n   0x000000000040148f &lt;+51&gt;:    cmp    $0x5,%eax\n   0x0000000000401492 &lt;+54&gt;:    jg     0x401499 &lt;read_six_numbers+61&gt;\n   0x0000000000401494 &lt;+56&gt;:    callq  0x40143a &lt;explode_bomb&gt;\n   0x0000000000401499 &lt;+61&gt;:    add    $0x18,%rsp\n   0x000000000040149d &lt;+65&gt;:    retq   \nEnd of assembler dump.\n</code></pre> <p>\u5728\u53cd\u6c47\u7f16\u4e2d\u6dfb\u52a0\u65ad\u70b9\uff1a <pre><code>b *func+14\n</code></pre> func \u4e3a\u51fd\u6570\u540d +14\u4e3a\u6c47\u7f16\u6307\u4ee4\u504f\u79fb\u91cf</p> <p>\u67e5\u770b\u5bc4\u5b58\u5668rsp\u4f4d\u7f6e\u540en\u4e2a\u5b57\u8282\u7684\u6570\u636e <pre><code>x /nxb $rsp\n</code></pre></p> <pre><code>   0x0000000000400f17 &lt;+27&gt;:    mov    -0x4(%rbx),%eax // eax = rbx[i-1]\n   0x0000000000400f1a &lt;+30&gt;:    add    %eax,%eax // eax += eax\n=&gt; 0x0000000000400f1c &lt;+32&gt;:    cmp    %eax,(%rbx) // eax == rbx[i]\n   0x0000000000400f1e &lt;+34&gt;:    je     0x400f25 &lt;phase_2+41&gt; // \u5faa\u73af\n   0x0000000000400f20 &lt;+36&gt;:    callq  0x40143a &lt;explode_bomb&gt; // Bomb!!!\n</code></pre> <p>\u6839\u636e\u8fd9\u4e00\u6bb5\uff1a\u8f93\u5165\u7684\u540e\u4e00\u4e2a\u6570\u5b57\u9700\u8981\u662f\u524d\u4e00\u4e2a\u6570\u5b57\u7684\u4e24\u500d\u3002\u51716\u4e2a\u6570\u5b57\u3002</p> <p>answer <pre><code>1 2 4 8 16 32\n</code></pre></p> <p>phase_3</p> <p>\u8f93\u5165\u4e24\u4e2a\u6570\u5b57\uff1a\u7b2c\u4e00\u4e2a\u6570\u4e3a\u5c0f\u4e8e\u7b49\u4e8e7\u7684\u6570\uff0c\u7b2c\u4e8c\u4e2a\u6570\u6839\u636e\u7b2c\u4e00\u4e2a\u6570\u51b3\u5b9a</p> <pre><code>   0x0000000000400f43 &lt;+0&gt;:     sub    $0x18,%rsp\n   0x0000000000400f47 &lt;+4&gt;:     lea    0xc(%rsp),%rcx\n   0x0000000000400f4c &lt;+9&gt;:     lea    0x8(%rsp),%rdx\n   0x0000000000400f51 &lt;+14&gt;:    mov    $0x4025cf,%esi\n   0x0000000000400f56 &lt;+19&gt;:    mov    $0x0,%eax\n   0x0000000000400f5b &lt;+24&gt;:    callq  0x400bf0 &lt;__isoc99_sscanf@plt&gt;\n   0x0000000000400f60 &lt;+29&gt;:    cmp    $0x1,%eax\n   0x0000000000400f63 &lt;+32&gt;:    jg     0x400f6a &lt;phase_3+39&gt;\n   0x0000000000400f65 &lt;+34&gt;:    callq  0x40143a &lt;explode_bomb&gt;\n   x &lt;= 7\n   0x0000000000400f6a &lt;+39&gt;:    cmpl   $0x7,0x8(%rsp)\n   0x0000000000400f6f &lt;+44&gt;:    ja     0x400fad &lt;phase_3+106&gt;\n   0x0000000000400f71 &lt;+46&gt;:    mov    0x8(%rsp),%eax\n   switch\n   0x0000000000400f75 &lt;+50&gt;:    jmpq   *0x402470(,%rax,8)\n   x = 0\n   0x0000000000400f7c &lt;+57&gt;:    mov    $0xcf,%eax\n   0x0000000000400f81 &lt;+62&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;\n   x = 2\n   0x0000000000400f83 &lt;+64&gt;:    mov    $0x2c3,%eax // 0x2c3 == 707\n   0x0000000000400f88 &lt;+69&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;\n   x = 3\n   0x0000000000400f8a &lt;+71&gt;:    mov    $0x100,%eax\n   0x0000000000400f8f &lt;+76&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;\n   x = 4\n   0x0000000000400f91 &lt;+78&gt;:    mov    $0x185,%eax\n   0x0000000000400f96 &lt;+83&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;\n   x = 5\n   0x0000000000400f98 &lt;+85&gt;:    mov    $0xce,%eax\n   0x0000000000400f9d &lt;+90&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;\n   x = 6\n   0x0000000000400f9f &lt;+92&gt;:    mov    $0x2aa,%eax\n   0x0000000000400fa4 &lt;+97&gt;:    jmp    0x400fbe &lt;phase_3+123&gt;\n   x = 7\n   0x0000000000400fa6 &lt;+99&gt;:    mov    $0x147,%eax\n   0x0000000000400fab &lt;+104&gt;:   jmp    0x400fbe &lt;phase_3+123&gt;\n   0x0000000000400fad &lt;+106&gt;:   callq  0x40143a &lt;explode_bomb&gt;\n   0x0000000000400fb2 &lt;+111&gt;:   mov    $0x0,%eax\n   0x0000000000400fb7 &lt;+116&gt;:   jmp    0x400fbe &lt;phase_3+123&gt;\n   x = 1\n   0x0000000000400fb9 &lt;+118&gt;:   mov    $0x137,%eax // 0x137 == 311\n   0x0000000000400fbe &lt;+123&gt;:   cmp    0xc(%rsp),%eax\n=&gt; 0x0000000000400fc2 &lt;+127&gt;:   je     0x400fc9 &lt;phase_3+134&gt;\n   0x0000000000400fc4 &lt;+129&gt;:   callq  0x40143a &lt;explode_bomb&gt;\n   0x0000000000400fc9 &lt;+134&gt;:   add    $0x18,%rsp\n   0x0000000000400fcd &lt;+138&gt;:   retq   \n</code></pre> <p>answser <pre><code>1 311\n</code></pre></p> <p>phase_4</p> <p>test %eax, %eax\" \u662f\u4e00\u4e2a\u903b\u8f91\u8fd0\u7b97\u6307\u4ee4\u3002\u5b83\u7528\u4e8e\u5c06\u5bc4\u5b58\u5668 %eax \u7684\u503c\u4e0e\u81ea\u8eab\u8fdb\u884c\u6309\u4f4d\u903b\u8f91\u4e0e\u8fd0\u7b97\uff0c\u5373\u5c06 %eax \u7684\u503c\u4e0e\u81ea\u8eab\u7684\u6bcf\u4e2a\u5bf9\u5e94\u4f4d\u8fdb\u884c\u903b\u8f91\u4e0e\u64cd\u4f5c\u3002</p> <p>\u5982\u679c %eax \u7684\u503c\u4e3a\u96f6\uff0c\u5219\u6807\u5fd7\u4f4d\uff08flags\uff09\u5bc4\u5b58\u5668\u4e2d\u7684\u96f6\u6807\u5fd7\u4f4d\uff08ZF\uff09\u4f1a\u88ab\u8bbe\u7f6e\u4e3a1\uff0c\u8868\u793a\u76f8\u7b49\u3002</p> <p>\"test %eax, %eax\" \u6307\u4ee4\u7684\u4f5c\u7528\u662f\u68c0\u67e5 %eax \u5bc4\u5b58\u5668\u7684\u503c\u662f\u5426\u4e3a\u96f6\uff0c\u5e76\u6839\u636e\u7ed3\u679c\u8bbe\u7f6e\u76f8\u5e94\u7684\u6807\u5fd7\u4f4d\u3002</p> <p><pre><code>   0x0000000000401051 &lt;+69&gt;:    cmpl   $0x0,0xc(%rsp)\n   0x0000000000401056 &lt;+74&gt;:    je     0x40105d &lt;phase_4+81&gt;\n   0x0000000000401058 &lt;+76&gt;:    callq  0x40143a &lt;explode_bomb&gt;\n   0x000000000040105d &lt;+81&gt;:    add    $0x18,%rsp\n   0x0000000000401061 &lt;+85&gt;:    retq   \n</code></pre> \u53ef\u77e5\u7b2c\u4e8c\u4e2a\u6570\u4e3a0</p> <p>func4 \u662f\u4e00\u4e2a\u9012\u5f52\u51fd\u6570: <pre><code>Dump of assembler code for function func4:\n   0x0000000000400fce &lt;+0&gt;:     sub    $0x8,%rsp\n   0x0000000000400fd2 &lt;+4&gt;:     mov    %edx,%eax\n   0x0000000000400fd4 &lt;+6&gt;:     sub    %esi,%eax\n   0x0000000000400fd6 &lt;+8&gt;:     mov    %eax,%ecx\n   0x0000000000400fd8 &lt;+10&gt;:    shr    $0x1f,%ecx\n   0x0000000000400fdb &lt;+13&gt;:    add    %ecx,%eax\n=&gt; 0x0000000000400fdd &lt;+15&gt;:    sar    %eax\n   0x0000000000400fdf &lt;+17&gt;:    lea    (%rax,%rsi,1),%ecx\n   0x0000000000400fe2 &lt;+20&gt;:    cmp    %edi,%ecx\n   0x0000000000400fe4 &lt;+22&gt;:    jle    0x400ff2 &lt;func4+36&gt;\n   0x0000000000400fe6 &lt;+24&gt;:    lea    -0x1(%rcx),%edx\n   0x0000000000400fe9 &lt;+27&gt;:    callq  0x400fce &lt;func4&gt;\n   0x0000000000400fee &lt;+32&gt;:    add    %eax,%eax\n   0x0000000000400ff0 &lt;+34&gt;:    jmp    0x401007 &lt;func4+57&gt;\n   0x0000000000400ff2 &lt;+36&gt;:    mov    $0x0,%eax\n   0x0000000000400ff7 &lt;+41&gt;:    cmp    %edi,%ecx\n   0x0000000000400ff9 &lt;+43&gt;:    jge    0x401007 &lt;func4+57&gt;\n   0x0000000000400ffb &lt;+45&gt;:    lea    0x1(%rcx),%esi\n   0x0000000000400ffe &lt;+48&gt;:    callq  0x400fce &lt;func4&gt;\n   0x0000000000401003 &lt;+53&gt;:    lea    0x1(%rax,%rax,1),%eax\n   0x0000000000401007 &lt;+57&gt;:    add    $0x8,%rsp\n   0x000000000040100b &lt;+61&gt;:    retq   \n</code></pre></p> <p>\u53ef\u5c06func4\u7528c\u8bed\u8a00\u8868\u793a <pre><code>// edx = 0x4. esi = 0 ,edi = num1\nint func4(int edx, int esi, int edi) {\n  int eax = edx - esi;\n  eax = (eax + (eax &gt;&gt; 31)) &gt;&gt; 1; // 5-8\u884c eax == 7\n  int ecx = eax + esi;            // 9\u884c\n  if (edi &lt; ecx)\n    return 2 * func4(edi, esi, edx - 1); // 14\u884c\n  else if (edi &gt; ecx)\n    return 2 * func4(edi, esi + 1, edx) + 1; // 21\u884c\n  else\n    return 0;\n}\n</code></pre> \u53ef\u77e5edi = num1 = ecx, ecx = eax + esi \u56e0\u6b64num1 = 7</p> <p>answer <pre><code>7 0\n</code></pre></p> <p>phase 5</p> <p><pre><code>   0x000000000040107a &lt;+24&gt;:    callq  0x40131b &lt;string_length&gt;\n   0x000000000040107f &lt;+29&gt;:    cmp    $0x6,%eax\n   0x0000000000401082 &lt;+32&gt;:    je     0x4010d2 &lt;phase_5+112&gt;\n   0x0000000000401084 &lt;+34&gt;:    callq  0x40143a &lt;explode_bomb&gt;\n</code></pre> \u6839\u636e\u8fd9\u6bb5\u53ef\u77e5\u8981\u6c42\u8f93\u5165\u957f\u5ea6\u4e3a6\u7684\u5b57\u7b26\u4e32</p> <pre><code>movzbl (%rbx,%rax,1),%ecx\n</code></pre> <ul> <li><code>movzbl</code>\uff1a\u8fd9\u662f\u6307\u4ee4\u7684\u52a9\u8bb0\u7b26\uff0c\u8868\u793a\"move zero-extend byte to long\"\uff08\u5c06\u5b57\u8282\u96f6\u6269\u5c55\u4e3a\u957f\u5b57\uff09\u3002\u5b83\u544a\u8bc9\u5904\u7406\u5668\u8981\u6267\u884c\u4e00\u4e2a\u5c06\u5b57\u8282\u96f6\u6269\u5c55\u4e3a\u53cc\u5b57\uff0832\u4f4d\uff09\u7684\u64cd\u4f5c\u3002</li> <li><code>(%rbx,%rax,1)</code>\uff1a\u8fd9\u662f\u5185\u5b58\u64cd\u4f5c\u6570\u7684\u8868\u793a\u65b9\u5f0f\u3002\u5728\u8fd9\u91cc\uff0c<code>%rbx</code>\u548c<code>%rax</code>\u662f\u5bc4\u5b58\u5668\uff0c<code>1</code>\u662f\u4e00\u4e2a\u6bd4\u4f8b\u56e0\u5b50\uff08scale factor\uff09\u3002\u8be5\u8868\u8fbe\u5f0f\u7684\u542b\u4e49\u662f\u5c06<code>%rbx</code>\u548c<code>%rax</code>\u7684\u5185\u5bb9\u76f8\u52a0\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u5185\u5b58\u5730\u5740\u6765\u8bbf\u95ee\u3002\u8fd9\u4e2a\u6307\u4ee4\u5c06\u4ece\u8ba1\u7b97\u5f97\u5230\u7684\u5185\u5b58\u5730\u5740\u5f00\u59cb\u8bfb\u53d6\u4e00\u4e2a\u5b57\u8282\u7684\u6570\u636e\u3002</li> <li><code>%ecx</code>\uff1a\u8fd9\u662f\u76ee\u6807\u5bc4\u5b58\u5668\uff0c\u7528\u4e8e\u5b58\u50a8\u4ece\u5185\u5b58\u8bfb\u53d6\u5e76\u96f6\u6269\u5c55\u7684\u6570\u636e\u3002\u6570\u636e\u5c06\u88ab\u5b58\u50a8\u5728ECX\u5bc4\u5b58\u5668\u4e2d\u3002</li> </ul> <p>\u56e0\u6b64\uff0c\u8fd9\u6761\u6307\u4ee4\u7684\u4f5c\u7528\u662f\u5c06\u4ece<code>(%rbx,%rax,1)</code>\u5730\u5740\u5904\u8bfb\u53d6\u7684\u5b57\u8282\u6570\u636e\u8fdb\u884c\u96f6\u6269\u5c55\uff0c\u5e76\u5c06\u7ed3\u679c\u5b58\u50a8\u5230ECX\u5bc4\u5b58\u5668\u4e2d\u3002</p> <p><pre><code>   0x000000000040108b &lt;+41&gt;:    movzbl (%rbx,%rax,1),%ecx\n   0x000000000040108f &lt;+45&gt;:    mov    %cl,(%rsp)\n   0x0000000000401092 &lt;+48&gt;:    mov    (%rsp),%rdx\n   0x0000000000401096 &lt;+52&gt;:    and    $0xf,%edx\n   0x0000000000401099 &lt;+55&gt;:    movzbl 0x4024b0(%rdx),%edx\n   0x00000000004010a0 &lt;+62&gt;:    mov    %dl,0x10(%rsp,%rax,1)\n   0x00000000004010a4 &lt;+66&gt;:    add    $0x1,%rax\n   0x00000000004010a8 &lt;+70&gt;:    cmp    $0x6,%rax\n   0x00000000004010ac &lt;+74&gt;:    jne    0x40108b &lt;phase_5+41&gt;\n</code></pre> \u5728x86\u67b6\u6784\u7684\u6c47\u7f16\u8bed\u8a00\u4e2d\uff0c<code>%cl</code> \u662f<code>%ecx</code> \u5bc4\u5b58\u5668\u7684\u4f4e8\u4f4d\u90e8\u5206\u3002</p> <p>\u53ef\u5206\u6790\u5f97\u5230 <pre><code>char *str = \"maduiersnfotvbyl\";\nchar *rdi = \"123456\";\nchar *rbx = rdi;\n  for (int rax = 0; rax &lt; 6; rax++) {\n    char ecx = rbx[rax];\n    int edx = ecx &amp; 0xf;\n    edx = str[edx];\n    rsp[16+rax] = edx;\n  }\n</code></pre></p> <p><pre><code>   0x00000000004010b3 &lt;+81&gt;:    mov    $0x40245e,%esi\n=&gt; 0x00000000004010b8 &lt;+86&gt;:    lea    0x10(%rsp),%rdi\n</code></pre> \u4e0e\u5b57\u7b26\u4e32<code>flyers</code> \u8fdb\u884c\u6bd4\u8f83</p> <p>\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u9700\u8981\u7684\u5b57\u7b26<code>flyers</code>\u7684\u7d22\u5f15\u5206\u522b\u4e3a<code>9 15 14 5 6 7</code>\u3002\u8fd9\u4e2a\u7d22\u5f15\u5c31\u662f\u6211\u4eec\u8f93\u5165\u7684\u5b57\u7b26\u7684\u4f4e4\u4f4d\uff0c\u90a3\u6211\u4eec\u53ea\u8981\u627e\u5230\u4f4e4\u4f4d\u5206\u522b\u662f\u4ee5\u4e0a\u6570\u503c\u7684\u5b57\u7b26\u5c31\u53ef\u4ee5\u4e86\u3002</p> <p>\u6240\u4ee5\u9636\u6bb55\u7684\uff08\u4e00\u4e2a\uff09\u7b54\u6848\u4e3a\uff1a</p> <pre><code>ionefg\n</code></pre> <p>phase 6</p> <p><pre><code>   0x00000000004010f4 &lt;+0&gt;:     push   %r14\n   0x00000000004010f6 &lt;+2&gt;:     push   %r13\n   0x00000000004010f8 &lt;+4&gt;:     push   %r12\n   0x00000000004010fa &lt;+6&gt;:     push   %rbp\n   0x00000000004010fb &lt;+7&gt;:     push   %rbx\n   0x00000000004010fc &lt;+8&gt;:     sub    $0x50,%rsp\n   0x0000000000401100 &lt;+12&gt;:    mov    %rsp,%r13\n   0x0000000000401103 &lt;+15&gt;:    mov    %rsp,%rsi\n   0x0000000000401106 &lt;+18&gt;:    callq  0x40145c &lt;read_six_numbers&gt;\n</code></pre> \u8f93\u51656\u4e2a\u6570\u5b57</p> <pre><code>(gdb) x /s $rsi\n0x603910 &lt;input_strings+400&gt;:   \"1 2 3 4 5 6\"\n</code></pre> <p>r13 = rsp</p> <p>r14 = rsp r12d = 0</p> <p><pre><code>   0x0000000000401117 &lt;+35&gt;:    mov    0x0(%r13),%eax // eax == num\n   0x000000000040111b &lt;+39&gt;:    sub    $0x1,%eax\n   0x000000000040111e &lt;+42&gt;:    cmp    $0x5,%eax\n   0x0000000000401121 &lt;+45&gt;:    jbe    0x401128 &lt;phase_6+52&gt;\n   0x0000000000401123 &lt;+47&gt;:    callq  0x40143a &lt;explode_bomb&gt;\n   0x0000000000401128 &lt;+52&gt;:    add    $0x1,%r12d\n</code></pre> \u53ef\u77e5num - 1 &lt;= 5  \u5373 num &lt;= 6</p> <pre><code>   0x0000000000401128 &lt;+52&gt;:    add    $0x1,%r12d \n   0x000000000040112c &lt;+56&gt;:    cmp    $0x6,%r12d // $r12d == 1\n   0x0000000000401130 &lt;+60&gt;:    je     0x401153 &lt;phase_6+95&gt;\n   0x0000000000401132 &lt;+62&gt;:    mov    %r12d,%ebx // $ebx = $r12d = 1\n   0x0000000000401135 &lt;+65&gt;:    movslq %ebx,%rax\n   0x0000000000401138 &lt;+68&gt;:    mov    (%rsp,%rax,4),%eax//rsp+4 -&gt; $eax==num2\n   0x000000000040113b &lt;+71&gt;:    cmp    %eax,0x0(%rbp) // cmp num2, num1\n   0x000000000040113e &lt;+74&gt;:    jne    0x401145 &lt;phase_6+81&gt;\n   0x0000000000401140 &lt;+76&gt;:    callq  0x40143a &lt;explode_bomb&gt;\n</code></pre> <p>\u89c2\u5bdf\u53ef\u77e5\u8fd9\u6bb5\u6c47\u7f16\u6784\u6210\u4e86\u4e00\u6bb5\u5faa\u73af <pre><code>   0x0000000000401132 &lt;+62&gt;:    mov    %r12d,%ebx\n   0x0000000000401135 &lt;+65&gt;:    movslq %ebx,%rax\n   0x0000000000401138 &lt;+68&gt;:    mov    (%rsp,%rax,4),%eax\n   0x000000000040113b &lt;+71&gt;:    cmp    %eax,0x0(%rbp)\n   0x000000000040113e &lt;+74&gt;:    jne    0x401145 &lt;phase_6+81&gt;\n   0x0000000000401140 &lt;+76&gt;:    callq  0x40143a &lt;explode_bomb&gt;\n   0x0000000000401145 &lt;+81&gt;:    add    $0x1,%ebx\n   0x0000000000401148 &lt;+84&gt;:    cmp    $0x5,%ebx\n   0x000000000040114b &lt;+87&gt;:    jle    0x401135 &lt;phase_6+65&gt;\n</code></pre></p> <p><pre><code>r12d\nrax = r12d\nfor (ebx = r12d,ebx&lt;=5;ebx++) {\n    rax = ebx;\n    eax = rsp[rax];\n    if(eax == rsp[0])\n        explode_bomb();\n}\n</code></pre> \u6240\u4ee5\u540e\u51e0\u4e2a\u6570\u5b57\u4e0d\u80fd\u548c\u7b2cr12d\u4e2a\u6570\u5b57\u76f8\u7b49</p> <pre><code>   0x000000000040114d &lt;+89&gt;:    add    $0x4,%r13 //num1 --&gt; num2 --&gt; num3 ...\n   0x0000000000401151 &lt;+93&gt;:    jmp    0x401114 &lt;phase_6+32&gt;\n</code></pre> <p>\u5faa\u73af6\u6b21 r12d 0~5 <pre><code>   0x0000000000401128 &lt;+52&gt;:    add    $0x1,%r12d\n   0x000000000040112c &lt;+56&gt;:    cmp    $0x6,%r12d\n   0x0000000000401130 &lt;+60&gt;:    je     0x401153 &lt;phase_6+95&gt;\n</code></pre></p> <p>\u6240\u4ee5\u8981\u6c42\u8f93\u5165\u7684\u5404\u4e2a\u6570\u5b57\u5404\u4e0d\u76f8\u7b49 \u6700\u540e\u4f7f\u5f97 num1 = r13 = num6</p> <p>\u8fd9\u91cc\u53c8\u662f\u4e00\u6bb5\u5faa\u73af <pre><code>   0x0000000000401153 &lt;+95&gt;:    lea    0x18(%rsp),%rsi //rsi == $(rsp+24) \n   0x0000000000401158 &lt;+100&gt;:   mov    %r14,%rax // i = 0\n   0x000000000040115b &lt;+103&gt;:   mov    $0x7,%ecx\n   0x0000000000401160 &lt;+108&gt;:   mov    %ecx,%edx\n   0x0000000000401162 &lt;+110&gt;:   sub    (%rax),%edx //edx -= num[i] ==&gt; 7-num[i]\n   0x0000000000401164 &lt;+112&gt;:   mov    %edx,(%rax) // num[i] = edx\n   0x0000000000401166 &lt;+114&gt;:   add    $0x4,%rax // i++\n   0x000000000040116a &lt;+118&gt;:   cmp    %rsi,%rax // i &lt; 7\n   0x000000000040116d &lt;+121&gt;:   jne    0x401160 &lt;phase_6+108&gt;\n   0x000000000040116f &lt;+123&gt;:   mov    $0x0,%esi\n   0x0000000000401174 &lt;+128&gt;:   jmp    0x401197 &lt;phase_6+163&gt;\n</code></pre></p> <p>\u4f5c\u7528\uff1anum[i] = 7-num[i]</p> <pre><code>   0x0000000000401197 &lt;+163&gt;:   mov    (%rsp,%rsi,1),%ecx // $rsi == 0\n   0x000000000040119a &lt;+166&gt;:   cmp    $0x1,%ecx\n   0x000000000040119d &lt;+169&gt;:   jle    0x401183 &lt;phase_6+143&gt;\n</code></pre> <p><pre><code>   0x0000000000401195 &lt;+161&gt;:   je     0x4011ab &lt;phase_6+183&gt;\n   0x0000000000401197 &lt;+163&gt;:   mov    (%rsp,%rsi,1),%ecx\n   0x000000000040119a &lt;+166&gt;:   cmp    $0x1,%ecx\n   0x000000000040119d &lt;+169&gt;:   jle    0x401183 &lt;phase_6+143&gt;\n   0x000000000040119f &lt;+171&gt;:   mov    $0x1,%eax\n   0x00000000004011a4 &lt;+176&gt;:   mov    $0x6032d0,%edx\n   0x00000000004011a9 &lt;+181&gt;:   jmp    0x401176 &lt;phase_6+130&gt;\n</code></pre> \u4e0d\u77e5\u9053\u4ec0\u4e48\u7528</p> <pre><code>   0x00000000004011ab &lt;+183&gt;:   mov    0x20(%rsp),%rbx \n   0x00000000004011b0 &lt;+188&gt;:   lea    0x28(%rsp),%rax\n   0x00000000004011b5 &lt;+193&gt;:   lea    0x50(%rsp),%rsi\n   0x00000000004011ba &lt;+198&gt;:   mov    %rbx,%rcx\n   0x00000000004011bd &lt;+201&gt;:   mov    (%rax),%rdx\n   0x00000000004011c0 &lt;+204&gt;:   mov    %rdx,0x8(%rcx)\n   0x00000000004011c4 &lt;+208&gt;:   add    $0x8,%rax\n   0x00000000004011c8 &lt;+212&gt;:   cmp    %rsi,%rax\n   0x00000000004011cb &lt;+215&gt;:   je     0x4011d2 &lt;phase_6+222&gt;\n</code></pre> <p>\u539f\u6765\u662f\u94fe\u8868....</p> <p>answer: <pre><code>6 2 1 5 4 3\n</code></pre></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/data%20lab/","title":"Data lab","text":"<p>-INT_MIN=INT_MIN  \u56e0\u4e3a\u8865\u7801\u7684\u76f8\u53cd\u6570 = \u8865\u7801\u7684\u6309\u4f4d\u53d6\u53cd + 1</p> <p>\u4f4d\u8fd0\u7b97</p> <p>\u76f8\u53cd\u6570</p> <pre><code>~x+1 // -x\n</code></pre> <pre><code>!(\u8d1f\u6570 || \u6b63\u6570) == 0\n\n!(x + ~0x30+1)\n// x - 0x30 &gt; 0\n\n!((x + ~0x30+1) &amp; (1&lt;&lt;31))\n// x - 0x30 &gt;= 0\n// &amp;(1&lt;&lt;31) \u5224\u65adx - 0x30\u7684\u7b26\u53f7\u4f4d\uff0c\u8d1f\u548c\u975e\u8d1f\u4e24\u79cd\u7ed3\u679c\n\n\n!(x &amp; (1&lt;&lt;31))  ==&gt; !(1 || 0)\n</code></pre> <pre><code>~1 ==&gt; 111110 ==+1==&gt; 111111\n~0 ==&gt; 111111 ==+1==&gt; 000000\n</code></pre> <p>\u975e\u89c4\u683c\u5316\u7684\u6d6e\u70b9\u6570 \u5f53\u6307\u6570\u90e8\u5206\u5168\u4e3a0\u65f6\uff0c\u5c3e\u6570\u90e8\u5206\u4e0d\u518d\u9700\u8981\u975e\u96f6\u4f4d\u5f00\u5934\u7684\u8981\u6c42\u3002\u8fd9\u610f\u5473\u7740\u975e\u89c4\u683c\u5316\u6570\u53ef\u4ee5\u8868\u793a\u975e\u5e38\u63a5\u8fd1\u4e8e0\u7684\u5c0f\u6570\u3002</p> <p>NaN ==&gt; \u6307\u6570\u90e8\u5206\u5168\u4e3a1\uff0c\u5c3e\u6570\u90e8\u5206\u4e0d\u5168\u4e3a0</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E5%BC%82%E5%B8%B8/","title":"\u5f02\u5e38","text":""},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E5%BC%82%E5%B8%B8/#_2","title":"\u5f02\u5e38\u63a7\u5236\u6d41","text":"<p>\u5904\u7406\u5668\u8bfb\u53d6\u5e76\u6267\u884c\u5185\u5b58\u4e2d\u7684\u8fde\u7eed\u6307\u4ee4\uff0c\u79f0\u4e3a\u63a7\u5236\u6d41(Control Flow)\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u63a7\u5236\u6d41\u4e00\u6761\u63a5\u7740\u4e00\u6761\u6307\u4ee4\u6267\u884c\u3002\u8df3\u8f6c\u548c\u51fd\u6570\u8c03\u7528\u662f\u7a0b\u5e8f\u6539\u53d8\u63a7\u5236\u6d41\u7684\u65b9\u5f0f\uff0c\u800c\u7cfb\u7edf\u6539\u53d8\u63a7\u5236\u6d41\u7684\u65b9\u5f0f\u5219\u53eb\u4f5c\u5f02\u5e38\u63a7\u5236\u6d41(Exceptional Control Flow)\uff0c\u5728\u78c1\u76d8/\u7f51\u7edc\u6570\u636e\u5230\u8fbe\uff0c\u96640\uff0c\u7cfb\u7edf\u8ba1\u65f6\u5668\u8fc7\u671f\uff0c\u952e\u76d8\u6309\u4e0bCtrl+C\u7b49\u60c5\u51b5\u5f15\u53d1\u3002\u5f02\u5e38\u63a7\u5236\u6d41\u7684\u5e94\u7528\u5305\u62ec\u5f02\u5e38(Exception)\uff0c\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362(Process Contex Switch)\uff0c\u4fe1\u53f7(Signals)(\u7eaf\u8f6f\u4ef6\u5b9e\u73b0)\u548c\u975e\u672c\u5730\u8df3\u8f6c(Nonlocal Jumps)(\u7eaf\u8f6f\u4ef6\u5b9e\u73b0)\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E5%BC%82%E5%B8%B8/#_3","title":"\u5f02\u5e38","text":"<p>\u5f02\u5e38\u53d1\u751f\u65f6\uff0c\u63a7\u5236\u6d41\u4ece\u7528\u6237\u7a0b\u5e8f\u8f6c\u79fb\u5230\u5185\u6838\uff0c\u54cd\u5e94\u7cfb\u7edf\u4e8b\u4ef6\u3002\u6ce8\u610f\u5185\u6838\u4e0d\u662f\u5355\u72ec\u5b58\u5728\u7684\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u800c\u662f\u8fdb\u7a0b\u7684\u4e00\u90e8\u5206\uff0c\u5e38\u9a7b\u5728\u5185\u5b58\u7a7a\u95f4\u7684\u9876\u90e8\uff0c\u7528\u4e8e\u7ba1\u7406\u7cfb\u7edf\u8d44\u6e90\u3002\u5f02\u5e38\u7531\u786c\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\u534f\u4f5c\u5b9e\u73b0\uff0c\u4e00\u822c\u5f02\u5e38\u7531\u786c\u4ef6\u5f15\u53d1\uff0c\u4f46\u7531\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u8f6f\u4ef6\u6765\u5904\u7406\u3002\u5185\u5b58\u7684\u67d0\u5904\u5b58\u50a8\u4e86\u4e00\u4e2a\u5f02\u5e38\u8df3\u8f6c\u8868\uff0c\u8bb0\u5f55\u5f02\u5e38\u7f16\u53f7\u5230\u5904\u7406\u51fd\u6570\u7684\u6620\u5c04\u3002</p> <ul> <li> <p>\u4e2d\u65ad(Interrupt)\uff1a\u6765\u81ea\u5904\u7406\u5668\u5916\u90e8\u7684\u5f02\u5e38\u79f0\u4f5c\u5f02\u6b65\u5f02\u5e38(Asynchronous Exception)\uff0c\u4e5f\u79f0\u4f5c\u4e2d\u65ad\u3002\u5f15\u53d1\u4e2d\u65ad\u7684\u4e8b\u4ef6\u4e00\u822c\u7531\u5904\u7406\u5668\u5f15\u811a\u7535\u5e73\u7684\u53d8\u5316\u5bfc\u81f4\uff0c\u6bd4\u5982\u6570\u636e\u5230\u8fbe\u6216\u952e\u76d8\u6309\u4e0bCtrl+C\u3002\u7cfb\u7edf\u65e0\u6cd5\u9884\u6d4b\u4e2d\u65ad\u4f55\u65f6\u5230\u6765\uff0c\u6240\u4ee5\u662f\u5f02\u6b65\u7684\u3002</p> </li> <li> <p>\u9677\u5165(Traps)\uff1a\u7a0b\u5e8f\u6267\u884c\u7cfb\u7edf\u8c03\u7528(syscall) \u7684\u65b9\u5f0f\u3002\u5185\u6838\u7684\u4ee3\u7801\u4e0e\u8d44\u6e90\u662f\u7528\u6237\u7ea7\u7a0b\u5e8f\u65e0\u6cd5\u8bbf\u95ee\u7684\u3002\u4e3a\u4e86\u8bf7\u6c42\u7cfb\u7edf\u8d44\u6e90\uff0c\u7528\u6237\u7ea7\u7a0b\u5e8f\u4e3b\u52a8\u53d1\u8d77\u4e00\u4e2a\u5f02\u5e38\uff0c\u4f7f\u63a7\u5236\u6d41\u5207\u6362\u5230\u5185\u6838\u72b6\u6001\uff0c\u8c03\u7528\u7cfb\u7edf\u8d44\u6e90\u3002\u7cfb\u7edf\u5e93\u63d0\u4f9b\u7684\u51fd\u6570\uff0c\u5982open\uff0cread\u7b49\uff0c\u5b9e\u9645\u4e0a\u662f\u7cfb\u7edf\u8c03\u7528\u7684\u5c01\u88c5\u3002</p> </li> <li> <p>\u6545\u969c(Faults)\uff1a\u7528\u6237\u7ea7\u7a0b\u5e8f\u6267\u884c\u67d0\u6761\u6307\u4ee4\u65f6\u53d1\u751f\u9519\u8bef\uff0c\u6bd4\u5982\u96640\uff0c\u7f3a\u9875\uff0c\u6bb5\u9519\u8bef(Segmentation Fault)\u7b49\u5f15\u53d1\u5f02\u5e38\uff0c\u6709\u4e9b\u662f\u53ef\u6062\u590d\u7684\uff0c\u6bd4\u5982\u7f3a\u9875\uff0c\u6062\u590d\u5f02\u5e38\u65f6\uff0c\u8fd9\u6761\u6307\u4ee4\u91cd\u65b0\u6267\u884c\u3002     \uff1b\u6709\u4e9b\u5219\u4e0d\u53ef\uff0c\u5982\u6bb5\u9519\u8bef\uff0c\u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u4e2d\u6b62(Abort)\u3002</p> </li> </ul> <p>\u4e0b\u56fe\u662f\u901a\u8fc7\u9677\u5165\u8fdb\u884copen\u7cfb\u7edf\u8c03\u7528\u7684\u4f8b\u5b50\u3002\u628a\u7cfb\u7edf\u8c03\u7528\u7684\u7f16\u53f7\u5199\u5165%rax\uff0c<code>syscall</code>\u6307\u4ee4\u5f15\u53d1\u9677\u5165\uff0c\u8fd4\u56de\u65f6\u6587\u4ef6\u63cf\u8ff0\u7b26\u653e\u5728%rax\u4e2d\u3002</p> <p></p> <p>\u4e0b\u56fe\u662f\u7f3a\u9875\u5f15\u53d1\u53ef\u6062\u590d\u6545\u969c\u7684\u4f8b\u5b50\u3002\u7a0b\u5e8f\u8bbf\u95ee\u5730\u57400x8049d10\uff0c\u4f46\u662f\u8be5\u5730\u5740\u5e76\u4e0d\u53ef\u7528\uff0c\u56e0\u4e3a\u8be5\u5730\u5740\u6ca1\u6709\u4ece\u78c1\u76d8\u4ea4\u6362\u5230\u5185\u5b58(\u5173\u4e8e\u4ea4\u6362\uff0c\u53c2\u8003\u865a\u62df\u5185\u5b58)\u3002\u5f15\u53d1\u7f3a\u9875\u6545\u969c\u540e\uff0c\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u5c1d\u8bd5\u4ea4\u6362\u3002\u6210\u529f\u540e\uff0c\u56de\u5230\u8be5\u6307\u4ee4\u91cd\u65b0\u6267\u884c\uff0c\u8fd9\u6b21\u5c31\u4e0d\u4f1a\u5f15\u53d1\u6545\u969c\u4e86\u3002</p> <p></p> <p>\u4e0b\u56fe\u662f\u8bbf\u95ee\u65e0\u6548\u5185\u5b58\u5730\u5740\u5f15\u53d1\u4e0d\u53ef\u6062\u590d\u6545\u969c\u7684\u4f8b\u5b50\u3002\u7a0b\u5e8f\u8bbf\u95ee\u5730\u57400x804e360\uff0c\u7531\u4e8e\u8be5\u5730\u5740\u4e0d\u53ef\u7528\uff0c\u540c\u6837\u5f15\u53d1\u4e86\u7f3a\u9875\u6545\u969c\u3002\u4f46\u662f\u5f02\u5e38\u5904\u7406\u7a0b\u5e8f\u7684\u4ea4\u6362\u5c1d\u8bd5\u5931\u8d25\uff0c\u4e8e\u662f\u5411\u7a0b\u5e8f\u53d1\u9001SIGSEGV\u4e2d\u6b62\u3002</p> <p></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E5%BC%82%E5%B8%B8/#_4","title":"\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362","text":"<p>\u8fdb\u7a0b\u662f\u7a0b\u5e8f\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5b9e\u4f8b\u5316\uff0c\u56e0\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\u53ea\u5b58\u50a8\u4e00\u4efd\u5728\u78c1\u76d8\u4e2d\uff0c\u800c\u53ef\u6267\u884c\u6587\u4ef6\u53ef\u4ee5\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u7684\u4e0d\u540c\u4f4d\u7f6e\u4ea7\u751f\u591a\u4e2a\u8fdb\u7a0b\u3002\u64cd\u4f5c\u7cfb\u7edf\u4e3a\u8fdb\u7a0b\u63d0\u4f9b\u4e86\u4e24\u4e2a\u62bd\u8c61\uff1a\u903b\u8f91\u63a7\u5236\u6d41(Logical Control Flow\uff0c\u5373\u8c8c\u4f3c\u72ec\u5360\u7684CPU\u8d44\u6e90) \u548c \u79c1\u6709\u7684\u5730\u5740\u7a7a\u95f4(\u865a\u62df\u5185\u5b58)\u3002</p> <p>\u6bcf\u4e2a\u8fdb\u7a0b\u62e5\u6709\u4e00\u5957\u76f8\u4e92\u72ec\u7acb\u4e14\u79c1\u6709\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5bc4\u5b58\u5668\u503c\u7684\u4e0a\u4e0b\u6587\u73af\u5883\u3002\u4e0a\u4e0b\u6587\u5207\u6362\u6307\u7684\u662f\u5904\u7406\u5668\u5728\u8fd9\u4e9b\u73af\u5883\u95f4\u5207\u6362\u3002\u7531\u4e8e\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u591a\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u5728\u5904\u7406\u5668\u4e0a\u5e76\u53d1(Concurrent) \u8fd0\u884c\u3002\u6211\u4eec\u5c06\u5e76\u53d1\u5b9a\u4e49\u4e3a\u903b\u8f91\u63a7\u5236\u6d41\u7684\u91cd\u53e0\uff0c\u4e0e\u6838\u5fc3\u6570\u65e0\u5173\u3002\u5373\u4f7f\u5728\u5355\u6838\u5904\u7406\u5668\u4e0a\uff0c\u8fdb\u7a0b\u4e5f\u53ef\u4ee5\u5e76\u53d1\u8fd0\u884c\u3002\u4e0b\u9762\u7b2c\u4e8c\u5f20\u56fe\uff0c\u8fdb\u7a0bA\u4e0e\u8fdb\u7a0bB\u662f\u5e76\u53d1\u7684\uff0c\u8fdb\u7a0bA\u4e0e\u8fdb\u7a0bC\u662f\u5e76\u53d1\u7684\uff0c\u4f46\u8fdb\u7a0bB\u4e0e\u8fdb\u7a0bC\u4e0d\u662f\u5e76\u53d1\u7684\u3002</p> <p></p> <p></p> <p>\u4e0a\u4e0b\u6587\u5207\u6362\u901a\u8fc7\u786c\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7edf\u8f6f\u4ef6\u534f\u4f5c\u5b8c\u6210\u3002\u786c\u4ef6\u5b9a\u65f6\u5668\u8fc7\u671f\u65f6\u5411\u5904\u7406\u5668\u53d1\u9001\u4e2d\u65ad\uff0c\u4e3a\u4e86\u63a5\u6536\u5b9a\u65f6\u5668\u4e2d\u65ad\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5c06\u8fdb\u7a0b\u5207\u6362\u5230\u5185\u6838\u6001\u3002\u6b64\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u53ef\u4ee5\u51b3\u5b9a\u662f\u5426\u5207\u6362\u4e0a\u4e0b\u6587\u3002\u800c\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6267\u884c\u987a\u5e8f\u662f\u4e0d\u53ef\u9884\u6d4b\u7684\uff0c\u5c06\u591a\u4e2a\u8fdb\u7a0b\u7684\u5404\u6761\u8bed\u53e5\u8fdb\u884c\u62d3\u6251\u6392\u5e8f\uff0c\u6bcf\u79cd\u6392\u5e8f\u7ed3\u679c\u90fd\u662f\u4e00\u79cd\u6267\u884c\u987a\u5e8f\u7684\u53ef\u80fd\u6027\u3002</p> <p></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E5%BC%82%E5%B8%B8/#_5","title":"\u8fdb\u7a0b\u7f16\u7a0b\u5b9e\u8df5","text":"<p>Linux\u7cfb\u7edf\u7528\u4e8e\u8fdb\u7a0b\u64cd\u4f5c\u7684\u51fd\u6570\u5982\u4e0b\uff1a</p> <pre><code>pid_t fork(void);\nvoid exit(int status);\npid_t wait(int *status);\npid_t waitpid(pid_t pid, int *status, int options);e\nint execve(const char *filename, char *const argv[], char *const envp[]);\n</code></pre> <p>\u5b50\u8fdb\u7a0b\u6267\u884c\u5b8c\u540e\u53d8\u6210\u50f5\u5c38\u8fdb\u7a0b(Zombie)\uff0c\u9700\u8981\u7236\u8fdb\u7a0b\u56de\u6536\u8d44\u6e90\u3002\u5982\u679c\u7236\u8fdb\u7a0b\u6bd4\u5b50\u8fdb\u7a0b\u66f4\u65e9\u9000\u51fa\uff0c\u5b50\u8fdb\u7a0b\u6210\u4e3ainit\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\uff0c\u88ab\u81ea\u52a8\u56de\u6536\u3002\u5982\u679c\u7236\u8fdb\u7a0b\u4e00\u76f4\u4e0d\u9000\u51fa\uff0c\u50f5\u5c38\u5b50\u8fdb\u7a0b\u5728\u5185\u5b58\u4e2d\u8d8a\u79ef\u8d8a\u591a\uff0c\u5c06\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E5%BC%82%E5%B8%B8/#_6","title":"\u4fe1\u53f7","text":"<p>\u4fe1\u53f7\u662f\u4e00\u79cd\u7cfb\u7edf\u53d1\u9001\u7ed9\u8fdb\u7a0b\u7684\u6d88\u606f\uff0c\u544a\u77e5\u8fdb\u7a0b\u7cfb\u7edf\u4e2d\u53d1\u751f\u4e86\u67d0\u79cd\u4e8b\u4ef6\u3002\u4fe1\u53f7\u7684\u7f16\u53f7(\u4e00\u4e2a\u6574\u6570)\u51b3\u5b9a\u5b83\u7684\u79cd\u7c7b\uff0c\u7531\u5185\u6838\u53d1\u9001\u7ed9\u7528\u6237\u7a0b\u5e8f\uff0c\u5728\u7528\u6237\u6001\u6267\u884c\u4fe1\u53f7\u5904\u7406\u4ee3\u7801\u3002\u4fe1\u53f7\u5904\u7406\u6709\u6355\u83b7\uff0c\u5ffd\u7565\u548c\u4e2d\u6b62\u4e09\u79cd\u65b9\u5f0f\u3002\u5982\u679c\u7528\u6237\u7a0b\u5e8f\u6ca1\u6709\u6355\u83b7\u5e76\u5b9a\u4e49\u4fe1\u53f7\u5904\u7406\u51fd\u6570\uff0c\u5219\u4f7f\u7528\u9884\u5b9a\u4e49\u7684\u9ed8\u8ba4\u5904\u7406\u65b9\u5f0f\u3002\u4fe1\u53f7\u4ece\u53d1\u9001\u5230\u63a5\u6536\u5206\u6210\u4e86\u4ee5\u4e0b\u51e0\u4e2a\u9636\u6bb5\uff1a</p> <ol> <li> <p>\u5185\u6838\u4f20\u9012\u4fe1\u53f7</p> </li> <li> <p>\u68c0\u67e5\u8fdb\u7a0b\u662f\u5426\u963b\u585e\u4fe1\u53f7</p> </li> <li> <p>\u8fdb\u7a0b\u72b6\u6001\u6807\u8bb0\u67d0\u4e9b\u4f4d\uff0c\u8868\u793a\u4fe1\u53f7\u5f85\u5904\u7406</p> </li> <li> <p>\u4e0a\u4e0b\u6587\u5207\u6362\u5230\u8fdb\u7a0b\u63a5\u6536\u4fe1\u53f7\uff0c\u8c03\u7528\u4fe1\u53f7\u5904\u7406\u51fd\u6570</p> </li> <li> <p>\u6e05\u9664\u8fdb\u7a0b\u72b6\u6001\u4e2d\u6807\u8bb0\u7684\u4f4d</p> </li> </ol> <p>\u7531\u4e8e\u5f85\u5904\u7406\u4fe1\u53f7\u53ea\u901a\u8fc7\u8fdb\u7a0b\u72b6\u6001\u4e2d\u7684\u4e00\u4e2a\u4f4d\u8868\u793a\uff0c\u6240\u4ee5\u4fe1\u53f7\u662f\u4e0d\u4f1a\u6392\u961f\u7684\uff0c\u5373\u65b0\u7684\u540c\u79cd\u4fe1\u53f7\u5728\u539f\u6709\u4fe1\u53f7\u88ab\u5904\u7406\u4e4b\u524d\u6765\u5230\uff0c\u8be5\u79cd\u4fe1\u53f7\u4e5f\u53ea\u88ab\u5904\u7406\u4e00\u6b21\u3002</p> <p>\u88ab\u963b\u585e\u7684\u4fe1\u53f7\u5c06\u6682\u65f6\u65e0\u6cd5\u5728\u8fdb\u7a0b\u72b6\u6001\u4e2d\u6807\u8bb0\uff0c\u6807\u8bb0\u8fdb\u7a0b\u72b6\u6001\u7684\u64cd\u4f5c\u88ab\u5ef6\u8fdf\u5230\u963b\u585e\u53d6\u6d88\u540e\u8fdb\u884c\u3002\u67d0\u79cd\u4fe1\u53f7\u7684\u5904\u7406\u51fd\u6570\u6267\u884c\u671f\u95f4\uff0c\u8be5\u79cd\u4fe1\u53f7\u88ab\u963b\u585e\uff0c\u4f46\u5176\u4ed6\u4fe1\u53f7\u4e0d\u53d7\u5f71\u54cd\uff0c\u79f0\u4f5c\u9690\u5f0f\u7684\u4fe1\u53f7\u963b\u585e\u3002\u6240\u4ee5\uff0c\u5728\u6267\u884c\u67d0\u79cd\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u65f6\uff0c\u53ef\u80fd\u8df3\u8f6c\u5230\u53e6\u4e00\u79cd\u4fe1\u53f7\u7684\u5904\u7406\u51fd\u6570\uff0c\u4f46\u4e0d\u53ef\u80fd\u518d\u4e00\u6b21\u8fdb\u5165\u540c\u79cd\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u3002</p> <p></p> <p>\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u51e0\u79cd\u65b9\u5f0f\u53d1\u9001\u4fe1\u53f7\uff1a</p> <ul> <li> <p><code>kill -&lt;signum&gt; &lt;pid&gt;</code>\uff0c\u5f53pid\u4e3a\u8d1f\u6570\uff0c\u8868\u793agpid</p> </li> <li> <p>\u952e\u76d8\u6309\u4e0bCtrl+C\u7ed9\u524d\u53f0\u8fdb\u7a0b\u7ec4\u53d1\u9001SIGINT\uff0cCtrl+Z\u53d1\u9001SIGSTP</p> </li> <li> <p><code>kill</code>\u51fd\u6570</p> </li> </ul> <p>\u8fdb\u7a0b\u4e3b\u51fd\u6570\u7684\u903b\u8f91\u63a7\u5236\u6d41\u4e0e\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u4e5f\u662f\u5e76\u53d1\u7684\u3002\u4f46\u662f\u4e0e\u591a\u8fdb\u7a0b\u5e76\u53d1\u4e0d\u540c\uff0c\u8fdb\u7a0b\u7684\u4e3b\u51fd\u6570\u4e0e\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u662f\u5171\u7528\u5185\u5b58\u7a7a\u95f4\u7684\u3002\u6240\u4ee5\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u4e5f\u5b58\u5728\u5e76\u53d1\u7f16\u7a0b\u4e2d\u6b7b\u9501\uff0c\u540c\u6b65\u4e00\u81f4\u6027\u7b49\u95ee\u9898\u3002\u4e3a\u4e86\u9632\u6b62\u8fd9\u4e9b\u95ee\u9898\u53d1\u751f\uff0c\u53ef\u4ee5\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\u5199\u5b89\u5168\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\uff1a</p> <ul> <li> <p>\u4f7f\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u5c3d\u91cf\u7b80\u5355\uff0c\u6bd4\u5982\u8bbe\u7f6e\u4e00\u4e2a\u5168\u5c40\u6807\u8bb0\u540e\u9a6c\u4e0a\u8fd4\u56de</p> </li> <li> <p>\u5728\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u4e2d\u53ea\u8c03\u7528\u53ef\u91cd\u5165\u51fd\u6570(Reentrant Function)\u3002\u5f02\u6b65\u5b89\u5168\u51fd\u6570\u6307(\u6ca1\u6709\u4f7f\u7528\u5168\u5c40/\u51fd\u6570\u9759\u6001\u53d8\u91cf\uff0c\u6240\u7528\u53d8\u91cf\u5b58\u50a8\u5728\u6808\u4e0a)\uff0c\u6216\u65e0\u6cd5\u88ab\u4fe1\u53f7\u4e2d\u65ad\u7684\u51fd\u6570\u3002\u5f02\u6b65\u5b89\u5168\u7684\u51fd\u6570\u5305\u62ec<code>_exit</code>\uff0c<code>write</code>\uff0c<code>wait</code>\uff0c<code>waitpid</code>\uff0c<code>sleep</code>\uff0c<code>kill</code>\u7b49\uff1b\u800c\u5e38\u7528\u7684\u5f02\u6b65\u4e0d\u5b89\u5168\u51fd\u6570\u6709<code>printf</code>\uff0c<code>sprintf</code>\uff0c<code>exit</code>\uff0c<code>malloc</code>\u7b49\u3002\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u4e2d\u4e0d\u5e94\u8be5\u4f7f\u7528\u5f02\u6b65\u4e0d\u5b89\u5168\u51fd\u6570\uff1b</p> </li> <li> <p>\u5728\u8fdb\u5165\u548c\u9000\u51fa\u4fe1\u53f7\u5b89\u5168\u51fd\u6570\u65f6\u5206\u522b\u4fdd\u5b58\u548c\u6062\u590d\u5168\u5c40\u53d8\u91cferrno</p> </li> <li> <p>\u8bbf\u95ee\u5171\u4eab\u6570\u636e\u524d\u963b\u585e\u4fe1\u53f7\u5b9e\u73b0\u4fdd\u62a4\u8bfb/\u5199</p> </li> <li> <p>\u5171\u4eab\u7684\u5168\u5c40\u53d8\u91cf\u58f0\u660e\u4e3a<code>volatile</code>\uff0c\u58f0\u660e\u540e\u53d8\u91cf\u5c06\u4e0d\u4f1a\u7f13\u5b58\u5230\u5bc4\u5b58\u5668\u4e2d\u800c\u5bfc\u81f4\u4e0d\u4e00\u81f4\u95ee\u9898\u3002\u5178\u578b\u5e94\u7528\u662f\u5728\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u8bbe\u7f6e\u5168\u5c40\u6807\u8bb0\uff0c\u4e3b\u51fd\u6570\u4e2dwhile\u5faa\u73af\u5fd9\u7b49\u8be5\u6807\u8bb0\uff0c\u5219\u8be5\u6807\u8bb0\u8981\u58f0\u660e\u4e3a<code>volatile</code>\u3002\u5982\u679c\u8be5\u6807\u8bb0\u7f13\u5b58\u5230\u5bc4\u5b58\u5668\u4e2d\uff0c\u5219\u4e3b\u51fd\u6570\u6c38\u8fdc\u4e0d\u80fd\u505c\u6b62\u5faa\u73af\u3002</p> </li> <li> <p>\u5171\u4eab\u7684\u5168\u5c40\u6807\u8bb0\u58f0\u660e\u4e3a<code>volatile sig_atomic_t</code>\uff0c\u5927\u591a\u6570\u7cfb\u7edf\u7684<code>sig_atomic_t</code>\u7c7b\u578b\u5927\u5c0f\u7b49\u540c<code>int</code>\uff0c\u4f46\u662f\u8bfb\u5199\u64cd\u4f5c\u662f\u4e0d\u53ef\u4e2d\u65ad\u7684\u3002</p> </li> </ul>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/","title":"\u865a\u62df\u5185\u5b58","text":"<p>\u53c2\u8003\uff1a\u3010\u8bfb\u8584 CSAPP\u3011\u67d2 \u865a\u62df\u5185\u5b58\u4e0e\u52a8\u6001\u5185\u5b58\u5206\u914d | \u5c0f\u571f\u5200 2.0</p> <p>\u64cd\u4f5c\u7cfb\u7edf\u5c06\u7269\u7406\u5185\u5b58\u5212\u5206\u4e3a\u56fa\u5b9a\u5927\u5c0f\u7684\u9875\u9762\uff08\u901a\u5e38\u662f4KB\u62168KB\uff09\uff0c\u5e76\u5c06\u5176\u6620\u5c04\u5230\u78c1\u76d8\u4e0a\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u9875\u9762\u6587\u4ef6\u4e2d\u3002\u8fd9\u4e9b\u9875\u9762\u6587\u4ef6\u53ef\u4ee5\u662f\u9884\u5148\u8bbe\u7f6e\u7684\u4ea4\u6362\u6587\u4ef6\u6216\u9875\u9762\u4ea4\u6362\u6587\u4ef6\u3002</p> <p>\u5f53\u7a0b\u5e8f\u9700\u8981\u66f4\u591a\u7684\u5185\u5b58\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5c06\u5f53\u524d\u672a\u4f7f\u7528\u7684\u7269\u7406\u5185\u5b58\u9875\u9762\u79fb\u52a8\u5230\u78c1\u76d8\u4e0a\u7684\u9875\u9762\u6587\u4ef6\u4e2d\uff0c\u5e76\u5c06\u7a0b\u5e8f\u6240\u9700\u7684\u65b0\u9875\u9762\u52a0\u8f7d\u5230\u7269\u7406\u5185\u5b58\u4e2d\u3002\u8fd9\u6837\uff0c\u7a0b\u5e8f\u5c31\u80fd\u591f\u7ee7\u7eed\u6267\u884c\uff0c\u5c3d\u7ba1\u5b9e\u9645\u4e0a\u5b83\u53ea\u80fd\u770b\u5230\u81ea\u5df1\u7684\u865a\u62df\u5185\u5b58\uff0c\u800c\u4e0d\u9700\u8981\u5173\u5fc3\u7269\u7406\u5185\u5b58\u7684\u9650\u5236\u3002</p> <p></p> <p>\u865a\u62df\u5185\u5b58\u5c31\u662f\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684 N \u4e2a\u8fde\u7eed\u5b57\u8282\u7684\u6570\u7ec4 \u90e8\u5206\u5185\u5bb9\u4f1a\u7f13\u5b58\u5728DRAM\u4e2d\u3002 \u5728DRAM\u4e2d\u7684\u6bcf\u4e2a\u7f13\u5b58\u5757(cache block)\u79f0\u4e3a \u9875(page)</p> <p>\u6bcf\u4e2a\u9875\u8868\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u79f0\u4e3a\u9875\u8868\u9879(PTE, page table entry)\uff0c\u6bcf\u4e2a\u9875\u8868\u9879\u8d1f\u8d23\u628a\u865a\u62df\u9875\u6620\u5c04\u5230\u7269\u7406\u9875\u4e0a\u3002\u5728 DRAM \u4e2d\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u9875\u8868\uff0c\u5177\u4f53\u5982\u4e0b</p> <p></p> <p>\u865a\u62df\u5185\u5b58\u9875\u8868\u5b58\u50a8\u5728\u64cd\u4f5c\u7cfb\u7edf\u7684\u5185\u6838\u7a7a\u95f4\u4e2d\uff0c\u7531 \u9875\u76ee\u5f55 \u548c \u9875\u8868 \u7ec4\u6210\uff0c\u5e76\u901a\u8fc7\u7279\u5b9a\u7684\u7d22\u5f15\u65b9\u5f0f\u5b9e\u73b0\u865a\u62df\u5730\u5740\u5230\u7269\u7406\u5730\u5740\u7684\u6620\u5c04\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/#_2","title":"\u4f5c\u4e3a\u5185\u5b58\u7ba1\u7406\u5de5\u5177","text":"<p>\u524d\u9762\u63d0\u5230\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\uff0c\u8fd9\u6837\u4e00\u6765\uff0c\u5bf9\u4e8e\u8fdb\u7a0b\u6765\u8bf4\uff0c\u5b83\u4eec\u770b\u5230\u7684\u5c31\u662f\u7b80\u5355\u7684\u7ebf\u6027\u7a7a\u95f4\uff08\u4f46\u5b9e\u9645\u4e0a\u5728\u7269\u7406\u5185\u5b58\u4e2d\u53ef\u80fd\u662f\u95f4\u9694\u3001\u652f\u79bb\u7834\u788e\u7684\uff09\uff0c\u5177\u4f53\u7684\u6620\u5c04\u8fc7\u7a0b\u53ef\u4ee5\u7528\u4e0b\u56fe\u8868\u793a\uff1a</p> <p></p> <p>\u5728\u5185\u5b58\u5206\u914d\u4e2d\u6ca1\u6709\u592a\u591a\u9650\u5236\uff0c\u6bcf\u4e2a\u865a\u62df\u9875\u90fd\u53ef\u4ee5\u88ab\u6620\u5c04\u5230\u4efb\u4f55\u7684\u7269\u7406\u9875\u4e0a\u3002\u8fd9\u6837\u4e5f\u5e26\u6765\u4e00\u4e2a\u597d\u5904\uff0c\u5982\u679c\u4e24\u4e2a\u8fdb\u7a0b\u95f4\u6709\u5171\u4eab\u7684\u6570\u636e\uff0c\u90a3\u4e48\u76f4\u63a5\u6307\u5411\u540c\u4e00\u4e2a\u7269\u7406\u9875\u5373\u53ef\uff08\u4e5f\u5c31\u662f\u4e0a\u56fe PP 6 \u7684\u72b6\u51b5\uff0c\u53ea\u8bfb\u6570\u636e\uff09</p> <p>\u865a\u62df\u5185\u5b58\u5e26\u6765\u7684\u53e6\u4e00\u4e2a\u597d\u5904\u5c31\u662f\u53ef\u4ee5\u7b80\u5316\u94fe\u63a5\u548c\u8f7d\u5165\u7684\u7ed3\u6784\uff08\u56e0\u4e3a\u6709\u4e86\u7edf\u4e00\u7684\u62bd\u8c61\uff0c\u4e0d\u9700\u8981\u7ea0\u7ed3\u7ec6\u8282\uff09</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/#_3","title":"\u4f5c\u4e3a\u5185\u5b58\u4fdd\u62a4\u5de5\u5177","text":"<p>\u9875\u8868\u4e2d\u7684\u6bcf\u4e2a\u6761\u76ee\u7684\u9ad8\u4f4d\u90e8\u5206\u662f\u8868\u793a\u6743\u9650\u7684\u4f4d\uff0cMMU \u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5\u8fd9\u4e9b\u4f4d\u6765\u8fdb\u884c\u6743\u9650\u63a7\u5236\uff08\u8bfb\u3001\u5199\u3001\u6267\u884c\uff09\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98/#_4","title":"\u5730\u5740\u7ffb\u8bd1","text":"\\[ N=2^{n}, M=2^{m}, P=2^{p} \\] <p>\u5176\u4e2d\u00a0<code>N</code>\u00a0\u8868\u793a\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u5730\u5740\u6570\u91cf\uff0c<code>M</code>\u00a0\u8868\u793a\u7269\u7406\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u5730\u5740\u6570\u91cf\uff0c<code>P</code>\u00a0\u662f\u6bcf\u4e00\u9875\u5305\u542b\u7684\u5b57\u8282\u6570(page size)\u3002</p> <p>\u865a\u62df\u5730\u5740(VA, Virtual Address)\u4e2d\u7684\u5143\u7d20\uff1a</p> <ul> <li><code>TLBI</code>: TLB \u7684\u7d22\u5f15\u503c</li> <li><code>TLBT</code>: TLB \u7684\u6807\u7b7e(tag)</li> <li><code>VPO</code>: \u865a\u62df\u9875\u504f\u79fb\u91cf</li> <li><code>VPN</code>: \u865a\u62df\u9875\u7f16\u53f7</li> </ul> <p>TLB\u539f\u7406 - \u77e5\u4e4e</p> <p>\u7269\u7406\u5730\u5740(PA, physical address)\u4e2d\u7684\u5143\u7d20\uff1a</p> <ul> <li><code>PPO</code>: \u7269\u7406\u9875\u504f\u79fb\u91cf\uff08\u4e0e\u00a0<code>VPO</code>\u00a0\u7684\u503c\u76f8\u540c\uff09</li> <li><code>PPN</code>: \u7269\u7406\u9875\u7f16\u53f7</li> </ul> <p>\u7136\u540e\u6211\u4eec\u901a\u8fc7\u4e00\u4e2a\u5177\u4f53\u7684\u4f8b\u5b50\u6765\u8bf4\u660e\u5982\u4f55\u8fdb\u884c\u5730\u5740\u7ffb\u8bd1</p> <p></p> <p>\u5177\u4f53\u7684\u8bbf\u95ee\u8fc7\u7a0b\u4e3a\uff1a</p> <ul> <li>\u901a\u8fc7\u865a\u62df\u5730\u5740\u627e\u5230\u9875\u8868(page table)\u4e2d\u5bf9\u5e94\u7684\u6761\u76ee</li> <li>\u68c0\u67e5\u6709\u6548\u4f4d(valid bit)\uff0c\u662f\u5426\u9700\u8981\u89e6\u53d1\u9875\u9519\u8bef(page fault)</li> <li>\u7136\u540e\u6839\u636e\u9875\u8868\u4e2d\u7684\u7269\u7406\u9875\u7f16\u53f7(physical page number)\u627e\u5230\u5185\u5b58\u4e2d\u7684\u5bf9\u5e94\u5730\u5740</li> <li>\u6700\u540e\u628a\u865a\u62df\u9875\u504f\u79fb(virtual page offset)\u548c\u524d\u9762\u7684\u5b9e\u9645\u5730\u5740\u62fc\u8d77\u6765\uff0c\u5c31\u662f\u6700\u7ec8\u7684\u7269\u7406\u5730\u5740\u4e86</li> </ul> <p>\u8fd9\u91cc\u53c8\u5206\u4e24\u79cd\u60c5\u51b5\uff1aPage Hit \u548c Page Fault\uff0c\u6211\u4eec\u5148\u6765\u770b\u770b Page Hit \u7684\u60c5\u51b5</p> <p></p> <p>\u4e3b\u8981\u6709 5 \u6b65\uff0cCPU \u9996\u5148\u628a\u865a\u62df\u5730\u5740\u53d1\u9001\u7ed9 MMU\uff0cMMU \u68c0\u67e5\u7f13\u5b58\uff0c\u5e76\u628a\u4ece\u9875\u8868\u4e2d\u5f97\u5230\u5bf9\u5e94\u7684\u7269\u7406\u5730\u5740\uff0c\u63a5\u7740 MMU \u628a\u7269\u7406\u5730\u5740\u53d1\u9001\u7ed9\u7f13\u5b58/\u5185\u5b58\uff0c\u6700\u540e\u4ece\u7f13\u5b58/\u5185\u5b58\u4e2d\u5f97\u5230\u6570\u636e\u3002</p> <p>\u800c Page Fault \u7684\u65f6\u5019\u5c31\u590d\u6742\u4e00\u4e9b\uff0c\u7b2c\u4e00\u6b21\u89e6\u53d1\u9875\u9519\u8bef\u4f1a\u628a\u9875\u9762\u8f7d\u5165\u5185\u5b58/\u7f13\u5b58\uff0c\u7136\u540e\u518d\u4ee5 Page Hit \u7684\u673a\u5236\u5f97\u5230\u6570\u636e\uff1a</p> <p></p> <p>\u8fd9\u91cc\u6709 7 \u6b65\uff0c\u524d\u9762\u548c Page Hit \u662f\u4e00\u81f4\u7684\uff0c\u5148\u628a\u865a\u62df\u5730\u5740\u53d1\u7ed9 MMU \u8fdb\u884c\u68c0\u67e5\uff0c\u7136\u540e\u53d1\u73b0\u6ca1\u6709\u5bf9\u5e94\u7684\u9875\uff0c\u4e8e\u662f\u89e6\u53d1\u5f02\u5e38\uff0c\u5f02\u5e38\u5904\u7406\u5668\u4f1a\u8d1f\u8d23\u4ece\u78c1\u76d8\u4e2d\u627e\u5230\u5bf9\u5e94\u9875\u9762\u5e76\u4e0e\u7f13\u5b58/\u5185\u5b58\u4e2d\u7684\u9875\u8fdb\u884c\u7f6e\u6362\uff0c\u7f6e\u6362\u5b8c\u6210\u540e\u518d\u8bbf\u95ee\u540c\u4e00\u5730\u5740\uff0c\u5c31\u53ef\u4ee5\u6309\u7167 Page Hit \u7684\u65b9\u5f0f\u6765\u8bbf\u95ee\u4e86\u3002</p> <p>\u867d\u7136\u7f13\u5b58\u5df2\u7ecf\u5f88\u5feb\u4e86\uff0c\u4f46\u662f\u80fd\u4e0d\u80fd\u66f4\u5feb\u5462\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u76f4\u63a5\u5728 MMU \u8fdb\u884c\u4e00\u90e8\u5206\u7684\u5de5\u4f5c\u5462\uff1f\u4e8e\u662f\u5c31\u6709\u4e86\u53e6\u5916\u4e00\u4e2a\u8bbe\u8ba1\uff1aTranslation Lookaside Buffer(TLB)\u3002TLB \u5b9e\u9645\u4e0a\u53ef\u4ee5\u8ba4\u4e3a\u662f\u9875\u8868\u5728\u5904\u7406\u82af\u7247\u4e0a\u7684\u7f13\u5b58\uff0c\u6574\u4f53\u7684\u673a\u5236\u548c\u524d\u9762\u63d0\u5230\u7684\u7f13\u5b58\u5f88\u50cf\uff0c\u6211\u4eec\u901a\u8fc7\u4e0b\u9762\u7684\u56fe\u8fdb\u884c\u8bb2\u89e3\uff1a</p> <p></p> <p>\u8fd9\u91cc VPN + VPO \u5c31\u662f\u865a\u62df\u5730\u5740\uff0c\u540c\u6837\u5206\u6210\u4e09\u90e8\u5206\uff0c\u5206\u522b\u7528\u4e8e\u5339\u914d\u6807\u7b7e\u3001\u786e\u5b9a\u96c6\u5408\uff0c\u5982\u679c TLB \u4e2d\u6709\u5bf9\u5e94\u7684\u8bb0\u5f55\uff0c\u90a3\u4e48\u76f4\u63a5\u8fd4\u56de\u5bf9\u5e94\u9875\u8868\u9879(PTE)\u5373\u53ef\uff0c\u5982\u679c\u6ca1\u6709\u7684\u8bdd\uff0c\u5c31\u8981\u4ece\u7f13\u5b58/\u5185\u5b58\u4e2d\u83b7\u53d6\uff0c\u5e76\u66f4\u65b0 TLB \u7684\u5bf9\u5e94\u96c6\u5408\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E9%93%BE%E6%8E%A5/","title":"\u94fe\u63a5","text":"<p>C \u8bed\u8a00\u7a0b\u5e8f\u5185\u5b58\u7ed3\u6784</p> <p></p> <p></p> <ol> <li> <p>gcc \u2013E hello.c \u2013o hello.i</p> </li> <li> <p>gcc \u2013S hello.i \u2013o hello.s</p> </li> <li> <p>as hello.s -o hello.o</p> </li> </ol>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E9%93%BE%E6%8E%A5/#prepressing","title":"\u9884\u5904\u7406(Prepressing)","text":"<ul> <li>\u5904\u7406<code>#define</code>,<code>#include</code></li> <li>\u5904\u7406<code>#if</code>,<code>#ifdef</code>,<code>#elif</code>,<code>#else</code>,<code>endif</code>.</li> <li>\u5220\u9664\u6ce8\u91ca</li> <li>\u6dfb\u52a0\u884c\u53f7,\u4fbf\u4e8e\u8c03\u8bd5\u4ea7\u751f\u76f8\u5173\u4fe1\u606f</li> <li>\u4fdd\u7559<code>#pragma</code></li> </ul>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E9%93%BE%E6%8E%A5/#_2","title":"\u76ee\u6807\u6587\u4ef6","text":"<ul> <li><code>ELF Header</code> \u63cf\u8ff0\u6574\u4e2a\u6587\u4ef6\u7684\u57fa\u672c\u5c5e\u6027</li> <li><code>.text</code> \u4ee3\u7801\u6bb5</li> <li><code>.data</code> \u6570\u636e\u6bb5</li> <li>.bss\u6bb5 \u4e3a\u672a\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\u548c\u5c40\u90e8\u9759\u6001\u53d8\u91cf\u9884\u7559\u4f4d\u7f6e\uff0c\u5b83\u5e76\u6ca1\u6709\u5185\u5bb9\uff0c\u6240\u4ee5\u5b83\u5728\u6587\u4ef6\u4e2d\u4e0d\u5360\u636e\u7a7a\u95f4\u3002</li> <li><code>Section Header Table</code></li> </ul>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/%E9%93%BE%E6%8E%A5/#binutils","title":"binutils\u4f7f\u7528\u65b9\u6cd5","text":"<p><code>gcc -c</code> \u53ea\u7f16\u8bd1\u4e0d\u94fe\u63a5</p> <p><code>objdump -h</code> \u67e5\u770bELF\u7684\u57fa\u672c\u4fe1\u606f          <code>-x</code> \u67e5\u770bELF\u7684\u5168\u90e8\u4fe1\u606f          <code>-s</code> \u5c06\u6bb5\u4e2d\u7684\u5185\u5bb9\u4ee5\u5341\u516d\u8fdb\u5236\u6253\u5370\u51fa\u6765          <code>-d</code> \u5c06\u5305\u542b\u6307\u4ee4\u7684\u6bb5\u53cd\u6c47\u7f16</p> <p><code>readelf -a</code> \u67e5\u770bELF\u7684\u5168\u90e8\u4fe1\u606f          <code>-h</code> \u67e5\u770bELF\u7684 <code>header</code> <code>-S</code> \u67e5\u770b\u6240\u6709\u7684\u6bb5\u8868\u4fe1\u606f          <code>-s</code> \u67e5\u770b\u6587\u4ef6\u7684\u7b26\u53f7 <code>size</code> \u67e5\u770bELF\u5404\u4e2a\u6bb5\u957f\u5ea6</p> <p><code>nm</code> \u67e5\u770bELF\u6587\u4ef6\u7684\u7b26\u53f7</p> <p>\u4ee3\u7801</p> <pre><code>/*\n * SimpleSection.c\n *\n * Linux:\n *   gcc -c SimpleSection.c\n *\n * Windows:\n *   cl SimpleSection.c /c /Za\n */\n\nint printf(const char *format, ...);\n\nint global_init_var = 84;\nint global_uninit_var;\n\nvoid func1(int i)\n{\n    printf(\"%d\\n\", i);\n}\n\nint main(void)\n{\n    static int static_var = 85;\n    static int static_var2;\n\n    int a = 1;\n    int b;\n\n    func1(static_var + static_var2 + a + b);\n\n    return a;\n}\n</code></pre> <p>\u7ed3\u679c </p> <p></p> <ul> <li> <p><code>.text</code>:  \u5df2\u7f16\u8bd1\u7a0b\u5e8f\u7684\u673a\u5668\u4ee3\u7801</p> </li> <li> <p><code>.rodata</code>: \u53ea\u8bfb\u6570\u636e\uff0c\u6bd4\u5982 printf \u8bed\u53e5\u4e2d\u7684\u683c \u56fe 7-3 \u5178\u578b\u7684 ELF \u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u5f0f\u4e32\u548c\u5f00\u5173\u8bed\u53e5\u7684\u8df3\u8f6c\u8868\u3002</p> </li> <li> <p><code>.data</code>: \u5df2\u521d\u59cb\u5316\u7684\u5168\u5c40\u548c\u9759\u6001 C \u53d8\u91cf\u3002\u5c40\u90e8 C \u53d8\u91cf\u5728\u8fd0\u884c\u65f6\u88ab\u4fdd\u5b58\u5728\u6808\u4e2d\uff0c\u65e2\u4e0d\u51fa\u73b0\u5728 .data \u8282\u4e2d\uff0c\u4e5f\u4e0d\u51fa\u73b0\u5728 .bss \u8282\u4e2d\u3002</p> </li> <li> <p><code>.bss</code>: \u672a\u521d\u59cb\u5316\u7684\u5168\u5c40\u548c\u9759\u6001 C \u53d8\u91cf\uff0c\u4ee5\u53ca\u6240\u6709\u88ab\u521d\u59cb\u5316\u4e3a 0 \u7684\u5168\u5c40\u6216\u9759\u6001\u53d8\u91cf\u3002\u5728\u76ee\u6807\u6587\u4ef6\u4e2d\u8fd9\u4e2a\u8282\u4e0d\u5360\u636e\u5b9e\u9645\u7684\u7a7a\u95f4\uff0c\u5b83\u4ec5\u4ec5\u662f\u4e00\u4e2a\u5360\u4f4d\u7b26\u3002\u76ee\u6807\u6587\u4ef6\u683c\u5f0f\u533a\u5206\u5df2\u521d\u59cb\u5316\u548c\u672a\u521d\u59cb\u5316\u53d8\u91cf\u662f\u4e3a\u4e86\u7a7a\u95f4\u6548\u7387\uff1a\u5728\u76ee\u6807\u6587\u4ef6\u4e2d\uff0c\u672a\u521d\u59cb\u5316\u53d8\u91cf\u4e0d\u9700\u8981\u5360\u636e\u4efb\u4f55\u5b9e\u9645\u7684\u78c1\u76d8\u7a7a\u95f4\u3002\u8fd0\u884c\u65f6\uff0c\u5728\u5185\u5b58\u4e2d\u5206\u914d\u8fd9\u4e9b\u53d8\u91cf\uff0c\u521d\u59cb\u503c\u4e3a 0 \u3002</p> </li> <li> <p><code>.symtab</code>: \u4e00\u4e2a\u7b26\u53f7\u8868\uff0c\u5b83\u5b58\u653e\u5728\u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u548c\u5f15\u7528\u7684\u51fd\u6570\u548c\u5168\u5c40\u53d8\u91cf\u7684\u4fe1\u606f\u3002\u4e00\u4e9b\u7a0b\u5e8f\u5458\u9519\u8bef\u5730\u8ba4\u4e3a\u5fc5\u987b\u901a\u8fc7 -g \u9009\u9879\u6765\u7f16\u8bd1\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u624d\u80fd\u5f97\u5230\u7b26\u53f7\u8868\u4fe1\u606f\u3002\u5b9e\u9645\u4e0a\uff0c\u6bcf\u4e2a\u53ef\u91cd\u5b9a\u4f4d\u76ee\u6807\u6587\u4ef6\u5728 .symtab \u4e2d\u90fd\u6709\u4e00\u5f20\u7b26\u53f7\u8868\uff08\u9664\u975e\u7a0b\u5e8f\u5458\u7279\u610f\u7528 STRIP \u547d\u4ee4\u53bb\u6389\u5b83\uff09\u3002\u7136\u800c\uff0c\u548c\u7f16\u8bd1\u5668\u4e2d\u7684\u7b26\u53f7\u8868\u4e0d\u540c\uff0c.symtab \u7b26\u53f7\u8868\u4e0d\u5305\u542b\u5c40\u90e8\u53d8\u91cf\u7684\u6761\u76ee\u3002</p> </li> <li> <p><code>.rel.text</code>: \u4e00\u4e2a .text \u8282\u4e2d\u4f4d\u7f6e\u7684\u5217\u8868\uff0c\u5f53\u94fe\u63a5\u5668\u628a\u8fd9\u4e2a\u76ee\u6807\u6587\u4ef6\u548c\u5176\u4ed6\u6587\u4ef6\u7ec4\u5408\u65f6\uff0c\u9700\u8981\u4fee\u6539\u8fd9\u4e9b\u4f4d\u7f6e\u3002\u4e00\u822c\u800c\u8a00\uff0c\u4efb\u4f55\u8c03\u7528\u5916\u90e8\u51fd\u6570\u6216\u8005\u5f15\u7528\u5168\u5c40\u53d8\u91cf\u7684\u6307\u4ee4\u90fd\u9700\u8981\u4fee\u6539\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u8c03\u7528\u672c\u5730\u51fd\u6570\u7684\u6307\u4ee4\u5219\u4e0d\u9700\u8981\u4fee\u6539\u3002\u6ce8\u610f\uff0c\u53ef\u6267\u884c\u76ee\u6807\u6587\u4ef6\u4e2d\u5e76\u4e0d\u9700\u8981\u91cd\u5b9a\u4f4d\u4fe1\u606f\uff0c\u56e0\u6b64\u901a\u5e38\u7701\u7565\uff0c\u9664\u975e\u7528\u6237\u663e\u5f0f\u5730\u6307\u793a\u94fe\u63a5\u5668\u5305\u542b\u8fd9\u4e9b\u4fe1\u606f\u3002</p> </li> <li> <p><code>.rel.data</code>: \u88ab\u6a21\u5757\u5f15\u7528\u6216\u5b9a\u4e49\u7684\u6240\u6709\u5168\u5c40\u53d8\u91cf\u7684\u91cd\u5b9a\u4f4d\u4fe1\u606f\u3002\u4e00\u822c\u800c\u8a00\uff0c\u4efb\u4f55\u5df2\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u6700\uff0c\u5982\u679c\u5b83\u7684\u521d\u59cb\u503c\u662f\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u5730\u5740\u6216\u8005\u5916\u90e8\u5b9a\u4e49\u51fd\u6570\u7684\u5730\u5740\uff0c\u90fd\u9700\u8981\u88ab\u4fee\u6539\u3002</p> </li> <li> <p><code>.debug</code>: \u4e00\u4e2a\u8c03\u8bd5\u7b26\u53f7\u8868\uff0c\u5176\u6761\u76ee\u662f\u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u7684\u5c40\u90e8\u53d8\u91cf\u548c\u7c7b\u578b\u5b9a\u4e49\uff0c\u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u548c\u5f15\u7528\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u4ee5\u53ca\u539f\u59cb\u7684 C \u6e90\u6587\u4ef6\u3002\u53ea\u6709\u4ee5 -g \u9009\u9879\u8c03\u7528\u7f16\u8bd1\u5668\u9a71\u52a8\u7a0b\u5e8f\u65f6\uff0c\u624d\u4f1a\u5f97\u5230\u8fd9\u5f20\u8868\u3002</p> </li> <li> <p><code>.line</code>: \u539f\u59cb C \u6e90\u7a0b\u5e8f\u4e2d\u7684\u884c\u53f7\u548c .text \u8282\u4e2d\u673a\u5668\u6307\u4ee4\u4e4b\u95f4\u7684\u6620\u5c04\u3002\u53ea\u6709\u4ee5 -g \u9009\u9879\u8c03\u7528\u7f16\u8bd1\u5668\u9a71\u52a8\u7a0b\u5e8f\u65f6\uff0c\u624d\u4f1a\u5f97\u5230\u8fd9\u5f20\u8868\u3002</p> </li> <li> <p><code>.strtab</code>: \u4e00\u4e2a\u5b57\u7b26\u4e32\u8868\uff0c\u5176\u5185\u5bb9\u5305\u62ec .symtab \u548c .debug \u8282\u4e2d\u7684\u7b26\u53f7\u8868\uff0c\u4ee5\u53ca\u8282\u5934\u90e8\u4e2d\u7684\u8282\u540d\u5b57\u3002\u5b57\u7b26\u4e32\u8868\u5c31\u662f\u4ee5 null \u7ed3\u5c3e\u7684\u5b57\u7b26\u4e32\u7684\u5e8f\u5217\u3002 </p> </li> </ul> <p></p> <p></p>"},{"location":"%E5%85%B6%E4%BB%96/CSAPP/CMU15-455/CMU15-455/","title":"CMU15-455","text":""},{"location":"%E5%85%B6%E4%BB%96/CSAPP/CMU15-455/CMU15-455/#2-advanced-sql","title":"2. Advanced SQL","text":"<p>Data Manipualtion Language (DML) \u6570\u636e\u64cd\u7eb5\u8bed\u8a00</p> <p>Data Defineition Language (DDL) \u6570\u636e\u5b9a\u4e49\u8bed\u8a00</p> <p>Data Contril Language (DCL) \u6570\u636e\u63a7\u5236\u8bed\u8a00</p> <p>HAVING \u53ef\u4ee5\u7528\u4e8e\u5904\u7406GROUP BY \u4e4b\u540e\u7684\u4e8b\u4ef6</p> <p></p> <p>SQL\u6807\u51c6\u4f7f\u7528 | | \u8fde\u63a5\u4e24\u4e2a\u5b57\u7b26\u4e32 MSSQL \u4f7f\u7528 + MySQL \u4f7f\u7528 concat\u51fd\u6570</p> <p>EXIST return true or false</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/1.%20Lab%20Utilities/","title":"1. Lab Utilities","text":""},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/1.%20Lab%20Utilities/#sleep","title":"sleep","text":"<p>\u53c2\u7167<code>echo.c</code>\uff0c\u76f4\u63a5\u8c03\u7528system\u7684\u51fd\u6570\u5373\u53ef</p> <pre><code>#include \"kernel/types.h\"\n#include \"kernel/stat.h\"\n#include \"user/user.h\"\n\nint main(int argc, char *argv[]) \n{\n  int n;\n  if (argc &lt; 2) {\n    fprintf(2, \"Please enter a number.\\n\");\n    exit(1);\n  }\n\n  n = atoi(argv[1]);\n  sleep(n);\n  exit(0);\n}\n</code></pre> <p>\u7136\u540e\u5728 <code>makefile</code> \u7684<code>UPROGS</code>\u4e0b\u9762\u52a0\u4e0a\u76f8\u5e94\u5185\u5bb9\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/1.%20Lab%20Utilities/#pingpoing","title":"pingpoing","text":"<p>\u4f7f\u7528\u5230\u4e86 <code>fork</code> \u548c <code>pipe</code></p> <p> \u53c2\u8003pipe() System call - GeeksforGeeks</p> <p>p[0] \u8bfb\u6570\u636e p[1] \u5199\u6570\u636e</p> <p>\u4e0d\u7528\u7684\u9700\u8981\u5173\u95ed</p> <pre><code>#include &lt;kernel/types.h&gt;\n#include &lt;kernel/stat.h&gt;\n#include &lt;user/user.h&gt;\n\nint main(int argc, char *argv[]) {\n\n  int p[2];\n  if (pipe(p) &lt; 0)\n    exit(1);\n\n  int pid = fork();\n  if (pid &gt; 0) {\n    char buf;\n    write(p[1], argv[1], 1);\n    close(p[1]);\n    read(p[0],&amp;buf,1);\n    close(p[0]);\n    printf(\"%d: received pong\\n\", getpid());\n\n\n  } else {\n    char buf;\n    read(p[0],&amp;buf, 1);// \u5f53p[0]\u6ca1\u6709\u6570\u636e\u65f6\uff0c\u8fd9\u4e2a\u8fdb\u7a0b\u4f1a\u88ab\u6302\u8d77\uff0c\u8fdb\u884c\u7b49\u5f85\u3002\n    close(p[0]);\n    printf(\"%d: received ping\\n\",getpid());\n    write(p[1], &amp;buf, 1);\n    close(p[1]);\n\n  }\n\n  exit(0);\n}\n</code></pre> <p>int pipe(int fds[2]);</p> <p>Parameters : fd[0] will be the fd(file descriptor) for the  read end of pipe. fd[1] will be the fd for the write end of pipe. Returns : 0 on Success. -1 on error.</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/1.%20Lab%20Utilities/#primes","title":"primes","text":"<p>\u53c2\u8003Bell Labs and CSP Threads</p> <p>\u8981\u6c42\u7f16\u5199\u5e76\u53d1\u7248\u672c\u7684\u8d28\u6570\u7b5b</p> <pre><code>#include \"kernel/types.h\"\n#include \"kernel/stat.h\"\n#include \"user/user.h\"\n\nvoid process(int left[]) {\n  char p;\n  read(left[0], &amp;p, 1);\n\n  printf(\"prime %d\\n\", p);\n\n  int num = 0;\n  if (read(left[0], &amp;num, 1) == 0) { // \u5230\u8fbe\u7ed3\u5c3e \u7ba1\u9053\u5173\u95ed\n    return;\n  }\n\n\n  int right[2];\n  pipe(right);\n\n  int pid = fork();\n  if (pid == 0) {\n    close(left[0]);\n    close(right[1]);\n\n    process(right);\n\n    close(right[0]);\n  } else if (pid &gt; 0) {\n\n    close(right[0]);\n\n    do {\n      if (num % p != 0) {\n        write(right[1], &amp;num, 1);\n      }\n    } while(read(left[0],&amp;num,1) != 0);\n\n    close(left[0]);\n    close(right[1]);\n    wait(0);\n\n  } else {\n    printf(\"Error.\\n\");\n    exit(1);\n  }\n\n\n}\n\nint main() {\n  int right[2];\n  pipe(right);\n\n  int pid = fork();\n  if (pid == 0) {\n\n    close(right[1]);\n    process(right);\n    close(right[0]);\n  } else if (pid &gt; 0) {\n\n    close(right[0]);\n\n    for (int i = 2; i &lt;= 35; i++) { // \u4f20\u6570\n      char buf = i;\n      write(right[1], &amp;buf, 1);\n    }\n\n    close(right[1]);\n    wait(0);\n\n  } else {\n    printf(\"Error.\\n\");\n    close(right[0]);\n    close(right[1]);\n    exit(1);\n  }\n\n  exit(0);\n}\n</code></pre> <p><code>read()</code> \u51fd\u6570\u8fd4\u56de\u6210\u529f\u8bfb\u53d6\u7684\u5b57\u8282\u6570\u3002\u5982\u679c\u8fd4\u56de\u503c\u4e3a0\uff0c\u5219\u8868\u793a\u5df2\u5230\u8fbe\u6587\u4ef6\u672b\u5c3e\uff08end-of-file\uff09\u3002</p> <p>\u5f53\u4f7f\u7528<code>read()</code>\u51fd\u6570\u4ece\u7ba1\u9053\u4e2d\u8bfb\u53d6\u6570\u636e\u65f6\uff0c\u5982\u679c\u6ca1\u6709\u6570\u636e\u53ef\u4f9b\u8bfb\u53d6\u4e14\u7ba1\u9053\u4e2d\u4e0d\u518d\u6709\u4efb\u4f55\u5199\u5165\u7aef\uff08\u4e5f\u5c31\u662f\u6240\u6709\u5199\u5165\u7aef\u90fd\u5df2\u5173\u95ed\uff09\uff0c<code>read()</code>\u51fd\u6570\u5c06\u4f1a\u8fd4\u56de0\uff0c\u8868\u793a\u5df2\u5230\u8fbe\u6587\u4ef6\u672b\u5c3e\uff08end-of-file\uff09\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/1.%20Lab%20Utilities/#find","title":"find","text":"<pre><code>#include \"kernel/types.h\"\n#include \"kernel/fs.h\"\n#include \"kernel/stat.h\"\n#include \"user/user.h\"\n\nchar *fmtname(char *path) { // \u8fd4\u56de\u6700\u540e\u4e00\u4e2a'/'\u4e4b\u540e\u7684\u5185\u5bb9\n  static char buf[DIRSIZ + 1];\n  char *p;\n\n  // Find first character after last slash.\n  for (p = path + strlen(path); p &gt;= path &amp;&amp; *p != '/'; p--)\n    ;\n  p++;\n\n  // Return blank-padded name.\n  if (strlen(p) &gt;= DIRSIZ)\n    return p;\n  memmove(buf, p, strlen(p));\n  memset(buf + strlen(p), 0, DIRSIZ - strlen(p)); // \u628a\u2019 \u2019\u6539\u62100\n  return buf;\n}\n\nint norecurse(char *path) { // \u5224\u65ad\u80fd\u5426\u9012\u5f52\n  char* buf = fmtname(path);\n  if(buf[0] == '.' &amp;&amp; buf[1] == 0) {\n    return 1;\n  }\n  if(buf[0] == '.' &amp;&amp; buf[1] == '.' &amp;&amp; buf[2] == 0) {\n    return 1;\n  }\n  return 0;\n}\n\nvoid find(char *path,char *target) {\n  //printf(\"%s\\n\",path);\n  char buf[512], *p;\n  int fd;\n  struct dirent de;\n  struct stat st;\n\n  if ((fd = open(path, 0)) &lt; 0) {\n    fprintf(2, \"find: cannot open %s\\n\", path);\n    return;\n  }\n\n  if (fstat(fd, &amp;st) &lt; 0) { // \u6587\u4ef6\u7684\u72b6\u6001\u4fe1\u606f\n    fprintf(2, \"find: cannot stat %s\\n\", path);\n    close(fd);\n    return;\n  }\n\n  //printf(\"path: %s; traget: %s;\\n\",path,target);\n\n  if (strcmp(fmtname(path),target) == 0) {\n    printf(\"%s\\n\",path);\n  }\n\n  switch(st.type){\n  case T_FILE:\n    // printf(\"%s %d %d %l\\n\", fmtname(path), st.type, st.ino, st.size);\n    break;\n\n  case T_DIR:\n    if(strlen(path) + 1 + DIRSIZ + 1 &gt; sizeof buf){\n      printf(\"ls: path too long\\n\");\n      break;\n    }\n    strcpy(buf, path);\n    p = buf+strlen(buf);\n    *p++ = '/';\n    while(read(fd, &amp;de, sizeof(de)) == sizeof(de)){\n      if(de.inum == 0)\n        continue;\n      memmove(p, de.name, DIRSIZ);\n      p[DIRSIZ] = 0;\n\n      if(stat(buf, &amp;st) &lt; 0){\n        printf(\"ls: cannot stat %s\\n\", buf);\n        continue;\n      }\n\n      // if (strcmp(fmtname(buf), target) == 0) {\n      //   printf(\"%s\\n\",buf);\n      // }\n\n      //printf(\"%s %d %d %d\\n\", fmtname(buf), st.type, st.ino, st.size);\n\n      if(norecurse(buf) == 0) {\n          find(buf,target);\n      }\n\n    }\n    break;\n  }\n  close(fd);\n}\n\nint main(int argc, char *argv[]) {\n\n  if(argc &lt; 2) {\n    printf(\"usage: find [path] [target]\\n\");\n    exit(1);\n  }\n\n  if (argc &lt; 3) {\n    find(\".\", argv[1]);\n    exit(0);\n  }\n  if(argc &lt;4) {\n    find(argv[1], argv[2]);\n    exit(0);\n  }\n\n\n  printf(\"usage: find [path] [target\\n]\");\n  exit(1);\n}\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/1.%20Lab%20Utilities/#xargs","title":"xargs","text":"<pre><code>$ echo hello too | xargs echo bye\nbye hello too\n$\n</code></pre> <pre><code>$ find . b | xargs grep hello\n</code></pre> <pre><code>#include \"kernel/types.h\"\n#include \"kernel/stat.h\"\n#include \"user/user.h\"\n#include \"kernel/param.h\"\n\n\n# define MAXSIZE 2048\n\nint main(int argc,char *argv[]) {\n\n    char buf[MAXSIZE];\n\n    // \u83b7\u53d6\u6807\u51c6\u5316\u8f93\u5165\n    int buf_idx = 0;\n\n    int n = read(0,buf,MAXSIZE); // \u9632\u6b62\u8f93\u5165\u65f6\u95f4\u8fc7\u957f\uff0c\u9700\u8981\u4e00\u76f4\u8bfb\u53d6\n    while (n&gt;0) {\n        buf_idx += n;\n        n = read(0,&amp;buf[buf_idx],MAXSIZE);\n    }\n\n    // for(int i=0;i&lt;MAXSIZE;i++) {\n    //     printf(\"%c\",buf[i]);\n    // }\n    // printf(\"\\n\");\n\n    // \u5904\u7406\u53c2\u6570\n    char *xargv[MAXARG];\n    int xargc = 0;\n    for (int i=1; i&lt;argc;i++) {\n        xargv[xargc] = argv[i];\n        xargc++;\n    }\n\n    char *p = buf;\n    for (int i = 0; i &lt; MAXSIZE; i++) {\n        if(buf[i] == '\\n') { //\u5bf9\u6bcf\u4e00\u884c\u8f93\u5165\u5206\u522b\u5904\u7406\n            int pid = fork();\n            if (pid == 0) {\n                buf[i] = 0;\n                xargv[xargc] = p; // \u628a\u53c2\u6570\u52a0\u5230\u6700\u540e\n                xargc ++ ;\n                xargv[xargc] = 0;\n                xargc++;\n                exec(xargv[0],xargv); // \u6267\u884c\u7a0b\u5e8f\n                exit(0);\n            } else if (pid &gt; 0) {\n                wait(0);\n                p = &amp;buf[i+1];\n\n            } else {\n                printf(\"fork error.\\n\");\n                exit(1);\n            }\n        }\n    }\n\n    exit(0);\n}\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/2.%20Lab%20system%20calls/","title":"Lab: system calls","text":""},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/2.%20Lab%20system%20calls/#system-call-tracing","title":"System call tracing","text":"<p>assignment\u8981\u6c42\u6dfb\u52a0\u4e00\u4e2a\u7cfb\u7edf\u7684trace\u529f\u80fd</p> <p><code>trace 32 grep hello README</code></p> <p>\u63a5\u53d7\u4e00\u4e2amask\u53c2\u6570\uff0c\u6839\u636emask\u7684\u5bf9\u5e94bit\u6307\u5b9a\u8981\u8ddf\u8e2a\u7684syscall</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/2.%20Lab%20system%20calls/#_1","title":"\u6dfb\u52a0\u58f0\u660e","text":"<pre><code># user/usys.pl\n# add\nentry(\"trace\");\n</code></pre> <pre><code>// user/user.h\nint trace(int);\n</code></pre> <pre><code>// kernel/syscall.h\n#define SYS_link   19\n#define SYS_mkdir  20\n#define SYS_close  21\n\n#define SYS_trace  22 // +\n</code></pre> <pre><code>// kernel/syscall.c\nextern uint64 sys_wait(void);\nextern uint64 sys_write(void);\nextern uint64 sys_uptime(void);\nextern uint64 sys_trace(void); // +\n\nstatic uint64 (*syscalls[])(void) = {\n[SYS_fork]    sys_fork,\n@@ -127,8 +128,36 @@ static uint64 (*syscalls[])(void) = {\n[SYS_link]    sys_link,\n[SYS_mkdir]   sys_mkdir,\n[SYS_close]   sys_close,\n[SYS_trace]   sys_trace, // +\n};\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/2.%20Lab%20system%20calls/#syscallsysprocc","title":"syscall\u51fd\u6570\u4fee\u6539\u3001\u5b9e\u73b0sysproc.c\u4e2d\u7684\u51fd\u6570","text":"<pre><code>//kernel/syscall.c\n\nvoid\nsyscall(void)\n{\n  int num;\n  struct proc *p = myproc();\n\n  num = p-&gt;trapframe-&gt;a7;\n  if(num &gt; 0 &amp;&amp; num &lt; NELEM(syscalls) &amp;&amp; syscalls[num]) {\n    p-&gt;trapframe-&gt;a0 = syscalls[num](); // \u8fdb\u884c\u7cfb\u7edf\u8c03\u7528\n|   uint64 ret_val = p-&gt;trapframe-&gt;a0;  // \u83b7\u53d6\u7cfb\u7edf\u8c03\u7528\u8fd4\u56de\u503c\n|   if((p-&gt;trace_mask&gt;&gt;num)&amp;1) {\n|     printf(\"%d: syscall %s -&gt; %d\\n\",p-&gt;pid, syscall_names[num], ret_val);\n|   }\n  } else {\n    printf(\"%d %s: unknown sys call %d\\n\",\n            p-&gt;pid, p-&gt;name, num);\n    p-&gt;trapframe-&gt;a0 = -1;\n  }\n}\n</code></pre> <p>\u5bf9\u7cfb\u7edf\u8c03\u7528\u4fe1\u606f\u8fdb\u884c\u5904\u7406\u3002</p> <pre><code>//kernel/syscall.c\n\n// \u6dfb\u52a0\u7cfb\u7edf\u8c03\u7528\u540d\u79f0\u6570\u7ec4\nconst char *syscall_names[] = {\n[SYS_fork]    \"fork\",\n[SYS_exit]    \"exit\",\n[SYS_wait]    \"wait\",\n[SYS_pipe]    \"pipe\",\n[SYS_read]    \"read\",\n[SYS_kill]    \"kill\",\n[SYS_exec]    \"exec\",\n[SYS_fstat]   \"fstat\",\n[SYS_chdir]   \"chdir\",\n[SYS_dup]     \"dup\",\n[SYS_getpid]  \"getpid\",\n[SYS_sbrk]    \"sbrk\",\n[SYS_sleep]   \"sleep\",\n[SYS_uptime]  \"uptime\",\n[SYS_open]    \"open\",\n[SYS_write]   \"write\",\n[SYS_mknod]   \"mknod\",\n[SYS_unlink]  \"unlink\",\n[SYS_link]    \"link\",\n[SYS_mkdir]   \"mkdir\",\n[SYS_close]   \"close\",\n[SYS_trace]   \"trace\",\n};\n</code></pre> <pre><code>// kernel/sysproc.c\n\nuint64\nsys_trace(void) \n{\n  int mask;\n\n  if(argint(0, &amp;mask) &lt; 0) //\u4ece\u7528\u6237\u7a7a\u95f4\u83b7\u53d6\u7cfb\u7edf\u8c03\u7528\u53c2\u6570(\u5b9e\u73b0\u4f4d\u4e8ekernel/syscall.c) \n    return -1;\n  myproc()-&gt;trace_mask = mask;\n  return 0;\n}\n</code></pre> <p>\u83b7\u53d6\u7cfb\u7edf\u8c03\u7528\u53c2\u6570\uff0c\u5e76\u4fdd\u5b58\u5230proc\u7ed3\u6784\u4f53\u4e2d</p> <pre><code>// kernel/proc.h\n\n// Per-process state\nstruct proc {\n  struct spinlock lock;\n\n@---------------------------------------------@\n  struct file *ofile[NOFILE];  // Open files\n  struct inode *cwd;           // Current directory\n  char name[16];               // Process name (debugging)\n\n  int trace_mask; // + \u5728\u8fdb\u7a0b\u7684struct\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5b58\u50a8mask\u7684\u53d8\u91cf \n};\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/2.%20Lab%20system%20calls/#trace","title":"\u591a\u8fdb\u7a0btrace","text":"<pre><code>// kernel/proc.c\n\n  safestrcpy(np-&gt;name, p-&gt;name, sizeof(p-&gt;name));\n\n  np-&gt;trace_mask = p-&gt;trace_mask; // + \u4f7f \u5b50\u8fdb\u7a0b\u7684mask \u7b49\u4e8e \u7236\u8fdb\u7a0b\u7684mask\n\n  pid = np-&gt;pid;\n\n  release(&amp;np-&gt;lock);\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/2.%20Lab%20system%20calls/#sysinfo","title":"Sysinfo","text":"<p>\u6dfb\u52a0\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528\uff1asysinfo\u7528\u4e8e\u6536\u96c6\u7cfb\u7edf\u7684\u4fe1\u606f</p> <p><pre><code>// kernel/sysinfo.h\n\nstruct sysinfo {\n  uint64 freemem;   // amount of free memory (bytes)\n  uint64 nproc;     // number of process\n};\n</code></pre> \u4f7f\u7528\u8be5\u7ed3\u6784\u4f53\u5b58\u50a8sysinfo</p> <p>\u53ef\u4ee5\u77e5\u9053\u9700\u8981\u6536\u96c6\u4ee5\u4e0b\u4fe1\u606f\uff1a 1. \u8fdb\u7a0b\u6570\u91cf 2. \u7a7a\u7684memory</p> <p>\u76f8\u5173\u58f0\u660e\u6b65\u9aa4\u4e0etrace\u4e00\u81f4</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/2.%20Lab%20system%20calls/#_2","title":"\u83b7\u53d6\u8fdb\u7a0b\u6570\u91cf","text":"<pre><code>// kernel/proc.c\n\n// Print a process listing to console.  For debugging.\n// Runs when user types ^P on console.\n// No lock to avoid wedging a stuck machine further.\nvoid\nprocdump(void)\n{\n  static char *states[] = {\n  [UNUSED]    \"unused\",\n  [SLEEPING]  \"sleep \",\n  [RUNNABLE]  \"runble\",\n  [RUNNING]   \"run   \",\n  [ZOMBIE]    \"zombie\"\n  };\n  struct proc *p;\n  char *state;\n\n  printf(\"\\n\");\n  for(p = proc; p &lt; &amp;proc[NPROC]; p++){\n    if(p-&gt;state == UNUSED)\n      continue;\n    if(p-&gt;state &gt;= 0 &amp;&amp; p-&gt;state &lt; NELEM(states) &amp;&amp; states[p-&gt;state])\n      state = states[p-&gt;state];\n    else\n      state = \"???\";\n    printf(\"%d %s %s\", p-&gt;pid, state, p-&gt;name);\n    printf(\"\\n\");\n  }\n}\n\n// +++++\nuint64 num_proc() {\n  uint64 cnt = 0;\n  struct proc *p;\n  for(p = proc; p &lt;&amp;proc[NPROC];p++){\n    if(p-&gt;state == UNUSED) // \u5904\u4e8eUNUSED\u72b6\u6001\u5c31\u8df3\u8fc7\n      continue;\n    cnt++;\n  }\n  return cnt;\n}\n// +++++\n</code></pre> <p>\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\uff0c\u524d\u4e00\u4e2a\u51fd\u6570\u5c31\u662f\u4e00\u4e2a\u8f93\u51fa\u6240\u6709\u8fd0\u884c\u8fdb\u7a0b\u7684\u51fd\u6570\u3002 \u56e0\u800c\u53ef\u4ee5\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u7edf\u8ba1\u8fdb\u7a0b\u7684\u6570\u91cf\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/2.%20Lab%20system%20calls/#memory","title":"\u83b7\u53d6\u7a7a\u7684memory\u5927\u5c0f","text":"<pre><code>// Allocate one 4096-byte page of physical memory.\n// Returns a pointer that the kernel can use.\n// Returns 0 if the memory cannot be allocated.\nvoid *\nkalloc(void)\n{\n  struct run *r;\n\n  acquire(&amp;kmem.lock);\n  r = kmem.freelist;\n  if(r)\n    kmem.freelist = r-&gt;next;\n  release(&amp;kmem.lock);\n\n  if(r)\n    memset((char*)r, 5, PGSIZE); // fill with junk\n  return (void*)r;\n}\n\n// +++++\nuint64 num_freemem() {\n  struct run *r;\n  uint64 mem_bytes = 0;\n  r = kmem.freelist;\n\n  while (r) {\n    mem_bytes += PGSIZE;\n    r = r-&gt;next;\n  }\n\n  return mem_bytes;\n}\n// +++++\n</code></pre> <p>\u524d\u4e00\u4e2a\u51fd\u6570\u662f\u7528\u4e8e\u5206\u914dmemory\u7684\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u53c2\u7167</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/2.%20Lab%20system%20calls/#sysinfouser-space","title":"\u5c06sysinfo\u7684\u7ed3\u6784\u4f53\u590d\u5236\u5230user space","text":"<p>\u9700\u8981\u53c2\u7167sys_fstat()\u00a0(kernel/sysfile.c) and\u00a0filestat()\u00a0(kernel/file.c)\u6765\u4f7f\u7528copyout</p> <pre><code>// kernel/sysfile.c\n\nuint64\nsys_fstat(void)\n{\n  struct file *f;\n  uint64 st; // user pointer to struct stat\n\n  if(argfd(0, 0, &amp;f) &lt; 0 || argaddr(1, &amp;st) &lt; 0)\n    return -1;\n  return filestat(f, st);\n}\n</code></pre> <pre><code>// kernel/file.c\n\n// Get metadata about file f.\n// addr is a user virtual address, pointing to a struct stat.\nint\nfilestat(struct file *f, uint64 addr)\n{\n  struct proc *p = myproc();\n  struct stat st;\n\n  if(f-&gt;type == FD_INODE || f-&gt;type == FD_DEVICE){\n    ilock(f-&gt;ip);\n    stati(f-&gt;ip, &amp;st);\n    iunlock(f-&gt;ip);\n    if(copyout(p-&gt;pagetable, addr, (char *)&amp;st, sizeof(st)) &lt; 0)\n      return -1;\n    return 0;\n  }\n  return -1;\n}\n</code></pre> <pre><code>// kernel/sysproc.c\n\nuint64\nsys_sysinfo(void)\n{\n  uint64 addr;\n\n  if(argaddr(0, &amp;addr) &lt; 0) // \u83b7\u5f97addr\n    return -1;\n\n  struct sysinfo info;          // \u5f00\u5934\u8981\u52a0\u4e0a#include \"sysinfo.h\"\n  info.freemem = num_freemem(); // memory\u7a7a\u95f4\n  info.nproc = num_proc();      // \u8fdb\u7a0b\u6570\u91cf\n  if(copyout(myproc()-&gt;pagetable, addr, (char *)&amp;info, sizeof(info)) &lt;0) {\n    return -1;\n  }\n  return 0;\n}\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/","title":"Lab: page tables","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u591a\u7ea7\u9875\u8868\u5230\u5e95\u662f\u4e3a\u4e86\u89e3\u51b3\u4ec0\u4e48\u95ee\u9898\uff1f - \u77e5\u4e4e</p> <p></p> <p></p> <pre><code>  +-----------------------------------+\n  |                                   |\n  |           \u7a0b\u5e8f\u8fd0\u884c\u65f6               |\n  |                                   |\n  +-----------------+-----------------+\n                    |\n                    | \u4f7f\u7528\u865a\u62df\u5730\u5740\u8bbf\u95ee\u5185\u5b58\n                    |\n                    v\n  +-----------------+-----------------+\n  |                                   |\n  |          MMU \u786c\u4ef6\u6a21\u5757              |\n  |                                   |\n  +-----------------+-----------------+\n                    |\n                    | \u901a\u8fc7\u9875\u8868\u6620\u5c04\uff0c\u5c06\u865a\u62df\u5730\u5740\u8f6c\u6362\u4e3a\u7269\u7406\u5730\u5740\n                    |\n                    v\n  +-----------------+-----------------+\n  |                                   |\n  |        \u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\u8868              |\n  |                                   |\n  +-----------------+-----------------+\n                    |\n                    | \u67e5\u627e\u865a\u62df\u9875\u53f7\u5bf9\u5e94\u7684\u7269\u7406\u9875\u53f7\n                    |\n                    v\n  +-----------------+-----------------+\n  |                                   |\n  |           \u7269\u7406\u5185\u5b58                 |\n  |                                   |\n  +-----------------+-----------------+\n</code></pre> <p>\u89e3\u91ca\u8fc7\u7a0b\u56fe\uff1a</p> <ol> <li>\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u7a0b\u5e8f\u4f7f\u7528\u865a\u62df\u5730\u5740\u8bbf\u95ee\u5185\u5b58\u3002</li> <li>MMU\uff08Memory Management Unit\uff09\u786c\u4ef6\u6a21\u5757\u662f\u8ba1\u7b97\u673a\u7684\u4e00\u90e8\u5206\uff0c\u8d1f\u8d23\u865a\u62df\u5185\u5b58\u5730\u5740\u8f6c\u6362\u3002\u5b83\u63a5\u6536\u7a0b\u5e8f\u53d1\u51fa\u7684\u865a\u62df\u5730\u5740\uff0c\u5e76\u901a\u8fc7\u9875\u8868\u6620\u5c04\u5c06\u865a\u62df\u5730\u5740\u8f6c\u6362\u4e3a\u7269\u7406\u5730\u5740\u3002</li> <li>\u64cd\u4f5c\u7cfb\u7edf\u7684\u9875\u8868\u662f\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u5305\u542b\u865a\u62df\u9875\u53f7\u4e0e\u7269\u7406\u9875\u53f7\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u3002MMU\u4f1a\u4f7f\u7528\u865a\u62df\u9875\u53f7\u5728\u9875\u8868\u4e2d\u67e5\u627e\u5bf9\u5e94\u7684\u7269\u7406\u9875\u53f7\u3002</li> <li>\u7269\u7406\u5185\u5b58\u662f\u5b9e\u9645\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5305\u542b\u4e86\u7a0b\u5e8f\u7684\u6570\u636e\u548c\u6307\u4ee4\u3002\u4e00\u65e6\u627e\u5230\u865a\u62df\u9875\u53f7\u5bf9\u5e94\u7684\u7269\u7406\u9875\u53f7\uff0cMMU\u4f1a\u5c06\u7269\u7406\u9875\u53f7\u4e0e\u9875\u5185\u504f\u79fb\u7ec4\u5408\u6210\u7269\u7406\u5730\u5740\uff0c\u4ece\u800c\u80fd\u591f\u8bbf\u95ee\u5b9e\u9645\u7684\u7269\u7406\u5185\u5b58\u3002</li> </ol> <p>\u901a\u8fc7\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u7a0b\u5e8f\u80fd\u591f\u5728\u865a\u62df\u5185\u5b58\u7a7a\u95f4\u4e2d\u8fd0\u884c\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u5173\u5fc3\u7269\u7406\u5185\u5b58\u7684\u5177\u4f53\u4f4d\u7f6e\u548c\u7ba1\u7406\uff0c\u64cd\u4f5c\u7cfb\u7edf\u901a\u8fc7\u865a\u62df\u5185\u5b58\u5730\u5740\u8f6c\u6362\u6765\u5b8c\u6210\u5185\u5b58\u7ba1\u7406\u7684\u4efb\u52a1\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#-","title":"\u591a\u7ea7\u9875\u8868-\u540d\u8bcd","text":""},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#page","title":"\u9875\uff08Page\uff09","text":"<p>\u9875\uff08\u901a\u5e38\u79f0\u4e3a\u9875\u9762\uff09\u662f\u5185\u5b58\u7ba1\u7406\u4e2d\u7684\u4e00\u4e2a\u57fa\u7840\u6982\u5ff5\uff0c\u5b83\u4ee3\u8868\u7684\u662f\u4e00\u4e2a\u56fa\u5b9a\u957f\u5ea6\u7684\u5185\u5b58\u5757\u3002\u64cd\u4f5c\u7cfb\u7edf\u628a\u7269\u7406\u5185\u5b58\u548c\u865a\u62df\u5185\u5b58\u90fd\u5206\u4e3a\u8bb8\u591a\u5927\u5c0f\u76f8\u7b49\u7684\u9875\u3002\u4f8b\u5982\uff0c\u5728\u5f88\u591a\u7cfb\u7edf\u4e2d\uff0c\u4e00\u4e2a\u5e38\u89c1\u7684\u9875\u5927\u5c0f\u53ef\u80fd\u662f4KB\u3002\u4f7f\u7528\u9875\u7684\u4e3b\u8981\u76ee\u7684\u662f\u4e3a\u4e86\u5b9e\u73b0\u865a\u62df\u5185\u5b58\u7cfb\u7edf\uff0c\u5176\u4e2d\u7684\u5730\u5740\u7a7a\u95f4\u7531\u8bb8\u591a\u8fd9\u6837\u7684\u9875\u6784\u6210\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#page-table","title":"\u9875\u8868\uff08Page Table\uff09","text":"<p>\u9875\u8868\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u628a\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e2d\u7684\u9875\u6620\u5c04\u5230\u7269\u7406\u5185\u5b58\u4e2d\u7684\u9875\u5e27\u3002\u8fd9\u6837\u7684\u6620\u5c04\u5bf9\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u8fdb\u884c\u5730\u5740\u8f6c\u6362\u662f\u5fc5\u8981\u7684\u2014\u5373\u5c06\u7a0b\u5e8f\u4f7f\u7528\u7684\u865a\u62df\u5730\u5740\u8f6c\u6362\u4e3a\u5b9e\u9645\u7269\u7406\u5185\u5b58\u5730\u5740\u3002\u9875\u8868\u901a\u5e38\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0c\u6709\u65f6\u5019\u8fd8\u4f1a\u88ab\u7f13\u5b58\u5230\u5feb\u901f\u7684\u786c\u4ef6\u5bc4\u5b58\u5668\uff08\u4f8b\u5982TLB\u2014Translation Lookaside Buffer\uff09\u4e2d\u4ee5\u52a0\u901f\u67e5\u627e\u901f\u5ea6\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#page-directory","title":"\u9875\u76ee\u5f55\uff08Page Directory\uff09","text":"<p>\u5728\u8bb8\u591a\u5206\u9875\u7cfb\u7edf\u4e2d\uff0c\u7279\u522b\u662f\u5728Intel x86\u4f53\u7cfb\u7ed3\u6784\u7684\u4f20\u7edf\u5206\u9875\u6a21\u5f0f\u4e2d\uff0c\u9875\u76ee\u5f55\u662f\u7ba1\u7406\u9875\u8868\u7684\u4e00\u79cd\u673a\u5236\u3002\u8003\u8651\u5230\u9875\u8868\u53ef\u80fd\u4f1a\u975e\u5e38\u5927\uff0c\u4e00\u4e2a\u5305\u542b\u6240\u6709\u6620\u5c04\u7684\u5355\u4e00\u9875\u8868\u5c06\u4e0d\u5b9e\u7528\uff0c\u6240\u4ee5\u7cfb\u7edf\u4f7f\u7528\u9875\u76ee\u5f55\u6765\u7ec4\u7ec7\u8fd9\u4e9b\u9875\u8868\u3002\u9875\u76ee\u5f55\u5305\u542b\u4e86\u6307\u5411\u9875\u8868\u7684\u6307\u9488\uff0c\u6bcf\u4e2a\u6307\u9488\u90fd\u5bf9\u5e94\u7740\u4e00\u4e2a\u9875\u8868\uff0c\u8fd9\u4e9b\u9875\u8868\u8fdb\u4e00\u6b65\u5b58\u50a8\u7740\u865a\u62df\u9875\u5230\u7269\u7406\u9875\u5e27\u7684\u6620\u5c04\u3002\u9875\u76ee\u5f55\u672c\u8eab\u4e5f\u5206\u9875\uff0c\u5c06\u5730\u5740\u7a7a\u95f4\u7684\u4e0d\u540c\u90e8\u5206\u5206\u914d\u7ed9\u4e0d\u540c\u7684\u9875\u8868\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#page-table-entrypte","title":"\u9875\u8868\u9879\uff08Page Table Entry\uff0cPTE\uff09","text":"<p>\u6bcf\u4e2a\u9875\u8868\u9879\u662f\u9875\u8868\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20\uff0c\u5305\u542b\u7528\u4e8e\u5c06\u865a\u62df\u9875\u6620\u5c04\u5230\u7269\u7406\u9875\u5e27\u7684\u4fe1\u606f\u3002PTE\u901a\u5e38\u5305\u542b\u7269\u7406\u9875\u5e27\u7684\u5730\u5740\u4ee5\u53ca\u4e0e\u8be5\u9875\u76f8\u5173\u7684\u4e00\u4e9b\u6807\u5fd7\uff0c\u5982\u662f\u5426\u53ef\u8bfb\u5199\uff0c\u662f\u5426\u5df2\u88ab\u8bbf\u95ee\uff0c\u662f\u5426\u810f\uff08\u88ab\u4fee\u6539\u8fc7\uff09\uff0c\u4ee5\u53ca\u9875\u662f\u5426\u5728\u7269\u7406\u5185\u5b58\u4e2d\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#_1","title":"\u9875\u9762","text":"<p>\u9875\u9762\u4e0e\u9875\u662f\u76f8\u540c\u7684\u6982\u5ff5\u3002\u5728\u5206\u9875\u5185\u5b58\u7ba1\u7406\u4e2d\uff0c\u201c\u9875\u9762\u201d\u662f\u53e6\u4e00\u79cd\u8bf4\u6cd5\uff0c\u6307\u7684\u662f\u88ab\u5206\u914d\u4e86\u7279\u5b9a\u7269\u7406\u5185\u5b58\u9875\u5e27\u7684\u865a\u62df\u5185\u5b58\u533a\u57df\u3002</p> <p>\u9875\u6846\u53f7=\u9875\u5e27\u53f7=\u5185\u5b58\u5757\u53f7=\u7269\u7406\u5757\u53f7=\u7269\u7406\u9875\u53f7</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#_2","title":"\u4ece\u5c5e\u5173\u7cfb","text":"<ol> <li> <p>\u9875\u9762\uff08Page\uff09\uff1a</p> <ul> <li>\u9875\u9762\u662f\u865a\u62df\u5185\u5b58\u4e2d\u5206\u914d\u7684\u57fa\u672c\u5355\u4f4d\uff0c\u901a\u5e38\u5927\u5c0f\u56fa\u5b9a\uff0c\u59824KB\u62162MB\u3002</li> <li> <p>\u9875\u8868\u9879\uff08Page Table Entry, PTE\uff09\uff1a</p> </li> <li> <p>\u6bcf\u4e2a\u9875\u9762\u5728\u9875\u8868\u4e2d\u5bf9\u5e94\u4e00\u4e2a\u9875\u8868\u9879\uff08PTE\uff09\u3002</p> </li> <li>\u9875\u8868\u9879\u5305\u542b\u6620\u5c04\u4fe1\u606f\uff0c\u6307\u793a\u5bf9\u5e94\u9875\u9762\u5728\u7269\u7406\u5185\u5b58\u4e2d\u7684\u5b9e\u9645\u4f4d\u7f6e\uff08\u9875\u5e27\uff09\u3002</li> <li> <p>\u9875\u8868\uff08Page Table\uff09\uff1a</p> </li> <li> <p>\u9875\u8868\u662f\u4e00\u7cfb\u5217\u9875\u8868\u9879\u7684\u96c6\u5408\u3002</p> </li> <li>\u4e00\u4e2a\u9875\u8868\u901a\u5e38\u5305\u62ec\u8db3\u591f\u7684\u9875\u8868\u9879\u6765\u6620\u5c04\u4e00\u5757\u5927\u7684\u865a\u62df\u5730\u5740\u7a7a\u95f4\u81f3\u7269\u7406\u5185\u5b58\u9875\u5e27\u3002</li> <li>\u901a\u5e38\uff0c\u4e00\u4e2a\u9875\u8868\u80fd\u591f\u6620\u5c04\u51e0\u5146\u5b57\u8282\uff08MB\uff09\u7684\u5185\u5b58\u7a7a\u95f4\u3002</li> <li> <p>\u9875\u76ee\u5f55\uff08Page Directory\uff09\uff1a</p> </li> <li> <p>\u9875\u76ee\u5f55\u542b\u6709\u6307\u5411\u9875\u8868\u7684\u6307\u9488\uff0c\u662f\u9875\u8868\u7684\u4e00\u4e2a\u9ad8\u7ea7\u7d22\u5f15\u3002</p> </li> <li>\u5728\u591a\u7ea7\u9875\u8868\u7ed3\u6784\u4e2d\uff0c\u9875\u76ee\u5f55\u662f\u9876\u7ea7\u7ed3\u6784\uff0c\u5b83\u7ec4\u7ec7\u4e86\u4e0b\u5c42\u7684\u9875\u8868\u3002</li> <li>\u5f53\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5f88\u5927\u65f6\uff0c\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a\u9875\u8868\uff0c\u6bcf\u4e2a\u9875\u8868\u8d1f\u8d23\u5730\u5740\u7a7a\u95f4\u7684\u4e00\u90e8\u5206\uff0c\u9875\u76ee\u5f55\u5e2e\u52a9\u7ba1\u7406\u8fd9\u4e9b\u9875\u8868\u3002</li> </ul> </li> </ol> <p>\u603b\u7684\u6765\u770b\uff0c\u4ece\u5c5e\u5173\u7cfb\u53ef\u4ee5\u63cf\u8ff0\u5982\u4e0b\uff1a</p> <ul> <li>\u865a\u62df\u5730\u5740\u7531\u865a\u62df\u9875\u9762\uff08\u5206\u9875\u5927\u5c0f\u7684\u5355\u4f4d\uff09\u7ec4\u6210\u3002</li> <li>\u6bcf\u4e2a\u865a\u62df\u9875\u9762\u90fd\u4f1a\u5728\u9875\u8868\u4e2d\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u9875\u8868\u9879\uff08PTE\uff09\u3002</li> <li>\u6240\u6709\u7684\u9875\u8868\u9879\u7ec4\u6210\u4e86\u4e00\u4e2a\u6216\u591a\u4e2a\u9875\u8868\u3002</li> <li>\u9875\u76ee\u5f55\u5305\u542b\u5bf9\u8fd9\u4e9b\u9875\u8868\u7684\u7d22\u5f15\u3002</li> <li>\u5728\u5206\u9875\u4e2d\uff0c\u9875\u8868\u9879\u6700\u7ec8\u6307\u5411\u7269\u7406\u5185\u5b58\u4e2d\u7684\u9875\u5e27\uff0c\u8fd9\u5c31\u662f\u865a\u62df\u9875\u5230\u7269\u7406\u9875\u5e27\u7684\u6620\u5c04\u3002</li> </ul>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#_3","title":"\u4ee3\u7801","text":"<p>speed up syscall // todo</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#print-a-page-table","title":"Print a page table","text":"<p>\u5728<code>defs.h</code>\u4e2d\u6dfb\u52a0\u58f0\u660e</p> <pre><code>void            vmprint(pagetable_t, int);\n</code></pre> <p><code>exec.c</code>\u4e2d\u4f7f\u7528vmprint()</p> <pre><code>+ if (p-&gt;pid == 1) \n+   vmprint(p-&gt;pagetable, 0);\n  return argc; // this ends up in a0, the first argument to main(argc, argv)\n</code></pre> <p><code>vm.c</code>\u4e2d\u5b9e\u73b0\u8be5\u51fd\u6570</p> <pre><code>void vmprint(pagetable_t pagetable,int depth) {\n  if(depth &gt; 2) { // \u6df1\u5ea6\u5927\u4e8e2\u5c31\u8fd4\u56de\n    return;\n  }\n  if(depth == 0) { // \u6df1\u5ea6\u7b49\u4e8e0\u65f6\u8f93\u51fapagetable\n    printf(\"page table %p\\n\",pagetable);\n  }\n\n  for(int i = 0; i &lt; 512; i++){ // \u904d\u5386\u9875\u8868\u9879\n    pte_t pte = pagetable[i];\n    if(pte &amp; PTE_V) { // \u5982\u679c\u53ef\u4ee5\u8bbf\u95ee\n\n      for(int i=0;i&lt;=depth;i++){ // \u5904\u7406vmprint\u7684\u683c\u5f0f\n        if(i == 0)\n          printf(\"..\");\n        else {\n          printf(\" ..\");\n        }\n      }\n\n      printf(\"%d: pte %p pa %p\\n\",i,pte,PTE2PA(pte)); // \u8f93\u51fa\n\n      uint64 child = PTE2PA(pte); // \u4e0b\u4e00\u7ea7\n      vmprint((pagetable_t)child,depth+1);\n    }\n  }\n}\n</code></pre> <p>pa \u7269\u7406\u5730\u5740</p> <p>pte \u9875\u8868</p> <p>va \u865a\u62df\u5730\u5740</p>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/3.%20Lab%20page%20tables/#a-kernel-page-table-per-process","title":"A kernel page table per process","text":""},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/4.%20Lab%20Traps/","title":"Lab: Traps","text":"<p>x86 \u548c RISC-V \u90fd\u662f\u5c0f\u7aef\u5e8f\uff08\uff09</p> <p></p> <p>\u8c03\u8bd5</p> <pre><code>make qemu-gdb\n\n# \u5b9e\u9a8c\u6307\u5bfc\u4e66\u4e0a\u8bf4, \u8c03\u8bd5\u7684\u65f6\u5019\u6307\u5b9a\u4e00\u4e2aCPU\u8fd0\u884c\u4f1a\u66f4\u597d\u4e00\u4e9b\nmake CPUS=1 qemu-gdb\n\ngdb-multiarch kernel/kernel\n\n# (gdb) \u8fdb\u5165gdb\u540e\u6267\u884c\nset confirm off\nset architecture riscv:rv64\nset riscv use-compressed-breakpoints yes\ntarget remote localhost:25000\n\n\u6216 \nriscv64-linux-gnu-gdb kernel/kernel\n\n\ntarget remote localhost:25000\n</code></pre> <p>\u5982\u679c\u4e0d\u60f3\u6bcf\u6b21\u90fd\u8f93\u5165\u8fd94\u884c\u547d\u4ee4\u7684\u8bdd\uff0c\u53ef\u4ee5\u5728<code>~/.gdbinit</code>\u6587\u4ef6\u91cc\u6dfb\u52a0\u5982\u4e0b\u547d\u4ee4</p> <pre><code>set auto-load safe-path /\nset confirm off\nset architecture riscv:rv64\nset riscv use-compressed-breakpoints yes\ntarget remote localhost:25000\n</code></pre> <p>\u5982\u679c\u8981\u8c03\u8bd5\u7528\u6237\u6001\u4e0b\u7684\u7a0b\u5e8f\uff0c\u9700\u8981 <pre><code>file user/_call\n</code></pre></p> <p>gdb\u5e38\u7528\u6307\u4ee4</p> <pre><code>b # \u6253\u65ad\u70b9 (e.g.     b main | b *0x30)\nc # continue\n\nlayout split # view src-code &amp; asm-code\n\nni # \u5355\u6b65\u6267\u884c\u6c47\u7f16(\u4e0d\u8fdb\u51fd\u6570)\nsi # \u5355\u6b65\u6267\u884c\u6c47\u7f16(\u6709\u51fd\u6570\u5219\u8fdb\u5165\u51fd\u6570)\nn # \u5355\u6b65\u6267\u884c\u6e90\u7801\ns # \u5355\u6b65\u6267\u884c\u6e90\u7801\n\np # print\np $a0 # \u6253\u5370a0\u5bc4\u5b58\u5668\u7684\u503c\np/x 1536 # \u4ee516\u8fdb\u5236\u7684\u683c\u5f0f\u6253\u53701536\ni r a0 # info registers a0\nx/i 0x630 # \u67e5\u770b0x630\u5730\u5740\u5904\u7684\u6307\u4ee4\nx/g 0x80000000 # \u67e5\u770b0x80000000\u5730\u5740\u5904\u7684\u503c\uff08g\u8868\u793a\u503c\u7684\u957f\u5ea6\u670964\u4f4d\uff09\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/MIT6.S081%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/7.%20Lab/","title":"7. Lab","text":"<p>\u591a\u7ebf\u7a0b\u7684\u5e76\u884c\u8fd0\u884c\u4e3b\u8981\u6709\u4e24\u4e2a\u7b56\u7565\uff1a</p> <ul> <li> <p>\u7b2c\u4e00\u4e2a\u7b56\u7565\u662f\u5728\u591a\u6838\u5904\u7406\u5668\u4e0a\u4f7f\u7528\u591a\u4e2aCPU\uff0c\u6bcf\u4e2aCPU\u90fd\u53ef\u4ee5\u8fd0\u884c\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5982\u679c\u4f60\u67094\u4e2aCPU\uff0c\u90a3\u4e48\u6bcf\u4e2aCPU\u53ef\u4ee5\u8fd0\u884c\u4e00\u4e2a\u7ebf\u7a0b\u3002\u6bcf\u4e2a\u7ebf\u7a0b\u81ea\u52a8\u7684\u6839\u636e\u6240\u5728CPU\u5c31\u6709\u4e86\u7a0b\u5e8f\u8ba1\u6570\u5668\u548c\u5bc4\u5b58\u5668\u3002\u4f46\u662f\u5982\u679c\u4f60\u53ea\u67094\u4e2aCPU\uff0c\u5374\u6709\u4e0a\u5343\u4e2a\u7ebf\u7a0b\uff0c\u6bcf\u4e2aCPU\u53ea\u8fd0\u884c\u4e00\u4e2a\u7ebf\u7a0b\u5c31\u4e0d\u80fd\u89e3\u51b3\u8fd9\u91cc\u7684\u95ee\u9898\u4e86\u3002</p> </li> <li> <p>\u6240\u4ee5\u8fd9\u8282\u8bfe\u5927\u90e8\u5206\u65f6\u95f4\u6211\u4eec\u90fd\u4f1a\u5173\u6ce8\u7b2c\u4e8c\u4e2a\u7b56\u7565\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2aCPU\u5728\u591a\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u6765\u56de\u5207\u6362\u3002\u5047\u8bbe\u6211\u53ea\u6709\u4e00\u4e2aCPU\uff0c\u4f46\u662f\u67091000\u4e2a\u7ebf\u7a0b\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u5c06\u4f1a\u770b\u5230XV6\u662f\u5982\u4f55\u5b9e\u73b0\u7ebf\u7a0b\u5207\u6362\u4f7f\u5f97XV6\u80fd\u591f\u5148\u8fd0\u884c\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u4e4b\u540e\u5c06\u7ebf\u7a0b\u7684\u72b6\u6001\u4fdd\u5b58\uff0c\u518d\u5207\u6362\u81f3\u8fd0\u884c\u7b2c\u4e8c\u4e2a\u7ebf\u7a0b\uff0c\u7136\u540e\u518d\u662f\u7b2c\u4e09\u4e2a\u7ebf\u7a0b\uff0c\u4f9d\u6b21\u7c7b\u63a8\u76f4\u5230\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u8fd0\u884c\u4e86\u4e00\u4f1a\uff0c\u518d\u56de\u6765\u91cd\u65b0\u6267\u884c\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u3002</p> </li> </ul> <ul> <li>multi-core </li> <li>switch</li> </ul> <p>\u5728\u6267\u884c\u7ebf\u7a0b\u8c03\u5ea6\u7684\u65f6\u5019\uff0c\u64cd\u4f5c\u7cfb\u7edf\u9700\u8981\u80fd\u533a\u5206\u51e0\u7c7b\u7ebf\u7a0b\uff1a</p> <ul> <li> <p>\u5f53\u524d\u5728CPU\u4e0a\u8fd0\u884c\u7684\u7ebf\u7a0b</p> </li> <li> <p>\u4e00\u65e6CPU\u6709\u7a7a\u95f2\u65f6\u95f4\u5c31\u60f3\u8981\u8fd0\u884c\u5728CPU\u4e0a\u7684\u7ebf\u7a0b</p> </li> <li> <p>\u4ee5\u53ca\u4e0d\u60f3\u8fd0\u884c\u5728CPU\u4e0a\u7684\u7ebf\u7a0b\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u7ebf\u7a0b\u53ef\u80fd\u5728\u7b49\u5f85I/O\u6216\u8005\u5176\u4ed6\u4e8b\u4ef6</p> </li> </ul> <ul> <li> <p>RUNNING\uff0c\u7ebf\u7a0b\u5f53\u524d\u6b63\u5728\u67d0\u4e2aCPU\u4e0a\u8fd0\u884c</p> </li> <li> <p>RUNABLE\uff0c\u7ebf\u7a0b\u8fd8\u6ca1\u6709\u5728\u67d0\u4e2aCPU\u4e0a\u8fd0\u884c\uff0c\u4f46\u662f\u4e00\u65e6\u6709\u7a7a\u95f2\u7684CPU\u5c31\u53ef\u4ee5\u8fd0\u884c</p> </li> <li> <p>SLEEPING\uff0c\u8fd9\u8282\u8bfe\u6211\u4eec\u4e0d\u4f1a\u4ecb\u7ecd\uff0c\u4e0b\u8282\u8bfe\u4f1a\u91cd\u70b9\u4ecb\u7ecd\uff0c\u8fd9\u4e2a\u72b6\u6001\u610f\u5473\u7740\u7ebf\u7a0b\u5728\u7b49\u5f85\u4e00\u4e9bI/O\u4e8b\u4ef6\uff0c\u5b83\u53ea\u4f1a\u5728I/O\u4e8b\u4ef6\u53d1\u751f\u4e86\u4e4b\u540e\u8fd0\u884c</p> </li> </ul>"},{"location":"%E5%85%B6%E4%BB%96/NJU%20OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","title":"\u64cd\u4f5c\u7cfb\u7edf","text":""},{"location":"%E5%85%B6%E4%BB%96/NJU%20OS/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/#3","title":"3. \u786c\u4ef6\u89c6\u89d2\u7684\u64cd\u4f5c\u7cfb\u7edf","text":"<p>strace \u67e5\u770b\u8fdb\u7a0b\u7684\u7cfb\u7edf\u8c03\u7528 xxd \u67e5\u770b\u4e8c\u8fdb\u5236\u6587\u4ef6</p> <p>Linux\u4e0b\u6808\u7684\u5927\u5c0f\u4e00\u822c\u4e3a --&gt; 8192 KB</p> <pre><code>ulimit -s\n</code></pre> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint x = 0;\nint y = 0;\n\nvoid T1() {\n    x = 1;\n    int t = y;\n    printf(\" %d\",t);\n}\n\nvoid T2() {\n    y = 1;\n    int t = x;\n    printf(\" %d\",t);\n}\n\n\nint main() {\n\n    int pid = fork();\n    if(pid == 0) {\n      T1();  \n    } else {\n      T2();\n    }\n    return 0;\n}\n</code></pre> <p>\u7ed3\u679c <pre><code>\u7edd\u5927\u591a\u6570\uff1a00\n\u5c11\u6570\uff1a01\u300110\n\u6781\u5c11\u6570\uff1a11\n</code></pre></p> <p>\u5e76\u53d1\u7a0b\u5e8f\u8bbe\u8ba1\u4e09\u8981\u7d20: \u539f\u5b50\u6027 \u6709\u5e8f\u6027 \u53ef\u89c1\u6027</p> <p>\u4ec0\u4e48\u662fPeterson\u7b97\u6cd5\uff1f</p> <p>\u4ec0\u4e48\u662f\u81ea\u65cb\u9501\uff1f</p> <pre><code>// \u5047\u8bbe\u5b58\u5728\u786c\u4ef6\u539f\u5b50\u64cd\u4f5c\uff1aTest-and-Set(TAS)\u6307\u4ee4\n// lock \u8868\u793a\u81ea\u65cb\u9501\u53d8\u91cf\uff0c\u521d\u59cb\u5316\u4e3a 0\uff0c\u8868\u793a\u672a\u9501\u5b9a\u72b6\u6001\n\nfunction acquireLock(lock):\n    while (TAS(lock) == 1):\n        // \u81ea\u65cb\u7b49\u5f85\uff0c\u76f4\u5230\u83b7\u53d6\u9501\n        // TAS(lock) \u8fd4\u56de 1 \u8868\u793a\u9501\u5df2\u7ecf\u88ab\u5176\u4ed6\u7ebf\u7a0b\u5360\u7528\uff0c\u7ee7\u7eed\u81ea\u65cb\u7b49\u5f85\n    // \u83b7\u53d6\u5230\u9501\u540e\u9000\u51fa\u5faa\u73af\n    return\n\nfunction releaseLock(lock):\n    lock = 0\n    // \u91ca\u653e\u9501\n\n// \u5728\u4e34\u754c\u533a\u5185\u7684\u4ee3\u7801\nacquireLock(myLock)\n// \u6267\u884c\u4e34\u754c\u533a\u7684\u4ee3\u7801\n// ...\nreleaseLock(myLock)\n</code></pre> <p>\u4e0a\u8ff0\u4f2a\u4ee3\u7801\u5047\u8bbe\u6709\u540d\u4e3a <code>TAS</code> \u7684\u539f\u5b50\u64cd\u4f5c\uff0c\u5b83\u662f\u4e00\u4e2a\u57fa\u672c\u7684\u786c\u4ef6\u539f\u5b50\u6307\u4ee4\uff0c\u53ef\u4ee5\u539f\u5b50\u5730\u8bbe\u7f6e\u4e00\u4e2a\u53d8\u91cf\u4e3a1\u5e76\u8fd4\u56de\u5176\u65e7\u503c\u3002\u5982\u679c\u8be5\u53d8\u91cf\u539f\u6765\u662f0\uff0c\u5219\u8bf4\u660e\u5f53\u524d\u7ebf\u7a0b\u6210\u529f\u83b7\u53d6\u4e86\u9501\u3002\u5982\u679c\u8fd4\u56de\u7684\u65e7\u503c\u662f1\uff0c\u5219\u8bf4\u660e\u9501\u5df2\u7ecf\u88ab\u5176\u4ed6\u7ebf\u7a0b\u5360\u7528\uff0c\u5f53\u524d\u7ebf\u7a0b\u7ee7\u7eed\u5728\u5faa\u73af\u4e2d\u81ea\u65cb\u7b49\u5f85\u3002</p> <p>\u4f7f\u7528xchg\u5b9e\u73b0\u4e92\u65a5</p> <pre><code>// lock \u8868\u793a\u4e92\u65a5\u9501\u53d8\u91cf\uff0c\u521d\u59cb\u5316\u4e3a 0\uff0c\u8868\u793a\u672a\u9501\u5b9a\u72b6\u6001\n\nfunction acquireLock(lock):\n    while (xchg(lock, 1) == 1):\n        // \u5c06 lock \u7684\u503c\u548c 1 \u4ea4\u6362\uff0c\u5e76\u8fd4\u56de\u539f\u6765\u7684 lock \u503c\n        // \u5982\u679c\u8fd4\u56de\u7684\u662f 1\uff0c\u8868\u793a\u9501\u5df2\u7ecf\u88ab\u5176\u4ed6\u7ebf\u7a0b\u5360\u7528\uff0c\u7ee7\u7eed\u81ea\u65cb\u7b49\u5f85\n    // \u83b7\u53d6\u5230\u9501\u540e\u9000\u51fa\u5faa\u73af\n    return\n\nfunction releaseLock(lock):\n    lock = 0\n    // \u5c06 lock \u7684\u503c\u8bbe\u7f6e\u4e3a 0\uff0c\u91ca\u653e\u9501\n\n// \u5728\u4e34\u754c\u533a\u5185\u7684\u4ee3\u7801\nacquireLock(myLock)\n// \u6267\u884c\u4e34\u754c\u533a\u7684\u4ee3\u7801\n// ...\nreleaseLock(myLock)\n</code></pre> <p>\u4ec0\u4e48\u662fcmpxchg</p> <p><code>cmpxchg</code> \u662f\u4e00\u79cd\u539f\u5b50\u6307\u4ee4\uff0c\u7528\u4e8e\u5728\u591a\u5904\u7406\u5668\u73af\u5883\u4e2d\u6267\u884c\u539f\u5b50\u6bd4\u8f83\u548c\u4ea4\u6362\u64cd\u4f5c\u3002\u5728x86\u67b6\u6784\u4e0a\uff0c<code>cmpxchg</code> \u6307\u4ee4\u7528\u4e8e\u6bd4\u8f83\u4e00\u4e2a\u5185\u5b58\u4f4d\u7f6e\u7684\u503c\u548c\u4e00\u4e2a\u9884\u671f\u503c\uff0c\u5982\u679c\u5b83\u4eec\u76f8\u7b49\uff0c\u5219\u5c06\u8be5\u5185\u5b58\u4f4d\u7f6e\u7684\u503c\u66ff\u6362\u4e3a\u4e00\u4e2a\u65b0\u503c\u3002\u8fd9\u4e2a\u64cd\u4f5c\u662f\u539f\u5b50\u7684\uff0c\u610f\u5473\u7740\u5728\u6267\u884c\u671f\u95f4\u4e0d\u4f1a\u88ab\u5176\u4ed6\u7ebf\u7a0b\u7684\u64cd\u4f5c\u4e2d\u65ad\u3002</p> <p>\u5728x86\u67b6\u6784\u4e0a\uff0c<code>cmpxchg</code> \u6307\u4ee4\u6709\u591a\u4e2a\u53d8\u79cd\uff0c\u4e3b\u8981\u53d6\u51b3\u4e8e\u8981\u6bd4\u8f83\u548c\u4ea4\u6362\u7684\u6570\u636e\u7c7b\u578b\u3002\u5e38\u89c1\u7684\u51e0\u4e2a\u53d8\u79cd\u5305\u62ec <code>cmpxchg</code>, <code>cmpxchg8b</code>, <code>cmpxchg16b</code> \u7b49\u3002\u8fd9\u4e9b\u6307\u4ee4\u7528\u4e8e\u5904\u7406\u4e0d\u540c\u5927\u5c0f\u7684\u6570\u636e\u7c7b\u578b\uff0c\u5982\u5355\u5b57\u8282\u3001\u53cc\u5b57\u8282\u3001\u56db\u5b57\u8282\u3001\u516b\u5b57\u8282\u6216\u66f4\u5927\u3002</p> <p>\u5728\u7f16\u7a0b\u4e2d\uff0c<code>cmpxchg</code> \u6307\u4ee4\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u539f\u5b50\u64cd\u4f5c\uff0c\u5982\u81ea\u65cb\u9501\u3001\u4e92\u65a5\u9501\u3001\u65e0\u9501\u6570\u636e\u7ed3\u6784\u7b49\u3002\u5b83\u53ef\u4ee5\u786e\u4fdd\u591a\u4e2a\u7ebf\u7a0b\u5728\u5e76\u53d1\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u65f6\u4e0d\u4f1a\u4ea7\u751f\u7ade\u6001\u6761\u4ef6\u6216\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\uff0c\u5c55\u793a\u4e86\u4f7f\u7528 <code>cmpxchg</code> \u6307\u4ee4\u5b9e\u73b0\u539f\u5b50\u6bd4\u8f83\u548c\u4ea4\u6362\u7684\u4f2a\u4ee3\u7801\uff1a</p> <pre><code>// \u5047\u8bbe\u6709\u4e00\u4e2a\u5171\u4eab\u7684\u53d8\u91cf sharedValue\uff0c\u548c\u4e00\u4e2a\u9884\u671f\u503c expectedValue\n\nfunction atomicCompareAndSwap(sharedValue, expectedValue, newValue):\n    if (sharedValue == expectedValue):\n        // \u5982\u679c sharedValue \u7b49\u4e8e\u9884\u671f\u503c expectedValue\n        // \u5219\u7528 newValue \u66ff\u6362 sharedValue\uff0c\u5e76\u8fd4\u56de true \u8868\u793a\u4ea4\u6362\u6210\u529f\n        // \u5426\u5219\u8fd4\u56de false \u8868\u793a\u4ea4\u6362\u5931\u8d25\n        sharedValue = newValue\n        return true\n    else:\n        return false\n\n// \u4f7f\u7528 atomicCompareAndSwap \u6765\u4fdd\u62a4\u5171\u4eab\u8d44\u6e90\nfunction updateSharedResource(newValue):\n    do:\n        currentValue = sharedValue\n        // \u5047\u8bbe currentValue \u662f\u5171\u4eab\u8d44\u6e90\u7684\u5f53\u524d\u503c\n        if (atomicCompareAndSwap(sharedValue, currentValue, newValue)):\n            // \u4ea4\u6362\u6210\u529f\uff0c\u5171\u4eab\u8d44\u6e90\u66f4\u65b0\u5b8c\u6210\n            break\n        // \u4ea4\u6362\u5931\u8d25\uff0c\u7ee7\u7eed\u5faa\u73af\uff0c\u91cd\u8bd5\u66f4\u65b0\u5171\u4eab\u8d44\u6e90\n    while (true)\n</code></pre> <p>\u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c<code>atomicCompareAndSwap</code> \u51fd\u6570\u5229\u7528\u4e86 <code>cmpxchg</code> \u6307\u4ee4\u6765\u6bd4\u8f83 <code>sharedValue</code> \u548c <code>expectedValue</code> \u662f\u5426\u76f8\u7b49\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5219\u7528 <code>newValue</code> \u66ff\u6362 <code>sharedValue</code>\uff0c\u5e76\u8fd4\u56de\u4ea4\u6362\u662f\u5426\u6210\u529f\u7684\u7ed3\u679c\u3002\u5982\u679c\u4ea4\u6362\u5931\u8d25\uff0c\u8bf4\u660e <code>sharedValue</code> \u5df2\u7ecf\u88ab\u5176\u4ed6\u7ebf\u7a0b\u4fee\u6539\uff0c\u6b64\u65f6\u9700\u8981\u91cd\u8bd5\u66f4\u65b0\u5171\u4eab\u8d44\u6e90\uff0c\u76f4\u5230\u4ea4\u6362\u6210\u529f\u4e3a\u6b62\u3002</p> <p>\u6bd4\u8f83\u5e76\u4ea4\u6362(xmpxchg)\u64cd\u4f5c\u7684\u4f18\u52bf\u5728\u4e8e\uff0c\u5b83\u53ef\u4ee5\u907f\u514d\u81ea\u65cb\u7b49\u5f85\uff0c\u56e0\u4e3a\u53ea\u6709\u5728\u64cd\u4f5c\u6210\u529f\u7684\u60c5\u51b5\u4e0b\uff0c\u624d\u4f1a\u771f\u6b63\u5730\u4fee\u6539\u5185\u5b58\u4f4d\u7f6e\u7684\u503c\uff0c\u800c\u5931\u8d25\u65f6\u53ef\u4ee5\u7acb\u5373\u8fd4\u56de\u5e76\u91cd\u65b0\u5c1d\u8bd5\uff0c\u51cf\u5c11\u4e86\u8d44\u6e90\u6d6a\u8d39\u3002</p> <p></p> <p>\u4e92\u65a5\u9501\uff08Mutex\uff09\u548c\u81ea\u65cb\u9501\uff08Spin Lock\uff09\u662f\u4e24\u79cd\u5e38\u89c1\u7684\u7ebf\u7a0b\u540c\u6b65\u673a\u5236\uff0c\u5b83\u4eec\u6709\u4e00\u4e9b\u5173\u952e\u533a\u522b\uff1a</p> <p>\u4e92\u65a5\u9501\u662f\u4e00\u79cd\u963b\u585e\u9501</p> <p>\u800c\u81ea\u65cb\u9501\u662f\u4e00\u79cd\u975e\u963b\u585e\u9501</p> <ol> <li> <p>\u7b49\u5f85\u65b9\u5f0f\uff1a</p> <ul> <li>\u4e92\u65a5\u9501\uff1a\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5c1d\u8bd5\u83b7\u53d6\u4e92\u65a5\u9501\u65f6\uff0c\u5982\u679c\u9501\u5df2\u7ecf\u88ab\u5176\u4ed6\u7ebf\u7a0b\u5360\u7528\uff0c\u8be5\u7ebf\u7a0b\u5c06\u88ab\u963b\u585e\u6302\u8d77\uff0c\u76f4\u5230\u9501\u88ab\u91ca\u653e\u3002\u7ebf\u7a0b\u4f1a\u8fdb\u5165\u7761\u7720\u72b6\u6001\uff0c\u4e0d\u4f1a\u5360\u7528CPU\u8d44\u6e90\u3002</li> <li>\u81ea\u65cb\u9501\uff1a\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5c1d\u8bd5\u83b7\u53d6\u81ea\u65cb\u9501\u65f6\uff0c\u5982\u679c\u9501\u5df2\u7ecf\u88ab\u5176\u4ed6\u7ebf\u7a0b\u5360\u7528\uff0c\u8be5\u7ebf\u7a0b\u5c06\u5728\u5faa\u73af\u4e2d\u81ea\u65cb\u7b49\u5f85\uff0c\u4e0d\u4f1a\u8fdb\u5165\u7761\u7720\u72b6\u6001\uff0c\u800c\u662f\u4e00\u76f4\u5360\u7528CPU\u8d44\u6e90\uff0c\u76f4\u5230\u83b7\u53d6\u5230\u9501\u3002</li> <li> <p>\u5360\u7528CPU\u8d44\u6e90\uff1a</p> </li> <li> <p>\u4e92\u65a5\u9501\uff1a\u7531\u4e8e\u7b49\u5f85\u65f6\u7ebf\u7a0b\u4f1a\u8fdb\u5165\u7761\u7720\u72b6\u6001\uff0c\u4e0d\u4f1a\u5360\u7528CPU\u8d44\u6e90\uff0c\u56e0\u6b64\u5728\u4e92\u65a5\u9501\u7684\u7b49\u5f85\u8fc7\u7a0b\u4e2d\uff0cCPU\u53ef\u4ee5\u88ab\u5176\u4ed6\u53ef\u8fd0\u884c\u7684\u7ebf\u7a0b\u5229\u7528\u3002</p> </li> <li>\u81ea\u65cb\u9501\uff1a\u7b49\u5f85\u65f6\u7ebf\u7a0b\u4e00\u76f4\u5728\u81ea\u65cb\u5faa\u73af\u4e2d\uff0c\u4f1a\u5360\u7528CPU\u8d44\u6e90\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u9ad8CPU\u5229\u7528\u7387\uff0c\u5c24\u5176\u5728\u9501\u7ade\u4e89\u6fc0\u70c8\u7684\u60c5\u51b5\u4e0b\u3002</li> <li> <p>\u9002\u7528\u573a\u666f\uff1a</p> </li> <li> <p>\u4e92\u65a5\u9501\uff1a\u9002\u7528\u4e8e\u4e34\u754c\u533a\u4fdd\u62a4\u65f6\u95f4\u8f83\u957f\u7684\u60c5\u51b5\uff0c\u5f53\u7ebf\u7a0b\u9700\u8981\u7b49\u5f85\u8f83\u957f\u65f6\u95f4\u624d\u80fd\u83b7\u5f97\u9501\u65f6\uff0c\u4e92\u65a5\u9501\u7684\u963b\u585e\u7b49\u5f85\u65b9\u5f0f\u662f\u66f4\u5408\u7406\u7684\u9009\u62e9\u3002</p> </li> <li>\u81ea\u65cb\u9501\uff1a\u9002\u7528\u4e8e\u4e34\u754c\u533a\u4fdd\u62a4\u65f6\u95f4\u8f83\u77ed\u7684\u60c5\u51b5\uff0c\u4f8b\u5982\u4e34\u754c\u533a\u7684\u4ee3\u7801\u5f88\u77ed\u6216\u5728\u5355\u6838\u5904\u7406\u5668\u4e0a\u8fd0\u884c\uff0c\u8fd9\u6837\u81ea\u65cb\u7b49\u5f85\u7684\u5f00\u9500\u76f8\u5bf9\u8f83\u5c0f\uff0c\u907f\u514d\u4e86\u7ebf\u7a0b\u5207\u6362\u5e26\u6765\u7684\u5f00\u9500\u3002</li> <li> <p>\u5185\u5b58\u5f00\u9500\uff1a</p> </li> <li> <p>\u4e92\u65a5\u9501\uff1a\u901a\u5e38\u6bd4\u81ea\u65cb\u9501\u5360\u7528\u66f4\u591a\u7684\u5185\u5b58\uff0c\u56e0\u4e3a\u4e92\u65a5\u9501\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u7b49\u5f85\u961f\u5217\u6765\u7ba1\u7406\u7b49\u5f85\u83b7\u53d6\u9501\u7684\u7ebf\u7a0b\u3002</p> </li> <li>\u81ea\u65cb\u9501\uff1a\u901a\u5e38\u6bd4\u4e92\u65a5\u9501\u5360\u7528\u66f4\u5c11\u7684\u5185\u5b58\uff0c\u56e0\u4e3a\u81ea\u65cb\u9501\u4e0d\u9700\u8981\u7ef4\u62a4\u7b49\u5f85\u961f\u5217\uff0c\u53ea\u9700\u8981\u4e00\u4e2a\u7b80\u5355\u7684\u6807\u5fd7\u6765\u8868\u793a\u9501\u7684\u72b6\u6001\u3002</li> </ul> </li> </ol> <p>\u9700\u8981\u6839\u636e\u5177\u4f53\u7684\u5e94\u7528\u573a\u666f\u548c\u6027\u80fd\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u7ebf\u7a0b\u540c\u6b65\u673a\u5236\u3002\u5728\u591a\u6838\u5904\u7406\u5668\u4e0a\uff0c\u81ea\u65cb\u9501\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9ad8CPU\u5360\u7528\uff0c\u56e0\u6b64\u901a\u5e38\u63a8\u8350\u5728\u4e34\u754c\u533a\u4fdd\u62a4\u65f6\u95f4\u8f83\u957f\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u4e92\u65a5\u9501\u3002\u800c\u5728\u5355\u6838\u5904\u7406\u5668\u4e0a\u6216\u4e34\u754c\u533a\u4fdd\u62a4\u65f6\u95f4\u8f83\u77ed\u7684\u60c5\u51b5\u4e0b\uff0c\u81ea\u65cb\u9501\u53ef\u80fd\u662f\u4e00\u4e2a\u66f4\u6709\u6548\u7684\u9009\u62e9\u3002</p> <p></p> <p>\u81ea\u65cb\u9501\u5728\u7ebf\u7a0b\u4e0a\u8fdb\u884c\u9501\u64cd\u4f5c\uff0c\u4e92\u65a5\u9501\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528\u8bbf\u95eelock</p>"},{"location":"%E5%85%B6%E4%BB%96/OSTEP/OSTEP%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/","title":"OSTEP\u8bfb\u4e66\u7b14\u8bb0","text":""},{"location":"%E5%85%B6%E4%BB%96/OSTEP/OSTEP%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/#_1","title":"\u64cd\u4f5c\u7cfb\u7edf","text":"<p>\u8fdb\u7a0b\u7684\u4e09\u79cd\u72b6\u6001\uff1a - \u8fd0\u884c\uff08running\uff09\uff1a\u5728\u8fd0\u884c\u72b6\u6001\u4e0b\uff0c\u8fdb\u7a0b\u6b63\u5728\u5904\u7406\u5668\u4e0a\u8fd0\u884c\u3002\u8fd9\u610f\u5473\u7740\u5b83\u6b63\u5728\u6267\u884c\u6307\u4ee4\u3002 - \u5c31\u7eea\uff08ready\uff09\uff1a\u5728\u5c31\u7eea\u72b6\u6001\u4e0b\uff0c\u8fdb\u7a0b\u5df2\u51c6\u5907\u597d\u8fd0\u884c\uff0c\u4f46\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\uff0c\u64cd\u4f5c\u7cfb\u7edf\u9009\u62e9\u4e0d\u5728\u6b64\u65f6\u8fd0\u884c\u3002 - \u963b\u585e\uff08blocked\uff09\uff1a\u5728\u963b\u585e\u72b6\u6001\u4e0b\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u6267\u884c\u4e86\u67d0\u79cd\u64cd\u4f5c\uff0c\u76f4\u5230\u53d1\u751f\u5176\u4ed6\u4e8b\u4ef6\u65f6\u624d\u4f1a\u51c6\u5907\u8fd0\u884c\u3002\u4e00\u4e2a\u5e38\u89c1\u7684\u4f8b\u5b50\u662f\uff0c\u5f53\u8fdb\u7a0b\u5411\u78c1\u76d8\u53d1\u8d77 I/O \u8bf7\u6c42\u65f6\uff0c\u5b83\u4f1a\u88ab\u963b\u585e\uff0c \u56e0\u6b64\u5176\u4ed6\u8fdb\u7a0b\u53ef\u4ee5\u4f7f\u7528\u5904\u7406\u5668\u3002</p> <p></p> <p>MLFQ: \u591a\u7ea7\u53cd\u9988\u961f\u5217</p> <p>\u865a\u62df\u5316import part\uff1a\u8fdb\u7a0b\u8c03\u5ea6\u3001\u9875\u8868\u3001\u5730\u5740\u8f6c\u6362</p> <p> Two-level page table structure in\u00a0x86\u00a0architecture (without\u00a0PAE\u00a0or\u00a0PSE).</p>"},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.%20%E6%A6%82%E8%AE%BA/","title":"\u6982\u8bba","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.%20%E6%A6%82%E8%AE%BA/#1internet","title":"1.\u4ec0\u4e48\u662fInternet","text":"<p>\u7f51\u7edc\u7684\u57fa\u672c\u7ec4\u6210\uff1a\u8282\u70b9\u548c\u8fb9\u3002 Internet\uff08\u56e0\u7279\u7f51\uff09\u5b9e\u9645\u4e0a\u662f\u201c\u7f51\u7edc\u7684\u7f51\u7edc\u201d\uff0c\u662f\u7531\u4e00\u5806\u7f51\u7edc\u901a\u8fc7\u7f51\u7edc\u4e92\u8054\u8bbe\u5907\u8fde\u63a5\u8d77\u6765\u7684\u5de8\u578b\u7f51\u7edc</p> <p>Internet\u7684\u57fa\u672c\u7ec4\u6210\uff1a\u8282\u70b9\u3001\u8fb9\u548c\u534f\u8bae \u4ee5TCP\u534f\u8bae\u548cIP\u534f\u8bae\u4e3a\u4e3b\u7684\u4e00\u7c07\u534f\u8bae\u652f\u6491\u5de5\u4f5c\u7684\u7f51\u4fbf\u662f\u4e92\u8054\u7f51(Internet)\u3002</p> <ul> <li> <p>\u8282\u70b9</p> <ul> <li>\u4e3b\u673a\u7ed3\u70b9\uff1a\u4e3b\u673a<code>host</code> = \u7aef\u7cfb\u7edf<code>end system</code>\u3002\u4ee5\u53ca\u8fd0\u884c\u7684\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u3002\u6837\u5f0f\u4e3a <code>\u25a1</code> \u65b9\u5f62</li> <li>\u4ea4\u6362\u8282\u70b9\uff1a\u6837\u5f0f\u4e3a \u25cb \u5706\u5f62<ul> <li>\u4ea4\u6362\u673a\uff1a\u5728\u94fe\u8def\u5c42</li> <li>\u8def\u7531\u5668\uff1a\u5728\u7f51\u7edc\u5c42</li> </ul> </li> </ul> </li> <li> <p>\u8fb9</p> <ul> <li>\u901a\u4fe1\u94fe\u8def\uff1a\u4ee5vp/s\u4f5c\u4e3a\u5355\u4f4d<ul> <li>\u63a5\u5165\u94fe\u8def\uff1a\u4e3b\u673a\u8fde\u63a5\u5230\u4e92\u8054\u7f51\u7684\u94fe\u8def\uff0c\u5373 <code>\u25a1\u2014\u2014\u25cb</code></li> <li>\u4e3b\u5e72\u94fe\u8def\uff1a\u8def\u7531\u5668\u95f4\u7684\u94fe\u8def\uff0c\u5373 <code>\u25cb\u2014\u2014\u25cb</code></li> </ul> </li> </ul> </li> <li> <p>\u534f\u8bae\uff1a\u5bf9\u7b49\u5c42\u7684\u5b9e\u4f53\u901a\u4fe1\u8fc7\u7a0b\u4e2d\u9075\u5b88\u7684\u7684\u89c4\u8303</p> <ul> <li>\u4ee5TCP\u534f\u8bae\u548cIP\u534f\u8bae\u4e3a\u4e3b\u7684\u4e00\u7c07\u534f\u8bae\u652f\u6491\u5de5\u4f5c\u7684\u7f51\u4fbf\u662f\u4e92\u8054\u7f51(Internet)\u3002</li> </ul> </li> </ul> <p>IETF</p>"},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.%20%E6%A6%82%E8%AE%BA/#2","title":"2.\u7f51\u7edc\u8fb9\u7f18","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.%20%E6%A6%82%E8%AE%BA/#3","title":"3.\u7f51\u7edc\u6838\u5fc3","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.%20%E6%A6%82%E8%AE%BA/#4","title":"4.\u63a5\u5165\u7f51\u548c\u7269\u7406\u5a92\u4f53","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.%20%E6%A6%82%E8%AE%BA/#5internetips","title":"5.Internet\u7ed3\u6784\u548cIPS","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.%20%E6%A6%82%E8%AE%BA/#6","title":"6.\u5206\u7ec4\u5ef6\u65f6\u3001\u4e22\u5931\u548c\u541e\u5410\u91cf","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/1.%20%E6%A6%82%E8%AE%BA/#7","title":"7.\u534f\u8bae\u5c42\u6b21\u548c\u670d\u52a1\u6a21\u578b","text":"<pre><code>graph TD;\n    subgraph Internet\n        A(\u5ba2\u6237\u7aef) --&gt;|\u8bf7\u6c42| B(\u672c\u5730ISP);\n        B --&gt;|\u8f6c\u53d1| C(\u4e3b\u5e72ISP);\n        C --&gt;|\u8f6c\u53d1| D(\u8fb9\u7f18\u8def\u7531\u5668);\n        D --&gt;|\u8def\u7531| E(\u76ee\u6807\u670d\u52a1\u5668);\n    end\n\n    style A fill:#FFCC00,stroke:#292c3c,stroke-width:2px;\n    style B fill:#CCFF99,stroke:#292c3c,stroke-width:2px;\n    style C fill:#66CCFF,stroke:#292c3c,stroke-width:2px;\n    style D fill:#CC99FF,stroke:#292c3c,stroke-width:2px;\n    style E fill:#FFCC00,stroke:#292c3c,stroke-width:2px;\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/CS144/","title":"CS144","text":"<p>version sponge 2021</p> <p>\u51c6\u5907</p> <p>make\u65f6\u51fa\u73b0\u9519\u8bef <code>error: 'out_of_range' was not declared in this scope</code></p> <p>\u89e3\u51b3\u65b9\u6cd5: \u5728libsponge/util/buffer.hh\u4e2d\u6dfb\u52a0<code>#include &lt;stdexcept&gt;</code>\u4e00\u884c</p> <p>\u9519\u8bef\uff1a\u53d8\u91cf\u2018std::array ip\u2019\u6709\u521d\u59cb\u503c\u8bbe\u5b9a\uff0c\u4f46\u662f\u7c7b\u578b\u4e0d\u5b8c\u5168 build 91 | array ip{}; <p>\u89e3\u51b3\u65b9\u6cd5:  \u5728util.hh\u6dfb\u52a0<code>#include &lt;array&gt;</code></p>","tags":["\u8ba1\u7b97\u673a\u7f51\u7edc"]},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/CS144/#lab0","title":"Lab0","text":"","tags":["\u8ba1\u7b97\u673a\u7f51\u7edc"]},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/CS144/#webget","title":"webget","text":"<p>webget.cc <pre><code>void get_URL(const string &amp;host, const string &amp;path) {\n    // Your code here.\n\n    // You will need to connect to the \"http\" service on\n    // the computer whose name is in the \"host\" string,\n    // then request the URL path given in the \"path\" string.\n\n    // Then you'll need to print out everything the server sends back,\n    // (not just one call to read() -- everything) until you reach\n    // the \"eof\" (end of file).\n\n    // \u521b\u5efasocket\n    std::shared_ptr&lt;TCPSocket&gt; socket = std::make_shared&lt;TCPSocket&gt;();\n\n    // \u7ed1\u5b9a\u5730\u5740\n    Address address(host, \"http\");\n\n    // \u8fde\u63a5\n    socket-&gt;connect(address);\n\n    // \u53d1\u9001\u8bf7\u6c42\n    string msg = \"GET \" + path +\n                 \" HTTP/1.1\\r\\n\"\n                 \"Host: \" +\n                 host +\n                 \"\\r\\n\"\n                 \"Connection: close\\r\\n\\r\\n\";\n\n    socket-&gt;write(msg);\n\n    string result;\n    while (!socket-&gt;eof()) {\n        result = socket-&gt;read(); // \u63a5\u6536\n        cout&lt;&lt;result;\n    }\n}\n</code></pre></p> <p>\u76f8\u5173\u77e5\u8bc6:</p> <p>Http\u62a5\u6587\u7ed3\u6784</p> <pre><code>GET path HTTP/1.1\nHost: host\nConnection: keep-alive // \u6216\u8005 Connection: close\n</code></pre> <p></p>","tags":["\u8ba1\u7b97\u673a\u7f51\u7edc"]},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/CS144/#an-in-memory-reliable-byte-stream","title":"An in-memory reliable byte stream","text":"<p>\u5185\u5b58\u4e2d\u53ef\u9760\u7684\u5b57\u8282\u6d41</p> <p>code:</p> <p>p0 byte_stream</p>","tags":["\u8ba1\u7b97\u673a\u7f51\u7edc"]},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/CS144/#lab-1","title":"Lab 1","text":"<p>\u5408\u5e76\u65e0\u5173\u7684\u5206\u652f <pre><code>git merge master --allow-unrelated-histories\n</code></pre></p> <p>\u60a8\u8981\u5728\u8fd9\u4e2a\u548c\u4e0b\u4e00\u4e2a\u5b9e\u9a8c\u5ba4\u4e2d\u5b9e\u73b0\u4e00\u4e2aTCP\u63a5\u6536\u5668\uff1a\u8be5\u6a21\u5757\u63a5\u6536\u6570\u636e\u62a5\u5e76\u5c06\u5176\u8f6c\u6362\u4e3a\u53ef\u9760\u7684\u5b57\u8282\u6d41\uff0c\u4ee5\u4fbf\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u5957\u63a5\u5b57\u8bfb\u53d6\uff0c\u5c31\u50cf\u60a8\u5728\u5b9e\u9a8c\u5ba40\u4e2d\u7684webget\u7a0b\u5e8f\u4eceweb\u670d\u52a1\u5668\u8bfb\u53d6\u5b57\u8282\u6d41\u4e00\u6837\u3002TCP\u53d1\u9001\u5668\u5c06\u5176\u5b57\u8282\u6d41\u5206\u6210\u77ed\u6bb5\uff08\u6bcf\u4e2a\u5b50\u5b57\u7b26\u4e32\u4e0d\u8d85\u8fc7\u5927\u7ea61460\u4e2a\u5b57\u8282\uff09\uff0c\u4ee5\u4fbf\u5b83\u4eec\u6bcf\u4e2a\u90fd\u80fd\u9002\u5e94\u4e00\u4e2a\u6570\u636e\u62a5\u3002\u4f46\u662f\u7f51\u7edc\u53ef\u80fd\u4f1a\u91cd\u65b0\u6392\u5e8f\u8fd9\u4e9b\u6570\u636e\u62a5\uff0c\u6216\u8005\u4e22\u5f03\u5b83\u4eec\uff0c\u6216\u8005\u591a\u6b21\u4ea4\u4ed8\u5b83\u4eec\u3002\u63a5\u6536\u5668\u5fc5\u987b\u5c06\u8fd9\u4e9b\u6bb5\u91cd\u65b0\u7ec4\u88c5\u6210\u5b83\u4eec\u6700\u521d\u7684\u8fde\u7eed\u5b57\u8282\u6d41\u3002</p> <p>\u5728\u8fd9\u4e2a\u5b9e\u9a8c\u5ba4\u4e2d\uff0c\u60a8\u5c06\u7f16\u5199\u8d1f\u8d23\u8fd9\u79cd\u91cd\u7ec4\u7684\u6570\u636e\u7ed3\u6784\uff1a\u4e00\u4e2aStreamReassembler\u3002\u5b83\u5c06\u63a5\u6536\u5b50\u5b57\u7b26\u4e32\uff0c\u7531\u5b57\u8282\u5b57\u7b26\u4e32\u548c\u8be5\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u4e2a\u5b57\u8282\u5728\u66f4\u5927\u6d41\u4e2d\u7684\u7d22\u5f15\u7ec4\u6210\u3002\u6d41\u4e2d\u7684\u6bcf\u4e2a\u5b57\u8282\u90fd\u6709\u81ea\u5df1\u552f\u4e00\u7684\u7d22\u5f15\uff0c\u4ece\u96f6\u5f00\u59cb\u5e76\u5411\u4e0a\u8ba1\u6570\u3002StreamReassembler\u5c06\u62e5\u6709\u4e00\u4e2aByteStream\u7528\u4e8e\u8f93\u51fa\uff1a\u4e00\u65e6\u91cd\u7ec4\u5668\u77e5\u9053\u4e86\u6d41\u7684\u4e0b\u4e00\u4e2a\u5b57\u8282\uff0c\u5b83\u5c31\u4f1a\u5c06\u5176\u5199\u5165ByteStream\u3002\u6240\u6709\u8005\u53ef\u4ee5\u968f\u65f6\u8bbf\u95ee\u548c\u8bfb\u53d6ByteStream\u3002</p> <p>\u4efb\u52a1:   </p> <p>implement a TCP receiver</p>","tags":["\u8ba1\u7b97\u673a\u7f51\u7edc"]},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/","title":"\u8ba1\u7b97\u673a\u7f51\u7edc","text":"<p>\u8ba1\u7b97\u673a\u7f51\u7edc\u901a\u5e38\u5206\u4e3a\u4e03\u5c42\uff0c\u91c7\u7528\u7684\u662fOSI\uff08\u5f00\u653e\u7cfb\u7edf\u4e92\u8fde\uff09\u53c2\u8003\u6a21\u578b\u3002\u6bcf\u4e00\u5c42\u90fd\u6709\u5176\u7279\u5b9a\u7684\u529f\u80fd\u548c\u8d23\u4efb\uff0c\u8fd9\u4e9b\u5c42\u4ece\u7269\u7406\u5c42\u5f00\u59cb\uff0c\u4e00\u76f4\u5230\u5e94\u7528\u5c42\u7ed3\u675f\u3002\u4ee5\u4e0b\u662f\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u7684\u4e03\u5c42\uff1a</p> <ol> <li> <p>\u7269\u7406\u5c42\uff08Physical Layer\uff09\uff1a\u8fd9\u4e00\u5c42\u8d1f\u8d23\u4f20\u8f93\u6570\u636e\u7684\u7269\u7406\u4ecb\u8d28\uff0c\u4f8b\u5982\u7535\u7f06\u3001\u5149\u7ea4\u548c\u65e0\u7ebf\u4fe1\u53f7\u7b49\u3002\u5b83\u5904\u7406\u4f4d\u4f20\u8f93\uff0c\u5373\u5c06\u6570\u636e\u8f6c\u6362\u4e3a\u6bd4\u7279\u6d41\uff0c\u5e76\u8fdb\u884c\u57fa\u672c\u7684\u7269\u7406\u4fe1\u53f7\u4f20\u8f93\u3002</p> </li> <li> <p>\u6570\u636e\u94fe\u8def\u5c42\uff08Data Link Layer\uff09\uff1a\u6570\u636e\u94fe\u8def\u5c42\u8d1f\u8d23\u5728\u76f4\u8fde\u7f51\u7edc\u8282\u70b9\u4e4b\u95f4\u4f20\u8f93\u6570\u636e\u5e27\u3002\u5b83\u901a\u8fc7\u7269\u7406\u5730\u5740\uff08MAC\u5730\u5740\uff09\u8bc6\u522b\u7f51\u7edc\u4e0a\u7684\u8bbe\u5907\uff0c\u5e76\u63d0\u4f9b\u4e86\u4e00\u4e9b\u9519\u8bef\u68c0\u6d4b\u548c\u7ea0\u6b63\u7684\u529f\u80fd\u3002</p> </li> <li> <p>\u7f51\u7edc\u5c42\uff08Network Layer\uff09\uff1a\u7f51\u7edc\u5c42\u5904\u7406\u6570\u636e\u5305\u7684\u4f20\u8f93\u548c\u8def\u7531\u9009\u62e9\u3002\u5b83\u4f7f\u7528\u903b\u8f91\u5730\u5740\uff08\u5982IP\u5730\u5740\uff09\u6765\u786e\u5b9a\u6570\u636e\u7684\u6700\u4f73\u8def\u5f84\uff0c\u4ee5\u5c06\u6570\u636e\u4ece\u6e90\u4e3b\u673a\u4f20\u8f93\u5230\u76ee\u6807\u4e3b\u673a\u3002</p> </li> <li> <p>\u4f20\u8f93\u5c42\uff08Transport Layer\uff09\uff1a\u4f20\u8f93\u5c42\u63d0\u4f9b\u4e86\u7aef\u5230\u7aef\u7684\u6570\u636e\u4f20\u8f93\u670d\u52a1\u3002\u5b83\u8d1f\u8d23\u5c06\u6570\u636e\u5206\u5272\u4e3a\u5408\u9002\u7684\u5927\u5c0f\u5e76\u8fdb\u884c\u4f20\u8f93\uff0c\u8fd8\u5904\u7406\u6570\u636e\u7684\u9519\u8bef\u6062\u590d\u548c\u6d41\u91cf\u63a7\u5236\u7b49\u529f\u80fd\u3002\u5e38\u89c1\u7684\u4f20\u8f93\u5c42\u534f\u8bae\u6709TCP\uff08\u4f20\u8f93\u63a7\u5236\u534f\u8bae\uff09\u548cUDP\uff08\u7528\u6237\u6570\u636e\u62a5\u534f\u8bae\uff09\u3002</p> </li> <li> <p>\u4f1a\u8bdd\u5c42\uff08Session Layer\uff09\uff1a\u4f1a\u8bdd\u5c42\u5efa\u7acb\u3001\u7ba1\u7406\u548c\u7ec8\u6b62\u7f51\u7edc\u4e2d\u7684\u4f1a\u8bdd\u8fde\u63a5\u3002\u5b83\u63d0\u4f9b\u4e86\u4f1a\u8bdd\u7684\u63a7\u5236\u548c\u540c\u6b65\u529f\u80fd\uff0c\u5141\u8bb8\u4e0d\u540c\u5e94\u7528\u7a0b\u5e8f\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\u548c\u6570\u636e\u4ea4\u6362\u3002</p> </li> <li> <p>\u8868\u793a\u5c42\uff08Presentation Layer\uff09\uff1a\u8868\u793a\u5c42\u8d1f\u8d23\u6570\u636e\u7684\u683c\u5f0f\u5316\u548c\u8868\u793a\u3002\u5b83\u5904\u7406\u6570\u636e\u7684\u52a0\u5bc6\u3001\u538b\u7f29\u3001\u89e3\u538b\u7f29\u548c\u6570\u636e\u683c\u5f0f\u8f6c\u6362\u7b49\u529f\u80fd\uff0c\u786e\u4fdd\u5728\u4e0d\u540c\u7cfb\u7edf\u95f4\u7684\u6570\u636e\u4ea4\u6362\u80fd\u591f\u6b63\u786e\u89e3\u91ca\u3002</p> </li> <li> <p>\u5e94\u7528\u5c42\uff08Application Layer\uff09\uff1a\u5e94\u7528\u5c42\u662f\u6700\u4e0a\u5c42\u7684\u5c42\u7ea7\uff0c\u63d0\u4f9b\u4e86\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u4e0e\u7528\u6237\u4e4b\u95f4\u7684\u63a5\u53e3\u3002\u5b83\u5305\u62ec\u4e86\u5404\u79cd\u5e94\u7528\u7a0b\u5e8f\uff0c\u5982\u7535\u5b50\u90ae\u4ef6\u3001\u6587\u4ef6\u4f20\u8f93\u3001\u8fdc\u7a0b\u767b\u5f55\u548c\u7f51\u9875\u6d4f\u89c8\u7b49\u3002</p> </li> </ol> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd8\u6709\u53e6\u4e00\u79cd\u5e38\u7528\u7684\u7f51\u7edc\u5206\u5c42\u6a21\u578b\u662fTCP/IP\u6a21\u578b\uff0c\u5b83\u5c06\u7f51\u7edc\u5c42\u548c\u6570\u636e\u94fe\u8def\u5c42\u5408\u5e76\u4e3a\u4e92\u8054\u7f51\u5c42\u3002\u8fd9\u4e24\u79cd\u6a21\u578b\u5728\u6982\u5ff5\u4e0a\u6709\u4e00\u5b9a\u7684\u5dee\u5f02\uff0c\u4f46\u90fd\u63cf\u8ff0\u4e86\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u4e0d\u540c\u5c42\u7ea7\u7684\u529f\u80fd\u548c\u804c\u8d23\u3002</p> <p></p> <pre><code>graph LR\nstyle A fill:#FFC300,stroke:#FFFFFF,stroke-width:2px\nstyle B fill:#FF5733,stroke:#FFFFFF,stroke-width:2px\nstyle C fill:#C70039,stroke:#FFFFFF,stroke-width:2px\nstyle D fill:#900C3F,stroke:#FFFFFF,stroke-width:2px\nstyle E fill:#581845,stroke:#FFFFFF,stroke-width:2px\nstyle F fill:#2E86C1,stroke:#FFFFFF,stroke-width:2px\nstyle G fill:#138D75,stroke:#FFFFFF,stroke-width:2px\n\nA[\u5e94\u7528\u5c42] --&gt; B[\u8868\u793a\u5c42]\nB --&gt; C[\u4f1a\u8bdd\u5c42]\nC --&gt; D[\u4f20\u8f93\u5c42]\nD --&gt; E[\u7f51\u7edc\u5c42]\nE --&gt; F[\u6570\u636e\u94fe\u8def\u5c42]\nF --&gt; G[\u7269\u7406\u5c42]\n\nA --&gt; \u5e94\u7528\u534f\u8bae1\nA --&gt; \u5e94\u7528\u534f\u8bae2\nA --&gt; \u5e94\u7528\u534f\u8bae3\n\nB --&gt; \u52a0\u5bc6\u89e3\u5bc6\nB --&gt; \u6570\u636e\u683c\u5f0f\u8f6c\u6362\nB --&gt; \u538b\u7f29\u89e3\u538b\u7f29\n\nC --&gt; \u4f1a\u8bdd\u63a7\u5236\nC --&gt; \u540c\u6b65\u4e0e\u6d41\u63a7\u5236\n\nD --&gt; TCP\nD --&gt; UDP\n\nE --&gt; IP\nE --&gt; ICMP\nE --&gt; \u8def\u7531\u534f\u8bae\n\nF --&gt; \u4ee5\u592a\u7f51\nF --&gt; Wi-Fi\nF --&gt; PPP\n\nG --&gt; \u7535\u7f06\nG --&gt; \u5149\u7ea4\nG --&gt; \u65e0\u7ebf\u4fe1\u53f7\n</code></pre>"},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_2","title":"\u5e94\u7528\u5c42","text":"<p>\u5e94\u7528\u5c42\u662f\u8ba1\u7b97\u673a\u7f51\u7edc\u4e2d\u7684\u6700\u9ad8\u5c42\uff0c\u5b83\u63d0\u4f9b\u4e86\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u4e0e\u7528\u6237\u4e4b\u95f4\u7684\u63a5\u53e3\u3002\u5e94\u7528\u5c42\u534f\u8bae\u5141\u8bb8\u4e0d\u540c\u8bbe\u5907\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u901a\u4fe1\u548c\u6570\u636e\u4ea4\u6362\u3002\u8fd9\u4e00\u5c42\u7684\u4e3b\u8981\u76ee\u6807\u662f\u4e3a\u7528\u6237\u63d0\u4f9b\u5404\u79cd\u670d\u52a1\u548c\u529f\u80fd\uff0c\u5982\u7535\u5b50\u90ae\u4ef6\u3001\u6587\u4ef6\u4f20\u8f93\u3001\u8fdc\u7a0b\u767b\u5f55\u3001\u7f51\u9875\u6d4f\u89c8\u548c\u5373\u65f6\u901a\u4fe1\u7b49\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#http","title":"HTTP\u62a5\u6587\u683c\u5f0f","text":"<p>HTTP\u62a5\u6587\u6709\u4e24\u79cd\uff1a\u8bf7\u6c42\u62a5\u6587\u548c\u54cd\u5e94\u62a5\u6587\u3002</p>"},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_3","title":"\u8bf7\u6c42\u62a5\u6587","text":"<p>HTTP\u8bf7\u6c42\u62a5\u6587\u793a\u4f8b <pre><code>GET /page.html HTTP/1.1\nHost: www.freebsd.org\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.7) Gecko/20050414 Firefox/1.0.3\nAccept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nKeep-Alive: 300\nConnection: keep-alive\nIf-Modified-Since: Mon, 09 May 2005 21:01:30 GMT\nIf-None-Match: \"26f731-8287-427fcfaa\"\n</code></pre></p> <p>HTTP\u8bf7\u6c42\u62a5\u6587\u7684\u7b2c\u4e00\u884c\u53eb\u4f5c\u8bf7\u6c42\u884c\uff08request line\uff09\uff0c\u5176\u540e\u7ee7\u7684\u884c\u53eb\u4f5c\u9996\u90e8\u884c?\uff08\u8bf7\u6c42\u5934\uff09\uff08header line\uff09\uff0c\u5728\u9996\u90e8\u884c\u4e4b\u540e\u5219\u662f\u5b9e\u4f53\u4f53\uff08entity body\uff09</p> <p>\u8bf7\u6c42\u884c\u6709\u4e09\u4e2a\u5b57\u6bb5: 1. \u65b9\u6cd5\u5b57\u6bb5 2. URL\u5b57\u6bb5 3. HTTP\u7248\u672c\u5b57\u6bb5</p> <p>\u9996\u90e8\u884c <code>Host: www.freebsd.org</code> \u6307\u660e\u4e86\u5bf9\u8c61\u6240\u5728\u7684\u4e3b\u673a <code>User-Agent:</code> \u7528\u6765\u6307\u660e\u7528\u6237\u4ee3\u7406\uff0c\u5373\u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42\u7684\u6d4f\u89c8\u5668\u7684\u7c7b\u578b</p>"},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_4","title":"\u54cd\u5e94\u62a5\u6587","text":"<p>HTTP\u54cd\u5e94\u62a5\u6587\u793a\u4f8b <pre><code>HTTP/1.1 200 OK\nDate: Fri, 13 May 2005 05:51:12 GMT\nServer: Apache/1.3.x LaHonda (Unix)\nLast-Modified: Fri, 13 May 2005 05:25:02 GMT\nETag: \"26f725-8286-42843a2e\"\nAccept-Ranges: bytes\nContent-Length: 33414\nKeep-Alive: timeout=15, max=100\nConnection: Keep-Alive\nContent-Type: text/html\n</code></pre></p> <p>\u54cd\u5e94\u62a5\u6587\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206\uff1a\u521d\u59cb\u72b6\u6001\u884c\uff08status line\uff09\uff0c\u82e5\u5e72\u4e2a\u9996\u90e8\u884c\uff1f\uff08\u54cd\u5e94\u5934\uff09\uff08header line\uff09\uff0c\u7136\u540e\u662f\u5b9e\u4f53\u4f53\uff08entity body\uff09</p>"},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_5","title":"\u5e38\u89c1\u7684\u72b6\u6001\u7801","text":"<ol> <li>1xx \u4fe1\u606f\u6027\u72b6\u6001\u7801\uff08Informational Status Codes\uff09\uff1a<ul> <li>100 Continue\uff1a\u670d\u52a1\u5668\u5df2\u7ecf\u63a5\u6536\u5230\u8bf7\u6c42\u7684\u4e00\u90e8\u5206\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u7ee7\u7eed\u53d1\u9001\u5269\u4f59\u7684\u8bf7\u6c42\u3002</li> </ul> </li> <li>2xx \u6210\u529f\u72b6\u6001\u7801\uff08Successful Status Codes\uff09\uff1a<ul> <li>200 OK\uff1a\u8bf7\u6c42\u5df2\u6210\u529f\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u8bf7\u6c42\u7684\u6570\u636e\u3002</li> <li>201 Created\uff1a\u8bf7\u6c42\u5df2\u6210\u529f\uff0c\u5e76\u5728\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u4e86\u65b0\u7684\u8d44\u6e90\u3002</li> <li>204 No Content\uff1a\u8bf7\u6c42\u5df2\u6210\u529f\uff0c\u4f46\u54cd\u5e94\u4e0d\u5305\u542b\u4efb\u4f55\u5b9e\u4f53\u5185\u5bb9\u3002</li> </ul> </li> <li>3xx \u91cd\u5b9a\u5411\u72b6\u6001\u7801\uff08Redirection Status Codes\uff09\uff1a<ul> <li>301 Moved Permanently\uff1a\u6240\u8bf7\u6c42\u7684\u8d44\u6e90\u5df2\u6c38\u4e45\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002</li> <li>302 Found\uff1a\u6240\u8bf7\u6c42\u7684\u8d44\u6e90\u4e34\u65f6\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002</li> <li>304 Not Modified\uff1a\u8d44\u6e90\u672a\u4fee\u6539\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u4f7f\u7528\u7f13\u5b58\u7684\u7248\u672c\u3002</li> </ul> </li> <li>4xx \u5ba2\u6237\u7aef\u9519\u8bef\u72b6\u6001\u7801\uff08Client Error Status Codes\uff09\uff1a<ul> <li>400 Bad Request\uff1a\u8bf7\u6c42\u6709\u8bed\u6cd5\u9519\u8bef\u6216\u65e0\u6cd5\u88ab\u670d\u52a1\u5668\u7406\u89e3\u3002</li> <li>401 Unauthorized\uff1a\u8bf7\u6c42\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1\u3002</li> <li>404 Not Found\uff1a\u6240\u8bf7\u6c42\u7684\u8d44\u6e90\u4e0d\u5b58\u5728\u3002</li> </ul> </li> <li>5xx \u670d\u52a1\u5668\u9519\u8bef\u72b6\u6001\u7801\uff08Server Error Status Codes\uff09\uff1a<ul> <li>500 Internal Server Error\uff1a\u670d\u52a1\u5668\u9047\u5230\u4e86\u672a\u77e5\u7684\u9519\u8bef\u3002</li> <li>503 Service Unavailable\uff1a\u670d\u52a1\u5668\u5f53\u524d\u65e0\u6cd5\u5904\u7406\u8bf7\u6c42\uff0c\u901a\u5e38\u662f\u7531\u4e8e\u8fc7\u8f7d\u6216\u7ef4\u62a4\u3002</li> </ul> </li> </ol>"},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_6","title":"\u4f20\u8f93\u5c42","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_7","title":"\u7f51\u7edc\u5c42","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_8","title":"\u6570\u636e\u5e73\u9762","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_9","title":"\u63a7\u5236\u5e73\u9762","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_10","title":"\u94fe\u8def\u5c42","text":""},{"location":"%E5%85%B6%E4%BB%96/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#_11","title":"\u8ba1\u7b97\u673a\u7f51\u7edc","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Bash%20%E8%84%9A%E6%9C%AC/","title":"Bash \u811a\u672c","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Bash%20%E8%84%9A%E6%9C%AC/#linux","title":"linux","text":"<pre><code>#!/bin/bash\n\n# \u8fd9\u662f\u4e00\u4e2a\u6ce8\u91ca\uff0c\u7528\u4e8e\u8bf4\u660e\u811a\u672c\u7684\u76ee\u7684\u6216\u7279\u5b9a\u90e8\u5206\u7684\u529f\u80fd\n\n# \u5b9a\u4e49\u53d8\u91cf\nname=\"World\"\n\n# \u8f93\u51fa\u6587\u672c\necho \"Hello, $name!\"\n\n# \u6267\u884c\u547d\u4ee4\necho \"\u5f53\u524d\u76ee\u5f55\uff1a\"\npwd\n\n# \u4f7f\u7528\u6761\u4ef6\u8bed\u53e5\nif [ -d \"/path/to/directory\" ]; then\n    echo \"\u76ee\u5f55\u5b58\u5728\"\nelse\n    echo \"\u76ee\u5f55\u4e0d\u5b58\u5728\"\nfi\n\n# \u4f7f\u7528\u5faa\u73af\nfor i in {1..5}; do\n    echo \"\u5faa\u73af\u6b21\u6570\uff1a$i\"\ndone\n\n# \u5b9a\u4e49\u548c\u4f7f\u7528\u51fd\u6570\nhello() {\n    echo \"Hello, $1!\"\n}\n\nhello \"John\"\n</code></pre> <p>\u5c06\u4ee5\u4e0a\u4ee3\u7801\u4fdd\u5b58\u4e3a\u4e00\u4e2a\u4ee5<code>.sh</code>\u4e3a\u540e\u7f00\u7684\u6587\u4ef6\uff08\u4f8b\u5982<code>script.sh</code>\uff09</p> <pre><code>chmod +x srcipt.sh\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/","title":"CMake","text":"<p>\u6a21\u677f TemplateCXX \u00b7 GitHub</p> <p>GitHub - ttroy50/cmake-examples: Useful CMake Examples</p> <p>CMake\u9879\u76ee\u7684\u914d\u7f6e\u6587\u4ef6\uff1a<code>CMakeLists.txt</code></p> <p>\u83b7\u53d6\u8f6f\u4ef6\u5305\uff08FetchContent\uff09(CMake 3.11+) \u00b7 Modern CMake</p> <p><code>cmake .</code></p> <p>\u6267\u884c\u540e\u7684\u7ed3\u6784</p> <pre><code>.\n\u251c\u2500\u2500 CMakeCache.txt\n\u251c\u2500\u2500 CMakeFiles\n\u251c\u2500\u2500 cmake_install.cmake\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 main.cpp\n\u2514\u2500\u2500 Makefile\n</code></pre> <p>\u518d\u6267\u884c<code>make</code>\uff0c\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6</p> <p>\u7531\u4e8e\u6587\u4ef6\u592a\u591a\uff0c\u6240\u4ee5\u901a\u5e38\u5355\u72ec\u521b\u5efa\u4e00\u4e2a<code>build</code>\u6587\u4ef6\u5939\uff0c\u5728\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e0b\u6267\u884c<code>cmake ..</code></p> <p>\u6267\u884c\u540e\u7684\u7ed3\u6784</p> <pre><code>.\n\u251c\u2500\u2500 build\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 CMakeCache.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 CMakeFiles\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cmake_install.cmake\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 Makefile\n\u251c\u2500\u2500 CMakeLists.txt\n\u2514\u2500\u2500 main.cpp\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#cmakelists","title":"CMakeLists \u6587\u4ef6","text":"<p>\u57fa\u672c <pre><code># CMake \u6700\u4f4e\u7248\u672c\u53f7\u8981\u6c42\ncmake_minimum_required(VERSION 3.25)\n\n# \u9879\u76ee\u4fe1\u606f\nproject(hello)\n\n# \u8bbe\u7f6eC++\u6807\u51c6\nset(CMAKE_CXX_STANDARD 20)\n\n# \u6307\u5b9a\u751f\u6210\u76ee\u6807\nadd_executable(hello main.cpp)\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#_1","title":"\u540c\u4e00\u76ee\u5f55\uff0c\u591a\u4e2a\u6e90\u6587\u4ef6","text":"<pre><code>.\n\u251c\u2500\u2500 main.cpp\n\u251c\u2500\u2500 String.cpp\n\u2514\u2500\u2500 String.hpp\n</code></pre> <pre><code>cmake_minimum_required(VERSION 3.10)\n\nset(CMAKE_CXX_STANDARD 17) # \u8bbe\u7f6eC++\u7248\u672c\n\nproject(hello)\n\nadd_executable(hello main.cpp String.cpp)\n</code></pre> <p>\u81ea\u52a8\u67e5\u627e\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6e90\u6587\u4ef6</p> <pre><code>cmake_minimum_required(VERSION 3.10)\n\nproject(hello)\n\naux_source_directory(. DIR_SRCS) # \u81ea\u52a8\u5bfb\u627e\u4fdd\u5b58'./'\u4e2d\u7684\u6e90\u6587\u4ef6\u540d\u5230DIR_SRCS\u53d8\u91cf\u4e2d\n\nadd_executable(hello ${DIR_SRCS}) # \u751f\u6210\u6307\u5b9a\u76ee\u6807\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#_2","title":"\u591a\u4e2a\u76ee\u5f55\u3002\u591a\u4e2a\u6e90\u6587\u4ef6","text":"<pre><code>.\n\u251c\u2500\u2500 main.cpp\n\u2514\u2500\u2500 String\n    \u251c\u2500\u2500 String.cpp\n    \u2514\u2500\u2500 String.hpp\n</code></pre> <p>\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u9700\u8981\u5206\u522b\u5728\u6839\u76ee\u5f55\u548c<code>String</code>\u76ee\u5f55\u4e2d\u5404\u81ea\u518d\u7f16\u5199\u4e00\u4e2aCMakeLists.txt\u6587\u4ef6</p> <p>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5c06 <code>String</code> \u76ee\u5f55\u91cc\u7684\u6587\u4ef6\u7f16\u8bd1\u6210\u9759\u6001\u5e93\u518d\u7531 main \u51fd\u6570\u8c03\u7528</p> <p>\u6839\u76ee\u5f55\u4e2d\u7684CMakeLists.txt</p> <pre><code>aux_source_directory(. DIR_LIB_SRCS)\n\n# \u751f\u6210\u94fe\u63a5\u5e93\nadd_library(StringFunctions ${DIR_LIB_SRCS})\n</code></pre> <p>CMakeLists.txt <pre><code>cmake_minimum_required(VERSION 3.10)\n\nproject(hello)\n\nset(CMAKE_C_STANDARD 17) # \u8bbe\u7f6eC\u8bed\u8a00\u7248\u672c\nset(CMAKE_CXX_STANDARD 17) # \u8bbe\u7f6eC++\u7248\u672c\n\n\naux_source_directory(. DIR_SRCS)\n\n# \u6dfb\u52a0String\u5b50\u76ee\u5f55\nadd_subdirectory(String)\n\nadd_executable(hello main.cpp)\n\n# \u6dfb\u52a0\u94fe\u63a5\u5e93\ntarget_link_libraries(hello StringFunctions)\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#cpp","title":"\u4e3a\u6bcf\u4e2acpp\u6587\u4ef6\u8fdb\u884c\u5355\u72ec\u7f16\u8bd1","text":"<pre><code># \u8bbe\u7f6eCMake\u7684\u6700\u5c0f\u7248\u672c\u8981\u6c42\ncmake_minimum_required(VERSION 3.10)\n\n# \u8bbe\u7f6e\u9879\u76ee\u540d\u79f0\nproject(SingleFileExecutables)\n\n# \u83b7\u53d6\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u7684.cpp\u6587\u4ef6\nfile(GLOB APP_SOURCES RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} *.cpp)\n\n# \u904d\u5386\u6240\u6709\u7684.cpp\u6587\u4ef6\nforeach(testsourcefile ${APP_SOURCES})\n    # \u83b7\u53d6\u5355\u4e2a\u6587\u4ef6\u7684\u6587\u4ef6\u540d\uff0c\u4e0d\u5305\u542b\u6269\u5c55\u540d\n    get_filename_component(testname ${testsourcefile} NAME_WE)\n\n    # \u6dfb\u52a0\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6784\u5efa\u76ee\u6807\n    add_executable(${testname} ${testsourcefile})\n\n    # \u5982\u679c\u4f60\u7684\u9879\u76ee\u6709\u7279\u5b9a\u7684\u7f16\u8bd1\u9009\u9879\u6216\u9700\u8981\u94fe\u63a5\u989d\u5916\u7684\u5e93\n    # \u53ef\u4ee5\u5728\u6b64\u5904\u8bbe\u7f6e\u8fd9\u4e9b\u5c5e\u6027\u3002\n    # target_compile_options(${testname} PRIVATE -Wall -O2)\n    # target_link_libraries(${testname} your_libraries_here)\n\nendforeach(testsourcefile ${APP_SOURCES})\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#_3","title":"\u5176\u4ed6","text":"<pre><code>.\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 main.cpp\n\u251c\u2500\u2500 mandel.cpp\n\u251c\u2500\u2500 mandel.h\n\u251c\u2500\u2500 rainbow.cpp\n\u251c\u2500\u2500 rainbow.h\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 stbiw\n    \u251c\u2500\u2500 CMakeLists.txt &lt;------- this file\n    \u251c\u2500\u2500 stb_image_write.cpp\n    \u2514\u2500\u2500 stb_image_write.h\n</code></pre> <pre><code>add_library(stbiw STATIC stb_image_write.cpp)\ntarget_include_directories(stbiw PUBLIC .)\n</code></pre> <p>stb_image_write.cpp</p> <pre><code>#define STB_IMAGE_WRITE_IMPLEMENTATION\n#include \"stb_image_write.h\"\n</code></pre> <p><code>add_library(stbiw STATIC stb_image_write.cpp)</code>: add_library \u662f\u4e00\u4e2aCMake\u547d\u4ee4\uff0c\u7528\u4e8e\u5c06\u4e00\u4e2a\u5e93\u6dfb\u52a0\u5230\u9879\u76ee\u4e2d\u3002 stbiw \u662f\u5e93\u7684\u540d\u79f0\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u9700\u8981\u66f4\u6539\u5b83\u3002 STATIC \u6307\u5b9a\u5e93\u7684\u7c7b\u578b\uff0c\u8fd9\u91cc\u662f\u4e00\u4e2a\u9759\u6001\u5e93\u3002\u9759\u6001\u5e93\u5728\u94fe\u63a5\u65f6\u4f1a\u88ab\u6574\u4f53\u5730\u94fe\u63a5\u5230\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u3002 stb_image_write.cpp \u662f\u5e93\u7684\u6e90\u4ee3\u7801\u6587\u4ef6\uff0c\u5b83\u5c06\u88ab\u7f16\u8bd1\u5e76\u94fe\u63a5\u5230\u6700\u7ec8\u7684\u5e93\u4e2d\u3002</p> <p><code>target_include_directories(stbiw PUBLIC .)</code>: target_include_directories \u662f\u7528\u4e8e\u5411\u76ee\u6807\uff08\u5728\u8fd9\u91cc\u662f\u5e93 stbiw\uff09\u6dfb\u52a0\u5305\u542b\u76ee\u5f55\u7684\u547d\u4ee4\u3002 stbiw \u662f\u76ee\u6807\u7684\u540d\u79f0\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u4fee\u6539\u3002 PUBLIC \u8868\u793a\u8fd9\u4e9b\u5305\u542b\u76ee\u5f55\u5c06\u88ab\u6dfb\u52a0\u5230\u5e93\u7684\u63a5\u53e3\uff08\u5373\u516c\u5171\u5934\u6587\u4ef6\uff09\u4e2d\uff0c\u4ee5\u4fbf\u5176\u4ed6\u4f7f\u7528\u8be5\u5e93\u7684\u76ee\u6807\u4e5f\u53ef\u4ee5\u8bbf\u95ee\u8fd9\u4e9b\u5934\u6587\u4ef6\u3002 . \u662f\u5f53\u524d\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u8fd9\u91cc\u6307\u5b9a\u5c06\u5f53\u524d\u76ee\u5f55\u5305\u542b\u5230 stbiw \u5e93\u7684\u63a5\u53e3\u4e2d\uff0c\u4f7f\u5f97\u5728\u4f7f\u7528\u8be5\u5e93\u7684\u5176\u4ed6\u76ee\u6807\u4e2d\u53ef\u4ee5\u76f4\u63a5\u5305\u542b #include \u58f0\u660e\u6307\u5411\u5f53\u524d\u76ee\u5f55\u7684\u5934\u6587\u4ef6\u3002 \u8fd9\u4e24\u884c\u4ee3\u7801\u4e00\u8d77\u5b8c\u6210\u4e86\u5c06 stb_image_write.cpp \u7f16\u8bd1\u6210\u4e00\u4e2a\u9759\u6001\u5e93 stbiw\uff0c\u5e76\u5c06\u8be5\u5e93\u7684\u5305\u542b\u76ee\u5f55\u8bbe\u7f6e\u4e3a\u5f53\u524d\u76ee\u5f55\u3002\u8fd9\u6837\uff0c\u5176\u4ed6\u9879\u76ee\u6216\u76ee\u6807\u53ef\u4ee5\u4f7f\u7528 stbiw \u5e93\uff0c\u5e76\u901a\u8fc7 #include \u6307\u4ee4\u5305\u542b\u5e93\u4e2d\u7684\u5934\u6587\u4ef6\u3002</p> <p><code>include_directories</code></p> <pre><code># \u6dfb\u52a0 include \u76ee\u5f55\u4f5c\u4e3a\u5305\u542b\u76ee\u5f55\ninclude_directories(include)\n\nadd_executable(hello src/test.c)\n</code></pre> <pre><code># \u7ed3\u6784\n.\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 include\n\u2502   \u2514\u2500\u2500 test.h\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 test.c\n</code></pre> <pre><code>#include \"test.h\" // \u5b9e\u73b0\u6548\u679c\n#include &lt;stdio.h&gt;\n\nint main() {\n    int a = add(2, 3);\n}\n</code></pre> <p>\u7f16\u8bd1\u9009\u9879</p> <pre><code># \u5728\u8fd9\u91cc\u6dfb\u52a0\u4f60\u7684\u9879\u76ee\u914d\u7f6e\n\n# \u6dfb\u52a0 -ffast-math \u7f16\u8bd1\u9009\u9879\nadd_executable(your_target source1.cpp source2.cpp)\ntarget_compile_options(your_target PRIVATE -ffast-math) # \u4f7f\u7528`-ffast-math`\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u6570\u5b66\u8ba1\u7b97\u7684\u4e0d\u786e\u5b9a\u6027\n</code></pre> <pre><code>add_compile_options(-fcoroutines)\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#vscode-cmakedebug","title":"vscode + cmake\u547d\u4ee4\u884c\u53c2\u6570debug","text":"<ol> <li>\u5728.vscode\u6587\u4ef6\u5939\u91cc\u65b0\u5efa\u4e00\u4e2a<code>settings.json</code></li> <li>\u7c98\u8d34\u4ee5\u4e0b\u53c2\u6570</li> </ol> <pre><code>{\n    \"cmake.debugConfig\": {\n        \"args\": [\n            \"-code\",\n            \"8\"\n        ]\n    }\n}\n</code></pre> <p>\u5c31\u76f8\u5f53\u4e8e\u547d\u4ee4\u884c\u53c2\u6570 -code 8</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#cmake_1","title":"CMake\u9759\u6001\u7f16\u8bd1","text":"<pre><code>set(CMAKE_EXE_LINKER_FLAGS \"-static\")\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#lib","title":"\u6784\u5efaLib","text":"<pre><code># src/CMakeLists.txt\n\n# \u6307\u5b9a\u5e93\u7684\u6e90\u6587\u4ef6\nset(SOURCES\n    my_library.cpp\n)\n\n# \u751f\u6210\u5e93\nadd_library(my_library ${SOURCES})\n\n# \u8bbe\u7f6e\u5934\u6587\u4ef6\u8def\u5f84\uff0c\u4f9b\u5176\u4ed6\u9879\u76ee\u4f7f\u7528\ntarget_include_directories(my_library PUBLIC ${CMAKE_CURRENT_SOURCE_DIR})\n</code></pre> <p>\u4e00\u65e6\u4f60\u5df2\u7ecf\u4f7f\u7528CMake\u6784\u5efa\u4e86\u5e93\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\u4e4b\u4e00\u6765\u8c03\u7528\u5b83\uff1a</p> <ol> <li>\u94fe\u63a5\u5230\u53e6\u4e00\u4e2aCMake\u9879\u76ee\uff1a\u5982\u679c\u4f60\u6709\u53e6\u4e00\u4e2aCMake\u9879\u76ee\u60f3\u8981\u4f7f\u7528\u4f60\u6784\u5efa\u7684\u5e93\uff0c\u4f60\u53ef\u4ee5\u5728\u5b83\u7684CMakeLists.txt\u6587\u4ef6\u4e2d\u4f7f\u7528<code>target_link_libraries()</code>\u547d\u4ee4\u6765\u94fe\u63a5\u4f60\u7684\u5e93\u3002\u4f8b\u5982\uff1a</li> </ol> <pre><code># CMakeLists.txt  \nproject(my_project)  # \u6dfb\u52a0\u4f60\u7684\u5e93 \nadd_subdirectory(path/to/your/library)  # \u6dfb\u52a0\u4f60\u7684\u53ef\u6267\u884c\u6587\u4ef6 \nadd_executable(my_executable main.cpp)  # \u94fe\u63a5\u4f60\u7684\u5e93 \ntarget_link_libraries(my_executable my_library)\n</code></pre> <ol> <li>\u624b\u52a8\u94fe\u63a5\u5230\u5176\u4ed6\u9879\u76ee\uff1a\u5982\u679c\u4f60\u7684\u5e93\u88ab\u6784\u5efa\u6210\u4e86\u9759\u6001\u5e93\uff08.a\u6587\u4ef6\uff09\u6216\u52a8\u6001\u5e93\uff08.so\u6587\u4ef6\uff09\uff0c\u4f60\u53ef\u4ee5\u5728\u5176\u4ed6\u9879\u76ee\u4e2d\u624b\u52a8\u94fe\u63a5\u5b83\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u5728\u7f16\u8bd1\u65f6\u6307\u5b9a\u5e93\u7684\u8def\u5f84\u548c\u540d\u79f0\u6765\u5b8c\u6210\u3002\u4f8b\u5982\uff1a</li> </ol> <pre><code>g++ -o my_program main.cpp -L/path/to/library -lmy_library\n</code></pre> <p>\u5176\u4e2d\uff0c<code>-L</code>\u9009\u9879\u6307\u5b9a\u5e93\u7684\u8def\u5f84\uff0c<code>-l</code>\u9009\u9879\u6307\u5b9a\u8981\u94fe\u63a5\u7684\u5e93\u7684\u540d\u79f0\u3002</p> <ol> <li>\u4f7f\u7528\u5934\u6587\u4ef6\uff1a\u5982\u679c\u4f60\u7684\u5e93\u66b4\u9732\u4e86\u516c\u5171\u5934\u6587\u4ef6\uff0c\u5176\u4ed6\u9879\u76ee\u53ef\u4ee5\u901a\u8fc7\u5305\u542b\u8fd9\u4e9b\u5934\u6587\u4ef6\u6765\u4f7f\u7528\u5e93\u7684\u529f\u80fd\u3002\u5728CMake\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528<code>target_include_directories()</code>\u547d\u4ee4\u6765\u544a\u8bc9\u5176\u4ed6\u9879\u76ee\u5305\u542b\u4f60\u7684\u5e93\u7684\u5934\u6587\u4ef6\u8def\u5f84\u3002</li> </ol> <pre><code># CMakeLists.txt  \nproject(another_project)  # \u5305\u542b\u4f60\u7684\u5e93\u7684\u5934\u6587\u4ef6\u8def\u5f84 \ninclude_directories(path/to/your/library)  # \u6dfb\u52a0\u4f60\u7684\u53ef\u6267\u884c\u6587\u4ef6 \nadd_executable(another_executable another_main.cpp)  # \u6dfb\u52a0\u94fe\u63a5 \ntarget_link_libraries(another_executable my_library)\n</code></pre> <p>\u65e0\u8bba\u4f60\u9009\u62e9\u54ea\u79cd\u65b9\u6cd5\uff0c\u4f60\u90fd\u9700\u8981\u786e\u4fdd\u5728\u94fe\u63a5\u548c\u5305\u542b\u4f60\u7684\u5e93\u65f6\uff0c\u4f60\u7684\u5e93\u6587\u4ef6\u548c\u5934\u6587\u4ef6\u90fd\u53ef\u5728\u76f8\u5e94\u7684\u4f4d\u7f6e\u627e\u5230\u3002</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#_4","title":"\u83b7\u53d6\u8f6f\u4ef6\u5305","text":"<pre><code>include(FetchContent)\n\n\nFetchContent_Declare(\n  catch\n  GIT_REPOSITORY https://github.com/catchorg/Catch2.git\n  GIT_TAG v2.13.6)\n# CMake 3.14+\nFetchContent_MakeAvailable(catch)\n\n\nadd_executable(fetch_example main.cpp)\ntarget_link_libraries(fetch_example PRIVATE Catch2::Catch2)\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/CMake/#_5","title":"\u5e38\u7528\u4ee3\u7801","text":"<p><code>set</code> \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf</p> <pre><code># \u8bbe\u7f6eC++\u6807\u51c6\nset(CMAKE_CXX_STANDARD 20)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\nset(CMAKE_EXPORT_COMPILE_COMMANDS True)\n</code></pre> <p><code>include_directories</code></p> <pre><code># \u8bbe\u7f6e\u5934\u6587\u4ef6\u76ee\u5f55\ninclude_directories(\"${CMAKE_SOURCE_DIR}/src/include\")\ninclude_directories(\"${CMAKE_SOURCE_DIR}/third_party/gtest/googletest/include\")\n</code></pre> <p><code>add_subdirectory</code> \u6dfb\u52a0\u5b50\u76ee\u5f55</p> <pre><code>add_subdirectory(src)\nadd_subdirectory(test)\nadd_subdirectory(\"${CMAKE_SOURCE_DIR}/third_party/gtest\")\n</code></pre> <p><code>aux_source_directory</code> \u81ea\u52a8\u5bfb\u627e\u3001\u6dfb\u52a0\u6e90\u4ee3\u7801</p> <pre><code>aux_source_directory(. DIR_SRCS)\n</code></pre> <p><code>find_package()</code> \u5bfb\u627e\u672c\u5730\u5305</p> <p><code>find_library</code> \u5bfb\u627e\u672c\u5730\u5e93</p> <pre><code>find_library([VAR] NAMES [\u5e93\u540d] REQUIRED)\n\n# EXAMPLE\nfind_library(A NAMES uring REQUIRED)\nmessage(${A}) # /usr/lib/liburing.so\n\n\n\nadd_executable(${PROJECT_NAME} ${SOURCES} ${HEADERS})\ntarget_link_libraries(${PROJECT_NAME} uring)\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Doxygen/","title":"Doxygen","text":"<p>\u751f\u6210Doxyfile</p> <pre><code>doxygen -g\n</code></pre> <p>\u751f\u6210\u6587\u6863</p> <pre><code>doxygen ./Doxyfile\n</code></pre> <p>\u7136\u540e\u5728<code>document</code>\u91cc\u9762\u6253\u5f00<code>index.html</code>\u5373\u53ef</p> <p>reference: 1. Doxygen 10 \u5206\u949f\u5165\u95e8\u6559\u7a0b | Simple</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Helix/","title":"Helix","text":"<pre><code># \u6253\u5f00\nhx\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Hyprland%E9%85%8D%E7%BD%AE/","title":"hyprland\u914d\u7f6e","text":"<p>\u57fa\u7840\u5b89\u88c5</p> <pre><code>yay -S \n\nhyprland-git \nwaybar-hyprland-git \nnetwork-manager-applet \nblueman\nxdg-desktop-portal-hyprland # \u5c4f\u5e55\u5171\u4eab\u3001\u622a\u56fe\u9700\u8981\ngrim # \u622a\u56fe\nslurp\n</code></pre> <p>NVIDIA \u76f8\u5173\u8bbe\u7f6e</p> <pre><code># \u6dfb\u52a0\u73af\u5883\u53d8\u91cf \u4f7f\u9f20\u6807\u53ef\u89c1\nWLR_NO_HARDWARE_CURSORS=1\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Linux%E7%AC%94%E8%AE%B0/","title":"Linux\u7b14\u8bb0","text":"<p>\u6b63\u5e38\u89e3\u538bgbk\u7f16\u7801\u683c\u5f0f\u7684\u6587\u4ef6</p> <pre><code>unzip -O gbk path/to/archive1.zip path/to/archive2.zip\n</code></pre> <p>\u5b9a\u65f6\u6267\u884c\u811a\u672c</p> <p><code>cronie</code> \u4f7f\u7528 <code>cronie.service</code></p> <pre><code>systemctl enable cronie.service\n</code></pre> <p>\u5f00\u59cb\u7f16\u8f91cron\u8868</p> <pre><code>crontab -e\n</code></pre> <p>\u5177\u4f53\u5185\u5bb9</p> <pre><code>0 9 * * * /path/to/your/script.sh\n</code></pre> <p>\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>0</code>\u4ee3\u8868\u5206\u949f\uff0c<code>9</code>\u4ee3\u8868\u5c0f\u65f6\uff0c<code>* * *</code>\u4ee3\u8868\u65e5\u671f\u3001\u6708\u4efd\u548c\u661f\u671f\u51e0\uff0c\u8868\u793a\u6bcf\u5929\u90fd\u5339\u914d\u3002<code>/path/to/your/script.sh</code>\u662f\u8981\u6267\u884c\u7684\u811a\u672c\u7684\u8def\u5f84\u3002</p> <ul> <li>\u5206\u949f\uff080-59\uff09</li> <li>\u5c0f\u65f6\uff080-23\uff09</li> <li>\u65e5\u671f\uff081-31\uff09</li> <li>\u6708\u4efd\uff081-12\uff09</li> <li>\u661f\u671f\u51e0\uff080-7\uff0c\u5176\u4e2d0\u548c7\u90fd\u8868\u793a\u661f\u671f\u65e5\uff09</li> </ul> <p>\u8f93\u51fa\u6240\u6709\u5b9a\u65f6\u4efb\u52a1</p> <pre><code>crontab -l\n</code></pre> <p>shell\u4e2d1&amp;\u5c06STDERR\u548cSTDOUT\u7684\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u540c\u4e00\u4e2a\u7ba1\u9053</p> <p><code>chattr</code> \u4fee\u6539\u6587\u4ef6\u5c5e\u6027 <code>lsattr</code> \u67e5\u770b\u6587\u4ef6\u5c5e\u6027</p> <p>\u4efb\u52a1\u7ba1\u7406</p> <p><code>jobs</code> \u67e5\u770b\u7ec8\u7aef\u4e2d\u7684\u4efb\u52a1\u5217\u8868\uff08\u5728\u540e\u53f0\u8fd0\u884c\u7684\u4efb\u52a1\uff09</p> <p><code>bg</code>\u548c<code>fg</code>\uff1a\u5c06\u540e\u53f0\u4f5c\u4e1a\u5207\u6362\u5230\u524d\u53f0\u6216\u5c06\u524d\u53f0\u4f5c\u4e1a\u5207\u6362\u5230\u540e\u53f0\u3002</p> <ul> <li><code>bg %job_number</code>: \u5c06\u7f16\u53f7\u4e3a<code>job_number</code>\u7684\u4f5c\u4e1a\u5207\u6362\u5230\u540e\u53f0\u8fd0\u884c\u3002</li> <li><code>fg %job_number</code>: \u5c06\u7f16\u53f7\u4e3a<code>job_number</code>\u7684\u4f5c\u4e1a\u5207\u6362\u5230\u524d\u53f0\u8fd0\u884c\u3002</li> </ul> <p>\u6309\u4e0b <code>Ctrl + Z</code> \u952e\u7ec4\u5408\u53ef\u4ee5\u5c06\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u52a1\uff08\u524d\u53f0\u4efb\u52a1\uff09\u6682\u505c\uff0c\u5e76\u5c06\u5176\u5207\u6362\u5230\u540e\u53f0\u3002\u8fd9\u4e2a\u64cd\u4f5c\u901a\u5e38\u79f0\u4e3a\u6302\u8d77\uff08suspend\uff09\u3002</p> <p>Linux\u4e2d\u7684\u7ba1\u9053\u4e0e\u8fde\u63a5\u7b26\u53f7 - \u77e5\u4e4e</p> <p>\u83b7\u5f97\u4e24\u4e2a\u6587\u4ef6\u4e4b\u95f4\u7684\u76f8\u5bf9\u8def\u5f84</p> <pre><code>realpath FILE(traget)  --relative-to=FILE(current)\n</code></pre> <p>Linux\u83b7\u53d6\u4e24\u4e2a\u8def\u5f84\u4e4b\u95f4\u7684\u76f8\u5bf9\u8def\u5f84</p> <p>ln\uff1a   - \u521b\u5efa\u6307\u5411\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u7b26\u53f7\u94fe\u63a5\uff1a     ln -s /\u8def\u5f84/\u5230/\u6587\u4ef6\u6216\u76ee\u5f55 \u8def\u5f84/\u5230/\u7b26\u53f7\u94fe\u63a5</p> <ul> <li> <p>\u8986\u76d6\u73b0\u6709\u7684\u7b26\u53f7\u94fe\u63a5\u4ee5\u6307\u5411\u5176\u4ed6\u6587\u4ef6\uff1a     ln -sf /\u8def\u5f84/\u5230/\u65b0\u6587\u4ef6 \u8def\u5f84/\u5230/\u7b26\u53f7\u94fe\u63a5</p> </li> <li> <p>\u521b\u5efa\u6587\u4ef6\u7684\u786c\u94fe\u63a5\uff1a     ln /\u8def\u5f84/\u5230/\u6587\u4ef6 \u8def\u5f84/\u5230/\u786c\u94fe\u63a5</p> </li> </ul> <p>\u8f6f\u94fe\u63a5\u7c7b\u4f3c\u4e8eWindows\u7684\u5feb\u6377\u65b9\u5f0f</p> <p>\u800c\u5bf9\u4e8e\u786c\u94fe\u63a5\u7c7b\u4f3c\u4e8e\u4e00\u79cdclone\uff0c\u539f\u6587\u4ef6\u88ab\u4fee\u6539\u4e5f\u4f1a\u540c\u6b65\u5230\u786c\u94fe\u63a5\u4e0a\uff0c\u4f46\u5220\u9664\u4e0d\u4f1a\u3002 \u786c\u94fe\u63a5\u4e0d\u80fd\u94fe\u63a5\u76ee\u5f55\uff0c\u53ea\u80fd\u94fe\u63a5\u6587\u4ef6\u3002</p> <p>scp \u4f20\u8f93\u6587\u4ef6</p> <pre><code>scp \u672c\u5730\u6587\u4ef6\u8def\u5f84 remote_username@remote_ip:remote_\u6587\u4ef6\u540d # \u672c\u5730\u6587\u4ef6\u590d\u5236\u5230\u8fdc\u7a0b\n\nscp remote_username@remote_ip:remote_\u6587\u4ef6\u540d \u672c\u5730\u6587\u4ef6\u8def\u5f84 # \u8fdc\u7a0b\u6587\u4ef6\u590d\u5236\u5230\u672c\u5730\n</code></pre> <p>\u4f7f\u7528\u65b9\u5f0f\u7c7b\u4f3c\u4e8e<code>cp</code></p> <p><code>-r</code> \u9012\u5f52\u590d\u5236\u76ee\u5f55</p> <p>PATH\u73af\u5883\u53d8\u91cf</p> <pre><code>vim ~/.bashrc\n</code></pre> <pre><code>export PATH=$PATH:/usr/local/src/python3/bin\n# \u6216\nexport PATH=/usr/local/src/python3/bin:$PATH\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Linux%E7%AC%94%E8%AE%B0/#_1","title":"\u7f51\u7edc","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Linux%E7%AC%94%E8%AE%B0/#lsof","title":"lsof","text":"<p>\u67e5\u770b\u7aef\u53e3\u5360\u7528\u60c5\u51b5</p> <pre><code>lsof -i:[port]\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Linux%E7%AC%94%E8%AE%B0/#netstat","title":"netstat","text":"<p>netstat\u547d\u4ee4\u7528\u4e8e\u663e\u793a\u7f51\u7edc\u8fde\u63a5\u548c\u8def\u7531\u8868\u4fe1\u606f\u3002</p> <p>-n\uff1a\u76f4\u63a5\u4f7f\u7528IP\u5730\u5740\uff0c\u800c\u4e0d\u901a\u8fc7\u57df\u540d\u670d\u52a1\u5668\u3002 -l\uff1a\u663e\u793a\u76d1\u63a7\u4e2d\u7684\u670d\u52a1\u5668\u7684Socket\u3002 -t\uff1a\u663e\u793aTCP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\u3002 -u\uff1a\u663e\u793aUDP\u4f20\u8f93\u534f\u8bae\u7684\u8fde\u7ebf\u72b6\u51b5\u3002 -p\uff1a\u663e\u793a\u6b63\u5728\u4f7f\u7528Socket\u7684\u7a0b\u5e8f\u8bc6\u522b\u7801\u548c\u7a0b\u5e8f\u540d\u79f0\u3002</p> <p>\u663e\u793a\u6240\u6709\u6d3b\u52a8\u7684\u7f51\u7edc\u8fde\u63a5\uff1a    <pre><code>netstat -a\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Linux%E7%AC%94%E8%AE%B0/#_2","title":"\u597d\u7528\u7684\u5de5\u5177","text":"<p><code>cloc</code> \u7edf\u8ba1\u4ee3\u7801\u884c\u6570</p> <p><code>tokei</code> \u7edf\u8ba1\u4ee3\u7801\u884c\u6570\uff0c\u4f46\u662f\u901f\u5ea6\u66f4\u5feb</p> <p><code>ncdu</code> \u67e5\u770b\u6587\u4ef6(\u5939)\u5360\u7528\u7a7a\u95f4</p> <p><code>tealdeer</code> tealdeer(tldr\u7684rust\u5ba2\u6237\u7aef\uff0c\u901f\u5ea6\u66f4\u5feb)</p> <p><code>hyperfine</code> benchmark\u5de5\u5177 </p> <pre><code>hyperfine --prepare zsh --warmup 10 --min-runs=1000 './path/to/program &gt; /dev/null'\n</code></pre> <p><code>valgrind</code> C++\u5e94\u7528\u5185\u5b58\u6cc4\u9732\u68c0\u67e5</p> <pre><code>valgrind --tool=helgrind ./my_program # \u68c0\u67e5\u5e76\u53d1\u95ee\u9898\n</code></pre> <p><code>webbench</code> \u7f51\u7edc\u538b\u529b\u6d4b\u8bd5</p> <pre><code>webbench -c [\u5e76\u53d1\u91cf] -t [\u65f6\u95f4-\u79d2] [target]\n\n# sample\nwebbench -c 500 -t 60 localhost:8080\n</code></pre> <p><code>locust</code> \u6027\u80fd\u6d4b\u8bd5</p> <p>Locust - A modern load testing framework</p> <p>\u706b\u7130\u56fe flamegraph</p> <p>\u5b89\u88c5 <pre><code>sudo yay -S flamegraph-git\n</code></pre></p> <p>\u4f7f\u7528</p> <pre><code># \u751f\u6210\u6587\u4ef6 perf.data\nsudo perf record -F 99 -p {pid} -g -- sleep 60 # \u4f7f\u7528 Linux perf_events\uff08\u53c8\u540d\u201cperf\u201d\uff09\u6355\u83b7 60 \u79d2\u7684 99 \u8d6b\u5179\u5806\u6808\u6837\u672c\uff0c\u7a0b\u5e8fPID\u4e3a{pid}\n\n# \u751f\u6210 out.perf\nsudo perf script &gt; out.perf\n\n# \u751f\u6210 out.folder\nsudo stackcollapse-perf out.perf &gt; out.folded\n\n# \u751f\u6210svg\u56fe\u7247\nsudo flamegraph.pl out.folded &gt; {name}.svg\n</code></pre> <p>\u5feb\u901fbash\u811a\u672c</p> <p>\u4f7f\u7528: <pre><code>./script.sh {pid}\n</code></pre></p> <pre><code>#! /usr/bin/env bash\n\n# \u4f7f\u7528 Linux perf_events\uff08\u53c8\u540d\u201cperf\u201d\uff09\u6355\u83b7 30 \u79d2\u7684 99 \u8d6b\u5179\u5806\u6808\u6837\u672c\uff0c\u7a0b\u5e8fPID\u4e3a{pid}\n# sudo perf record -F 99 -p \"$1\" -g -- sleep 30 \n\n# \u5206\u6790\u7a0b\u5e8f $1\nsudo perf record \"$1\" -F 99 -g -- sleep 30\n\n# \u751f\u6210 out.perf\nsudo perf script &gt; out.perf\n\n# \u751f\u6210 out.folder\nsudo stackcollapse-perf out.perf &gt; out.folded\n\n# \u751f\u6210svg\u56fe\u7247\nsudo flamegraph out.folded &gt; \"$1\".svg\n\nsudo chmod +r \"$1\".svg\n</code></pre> <p>\u7ed3\u679c: </p> <p>reference: GitHub - brendangregg/FlameGraph: Stack trace visualizer \u5229\u7528\u706b\u7130\u56fe\u5206\u6790\u7a0b\u5e8f\u6027\u80fd\u74f6\u9888 | \u9f50\u6d69\u5929\u7684\u535a\u5ba2</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Linux%E7%AC%94%E8%AE%B0/#_3","title":"\u684c\u9762\u73af\u5883","text":"<p>kde\u67e5\u770b\u54ea\u4e9b\u5e94\u7528\u8fd0\u884c\u5728x11\u6216wayland\u4e0b</p> <pre><code>qdbus org.kde.KWin /KWin org.kde.KWin.showDebugConsole\n</code></pre> <p>chrome electron wayland\u914d\u7f6e</p> <p>chrome-flags.conf <pre><code>--enable-features=UseOzonePlatform\n--ozone-platform=wayland\n--enable-wayland-ime \n</code></pre></p> <p>20 \u4e4b\u540e electron-flags.conf <pre><code>--ozone-platform-hint=auto\n--enable-wayland-ime \n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Linux%E7%AC%94%E8%AE%B0/#_4","title":"\u5e94\u7528\u7a0b\u5e8f","text":"<p>mpv\u64ad\u653e\u5668</p> <p>\u542f\u7528\u786c\u4ef6\u89e3\u7801(\u81ea\u52a8\u9009\u62e9\u89e3\u7801\u65b9\u5f0f) <code>--hwdec=auto</code></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Make/","title":"Make\u4f7f\u7528","text":"<p>\u4e00\u4e2a\u7b80\u5355\u7684Makefile\u4f8b\u5b50\uff1a</p> <pre><code>CC=gcc\nCFLAGS=-Wall\n\nall: program\n\nprogram: main.o func1.o func2.o\n    $(CC) $(CFLAGS) -o program main.o func1.o func2.o\n\nmain.o: main.c\n    $(CC) $(CFLAGS) -c main.c\n\nfunc1.o: func1.c\n    $(CC) $(CFLAGS) -c func1.c\n\nfunc2.o: func2.c\n    $(CC) $(CFLAGS) -c func2.c\n\nclean:\n    rm -f *.o program\n</code></pre> <p>\u8fd9\u4e2aMakefile\u6307\u5b9a\u4e86\u4e00\u4e2a\u53eb\u505a<code>program</code>\u7684\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6784\u5efa\u89c4\u5219\u3002\u5b83\u7531\u4e09\u4e2a\u6e90\u6587\u4ef6<code>main.c</code>\u3001<code>func1.c</code>\u548c<code>func2.c</code>\u7ec4\u6210\u3002</p> <p><code>CC</code>\u548c<code>CFLAGS</code>\u662fMakefile\u7684\u53d8\u91cf\uff0c\u5206\u522b\u6307\u5b9a\u7f16\u8bd1\u5668\u548c\u7f16\u8bd1\u9009\u9879\u3002<code>all</code>\u662f\u4e00\u4e2a\u4f2a\u76ee\u6807\uff0c\u7528\u4e8e\u6307\u5b9a\u9ed8\u8ba4\u7684\u6784\u5efa\u76ee\u6807\u3002</p> <p><code>program</code>\u76ee\u6807\u4f9d\u8d56\u4e8e<code>main.o</code>\u3001<code>func1.o</code>\u548c<code>func2.o</code>\u4e09\u4e2a\u76ee\u6807\u3002<code>make</code>\u5c06\u68c0\u67e5\u6bcf\u4e2a\u76ee\u6807\u662f\u5426\u9700\u8981\u91cd\u65b0\u6784\u5efa\uff0c\u5982\u679c\u9700\u8981\uff0c\u5b83\u4f1a\u8fd0\u884c\u6307\u5b9a\u7684\u547d\u4ee4\u6765\u751f\u6210\u76ee\u6807\u6587\u4ef6\u3002\u6700\u7ec8\uff0c<code>program</code>\u76ee\u6807\u5c06\u901a\u8fc7\u94fe\u63a5\u8fd9\u4e09\u4e2a\u76ee\u6807\u6587\u4ef6\u6765\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> <p><code>clean</code>\u662f\u4e00\u4e2a\u4f2a\u76ee\u6807\uff0c\u7528\u4e8e\u5220\u9664\u6240\u6709\u751f\u6210\u7684\u76ee\u6807\u6587\u4ef6\u548c\u53ef\u6267\u884c\u6587\u4ef6\u3002</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MongoDB/","title":"MongoDB","text":"<p>\u4f7f\u7528docker\u4e0b\u8f7dmongoDB\u955c\u50cf <pre><code>docker pull mongo\n</code></pre></p> <p>\u521b\u5efamongo\u5bb9\u5668 <pre><code>docker run -p 27017:27017 --name mongodb -d mongo\n</code></pre></p> <p>\u4e0d\u8981\u8fd9\u6837\u521b\u5efa\u5bb9\u5668\uff0c\u53ef\u80fd\u4f7f\u5916\u90e8\u5e94\u7528\u65e0\u6cd5\u8fde\u63a5\u3002\u56e0\u4e3a\u8fd9\u4f1a\u4f7fmongod\u6ca1\u6709\u5728\u540e\u53f0\u8fd0\u884c\uff0c\u88abbash\u66ff\u4ee3 <code>shell docker run -it --name mongodb  -p 27017:27017 -d mongo /bin/bash</code></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MySQL%E6%8C%87%E4%BB%A4/","title":"MySQL\u6307\u4ee4","text":"<p>\u542f\u52a8MySQL\u670d\u52a1\uff1a<code>sudo /etc/init.d/mysql start</code> \u6216 <code>sudo service mysql start</code></p> <p>\u6570\u636e\u5e93\u5b9a\u4e49\u8bed\u8a00(DDL) 1. DDL\uff08Data Definition Language\uff0c\u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff09\u7528\u6765\u521b\u5efa\u6216\u8005\u5220\u9664\u5b58\u50a8\u6570\u636e\u7528\u7684\u6570\u636e\u5e93\u4ee5\u53ca\u6570\u636e\u5e93\u4e2d\u7684\u8868\u7b49\u5bf9\u8c61\u3002 DDL \u5305\u542b\u4ee5\u4e0b\u51e0\u79cd\u6307\u4ee4\u3002     1. CREATE\uff1a \u521b\u5efa\u6570\u636e\u5e93\u548c\u8868\u7b49\u5bf9\u8c61     2. DROP\uff1a \u5220\u9664\u6570\u636e\u5e93\u548c\u8868\u7b49\u5bf9\u8c61     3. ALTER\uff1a \u4fee\u6539\u6570\u636e\u5e93\u548c\u8868\u7b49\u5bf9\u8c61\u7684\u7ed3\u6784</p> <p>\u6570\u636e\u5e93\u64cd\u7eb5\u8bed\u8a00(DML) 2. DML\uff08Data Manipulation Language\uff0c\u6570\u636e\u64cd\u7eb5\u8bed\u8a00\uff09\u7528\u6765\u67e5\u8be2\u6216\u8005\u53d8\u66f4\u8868\u4e2d\u7684\u8bb0\u5f55\u3002 DML \u5305\u542b\u4ee5\u4e0b\u51e0\u79cd\u6307\u4ee4\u3002</p> <pre><code>1. CREATE\uff1a \u521b\u5efa\u6570\u636e\u5e93\u548c\u8868\u7b49\u5bf9\u8c61\n2. DROP\uff1a \u5220\u9664\u6570\u636e\u5e93\u548c\u8868\u7b49\u5bf9\u8c61\n3. ALTER\uff1a \u4fee\u6539\u6570\u636e\u5e93\u548c\u8868\u7b49\u5bf9\u8c61\u7684\u7ed3\u6784\n</code></pre> <p>\u6570\u636e\u5e93\u63a7\u5236\u8bed\u8a00(DCL) 3. DCL\uff08Data Control Language\uff0c\u6570\u636e\u63a7\u5236\u8bed\u8a00\uff09\u7528\u6765\u786e\u8ba4\u6216\u8005\u53d6\u6d88\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u7684\u53d8\u66f4\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u5bf9 RDBMS \u7684\u7528\u6237\u662f\u5426\u6709\u6743\u9650\u64cd\u4f5c\u6570\u636e\u5e93\u4e2d\u7684\u5bf9\u8c61\uff08\u6570\u636e\u5e93\u8868\u7b49\uff09\u8fdb\u884c\u8bbe\u5b9a\u3002 DCL \u5305\u542b\u4ee5\u4e0b\u51e0\u79cd\u6307\u4ee4\u3002     1. COMMIT\uff1a \u786e\u8ba4\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u7684\u53d8\u66f4     2. ROLLBACK\uff1a \u53d6\u6d88\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u7684\u53d8\u66f4     3. GRANT\uff1a \u8d4b\u4e88\u7528\u6237\u64cd\u4f5c\u6743\u9650     4. REVOKE\uff1a \u53d6\u6d88\u7528\u6237\u7684\u64cd\u4f5c\u6743\u9650</p> <p>\u6570\u636e\u5e93\u67e5\u8be2\u8bed\u8a00(DQL)</p> <p>SQL\u7684\u57fa\u672c\u4e66\u5199\u89c4\u5219\uff1a SQL\u8bed\u53e5\u8981\u4ee5\u5206\u53f7\uff08;\uff09\u7ed3\u5c3e\uff1b SQL\u8bed\u53e5\u4e0d\u533a\u5206\u5173\u952e\u5b57\u5927\u5c0f\u5199\uff0c\u63d2\u5165\u8868\u4e2d\u7684\u6570\u636e\u533a\u5206\u5927\u5c0f\u5199\uff1b \u5e38\u6570\u7684\u4e66\u5199\u65b9\u5f0f\u662f\u56fa\u5b9a\u7684\uff0c\u5b57\u7b26\u4e32\u548c\u65e5\u671f\u5e38\u6570\u9700\u8981\u4f7f\u7528\u5355\u5f15\u53f7\uff08'\uff09\u62ec\u8d77\u6765\uff0c\u6570\u5b57\u5e38\u6570\u65e0\u9700\u52a0\u6ce8\u5355\u5f15\u53f7\uff08\u76f4\u63a5\u4e66\u5199\u6570\u5b57\u5373\u53ef\uff09\uff1b \u5355\u8bcd\u95f4\u9700\u8981\u7528\u534a\u89d2\u7a7a\u683c\u6216\u8005\u6362\u884c\u6765\u5206\u9694\uff0c\u4e0d\u80fd\u4f7f\u7528\u5168\u89d2\u7a7a\u683c\u4f5c\u4e3a\u5355\u8bcd\u7684\u5206\u9694\u7b26\uff1b</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MySQL%E6%8C%87%E4%BB%A4/#_1","title":"\u589e","text":"<p>\u521b\u5efa\u6570\u636e\u5e93</p> <pre><code>CREATE DATABASE \u6570\u636e\u5e93\u540d;\n</code></pre> <p>\u521b\u5efa\u8868\u540d</p> <pre><code>CREATE TABLE \u8868\u540d ( \u5217\u540d1 \u6570\u636e\u7c7b\u578b1, \u5217\u540d2 \u6570\u636e\u7c7b\u578b2.... );\n</code></pre> <p>\u5411\u8868\u4e2d\u63d2\u5165\u6570\u636e</p> <pre><code>INSERT INTO \u8868\u540d VALUES (\u6570\u636e1,\u6570\u636e2...);\n</code></pre> <p>\u6307\u5b9a\u5217\u540d\u63d2\u5165\u6570\u636e</p> <pre><code>INSERT INTO \u8868\u540d (\u5217\u540d1,\u5217\u540d2...) VALUES(\u6570\u636e1,\u6570\u636e2...);\n</code></pre> <p>\u4e00\u6b21\u6027\u63d2\u5165\u591a\u884c\u6570\u636e</p> <pre><code>INSERT INTO \u8868\u540d (\u5217\u540d1,\u5217\u540d2...) VALUES (\u6570\u636e1,\u6570\u636e2...),(\u6570\u636e1,\u6570\u636e2...)...;\n</code></pre> <p>\u6dfb\u52a0\u5217</p> <pre><code>ALTER TABLE \u8868\u540d ADD \u5217\u540d \u6570\u636e\u7c7b\u578b;\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MySQL%E6%8C%87%E4%BB%A4/#_2","title":"\u5220","text":"<p>\u5220\u9664\u8868</p> <pre><code>DROP TABLE \u8868\u540d;\n</code></pre> <p>\u5220\u9664\u8868\u4e2d\u6570\u636e</p> <pre><code>DELETE FROM \u8868\u540d\n</code></pre> <p>\u5220\u9664\u5217</p> <pre><code>ALTER TABLE \u8868\u540d DROP \u5217\u540d;\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MySQL%E6%8C%87%E4%BB%A4/#_3","title":"\u6539","text":"<p>\u4fee\u6539\u5217\u7684\u4f4d\u7f6e</p> <pre><code># \u628a\u5217\u6dfb\u52a0\u5230\u6700\u524d\u9762\nALTER TABLE \u8868\u540d ADD \u5217\u540d \u6570\u636e\u7c7b\u578b FIRST;\n# \u5217\u6dfb\u52a0\u5230\u4efb\u610f\u4f4d\u7f6e\nALTER TABLE \u8868\u540d ADD \u5217\u540d \u6570\u636e\u7c7b\u578b AFTER \u5176\u4ed6\u5217;\n</code></pre> <p>\u4fee\u6539\u5217\u540d\u548c\u6570\u636e\u7c7b\u578b</p> <pre><code>ALTER TABLE \u8868\u540d CHANGE \u4fee\u6539\u524d\u7684\u5217\u540d \u4fee\u6539\u540e\u7684\u5217\u540d \u4fee\u6539\u540e\u7684\u6570\u7c7b\u578b;\n</code></pre> <p>\u8bbe\u7f6e\u4e3b\u952e</p> <pre><code>ALTER TABLE \u8868\u540d MODIFY \u5217\u540d \u6570\u636e\u7c7b\u578b PRIMARY KEY;\n</code></pre> <p>\u8bbe\u7f6e\u552f\u4e00\u503c</p> <pre><code>ALTER TABLE \u8868\u540d MODIFY \u5217\u540d \u6570\u636e\u7c7b\u578b UNIQUE;\n</code></pre> <p>\u8bbe\u7f6e\u9ed8\u8ba4\u503c</p> <pre><code>ALTER TABLE \u8868\u540d MODIFY \u5217\u540d \u6570\u636e\u7c7b\u578b DEFAULT \u503c;\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MySQL%E6%8C%87%E4%BB%A4/#_4","title":"\u67e5","text":"<p>\u663e\u793a\u6570\u636e\u5e93\u4fe1\u606f</p> <pre><code>SHOW DATABASE;\n</code></pre> <p>\u6307\u5b9a\u6570\u636e\u5e93</p> <pre><code>use \u6570\u636e\u5e93\u540d;\n</code></pre> <p>\u663e\u793a\u5f53\u524d\u4f7f\u7528\u7684\u6570\u636e\u5e93</p> <pre><code>SELECT DATABASE();\n</code></pre> <p>\u663e\u793a\u6240\u6709\u7684\u8868</p> <pre><code>SHOW TABLES;\n</code></pre> <p>\u663e\u793a\u8868\u7684\u5217\u7ed3\u6784</p> <pre><code>DESC \u8868\u540d;\n</code></pre> <p>\u663e\u793a\u5404\u5217\u6570\u636e</p> <pre><code>SELECT \u5217\u540d1,\u5217\u540d2...FROM \u8868\u540d;\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MySQL%E6%8C%87%E4%BB%A4/#_5","title":"\u7d22\u5f15","text":"<p>\u5927\u591a\u6570\u60c5\u51b5\u4e0b,\u5efa\u7acb\u7d22\u5f15\u80fd\u7f29\u77ed\u67e5\u627e\u65f6\u95f4\u3002</p> <p>\u521b\u5efa\u7d22\u5f15</p> <pre><code>CREATE INDEX \u7d22\u5f15\u540d ON \u8868\u540d(\u5217\u540d);\n</code></pre> <p>\u663e\u793a\u7d22\u5f15</p> <pre><code>SHOW INDEX FROM \u8868\u540d;\n</code></pre> <p>\u5220\u9664\u7d22\u5f15</p> <pre><code>DROP INDEX \u7d22\u5f15\u540d FROM \u8868\u540d;\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MySQL%E6%8C%87%E4%BB%A4/#_6","title":"\u590d\u5236","text":"<p>........</p> <p></p> <p>MySQL \u4e2d\u6ca1\u6709\u5e03\u5c14\u7c7b\u578b\uff0c<code>AND</code>\u00a0\u7684\u8fd0\u7b97\u7ed3\u679c\u662f\u00a0<code>1</code>,\u00a0<code>0</code>, \u6216\u8005\u00a0<code>NULL</code>\u3002  <pre><code>1 &gt; NULL &gt; 0\n\n1 AND NULL -&gt; NULL    NULL AND 0 -&gt; 0\n1 OR  NULL -&gt; 1       NULL OR 0  -&gt; NULL\n NOT NULL -&gt; NULL\n</code></pre> <code>AND</code>\u00a0\u8fd0\u7b97\u7b26\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u00a0<code>OR</code>\u00a0\u8fd0\u7b97\u7b26 <pre><code>1 AND 0 OR 0 -&gt; (1 AND 0) OR 0\n</code></pre></p> <p>\u53ef\u4ee5\u4f7f\u7528\u62ec\u53f7\u66f4\u6539\u8fd0\u7b97\u987a\u5e8f <pre><code>SELECT (1 OR 0) AND 0;\n</code></pre> <pre><code>+----------------+\n| (1 OR 0) AND 0 |\n+----------------+\n|              0 |\n+----------------+\n1 row in set (0.00 sec)\n</code></pre></p> <p><code>IN</code>\u00a0\u8fd0\u7b97\u7b26\u7528\u6765\u68c0\u67e5\u4e00\u4e2a\u5b57\u6bb5\u6216\u503c\u662f\u5426\u5305\u542b\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\uff0c\u5982\u679c\u503c\u5305\u542b\u5728\u96c6\u5408\u4e2d\u8fd4\u56de\u00a0<code>1</code>\uff0c\u5426\u5219\u8fd4\u56de\u00a0<code>0</code>\u3002 </p> <p><code>NOT IN</code>\u00a0\u548c\u00a0<code>IN</code>\u00a0\u7528\u6cd5\u51e0\u4e4e\u4e00\u6837\uff0c\u53ea\u662f\u5728\u00a0<code>IN</code>\u00a0\u524d\u9762\u6dfb\u52a0\u4e00\u4e2a\u00a0<code>NOT</code>\u00a0\u5173\u952e\u5b57\uff0c<code>IN</code>\u00a0\u7684\u5426\u5b9a\u64cd\u4f5c\u7b26\u3002</p> <p><code>BETWEEN</code>\u00a0\u8fd0\u7b97\u7b26\u786e\u5b9a\u4e00\u4e2a\u503c\u662f\u5426\u4ecb\u4e8e\u67d0\u4e24\u4e2a\u503c\u4e4b\u95f4\u3002<code>BETWEEN</code>\u00a0\u8fd0\u7b97\u7b26\u5e38\u7528\u4e8e\u6bd4\u8f83\u6570\u5b57\u548c\u65e5\u671f\u7c7b\u578b\u7684\u6570\u636e\u3002 <pre><code>xxx BETWEEN min AND max\nxxx NOT BETWEEN min AND max\n</code></pre> MySQL BETWEEN \u7528\u6cd5\u4e0e\u5b9e\u4f8b MySQL LIKE \u7528\u6cd5\u4e0e\u5b9e\u4f8b MySQL EXISTS \u7684\u7528\u6cd5\u4e0e\u5b9e\u4f8b \u4f7f\u7528CASE\u53ef\u4ee5\u8fdb\u884c\u6392\u5e8f</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/MySQL%E6%8C%87%E4%BB%A4/#trick","title":"Trick","text":"<p>\u5efa\u7acbutf8\u7684databse</p> <pre><code>CREATE DATABASE your_database_name CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n</code></pre> <p>linux\u5b89\u88c5mysql</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Nginx/","title":"Nginx","text":"<p>Docker Nginx\u5b89\u88c5\u4f7f\u7528\u4ee5\u53ca\u8e29\u5751\u70b9\u603b\u7ed3 - LiangSenCheng\u5c0f\u68ee\u68ee - \u535a\u5ba2\u56ed</p> <p>NGINX \u5907\u5fd8\u6e05\u5355 &amp; nginx cheatsheet &amp; Quick Reference</p> <p>\u542f\u52a8 <pre><code>nginx           # \u542f\u52a8\nnginx -s reload # \u91cd\u542f\nnginx -s quit   # \u5e73\u6ed1\u5173\u95ednginx\nnginx -s stop   # \u5173\u95ed\u8fdb\u7a0b\nnginx -V        # \u67e5\u770bnginx\u7684\u5b89\u88c5\u72b6\u6001\nsudo nginx -t   # \u68c0\u67e5nginx.conf\u8bed\u6cd5\n</code></pre></p> <p>[!note] nginx\u9ed8\u8ba4\u7aef\u53e3\u4e3a80</p> <p>\u4f7f\u7528<code>whereis nginx</code>\u67e5\u770bnginx\u7684\u76ee\u5f55\u4f4d\u7f6e</p> <pre><code>whereis nginx\nnginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx\n</code></pre> <p>\u5168\u5c40\u53d8\u91cf <pre><code>$host   # \u8bf7\u6c42\u4e3b\u673a\u5934\u5b57\u6bb5\uff0c\u5426\u5219\u4e3a\u670d\u52a1\u5668\u540d\u79f0\n</code></pre></p> <p>\u7b80\u5355\u4ee3\u7406 <pre><code>location / {\n  proxy_pass http://127.0.0.1:3000;\n  proxy_redirect      off;\n  proxy_set_header    Host $host;\n}\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/","title":"Redis\u4f7f\u7528","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#redis_1","title":"redis","text":"<pre><code>redis-server  // \u542f\u52a8redis\u670d\u52a1\u5668\nredis-cli     // \u542f\u52a8redis\u547d\u4ee4\u884c\u5de5\u5177\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#_1","title":"\u57fa\u672c\u64cd\u4f5c","text":"<p>\u6e05\u9664\u6240\u6709\u503c</p> <pre><code>FLUSHALL\n</code></pre> <p>\u8bbe\u7f6ekey</p> <pre><code>SET key value\n</code></pre> <p>\u83b7\u53d6key</p> <pre><code>GET key\n</code></pre> <p>\u67e5\u770bkey\u662f\u5426\u5b58\u5728</p> <pre><code>EXISTS key\n</code></pre> <p>\u67e5\u770b\u6240\u6709\u7684key</p> <pre><code>KEYS \u6a21\u5f0f\u53c2\u6570\n</code></pre> <p>\u67e5\u770b\u4ee5<code>llo</code>\u7ed3\u5c3e\u7684\u952e</p> <pre><code>KEYS *llo\n</code></pre> <p>\u67e5\u770b\u540d\u4e3a<code>name</code>\u7684\u952e</p> <pre><code>KEYS name\n</code></pre> <p>\u5220\u9664key</p> <pre><code>DEL key\n</code></pre> <p>\u5220\u9664\u6240\u6709\u952e</p> <pre><code>FLASHALL\n</code></pre> <p>\u589e\u52a0key 1</p> <pre><code>INCR key\n</code></pre> <p>\u51cf\u5c11key 1</p> <pre><code>DECR key\n</code></pre> <p>\u589e\u52a0key \u7279\u5b9anum</p> <pre><code>INCRBY key number\n</code></pre> <p>\u51cf\u5c11key \u7279\u5b9anum</p> <pre><code>DECRBY key number\n</code></pre> <p>[!info]  Redis\u4e2d\u5355\u4e2a\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u591a\u4e2a\u5ba2\u6237\u7aef\u64cd\u4f5c\u65f6\uff0c\u4e0d\u4f1a\u53d1\u751f\u5e76\u53d1\u51b2\u7a81\u3002</p> <p>x ==&gt; 10</p> <p>A: INCR x</p> <p>B: INCR x</p> <p>x ==&gt; 12</p> <p>\u8bbe\u7f6ekey\u7684\u5bff\u547d\u4e3axx\u79d2</p> <pre><code>EXPIRE key number\n</code></pre> <p>\u67e5\u770bkey\u7684\u5bff\u547d</p> <p><pre><code>TTL key\n</code></pre> \u5f53\u8fd4\u56de\u503c\u4e3a-1\u65f6\uff0ckey\u6ca1\u6709\u5bff\u547d\u9650\u5236</p> <p>\u5f53\u8fd4\u56de\u503c\u4e3a-2\u65f6\uff0ckey\u4e0d\u5b58\u5728\u6216\u5df2\u7ecf\u6d88\u5931</p> <p>[!note] \u5f53\u91cd\u65b0SET key\u7684\u503c\u540e\uff0c\u5176\u751f\u547d\u5468\u671f\u5c06\u88ab\u91cd\u7f6e(\u65e0\u9650\u6216\u81ea\u5b9a\u4e49)</p> <p>\u8bbe\u7f6ekey\u7684\u503c\u548c\u751f\u547d\u5468\u671f <pre><code>SET key value EX number\n</code></pre></p> <p>\u53d6\u6d88\u751f\u547d\u5468\u671f\u9650\u5236 <pre><code>PERSIST key\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#_2","title":"\u6570\u636e\u7c7b\u578b","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#strings","title":"\u5b57\u7b26\u4e32 Strings","text":"<p>Redis Strings \u80fd\u591f\u5b58\u50a8\u5e8f\u5217\u7684bytes\uff0c\u5305\u62ec\u6587\u672c\u3001\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\u3001\u4e8c\u8fdb\u5236\u6570\u7ec4\u3002\uff08\u663e\u7136\u53ef\u4ee5\u5b58\u50a8\u56fe\u50cf\uff09</p> <p>\u503c\u7684\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc7512MB</p> <p>\u8bbe\u7f6e\u548c\u8bfb\u53d6\u591a\u4e2akey <pre><code>&gt; mset a 10 b 20 c 30\nOK\n&gt; mget a b c\n1) \"10\"\n2) \"20\"\n3) \"30\"\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#list","title":"\u5217\u8868 List","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#_3","title":"\u57fa\u672c\u6307\u4ee4","text":"<ul> <li><code>LPUSH</code>\u00a0adds a new element to the head of a list;\u00a0<code>RPUSH</code>\u00a0adds to the tail.</li> <li><code>LPOP</code>\u00a0removes and returns an element from the head of a list;\u00a0<code>RPOP</code>\u00a0does the same but from the tails of a list.</li> <li><code>LLEN</code>\u00a0returns the length of a list.</li> <li><code>LMOVE</code>\u00a0atomically moves elements from one list to another.</li> <li><code>LTRIM</code>\u00a0reduces a list to the specified range of elements.</li> </ul> <p><code>LPUSH</code> \u5c06\u4e00\u4e2a\u65b0\u7684\u5143\u7d20\u653e\u5728list\u7684\u5934\u90e8 <code>RPUSH</code> \u5c06\u4e00\u4e2a\u65b0\u7684\u5143\u7d20\u653e\u5728list\u7684\u5c3e\u90e8 <pre><code>LPUSH key element [element ...]\n</code></pre></p> <p><code>LPOP</code> \u4ecelist\u5934\u90e8\u5220\u9664\u5e76\u8fd4\u56de\u4e00\u4e2a\u5143\u7d20 <code>RPOP</code> \u4ecelist\u5c3e\u90e8\u5220\u9664\u5e76\u8fd4\u56de\u4e00\u4e2a\u5143\u7d20 <pre><code>LPOP key [count]\n</code></pre></p> <p><code>LLEN</code> \u8fd4\u56delist\u7684\u957f\u5ea6 <pre><code>LLEN key\n</code></pre></p> <p><code>LMOVE</code> \u539f\u5b50\u5730\u5c06\u5143\u7d20\u79fb\u52a8\u5230\u53e6\u4e00\u4e2alist <pre><code>LMOVE source destination &lt;LEFT | RIGHT&gt; &lt;LEFT | RIGHT&gt;\n</code></pre></p> <p><code>LTRIM</code> \u5c06\u4e00\u4e2a\u5217\u8868\u51cf\u5c11\u5230\u6307\u5b9a\u7684\u5143\u7d20\u8303\u56f4\u3002</p> <p><code>LRANGE</code> \u4ece\u5de6\u5230\u53f3\u904d\u5386list  <code>RRANGE</code> \u4ece\u53f3\u5230\u5de6\u904d\u5386lit <pre><code>LRANGE list 0 -1\n</code></pre></p> <pre><code>redis&gt; LPUSH list \"d\" \"c\" \"b\" \"a\"\n(integer) 4\nredis&gt; LRANGE list 0 -2\n1) \"a\"\n2) \"b\"\n3) \"c\"\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#set","title":"\u96c6\u5408 Set","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#_4","title":"\u57fa\u672c\u6307\u4ee4","text":"<ul> <li><code>SADD</code>\u00a0adds a new member to a set.</li> <li><code>SREM</code>\u00a0removes the specified member from the set.</li> <li><code>SISMEMBER</code>\u00a0tests a string for set membership.</li> <li><code>SINTER</code>\u00a0returns the set of members that two or more sets have in common (i.e., the intersection).</li> <li><code>SCARD</code>\u00a0returns the size (a.k.a. cardinality) of a set. See the\u00a0complete list of set commands.</li> </ul> <p><code>SADD</code> \u5411\u96c6\u5408\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u5143\u7d20 <pre><code>SADD key member [member ...]\n</code></pre></p> <p><code>SREM</code> \u79fb\u9664\u96c6\u5408\u4e2d\u7684\u7279\u5b9a\u5143\u7d20 <pre><code>SREM key member [member ...]\n</code></pre></p> <p><code>SISMEMBER</code> \u67e5\u770b\u5143\u7d20\u662f\u5426\u5728\u96c6\u5408\u4e2d <pre><code>SISMEMBER key member\n</code></pre></p> <p><code>SINTER</code> \u8fd4\u56de\u96c6\u5408\u7684\u4ea4\u96c6 <pre><code>SINTER key [key ...]\n</code></pre></p> <p><code>SCARD</code> \u8fd4\u56de\u96c6\u5408\u4e2d\u5143\u7d20\u7684\u4e2a\u6570 <pre><code>SCARD key\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#hash","title":"\u54c8\u5e0c Hash","text":"<p><code>HSET</code> \u8bbe\u7f6e\u54c8\u5e0c\u4e2d\u7684\u952e\u503c\u5bf9 <pre><code>HSET key \u952e \u503c\n</code></pre></p> <p><code>HGET</code> \u83b7\u53d6\u952e|\u503c <pre><code>HGET key \u952e|\u503c\n</code></pre></p> <p><code>HGETALL</code> \u83b7\u53d6\u6240\u6709\u952e\u503c\u5bf9 <pre><code>&gt; HGETALL\n\u952e\n\u503c\n\u952e\n\u503c\n...\n...\n</code></pre></p> <p><code>HDEL</code> \u5220\u9664\u54c8\u5e0c\u4e2d\u7684\u67d0\u4e2a\u952e\u503c\u5bf9 <pre><code>HDEL key \u952e|\u503c\n</code></pre></p> <p><code>HEXISTS</code> \u5224\u65ad\u67d0\u4e2a\u952e\u503c\u5bf9\u662f\u5426\u5b58\u5728 <pre><code>HEXISTS key \u952e\n</code></pre></p> <p><code>HKEYS</code> \u67e5\u770b\u6709\u54ea\u4e9b\u952e(filed) <pre><code>HKEYS key\n</code></pre></p> <p><code>HLEN</code> \u67e5\u770b\u54c8\u5e0c\u4e2d\u952e\u503c\u5bf9\u7684\u6570\u91cf <pre><code>HLEN key\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#sortedset","title":"\u6709\u5e8f\u96c6\u5408 SortedSet","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#_5","title":"\u57fa\u672c\u6307\u4ee4","text":"<p><code>ZADD</code> <pre><code>ZADD key  \u503c \u952e \u503c \u952e ...\n</code></pre></p> <p><code>ZRANGE</code> <pre><code>ZRANGE key \u8d77\u59cb\u4f4d\u7f6e \u7ed3\u675f\u4f4d\u7f6e\nZRANGE key \u8d77\u59cb\u4f4d\u7f6e \u7ed3\u675f\u4f4d\u7f6e WITHSCORES\n</code></pre></p> <p><code>ZSCORE</code>  \u67e5\u770b\u96c6\u5408\u4e2d\u5143\u7d20\u7684\u503c <pre><code>ZSCORE key \u952e\n</code></pre></p> <p><code>ZRANK</code> \u67e5\u770b\u67d0\u5143\u7d20\u7684\u6392\u540d <pre><code>ZRANK key \u952e\n</code></pre></p> <p><code>ZREVRANK</code> \u67e5\u770b\u67d0\u5143\u7d20\u7684\u6392\u540d\uff08\u4ece\u5927\u5230\u5c0f\uff09 <pre><code>ZREVRANK key \u952e\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#geospatial","title":"\u5730\u7406\u7a7a\u95f4Geospatial","text":"<p><code>GEOADD</code> \u6dfb\u52a0\u5730\u7406\u4f4d\u7f6e\u4fe1\u606f <pre><code>GEOADD key \u7ecf\u5ea6 \u7eac\u5ea6 \u57ce\u5e02\u540d (\u7ecf\u5ea6 \u7eac\u5ea6 \u57ce\u5e02\u540d \u7ecf\u5ea6 \u7eac\u5ea6 \u57ce\u5e02\u540d ...)\n</code></pre></p> <p><code>GEOPOS</code> \u83b7\u53d6\u5730\u7406\u4f4d\u7f6e\u7684\u7ecf\u7eac\u5ea6 <pre><code>GEOPOS key \u57ce\u5e02\u540d\n</code></pre></p> <p><code>GEODIST</code> \u4e24\u4e2a\u4f4d\u7f6e\u95f4\u7684\u8ddd\u79bb(\u9ed8\u8ba4\u5355\u4f4d\u4e3aM) <pre><code>GEODIST key city1 city2 \n</code></pre></p> <p><pre><code>GEODIST key city1 city2 KM\n</code></pre> \u7ed3\u679c\u4ee5KM\u4e3a\u5355\u4f4d</p> <p><code>GEOSEARCH</code> \u641c\u7d22\u4e34\u8fd1\u7684\u4f4d\u7f6e <pre><code>GEOSEARCH key FROMMEMBER city1 BYRADIUS 300KM\n</code></pre> \u641c\u7d22city1 300KM\u5185\u7684\u4f4d\u7f6e(\u4f1a\u5305\u62ec\u81ea\u5df1)</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#hyperloglog","title":"HyperLogLog","text":"<p>\u901a\u8fc7\u964d\u4f4e\u7cbe\u786e\u5ea6\uff0c\u6362\u53d6\u66f4\u5c0f\u7684\u5185\u5b58\u6d88\u8017</p> <pre><code>PFADD key member [member ...]\n</code></pre> <p>\u8bfb\u53d6\u57fa\u6570 <pre><code>PFCOUNT key\n</code></pre></p> <p>\u5408\u5e76\u591a\u4e2ahyperloglog <pre><code>PFMERGE key-result key1 key2\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#bitmap","title":"\u4f4d\u56feBitmap","text":"<p>bitmap\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u4ee5\u4f4d\u7684\u65b9\u5f0f\u5b58\u50a8\u6570\u636e\u3002\u6bcf\u4e2a\u4f4d\u4ee3\u8868\u4e00\u4e2a\u4e8c\u8fdb\u5236\u503c\uff0c\u53ef\u4ee5\u662f0\u62161\u3002Bitmap\u5728Redis\u4e2d\u4ee5\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u5b58\u50a8\uff0c\u6bcf\u4e2a\u5b57\u7b26\u53ef\u4ee5\u5b58\u50a88\u4e2a\u4f4d\u3002</p> <p>Bitmap\u53ef\u7528\u4e8e\u7edf\u8ba1\u5728\u7ebf\u7528\u6237\u3001\u7edf\u8ba1\u7528\u6237\u6d3b\u8dc3\u5ea6</p> <p>value\u53ea\u80fd\u4e3a0\u62161</p> <p>\u8bbe\u7f6eoffset\u4f4d\u7f6e\u7684\u503c</p> <pre><code>SETBIT key offset value\n</code></pre> <p>\u5f97\u5230offset\u4f4d\u7f6e\u7684\u503c</p> <pre><code>GETBIT key offset\n</code></pre> <p>\u8bbe\u7f6e\u67d0\u6bb5\u4f4d\u7f6e\u7684\u503c(\u56e0\u4e3a\u4f4d\u56fe\u672c\u8d28\u4e0a\u662f\u5b57\u7b26\u4e32)</p> <pre><code>SET Key \"\\xF0\"\n</code></pre> <p>F0 (11110000)</p> <p>\u7edf\u8ba1key\u91cc\u6709\u591a\u5c11\u4e2a1 <pre><code>BITCOUNT key\n</code></pre></p> <p>\u5f97\u5230key\u91cc\u7b2c\u4e00\u4e2a0\u62161\u7684\u4f4d\u7f6e</p> <pre><code>BITPOS key 0\nBITPOS key 1\n\nBITPOS key 1 strat end\n</code></pre> <p><code>BITFIELD</code>\u547d\u4ee4\u662f\u7528\u4e8e\u5bf9\u4f4d\u56fe\u8fdb\u884c\u64cd\u4f5c\u7684\u547d\u4ee4\u3002\u4f4d\u56fe\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784\uff0c\u5b83\u53ef\u4ee5\u5c06\u4e00\u4e2a\u8fde\u7eed\u7684\u4f4d\u5e8f\u5217\u7ec4\u7ec7\u8d77\u6765\uff0c\u6bcf\u4e2a\u4f4d\u53ea\u80fd\u5b58\u50a8<code>0</code>\u6216<code>1</code>\u3002<code>BITFIELD</code>\u547d\u4ee4\u53ef\u4ee5\u5bf9\u4f4d\u56fe\u8fdb\u884c\u8bfb\u53d6\u3001\u8bbe\u7f6e\u3001\u4fee\u6539\u548c\u8ba1\u6570\u7b49\u64cd\u4f5c\u3002</p> <p><code>BITFIELD</code>\u547d\u4ee4\u7684\u57fa\u672c\u8bed\u6cd5\u5982\u4e0b\uff1a <pre><code>BITFIELD key [GET type offset] [SET type offset value] [INCRBY type offset increment] [OVERFLOW WRAP|SAT|FAIL]\n</code></pre></p> <p>\u4f4d\u56fe\u7684\u6bcf\u4e2a\u4f4d\u90fd\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u7c7b\u578b\u8868\u793a\uff0c\u5e38\u89c1\u7684\u7c7b\u578b\u6709\uff1a - <code>u[N]</code>\uff1a\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u5360\u7528N\u4e2a\u4f4d\uff0c\u53ef\u4ee5\u8868\u793a\u7684\u6700\u5927\u503c\u4e3a2^N-1\u3002 - <code>i[N]</code>\uff1a\u6709\u7b26\u53f7\u6574\u6570\uff0c\u5360\u7528N\u4e2a\u4f4d\uff0c\u53ef\u4ee5\u8868\u793a\u7684\u8303\u56f4\u4e3a-2<sup>(N-1)\u52302</sup>(N-1)-1\u3002 - <code>f[N.M]</code>\uff1a\u6d6e\u70b9\u6570\uff0c\u5360\u7528N\u4e2a\u4f4d\uff0c\u5176\u4e2dM\u4e2a\u4f4d\u8868\u793a\u5c0f\u6570\u90e8\u5206\u3002</p> <p><code>BITFIELD</code>\u547d\u4ee4\u7684\u5177\u4f53\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a - <code>GET type offset</code>\uff1a\u83b7\u53d6\u4f4d\u56fe\u4e2d\u6307\u5b9a\u504f\u79fb\u91cf\u7684\u4f4d\u7684\u503c\u3002 - <code>SET type offset value</code>\uff1a\u8bbe\u7f6e\u4f4d\u56fe\u4e2d\u6307\u5b9a\u504f\u79fb\u91cf\u7684\u4f4d\u7684\u503c\u3002 - <code>INCRBY type offset increment</code>\uff1a\u5c06\u4f4d\u56fe\u4e2d\u6307\u5b9a\u504f\u79fb\u91cf\u7684\u4f4d\u7684\u503c\u589e\u52a0\u6307\u5b9a\u7684\u589e\u91cf\u3002 - <code>OVERFLOW WRAP|SAT|FAIL</code>\uff1a\u8bbe\u7f6e\u4f4d\u56fe\u64cd\u4f5c\u6ea2\u51fa\u65f6\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u53ef\u9009\u7684\u5904\u7406\u65b9\u5f0f\u6709\uff1a<code>WRAP</code>\uff08\u5faa\u73af\uff09\u3001<code>SAT</code>\uff08\u9971\u548c\uff09\u548c<code>FAIL</code>\uff08\u5931\u8d25\uff09\u3002</p> <p><code>BITFIELD</code>\u547d\u4ee4\u53ef\u4ee5\u7528\u4e8e\u4e00\u4e9b\u5e38\u89c1\u7684\u5e94\u7528\u573a\u666f\uff0c\u4f8b\u5982\uff1a - \u7edf\u8ba1\u7528\u6237\u7684\u7b7e\u5230\u60c5\u51b5\uff1a\u4f7f\u7528\u4f4d\u56fe\u8bb0\u5f55\u7528\u6237\u6bcf\u5929\u662f\u5426\u7b7e\u5230\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u8fdb\u884c\u7b7e\u5230\u6b21\u6570\u7edf\u8ba1\u3002 - \u5b58\u50a8\u7528\u6237\u6743\u9650\uff1a\u4f7f\u7528\u4f4d\u56fe\u8bb0\u5f55\u7528\u6237\u7684\u6743\u9650\u4fe1\u606f\uff0c\u53ef\u4ee5\u5feb\u901f\u5224\u65ad\u7528\u6237\u662f\u5426\u5177\u6709\u67d0\u9879\u6743\u9650\u3002 - \u8ba1\u6570\u5668\uff1a\u4f7f\u7528\u4f4d\u56fe\u8bb0\u5f55\u67d0\u4e2a\u4e8b\u4ef6\u53d1\u751f\u7684\u6b21\u6570\uff0c\u53ef\u4ee5\u5b9e\u73b0\u7b80\u5355\u7684\u8ba1\u6570\u529f\u80fd\u3002</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#stream","title":"\u8ba2\u9605\u6a21\u5f0f\u548cStream","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#_6","title":"\u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f","text":"<p>\u9700\u8981\u591a\u4e2a\u7ec8\u7aef</p> <p><code>SUBSCRIBE</code> \u8ba2\u9605\u67d0\u4e2a\u9891\u9053\uff08\u7136\u540e\u4e00\u76f4\u8fdb\u884c\u7b49\u5f85\uff0c\u63a5\u6536\u5230\u6d88\u606f\u4e5f\u4e0d\u4f1a\u505c\u6b62\uff09 <pre><code>SUBSCRIBE \u9891\u9053\u540d\n</code></pre></p> <p><code>PUBLISH</code> \u5728\u67d0\u4e2a\u9891\u9053\u4e0a\u53d1\u5e03\u6d88\u606f</p> <pre><code>PUBLISH \u9891\u9053\u540d \u6d88\u606f\n</code></pre> <p>\u53ef\u4ee5\u6709\u591a\u4e2a\u63a5\u6536\u8005\u3002</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#stream_1","title":"\u6d88\u606f\u961f\u5217Stream","text":"<p>\u521b\u5efa\u4e00\u4e2aStream\uff0c\u5e76\u5411\u5176\u4e2d\u6dfb\u52a0\u6d88\u606f</p> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u547d\u4ee4\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a<code>mystream</code>\u7684Stream\uff0c\u5e76\u6dfb\u52a0\u4e86\u4e00\u4e2a\u6d88\u606f\uff1a</p> <pre><code>XADD mystream * message hello\n</code></pre> <p>\u5176\u4e2d\uff0c<code>*</code>\u8868\u793a\u4f7f\u7528redis\u81ea\u52a8\u751f\u6210\u7684\u5f53\u524d\u65f6\u95f4\u6233\u4f5c\u4e3a\u6d88\u606f\u7684ID\uff0c<code>message</code>\u662f\u6d88\u606f\u7684\u952e\uff0c<code>hello</code>\u662f\u6d88\u606f\u7684\u503c\u3002</p> <p>\u83b7\u5f97Stream\u957f\u5ea6 <pre><code>XLEN mystream\n</code></pre></p> <p>\u4f7f\u7528<code>XRANGE</code>\u5f97\u5230Stream\u4e2d\u7684\u6240\u6709\u4fe1\u606f <pre><code>XRANGE mystream - +\n</code></pre></p> <p>\u5220\u9664\u4fe1\u606f <pre><code>XDEL mystream id\n</code></pre></p> <p>\u4f7f\u7528<code>XTRIM</code>\u4fdd\u7559\u6307\u5b9a\u6570\u91cf\u7684\u6761\u76ee\u6765\u63a7\u5236stream\u6570\u636e\u7ed3\u6784\u7684\u5927\u5c0f</p> <pre><code>XTRIM mystream MAXLEN [~] count\n</code></pre> <p>MAXLEN\u662f\u4e00\u4e2a\u8868\u793a\u6700\u5927\u957f\u5ea6\u7684\u6574\u6570\u503c\uff0ccount\u662f\u4e00\u4e2a\u6574\u6570\u503c\uff0c\u7528\u4e8e\u6307\u5b9a\u8981\u4fdd\u7559\u7684\u6700\u5927\u6761\u76ee\u6570\u91cf\u3002</p> <p>count\u53ef\u4ee5\u662f\u6b63\u6574\u6570\uff0c\u8868\u793a\u4fdd\u7559\u6700\u65b0\u7684count\u6761\u76ee\uff1b\u4e5f\u53ef\u4ee5\u662f\u8d1f\u6574\u6570\uff0c\u8868\u793a\u4fdd\u7559\u6700\u65e7\u7684count\u6761\u76ee\u3002\u5982\u679c\u5728count\u524d\u9762\u52a0\u4e0a\"~\"\u7b26\u53f7\uff0c\u5219\u8868\u793a\u4fdd\u7559\u7684\u6761\u76ee\u6570\u91cf\u662f\u4e0d\u5305\u62eccount\u6761\u76ee\u5728\u5185\u7684\u3002</p> <p>\u4f7f\u7528<code>XREAD</code>\u6216<code>XREADGROUP</code>\u547d\u4ee4\u6765\u4eceStream\u4e2d\u8bfb\u53d6\u6d88\u606f\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u547d\u4ee4\u8bfb\u53d6\u4e86<code>mystream</code>\u4e2d\u7684\u6240\u6709\u6d88\u606f\uff1a <pre><code>XREAD STREAMS mystream 0\n</code></pre> \u5176\u4e2d\uff0c<code>STREAMS mystream 0</code>\u8868\u793a\u4ece<code>mystream</code>\u4e2d\u8bfb\u53d6\u4eceID\u4e3a0\u5f00\u59cb\u7684\u6240\u6709\u6d88\u606f\u3002<code>STREAMS mystream $</code>\u8868\u793a\u8bfb\u53d6\u73b0\u5728\u5f00\u59cb\u4ee5\u540e\u6700\u65b0\u7684\u6d88\u606f</p> <pre><code>XREAD COUNT 2 BLOCK 1000 STREAMS mystream 0\n</code></pre> <p>COUNT 2 \u8868\u793a\u4e00\u6b21\u8bfb\u53d6\u4e24\u4e2a\u6d88\u606f\uff0cBLOCK\u8868\u793a\u6ca1\u6709\u6d88\u606f\u7684\u8bdd\uff0c\u963b\u585e1000\u6beb\u79d2</p> <p>\u6d88\u606f\u662f\u91cd\u590d\u8bfb\u53d6\u7684</p> <p>\u53ef\u4ee5\u4f7f\u7528<code>XREADGROUP</code>\u547d\u4ee4\u6765\u521b\u5efa\u4e00\u4e2a\u6d88\u8d39\u8005\u7ec4\uff0c\u5e76\u4eceStream\u4e2d\u6d88\u8d39\u6d88\u606f\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u547d\u4ee4\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a<code>mygroup</code>\u7684\u6d88\u8d39\u8005\u7ec4\uff0c\u5e76\u4ece<code>mystream</code>\u4e2d\u6d88\u8d39\u6d88\u606f\uff1a <pre><code>XGROUP CREATE mystream mygroup 0\n</code></pre></p> <p>\u4f7f\u7528<code>XINFO</code>\u67e5\u770b\u6d88\u8d39\u8005\u7ec4\u7684\u4fe1\u606f <pre><code>XINFO GROUPS mygroup\n</code></pre></p> <p>\u5c06\u6d88\u8d39\u8005\u52a0\u5165\u6d88\u8d39\u8005\u7ec4 <pre><code>XGROUP CREATECONSUMER mystream mygroup consumer1\n</code></pre></p> <p>\u63a5\u4e0b\u6765\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528<code>XREADGROUP</code>\u547d\u4ee4\u6765\u4ece<code>mygroup</code>\u4e2d\u6d88\u8d39\u6d88\u606f\uff1a <pre><code>XREADGROUP GROUP mygroup consumer1 COUNT 1 STREAMS mystream &gt;\n</code></pre></p> <p>\u5176\u4e2d\uff0c<code>GROUP mygroup consumer1</code>\u8868\u793a\u52a0\u5165\u5230<code>mygroup</code>\u6d88\u8d39\u8005\u7ec4\u4e2d\uff0c\u5e76\u4f7f\u7528<code>consumer1</code>\u4f5c\u4e3a\u6d88\u8d39\u8005\u7684\u540d\u79f0\uff0c<code>COUNT 1</code>\u8868\u793a\u4e00\u6b21\u6700\u591a\u6d88\u8d391\u6761\u6d88\u606f\uff0c<code>STREAMS mystream &gt;</code>\u8868\u793a\u4ece<code>mystream</code>\u4e2d\u8bfb\u53d6\u4ece\u4e0a\u6b21\u6d88\u8d39\u7684\u4f4d\u7f6e\u5f00\u59cb\u7684\u6240\u6709\u6d88\u606f\u3002</p> <p>\u5f53\u4f60\u6210\u529f\u6d88\u8d39\u4e86\u4e00\u6761\u6d88\u606f\u540e\uff0c\u4f60\u9700\u8981\u4f7f\u7528<code>XACK</code>\u547d\u4ee4\u6765\u786e\u8ba4\u6d88\u8d39\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u547d\u4ee4\u786e\u8ba4\u4e86<code>mygroup</code>\u6d88\u8d39\u8005\u7ec4\u6d88\u8d39\u4e86ID\u4e3a<code>1591020728176-0</code>\u7684\u6d88\u606f\uff1a <pre><code>XACK mystream mygroup 1591020728176-0\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#_7","title":"\u4e8b\u52a1","text":"<p>Redis\u7684\u4e8b\u52a1\u662f\u901a\u8fc7 MULTI\u3001EXEC\u3001DISCARD \u548c WATCH \u7b49\u547d\u4ee4\u6765\u5b9e\u73b0\u7684\u3002</p> <ol> <li>MULTI\uff1a\u7528\u4e8e\u6807\u8bb0\u4e00\u4e2a\u4e8b\u52a1\u7684\u5f00\u59cb\uff0c\u4e4b\u540e\u7684\u547d\u4ee4\u90fd\u4f1a\u88ab\u653e\u5165\u4e8b\u52a1\u961f\u5217\u4e2d\u7b49\u5f85\u6267\u884c\u3002</li> <li>EXEC\uff1a\u6267\u884c\u6240\u6709\u5728\u4e8b\u52a1\u961f\u5217\u4e2d\u7684\u547d\u4ee4\u5e76\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0cRedis\u4f1a\u6309\u987a\u5e8f\u6267\u884c\u6240\u6709\u7684\u547d\u4ee4\uff0c\u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u5931\u8d25\uff0c\u90a3\u4e48\u4e8b\u52a1\u4f1a\u7ec8\u6b62\uff0c\u5df2\u6267\u884c\u7684\u547d\u4ee4\u4e0d\u4f1a\u56de\u6eda\u3002</li> <li>DISCARD\uff1a\u53d6\u6d88\u5f53\u524d\u4e8b\u52a1\uff0c\u6e05\u7a7a\u4e8b\u52a1\u961f\u5217\uff0c\u5e76\u6062\u590d\u5230\u975e\u4e8b\u52a1\u72b6\u6001\u3002</li> <li>WATCH\uff1a\u7528\u4e8e\u76d1\u89c6\u4e00\u4e2a\u6216\u591a\u4e2a\u952e\uff0c\u5982\u679c\u5728\u4e8b\u52a1\u6267\u884c\u671f\u95f4\u88ab\u5176\u4ed6\u5ba2\u6237\u7aef\u4fee\u6539\uff0c\u5219\u4e8b\u52a1\u5c06\u88ab\u653e\u5f03\u3002</li> </ol> <pre><code>MULTI\n\nxxx\nxxx\nxxx\n\nEXEC/DISCARD\n</code></pre> <p>[!info] \u5728Redis\u4e2d\uff0c\u4e8b\u52a1\u5e76\u4e0d\u5177\u5907\u539f\u5b50\u6027\uff0c\u5f53\u4e8b\u52a1\u4e2d\u7684\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u5931\u8d25\u65f6\uff0c\u5269\u4f59\u7684\u547d\u4ee4\u4ecd\u7136\u4f1a\u7ee7\u7eed\u6267\u884c</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#redis_2","title":"Redis\u6301\u4e45\u5316","text":"<p>\u53ef\u5728<code>/etc/redis/redis.conf</code> \u4fee\u6539<code>save</code>\u914d\u7f6e\uff0c</p> <pre><code>################################ SNAPSHOTTING  ################################\n\n# Save the DB to disk.\n#\n# save &lt;seconds&gt; &lt;changes&gt; [&lt;seconds&gt; &lt;changes&gt; ...]\n#\n# Redis will save the DB if the given number of seconds elapsed and it\n# surpassed the given number of write operations against the DB.\n#\n# Snapshotting can be completely disabled with a single empty string argument\n# as in following example:\n#\n# save \"\"\n#\n# Unless specified otherwise, by default Redis will save the DB:\n#   * After 3600 seconds (an hour) if at least 1 change was performed\n#   * After 300 seconds (5 minutes) if at least 100 changes were performed\n#   * After 60 seconds if at least 10000 changes were performed\n#\n# You can set these explicitly by uncommenting the following line.\n#\n# save 3600 1 300 100 60 10000\n</code></pre> <p>\u53ef\u4ee5\u7528<code>save</code>\u547d\u4ee4\u624b\u52a8\u4fdd\u5b58</p> <p>\u5feb\u7167\u6587\u4ef6\u4e3a<code>dump.rdb</code>\uff0c\u7528<code>xxd</code>\u67e5\u770b\u8be5\u4e8c\u8fdb\u5236\u6587\u4ef6</p> <p><code>bgsave</code> \u4f1a\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u6765\u8fdb\u884c\u4fdd\u5b58\uff0c\u9002\u5408\u6587\u4ef6\u8f83\u5927\u7684\u60c5\u51b5</p> <p>AOF\u4f1a\u4f7fredis\u81ea\u52a8\u4fdd\u5b58\u6307\u4ee4\uff0c\u9700\u8981\u914d\u7f6e</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#_8","title":"\u4e3b\u4ece\u590d\u5236","text":"<p>Redis\u7684\u4e3b\u4ece\u590d\u5236\u662f\u4e00\u79cd\u6570\u636e\u590d\u5236\u673a\u5236\uff0c\u7528\u4e8e\u5c06\u4e00\u4e2aRedis\u670d\u52a1\u5668\u7684\u6570\u636e\u590d\u5236\u5230\u5176\u4ed6\u591a\u4e2aRedis\u670d\u52a1\u5668\uff0c\u4ee5\u5b9e\u73b0\u6570\u636e\u7684\u5197\u4f59\u5907\u4efd\u548c\u8bfb\u5199\u5206\u79bb\u3002</p> <p>\u4e00\u822c\u5199\u4e3b\u8282\u70b9\uff0c\u8bfb\u4ece\u8282\u70b9</p> <p><code>role</code> \u67e5\u770b\u5f53\u524d\u8282\u70b9\u89d2\u8272</p> <p><code>replicaof host port</code> \u914d\u7f6e\u6240\u5c5e\u4e3b\u8282\u70b9</p> <p>\u4ece\u8282\u70b9\u9700\u8981\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u7aef\u53e3\u53f7\u3001pidfile\u3001dbfilename \u9632\u6b62\u51b2\u7a81</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Redis/#_9","title":"\u54e8\u5175\u6a21\u5f0f","text":"<p><code>redis -sentinel</code> \u542f\u52a8\u54e8\u5175\u8282\u70b9\uff08\u9700\u8981\u4f7f\u7528\u914d\u7f6esentinel.conf\uff09</p> <pre><code>sentinel monitor \u4e3b\u8282\u70b9\u540d\u79f0 ip\u5730\u5740 \u7aef\u53e3\u53f7 1\n# 1\u8868\u793a\u53ea\u9700\u8981\u4e00\u4e2a\u54e8\u5175\u8282\u70b9\u540c\u610f\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884c\u6545\u969c\u8f6c\u79fb\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/","title":"Vim","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#normal-mode","title":"normal mode","text":"<pre><code>// I\n\u8df3\u8f6c\u5230\u884c\u9996\uff0c\u5e76\u8fdb\u5165 insert_mode\n\n// a\n\u8df3\u8f6c\u5230\u5f53\u524d\u5b57\u7b26\u540e\uff0c\u5e76\u8fdb\u5165 insert_mode\n\n// A\n\u8df3\u8f6c\u5230\u884c\u5c3e\uff0c\u5e76\u8fdb\u5165 insert_mode\n\n// o\n\u521b\u5efa\u5e76\u8df3\u8f6c\u5230\u4e0b\u4e00\u65b0\u884c\uff0c\u8fdb\u5165 insert_mode\n\n// O\n\u521b\u5efa\u5e76\u8df3\u8f6c\u5230\u4e0a\u4e00\u65b0\u884c\uff0c\u8fdb\u5165 insert_mode\n\n// s\n\u5220\u9664\u5f53\u524d\u5b57\u7b26\uff0c\u5e76\u8fdb\u5165 insert_mode\n\n// S\n\u5220\u9664\u5f53\u524d\u884c\u7684\u5b57\u7b26(\u4e0d\u5305\u62ec\u7a7a\u683c)\uff0c\u5e76\u8fdb\u5165 insert_mode\n\n// h \u5149\u6807\u5411\u5de6     k\n// j \u5149\u6807\u5411\u4e0b   h   l\n// k \u5149\u6807\u5411\u4e0a     j\n// l \u5149\u6807\u5411\u4e0b\n\n// w\n\u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u5b57\u6bcd\n\n// W\n\u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u5b57\u6bcd(\u4ee5\u7a7a\u683c\u4e3a\u533a\u5206)\n\n// e\n\u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u5b57\u6bcd\u7ed3\u5c3e\n\n// E\n\u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u5b57\u6bcd\u7ed3\u5c3e(\u4ee5\u7a7a\u683c\u4e3a\u533a\u5206)\n\n// b\n\u8df3\u8f6c\u5230\u4e0a\u4e00\u4e2a\u5b57\u6bcd\n\n// B\n\u8df3\u8f6c\u5230\u4e0a\u4e00\u4e2a\u5b57\u6bcd(\u4ee5\u7a7a\u683c\u4e3a\u533a\u5206)\n\n// 0\n\u5230\u8fd9\u4e00\u884c\u7684\u5f00\u5934\n\n// u\n\u64a4\u9500\u64cd\u4f5c\n\n// U\n\u56de\u5230\u4e0a\u6b21\u64cd\u4f5c\u7684\u4f4d\u7f6e\n\n// r + ?\n\u5c06\u5f53\u524d\u5b57\u7b26\u66ff\u6362\u4e3a?\n\n// R\n\u8fdb\u5165replace_mode\n\n// x\n\u5220\u9664\u5f53\u524d\u5b57\u7b26\n\n\n&gt; ----- \u64cd\u4f5c + \u52a8\u4f5c -----\n\n// d + \u7a7a\u683c\n\u5220\u9664\u5f53\u524d\u5b57\u7b26\n\n// dd\n\u5220\u9664\u6574\u884c\n\n// dw\n\u5220\u9664\u4ece\u5149\u6807\u4f4d\u7f6e\u5230\u5f53\u524d\u5355\u8bcd\u7684\u672b\u5c3e\u7684\u6240\u6709\u5b57\u7b26\u3002\n\n// d + number + \u65b9\u5411\n\u4e0a\u4e0b\u5220\u9664\u884c\uff0c\u5de6\u53f3\u5220\u9664number\u4e2a\u5b57\u7b26\n\n// p\n\u7c98\u8d34\n\n// number + \u64cd\u4f5c\n\u6267\u884c\u67d0\u64cd\u4f5cn\u6b21\n\n// y\n\u590d\u5236\n\n// c\n\u66f4\u6539\n\n// cw\n\u66f4\u6539\u5149\u6807\u5230\u5355\u8bcd\u7ed3\u5c3e\u7684\u90e8\u5206\n\n// ciw\n\u66f4\u6539\u6574\u4e2a\u5355\u8bcd\n\n// ci\"\n\u66f4\u6539\" \"\u4e2d\u7684\u5185\u5bb9\n\n// yi\"\n\u590d\u5236\" \"\u4e2d\u7684\u5185\u5bb9\n\n// di\"\n\u5220\u9664\" \"\u4e2d\u7684\u5185\u5bb9\n\n// fv\n\u627e\u5230\u540e\u9762\u7684\u7b2c\u4e00\u4e2a'v'\uff08\u540c\u4e00\u884c\uff09\n\n// Fv\n\u627e\u5230\u524d\u9762\u7684\u7b2c\u4e00\u4e2a'v'\uff08\u540c\u4e00\u884c\uff09\n\n// df:\n\u627e\u5230\u7b2c\u4e00\u4e2a':',\u5e76\u5220\u9664\u5149\u6807\u5230':'\u7684\u5185\u5bb9(\u5305\u62ec':')\n\n// df:\n\u627e\u5230\u7b2c\u4e00\u4e2a':',\u5e76\u590d\u5236\u5149\u6807\u5230':'\u524d\u7684\u5185\u5bb9(\u5305\u62ec':')\n\n// gg\n\u79fb\u52a8\u6587\u4ef6\u5f00\u5934\n\n// G\n\u79fb\u52a8\u6587\u4ef6\u6700\u540e\u4e00\u884c\n\n// gU\n\u5728 Visual \u6a21\u5f0f\u4e0b\u9009\u62e9\u6587\u672c\u540e\uff0c\u6309\u4e0b `gU` \u952e\uff0c\u5c06\u9009\u4e2d\u7684\u6587\u672c\u8f6c\u6362\u4e3a\u5927\u5199\u3002\n\n// gu\n\u5728 Visual \u6a21\u5f0f\u4e0b\u9009\u62e9\u6587\u672c\u540e\uff0c\u6309\u4e0b `gu` \u952e\uff0c\u5c06\u9009\u4e2d\u7684\u6587\u672c\u8f6c\u6362\u4e3a\u5c0f\u5199\u3002\n\n// g~\n\u53cd\u8f6c\u5927\u5c0f\u5199\n\n\n// :split or ctrl+w +s\n\u4e0a\u4e0b\u5206\u5c4f\n\n// :vsplit or ctrl+w +v\n\u5de6\u53f3\u5206\u5c4f\n\n// ^/$\uff1a\u8df3\u5230\u884c\u9996/\u884c\u5c3e\n</code></pre> <p>ctrl + O \u5207\u6362\u6a21\u5f0f ctrl + [ \u5207\u6362\u4e3anormal\u6a21\u5f0f</p> <p>a - \u5728\u5149\u6807\u540e\u63d2\u5165\u6587\u672c b - \u5149\u6807\u5411\u540e\u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd c - \u5220\u9664\u6587\u672c\u5e76\u8fdb\u5165\u63d2\u5165\u6a21\u5f0f d - \u5220\u9664\u6587\u672c e - \u5149\u6807\u5411\u540e\u79fb\u52a8\u5230\u5355\u8bcd\u7684\u672b\u5c3e f - \u5728\u5f53\u524d\u884c\u67e5\u627e\u6307\u5b9a\u5b57\u7b26 g - \u6267\u884c\u4e00\u4e9b\u7279\u6b8a\u64cd\u4f5c h - \u5149\u6807\u5411\u5de6\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26 i - \u5728\u5149\u6807\u524d\u63d2\u5165\u6587\u672c j - \u5149\u6807\u5411\u4e0b\u79fb\u52a8\u4e00\u884c k - \u5149\u6807\u5411\u4e0a\u79fb\u52a8\u4e00\u884c l - \u5149\u6807\u5411\u53f3\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26 m - \u5728\u6307\u5b9a\u4f4d\u7f6e\u6807\u8bb0 n - \u67e5\u627e\u4e0b\u4e00\u4e2a\u5339\u914d\u9879 o - \u5728\u5f53\u524d\u884c\u4e0b\u65b9\u63d2\u5165\u65b0\u884c p - \u7c98\u8d34\u526a\u8d34\u677f\u5185\u5bb9 q - \u5f00\u59cb\u8bb0\u5f55\u5b8f r - \u66ff\u6362\u5f53\u524d\u5b57\u7b26 s - \u5220\u9664\u5b57\u7b26\u5e76\u8fdb\u5165\u63d2\u5165\u6a21\u5f0f t - \u5728\u5f53\u524d\u884c\u67e5\u627e\u6307\u5b9a\u5b57\u7b26\u5e76\u79fb\u52a8\u5230\u524d\u4e00\u4e2a\u5b57\u7b26 u - \u64a4\u9500\u4e0a\u4e00\u6b21\u64cd\u4f5c v - \u542f\u52a8\u53ef\u89c6\u6a21\u5f0f w - \u5149\u6807\u5411\u540e\u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd x - \u5220\u9664\u5f53\u524d\u5b57\u7b26 y - \u590d\u5236\u6587\u672c z - \u6267\u884c\u4e00\u4e9b\u7279\u6b8a\u64cd\u4f5c</p> <p>\u5176\u4ed6\u64cd\u4f5c</p> <p>\u4ee516\u8fdb\u5236\u683c\u5f0f\u67e5\u770b\u6587\u4ef6 <pre><code>:%xxd\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#vim","title":"Vim \u5e38\u7528\u5feb\u6377\u952e\u8868","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#_1","title":"\u57fa\u672c\u79fb\u52a8","text":"<ul> <li><code>h</code> - \u5411\u5de6\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26</li> <li><code>j</code> - \u5411\u4e0b\u79fb\u52a8\u4e00\u884c</li> <li><code>k</code> - \u5411\u4e0a\u79fb\u52a8\u4e00\u884c</li> <li><code>l</code> - \u5411\u53f3\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26</li> <li><code>0</code> - \u79fb\u52a8\u5230\u884c\u9996</li> <li><code>^</code> - \u79fb\u52a8\u5230\u884c\u9996\u7b2c\u4e00\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26</li> <li><code>$</code> - \u79fb\u52a8\u5230\u884c\u5c3e</li> <li><code>gg</code> - \u79fb\u52a8\u5230\u6587\u4ef6\u5f00\u5934</li> <li><code>G</code> - \u79fb\u52a8\u5230\u6587\u4ef6\u672b\u5c3e</li> <li><code>nG</code> - \u79fb\u52a8\u5230\u7b2c n \u884c</li> <li><code>w</code> - \u79fb\u52a8\u5230\u4e0b\u4e00\u4e2a\u5355\u8bcd\u7684\u5f00\u5934</li> <li><code>b</code> - \u79fb\u52a8\u5230\u4e0a\u4e00\u4e2a\u5355\u8bcd\u7684\u5f00\u5934</li> <li><code>e</code> - \u79fb\u52a8\u5230\u4e0b\u4e00\u4e2a\u5355\u8bcd\u7684\u672b\u5c3e</li> </ul>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#_2","title":"\u63d2\u5165\u6a21\u5f0f","text":"<ul> <li><code>i</code> - \u5728\u5149\u6807\u524d\u63d2\u5165</li> <li><code>I</code> - \u5728\u884c\u9996\u63d2\u5165</li> <li><code>a</code> - \u5728\u5149\u6807\u540e\u63d2\u5165</li> <li><code>A</code> - \u5728\u884c\u5c3e\u63d2\u5165</li> <li><code>o</code> - \u5728\u5f53\u524d\u884c\u4e0b\u65b9\u63d2\u5165\u65b0\u884c</li> <li><code>O</code> - \u5728\u5f53\u524d\u884c\u4e0a\u65b9\u63d2\u5165\u65b0\u884c</li> </ul>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#_3","title":"\u5220\u9664\u548c\u4fee\u6539","text":"<ul> <li><code>x</code> - \u5220\u9664\u5149\u6807\u4e0b\u7684\u5b57\u7b26</li> <li><code>X</code> - \u5220\u9664\u5149\u6807\u524d\u7684\u5b57\u7b26</li> <li><code>dd</code> - \u5220\u9664\u5f53\u524d\u884c</li> <li><code>dw</code> - \u5220\u9664\u5149\u6807\u540e\u7684\u5355\u8bcd</li> <li><code>db</code> - \u5220\u9664\u5149\u6807\u524d\u7684\u5355\u8bcd</li> <li><code>D</code> - \u5220\u9664\u4ece\u5149\u6807\u5230\u884c\u5c3e\u7684\u5185\u5bb9</li> <li><code>C</code> - \u5220\u9664\u4ece\u5149\u6807\u5230\u884c\u5c3e\u7684\u5185\u5bb9\u5e76\u8fdb\u5165\u63d2\u5165\u6a21\u5f0f</li> <li><code>s</code> - \u5220\u9664\u5149\u6807\u4e0b\u7684\u5b57\u7b26\u5e76\u8fdb\u5165\u63d2\u5165\u6a21\u5f0f</li> <li><code>S</code> - \u5220\u9664\u5f53\u524d\u884c\u5e76\u8fdb\u5165\u63d2\u5165\u6a21\u5f0f</li> <li><code>r</code> - \u66ff\u6362\u5149\u6807\u4e0b\u7684\u5b57\u7b26</li> <li><code>R</code> - \u8fdb\u5165\u66ff\u6362\u6a21\u5f0f</li> </ul>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#_4","title":"\u590d\u5236\u548c\u7c98\u8d34","text":"<ul> <li><code>yy</code> - \u590d\u5236\u5f53\u524d\u884c</li> <li><code>yw</code> - \u590d\u5236\u5149\u6807\u540e\u7684\u5355\u8bcd</li> <li><code>yb</code> - \u590d\u5236\u5149\u6807\u524d\u7684\u5355\u8bcd</li> <li><code>p</code> - \u5728\u5149\u6807\u540e\u7c98\u8d34</li> <li><code>P</code> - \u5728\u5149\u6807\u524d\u7c98\u8d34</li> </ul>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#_5","title":"\u64a4\u9500\u548c\u91cd\u505a","text":"<ul> <li><code>u</code> - \u64a4\u9500\u4e0a\u4e00\u6b21\u64cd\u4f5c</li> <li><code>Ctrl + r</code> - \u91cd\u505a\u4e0a\u4e00\u6b21\u64a4\u9500\u7684\u64cd\u4f5c</li> </ul>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#_6","title":"\u641c\u7d22\u548c\u66ff\u6362","text":"<ul> <li><code>/pattern</code> - \u5411\u524d\u641c\u7d22 pattern</li> <li><code>?pattern</code> - \u5411\u540e\u641c\u7d22 pattern</li> <li><code>n</code> - \u91cd\u590d\u4e0a\u4e00\u6b21\u641c\u7d22\uff08\u5411\u524d\uff09</li> <li><code>N</code> - \u91cd\u590d\u4e0a\u4e00\u6b21\u641c\u7d22\uff08\u5411\u540e\uff09</li> <li><code>:%s/old/new/g</code> - \u5168\u5c40\u66ff\u6362 old \u4e3a new</li> <li><code>:%s/old/new/gc</code> - \u5168\u5c40\u66ff\u6362 old \u4e3a new\uff0c\u6bcf\u6b21\u66ff\u6362\u524d\u786e\u8ba4</li> </ul>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#_7","title":"\u6587\u4ef6\u64cd\u4f5c","text":"<ul> <li><code>:w</code> - \u4fdd\u5b58\u6587\u4ef6</li> <li><code>:q</code> - \u9000\u51fa Vim</li> <li><code>:wq</code> \u6216 <code>ZZ</code> - \u4fdd\u5b58\u5e76\u9000\u51fa</li> <li><code>:q!</code> \u6216 <code>ZQ</code> - \u4e0d\u4fdd\u5b58\u5e76\u9000\u51fa</li> <li><code>:e filename</code> - \u6253\u5f00\u6216\u521b\u5efa\u6587\u4ef6</li> <li><code>:split filename</code> - \u6c34\u5e73\u5206\u5272\u7a97\u53e3\u5e76\u6253\u5f00\u6587\u4ef6</li> <li><code>:vsplit filename</code> - \u5782\u76f4\u5206\u5272\u7a97\u53e3\u5e76\u6253\u5f00\u6587\u4ef6</li> </ul>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/Vim/#_8","title":"\u5176\u4ed6","text":"<ul> <li><code>Ctrl + g</code> - \u663e\u793a\u5f53\u524d\u6587\u4ef6\u4fe1\u606f</li> <li><code>Ctrl + f</code> - \u5411\u524d\u7ffb\u9875</li> <li><code>Ctrl + b</code> - \u5411\u540e\u7ffb\u9875</li> <li><code>Ctrl + d</code> - \u5411\u4e0b\u6eda\u52a8\u534a\u9875</li> <li><code>Ctrl + u</code> - \u5411\u4e0a\u6eda\u52a8\u534a\u9875</li> <li><code>Ctrl + e</code> - \u5411\u4e0b\u6eda\u52a8\u4e00\u884c</li> <li><code>Ctrl + y</code> - \u5411\u4e0a\u6eda\u52a8\u4e00\u884c</li> </ul>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/docker/","title":"docker \u4f7f\u7528","text":""},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/docker/#_1","title":"\u57fa\u672c\u4f7f\u7528","text":"<p>\u5c06docker\u6dfb\u52a0\u5230\u7528\u6237\u7ec4 <pre><code># sudo\nsudo groupadd docker\nsudo usermod -aG docker $USER\nnewgrp - docker\n</code></pre></p> <p>\u641c\u7d22\u955c\u50cf <pre><code>docker search [keyword]\n</code></pre></p> <p>\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\uff0c\u5e76\u53ef\u4ee5\u4f7f\u7528bash\u4ea4\u4e92 <pre><code>docker run -it &lt;image&gt; bash\n</code></pre></p> <p>\u5217\u51fa\u5bb9\u5668 <pre><code># \u5217\u51fa\u76ee\u524d\u6b63\u5728\u8fd0\u884c\u7684docker\u5bb9\u5668\ndocker ps\n\n# \u5217\u51fa\u6240\u6709 docker \u5bb9\u5668\uff08\u5305\u62ec\u505c\u6b62\u7684\u5bb9\u5668\uff09\ndocker ps -a\n</code></pre></p> <p>\u5217\u51fa\u6240\u6709\u7684\u955c\u50cf <pre><code>docker image ls \n</code></pre></p> <p>\u8fd0\u884c\u955c\u50cf, \u521b\u5efa\u5bb9\u5668\uff0c\u7aef\u53e3\u6620\u5c04\u523080 <pre><code>docker run -p 80:8080 &lt;image&gt;\n</code></pre></p> <p>\u521b\u5efa\u4e00\u4e2a\u5bb9\u5668\u5e76\u540e\u53f0\u8fd0\u884c <pre><code>docker run -d [image]\n</code></pre></p> <p>\u83b7\u53d6\u5e76\u67e5\u770b\u5bb9\u5668\u7684\u65e5\u5fd7 <pre><code>docker logs -f &lt;container&gt;\n</code></pre></p> <p>\u672c\u5730\u76ee\u5f55\u6302\u8f7d\u5230docker\u5bb9\u5668\u76ee\u5f55 <pre><code>docker run -v /\u672c\u5730\u6587\u4ef6\u5939\u8def\u5f84:/\u5bb9\u5668\u5185\u76ee\u6807\u8def\u5f84 &lt;image&gt;\n</code></pre></p> <p>\u6307\u5b9a\u5bb9\u5668\u5185\u547d\u4ee4\u7684\u5de5\u4f5c\u76ee\u5f55 <pre><code>docker run -w /app myimage \u547d\u4ee4\n</code></pre></p> <p><code>-w</code>\u9009\u9879\u4ec5\u5f71\u54cd\u5bb9\u5668\u5185\u90e8\u7684\u547d\u4ee4\u3002\u5b83\u4e0d\u4f1a\u6539\u53d8\u5bb9\u5668\u672c\u8eab\u7684\u5de5\u4f5c\u76ee\u5f55\u3002</p> <p>docker run</p> <p>-i \u83b7\u53d6STDIN -t \u7ed9\u4e88\u5bb9\u5668\u4e00\u4e2atty</p> <p>\u91cd\u542f\u5bb9\u5668 <pre><code>docker restart &lt;container&gt; \n</code></pre></p> <p>\u4fee\u6539docker\u9ed8\u8ba4\u4f7f\u7528\u7684shell(\u9700\u8981\u5bb9\u5668\u6b63\u5728\u8fd0\u884c)\uff0c\u9000\u51fa\u540e\u5bb9\u5668\u4e0d\u4f1a\u505c\u6b62\u8fd0\u884c <pre><code>docker exec -it &lt;container&gt; /bin/bash\n</code></pre></p> <pre><code>docker exec -it &lt;container&gt; /bin/bash -c \"apt update\" # \u6253\u5f00\u5bb9\u5668\uff0c\u5e76\u6267\u884c'apt update',\u968f\u540e\u9000\u51fa\ndocker exec -it &lt;container&gt; /bin/bash -c \"apt update; bash\" # \u6253\u5f00\u5bb9\u5668\uff0c\u5e76\u6267\u884c'apt update',\u968f\u540e\u4e0d\u4f1a\u9000\u51fa\n</code></pre> <p>\u8fde\u63a5\u5bb9\u5668\uff08\u9000\u51fa\u540e\uff0c\u5bb9\u5668\u4fbf\u4f1a\u505c\u6b62\u8fd0\u884c\uff09 <pre><code>docker attach &lt;container&gt;\n</code></pre></p> <p>Ubuntu docker\u5f00\u53d1\u73af\u5883\u5feb\u901f\u914d\u7f6e</p> <pre><code>sed -i 's@//.*archive.ubuntu.com@//mirrors.ustc.edu.cn@g' /etc/apt/sources.list ; #\u914d\u7f6eustc\u955c\u50cf\u6e90 \\\napt update;\\\napt upgrade -y;\\\napt install -y curl sudo ssh vim fish neofetch tree make git gcc gdb build-essential htop wget python3 tmux;\n</code></pre> <p>Dockerfile <pre><code># Set the base image \nFROM ubuntu:latest\n\nRUN sed -i 's@//.*archive.ubuntu.com@//mirrors.ustc.edu.cn@g' /etc/apt/sources.list\n\n# Update the repository sources list\nRUN apt update\n\n# Upgrade any pre-installed packages\nRUN apt upgrade -y\n\n# Install necessary packages\nRUN apt install -y curl sudo ssh vim fish neofetch tree make git gcc gdb build-essential htop wget python3 tmux\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/docker/#dockerfile","title":"Dockerfile","text":"<pre><code>docker build --tag &lt;image-name&gt;:&lt;image-version&gt; -f /path/to/Dockefile .\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/gdb%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","title":"gdb\u5e38\u7528\u547d\u4ee4","text":"<ol> <li>\u8fd0\u884c\u7a0b\u5e8f\uff1a</li> <li><code>run</code>: \u542f\u52a8\u7a0b\u5e8f\u6267\u884c\uff0c\u53ef\u4ee5\u5e26\u53c2\u6570\uff0c\u5982<code>run arg1 arg2</code>\u3002</li> <li> <p><code>start</code>: \u542f\u52a8\u7a0b\u5e8f\u5e76\u5728main\u51fd\u6570\u5904\u505c\u4e0b\u6765\u3002</p> </li> <li> <p>\u65ad\u70b9\uff1a</p> </li> <li><code>break</code> (<code>b</code>): \u8bbe\u7f6e\u65ad\u70b9\uff0c\u53ef\u4ee5\u5728\u67d0\u884c\u53f7\u4e0a\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5982<code>b 10</code>\uff0c\u4e5f\u53ef\u4ee5\u5728\u51fd\u6570\u540d\u4e0a\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5982<code>b main</code>\u3002</li> <li><code>delete</code>: \u5220\u9664\u6307\u5b9a\u65ad\u70b9\uff0c\u5982<code>delete 1</code>\u3002</li> <li><code>disable</code>: \u7981\u7528\u6307\u5b9a\u65ad\u70b9\uff0c\u5982<code>disable 1</code>\u3002</li> <li><code>enable</code>: \u542f\u7528\u6307\u5b9a\u65ad\u70b9\uff0c\u5982<code>enable 1</code>\u3002</li> <li> <p><code>clear</code>: \u6e05\u9664\u6307\u5b9a\u884c\u53f7\u4e0a\u7684\u65ad\u70b9\uff0c\u5982<code>clear 10</code>\u3002</p> </li> <li> <p>\u67e5\u770b\u548c\u64cd\u4f5c\u4ee3\u7801\u6267\u884c\uff1a</p> </li> <li><code>list</code> (<code>l</code>): \u663e\u793a\u5f53\u524d\u6267\u884c\u70b9\u9644\u8fd1\u7684\u4ee3\u7801\uff0c\u5982<code>list</code>\u6216<code>list 1,10</code>\u3002</li> <li><code>step</code> (<code>s</code>): \u9010\u8fc7\u7a0b\u5355\u6b65\u6267\u884c\uff0c\u8fdb\u5165\u51fd\u6570\u3002</li> <li><code>next</code> (<code>n</code>): \u5355\u6b65\u6267\u884c\uff0c\u8df3\u8fc7\u51fd\u6570\u3002</li> <li><code>continue</code> (<code>c</code>): \u7ee7\u7eed\u6267\u884c\u76f4\u5230\u9047\u5230\u4e0b\u4e00\u4e2a\u65ad\u70b9\u6216\u7a0b\u5e8f\u7ed3\u675f\u3002</li> <li> <p><code>finish</code>: \u8fd0\u884c\u76f4\u5230\u5f53\u524d\u51fd\u6570\u8fd4\u56de\u3002</p> </li> <li> <p>\u67e5\u770b\u548c\u4fee\u6539\u53d8\u91cf\uff1a</p> </li> <li><code>print</code> (<code>p</code>): \u6253\u5370\u53d8\u91cf\u7684\u503c\uff0c\u5982<code>print x</code>\u3002</li> <li><code>display</code>: \u6301\u7eed\u6253\u5370\u67d0\u4e2a\u53d8\u91cf\u7684\u503c\u3002</li> <li> <p><code>set</code>: \u4fee\u6539\u53d8\u91cf\u7684\u503c\uff0c\u5982<code>set x = 10</code>\u3002</p> </li> <li> <p>\u67e5\u770b\u6808\u4fe1\u606f\uff1a</p> </li> <li><code>backtrace</code> (<code>bt</code>): \u663e\u793a\u5f53\u524d\u7684\u8c03\u7528\u6808\u3002</li> <li> <p><code>frame</code> (<code>f</code>): \u5207\u6362\u5f53\u524d\u5e27\uff0c\u5982<code>frame 2</code>\u3002</p> </li> <li> <p>\u67e5\u770b\u5185\u5b58\uff1a</p> </li> <li> <p><code>x</code>: \u67e5\u770b\u5185\u5b58\u4e2d\u7684\u5185\u5bb9\uff0c\u5982<code>x/nfu address</code>\uff0c\u5176\u4e2dn\u662f\u663e\u793a\u6570\u91cf\uff0cf\u662f\u663e\u793a\u683c\u5f0f\uff08\u5982x\u8868\u793a\u5341\u516d\u8fdb\u5236\uff09\uff0cu\u662f\u5355\u4f4d\u5927\u5c0f\uff08\u5982b\u8868\u793a\u5b57\u8282\uff09\u3002</p> </li> <li> <p>\u67e5\u770b\u5bc4\u5b58\u5668\uff1a</p> </li> <li> <p><code>info registers</code> (<code>i r</code>): \u663e\u793a\u5f53\u524d\u7684\u5bc4\u5b58\u5668\u503c\u3002</p> </li> <li> <p>\u8bbe\u7f6e\u65ad\u70b9\u6761\u4ef6\uff1a</p> </li> <li> <p><code>break if</code>: \u5728\u8bbe\u7f6e\u65ad\u70b9\u65f6\u6307\u5b9a\u6761\u4ef6\uff0c\u5982<code>break 10 if x &gt; 5</code>\u3002</p> </li> <li> <p>\u8bbe\u7f6e\u89c2\u5bdf\u70b9\uff1a</p> </li> <li> <p><code>watch</code>: \u76d1\u89c6\u67d0\u4e2a\u53d8\u91cf\uff0c\u5f53\u5b83\u7684\u503c\u53d1\u751f\u6539\u53d8\u65f6\u4e2d\u65ad\u7a0b\u5e8f\u7684\u6267\u884c\u3002</p> </li> <li> <p>\u9644\u52a0\u8c03\u8bd5\u5230\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\uff1a</p> <ul> <li><code>attach</code>: \u9644\u52a0\u5230\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u8fdb\u884c\u8c03\u8bd5\uff0c\u5982<code>attach PID</code>\u3002</li> </ul> </li> <li> <p>\u5206\u6790\u5d29\u6e83\u4fe1\u606f\uff1a</p> <ul> <li><code>core</code>: \u5206\u6790core dump\u6587\u4ef6\uff0c\u5982<code>gdb executable core</code>\u3002</li> </ul> </li> <li> <p>\u9000\u51faGDB\uff1a</p> <ul> <li><code>quit</code> (<code>q</code>): \u9000\u51faGDB\u3002</li> </ul> </li> <li> <p><code>disas</code>\uff1a\u7b80\u5199\u4e3a<code>d</code>\uff0c\u7528\u4e8e\u663e\u793a\u5f53\u524d\u6267\u884c\u4f4d\u7f6e\u9644\u8fd1\u7684\u6c47\u7f16\u4ee3\u7801\u3002</p> </li> <li><code>stepi</code>\uff1a\u7b80\u5199\u4e3a<code>s</code>\uff0c\u7528\u4e8e\u5355\u6b65\u6267\u884c\u4e00\u6761\u6c47\u7f16\u6307\u4ee4\u3002</li> <li><code>nexti</code>\uff1a\u7b80\u5199\u4e3a<code>n</code>\uff0c\u7528\u4e8e\u6267\u884c\u4e0b\u4e00\u6761\u6c47\u7f16\u6307\u4ee4\uff0c\u4f46\u662f\u4f1a\u8df3\u8fc7\u51fd\u6570\u8c03\u7528\u3002</li> <li><code>finish</code>\uff1a\u7b80\u5199\u4e3a<code>f</code>\uff0c\u7528\u4e8e\u6267\u884c\u5b8c\u5f53\u524d\u51fd\u6570\u5e76\u505c\u6b62\u5728\u8c03\u7528\u5b83\u7684\u5730\u65b9\u3002</li> <li><code>break *address</code>\uff1a\u7b80\u5199\u4e3a<code>b *address</code>\uff0c\u7528\u4e8e\u5728\u6307\u5b9a\u5730\u5740\u8bbe\u7f6e\u65ad\u70b9\u3002</li> <li><code>info registers</code>\uff1a\u7b80\u5199\u4e3a<code>i r</code>\uff0c\u7528\u4e8e\u663e\u793a\u5f53\u524d\u6240\u6709\u5bc4\u5b58\u5668\u7684\u503c\u3002</li> <li><code>x/nfu address</code>\uff1a\u7b80\u5199\u4e3a<code>x/nfu addr</code>\uff0c\u7528\u4e8e\u663e\u793a\u5185\u5b58\u4e2d\u4ece\u6307\u5b9a\u5730\u5740\u5f00\u59cb\u7684n\u4e2a\u5355\u4f4d\u7684\u5185\u5bb9\u3002</li> <li><code>set $register=value</code>\uff1a\u7b80\u5199\u4e3a<code>set $reg=val</code>\uff0c\u7528\u4e8e\u8bbe\u7f6e\u67d0\u4e2a\u5bc4\u5b58\u5668\u7684\u503c\u3002</li> <li><code>display $register</code>\uff1a\u7b80\u5199\u4e3a<code>disp $reg</code>\uff0c\u7528\u4e8e\u5728\u6bcf\u6b21\u505c\u4e0b\u6765\u65f6\u663e\u793a\u67d0\u4e2a\u5bc4\u5b58\u5668\u7684\u503c\u3002</li> <li><code>layout asm</code>\uff1a\u7b80\u5199\u4e3a<code>layout a</code>\uff0c\u7528\u4e8e\u663e\u793a\u6c47\u7f16\u4ee3\u7801\u548c\u5bc4\u5b58\u5668\u7a97\u53e3\u3002</li> </ol> <p>x/10i\u8868\u793a\u4ee5\u6c47\u7f16\u6307\u4ee4\u7684\u683c\u5f0f\u6253\u5370\u5185\u5b58\u4e2d\u7684\u5185\u5bb9\u3002\u5176\u4e2d\uff0cx\u8868\u793a\u4ee5\u5341\u516d\u8fdb\u5236\u7684\u683c\u5f0f\u663e\u793a\uff0c10\u8868\u793a\u6253\u537010\u6761\u6307\u4ee4\uff0ci\u8868\u793a\u4ee5\u6c47\u7f16\u6307\u4ee4\u7684\u683c\u5f0f\u663e\u793a\u3002</p> <p>\u4f8b\u5982\uff0c\u5f53\u4f60\u4f7f\u7528\u547d\u4ee4x/10i $pc\u65f6\uff0c\u5b83\u4f1a\u6253\u5370\u51fa\u5f53\u524d\u6307\u4ee4\u6307\u9488\u6240\u6307\u5411\u7684\u4f4d\u7f6e\u7684\u5341\u516d\u8fdb\u5236\u5185\u5bb9\uff0c\u5e76\u5c06\u5176\u89e3\u6790\u4e3a\u5bf9\u5e94\u7684\u6c47\u7f16\u6307\u4ee4\u3002</p> <p>gdb\u5e38\u7528\u6307\u4ee4</p> <pre><code>b # \u6253\u65ad\u70b9 (e.g.     b main | b *0x30)\nc # continue\n\nlayout split # view src-code &amp; asm-code\n\nni # \u5355\u6b65\u6267\u884c\u6c47\u7f16(\u4e0d\u8fdb\u51fd\u6570)\nsi # \u5355\u6b65\u6267\u884c\u6c47\u7f16(\u6709\u51fd\u6570\u5219\u8fdb\u5165\u51fd\u6570)\nn # \u5355\u6b65\u6267\u884c\u6e90\u7801\ns # \u5355\u6b65\u6267\u884c\u6e90\u7801\n\np # print\np $a0 # \u6253\u5370a0\u5bc4\u5b58\u5668\u7684\u503c\np/x 1536 # \u4ee516\u8fdb\u5236\u7684\u683c\u5f0f\u6253\u53701536\ni r a0 # info registers a0\nx/i 0x630 # \u67e5\u770b0x630\u5730\u5740\u5904\u7684\u6307\u4ee4\nx/g 0x80000000 # \u67e5\u770b0x80000000\u5730\u5740\u5904\u7684\u503c\uff08g\u8868\u793a\u503c\u7684\u957f\u5ea6\u670964\u4f4d\uff09\n</code></pre> <p>\u63a8\u8350\u5b89\u88c5<code>gdb-dashboard</code></p> <p>GitHub - cyrus-and/gdb-dashboard: Modular visual interface for GDB in Python</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/tmux/","title":"Tmux","text":"<p>\u65b0\u5efa\u4f1a\u8bdd <pre><code>tmux new -s &lt;name&gt;\n</code></pre></p> <p>\u9000\u51fa\u4f1a\u8bdd <pre><code>tmux detach\nctrl + b -&gt; d\n</code></pre></p> <p>\u5217\u51fa\u6240\u6709\u4f1a\u8bdd  <code>shell  tmux ls</code></p> <p>\u5de6\u53f3\u5206\u5c4f <pre><code>ctrl + b -&gt; %\n</code></pre></p> <p>\u4e0a\u4e0b\u5206\u5c4f <pre><code>ctrl + b -&gt; \"\n</code></pre></p> <p>\u5173\u95ed\u5f53\u524d\u5206\u5c4f <pre><code>ctrl + b -&gt; x\n</code></pre></p> <p>\u8bbe\u5b9a\u9f20\u6807\u6eda\u52a8\u652f\u6301\uff1a <pre><code>tmux set mouse on\n</code></pre></p> <p>\u5207\u6362\u4f1a\u8bdd <pre><code>ctrl + b -&gt; \u65b9\u5411\u952e\n</code></pre></p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/tmux/#_1","title":"\u914d\u7f6e\u6587\u4ef6","text":"<p><code>~/.tmux.conf</code></p> <p>\u5f00\u542f\u9f20\u6807 <pre><code>set-option -g mouse on\n</code></pre></p> <p>\u8ba9tmux\u5728\u5f53\u524d\u76ee\u5f55\u5206\u5c4f <pre><code>bind-key c new-window -c \"#{pane_current_path}\"\nbind-key % split-window -h -c \"#{pane_current_path}\"\nbind-key '\"' split-window -c \"#{pane_current_path}\"\n</code></pre></p> <p>https://zhuanlan.zhihu.com/p/345577995</p> <pre><code>echo \"set-option -g mouse on\nbind-key c new-window -c \\\"#{pane_current_path}\\\"\nbind-key % split-window -h -c \\\"#{pane_current_path}\\\"\nbind-key '\\\"' split-window -c \\\"#{pane_current_path}\\\"\n\" &gt; .tmux.conf\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B8%B8%E7%94%A8Latex%E7%AC%A6%E5%8F%B7%E5%85%AC%E5%BC%8F/","title":"\u5e38\u7528Latex\u7b26\u53f7\u516c\u5f0f","text":"\\[ \\LaTeX \\] <p>LaTeX \u5165\u95e8 - OI Wiki (oi-wiki.org)</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B8%B8%E7%94%A8Latex%E7%AC%A6%E5%8F%B7%E5%85%AC%E5%BC%8F/#_1","title":"\u57fa\u672c\u7b26\u53f7","text":"<p>\u7a7a\u683c</p> <pre><code>a \\space b\n</code></pre> <p>$$ a \\space b $$ \u4e0a\u6807</p> <pre><code>a^b\n</code></pre> <p>$$ a^b $$ \u4e0b\u6807</p> <pre><code>a_b\n</code></pre> <p>$$ a_b $$ \u53c9\u4e58</p> <pre><code>a \\times b\n</code></pre> <p>$$ a \\times b $$ \u70b9\u4e58</p> <pre><code>a \\cdot b\n</code></pre> \\[ a \\cdot b $$ \u7701\u7565\u53f7 \\\\dots \\\\cdots $$ \\dots \\space \\cdots \\]"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B8%B8%E7%94%A8Latex%E7%AC%A6%E5%8F%B7%E5%85%AC%E5%BC%8F/#_2","title":"\u5e0c\u814a\u5b57\u6bcd","text":"Code \u5c0f\u5199 \u5927\u5199 \\alpha A \\(\\alpha\\) \\(A\\) \\beta B \\(\\beta\\) \\(B\\) \\gamma \\Gamma \\(\\gamma\\) \\(\\Gamma\\)"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B8%B8%E7%94%A8Latex%E7%AC%A6%E5%8F%B7%E5%85%AC%E5%BC%8F/#_3","title":"\u5176\u4ed6\u7b26\u53f7","text":"<p>\u6a2a\u5411\u7701\u7565\u53f7 $$ 1 + 3+ \\cdots + 5 $$</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B8%B8%E7%94%A8git%E6%8C%87%E4%BB%A4/","title":"\u5e38\u7528git\u6307\u4ee4","text":"<pre><code>git init                        # \u521d\u59cb\u5316\u4ed3\u5e93\n</code></pre> <pre><code>git add \u6587\u4ef6\u540d                   # \u5c06\u6587\u4ef6\u6dfb\u52a0\u5230\u7f13\u5b58\u533a\ngit add .\n</code></pre> <pre><code>git commit -m \"message\"         # \u5c06\u7f13\u5b58\u533a\u7684\u6587\u4ef6\u6dfb\u52a0\u5230\u672c\u5730\u4ed3\u5e93\n</code></pre> <pre><code>git status                      # \u67e5\u770b\u4ed3\u5e93\u5f53\u524d\u7684\u72b6\u6001\ngit status -vv                  # \u67e5\u770b\u4ed3\u5e93\u5f53\u524d\u7684\u8be6\u7ec6\u72b6\u6001\n</code></pre> <pre><code>git diff                        # \u7f13\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u6587\u4ef6\u7684\u5dee\u5f02\ngit diff &lt;\u6587\u4ef6...&gt;              # \u7f13\u5b58\u533a\u548c\u5de5\u4f5c\u533a&lt;\u6587\u4ef6...&gt;\u7684\u5dee\u5f02\n</code></pre> <pre><code>git rm                          # \u5220\u9664\u672c\u5730\u4ed3\u5e93\u7684\u6587\u4ef6\n</code></pre> <pre><code>git log                         # \u67e5\u770b\u5386\u53f2\u63d0\u4ea4\u8bb0\u5f55\n</code></pre> <pre><code>ssh-keygen -t rsa -C \"github\u4e0a\u6ce8\u518c\u7684\u7535\u5b50\u90ae\u7bb1\"              # \u751f\u6210SSH\u5bc6\u94a5\n</code></pre> <pre><code>git pull                          # \u4e0b\u8f7d\u8fdc\u7a0b\u4ee3\u7801\u5e76\u5408\u5e76\ngit pull [remote_name] [branch_name]\n</code></pre> <pre><code>git fetch\n</code></pre> <pre><code>git push                          # \u4e0a\u4f20\u6587\u4ef6\u81f3\u8fdc\u7a0b\u5e93\ngit push [remote_name] [branch_name]\ngit push origin master            # \u4e0a\u4f20\u6587\u4ef6\u81f3\u540d\u4e3aorigin\u7684\u8fdc\u7a0b\u5e93\u7684master\u5206\u652f\n</code></pre> <pre><code>git remote add origin [server_url]    # \u6dfb\u52a0\u8fdc\u7a0b\u670d\u52a1\u5668\u7684url\u6216\u8def\u5f84\uff0c\u5e76\u547d\u540d\u4e3a \"origin\"\n</code></pre> <pre><code>git checkout &lt;\u5206\u652f\u540d&gt;     # \u5207\u6362\u5206\u652f\ngit checkout -b &lt;\u5206\u652f\u540d&gt;  # \u5207\u6362\u5206\u652f(\u5982\u679c\u8be5\u5206\u652f\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u8be5\u5206\u652f)\n</code></pre> <pre><code>git cherry-pick [commit_hash]\n</code></pre> <p>\u6682\u5b58</p> <pre><code>git commit # \u63d0\u4ea4\ngit stash  # \u6682\u5b58\ngit pull   # \u62c9\u53d6\u5185\u5bb9\n\ngit stash pop  # \u6062\u590d\u6682\u5b58\u7684\u5185\u5bb9\ngit stash drop # \u5220\u9664\u4e00\u4e2a\u6682\u5b58\u7684\u5185\u5bb9\n</code></pre> <pre><code>git stash list # \u663e\u793a\u6682\u5b58\u5217\u8868\n</code></pre> <p>\u8bbe\u5b9a\u521d\u59cb\u5206\u652f\u540d</p> <pre><code>git config --global init.defaultBranch &lt;\u540d\u79f0&gt;\n</code></pre> <p><code>git clone</code>\u6307\u5b9a\u5206\u652f <pre><code>git clone -b [branch_name] [git_url]\n</code></pre></p> <p>submodule</p> <p>\u5411\u5f53\u524dgit\u4ed3\u5e93\u6dfb\u52a0submodule</p> <pre><code>git submodule add &lt;url&gt; &lt;path/to/directory&gt;\n</code></pre> <p>\u6dfb\u52a0\u540e\u4f1a\u751f\u6210<code>.gitmodules</code>\u6587\u4ef6</p> <p>\u4e0b\u8f7d/\u66f4\u65b0submodule</p> <pre><code>git submodule update --init [submodule names]\n\ngit submodule init\n\ngit submodule update\n\ngit submodule update --init --recursive\n\ngit submodule sync\n</code></pre> <p>clone\u65f6\u540c\u65f6clone\u5b50\u6a21\u7ec4 <pre><code>git clone --recurse-submodules [remote_url]\n</code></pre></p> <p>merge</p> <p>\u5408\u5e76\u65e0\u5173\u7684\u5206\u652f</p> <pre><code>git merge [branch_name] --allow-unrelated-histories\n</code></pre> <p>tag</p> <pre><code>git tag # \u5217\u51fa\u672c\u5730\u6240\u6709\u6807\u7b7e\ngit tag -l\n</code></pre> <pre><code>git ls-remote --tag # \u5217\u51fa\u8fdc\u7a0b\u6807\u7b7e\n</code></pre> <p>\u521b\u5efatag</p> <pre><code>git tag [\u6807\u7b7e\u540d]\ngit tag v0.1.1\n</code></pre> <p>\u5207\u6362tag\u5e76\u521b\u5efa\u5206\u652f(\u76f4\u63a5checkout\u4f1a\u51fa\u73b0\u5206\u79bb\u7684\u5934\u6307\u9488)</p> <pre><code>git checkout -b [branch_name] [tag_name]\n</code></pre> <p>.gitignore</p> <pre><code># \u5ffd\u7565\u6240\u6709\u6587\u4ef6\uff0c\u9664\u4e86.cpp\u3001.txt\u6587\u4ef6\u3001makefile\u4ee5\u53ca.gitignore\n\n*\n\n!*.cpp\n!*.txt\n!makefile\n!.gitignore\n</code></pre> <pre><code># Ignore all files\n*\n\n# But don't ignore .cpp and .hpp files\n!*.cpp\n!*.hpp\n!*.h\n!*.c\n!CMakeLists.txt\n!README.md\n\n\n*/*\n\n!.gitignore\n!*/\n\n!**/*.cpp\n!**/*.hpp\n!**/*.h\n!**/*.c\n!**/CMakeLists.txt\n!**/.clang-format\n\n*/build\n</code></pre>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B8%B8%E7%94%A8git%E6%8C%87%E4%BB%A4/#_1","title":"\u76f8\u5173\u8d44\u6599","text":"<p>\u9ad8\u8d28\u91cf\u7684 Git \u4e2d\u6587\u6559\u7a0b\uff0c\u6e90\u4e8e\u56fd\u5916\u793e\u533a\u7684\u4f18\u79c0\u6587\u7ae0\u548c\u4e2a\u4eba\u5b9e\u8df5</p> <p>\u300aPro Git\u300bGit\u5b98\u65b9\u4e66\u7c4d(\u4e2d\u6587)</p>"},{"location":"%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B8%B8%E7%94%A8git%E6%8C%87%E4%BB%A4/#_2","title":"\u9519\u8bef\u89e3\u51b3","text":"<p>OpenSSL SSL_read: Connection was aborted, errno 10054</p> <p>\u89e3\u51b3\u65b9\u6cd5\u53c2\u8003:  \u4f5c\u8005\uff1a\u4e91\u68a6&amp;&amp;\u7384\u9f99   \u6216   \u4f5c\u8005\uff1aHerio</p> <p>\u89e3\u51b3 ssh: connect to host github.com port 22: Connection timed out</p> <p>\u5982\u679c\u65e0\u6cd5\u6b63\u5e38\u9a8c\u8bc1\u8eab\u4efd, \u8bd5\u8bd5\u4f7f\u7528ssh\u94fe\u63a5\u800c\u975ehttps\u94fe\u63a5</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E4%BB%A3%E7%A0%81%E6%A0%B7%E4%BE%8B/","title":"C++-Code","text":"<p>\u81ea\u5df1\u5b9e\u73b0String\u7c7b</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;cstring&gt;\n\nusing namespace std;\n\nclass String{\npublic:\n    // \u9ed8\u8ba4\u6784\u9020\u51fd\u6570\n    String(const char *str = nullptr);\n    // \u62f7\u8d1d\u6784\u9020\u51fd\u6570\n    String(const String &amp;str);\n    // \u6790\u6784\u51fd\u6570\n    ~String();\n    // \u5b57\u7b26\u4e32\u8d4b\u503c\u51fd\u6570\n    String&amp; operator=(const String &amp;str);\n\nprivate:\n    char *m_data;\n    int m_size;\n};\n\n// \u6784\u9020\u51fd\u6570\nString::String(const char *str)\n{\n    if(str == nullptr)  // \u52a0\u5206\u70b9\uff1a\u5bf9m_data\u52a0NULL \u5224\u65ad\n    {\n        m_data = new char[1];   // \u5f97\u5206\u70b9\uff1a\u5bf9\u7a7a\u5b57\u7b26\u4e32\u81ea\u52a8\u7533\u8bf7\u5b58\u653e\u7ed3\u675f\u6807\u5fd7'\\0'\u7684\n        m_data[0] = '\\0';\n        m_size = 0;\n    }\n    else\n    {\n        m_size = strlen(str);\n        m_data = new char[m_size + 1];\n        strcpy(m_data, str);\n    }\n}\n\n// \u62f7\u8d1d\u6784\u9020\u51fd\u6570\nString::String(const String &amp;str)   // \u5f97\u5206\u70b9\uff1a\u8f93\u5165\u53c2\u6570\u4e3aconst\u578b\n{\n    m_size = str.m_size;\n    m_data = new char[m_size + 1];  //\u52a0\u5206\u70b9\uff1a\u5bf9m_data\u52a0NULL \u5224\u65ad\n    strcpy(m_data, str.m_data);\n}\n\n// \u6790\u6784\u51fd\u6570\nString::~String()\n{\n    delete[] m_data;\n}\n\n// \u5b57\u7b26\u4e32\u8d4b\u503c\u51fd\u6570\n/*\n\u6211\u4eec\u5148\u7528delete\u91ca\u653e\u4e86\u5b9e\u4f8bm_data\u7684\u5185\u5b58\uff0c\u5982\u679c\u6b64\u65f6\u5185\u5b58\u4e0d\u8db3\u5bfc\u81f4new char\u629b\u51fa\u5f02\u5e38\uff0c\u5219m_data\u5c06\u662f\u4e00\u4e2a\u7a7a\u6307\u9488\uff0c\n\u8fd9\u6837\u975e\u5e38\u5bb9\u6613\u5bfc\u81f4\u7a0b\u5e8f\u5d29\u6e83\u3002\u8fdd\u80cc\u4e86\u5f02\u5e38\u5b89\u5168\u6027\u539f\u5219\u3002\n*/\nString&amp; String::operator=(const String &amp;str)  // \u5f97\u5206\u70b9\uff1a\u8f93\u5165\u53c2\u6570\u4e3aconst\n{\n    if(this == &amp;str)    //\u5f97\u5206\u70b9\uff1a\u68c0\u67e5\u81ea\u8d4b\u503c\n        return *this;\n\n    delete[] m_data;    //\u5f97\u5206\u70b9\uff1a\u91ca\u653e\u539f\u6709\u7684\u5185\u5b58\u8d44\u6e90\n    m_size = strlen(str.m_data);\n    m_data = new char[m_size + 1];  //\u52a0\u5206\u70b9\uff1a\u5bf9m_data\u52a0NULL \u5224\u65ad\n    strcpy(m_data, str.m_data);\n    return *this;       //\u5f97\u5206\u70b9\uff1a\u8fd4\u56de\u672c\u5bf9\u8c61\u7684\u5f15\u7528\n}\n\n// \u5b57\u7b26\u4e32\u8d4b\u503c\u51fd\u6570\uff08\u63a8\u8350\u4f7f\u7528\uff09\n// \u4fdd\u8bc1\u4e86\u5f02\u5e38\u5b89\u5168\u6027\nString&amp; String::operator=(const String &amp;str)\n{\n    if(this != &amp;str)\n    {\n        String str_temp(str);\n\n        char* p_temp = str_temp.m_data;\n        str_temp.m_data = m_data;\n        m_data = p_temp;\n    }\n    return *this;\n}\n</code></pre> <p>String.cpp</p> <pre><code>#include &lt;cstdlib&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include &lt;ostream&gt;\n#include \"String.hpp\"\n\nString::String(const char *str)\n{\n    if (str == nullptr)\n    {\n        m_size = 0;\n        m_data = new char[1];\n        m_data[0] = '\\0';\n    }\n    else\n    {\n        m_size = strlen(str);\n        m_data = new char[m_size+1];\n        strcpy(m_data, str);\n    }\n}\n\nString::String(const String &amp;str) {\n    m_size = str.m_size;\n    m_data = new char[m_size];\n    strcpy(m_data, str.m_data);\n}\n\nString::~String() {\n    delete [] m_data;\n}\n\nString&amp; String::operator=(const String &amp;str) {\n    if (this != &amp;str) {\n        String strTemp(str);\n\n        char* pTemp = strTemp.m_data;\n        strTemp.m_data = m_data;\n        m_data = pTemp;\n\n    }\n    return *this;\n}\n\nstd::ostream&amp; operator&lt;&lt;(std::ostream&amp; stream, const String &amp;str) {\n    stream&lt;&lt;str.m_data;\n    return stream;\n}\n</code></pre> <p>String.hpp <pre><code>#include &lt;ostream&gt;\nclass String\n{\n  private:\n    char *m_data;\n    int m_size;\n\n  public:\n    String(const char *str = nullptr);\n    String(const String &amp;str);\n\n    String &amp;operator=(const String &amp;str);\n    friend std::ostream&amp; operator&lt;&lt;(std::ostream &amp;stream, const String &amp;str);\n\n    ~String();\n};\n</code></pre></p> <p>main.cpp <pre><code>#include &lt;cstdio&gt;\n#include &lt;cstdlib&gt;\n#include &lt;cstring&gt;\n#include &lt;iostream&gt;\n#include \"string/String.hpp\"\n\n\nint main()\n{\n    String a = \"asdfadsf\";\n    std::cout&lt;&lt;a&lt;&lt;std::endl;\n    return 0;\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E4%BB%A3%E7%A0%81%E6%A0%B7%E4%BE%8B/#_1","title":"\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9","text":"<pre><code>#include &lt;fstream&gt;\n#include &lt;string&gt;\n#include &lt;sstream&gt;\n\nstd::string readFile(const std::string&amp; filePath) {\n    std::ifstream fileStream(filePath);\n    if(!fileStream) {\n        std::cerr &lt;&lt; \"\u65e0\u6cd5\u6253\u5f00\u6587\u4ef6: \" &lt;&lt; fileName &lt;&lt; std::endl;\n        exit(1);\n    }\n\n    std::stringstream stringStream;\n    stringStream &lt;&lt; fileStream.rdbuf();\n    return stringStream.str();\n}\n</code></pre> <p>\u9012\u5f52\u641c\u7d22\u6587\u4ef6\u5939\u4e2d\u6587\u4ef6</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;filesystem&gt;\n#include &lt;chrono&gt;\n#include &lt;memory&gt;\n\nnamespace fs = std::filesystem;\n\nconst std::string PATH = \"./\";\n\nint search(const std::string&amp; path, std::shared_ptr&lt;int&gt; sum) {\n    try {\n        for (const auto&amp; entry : fs::directory_iterator(path)) {\n            std::string name = entry.path().filename().string();\n            std::cout &lt;&lt; \"file: \" &lt;&lt; name &lt;&lt; std::endl;\n\n            if (fs::is_directory(entry.status())) {\n                search(entry.path().string() + \"/\", sum);\n            } else {\n                (*sum)++;\n            }\n        }\n    } catch (const std::filesystem::filesystem_error&amp; e) {\n        std::cerr &lt;&lt; \"Error: \" &lt;&lt; e.what() &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n\nint main() {\n    auto now = std::chrono::steady_clock::now();\n    auto sum = std::make_shared&lt;int&gt;(0);\n\n    search(PATH, sum);\n\n    auto elapsed_time = std::chrono::steady_clock::now() - now;\n    std::cout &lt;&lt; \"Elapsed time: \" &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(elapsed_time).count() &lt;&lt; \" ms\" &lt;&lt; std::endl;\n    std::cout &lt;&lt; \"Count: \" &lt;&lt; *sum &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E4%BB%A3%E7%A0%81%E6%A0%B7%E4%BE%8B/#_2","title":"\u7ebf\u7a0b\u6c60","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E4%BB%A3%E7%A0%81%E6%A0%B7%E4%BE%8B/#c-11-version","title":"C++ 11 version","text":"<p>ref: GitHub - progschj/ThreadPool: A simple C++11 Thread Pool implementation</p> <pre><code>#ifndef THREAD_POOL_H\n#define THREAD_POOL_H\n\n#include &lt;vector&gt;\n#include &lt;queue&gt;\n#include &lt;memory&gt;\n#include &lt;thread&gt;\n#include &lt;mutex&gt;\n#include &lt;condition_variable&gt;\n#include &lt;future&gt;\n#include &lt;functional&gt;\n#include &lt;stdexcept&gt;\n\nclass ThreadPool {\npublic:\n    explicit ThreadPool(size_t);\n    template &lt;class F, class... Args&gt;\n    auto enqueue(F&amp;&amp; f, Args&amp;&amp;... args)\n        -&gt; std::future&lt;typename std::result_of&lt;F(Args...)&gt;::type&gt;;\n    ~ThreadPool();\n\nprivate:\n    // need to keep track of threads so we can join them\n    std::vector&lt;std::thread&gt; workers;\n    // the task queue\n    std::queue&lt;std::function&lt;void()&gt;&gt; tasks;\n\n    // synchronization\n    std::mutex              queue_mutex;\n    std::condition_variable condition;\n    bool                    stop;\n};\n\n// the constructor just launches some amount of workers\ninline ThreadPool::ThreadPool(size_t threads) : stop(false) {\n    for (size_t i = 0; i &lt; threads; ++i)\n        workers.emplace_back([this] {\n            for (;;) {\n                std::function&lt;void()&gt; task;\n\n                {\n                    std::unique_lock&lt;std::mutex&gt; lock(this-&gt;queue_mutex);\n                    this-&gt;condition.wait(lock, [this] {\n                        return this-&gt;stop || !this-&gt;tasks.empty();\n                    });\n                    if (this-&gt;stop &amp;&amp; this-&gt;tasks.empty())\n                        return;\n                    task = std::move(this-&gt;tasks.front());\n                    this-&gt;tasks.pop();\n                }\n\n                task();\n            }\n        });\n}\n\n// add new work item to the pool\ntemplate &lt;class F, class... Args&gt;\nauto ThreadPool::enqueue(F&amp;&amp; f, Args&amp;&amp;... args)\n    -&gt; std::future&lt;typename std::result_of&lt;F(Args...)&gt;::type&gt; {\n    using return_type = typename std::result_of&lt;F(Args...)&gt;::type;\n\n    auto task = std::make_shared&lt;std::packaged_task&lt;return_type()&gt;&gt;(\n        std::bind(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)...));\n\n    std::future&lt;return_type&gt; res = task-&gt;get_future();\n    {\n        std::unique_lock&lt;std::mutex&gt; lock(queue_mutex);\n\n        // don't allow enqueueing after stopping the pool\n        if (stop)\n            throw std::runtime_error(\"enqueue on stopped ThreadPool\");\n\n        tasks.emplace([task]() { (*task)(); });\n    }\n    condition.notify_one();\n    return res;\n}\n\n// the destructor joins all threads\ninline ThreadPool::~ThreadPool() {\n    {\n        std::unique_lock&lt;std::mutex&gt; lock(queue_mutex);\n        stop = true;\n    }\n    condition.notify_all();\n    for (std::thread&amp; worker : workers)\n        worker.join();\n}\n\n#endif\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E4%BB%A3%E7%A0%81%E6%A0%B7%E4%BE%8B/#c-20-version","title":"C++ 20 version","text":"<p>ref: https://github.com/progschj/ThreadPool/issues/109</p> <pre><code>#ifndef THREAD_POOL_H\n#define THREAD_POOL_H\n\n#include &lt;vector&gt;\n#include &lt;queue&gt;\n#include &lt;memory&gt;\n#include &lt;thread&gt;\n#include &lt;mutex&gt;\n#include &lt;condition_variable&gt;\n#include &lt;future&gt;\n#include &lt;functional&gt;\n#include &lt;stdexcept&gt;\n\nclass ThreadPool {\npublic:\n    ThreadPool(size_t);\n    template &lt;class F, class... Args&gt;\n    auto enqueue(F&amp;&amp; f, Args&amp;&amp;... args)\n        -&gt; std::future&lt;typename std::result_of&lt;F(Args...)&gt;::type&gt;;\n    ~ThreadPool();\n\nprivate:\n    // need to keep track of threads so we can join them\n    std::vector&lt;std::thread&gt; workers;\n    // the task queue\n    std::queue&lt;std::function&lt;void()&gt;&gt; tasks;\n\n    // synchronization\n    std::mutex              queue_mutex;\n    std::condition_variable condition;\n    bool                    stop;\n};\n\n// the constructor just launches some amount of workers\ninline ThreadPool::ThreadPool(size_t threads) : stop(false) {\n    for (size_t i = 0; i &lt; threads; ++i)\n        workers.emplace_back([this] {\n            for (;;) {\n                std::function&lt;void()&gt; task;\n\n                {\n                    std::unique_lock&lt;std::mutex&gt; lock(this-&gt;queue_mutex);\n                    this-&gt;condition.wait(lock, [this] {\n                        return this-&gt;stop || !this-&gt;tasks.empty();\n                    });\n                    if (this-&gt;stop &amp;&amp; this-&gt;tasks.empty())\n                        return;\n                    task = std::move(this-&gt;tasks.front());\n                    this-&gt;tasks.pop();\n                }\n\n                task();\n            }\n        });\n}\n\n// add new work item to the pool\ntemplate &lt;class F, class... Args&gt;\nauto ThreadPool::enqueue(F&amp;&amp; f, Args&amp;&amp;... args)\n    -&gt; std::future&lt;typename std::result_of&lt;F(Args...)&gt;::type&gt; {\n    using return_type = typename std::invoke_result&lt;F&amp;&amp;,Args&amp;&amp;...&gt;::type; // ------ \u6539\u52a8------\n\n    auto task = std::make_shared&lt;std::packaged_task&lt;return_type()&gt;&gt;(\n        std::bind(std::forward&lt;F&gt;(f), std::forward&lt;Args&gt;(args)...));\n\n    std::future&lt;return_type&gt; res = task-&gt;get_future();\n    {\n        std::unique_lock&lt;std::mutex&gt; lock(queue_mutex);\n\n        // don't allow enqueueing after stopping the pool\n        if (stop)\n            throw std::runtime_error(\"enqueue on stopped ThreadPool\");\n\n        tasks.emplace([task]() { (*task)(); });\n    }\n    condition.notify_one();\n    return res;\n}\n\n// the destructor joins all threads\ninline ThreadPool::~ThreadPool() {\n    {\n        std::unique_lock&lt;std::mutex&gt; lock(queue_mutex);\n        stop = true;\n    }\n    condition.notify_all();\n    for (std::thread&amp; worker : workers)\n        worker.join();\n}\n\n#endif\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E4%BB%A3%E7%A0%81%E6%A0%B7%E4%BE%8B/#_3","title":"\u7981\u7528\u7c7b\u7684\u62f7\u8d1d\u548c\u79fb\u52a8","text":"<pre><code>ClassName(const ClassName&amp;) = delete;\nClassName(ClassName&amp;&amp;) = delete;\nClassName&amp; operator=(const ClassName&amp;) = delete;\nClassName&amp; operator=(ClassName&amp;&amp;) = delete;\n</code></pre> <p>\u5b8f\u5f62\u5f0f <pre><code>#define DISABLE_COPY_AND_MOVE(ClassName) \\\nClassName(const ClassName &amp;) = delete; \\\nClassName(ClassName &amp;&amp;) = delete; \\\nClassName &amp;operator=(const ClassName &amp;) = delete; \\\nClassName &amp;operator=(ClassName &amp;&amp;) = delete;\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E4%BB%A3%E7%A0%81%E6%A0%B7%E4%BE%8B/#assert","title":"\u8b66\u544a\u3001Assert","text":"<pre><code>#define Assert(expr)                                                           \\\n  if(!(expr)) {                                                                \\\n    printf(\"assert error: %s\\n\", #expr);                                       \\\n    *(volatile int *)0 = 0;                                                    \\\n  }\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/","title":"Reactor","text":"<p>\u4e3b\u4eceReactor\u67b6\u6784\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u9ad8\u6027\u80fd\u7f51\u7edc\u670d\u52a1\u5668\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5e7f\u6cdb\u5e94\u7528\u4e8eC++\u7f51\u7edc\u7f16\u7a0b\u4e2d\u3002\u5b83\u901a\u8fc7\u5206\u79bbI/O\u4e8b\u4ef6\u7684\u5904\u7406\u548c\u4e1a\u52a1\u903b\u8f91\u7684\u5904\u7406\uff0c\u63d0\u5347\u4e86\u670d\u52a1\u5668\u7684\u5e76\u53d1\u80fd\u529b\u548c\u54cd\u5e94\u901f\u5ea6\u3002\u4ee5\u4e0b\u662f\u4e3b\u4eceReactor\u67b6\u6784\u7684\u8be6\u7ec6\u8bbe\u8ba1\u601d\u8def\uff1a</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#1","title":"1. \u67b6\u6784\u6982\u8ff0","text":"<p>\u4e3b\u4eceReactor\u67b6\u6784\u7684\u6838\u5fc3\u601d\u60f3\u662f\u5c06\u4e8b\u4ef6\u5904\u7406\u5206\u4e3a\u4e24\u4e2a\u5c42\u6b21\uff1a - \u4e3bReactor\uff1a\u8d1f\u8d23\u76d1\u542c\u548c\u63a5\u53d7\u65b0\u7684\u8fde\u63a5\uff0c\u5e76\u5c06\u65b0\u8fde\u63a5\u5206\u53d1\u7ed9\u4eceReactor\u3002 - \u4eceReactor\uff1a\u8d1f\u8d23\u5904\u7406\u5df2\u5efa\u7acb\u8fde\u63a5\u7684I/O\u4e8b\u4ef6\uff08\u5982\u8bfb\u3001\u5199\u7b49\uff09\u3002</p> <p>\u8fd9\u79cd\u8bbe\u8ba1\u901a\u8fc7\u591a\u7ebf\u7a0b\u6216\u4e8b\u4ef6\u5faa\u73af\u7684\u65b9\u5f0f\uff0c\u5145\u5206\u5229\u7528\u591a\u6838CPU\u7684\u6027\u80fd\uff0c\u540c\u65f6\u907f\u514d\u4e86\u5355\u7ebf\u7a0b\u4e8b\u4ef6\u5faa\u73af\u7684\u74f6\u9888\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#2","title":"2. \u6838\u5fc3\u7ec4\u4ef6","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#1-reactor","title":"(1) Reactor","text":"<p>Reactor\u662f\u4e8b\u4ef6\u9a71\u52a8\u7684\u6838\u5fc3\uff0c\u901a\u5e38\u57fa\u4e8e<code>epoll</code>\uff08Linux\uff09\u6216<code>kqueue</code>\uff08BSD\uff09\u7b49I/O\u591a\u8def\u590d\u7528\u6280\u672f\u5b9e\u73b0\u3002\u5b83\u7684\u4e3b\u8981\u804c\u8d23\u662f\uff1a - \u76d1\u542c\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08fd\uff09\u4e0a\u7684\u4e8b\u4ef6\uff08\u5982\u8bfb\u3001\u5199\u3001\u5f02\u5e38\u7b49\uff09\u3002 - \u5c06\u4e8b\u4ef6\u5206\u53d1\u7ed9\u5bf9\u5e94\u7684\u5904\u7406\u5668\uff08Handler\uff09\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#2-acceptor","title":"(2) Acceptor","text":"<p>Acceptor\u662f\u4e3bReactor\u7684\u4e00\u90e8\u5206\uff0c\u8d1f\u8d23\u76d1\u542c\u65b0\u7684\u8fde\u63a5\u8bf7\u6c42\u3002\u5f53\u6709\u65b0\u8fde\u63a5\u5230\u8fbe\u65f6\uff0cAcceptor\u4f1a\u63a5\u53d7\u8fde\u63a5\uff0c\u5e76\u5c06\u65b0\u8fde\u63a5\u7684fd\u5206\u914d\u7ed9\u4eceReactor\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#3-handler","title":"(3) Handler","text":"<p>Handler\u662f\u4e8b\u4ef6\u5904\u7406\u5668\uff0c\u8d1f\u8d23\u5904\u7406\u5177\u4f53\u7684I/O\u4e8b\u4ef6\u3002\u6bcf\u4e2a\u8fde\u63a5\u5bf9\u5e94\u4e00\u4e2aHandler\uff0c\u5b83\u901a\u5e38\u5305\u542b\u4ee5\u4e0b\u529f\u80fd\uff1a - \u8bfb\u53d6\u6570\u636e\u5e76\u89e3\u6790\u534f\u8bae\u3002 - \u6267\u884c\u4e1a\u52a1\u903b\u8f91\u3002 - \u53d1\u9001\u54cd\u5e94\u6570\u636e\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#4-eventloop","title":"(4) EventLoop","text":"<p>EventLoop\u662f\u4e8b\u4ef6\u5faa\u73af\u7684\u6838\u5fc3\uff0c\u8d1f\u8d23\u4e0d\u65ad\u76d1\u542c\u548c\u5206\u53d1\u4e8b\u4ef6\u3002\u6bcf\u4e2aReactor\uff08\u4e3bReactor\u548c\u4eceReactor\uff09\u90fd\u6709\u81ea\u5df1\u7684EventLoop\u3002</p> <p>\u5728C++\u7f51\u7edc\u7f16\u7a0b\u4e2d\uff0cEventLoop \u662f\u4e00\u4e2a\u6838\u5fc3\u6982\u5ff5\uff0c\u5c24\u5176\u662f\u5728\u57fa\u4e8e\u4e8b\u4ef6\u9a71\u52a8\u7684\u7f16\u7a0b\u6a21\u578b\u4e2d\u3002EventLoop \u8d1f\u8d23\u4e0d\u65ad\u76d1\u542c\u548c\u5206\u53d1\u4e8b\u4ef6\uff0c\u786e\u4fdd\u7a0b\u5e8f\u80fd\u591f\u53ca\u65f6\u54cd\u5e94\u5404\u79cdI/O\u4e8b\u4ef6\u3001\u5b9a\u65f6\u5668\u4e8b\u4ef6\u7b49\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#eventloop","title":"EventLoop \u7684\u4f5c\u7528","text":"<ol> <li>\u4e8b\u4ef6\u76d1\u542c\uff1aEventLoop \u4f1a\u4e0d\u65ad\u5730\u68c0\u67e5\u662f\u5426\u6709\u65b0\u7684\u4e8b\u4ef6\u53d1\u751f\uff0c\u6bd4\u5982\u65b0\u7684\u8fde\u63a5\u8bf7\u6c42\u3001\u6570\u636e\u5230\u8fbe\u3001\u5b9a\u65f6\u5668\u8d85\u65f6\u7b49\u3002</li> <li>\u4e8b\u4ef6\u5206\u53d1\uff1a\u5f53\u68c0\u6d4b\u5230\u6709\u4e8b\u4ef6\u53d1\u751f\u65f6\uff0cEventLoop \u4f1a\u5c06\u4e8b\u4ef6\u5206\u53d1\u7ed9\u76f8\u5e94\u7684\u5904\u7406\u51fd\u6570\u6216\u56de\u8c03\u51fd\u6570\u8fdb\u884c\u5904\u7406\u3002</li> <li>\u5faa\u73af\u6267\u884c\uff1aEventLoop \u901a\u5e38\u5728\u4e00\u4e2a\u65e0\u9650\u5faa\u73af\u4e2d\u8fd0\u884c\uff0c\u4e0d\u65ad\u5730\u76d1\u542c\u548c\u5206\u53d1\u4e8b\u4ef6\uff0c\u76f4\u5230\u7a0b\u5e8f\u9000\u51fa\u3002</li> </ol>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#eventloop_1","title":"EventLoop \u7684\u5b9e\u73b0","text":"<p>\u5728\u5b9e\u73b0\u4e0a\uff0cEventLoop \u901a\u5e38\u4f1a\u4f9d\u8d56\u4e8e\u5e95\u5c42\u7684I/O\u591a\u8def\u590d\u7528\u673a\u5236\uff08\u5982 <code>select</code>\u3001<code>poll</code>\u3001<code>epoll</code> \u6216 <code>kqueue</code>\uff09\u6765\u9ad8\u6548\u5730\u76d1\u542c\u591a\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u7684\u4e8b\u4ef6\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684 EventLoop \u5b9e\u73b0\u6846\u67b6\uff1a</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;vector&gt;\n#include &lt;sys/epoll.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nclass EventLoop {\npublic:\n    EventLoop() {\n        epoll_fd_ = epoll_create1(0);\n        if (epoll_fd_ == -1) {\n            perror(\"epoll_create1\");\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    ~EventLoop() {\n        close(epoll_fd_);\n    }\n\n    void addFd(int fd, uint32_t events) {\n        struct epoll_event ev;\n        ev.events = events;\n        ev.data.fd = fd;\n        if (epoll_ctl(epoll_fd_, EPOLL_CTL_ADD, fd, &amp;ev) == -1) {\n            perror(\"epoll_ctl: add\");\n            exit(EXIT_FAILURE);\n        }\n    }\n\n    void run() {\n        const int MAX_EVENTS = 10;\n        struct epoll_event events[MAX_EVENTS];\n\n        while (true) {\n            int nfds = epoll_wait(epoll_fd_, events, MAX_EVENTS, -1);\n            if (nfds == -1) {\n                perror(\"epoll_wait\");\n                exit(EXIT_FAILURE);\n            }\n\n            for (int i = 0; i &lt; nfds; ++i) {\n                if (events[i].events &amp; EPOLLIN) {\n                    // Handle read event\n                    std::cout &lt;&lt; \"Read event on fd: \" &lt;&lt; events[i].data.fd &lt;&lt; std::endl;\n                }\n                if (events[i].events &amp; EPOLLOUT) {\n                    // Handle write event\n                    std::cout &lt;&lt; \"Write event on fd: \" &lt;&lt; events[i].data.fd &lt;&lt; std::endl;\n                }\n                // Handle other events...\n            }\n        }\n    }\n\nprivate:\n    int epoll_fd_;\n};\n\nint main() {\n    EventLoop loop;\n\n    // Example: Add a file descriptor to the event loop\n    int fd = open(\"example.txt\", O_RDONLY);\n    if (fd == -1) {\n        perror(\"open\");\n        return EXIT_FAILURE;\n    }\n\n    loop.addFd(fd, EPOLLIN);\n    loop.run();\n\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#reactor-eventloop","title":"Reactor \u6a21\u5f0f\u4e2d\u7684 EventLoop","text":"<p>\u5728 Reactor\u6a21\u5f0f \u4e2d\uff0c\u901a\u5e38\u4f1a\u6709\u591a\u4e2a EventLoop\u3002\u4e3b Reactor\uff08Main Reactor\uff09\u8d1f\u8d23\u76d1\u542c\u65b0\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u800c\u4ece Reactor\uff08Sub Reactor\uff09\u5219\u8d1f\u8d23\u5904\u7406\u5df2\u5efa\u7acb\u8fde\u63a5\u7684I/O\u64cd\u4f5c\u3002\u6bcf\u4e2a Reactor \u90fd\u6709\u81ea\u5df1\u7684 EventLoop\uff0c\u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u5730\u5c06\u4efb\u52a1\u5206\u914d\u5230\u4e0d\u540c\u7684\u7ebf\u7a0b\u6216\u8fdb\u7a0b\u4e2d\uff0c\u63d0\u9ad8\u5e76\u53d1\u5904\u7406\u80fd\u529b\u3002</p> <ul> <li>\u4e3b Reactor\uff1a\u901a\u5e38\u53ea\u6709\u4e00\u4e2a\u4e3b Reactor\uff0c\u5b83\u8d1f\u8d23\u76d1\u542c\u65b0\u7684\u8fde\u63a5\u8bf7\u6c42\u3002\u5f53\u6709\u65b0\u8fde\u63a5\u5230\u6765\u65f6\uff0c\u4e3b Reactor \u4f1a\u5c06\u8fde\u63a5\u5206\u914d\u7ed9\u4e00\u4e2a\u4ece Reactor\u3002</li> <li>\u4ece Reactor\uff1a\u53ef\u4ee5\u6709\u591a\u4e2a\u4ece Reactor\uff0c\u6bcf\u4e2a\u4ece Reactor \u90fd\u6709\u81ea\u5df1\u7684 EventLoop\u3002\u5b83\u4eec\u8d1f\u8d23\u5904\u7406\u5df2\u5efa\u7acb\u8fde\u63a5\u7684I/O\u64cd\u4f5c\u3002</li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#_1","title":"\u603b\u7ed3","text":"<p>EventLoop \u662fC++\u7f51\u7edc\u7f16\u7a0b\u4e2d\u975e\u5e38\u5173\u952e\u7684\u4e00\u4e2a\u7ec4\u4ef6\uff0c\u5b83\u901a\u8fc7\u4e0d\u65ad\u76d1\u542c\u548c\u5206\u53d1\u4e8b\u4ef6\u6765\u9a71\u52a8\u6574\u4e2a\u7a0b\u5e8f\u7684\u8fd0\u884c\u3002\u5728\u590d\u6742\u7684\u7f51\u7edc\u5e94\u7528\u4e2d\uff0c\u5408\u7406\u5730\u4f7f\u7528\u591a\u4e2a EventLoop\uff08\u5982\u4e3b\u4eceReactor\u6a21\u5f0f\uff09\u53ef\u4ee5\u663e\u8457\u63d0\u9ad8\u7a0b\u5e8f\u7684\u5e76\u53d1\u5904\u7406\u80fd\u529b\u548c\u6027\u80fd\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#5-threadpool","title":"(5) ThreadPool","text":"<p>\u4eceReactor\u901a\u5e38\u8fd0\u884c\u5728\u591a\u4e2a\u7ebf\u7a0b\u4e2d\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u72ec\u7acb\u8fd0\u884c\u4e00\u4e2aEventLoop\u3002ThreadPool\u7528\u4e8e\u7ba1\u7406\u8fd9\u4e9b\u7ebf\u7a0b\uff0c\u786e\u4fdd\u8d1f\u8f7d\u5747\u8861\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#3","title":"3. \u5de5\u4f5c\u6d41\u7a0b","text":"<ol> <li>\u4e3bReactor\u76d1\u542c\u65b0\u8fde\u63a5\uff1a</li> <li>\u4e3bReactor\u8fd0\u884c\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u7ebf\u7a0b\u4e2d\uff0c\u76d1\u542c\u670d\u52a1\u5668\u5957\u63a5\u5b57\uff08listen fd\uff09\u3002</li> <li> <p>\u5f53\u6709\u65b0\u8fde\u63a5\u5230\u8fbe\u65f6\uff0c\u4e3bReactor\u8c03\u7528Acceptor\u63a5\u53d7\u8fde\u63a5\u3002</p> </li> <li> <p>\u5206\u914d\u8fde\u63a5\u7ed9\u4eceReactor\uff1a</p> </li> <li>Acceptor\u63a5\u53d7\u8fde\u63a5\u540e\uff0c\u5c06\u65b0\u8fde\u63a5\u7684fd\u5206\u914d\u7ed9\u4e00\u4e2a\u4eceReactor\u3002</li> <li> <p>\u5206\u914d\u7b56\u7565\u53ef\u4ee5\u662f\u8f6e\u8be2\u3001\u54c8\u5e0c\u6216\u5176\u4ed6\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\u3002</p> </li> <li> <p>\u4eceReactor\u5904\u7406I/O\u4e8b\u4ef6\uff1a</p> </li> <li>\u4eceReactor\u5728\u81ea\u5df1\u7684EventLoop\u4e2d\u76d1\u542c\u5df2\u5206\u914d\u8fde\u63a5\u7684fd\u3002</li> <li> <p>\u5f53fd\u4e0a\u6709\u53ef\u8bfb\u6216\u53ef\u5199\u4e8b\u4ef6\u65f6\uff0c\u4eceReactor\u8c03\u7528\u5bf9\u5e94\u7684Handler\u5904\u7406\u3002</p> </li> <li> <p>Handler\u5904\u7406\u4e1a\u52a1\u903b\u8f91\uff1a</p> </li> <li>Handler\u8bfb\u53d6\u6570\u636e\u5e76\u89e3\u6790\u534f\u8bae\uff08\u5982HTTP\u3001WebSocket\u7b49\uff09\u3002</li> <li>\u6267\u884c\u4e1a\u52a1\u903b\u8f91\uff08\u5982\u6570\u636e\u5e93\u67e5\u8be2\u3001\u8ba1\u7b97\u7b49\uff09\u3002</li> <li> <p>\u5c06\u54cd\u5e94\u6570\u636e\u5199\u5165fd\uff0c\u89e6\u53d1\u53ef\u5199\u4e8b\u4ef6\u3002</p> </li> <li> <p>\u4e8b\u4ef6\u5faa\u73af\u6301\u7eed\u8fd0\u884c\uff1a</p> </li> <li>\u4e3bReactor\u548c\u4eceReactor\u7684EventLoop\u6301\u7eed\u8fd0\u884c\uff0c\u4e0d\u65ad\u76d1\u542c\u548c\u5904\u7406\u4e8b\u4ef6\u3002</li> </ol>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#4","title":"4. \u4ee3\u7801\u7ed3\u6784\u793a\u4f8b","text":"<p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5316\u7684C++\u4ee3\u7801\u7ed3\u6784\u793a\u4f8b\uff1a</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;vector&gt;\n#include &lt;memory&gt;\n#include &lt;sys/epoll.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n// Reactor\u7c7b\nclass Reactor {\npublic:\n    Reactor() : epoll_fd(epoll_create1(0)) {}\n    ~Reactor() { close(epoll_fd); }\n\n    void add_fd(int fd, uint32_t events) {\n        epoll_event ev;\n        ev.events = events;\n        ev.data.fd = fd;\n        epoll_ctl(epoll_fd, EPOLL_CTL_ADD, fd, &amp;ev);\n    }\n\n    void run() {\n        while (true) {\n            epoll_event events[10];\n            int n = epoll_wait(epoll_fd, events, 10, -1);\n            for (int i = 0; i &lt; n; ++i) {\n                handle_event(events[i]);\n            }\n        }\n    }\n\n    virtual void handle_event(const epoll_event&amp; ev) = 0;\n\nprotected:\n    int epoll_fd;\n};\n\n// Acceptor\u7c7b\nclass Acceptor : public Reactor {\npublic:\n    Acceptor(int port) {\n        listen_fd = socket(AF_INET, SOCK_STREAM, 0);\n        sockaddr_in addr{};\n        addr.sin_family = AF_INET;\n        addr.sin_port = htons(port);\n        addr.sin_addr.s_addr = INADDR_ANY;\n        bind(listen_fd, (sockaddr*)&amp;addr, sizeof(addr));\n        listen(listen_fd, 5);\n        add_fd(listen_fd, EPOLLIN);\n    }\n\n    void handle_event(const epoll_event&amp; ev) override {\n        if (ev.data.fd == listen_fd) {\n            int conn_fd = accept(listen_fd, nullptr, nullptr);\n            // \u5c06conn_fd\u5206\u914d\u7ed9\u4eceReactor\n            // \u8fd9\u91cc\u7701\u7565\u4e86\u5177\u4f53\u7684\u5206\u914d\u903b\u8f91\n            std::cout &lt;&lt; \"New connection: \" &lt;&lt; conn_fd &lt;&lt; std::endl;\n        }\n    }\n\nprivate:\n    int listen_fd;\n};\n\n// Handler\u7c7b\nclass Handler : public Reactor {\npublic:\n    Handler(int fd) : conn_fd(fd) {\n        add_fd(conn_fd, EPOLLIN | EPOLLET);\n    }\n\n    void handle_event(const epoll_event&amp; ev) override {\n        if (ev.events &amp; EPOLLIN) {\n            char buf[1024];\n            int n = read(conn_fd, buf, sizeof(buf));\n            if (n &gt; 0) {\n                // \u5904\u7406\u4e1a\u52a1\u903b\u8f91\n                std::cout &lt;&lt; \"Received data: \" &lt;&lt; std::string(buf, n) &lt;&lt; std::endl;\n            } else {\n                close(conn_fd);\n            }\n        }\n    }\n\nprivate:\n    int conn_fd;\n};\n\n// \u4e3b\u51fd\u6570\nint main() {\n    Acceptor acceptor(8080);\n    std::thread main_thread([&amp;acceptor]() { acceptor.run(); });\n\n    // \u5047\u8bbe\u6709\u591a\u4e2a\u4eceReactor\u7ebf\u7a0b\n    std::vector&lt;std::thread&gt; workers;\n    for (int i = 0; i &lt; 4; ++i) {\n        workers.emplace_back([]() {\n            // \u4eceReactor\u7684\u903b\u8f91\n        });\n    }\n\n    main_thread.join();\n    for (auto&amp; t : workers) {\n        t.join();\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/C%2B%2B%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#5","title":"5. \u4f18\u5316\u4e0e\u6269\u5c55","text":"<ul> <li>\u7ebf\u7a0b\u6c60\u52a8\u6001\u8c03\u6574\uff1a\u6839\u636e\u8d1f\u8f7d\u52a8\u6001\u8c03\u6574\u4eceReactor\u7684\u7ebf\u7a0b\u6570\u91cf\u3002</li> <li>\u96f6\u62f7\u8d1d\u6280\u672f\uff1a\u4f7f\u7528<code>sendfile</code>\u6216<code>mmap</code>\u51cf\u5c11\u6570\u636e\u62f7\u8d1d\u3002</li> <li>\u534f\u8bae\u4f18\u5316\uff1a\u652f\u6301HTTP/2\u3001WebSocket\u7b49\u9ad8\u6027\u80fd\u534f\u8bae\u3002</li> <li>\u5f02\u6b65\u65e5\u5fd7\uff1a\u4f7f\u7528\u5f02\u6b65\u65e5\u5fd7\u5e93\u8bb0\u5f55\u65e5\u5fd7\uff0c\u907f\u514d\u963b\u585e\u4e3b\u7ebf\u7a0b\u3002</li> </ul> <p>\u901a\u8fc7\u4ee5\u4e0a\u8bbe\u8ba1\uff0c\u4e3b\u4eceReactor\u67b6\u6784\u80fd\u591f\u9ad8\u6548\u5904\u7406\u9ad8\u5e76\u53d1\u8bf7\u6c42\uff0c\u662fC++\u7f51\u7edc\u670d\u52a1\u5668\u5f00\u53d1\u7684\u7ecf\u5178\u6a21\u5f0f\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/GTest/","title":"GTest","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/GTest/#cpp","title":"CPP","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/GTest/#_1","title":"\u5b89\u88c5","text":"<p>Archlinux \u5305\u7ba1\u7406</p> <pre><code>sudo pacman -S gtest\n</code></pre> <p>git clone</p> <pre><code>git clone https://github.com/google/googletest.git\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/GTest/#_2","title":"\u57fa\u7840","text":"<pre><code>cmake_minimum_required(VERSION 3.26)\nproject(review)\n\nset(CMAKE_CXX_STANDARD 17)\n\nenable_testing() # \u542f\u7528\u4e86\u6d4b\u8bd5\u529f\u80fd\n\nadd_executable(review main.cpp)\n\n\ninclude(FetchContent) # \u5f15\u5165\u4e86 CMake \u7684 FetchContent \u6a21\u5757\uff0c\u7528\u4e8e\u4e0b\u8f7d\u548c\u7ba1\u7406\u4f9d\u8d56\u9879\nFetchContent_Declare( # \u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a \"googletest\" \u7684\u4f9d\u8d56\u9879\uff0c\u5e76\u6307\u5b9a\u4e86\u5b83\u7684\u4e0b\u8f7d\u5730\u5740\n  googletest\n  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip\n)\n\ntarget_link_libraries( # \"review\" \u53ef\u6267\u884c\u6587\u4ef6\u4e0e GTest \u7684\u4e3b\u7a0b\u5e8f\u5e93\uff08gtest_main\uff09\u8fdb\u884c\u94fe\u63a5\uff0c\u4ee5\u4fbf\u5728\u6d4b\u8bd5\u4e2d  \n\u4f7f\u7528 GTest\u3002\n    review\n    GTest::gtest_main\n)\n\n\nset(gtest_force_shared_crt ON CACHE BOOL \"\" FORCE) # \u8bbe\u7f6e\u4e86 GTest \u7684\u4e00\u4e2a\u9009\u9879\uff0c\u7528\u4e8e\u517c\u5bb9 Windows \u5e73\u53f0\nFetchContent_MakeAvailable(googletest) # \u4ece\u4e0b\u8f7d\u7684\u4f9d\u8d56\u9879\u4e2d\u751f\u6210\u76ee\u6807\uff08\u8fd9\u91cc\u662f GTest\uff09\uff0c\u4ee5\u4fbf\u5728\u9879\u76ee\u4e2d\u4f7f\u7528\u3002\n</code></pre> <pre><code>#include &lt;cstdlib&gt;\n#include &lt;gtest/gtest.h&gt;\n\n// \u9759\u6001\u65ad\u8a00\u5728\u6d4b\u8bd5\u7684\u65f6\u5019\u4e0d\u4f1a\u5c06\u7a0b\u5e8f\u4e2d\u65ad\nlong long fact(int n)\n{\n    long long result = 1;\n    for (int i = 1; i &lt;= n; i++) result = result * i;\n    return result;\n}\n\nTEST(first_group, negtive)  // TEST\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u5206\u7ec4\u6d4b\u8bd5\uff0c\u7136\u540e\u901a\u8fc7\u65ad\u8a00\u6765\u751f\u6210\u5176\u6d4b\u8bd5\u7ed3\u679c\n{\n  EXPECT_EQ(1, fact(-5));\n  EXPECT_EQ(1, fact(-1));\n  EXPECT_GT(fact(-10), 0);\n}\n\nTEST(first_group, zero)\n{\n  EXPECT_EQ(1, fact(0));\n}\n\nTEST(first_group, Positive) \n{\n  EXPECT_EQ(1, fact(1));\n  EXPECT_EQ(2, fact(2));\n  EXPECT_EQ(6, fact(3));\n  EXPECT_EQ(40320, fact(8));\n}\n// \u9519\u8bef\u4fe1\u606f\nTEST(failure_froup, first)\n{\n    EXPECT_EQ(1, fact(2));\n}\n\nint main()\n{\n    // static_assert(1 == 2); // \u4f1a\u5c06\u7a0b\u5e8f\u76f4\u63a5\u7ec8\u6b62 \u9759\u6001\u65ad\u8a00\uff0c\u5b8c\u5168\u6ca1\u6709\u5bf9\u7a0b\u5e8f\u8fd0\u884c\u671f\u4e4b\u95f4\u7684\u6d88\u8017\u3002\n    EXPECT_EQ(1, 2); // \u8fd9\u4e2a\u4e0d\u4f1a\uff0c\u4f46\u662f\u4f1a\u5f97\u5230\u9519\u8bef\u4fe1\u606f\n    testing::InitGoogleTest();\n    return RUN_ALL_TESTS();\n}\n</code></pre> <pre><code>Expected equality of these values:\n  1\n  2\n[==========] Running 4 tests from 2 test suites.\n[----------] Global test environment set-up.\n[----------] 3 tests from first_group\n[ RUN      ] first_group.negtive\n[       OK ] first_group.negtive (0 ms)\n[ RUN      ] first_group.zero\n[       OK ] first_group.zero (0 ms)\n[ RUN      ] first_group.Positive\n[       OK ] first_group.Positive (0 ms)\n[----------] 3 tests from first_group (0 ms total)\n\n[----------] 1 test from failure_froup\n[ RUN      ] failure_froup.first\n/home/Piako/code/c++/review/main.cpp:34: Failure\nExpected equality of these values:\n  1\n  fact(2)\n    Which is: 2\n[  FAILED  ] failure_froup.first (0 ms)\n[----------] 1 test from failure_froup (0 ms total)\n\n[----------] Global test environment tear-down\n[==========] 4 tests from 2 test suites ran. (0 ms total)\n[  PASSED  ] 3 tests.\n[  FAILED  ] 1 test, listed below:\n[  FAILED  ] failure_froup.first\n\n 1 FAILED TEST\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/Google%20benchmark/","title":"Google benchmark","text":"<p>\u6837\u4f8b\u4ee3\u7801</p> <p>\u6d4b\u8bd5\u5192\u6ce1\u6392\u5e8f\u548c\u9009\u62e9\u6392\u5e8f\u7684\u901f\u5ea6</p> <pre><code>#include \"benchmark/benchmark.h\"\n#include \"sort.h\"\n\n// \u5192\u6ce1\u6392\u5e8f\nstatic void bubble(benchmark::State &amp;state) {\n    std::vector&lt;int&gt; v;\n    srand(time(NULL));\n    for (int i = 1; i &lt;= 50000; ++i) {\n        v.emplace_back(rand() % 10000);\n    }\n    for (auto _ : state) {\n        bubble_sort(v);\n    }\n}\nBENCHMARK(bubble);\n\n// \u9009\u62e9\u6392\u5e8f\nstatic void select(benchmark::State &amp;state) {\n    std::vector&lt;int&gt; v;\n    srand(time(NULL));\n    for (int i = 1; i &lt;= 50000; ++i) {\n        v.emplace_back(rand() % 10000);\n    }\n    for (auto _ : state) {\n        select_sort(v);\n    }\n}\nBENCHMARK(select);\n\nBENCHMARK_MAIN();\n</code></pre> <p>output</p> <pre><code>Run on (16 X 2900 MHz CPU s)\nCPU Caches:\n  L1 Data 32 KiB (x8)\n  L1 Instruction 32 KiB (x8)\n  L2 Unified 512 KiB (x8)\n  L3 Unified 4096 KiB (x2)\nLoad Average: 1.73, 1.62, 1.37\n***WARNING*** CPU scaling is enabled, the benchmark real time measurements may be noisy and will incur extra overhead.\n-----------------------------------------------------\nBenchmark           Time             CPU   Iterations\n-----------------------------------------------------\nbubble     3879170822 ns   3878109577 ns            1\nselect     1461544666 ns   1461428968 ns            1\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/clang-format%20%20%26%20clang-tidy/","title":"clang-format &amp; clang-tidy","text":"<p>\u76f8\u5173 GitHub - VS Code C++\u9879\u76ee\u6a21\u677f</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/clang-format%20%20%26%20clang-tidy/#clang-format","title":"clang-format","text":"<p><code>.clang-format</code></p> <pre><code># \u57fa\u4e8eLLVM\nBasedOnStyle: LLVM\n\n# \u8bbe\u7f6e\u7f29\u8fdb\u662f 4 \u7a7a\u683c\nIndentWidth: 4 \n\n# \u4f7f\u7528\u7a7a\u683c\nUseTab: Never\n\n# \u8bbe\u7f6e\u8bbf\u95ee\u4fee\u9970\u7b26\uff08public\u3001private\u3001protected\uff09\u7684\u504f\u79fb\u91cf\u4e3a-4\uff0c\u4f7f\u5f97\u4e0eclass\u5bf9\u5176\nAccessModifierOffset: -4  \n\n# \u5141\u8bb8\u6392\u5e8f#include\nSortIncludes: false\n\n# \u6307\u9488\u548c\u5f15\u7528\u7684\u5bf9\u9f50: Left, Right, Middle\nPointerAlignment: Left\n\n# \u5141\u8bb8\u91cd\u65b0\u6392\u7248\u6ce8\u91ca\nReflowComments: true\n\n# \u5bf9\u9f50\u8fde\u7eed\u7684\u5c3e\u968f\u7684\u6ce8\u91ca\nAlignTrailingComments: true\n\n# \u8fde\u7eed\u58f0\u660e\u65f6\uff0c\u5bf9\u9f50\u6240\u6709\u58f0\u660e\u7684\u53d8\u91cf\u540d\nAlignConsecutiveDeclarations: true\n\n# \u603b\u662f\u5728template\u58f0\u660e\u540e\u6362\u884c\nAlwaysBreakTemplateDeclarations: true\n\n# \u8fde\u7eed\u7a7a\u884c\u7684\u6700\u5927\u6570\u91cf\nMaxEmptyLinesToKeep: 1\n</code></pre> <pre><code># \u57fa\u4e8eLLVM\nBasedOnStyle: LLVM\n\n# \u8bbe\u7f6e\u7f29\u8fdb\u662f 4 \u7a7a\u683c\nIndentWidth: 4 \n\n# \u4f7f\u7528\u7a7a\u683c\nUseTab: Never\n\n# \u8bbe\u7f6e\u8bbf\u95ee\u4fee\u9970\u7b26\uff08public\u3001private\u3001protected\uff09\u7684\u504f\u79fb\u91cf\u4e3a-4\uff0c\u4f7f\u5f97\u4e0eclass\u5bf9\u5176\nAccessModifierOffset: -4  \n\n# \u5141\u8bb8\u6392\u5e8f#include\nSortIncludes: false\n\n# \u6307\u9488\u548c\u5f15\u7528\u7684\u5bf9\u9f50: Left, Right, Middle\nPointerAlignment: Left\n\n\n# \u5141\u8bb8\u91cd\u65b0\u6392\u7248\u6ce8\u91ca\nReflowComments: true\n\n# \u5bf9\u9f50\u8fde\u7eed\u7684\u5c3e\u968f\u7684\u6ce8\u91ca\nAlignTrailingComments: true\n\nColumnLimit: 120\n\n# \u8bbe\u7f6e\u521d\u59cb\u5316\u7684\nCpp11BracedListStyle: false\nSpaceBeforeCpp11BracedList: true\n</code></pre> <pre><code>BasedOnStyle: LLVM\nIndentWidth: 4\nTabWidth: 4\nLanguage: Cpp\n</code></pre> <pre><code>Language: Cpp\nBasedOnStyle: WebKit\n</code></pre> <pre><code>Language: Cpp\nBasedOnStyle: Microsoft\n</code></pre> <pre><code>BasedOnStyle: Google\nDerivePointerAlignment: false\nPointerAlignment: Right\nColumnLimit: 120\nIncludeBlocks: Preserve\n</code></pre> <pre><code># \u8bed\u8a00: None, Cpp, Java, JavaScript, ObjC, Proto, TableGen, TextProto\nLanguage: Cpp\n# BasedOnStyle: LLVM\n\n# \u8bbf\u95ee\u8bf4\u660e\u7b26(public\u3001private\u7b49)\u7684\u504f\u79fb\nAccessModifierOffset: -4\n\n# \u5f00\u62ec\u53f7(\u5f00\u5706\u62ec\u53f7\u3001\u5f00\u5c16\u62ec\u53f7\u3001\u5f00\u65b9\u62ec\u53f7)\u540e\u7684\u5bf9\u9f50: Align, DontAlign, AlwaysBreak(\u603b\u662f\u5728\u5f00\u62ec\u53f7\u540e\u6362\u884c)\nAlignAfterOpenBracket: Align\n\n# \u8fde\u7eed\u8d4b\u503c\u65f6\uff0c\u5bf9\u9f50\u6240\u6709\u7b49\u53f7\nAlignConsecutiveAssignments: false\n\n# \u8fde\u7eed\u58f0\u660e\u65f6\uff0c\u5bf9\u9f50\u6240\u6709\u58f0\u660e\u7684\u53d8\u91cf\u540d\nAlignConsecutiveDeclarations: false\n\n# \u53f3\u5bf9\u9f50\u9003\u8131\u6362\u884c(\u4f7f\u7528\u53cd\u659c\u6760\u6362\u884c)\u7684\u53cd\u659c\u6760\nAlignEscapedNewlines: Right\n\n# \u6c34\u5e73\u5bf9\u9f50\u4e8c\u5143\u548c\u4e09\u5143\u8868\u8fbe\u5f0f\u7684\u64cd\u4f5c\u6570\nAlignOperands: true\n\n# \u5bf9\u9f50\u8fde\u7eed\u7684\u5c3e\u968f\u7684\u6ce8\u91ca\nAlignTrailingComments: true\n\n# \u4e0d\u5141\u8bb8\u51fd\u6570\u58f0\u660e\u7684\u6240\u6709\u53c2\u6570\u5728\u653e\u5728\u4e0b\u4e00\u884c\nAllowAllParametersOfDeclarationOnNextLine: false\n\n# \u4e0d\u5141\u8bb8\u77ed\u7684\u5757\u653e\u5728\u540c\u4e00\u884c\nAllowShortBlocksOnASingleLine: true\n\n# \u5141\u8bb8\u77ed\u7684case\u6807\u7b7e\u653e\u5728\u540c\u4e00\u884c\nAllowShortCaseLabelsOnASingleLine: true\n\n# \u5141\u8bb8\u77ed\u7684\u51fd\u6570\u653e\u5728\u540c\u4e00\u884c: None, InlineOnly(\u5b9a\u4e49\u5728\u7c7b\u4e2d), Empty(\u7a7a\u51fd\u6570), Inline(\u5b9a\u4e49\u5728\u7c7b\u4e2d\uff0c\u7a7a\u51fd\u6570), All\nAllowShortFunctionsOnASingleLine: None\n\n# \u5141\u8bb8\u77ed\u7684if\u8bed\u53e5\u4fdd\u6301\u5728\u540c\u4e00\u884c\nAllowShortIfStatementsOnASingleLine: true\n\n# \u5141\u8bb8\u77ed\u7684\u5faa\u73af\u4fdd\u6301\u5728\u540c\u4e00\u884c\nAllowShortLoopsOnASingleLine: true\n\n# \u603b\u662f\u5728\u8fd4\u56de\u7c7b\u578b\u540e\u6362\u884c: None, All, TopLevel(\u9876\u7ea7\u51fd\u6570\uff0c\u4e0d\u5305\u62ec\u5728\u7c7b\u4e2d\u7684\u51fd\u6570), \n# AllDefinitions(\u6240\u6709\u7684\u5b9a\u4e49\uff0c\u4e0d\u5305\u62ec\u58f0\u660e), TopLevelDefinitions(\u6240\u6709\u7684\u9876\u7ea7\u51fd\u6570\u7684\u5b9a\u4e49)\nAlwaysBreakAfterReturnType: None\n\n# \u603b\u662f\u5728\u591a\u884cstring\u5b57\u9762\u91cf\u524d\u6362\u884c\nAlwaysBreakBeforeMultilineStrings: false\n\n# \u603b\u662f\u5728template\u58f0\u660e\u540e\u6362\u884c\nAlwaysBreakTemplateDeclarations: true\n\n# false\u8868\u793a\u51fd\u6570\u5b9e\u53c2\u8981\u4e48\u90fd\u5728\u540c\u4e00\u884c\uff0c\u8981\u4e48\u90fd\u5404\u81ea\u4e00\u884c\nBinPackArguments: true\n\n# false\u8868\u793a\u6240\u6709\u5f62\u53c2\u8981\u4e48\u90fd\u5728\u540c\u4e00\u884c\uff0c\u8981\u4e48\u90fd\u5404\u81ea\u4e00\u884c\nBinPackParameters: true\n\n# \u5927\u62ec\u53f7\u6362\u884c\uff0c\u53ea\u6709\u5f53BreakBeforeBraces\u8bbe\u7f6e\u4e3aCustom\u65f6\u624d\u6709\u6548\nBraceWrapping:\n  # class\u5b9a\u4e49\u540e\u9762\n  AfterClass: false\n  # \u63a7\u5236\u8bed\u53e5\u540e\u9762\n  AfterControlStatement: false\n  # enum\u5b9a\u4e49\u540e\u9762\n  AfterEnum: false\n  # \u51fd\u6570\u5b9a\u4e49\u540e\u9762\n  AfterFunction: false\n  # \u547d\u540d\u7a7a\u95f4\u5b9a\u4e49\u540e\u9762\n  AfterNamespace: false\n  # struct\u5b9a\u4e49\u540e\u9762\n  AfterStruct: false\n  # union\u5b9a\u4e49\u540e\u9762\n  AfterUnion: false\n  # extern\u4e4b\u540e\n  AfterExternBlock: false\n  # catch\u4e4b\u524d\n  BeforeCatch: false\n  # else\u4e4b\u524d\n  BeforeElse: false\n  # \u7f29\u8fdb\u5927\u62ec\u53f7\n  IndentBraces: false\n  # \u5206\u79bb\u7a7a\u51fd\u6570\n  SplitEmptyFunction: false\n  # \u5206\u79bb\u7a7a\u8bed\u53e5\n  SplitEmptyRecord: false\n  # \u5206\u79bb\u7a7a\u547d\u540d\u7a7a\u95f4\n  SplitEmptyNamespace: false\n\n# \u5728\u4e8c\u5143\u8fd0\u7b97\u7b26\u524d\u6362\u884c: None(\u5728\u64cd\u4f5c\u7b26\u540e\u6362\u884c), NonAssignment(\u5728\u975e\u8d4b\u503c\u7684\u64cd\u4f5c\u7b26\u524d\u6362\u884c), All(\u5728\u64cd\u4f5c\u7b26\u524d\u6362\u884c)\nBreakBeforeBinaryOperators: NonAssignment\n\n# \u5728\u5927\u62ec\u53f7\u524d\u6362\u884c: Attach(\u59cb\u7ec8\u5c06\u5927\u62ec\u53f7\u9644\u52a0\u5230\u5468\u56f4\u7684\u4e0a\u4e0b\u6587), Linux(\u9664\u51fd\u6570\u3001\u547d\u540d\u7a7a\u95f4\u548c\u7c7b\u5b9a\u4e49\uff0c\u4e0eAttach\u7c7b\u4f3c), \n#   Mozilla(\u9664\u679a\u4e3e\u3001\u51fd\u6570\u3001\u8bb0\u5f55\u5b9a\u4e49\uff0c\u4e0eAttach\u7c7b\u4f3c), Stroustrup(\u9664\u51fd\u6570\u5b9a\u4e49\u3001catch\u3001else\uff0c\u4e0eAttach\u7c7b\u4f3c), \n#   Allman(\u603b\u662f\u5728\u5927\u62ec\u53f7\u524d\u6362\u884c), GNU(\u603b\u662f\u5728\u5927\u62ec\u53f7\u524d\u6362\u884c\uff0c\u5e76\u5bf9\u4e8e\u63a7\u5236\u8bed\u53e5\u7684\u5927\u62ec\u53f7\u589e\u52a0\u989d\u5916\u7684\u7f29\u8fdb), WebKit(\u5728\u51fd\u6570\u524d\u6362\u884c), Custom\n#   \u6ce8\uff1a\u8fd9\u91cc\u8ba4\u4e3a\u8bed\u53e5\u5757\u4e5f\u5c5e\u4e8e\u51fd\u6570\nBreakBeforeBraces: Custom\n\n# \u5728\u4e09\u5143\u8fd0\u7b97\u7b26\u524d\u6362\u884c\nBreakBeforeTernaryOperators: false\n\n# \u5728\u6784\u9020\u51fd\u6570\u7684\u521d\u59cb\u5316\u5217\u8868\u7684\u5192\u53f7\u540e\u6362\u884c\nBreakConstructorInitializers: AfterColon\n\n#BreakInheritanceList: AfterColon\n\nBreakStringLiterals: false\n\n# \u6bcf\u884c\u5b57\u7b26\u7684\u9650\u5236\uff0c0\u8868\u793a\u6ca1\u6709\u9650\u5236\nColumnLimit: 0\n\nCompactNamespaces: true\n\n# \u6784\u9020\u51fd\u6570\u7684\u521d\u59cb\u5316\u5217\u8868\u8981\u4e48\u90fd\u5728\u540c\u4e00\u884c\uff0c\u8981\u4e48\u90fd\u5404\u81ea\u4e00\u884c\nConstructorInitializerAllOnOneLineOrOnePerLine: false\n\n# \u6784\u9020\u51fd\u6570\u7684\u521d\u59cb\u5316\u5217\u8868\u7684\u7f29\u8fdb\u5bbd\u5ea6\nConstructorInitializerIndentWidth: 4\n\n# \u5ef6\u7eed\u7684\u884c\u7684\u7f29\u8fdb\u5bbd\u5ea6\nContinuationIndentWidth: 4\n\n# \u53bb\u9664C++11\u7684\u5217\u8868\u521d\u59cb\u5316\u7684\u5927\u62ec\u53f7{\u540e\u548c}\u524d\u7684\u7a7a\u683c\nCpp11BracedListStyle: true\n\n# \u7ee7\u627f\u6700\u5e38\u7528\u7684\u6307\u9488\u548c\u5f15\u7528\u7684\u5bf9\u9f50\u65b9\u5f0f\nDerivePointerAlignment: false\n\n# \u56fa\u5b9a\u547d\u540d\u7a7a\u95f4\u6ce8\u91ca\nFixNamespaceComments: true\n\n# \u7f29\u8fdbcase\u6807\u7b7e\nIndentCaseLabels: false\n\nIndentPPDirectives: None\n\n# \u7f29\u8fdb\u5bbd\u5ea6\nIndentWidth: 4\n\n# \u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u6362\u884c\u65f6\uff0c\u7f29\u8fdb\u51fd\u6570\u58f0\u660e\u6216\u51fd\u6570\u5b9a\u4e49\u7684\u51fd\u6570\u540d\nIndentWrappedFunctionNames: false\n\n# \u4fdd\u7559\u5728\u5757\u5f00\u59cb\u5904\u7684\u7a7a\u884c\nKeepEmptyLinesAtTheStartOfBlocks: false\n\n# \u8fde\u7eed\u7a7a\u884c\u7684\u6700\u5927\u6570\u91cf\nMaxEmptyLinesToKeep: 1\n\n# \u547d\u540d\u7a7a\u95f4\u7684\u7f29\u8fdb: None, Inner(\u7f29\u8fdb\u5d4c\u5957\u7684\u547d\u540d\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9), All\nNamespaceIndentation: None\n\n# \u6307\u9488\u548c\u5f15\u7528\u7684\u5bf9\u9f50: Left, Right, Middle\nPointerAlignment: Right\n\n# \u5141\u8bb8\u91cd\u65b0\u6392\u7248\u6ce8\u91ca\nReflowComments: true\n\n# \u5141\u8bb8\u6392\u5e8f#include\nSortIncludes: false\n\n# \u5141\u8bb8\u6392\u5e8f using \u58f0\u660e\nSortUsingDeclarations: false\n\n# \u5728C\u98ce\u683c\u7c7b\u578b\u8f6c\u6362\u540e\u6dfb\u52a0\u7a7a\u683c\nSpaceAfterCStyleCast: false\n\n# \u5728Template \u5173\u952e\u5b57\u540e\u9762\u6dfb\u52a0\u7a7a\u683c\nSpaceAfterTemplateKeyword: true\n\n# \u5728\u8d4b\u503c\u8fd0\u7b97\u7b26\u4e4b\u524d\u6dfb\u52a0\u7a7a\u683c\nSpaceBeforeAssignmentOperators: true\n\n# SpaceBeforeCpp11BracedList: true\n\n# SpaceBeforeCtorInitializerColon: true\n\n# SpaceBeforeInheritanceColon: true\n\n# \u5f00\u5706\u62ec\u53f7\u4e4b\u524d\u6dfb\u52a0\u4e00\u4e2a\u7a7a\u683c: Never, ControlStatements, Always\nSpaceBeforeParens: ControlStatements\n\n# SpaceBeforeRangeBasedForLoopColon: true\n\n# \u5728\u7a7a\u7684\u5706\u62ec\u53f7\u4e2d\u6dfb\u52a0\u7a7a\u683c\nSpaceInEmptyParentheses: false\n\n# \u5728\u5c3e\u968f\u7684\u8bc4\u8bba\u524d\u6dfb\u52a0\u7684\u7a7a\u683c\u6570(\u53ea\u9002\u7528\u4e8e//)\nSpacesBeforeTrailingComments: 1\n\n# \u5728\u5c16\u62ec\u53f7\u7684&lt;\u540e\u548c&gt;\u524d\u6dfb\u52a0\u7a7a\u683c\nSpacesInAngles: false\n\n# \u5728C\u98ce\u683c\u7c7b\u578b\u8f6c\u6362\u7684\u62ec\u53f7\u4e2d\u6dfb\u52a0\u7a7a\u683c\nSpacesInCStyleCastParentheses: false\n\n# \u5728\u5bb9\u5668(ObjC\u548cJavaScript\u7684\u6570\u7ec4\u548c\u5b57\u5178\u7b49)\u5b57\u9762\u91cf\u4e2d\u6dfb\u52a0\u7a7a\u683c\nSpacesInContainerLiterals: true\n\n# \u5728\u5706\u62ec\u53f7\u7684(\u540e\u548c)\u524d\u6dfb\u52a0\u7a7a\u683c\nSpacesInParentheses: false\n\n# \u5728\u65b9\u62ec\u53f7\u7684[\u540e\u548c]\u524d\u6dfb\u52a0\u7a7a\u683c\uff0clamda\u8868\u8fbe\u5f0f\u548c\u672a\u6307\u660e\u5927\u5c0f\u7684\u6570\u7ec4\u7684\u58f0\u660e\u4e0d\u53d7\u5f71\u54cd\nSpacesInSquareBrackets: false\n\n# \u6807\u51c6: Cpp03, Cpp11, Auto\nStandard: Cpp11\n\n# tab\u5bbd\u5ea6\nTabWidth: 4\n\n# \u4f7f\u7528tab\u5b57\u7b26: Never, ForIndentation, ForContinuationAndIndentation, Always\nUseTab: Never\n</code></pre> <p>BasedOnStyle</p> <pre><code>LLVM, Google, Chromium, Mozilla, WebKit, Microsoft\n</code></pre> <p>\u5feb\u901f\u751f\u6210<code>.clang-format</code>\u6587\u4ef6</p> <pre><code>clang-format -style=llvm -dump-config &gt; .clang-format\n</code></pre> <pre><code>clang-format -style=Microsoft -dump-config &gt; .clang-format\n</code></pre> <pre><code>clang-format -style=Google -dump-config &gt; .clang-format\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/clang-format%20%20%26%20clang-tidy/#clang-tidy","title":"clang-tidy","text":"<p><code>.clang-tidy</code></p> <pre><code>---\nChecks:    \"bugprone-*,\\\n            cert-*,\\\n            clang-analyzer-*,\\\n            concurrency-*,\\\n            google-*,\\\n            llvm-*,\\\n            misc-*,\\\n            modernize-*,\\\n            portability-*,\\\n            performance-*,\\\n            readability-*,\\\n            -bugprone-easily-swappable-parameters,\\\n            -bugprone-reserved-identifier,\\\n            -cert-dcl51-cpp,\\\n            -cert-dcl37-c,\\\n            -readability-magic-numbers,\\\n            -readability-identifier-length,\\\n            -readability-implicit-bool-conversion,\\\n            -readability-isolate-declaration,\\\n            -readability-static-accessed-through-instance,\\\n            -readability-redundant-access-specifiers,\\\n            -google-build-using-namespace,\\\n            -google-readability-casting,\\\n            -google-readability-todo,\\\n            -modernize-avoid-c-arrays,\\\n            -modernize-use-trailing-return-type,\\\n            -misc-non-private-member-variables-in-classes\"\nWarningsAsErrors:   '-*'\nHeaderFilterRegex: '^.*\\.hpp$'\nFormatStyle: file\nAnalyzeTemporaryDtors: false\n# check https://clang.llvm.org/extra/clang-tidy/checks/readability/identifier-naming.html\nCheckOptions:\n  - key:             readability-identifier-naming.ClassCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.ClassConstantCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.ClassConstantPrefix\n    value:           ''\n  - key:             readability-identifier-naming.EnumCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.EnumConstantCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.FunctionCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.GlobalConstantCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.MemberCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.NamespaceCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.PublicMemberSuffix\n    value:           ''\n  - key:             readability-identifier-naming.PrivateMemberSuffix\n    value:           ''\n  - key:             readability-identifier-naming.ProtectedMemberSuffix\n    value:           ''\n  - key:             readability-identifier-naming.MethodCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.ParameterCase\n    value:           aNy_CasE\n  - key:             readability-identifier-naming.VariableCase\n    value:           aNy_CasE\n</code></pre> <pre><code>---\nChecks:     '\n            bugprone-*,\n            clang-analyzer-*,\n            google-*,\n            modernize-*,\n            performance-*,\n            portability-*,\n            readability-*,\n            -bugprone-easily-swappable-parameters,\n            -bugprone-implicit-widening-of-multiplication-result,\n            -bugprone-narrowing-conversions,\n            -bugprone-reserved-identifier,\n            -bugprone-signed-char-misuse,\n            -bugprone-suspicious-include,\n            -bugprone-unhandled-self-assignment,\n            -clang-analyzer-cplusplus.NewDelete,\n            -clang-analyzer-cplusplus.NewDeleteLeaks,\n            -clang-analyzer-security.insecureAPI.rand,\n            -clang-diagnostic-implicit-int-float-conversion,\n            -google-readability-avoid-underscore-in-googletest-name,\n            -modernize-avoid-c-arrays,\n            -modernize-use-nodiscard,\n            -readability-convert-member-functions-to-static,\n            -readability-identifier-length,\n            -readability-function-cognitive-complexity,\n            -readability-magic-numbers,\n            -readability-make-member-function-const,\n            -readability-qualified-auto,\n            -readability-redundant-access-specifiers,\n            -bugprone-exception-escape,\n            '\nCheckOptions:\n  - { key: readability-identifier-naming.ClassCase,           value: CamelCase  }\n  - { key: readability-identifier-naming.EnumCase,            value: CamelCase  }\n  - { key: readability-identifier-naming.FunctionCase,        value: CamelCase  }\n  - { key: readability-identifier-naming.GlobalConstantCase,  value: UPPER_CASE }\n  - { key: readability-identifier-naming.MemberCase,          value: lower_case }\n  - { key: readability-identifier-naming.MemberSuffix,        value: _          }\n  - { key: readability-identifier-naming.NamespaceCase,       value: lower_case }\n  - { key: readability-identifier-naming.StructCase,          value: CamelCase  }\n  - { key: readability-identifier-naming.UnionCase,           value: CamelCase  }\n  - { key: readability-identifier-naming.VariableCase,        value: lower_case }\nWarningsAsErrors: '*'\nHeaderFilterRegex: '/(src|test)/include'\nAnalyzeTemporaryDtors: true\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/clang-format%20%20%26%20clang-tidy/#my-clang-format-clang-tidy-file","title":"My clang-format &amp; clang-tidy file","text":"<p><code>.clang-format</code></p> <pre><code># \u57fa\u4e8eLLVM\nBasedOnStyle: LLVM\n\n# \u8bbe\u7f6e\u7f29\u8fdb\u662f 4 \u7a7a\u683c\nIndentWidth: 4 \n\n# \u4f7f\u7528\u7a7a\u683c\nUseTab: Never\n\n# \u8bbe\u7f6e\u8bbf\u95ee\u4fee\u9970\u7b26\uff08public\u3001private\u3001protected\uff09\u7684\u504f\u79fb\u91cf\u4e3a-4\uff0c\u4f7f\u5f97\u4e0eclass\u5bf9\u5176\nAccessModifierOffset: -4  \n</code></pre> <pre><code># \u57fa\u4e8eLLVM\nBasedOnStyle: LLVM\n\n# \u8bbe\u7f6e\u7f29\u8fdb\u662f 4 \u7a7a\u683c\nIndentWidth: 4\n\n# \u4f7f\u7528\u7a7a\u683c\nUseTab: Never\n\nAccessModifierOffset: -4\n\n# \u5141\u8bb8\u6392\u5e8f#include\nSortIncludes: Never\n\n# \u6307\u9488\u548c\u5f15\u7528\u7684\u5bf9\u9f50: Left, Right, Middle\nPointerAlignment: Right\n\n# \u5141\u8bb8\u91cd\u65b0\u6392\u7248\u6ce8\u91ca\nReflowComments: true\n\n# \u5bf9\u9f50\u8fde\u7eed\u7684\u5c3e\u968f\u7684\u6ce8\u91ca\nAlignTrailingComments: true\n\n# \u8fde\u7eed\u58f0\u660e\u65f6\uff0c\u5bf9\u9f50\u6240\u6709\u58f0\u660e\u7684\u53d8\u91cf\u540d\nAlignConsecutiveDeclarations: true\n\n# \u603b\u662f\u5728template\u58f0\u660e\u540e\u6362\u884c\nAlwaysBreakTemplateDeclarations: Yes\n\n# \u8fde\u7eed\u7a7a\u884c\u7684\u6700\u5927\u6570\u91cf\nMaxEmptyLinesToKeep: 1\n\n# false\u8868\u793a\u51fd\u6570\u5b9e\u53c2\u8981\u4e48\u90fd\u5728\u540c\u4e00\u884c\uff0c\u8981\u4e48\u90fd\u5404\u81ea\u4e00\u884c\nBinPackArguments: false\n</code></pre> <p><code>.clang-tidy</code></p> <pre><code>---\nChecks: \"bugprone-*,\\\n  cert-*,\\\n  clang-analyzer-*,\\\n  concurrency-*,\\\n  google-*,\\\n  llvm-*,\\\n  misc-*,\\\n  modernize-*,\\\n  portability-*,\\\n  performance-*,\\\n  readability-*,\\\n  -bugprone-easily-swappable-parameters,\\\n  -bugprone-reserved-identifier,\\\n  -cert-dcl51-cpp,\\\n  -cert-dcl37-c,\\\n  -readability-magic-numbers,\\\n  -readability-identifier-length,\\\n  -readability-implicit-bool-conversion,\\\n  -readability-isolate-declaration,\\\n  -readability-static-accessed-through-instance,\\\n  -readability-redundant-access-specifiers,\\\n  -google-build-using-namespace,\\\n  -google-readability-casting,\\\n  -google-readability-todo,\\\n  -modernize-avoid-c-arrays,\\\n  -modernize-use-trailing-return-type,\\\n  -misc-non-private-member-variables-in-classes\"\nWarningsAsErrors: \"-*\"\nHeaderFilterRegex: '^.*\\.hpp$'\nFormatStyle: file\nAnalyzeTemporaryDtors: false\n# check https://clang.llvm.org/extra/clang-tidy/checks/readability/identifier-naming.html\nCheckOptions:\n  - key: readability-identifier-naming.ClassCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.ClassConstantCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.ClassConstantPrefix\n    value: \"\"\n  - key: readability-identifier-naming.EnumCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.EnumConstantCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.FunctionCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.GlobalConstantCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.MemberCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.NamespaceCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.PublicMemberSuffix\n    value: \"\"\n  - key: readability-identifier-naming.PrivateMemberSuffix\n    value: \"\"\n  - key: readability-identifier-naming.ProtectedMemberSuffix\n    value: \"\"\n  - key: readability-identifier-naming.MethodCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.ParameterCase\n    value: aNy_CasE\n  - key: readability-identifier-naming.VariableCase\n    value: aNy_CasE\n</code></pre> <p>\u4fee\u6539\u4e86CheckOption\u7684<code>.clang-tidy</code>:</p> <pre><code>---\nChecks: \"bugprone-*,\\\n  cert-*,\\\n  clang-analyzer-*,\\\n  concurrency-*,\\\n  google-*,\\\n  llvm-*,\\\n  misc-*,\\\n  modernize-*,\\\n  portability-*,\\\n  performance-*,\\\n  readability-*,\\\n  -bugprone-easily-swappable-parameters,\\\n  -bugprone-reserved-identifier,\\\n  -cert-dcl51-cpp,\\\n  -cert-dcl37-c,\\\n  -readability-magic-numbers,\\\n  -readability-identifier-length,\\\n  -readability-implicit-bool-conversion,\\\n  -readability-isolate-declaration,\\\n  -readability-static-accessed-through-instance,\\\n  -readability-redundant-access-specifiers,\\\n  -google-build-using-namespace,\\\n  -google-readability-casting,\\\n  -google-readability-todo,\\\n  -modernize-avoid-c-arrays,\\\n  -modernize-use-trailing-return-type,\\\n  -misc-non-private-member-variables-in-classes\"\nWarningsAsErrors: \"-*\"\nHeaderFilterRegex: '^.*\\.hpp$'\nFormatStyle: file\nAnalyzeTemporaryDtors: false\n# check https://clang.llvm.org/extra/clang-tidy/checks/readability/identifier-naming.html\n\n\nCheckOptions:\n  - { key: readability-identifier-naming.ClassCase, value: CamelCase }\n  - { key: readability-identifier-naming.EnumCase, value: CamelCase }\n  - { key: readability-identifier-naming.FunctionCase, value: CamelCase }\n  - { key: readability-identifier-naming.GlobalConstantCase, value: UPPER_CASE }\n  - { key: readability-identifier-naming.MemberCase, value: lower_case }\n  - { key: readability-identifier-naming.MemberSuffix, value: _ }\n  - { key: readability-identifier-naming.NamespaceCase, value: lower_case }\n  - { key: readability-identifier-naming.StructCase, value: CamelCase }\n  - { key: readability-identifier-naming.UnionCase, value: CamelCase }\n  - { key: readability-identifier-naming.VariableCase, value: lower_case }\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B%20Template/","title":"C++ Template","text":"<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\ntemplate &lt;typename T&gt;\nvoid my_swap(T &amp;a, T &amp;b) // \u975e\u4f18\u5148\u8c03\u7528\n{\n    auto temp = a;\n    a = b;\n    b = temp;\n}\ntemplate &lt;typename T, typename U&gt;\nvoid my_swap(T &amp;a, U &amp;b)\n{\n    auto temp = a;\n    a = b;\n    b = temp;\n}\n\nvoid my_swap(int &amp;a, int &amp;b) // \u4f18\u5148\u8c03\u7528\n{\n    cout &lt;&lt; \"YYY\" &lt;&lt; endl;\n    auto temp = a;\n    a = b;\n    b = temp;\n}\n\nint main()\n{\n    int aa = 1;\n    int bb = 2;\n    my_swap(aa, bb); // \u8c03\u7528int\n    cout &lt;&lt; aa &lt;&lt; \" \" &lt;&lt; bb &lt;&lt; endl;\n\n    double a = 1;\n    float b = 2.1;\n    my_swap(a, b);\n    cout &lt;&lt; a &lt;&lt; \" \" &lt;&lt; b &lt;&lt; endl;\n    return 0;\n}\n</code></pre> <pre><code>YYY\n21\n2.1 1\n</code></pre> <p>\u6a21\u7248\u51fd\u6570\u4e0d\u652f\u6301\u9690\u5f0f\u8f6c\u6362\uff0c\u5fc5\u987b\u5339\u914d \u5f53\u51fd\u6570\u91cd\u8f7d\u4e0e\u6a21\u7248\u51fd\u6570\u51b2\u7a81\u65f6\uff0c\u4f18\u5148\u8c03\u7528\u666e\u901a\u51fd\u6570</p> <p>C++20</p> <p>\u6a21\u677f\u7ea6\u675f</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;type_traits&gt;\n\n\n// C++ 17 \u4e4b\u524d\n\ntemplate&lt;typename T,typename = std::enable_if&lt;std::is_integralv&lt;T&gt;&gt;&gt;\nvoid f(T a){\n    std::cout&lt;&lt;a&lt;&lt;std::endl;\n}\n\n\n// C++ 17\n\ntemplate&lt;typename T,typename = std::enable_if_t&lt;std::is_integral_v&lt;T&gt;&gt;&gt;\nvoid f(T a){\n    std::cout&lt;&lt;a&lt;&lt;std::endl;\n}\n\n// \u4ee5\u4e0b\u4e3aC++ 20 \u652f\u6301\n\ntemplate&lt;typename T&gt;\n    requires std::is_same_v&lt;T, int&gt;\nvoid f2(T){}\n\n\n// template &lt;typename T&gt;\n// concept have_func=requires{T::func; }; // \u8981\u6c42\u62e5\u6709\u6210\u5458\u53d8\u91cf\n\ntemplate &lt;typename T&gt;\nconcept have_func = requires(T t) {t.func; t.f();};\n\ntemplate &lt;typename T&gt;\nconcept Int = std::is_same_v&lt;T, int&gt;;\n\n\nvoid f3(have_func auto a) { // \u7b80\u5199\u6a21\u677f\u51fd\u6570\n    // do nothing\n}\n\ntemplate &lt;typename Int&gt;\nvoid f4(Int a) {\n\n}\n\ntemplate &lt;typename T&gt;\n    requires requires (T t) {t.func; t.f();}\nstruct Y{};\n\nint main() {\n    f(1);\n    //f(1.0);\n    f('c');\n    f(1l);\n    f2(1);\n    //f2(1l);\n\n    struct X{int func; void f();};\n    f3(X{});\n\n    Int auto r = 1;\n\n    f4(1);\n    f4(1l);\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/","title":"C++","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_1","title":"\u57fa\u7840","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_2","title":"\u6761\u4ef6\u5b8f","text":"<p>\u6761\u4ef6\u5b8f\u7684\u5de5\u4f5c\u539f\u7406\u662f\u5148\u68c0\u67e5\u5b8f\u662f\u5426\u5df2\u7ecf\u5b9a\u4e49\uff0c\u5982\u679c\u5df2\u7ecf\u5b9a\u4e49\u5219\u7f16\u8bd1<code>#ifdef</code>\u548c<code>#else</code>\u4e4b\u95f4\u7684\u4ee3\u7801\uff0c\u5426\u5219\u7f16\u8bd1<code>#else</code>\u548c<code>#endif</code>\u4e4b\u95f4\u7684\u4ee3\u7801\u3002</p> <p>\u6761\u4ef6\u5b8f\u7684\u5e38\u7528\u573a\u666f\u5305\u62ec\uff1a</p> <ol> <li>\u5e73\u53f0\u76f8\u5173\u4ee3\u7801\uff1a\u6839\u636e\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u6765\u7f16\u5199\u4e0d\u540c\u7684\u4ee3\u7801\u3002\u6bd4\u5982\uff1a</li> </ol> <pre><code>#ifdef _WIN32\n    // Windows\u5e73\u53f0\u4e0b\u7684\u4ee3\u7801\n#elif __linux__\n    // Linux\u5e73\u53f0\u4e0b\u7684\u4ee3\u7801\n#elif __APPLE__\n    // macOS\u5e73\u53f0\u4e0b\u7684\u4ee3\u7801\n#else\n    // \u5176\u4ed6\u5e73\u53f0\u4e0b\u7684\u4ee3\u7801\n#endif\n</code></pre> <ol> <li>\u7279\u5b9a\u529f\u80fd\u7684\u5f00\u5173\uff1a\u6839\u636e\u5b8f\u7684\u5b9a\u4e49\u4e0e\u5426\u6765\u9009\u62e9\u6027\u5730\u7f16\u8bd1\u67d0\u4e9b\u529f\u80fd\u4ee3\u7801\u3002\u6bd4\u5982\uff1a</li> </ol> <pre><code>#ifdef DEBUG\n    // \u8c03\u8bd5\u6a21\u5f0f\u4e0b\u7684\u4ee3\u7801\n#endif\n\n#ifndef NDEBUG\n    // \u975e\u8c03\u8bd5\u6a21\u5f0f\u4e0b\u7684\u4ee3\u7801\n#endif\n</code></pre> <p>\u5728\u4ee3\u7801\u4e2d\uff0c<code>DEBUG</code>\u548c<code>NDEBUG</code>\u90fd\u662f\u9884\u5b9a\u4e49\u7684\u5b8f\uff0c\u5728\u7f16\u8bd1\u65f6\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4\u884c\u53c2\u6570\u6216\u8005IDE\u5de5\u5177\u7684\u8bbe\u7f6e\u6765\u51b3\u5b9a\u662f\u5426\u5b9a\u4e49\u8fd9\u4e9b\u5b8f\uff0c\u4ece\u800c\u9009\u62e9\u6027\u5730\u7f16\u8bd1\u8c03\u8bd5\u76f8\u5173\u7684\u4ee3\u7801\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6761\u4ef6\u5b8f\u53ea\u80fd\u5728\u9884\u7f16\u8bd1\u9636\u6bb5\u8d77\u4f5c\u7528\uff0c\u5373\u5728\u6e90\u4ee3\u7801\u88ab\u7f16\u8bd1\u4e4b\u524d\u8fdb\u884c\u5904\u7406\u3002\u4e00\u65e6\u5b8f\u88ab\u5b9a\u4e49\u6216\u672a\u5b9a\u4e49\uff0c\u5b83\u5728\u6574\u4e2a\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u90fd\u4fdd\u6301\u4e0d\u53d8\u3002\u56e0\u6b64\uff0c\u5728\u4e0d\u540c\u7684\u7f16\u8bd1\u5355\u5143\u4e2d\u5b9a\u4e49\u6216\u53d6\u6d88\u5b9a\u4e49\u540c\u4e00\u4e2a\u5b8f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e0d\u4e00\u81f4\u7684\u884c\u4e3a\u3002</p> <p>\u6b64\u5916\uff0c\u6761\u4ef6\u5b8f\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>#ifndef</code>\uff08\u5373\u201c\u5982\u679c\u672a\u5b9a\u4e49\u201d\uff09\u6765\u5224\u65ad\u5b8f\u662f\u5426\u672a\u5b9a\u4e49\u3002\u4f8b\u5982\uff1a</p> <pre><code>#ifndef \u5b8f\u540d\n    // \u5982\u679c\u5b8f\u672a\u88ab\u5b9a\u4e49\uff0c\u5219\u7f16\u8bd1\u8fd9\u90e8\u5206\u4ee3\u7801\n#endif\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_3","title":"\u6784\u9020\u51fd\u6570","text":"<pre><code>struct S {\n    // \u6211\u4e0d\u60f3\u81ea\u5df1\u5199\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\uff0c\u5c31\u6309\u7167\u9884\u7f6e\u7684\u6765\u5c31\u884c\n    S() = default;\n    // \u9ed8\u8ba4\u521d\u59cb\u5316\u6240\u6709\u6210\u5458\uff08\u8c03\u7528\u9ed8\u8ba4\u6784\u9020\u6216\u4e0d\u521d\u59cb\u5316\uff09\n\n\n    // \u6211\u4e5f\u4e0d\u60f3\u81ea\u5df1\u5199\u590d\u5236\u6784\u9020\u51fd\u6570\uff0c\u5c31\u6309\u7167\u9884\u7f6e\u7684\u6765\u5c31\u884c\n    S(const S&amp;) = default;\n    // \u590d\u5236\u521d\u59cb\u5316\u6240\u6709\u6210\u5458\uff08\u8c03\u7528\u590d\u5236\u6784\u9020\u6216\u76f4\u63a5\u590d\u5236\uff09\n\n    S(/* \u5176\u5b83\u6784\u9020\u51fd\u6570 */) { /* [...] */ }\n};\n</code></pre> <pre><code>struct S {\n    // \u4e0d\u8bb8\u751f\u6210\u9ed8\u8ba4\u6784\u9020\u51fd\u6570\n    S() = delete;\n};\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#static","title":"static \u9759\u6001\u53d8\u91cf","text":"<p>\u5f53\u58f0\u660e\u4e00\u4e2a\u9759\u6001\u65b9\u6cd5\u6216\u8005\u9759\u6001\u53d8\u91cf\uff0c\u8fd9\u4e2a\u9759\u6001\u65b9\u6cd5\u6216\u9759\u6001\u53d8\u91cf\u53ea\u80fd\u5728\u8be5cpp\u6587\u4ef6\u4e2d\u4f7f\u7528\uff0c\u800c\u4e0d\u80fd\u591f\u88ab\u5176\u4ed6cpp\u6587\u4ef6\u6240\u4f7f\u7528\u3002\u9664\u975e\u4e24\u4e2a\u6587\u4ef6\u58f0\u660e\u4e86\u4e24\u4e2a\u540d\u5b57\u76f8\u540c\u7684\u53d8\u91cf\uff0c\u5e76\u90fd\u4e3a\u9759\u6001\u53d8\u91cf</p> <p>\u9759\u6001\u6210\u5458\u53d8\u91cf\u5728\u7f16\u8bd1\u65f6\u5b58\u50a8\u5728\u9759\u6001\u5b58\u50a8\u533a\uff0c\u5373\u5b9a\u4e49\u8fc7\u7a0b\u5e94\u8be5\u5728\u7f16\u8bd1\u65f6\u5b8c\u6210\uff0c\u56e0\u6b64\u4e00\u5b9a\u8981\u5728\u7c7b\u5916\u8fdb\u884c\u5b9a\u4e49\uff0c\u4f46\u53ef\u4ee5\u4e0d\u521d\u59cb\u5316\u3002 \u9759\u6001\u6210\u5458\u53d8\u91cf\u662f\u6240\u6709\u5b9e\u4f8b\u5171\u4eab\u7684\uff0c\u4f46\u662f\u5176\u53ea\u662f\u5728\u7c7b\u4e2d\u8fdb\u884c\u4e86\u58f0\u660e\uff0c\u5e76\u672a\u5b9a\u4e49\u6216\u521d\u59cb\u5316\uff08\u5206\u914d\u5185\u5b58\uff09\uff0c\u7c7b\u6216\u8005\u7c7b\u5b9e\u4f8b\u5c31\u65e0\u6cd5\u8bbf\u95ee\u9759\u6001\u6210\u5458\u53d8\u91cf\uff0c\u8fd9\u663e\u7136\u662f\u4e0d\u5bf9\u7684\uff0c\u6240\u4ee5\u5fc5\u987b\u5148\u5728\u7c7b\u5916\u90e8\u5b9a\u4e49\uff0c\u4e5f\u5c31\u662f\u5206\u914d\u5185\u5b58</p> <pre><code>class Entity {\npublic:\n    static int x;\n    static int y;\n    void Print() {\n        std::cout &lt;&lt; x &lt;&lt; \" \" &lt;&lt; y &lt;&lt; std::endl;\n    }\n};\nint Entity::x;\nint Entity::y;\n\nEntity e;\ne.x = 1;\n\nEntity::x = 2;\n</code></pre> <p>\u9759\u6001\u65b9\u6cd5\u4e0d\u80fd\u8bbf\u95ee\u975e\u9759\u6001\u53d8\u91cf\uff0c\u56e0\u4e3a\u9759\u6001\u65b9\u6cd5\u6ca1\u6709\u7c7b\u5b9e\u4f8b</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#static_1","title":"\u5c40\u90e8 static","text":"<p>\u53ea\u80fd\u88ab\u51fd\u6570\u6539\u53d8</p> <pre><code>void Function() {\n    static int i = 0;\n    i++;\n    std::cout&lt;&lt;i&lt;&lt;std::endl;\n}\n\nint main() {\n    Function(); // 1\n    Function(); // 2\n    Function(); // 3\n    Function(); // 4\n    Function(); // 5\n    return 0;\n}\n</code></pre> <p>\u901a\u8fc7\u4f7f\u7528static\uff0c\u5b9e\u9645\u4e0a\u53ef\u4ee5\u5ef6\u957f\u53d8\u91cf\u7684\u751f\u5b58\u671f</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#enum","title":"enum \u679a\u4e3e","text":"<p>\u53ea\u80fd\u4e3a\u6574\u6570</p> <pre><code>enum xxx {\n    A, B, C\n}; // 0, 1, 2\n\nxxx a = 2; // 0 ~ 2\n</code></pre> <p>\u8bbe\u7f6e\u6574\u6570\u7684\u7c7b\u578b</p> <pre><code>enum xxx : unsigned char {\n    A, B, C\n};\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_4","title":"\u7ee7\u627f","text":"<p>\u4e0b\u8ff0\u4ee3\u7801\u4e2d\u7684Player\u7c7b\u662fEntity\u7c7b\u7684\u8d85\u96c6\uff0c\u53ef\u4ee5\u88ab\u5f53\u4f5cEntity\u7c7b\u4f7f\u7528 <pre><code>class Entity {\npublic:\n    float x, y;\n\n    void Move(float xa, float ya) {\n        x += xa;\n        y += ya;\n    }\n\n    void print() {\n        std::cout &lt;&lt; x &lt;&lt; \", \" &lt;&lt; y &lt;&lt; std::endl;\n    }\n};\n\nclass Player : public Entity { //\u6ca1\u6709 public \u65f6\uff0c\u9ed8\u8ba4\u4e3aprivate\npublic:\n    const char* Name;\n\n    void PrintName() {\n        std::cout &lt;&lt; Name &lt;&lt; std::endl;\n    }\n};\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_5","title":"\u865a\u51fd\u6570","text":"<p>[!note] \u4f7f\u7528\u865a\u51fd\u6570\u53ef\u80fd\u4f1a\u635f\u5931\u4e00\u5b9a\u7684\u6027\u80fd\uff0c\u4f46\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6ca1\u6709\u5f71\u54cd</p> <pre><code>class Entity {\nprivate:\npublic:\n    std::string GetName() {\n        return \"Entity\";\n    }\n};\n\nclass Player : public Entity {\nprivate:\n    std::string m_Name;\n\npublic:\n    Player(const std::string&amp; name) :\n        m_Name(name) {\n    }\n\n    std::string GetName() {\n        return m_Name;\n    }\n};\n\nint main() {\n    Entity* e = new Entity();\n    std::cout &lt;&lt; e-&gt;GetName() &lt;&lt; std::endl; // \"Entity\"\n\n    Player* p = new Player(\"Piako\");\n    std::cout &lt;&lt; p-&gt;GetName() &lt;&lt; std::endl; // \"Piako\"\n\n    Entity* entity = p;\n\n    std::cout &lt;&lt; entity-&gt;GetName() &lt;&lt; std::endl; // \"Entity\"\n\n    return 0;\n}\n</code></pre> <p>\u5c3d\u7ba1entity\u5b9e\u9645\u4e0a\u662fPlayer\u6307\u9488\uff0c\u4f46\u8fd8\u662f\u88ab\u5f53\u4f5c\u4e86Entity\u7c7b\u578b\u3002</p> <p>\u53ef\u4ee5\u901a\u8fc7\u6dfb\u52a0virtual\u5173\u952e\u5b57\uff0c\u521b\u5efav\u8868\uff0c\u4f7f\u5f97\u5176\u53ef\u4ee5\u6309\u7167\u9884\u671f\u5de5\u4f5c\u3002</p> <pre><code>virtual std::string GetName() {\n    return \"Entity\";\n}\n</code></pre> <p>[!info] \u5728C++ 11 \u4e2d\u6dfb\u52a0\u4e86override\u6807\u8bb0\uff0c\u63d0\u9ad8\u4ee3\u7801\u53ef\u8bfb\u6027,\u5e2e\u52a9\u68c0\u67e5\u4ee3\u7801 </p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_6","title":"\u7eaf\u865a\u51fd\u6570","text":"<p>\u7c7b\u4f3c\u4e8e\u5176\u4ed6\u51fd\u6570\u4e2d\u7684\u62bd\u8c61\u65b9\u6cd5\u6216\u63a5\u53e3\u3002\u5f3a\u5236\u5b50\u7c7b\u53bb\u5b9e\u73b0\u672a\u5b9e\u73b0\u7684\u65b9\u6cd5\u3002</p> <pre><code>class Entity {\npublic:\n    virtual void printName() = 0;\n};\n\n\nclass Player:public Entity {\npublic:\n    // void printName() {\n    //     std::printf(\"EEE\");\n    // }\n    void print() {\n        std::printf(\"Hello\\n\");\n    }\n};\n</code></pre> <p>Player\u7c7b\u578b\u5fc5\u987b\u5b9e\u73b0printName\u65b9\u6cd5\uff0c\u5426\u5219\u5b83\u4e5f\u5c06\u662f\u7eaf\u865a\u51fd\u6570\uff0c\u65e0\u6cd5\u5b9e\u4f8b\u5316\u3002</p> <p></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_7","title":"\u53ef\u89c1\u6027","text":"<p><code>public</code> \u7686\u53ef\u89c1</p> <p><code>protected</code> \u7ee7\u627f\u4f53\u7cfb\u53ef\u89c1\uff0c\u7c7b\u5916\u4e0d\u53ef\u89c1</p> <p><code>private</code> \u7c7b\u5185\u4e0e\u53cb\u5143\u53ef\u89c1\uff0c\u7c7b\u5916\u4e0d\u53ef\u89c1</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_8","title":"\u5b57\u7b26\u4e32","text":"<p><code>const char*</code> <code>string</code></p> <pre><code>const char* name = \"Piako\";\nconst wchar_t* name2 = L\"Piako\";\nconst char16_t* name3 = u\"Piako\";\nconst char32_t* name4 = U\"Piako\";\n</code></pre> <p>std::string_literals <code>string(\"Piako\") -&gt; \"Piako\"s</code></p> <p>R\"xxx\" \u4e0d\u8003\u8651\u8f6c\u4e49\u5b57\u7b26</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#const","title":"const","text":"<p>\u5e38\u91cf\u6307\u9488 <code>const int* a</code> \u4e0e <code>int const* a</code> \u4f5c\u7528\u76f8\u540c\u8ba9\u6307\u9488\u6307\u5411\u7684\u7a7a\u95f4\u65e0\u6cd5\u88ab\u6539\u53d8</p> <p>\u6307\u9488\u5e38\u91cf <code>int* const a</code> \u6307\u9488\u672c\u8eab\u65e0\u6cd5\u88ab\u6539\u53d8</p> <p>\u627f\u8bfa\u8be5\u51fd\u6570\u4e0d\u4f1a\u4fee\u6539\u503c <pre><code>getX() const {\n    return x;\n}\n</code></pre></p> <p>\u5e38\u91cf\u5bf9\u8c61\u53ea\u80fd\u8c03\u7528\u5e38\u91cf\u51fd\u6570\uff0c\u5982\u679c\u6709\u4e24\u4e2a\u540c\u540d\u7684\u51fd\u6570\uff0c\u8be5\u5bf9\u8c61\u5c06\u4f1a\u8c03\u7528\u5f53\u4e2d\u5e38\u91cf\u51fd\u6570</p> <pre><code>class Entity {\nprivate:\n    int m_x;\n    mutable int conut = 0;\npublic:\n    int getX() const {\n        count ++;\n        return m_x;\n    }\n    int getX() {\n        return m_x;\n    }\n};\n\n\nvoid print(const Entity&amp; e) {\n    std::cout&lt;&lt; e.getX() &lt;&lt; std::endl;\n}\n</code></pre> <p>mutable\u5141\u8bb8\u51fd\u6570\u662f\u5e38\u91cf\u65b9\u6cd5\uff0c\u4f46\u53ef\u4ee5\u4fee\u6539\u53d8\u91cf.</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_9","title":"\u6210\u5458\u5217\u8868","text":"<pre><code>class Entity {\nprivate:\n    std::string m_Name;\n    int m_x;\n    mutable int conut = 0;\npublic:\n    Entity() : m_Name(\"Unknown\"),m_x(5) {\n        // xxxx\n    }\n\n};\n</code></pre> <p>\u5192\u53f7\u540e\u7684\u5185\u5bb9\uff0c\u6bcf\u6b21\u6267\u884c\u8fd9\u4e2a\u51fd\u6570\u90fd\u4f1a\u5148\u6267\u884c\u4e00\u6b21\u3002</p> <p>\u56e0\u6b64\u7f16\u5199\u6210\u5458\u5217\u8868\u9700\u8981\u6309\u7167\u53d8\u91cf\u7684\u58f0\u660e\u987a\u5e8f\u3002</p> <p>\u4f7f\u7528\u6210\u5458\u5217\u8868\u53ef\u4ee5\u907f\u514d\u5728\u6784\u9020\u5bf9\u8c61\u4e2d\u7684\u5bf9\u8c61\u5143\u7d20\u65f6\u91cd\u590d\u6784\u9020 <pre><code>class Example {\n    private:\n    int x;\npublic:\n    Example(int x) {\n        this-&gt;x = x;\n        std::cout&lt;&lt;\"Create \"&lt;&lt; x&lt;&lt;std::endl;\n    }\n    Example() {\n\n        std::cout &lt;&lt; \"Create\" &lt;&lt; std::endl;\n    }\n};\n\nclass Entity {\nprivate:\n    std::string name;\n    Example e;\npublic:\n    Entity() {\n        name = \"Hello\";\n        e = Example(6); // \u53d1\u751f\u91cd\u590d\u6784\u9020\n    }\n};\n</code></pre></p> <pre><code>Entity(): e(Example(6)) {\n    name = \"Hello\";\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_10","title":"\u9690\u5f0f\u8f6c\u6362","text":"<pre><code>class Entity {\nprivate:\n    std::string m_name;\n    int m_age;\n\npublic:\n    Entity(const std::string&amp; name) :\n        m_name(name), m_age(-1) {\n    }\n    Entity(int age) :\n        m_name(\"unknown\"), m_age(age) {\n    }\n};\n\nvoid PrintEntity(const Entity&amp; entity) {\n    // Printing\n}\n\nint main() {\n    PrintEntity(45);\n\n    Entity a = std::string(\"Piako\");\n    Entity b = 22;\n\n    return 0;\n}\n</code></pre> <p><code>explicit</code> \u7528\u4e8e\u7981\u7528\u9690\u5f0f\u8f6c\u6362,\u5fc5\u987b\u663e\u5f0f\u5730\u8c03\u7528\u6784\u9020\u51fd\u6570\u3002</p> <pre><code>class Entity {\nprivate:\n    std::string m_name;\n    int m_age;\n\npublic:\n    Entity(const std::string&amp; name) :\n        m_name(name), m_age(-1) {\n    }\n    Entity(int age) :\n        m_name(\"unknown\"), m_age(age) {\n    }\n};\n\nvoid PrintEntity(const Entity&amp; entity) {\n    // Printing\n}\n\nint main() {\n    PrintEntity(45);\n\n    Entity a = std::string(\"Piako\");\n    Entity b = 22;\n\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_11","title":"\u57df\u6307\u9488\u5b9e\u73b0","text":"<p>\u5728\u5806\u4e0a\u521b\u5efa\u5bf9\u8c61\uff0c\u5e76\u80fd\u4ee5\u201c\u6808\u201d\u4e0a\u5bf9\u8c61\u7684\u65b9\u5f0f\u81ea\u52a8\u9500\u6bc1\u3002</p> <pre><code>class Entity\n{\npublic:\n    Entity()\n    {\n        std::cout &lt;&lt;\"Created\" &lt;&lt;std::endl;\n    }\n\n    ~Entity()\n    {\n        std::cout&lt;&lt;\"Destroyed\"&lt;&lt; std::endl;\n    }\n};\n\n\nclass ScopedPtr\n{\nprivate:\n    Entity *m_ptr;\n\npublic:\n    ScopedPtr(Entity *ptr) : m_ptr(ptr) {}\n    ~ScopedPtr()\n    {\n        delete m_ptr;\n    }\n\n};\n\n\n\nint main()\n{\n    {   // Entity* e = new Entity(); \u4e0d\u4f1a\u5728\u4f5c\u7528\u57df\u7ed3\u675f\u540e\u88ab\u81ea\u52a8\u9500\u6bc1\n        ScopedPtr e = new Entity(); //\u5728\u5806\u4e0a\u521b\u5efaEntity \n    }\n    // ScopedPtr\u7684\u4f5c\u7528\u57df\u7ed3\u675f\uff0cEntity\u5bf9\u8c61\u88ab\u81ea\u52a8delete\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_12","title":"\u667a\u80fd\u6307\u9488","text":"<p>\u5934\u6587\u4ef6<code>&lt;memory&gt;</code></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#unique_ptr","title":"unique_ptr","text":"<p><code>unique_ptr</code> \u662f\u4f5c\u7528\u57df\u6307\u9488\uff0c\u5f53\u8d85\u51fa\u4f5c\u7528\u57df\u65f6\uff0c\u5bf9\u8c61\u5c31\u4f1a\u88ab\u81ea\u52a8\u9500\u6bc1\uff0c</p> <p>\u53ea\u80fd\u6709\u4e00\u4e2a\uff0c\u5426\u5219\u4f1a\u53d1\u751f\u51b2\u7a81\u3002\u4e0d\u5141\u8bb8\u88ab\u590d\u5236</p> <p>\u56e0\u4e3a <code>unique_ptr</code> \u662f <code>explicit</code> \u7684\uff0c\u6240\u4ee5\u5fc5\u987b\u663e\u5f0f\u5730\u8c03\u7528\u6784\u9020\u51fd\u6570</p> <pre><code>std::unique_ptr&lt;Entity&gt; entity(new Entity());\n</code></pre> <p>\u66f4\u597d\u7684\u5b9e\u73b0\u65b9\u6cd5  C++14 \u652f\u6301</p> <pre><code>std::unique_ptr&lt;Entity&gt; entity = std::make_unique&lt;Entity&gt;();\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#shared_ptr","title":"shared_ptr","text":"<p><code>shared_ptr</code> \u901a\u8fc7\u5f15\u7528\u8ba1\u6570\u6765\u63a7\u5236\u5bf9\u8c61\u3002\u5f53\u5f15\u7528\u8ba1\u6570\u4e3a\u96f6\u65f6\uff0c\u5bf9\u8c61\u88ab\u9500\u6bc1</p> <p>[!note] <code>shared_ptr</code> \u7684\u8ba1\u6570\u7cfb\u7edf\u4f1a\u589e\u52a0\u5f00\u9500</p> <pre><code>{\n    std::shared_ptr&lt;Entity&gt; e0;\n    {\n        std::shared_ptr&lt;Entity&gt; sharedEntity = std::make_shared&lt;Entity&gt;(); // Print: Created Entity.\n        e0 = sharedEntity;\n    }\n} // Print: Destroyed Entity.\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#weak_ptr","title":"weak_ptr","text":"<p>\u5f53shared_ptr\u8d4b\u503c\u7ed9weak_ptr\u65f6\uff0c\u4e0d\u4f1a\u589e\u52a0\u5f15\u7528\u8ba1\u6570\u3002weak_ptr\u4ec5\u4ec5\u662f\u58f0\u660e\u8fd9\u4e2a\u5bf9\u8c61\u8fd8\u5b58\u6d3b\uff0c\u4e0d\u4f1a\u4fdd\u6301\u5bf9\u8c61\u7684\u5b58\u6d3b\u3002\u5f80\u5f80\u7528\u4e8e\u67e5\u770b\u5bf9\u8c61\u7684\u60c5\u51b5\u3002</p> <p>\u5728\u4f7f\u7528\u65f6\u4f18\u5148\u4f7f\u7528unique_ptr\uff0c\u5176\u6b21\u624d\u662fshared_ptr\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_13","title":"\u6d45\u62f7\u8d1d\u548c\u6df1\u62f7\u8d1d","text":"<p>\u5f53\u4e24\u4e2a\u5bf9\u8c61\u590d\u5236\u65f6\uff0cC++\u9ed8\u8ba4\u4f1a\u76f4\u63a5\u590d\u5236\u5143\u7d20\u503c\uff0c\u7136\u800c\u5f53\u5143\u7d20\u4e3a\u6307\u9488\u65f6\uff0c\u8fd9\u6837\u4f1a\u4f7f\u4e24\u4e2a\u5bf9\u8c61\u7684\u5143\u7d20\u6307\u5411\u540c\u4e00\u5757\u5185\u5b58\u7a7a\u95f4\u3002</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;ostream&gt;\n#include &lt;string&gt;\n#include &lt;cstring&gt;\n\nclass String {\nprivate:\n    char *m_Buffer; //pointer\n    unsigned int m_Size;\n\npublic:\n    String(const char *string) {\n        m_Size = strlen(string);\n        m_Buffer = new char[m_Size+1];\n        memcpy(m_Buffer, string, m_Size + 1);\n        m_Buffer[m_Size] = 0;\n    }\n\n    ~String() {\n        delete [] m_Buffer;\n    }\n\n    friend std::ostream &amp;operator&lt;&lt;(std::ostream &amp;stream, const String &amp;string);\n};\n\n\nstd::ostream &amp;operator&lt;&lt;(std::ostream &amp;stream, const String &amp;string) {\n    stream &lt;&lt; string.m_Buffer;\n    return stream;\n}\n\n\nint main() {\n    String str= \"Piako\";\n    String second = str; \n    std::cout&lt;&lt;str&lt;&lt;std::endl;\n\n    return 0;\n}// free(): double free detected in tcache 2\n</code></pre> <p>\u6b64\u65f6\u5c31\u9700\u8981\u5b9e\u73b0\u6df1\u62f7\u8d1d</p> <ol> <li>\u5b9e\u73b0C++\u4e2d\u7684\u62f7\u8d1d\u6784\u9020\u51fd\u6570</li> <li>\u91cd\u8f7d\u8fd0\u7b97\u7b26</li> </ol> <pre><code>String(const String &amp;other) :\n    m_Size(other.m_Size)\n{\n    m_Buffer = new char[m_Size + 1];\n    memcpy(m_Buffer, other.m_Buffer, m_Size+1);\n}\n\n// ...\n\nString second = str; \n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#vector","title":"Vector","text":"<p><code>.reserve()</code> \u8bbe\u5b9avector\u5927\u5c0f <code>.emplace_back()</code> \u7528\u8bbe\u5b9a\u7684\u53c2\u6570\u6784\u9020\u5bf9\u8c61\uff0c\u6bd4<code>.push_back()</code>\u6548\u7387\u66f4\u9ad8</p> <p>C++17\u524d <pre><code>std::vector&lt;int&gt; v = {4, 3, 2, 1};\n</code></pre></p> <p>C++17\u540e <pre><code>std::vector&lt;int&gt; v = {4, 3, 2, 1}; // CTAD \u7f16\u8bd1\u671f\u53c2\u6570\u63a8\u65ad\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#template","title":"Template \u6a21\u677f","text":"<p>C++ Template</p> <p>C++20 \u6a21\u677f</p> <pre><code>template &lt;typename T&gt;\nvoid func(T value)\n{\n\n}\n</code></pre> <p>[!note] <code>template &lt;class T&gt;</code> \u548c <code>template &lt;typename T&gt;</code> \u5b8c\u5168\u7b49\u4ef7</p> <p>\u53ea\u6709\u8c03\u7528Template\u65f6\uff0c\u624d\u4f1a\u5728\u7f16\u8bd1\u65f6\u771f\u6b63\u751f\u6210Template\u7684\u4ee3\u7801\u3002</p> <pre><code>template &lt;typename T, int N&gt;\nclass Array\n{\nprivate:\n    T m_Array[N];\n\npublic:\n    int GetSize() const { return N; }\n};\n\nint main()\n{\n    Array&lt;std::string, 5&gt; array;\n    std::cout &lt;&lt; array.GetSize() &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_14","title":"\u81ea\u52a8\u63a8\u5bfc\u53c2\u6570\u7c7b\u578b","text":"<pre><code>template &lt;typename T&gt;\nvoid my_swap(T &amp;a, T &amp;b) // \u975e\u4f18\u5148\u8c03\u7528\n{\n    auto temp = a;\n    a = b;\n    b = temp;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_15","title":"\u7279\u5316\u7684\u91cd\u8f7d","text":"<pre><code>#include &lt;iostream&gt;\n\ntemplate &lt;typename  T&gt;\nT twice(T t) {\n    return t * 2;\n}\n\nstd::string twice(std::string t) {\n    return t + t;\n}\n\nint main() {\n    std::cout&lt;&lt;twice(2.3)&lt;&lt;std::endl;\n    std::cout&lt;&lt;twice(std::string(\"Hello\"))&lt;&lt;std::endl; // \u4e0d\u4f1a\u9690\u5f0f\u8f6c\u6362\n    return 0;\n}\n</code></pre> <p>C++\u6a21\u677f\u8fdb\u9636\u6307\u5357\uff1aSFINAE - \u77e5\u4e4e</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_16","title":"\u9ed8\u8ba4\u53c2\u6570\u7c7b\u578b","text":"<p>\u5982\u679c\u6a21\u677f\u7c7b\u578b\u53c2\u6570 T \u6ca1\u6709\u51fa\u73b0\u5728\u51fd\u6570\u7684\u53c2\u6570\u4e2d\uff0c\u90a3\u4e48\u7f16\u8bd1\u5668\u5c31\u65e0\u6cd5\u63a8\u65ad\uff0c\u5c31\u4e0d\u5f97\u4e0d\u624b\u52a8\u6307\u5b9a <pre><code>template &lt;typename  T = int&gt;\nT two() {\n    return 2;\n}\n\nint main() {\n    std::cout&lt;&lt;two()&lt;&lt;std::endl;\n    return 0;\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_17","title":"\u6a21\u7248\u53c2\u6570\uff08\u53ea\u652f\u6301\u6574\u6570\uff09","text":"<pre><code>template &lt;int N&gt;\nvoid echo_times(std::string str)\n{\n    for (int i = 0; i &lt; N; i++)\n    {\n        std::cout &lt;&lt; str &lt;&lt; std::endl;\n    }\n}\n\nint main()\n{\n    echo_times&lt;3&gt;(\"Hello\");\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_18","title":"\u5e38\u7528\u6570\u503c\u7b97\u6cd5","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#for_each","title":"for_each","text":"<pre><code>int sum = 0;\n\nvoid func(int value)\n{\n    sum += value;\n}\n\nint main()\n{\n    std::vector&lt;int&gt; v = {4, 3, 2, 1};\n    std::for_each(v.begin(), v.end(), func);\n    std::cout &lt;&lt; sum &lt;&lt; std::endl; // 10\n\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#reduce","title":"reduce","text":"<p>c++17\u5f15\u5165</p> <pre><code>int main()\n{\n    std::vector&lt;int&gt; v = {4, 3, 2, 1};\n\n    int sum = std::reduce(v.begin(), v.end());\n    std::cout &lt;&lt; sum &lt;&lt; std::endl; // 10\n\n    return 0;\n}\n</code></pre> <pre><code>#include &lt;iostream&gt;\n#include &lt;numeric&gt;\n#include &lt;vector&gt;\n\nint main()\n{\n    std::vector&lt;int&gt; v = {4, 3, 2, 1};\n\n    int sum = std::reduce(v.begin(), v.end(),0,std::plus());\n    std::cout &lt;&lt; sum &lt;&lt; std::endl; // 10\n\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#stdfunction","title":"std::function","text":"<pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\n// \u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\nint add(int a, int b) {\n    return a + b;\n}\n\nint main() {\n    // \u4f7f\u7528 std::function \u5c01\u88c5\u4e00\u4e2a\u51fd\u6570\u6307\u9488\n    std::function&lt;int(int, int)&gt; func_ptr = &amp;add;\n    std::cout &lt;&lt; func_ptr(3, 4) &lt;&lt; std::endl;  // \u8f93\u51fa 7\n\n    // \u4f7f\u7528 std::function \u5c01\u88c5\u4e00\u4e2a Lambda \u8868\u8fbe\u5f0f\n    std::function&lt;int(int, int)&gt; func_lambda = [](int a, int b) { return a * b; };\n    std::cout &lt;&lt; func_lambda(3, 4) &lt;&lt; std::endl;  // \u8f93\u51fa 12\n\n    // \u4f7f\u7528 std::function \u5c01\u88c5\u4e00\u4e2a\u51fd\u6570\u5bf9\u8c61\n    struct MyAdd {\n        int operator()(int a, int b) {\n            return a + b;\n        }\n    };\n    std::function&lt;int(int, int)&gt; func_obj = MyAdd();\n    std::cout &lt;&lt; func_obj(3, 4) &lt;&lt; std::endl;  // \u8f93\u51fa 7\n\n    return 0;\n}\n</code></pre> <p>\u672a\u77e5\u7c7b\u578b\u3001\u6570\u91cf\u7684\u53c2\u6570\uff0c\u4ee5\u53ca\u672a\u77e5\u7c7b\u578b\u7684\u8fd4\u56de\u503c</p> <pre><code>template&lt;typename... Args, typename ReturnType&gt;\nstd::function&lt;ReturnType(Args...)&gt; create_function(ReturnType (*func)(Args...)) {\n    return std::function&lt;ReturnType(Args...)&gt;(func);\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#lambda","title":"lambda \u8868\u8fbe\u5f0f","text":"<p>lambda\u8868\u8fbe\u5f0f\u7684\u4e00\u822c\u5f62\u5f0f\u5982\u4e0b\uff1a <pre><code>[capture-list](parameters) -&gt; return-type {\n    // \u51fd\u6570\u4f53\n}\n</code></pre> \u5728<code>capture-list</code>\u4e2d\uff0c\u53ef\u4ee5\u6307\u5b9a\u4e00\u7ec4\u53d8\u91cf\uff0c\u8fd9\u4e9b\u53d8\u91cf\u53ef\u4ee5\u5728lambda\u8868\u8fbe\u5f0f\u4e2d\u88ab\u6355\u83b7\u5e76\u5728\u51fd\u6570\u4f53\u4e2d\u4f7f\u7528\u3002\u6355\u83b7\u53ef\u4ee5\u662f\u6309\u503c\uff08<code>[=]</code>\uff09\u6216\u6309\u5f15\u7528\uff08<code>[&amp;]</code>\uff09\u8fdb\u884c\u3002\u5f53\u7136\uff0c\u8fd8\u6709\u5176\u4ed6\u7684\u6355\u83b7\u65b9\u5f0f\uff0c\u5982\u6309\u503c\u6355\u83b7\u5355\u4e2a\u53d8\u91cf\uff08<code>[x]</code>\uff09\u6216\u6309\u5f15\u7528\u6355\u83b7\u5355\u4e2a\u53d8\u91cf\uff08<code>[&amp;x]</code>\uff09\u7b49\u3002</p> <p><code>parameters</code>\u662flambda\u8868\u8fbe\u5f0f\u7684\u53c2\u6570\u5217\u8868\uff0c\u53ef\u4ee5\u6307\u5b9a\u53c2\u6570\u7684\u7c7b\u578b\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>auto</code>\u8fdb\u884c\u7c7b\u578b\u63a8\u65ad\u3002</p> <p><code>return-type</code>\u662f\u8fd4\u56de\u7c7b\u578b\uff0c\u53ef\u4ee5\u4f7f\u7528<code>auto</code>\u8fdb\u884c\u7c7b\u578b\u63a8\u65ad\uff0c\u4e5f\u53ef\u4ee5\u663e\u5f0f\u6307\u5b9a\u3002</p> <pre><code>int main()\n{\n    std::vector&lt;int&gt; v = {4, 3, 2, 1};\n\n    int sum = 0;\n\n    std::for_each(v.begin(), v.end(),[&amp;] (int value){\n        sum += value;\n    });\n    std::cout &lt;&lt; sum &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre> <p>\u9012\u5f52 <pre><code>#include &lt;iostream&gt;\n#include &lt;functional&gt;\n\nint main() {\n    std::function&lt;int(int)&gt; factorial = [&amp;](int n) {\n        if (n == 0 || n == 1) {\n            return 1;\n        } else {\n            return n * factorial(n - 1);\n        }\n    };\n\n    std::cout &lt;&lt; factorial(5) &lt;&lt; std::endl;  // \u8f93\u51fa120\n\n    return 0;\n}\n</code></pre> <pre><code>C++14\u7684lambda\u8868\u8fbe\u5f0f\u5141\u8bb8\u4f7f\u7528auto\n```cpp\nint main()\n{\n    std::vector&lt;int&gt; v = {4, 3, 2, 1};\n\n    int sum = 0;\n\n    std::for_each(v.begin(), v.end(),[&amp;] (auto value){\n        sum += value;\n    });\n    std::cout &lt;&lt; sum &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_19","title":"\u5e76\u53d1\u7f16\u7a0b","text":"<p>\u5728C++\u4e2d\uff0c\u6709\u591a\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5b9e\u73b0\u5e76\u53d1\u7f16\u7a0b\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u65b9\u6cd5\uff1a</p> <ol> <li>\u591a\u7ebf\u7a0b\uff1a\u4f7f\u7528\u7ebf\u7a0b\u5e93\uff08\u5982std::thread\uff09\u521b\u5efa\u591a\u4e2a\u7ebf\u7a0b\u6765\u5e76\u53d1\u6267\u884c\u4efb\u52a1\u3002</li> <li>\u4e92\u65a5\u9501\uff1a\u4f7f\u7528\u4e92\u65a5\u9501\uff08\u5982std::mutex\uff09\u6765\u4fdd\u62a4\u5171\u4eab\u8d44\u6e90\uff0c\u4ee5\u907f\u514d\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u5bfc\u81f4\u7684\u6570\u636e\u7ade\u4e89\u3002</li> <li>\u6761\u4ef6\u53d8\u91cf\uff1a\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\uff08\u5982std::condition_variable\uff09\u53ef\u4ee5\u5b9e\u73b0\u7ebf\u7a0b\u95f4\u7684\u540c\u6b65\u548c\u901a\u4fe1\u3002</li> <li>\u539f\u5b50\u64cd\u4f5c\uff1a\u4f7f\u7528\u539f\u5b50\u64cd\u4f5c\uff08\u5982std::atomic\uff09\u6765\u4fdd\u8bc1\u5bf9\u5171\u4eab\u6570\u636e\u7684\u539f\u5b50\u6027\u64cd\u4f5c\uff0c\u907f\u514d\u51fa\u73b0\u6570\u636e\u7ade\u4e89\u3002</li> <li>\u5f02\u6b65\u7f16\u7a0b\uff1a\u4f7f\u7528\u5f02\u6b65\u4efb\u52a1\uff08\u5982std::async\uff09\u6765\u5b9e\u73b0\u4efb\u52a1\u7684\u5f02\u6b65\u6267\u884c\uff0c\u53ef\u4ee5\u5728\u4efb\u52a1\u5b8c\u6210\u4e4b\u524d\u7ee7\u7eed\u6267\u884c\u5176\u4ed6\u4efb\u52a1\u3002</li> <li>\u5e76\u884c\u7b97\u6cd5\uff1a\u4f7f\u7528\u5e76\u884c\u7b97\u6cd5\uff08\u5982std::for_each\u3001std::transform\u7b49\uff09\u53ef\u4ee5\u5e76\u53d1\u5730\u5904\u7406\u5927\u91cf\u6570\u636e\u3002</li> </ol> <p>\u8be6\u60c5\u53c2\u89c1  English:Concurrency support library (since C++11) - cppreference.com Chinese:\u5e76\u53d1\u652f\u6301\u5e93 - cppreference.com</p> <p>C++\u591a\u7ebf\u7a0b\u5e76\u53d1\u57fa\u7840\u5165\u95e8\u6559\u7a0b</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#thread","title":"thread","text":"<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\nusing namespace std;\n\n// basic_thread\n\nint x = 0;\n\nauto add_x() {\n    for (int i = 1; i &lt;= 10000; i++) {\n        x += 1;\n    }\n}\n\nauto print() {\n    cout&lt;&lt;\"value: \"&lt;&lt;x&lt;&lt;endl;\n} \n\n\n\nauto main() -&gt; int {\n    const int numThreads = 10000;\n    thread threads[numThreads];\n\n    for (int i = 0; i &lt; numThreads; i++) {\n        threads[i] = thread(add_x); // thread\u6784\u9020\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u51fd\u6570\u540d\uff0c\u4e4b\u540e\u7684\u53c2\u6570\u4e3a\u8fd9\u4e2a\u51fd\u6570\u7684\u53c2\u6570\n    }\n\n    for (int i = 0;i&lt;numThreads; i++) {\n        threads[i].join(); // \u5bf9\u7ebf\u7a0b\u8fdb\u884c\u963b\u585e\n    }\n\n    print();\n    return 0;\n}\n</code></pre> <p>detach()</p> <p><code>.detach()</code>\u65b9\u6cd5\u7528\u4e8e\u5c06\u7ebf\u7a0b\u4e0e\u4e3b\u7ebf\u7a0b\u5206\u79bb\u3002\u4e00\u65e6\u7ebf\u7a0b\u88ab\u5206\u79bb\uff0c\u5b83\u5c31\u53ef\u4ee5\u72ec\u7acb\u8fd0\u884c\uff0c\u4e0d\u518d\u4e0e\u4e3b\u7ebf\u7a0b\u5173\u8054\u3002\u4e3b\u7ebf\u7a0b\u4e0d\u4f1a\u7b49\u5f85\u88ab\u5206\u79bb\u7684\u7ebf\u7a0b\u7ed3\u675f\uff0c\u4e5f\u65e0\u6cd5\u83b7\u53d6\u88ab\u5206\u79bb\u7ebf\u7a0b\u7684\u8fd4\u56de\u503c\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\uff1a</p> <pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n\nvoid threadFunction() {\n    std::cout &lt;&lt; \"\u5b50\u7ebf\u7a0b\u5f00\u59cb\u8fd0\u884c\" &lt;&lt; std::endl;\n    // \u7ebf\u7a0b\u6267\u884c\u4e00\u4e9b\u4efb\u52a1\n    // ...\n    std::cout &lt;&lt; \"\u5b50\u7ebf\u7a0b\u7ed3\u675f\" &lt;&lt; std::endl;\n}\n\nint main() {\n    std::cout &lt;&lt; \"\u4e3b\u7ebf\u7a0b\u5f00\u59cb\" &lt;&lt; std::endl;\n    std::thread myThread(threadFunction);\n\n    myThread.detach(); // \u5206\u79bb\u7ebf\u7a0b\n\n    std::cout &lt;&lt; \"\u4e3b\u7ebf\u7a0b\u7ed3\u675f\" &lt;&lt; std::endl;\n    return 0;\n}\n</code></pre> <p>\u5728\u4e0a\u8ff0\u793a\u4f8b\u4e2d\uff0c\u4e3b\u7ebf\u7a0b\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a<code>myThread</code>\u7684\u5b50\u7ebf\u7a0b\uff0c\u5e76\u4f7f\u7528<code>.detach()</code>\u5c06\u5176\u5206\u79bb\u3002\u4e3b\u7ebf\u7a0b\u7ee7\u7eed\u6267\u884c\uff0c\u4e0d\u4f1a\u7b49\u5f85\u5b50\u7ebf\u7a0b\u7ed3\u675f\u3002\u56e0\u6b64\uff0c\u5f53\u4e3b\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u7a0b\u5e8f\u4f1a\u7acb\u5373\u7ec8\u6b62\uff0c\u800c\u4e0d\u7ba1\u5b50\u7ebf\u7a0b\u662f\u5426\u6267\u884c\u5b8c\u6bd5\u3002\u5f53\u5b50\u7ebf\u7a0b\u7684\u4efb\u52a1\u5b8c\u6210\u540e\uff0c\u5b83\u4f1a\u81ea\u52a8\u9000\u51fa\u3002</p> <p>\u8fd9\u4f1a\u4f7f\u7a0b\u5e8f\u4e0d\u53d1\u751f\u5982\u4e0b\u9519\u8bef <pre><code>terminate called without an active exception\n[2]    132526 IOT instruction (core dumped)\n</code></pre></p> <p>\u4f46\u53ef\u80fd\u8bbf\u95ee\u5df2\u7ecf\u9500\u6bc1\u7684\u53d8\u91cf\u3001\u9020\u6210\u66f4\u4e25\u91cd\u7684\u98ce\u9669</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#mutex","title":"mutex","text":"<pre><code>#include &lt;iostream&gt;\n#include &lt;mutex&gt;\n#include &lt;thread&gt;\n\nusing namespace std;\n\n// basic_mutex\n\nmutex m_lock;\n\nint x = 0;\n\nauto add_x() {\n    m_lock.lock();\n    for (int i = 1; i &lt;= 10000; i++) {\n        x += 1;\n    }\n    m_lock.unlock();\n}\n\nauto add_xx() {\n    lock_guard&lt;std::mutex&gt; lock(m_lock);\n    for (int i = 1; i &lt;= 10000; i++) {\n        x += 1;\n    }\n}\n\nauto print() {\n    cout&lt;&lt;\"value: \"&lt;&lt;x&lt;&lt;endl;\n} \n\n\n\nauto main() -&gt; int {\n    const int numThreads = 10000;\n    thread threads[numThreads];\n\n    for (int i = 0; i &lt; numThreads; i++) {\n        threads[i] = thread(add_x);\n    }\n\n    for (int i = 0;i&lt;numThreads; i++) {\n        threads[i].join();\n    }\n\n    print();\n    return 0;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#condition_variable","title":"condition_variable","text":"<p>\u6761\u4ef6\u53d8\u91cf\u901a\u5e38\u4e0e\u4e92\u65a5\u9501\uff08mutex\uff09\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u786e\u4fdd\u7ebf\u7a0b\u4e4b\u95f4\u7684\u6b63\u786e\u540c\u6b65\u3002\u4e92\u65a5\u9501\u7528\u4e8e\u4fdd\u62a4\u5171\u4eab\u6570\u636e\u7684\u8bbf\u95ee\uff0c\u800c\u6761\u4ef6\u53d8\u91cf\u7528\u4e8e\u7ebf\u7a0b\u4e4b\u95f4\u7684\u7b49\u5f85\u548c\u5524\u9192\u901a\u77e5\u3002 C++\u4e2d\u7684\u6761\u4ef6\u53d8\u91cf\u4e3b\u8981\u7531\u4ee5\u4e0b\u4e24\u4e2a\u7c7b\u7ec4\u6210\uff1a</p> <ol> <li><code>std::condition_variable</code>\uff1a\u6761\u4ef6\u53d8\u91cf\u7c7b\uff0c\u7528\u4e8e\u7b49\u5f85\u548c\u5524\u9192\u7ebf\u7a0b\u3002</li> <li><code>std::condition_variable_any</code>\uff1a\u901a\u7528\u6761\u4ef6\u53d8\u91cf\u7c7b\uff0c\u53ef\u4ee5\u4e0e\u4efb\u4f55\u4e92\u65a5\u91cf\u4e00\u8d77\u4f7f\u7528\u3002</li> </ol> <p>\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\uff0c\u9700\u8981\u8fdb\u884c\u4ee5\u4e0b\u6b65\u9aa4\uff1a</p> <ol> <li>\u521b\u5efa\u4e00\u4e2a\u6761\u4ef6\u53d8\u91cf\u5bf9\u8c61\u3002</li> <li>\u521b\u5efa\u4e00\u4e2a\u4e92\u65a5\u9501\u5bf9\u8c61\u6765\u4fdd\u62a4\u5171\u4eab\u6570\u636e\u3002</li> <li>\u5728\u7b49\u5f85\u7ebf\u7a0b\u4e2d\uff0c\u4f7f\u7528\u4e92\u65a5\u9501\u548c\u6761\u4ef6\u53d8\u91cf\u7684 <code>wait()</code> \u51fd\u6570\u7b49\u5f85\u6ee1\u8db3\u6761\u4ef6\u3002</li> <li>\u5728\u5524\u9192\u7ebf\u7a0b\u4e2d\uff0c\u7528\u4e92\u65a5\u9501\u9501\u5b9a\u5171\u4eab\u6570\u636e\uff0c\u7136\u540e\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\u7684 <code>notify_one()</code> \u6216 <code>notify_all()</code> \u51fd\u6570\u5524\u9192\u7b49\u5f85\u7ebf\u7a0b\u3002</li> <li>\u5728\u7b49\u5f85\u7ebf\u7a0b\u88ab\u5524\u9192\u540e\uff0c\u91cd\u65b0\u83b7\u53d6\u4e92\u65a5\u9501\uff0c\u7136\u540e\u68c0\u67e5\u6761\u4ef6\u662f\u5426\u6ee1\u8db3\uff0c\u5982\u679c\u4e0d\u6ee1\u8db3\uff0c\u5219\u7ee7\u7eed\u7b49\u5f85\u3002</li> </ol> <p><code>wait()</code>: \u7ebf\u7a0b\u8c03\u7528<code>wait()</code>\u65b9\u6cd5\u540e\uff0c\u4f1a\u8fdb\u5165\u7b49\u5f85\u72b6\u6001\uff0c\u76f4\u5230\u5176\u4ed6\u7ebf\u7a0b\u8c03\u7528\u4e86<code>notify_one()</code>\u6216<code>notify_all()</code>\u65b9\u6cd5\u6765\u5524\u9192\u5b83\u3002</p> <p><code>notify_one()</code>: \u5524\u9192\u4e00\u4e2a\u7b49\u5f85\u5728\u6761\u4ef6\u53d8\u91cf\u4e0a\u7684\u7ebf\u7a0b\u3002</p> <p><code>notify_all()</code>: \u5524\u9192\u6240\u6709\u7b49\u5f85\u5728\u6761\u4ef6\u53d8\u91cf\u4e0a\u7684\u7ebf\u7a0b\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\uff1a <pre><code>#include &lt;iostream&gt;\n#include &lt;queue&gt;\n#include &lt;thread&gt;\n#include &lt;condition_variable&gt;\n\nstd::queue&lt;int&gt; data_queue;\nstd::mutex mtx;\nstd::condition_variable cond;\n\nvoid producer()\n{\n    for (int i = 1; i &lt;= 10; ++i) {\n        std::this_thread::sleep_for(std::chrono::milliseconds(500));  // \u6a21\u62df\u751f\u4ea7\u65f6\u95f4\n        std::lock_guard&lt;std::mutex&gt; lock(mtx);\n        data_queue.push(i);\n        std::cout &lt;&lt; \"Produced: \" &lt;&lt; i &lt;&lt; std::endl;\n        cond.notify_all();  // \u901a\u77e5\u7b49\u5f85\u7684\u6d88\u8d39\u8005\u7ebf\u7a0b\n    }\n}\n\nvoid consumer()\n{\n    while (true) {\n        std::unique_lock&lt;std::mutex&gt; lock(mtx); // \u4f7fwait\u65f6\uff0c\u7ebf\u7a0b\u5904\u4e8e\u963b\u585e\u72b6\u6001\n        cond.wait(lock, []{ return !data_queue.empty(); });  // \u7b49\u5f85\u6761\u4ef6\u6ee1\u8db3\n        int data = data_queue.front();\n        data_queue.pop();\n        std::cout &lt;&lt; \"Consumed: \" &lt;&lt; data &lt;&lt; std::endl;\n    }\n}\n\nint main()\n{\n    std::thread producer_thread(producer);\n    std::thread consumer_thread(consumer);\n\n    producer_thread.join();\n    consumer_thread.join();\n\n    return 0;\n}\n</code></pre></p> <p>\u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c\u751f\u4ea7\u8005\u7ebf\u7a0b\u901a\u8fc7\u5faa\u73af\u4e0d\u65ad\u5730\u751f\u4ea7\u6570\u636e\uff0c\u5e76\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\u901a\u77e5\u7b49\u5f85\u7684\u6d88\u8d39\u8005\u7ebf\u7a0b\u3002\u6d88\u8d39\u8005\u7ebf\u7a0b\u5728\u6d88\u8d39\u6570\u636e\u524d\u7b49\u5f85\u6761\u4ef6\u53d8\u91cf\u7684\u6ee1\u8db3\uff0c\u4e00\u65e6\u6ee1\u8db3\u5c31\u6d88\u8d39\u6570\u636e\u3002\u4e24\u4e2a\u7ebf\u7a0b\u901a\u8fc7\u4e92\u65a5\u91cfmtx\u5bf9\u5171\u4eab\u8d44\u6e90data_queue\u8fdb\u884c\u4fdd\u62a4\uff0c\u4fdd\u8bc1\u6570\u636e\u7684\u6b63\u786e\u8bbf\u95ee\u3002</p> <p><code>.notify_all()</code> \u5524\u9192\u6240\u6709\u7b49\u5f85\u7684\u7ebf\u7a0b</p> <p><code>.notify_one()</code>  \u968f\u673a\u5524\u9192\u4e00\u4e2a\u7b49\u5f85\u7684\u7ebf\u7a0b</p> <p><code>wait()</code> </p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#scoped_lock","title":"scoped_lock","text":"<pre><code>// \u8fd9\u4e2a\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4f7f\u7528std::scoped_lock\u7684\u4e00\u4e2a\u5c0f\u4f8b\u5b50\u3002\n// std::scoped_lock\u662f\u4e00\u4e2a\u4e92\u65a5\u9501\u7684\u5305\u88c5\u7c7b\uff0c\u63d0\u4f9b\u4e86\u4e00\u79cdRAII\u98ce\u683c\u7684\u65b9\u6cd5\u6765\u83b7\u53d6\u548c\u91ca\u653e\u9501\u3002\n// \u8fd9\u610f\u5473\u7740\u5f53\u5bf9\u8c61\u88ab\u6784\u9020\u65f6\uff0c\u9501\u88ab\u83b7\u53d6\uff0c\u5f53\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\uff0c\u9501\u88ab\u91ca\u653e\u3002\n\n// \u5305\u542b\u7528\u4e8e\u6f14\u793a\u76ee\u7684\u7684std::cout\uff08\u6253\u5370\uff09\u3002\n#include &lt;iostream&gt;\n// \u5305\u542b\u4e92\u65a5\u9501\u5e93\u7684\u5934\u6587\u4ef6\u3002\n#include &lt;mutex&gt;\n// \u5305\u542b\u7ebf\u7a0b\u5e93\u7684\u5934\u6587\u4ef6\u3002\n#include &lt;thread&gt;\n\n// \u5b9a\u4e49\u4e00\u4e2a\u5168\u5c40\u8ba1\u6570\u53d8\u91cf\u548c\u4e24\u4e2a\u4e92\u65a5\u9501\uff0c\u4f9b\u4e24\u4e2a\u7ebf\u7a0b\u4f7f\u7528\u3002\nint count = 0;\nstd::mutex m;\n\n// add_count\u51fd\u6570\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u539f\u5b50\u5730\u5c06\u8ba1\u6570\u53d8\u91cf\u52a01\u3002\nvoid add_count() {\n  // std::scoped_lock\u7684\u6784\u9020\u51fd\u6570\u5141\u8bb8\u7ebf\u7a0b\u83b7\u53d6\u4e92\u65a5\u9501m\u3002\n  std::scoped_lock slk(m);\n  count += 1;\n\n  // \u4e00\u65e6add_count\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\uff0c\u5bf9\u8c61slk\u5c31\u8d85\u51fa\u4e86\u4f5c\u7528\u57df\uff0c\u5728\u5176\u6790\u6784\u51fd\u6570\u4e2d\u91ca\u653e\u4e86\u4e92\u65a5\u9501m\u3002\n}\n\n// main\u65b9\u6cd5\u4e0emutex.cpp\u4e2d\u7684\u76f8\u540c\u3002\u5b83\u6784\u9020\u7ebf\u7a0b\u5bf9\u8c61\uff0c\u5bf9\u4e24\u4e2a\u7ebf\u7a0b\u8fd0\u884cadd_count\uff0c\u7136\u540e\u6253\u5370\u6267\u884c\u540e\u7684\u8ba1\u6570\u7ed3\u679c\u3002\nint main() {\n  std::thread t1(add_count);\n  std::thread t2(add_count);\n  t1.join();\n  t2.join();\n\n  std::cout &lt;&lt; \"Printing count: \" &lt;&lt; count &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre> <p>scoped_lock\u662fC++11\u4e2d\u5f15\u5165\u7684\u7c7b\u6a21\u677f\uff0c\u53ef\u4ee5\u540c\u65f6\u7ba1\u7406\u591a\u4e2a\u4e92\u65a5\u91cf\u3002scoped_lock\u901a\u8fc7\u6784\u9020\u51fd\u6570\u63a5\u53d7\u591a\u4e2a\u4e92\u65a5\u91cf\uff0c\u5e76\u5728\u6784\u9020\u65f6\u5bf9\u8fd9\u4e9b\u4e92\u65a5\u91cf\u8fdb\u884c\u52a0\u9501\u64cd\u4f5c\u3002\u5728\u6790\u6784\u65f6\uff0cscoped_lock\u4f1a\u5bf9\u6240\u6709\u5df2\u52a0\u9501\u7684\u4e92\u65a5\u91cf\u8fdb\u884c\u89e3\u9501\u64cd\u4f5c\u3002scoped_lock\u53ef\u4ee5\u9632\u6b62\u5fd8\u8bb0\u89e3\u9501\u4e92\u65a5\u91cf\u800c\u4ea7\u751f\u6b7b\u9501\u7684\u60c5\u51b5\u3002</p> <p>lock_guard\u662fC++11\u4e4b\u524d\u7684\u7c7b\uff0c\u53ea\u80fd\u7ba1\u7406\u5355\u4e2a\u4e92\u65a5\u91cf\u3002lock_guard\u901a\u8fc7\u6784\u9020\u51fd\u6570\u63a5\u53d7\u4e00\u4e2a\u4e92\u65a5\u91cf\uff0c\u5e76\u5728\u6784\u9020\u65f6\u5bf9\u8be5\u4e92\u65a5\u91cf\u8fdb\u884c\u52a0\u9501\u64cd\u4f5c\u3002\u5728\u6790\u6784\u65f6\uff0clock_guard\u4f1a\u81ea\u52a8\u5bf9\u4e92\u65a5\u91cf\u8fdb\u884c\u89e3\u9501\u64cd\u4f5c\u3002lock_guard\u7684\u4f7f\u7528\u65b9\u5f0f\u66f4\u7b80\u6d01\uff0c\u4f46\u53ea\u80fd\u7ba1\u7406\u5355\u4e2a\u4e92\u65a5\u91cf\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#misc","title":"Misc","text":"<p>\u8bfb\u5199\u9501 <pre><code>/**\n * @file rwlock.cpp\n * @author Abigale Kim (abigalek)\n * @brief C++ STL std::shared_lock \u548c std::unique_lock \u7684\u6559\u7a0b\u4ee3\u7801\n * (\u7279\u522b\u662f\u5c06\u5b83\u4eec\u7528\u4f5c\u8bfb\u5199\u9501)\n */\n\n// \u867d\u7136C++\u6ca1\u6709\u4e13\u95e8\u7684\u8bfb\u5199\u9501\u5e93\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528 std::shared_mutex\u3001std::shared_lock \u548c std::unique_lock \u5e93\u6765\u6a21\u62df\u4e00\u4e2a\u3002\n// \u8fd9\u4e2a\u7a0b\u5e8f\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u5b83\u4eec\u4f5c\u4e3a\u8bfb\u5199\u9501\u7684\u7b80\u5355\u793a\u4f8b\u3002\n\n// std::shared_mutex \u662f\u4e00\u79cd\u5141\u8bb8\u5171\u4eab\u53ea\u8bfb\u9501\u548c\u72ec\u5360\u5199\u9501\u7684\u4e92\u65a5\u9501\u3002std::shared_lock \u53ef\u4ee5\u7528\u4f5c RAII \u98ce\u683c\u7684\u8bfb\u9501\uff0c\n// std::unique_lock \u53ef\u4ee5\u7528\u4f5c RAII \u98ce\u683c\u7684\u5199\u9501\u3002scoped_lock.cpp \u4e2d\u4ecb\u7ecd\u4e86 C++ \u4e2d\u7684 RAII \u98ce\u683c\u9501\u5b9a\u3002\n\n// \u5982\u679c\u4f60\u66f4\u613f\u610f\u56de\u987e\u8bfb\u5199\u9501\u7684\u6982\u5ff5\u548c\u8bfb\u5199\u5668\u95ee\u9898\uff0c\u53ef\u4ee5\u53c2\u8003\u8fd9\u91cc\u7684 15-213/513/613 \u8bb2\u4e49:\n// https://www.cs.cmu.edu/afs/cs/academic/class/15213-s23/www/lectures/25-sync-advanced.pdf\n\n// \u5305\u542b std::cout\uff08\u6253\u5370\uff09\u4ec5\u7528\u4e8e\u6f14\u793a\u76ee\u7684\u3002\n#include &lt;iostream&gt;\n// \u5305\u542b\u4e92\u65a5\u9501\u5e93\u5934\u6587\u4ef6\u3002\n#include &lt;mutex&gt;\n// \u5305\u542b\u5171\u4eab\u4e92\u65a5\u9501\u5e93\u5934\u6587\u4ef6\u3002\n#include &lt;shared_mutex&gt;\n// \u5305\u542b\u7ebf\u7a0b\u5e93\u5934\u6587\u4ef6\u3002\n#include &lt;thread&gt;\n\n// \u5b9a\u4e49\u4e00\u4e2a\u5168\u5c40 count \u53d8\u91cf\u548c\u4e00\u4e2a\u5171\u4eab\u4e92\u65a5\u9501\uff0c\u4f9b\u6240\u6709\u7ebf\u7a0b\u4f7f\u7528\u3002\n// std::shared_mutex \u662f\u4e00\u79cd\u5141\u8bb8\u5171\u4eab\u9501\u5b9a\u548c\u72ec\u5360\u9501\u5b9a\u7684\u4e92\u65a5\u9501\u3002\nint count = 0;\nstd::shared_mutex m;\n\n// \u8fd9\u4e2a\u51fd\u6570\u4f7f\u7528 std::shared_lock\uff08\u76f8\u5f53\u4e8e\u8bfb\u9501\uff09\u6765\u83b7\u53d6\u53ea\u8bfb\u7684\u5171\u4eab\u8bbf\u95ee count \u53d8\u91cf\uff0c\u5e76\u8bfb\u53d6 count \u53d8\u91cf\u7684\u503c\u3002\nvoid read_value() {\n  std::shared_lock lk(m);\n  std::cout &lt;&lt; \"Reading value \" + std::to_string(count) + \"\\n\" &lt;&lt; std::flush;\n}\n\n// \u8fd9\u4e2a\u51fd\u6570\u4f7f\u7528 std::unique_lock\uff08\u76f8\u5f53\u4e8e\u5199\u9501\uff09\u6765\u83b7\u53d6\u72ec\u5360\u8bbf\u95ee count \u53d8\u91cf\uff0c\u5e76\u4fee\u6539\u5176\u503c\u3002\nvoid write_value() {\n  std::unique_lock lk(m);\n  count += 3;\n}\n\n// \u4e3b\u51fd\u6570\u521b\u5efa\u4e86\u516d\u4e2a\u7ebf\u7a0b\u5bf9\u8c61\uff0c\u5176\u4e2d\u4e24\u4e2a\u7ebf\u7a0b\u8fd0\u884c write_value \u51fd\u6570\uff0c\u56db\u4e2a\u7ebf\u7a0b\u8fd0\u884c read_value \u51fd\u6570\uff0c\u6240\u6709\u7ebf\u7a0b\u5e76\u884c\u8fd0\u884c\u3002\n// \u8fd9\u610f\u5473\u7740\u8f93\u51fa\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u53d6\u51b3\u4e8e\u54ea\u4e2a\u7ebf\u7a0b\u9996\u5148\u83b7\u53d6\u9501\u3002\u8fd0\u884c\u7a0b\u5e8f\u51e0\u6b21\uff0c\u770b\u770b\u80fd\u5426\u83b7\u5f97\u4e0d\u540c\u7684\u8f93\u51fa\u3002\nint main() {\n  std::thread t1(read_value);\n  std::thread t2(write_value);\n  std::thread t3(read_value);\n  std::thread t4(read_value);\n  std::thread t5(write_value);\n  std::thread t6(read_value);\n\n  t1.join();\n  t2.join();\n  t3.join();\n  t4.join();\n  t5.join();\n  t6.join();\n\n  return 0;\n}\n// \u8f93\u51fa\u7ed3\u679c\u663e\u7136\u4e0d\u540c\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#_20","title":"\u5de6\u503c\u3001\u53f3\u503c","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#t","title":"T&amp;\uff08\u5de6\u503c\u5f15\u7528\uff09","text":"<ul> <li><code>T&amp;</code>\u00a0\u8868\u793a\u4e00\u4e2a\u5bf9\u7c7b\u578b\u00a0<code>T</code>\u00a0\u7684\u5de6\u503c\u5f15\u7528\uff0c\u4f60\u53ef\u4ee5\u7528\u5b83\u6765\u5f15\u7528\u957f\u671f\u5b58\u5728\u7684\u5bf9\u8c61\u3002</li> <li>\u4f60\u53ef\u4ee5\u901a\u8fc7\u00a0<code>T&amp;</code>\u00a0\u4fee\u6539\u5b83\u6240\u5f15\u7528\u7684\u5bf9\u8c61\uff08\u9664\u975e\u5b83\u5f15\u7528\u7684\u662f\u4e00\u4e2a const \u5bf9\u8c61\uff09\u3002</li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#const-t","title":"const T&amp;\uff08\u5e38\u91cf\u5de6\u503c\u5f15\u7528\uff09","text":"<ul> <li><code>const T&amp;</code>\u00a0\u8868\u793a\u5bf9\u7c7b\u578b\u00a0<code>T</code>\u00a0\u7684\u5e38\u91cf\u5de6\u503c\u5f15\u7528\u3002\u4f7f\u7528\u5b83\u8868\u793a\u4f60\u4e0d\u6253\u7b97\u4fee\u6539\u901a\u8fc7\u8fd9\u4e2a\u5f15\u7528\u8bbf\u95ee\u7684\u6570\u636e\u3002</li> <li>\u5b83\u53ef\u4ee5\u5f15\u7528 const \u6216\u975e const \u5bf9\u8c61\uff0c\u4e34\u65f6\u5bf9\u8c61\uff0c\u751a\u81f3\u662f\u5b57\u9762\u503c\u3002</li> <li>\u5e38\u7528\u4e8e\u51fd\u6570\u53c2\u6570\uff0c\u6765\u8868\u660e\u51fd\u6570\u4e0d\u4f1a\u4fee\u6539\u4f20\u5165\u7684\u53c2\u6570\uff0c\u5e76\u4e14\u80fd\u591f\u63a5\u53d7\u4e34\u65f6\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\u3002</li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#t_1","title":"T&amp;&amp;\uff08\u53f3\u503c\u5f15\u7528\uff09","text":"<ul> <li><code>T&amp;&amp;</code>\u00a0\u8868\u793a\u5bf9\u7c7b\u578b\u00a0<code>T</code>\u00a0\u7684\u53f3\u503c\u5f15\u7528\u3002\u5b83\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u79fb\u52a8\u8bed\u4e49\u548c\u5b8c\u7f8e\u8f6c\u53d1\u3002</li> <li>\u53f3\u503c\u5f15\u7528\u53ef\u4ee5\u7ed1\u5b9a\u5230\u5373\u5c06\u88ab\u9500\u6bc1\u7684\u5bf9\u8c61\uff08\u4e5f\u5c31\u662f\u53f3\u503c\uff09\uff0c\u4ece\u800c\u5141\u8bb8\u4f60\u5b89\u5168\u5730\u4ece\u5b83\u4eec\u90a3\u91cc\u201c\u7a83\u53d6\u201d\u8d44\u6e90\u3002</li> <li>\u53f3\u503c\u5f15\u7528\u672c\u8eab\u662f\u4e00\u4e2a\u5de6\u503c\uff0c\u9664\u975e\u5b83\u88ab\u00a0<code>std::move</code>\u00a0\u8f6c\u6362\u4e3a\u53f3\u503c\u3002</li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B/#const-t_1","title":"const T&amp;&amp;\uff08\u5e38\u91cf\u53f3\u503c\u5f15\u7528\uff09","text":"<ul> <li><code>const T&amp;&amp;</code>\u00a0\u662f\u4e00\u4e2a\u76f8\u5bf9\u7f55\u89c1\u7684\u7c7b\u578b\uff0c\u5b83\u8868\u793a\u5bf9\u4e00\u4e2a\u5e38\u91cf\u53f3\u503c\u7684\u5f15\u7528\u3002</li> <li>\u8fd9\u79cd\u7c7b\u578b\u7684\u4f7f\u7528\u9891\u7387\u5f88\u4f4e\uff0c\u56e0\u4e3a\u53f3\u503c\u5f15\u7528\u7684\u4e3b\u8981\u7528\u9014\u662f\u4e3a\u4e86\u79fb\u52a8\u5bf9\u8c61\uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ece\u6e90\u5bf9\u8c61\u4e2d\u79fb\u52a8\u8d44\u6e90\uff0c\u800c\u4e0d\u662f\u590d\u5236\uff09\uff0c\u800c\u5bf9\u4e8e\u5e38\u91cf\u5bf9\u8c61\uff0c\u4f60\u901a\u5e38\u4e0d\u4f1a\u53bb\u79fb\u52a8\u5b83\uff0c\u800c\u662f\u53bb\u590d\u5236\u5b83\u3002</li> <li>\u4e00\u4e9b\u6a21\u677f\u7f16\u7a0b\u573a\u666f\u53ef\u80fd\u4f1a\u9047\u5230\u00a0<code>const T&amp;&amp;</code>\uff0c\u4f46\u5728\u65e5\u5e38\u4f7f\u7528\u4e2d\u4f60\u901a\u5e38\u4e0d\u9700\u8981\u5b83\u3002</li> </ul> <p>\u5728\u51fd\u6570\u7684\u53c2\u6570\u4e2d\uff0c\u8fd9\u4e9b\u4e0d\u540c\u7c7b\u578b\u7684\u5f15\u7528\u901a\u5e38\u6709\u4ee5\u4e0b\u7528\u9014\uff1a</p> <ul> <li> <p><code>T&amp;</code></p> <ul> <li>\u7528\u4e8e\u9700\u8981\u4fee\u6539\u4f20\u5165\u5bf9\u8c61\u7684\u51fd\u6570\u3002</li> <li>\u65e0\u6cd5\u63a5\u53d7\u4e34\u65f6\u5bf9\u8c61\u3001\u5b57\u9762\u503c\u6216\u8fd4\u56de\u4e34\u65f6\u5bf9\u8c61\u7684\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u53c2\u6570\u3002</li> </ul> </li> <li> <p><code>const T&amp;</code></p> <ul> <li>\u7528\u4e8e\u4e0d\u9700\u8981\u4fee\u6539\u4f20\u5165\u5bf9\u8c61\u7684\u51fd\u6570\u3002</li> <li>\u53ef\u4ee5\u63a5\u53d7\u4efb\u4f55\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5305\u62ec\u4e34\u65f6\u5bf9\u8c61\u3002</li> <li>\u5e38\u7528\u4e8e\u8bfb\u53d6\u6570\u636e\u800c\u4e0d\u6539\u53d8\u6570\u636e\u7684\u573a\u666f\u3002</li> </ul> </li> <li> <p><code>T&amp;&amp;</code></p> <ul> <li>\u7528\u4e8e\u9700\u8981\u79fb\u52a8\u8d44\u6e90\u7684\u51fd\u6570\uff08\u4f8b\u5982\uff0c\u5c06\u8d44\u6e90\u4ece\u4e00\u4e2a\u5bf9\u8c61\u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u5bf9\u8c61\uff09\u3002</li> <li>\u63a5\u53d7\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\uff0c\u5141\u8bb8\u51fd\u6570\u6539\u53d8\u5176\u503c\u3002</li> </ul> </li> <li> <p><code>const T&amp;&amp;</code></p> <ul> <li>\u6781\u5c11\u4f7f\u7528\uff0c\u901a\u5e38\u53ea\u5728\u6a21\u677f\u7f16\u7a0b\u6216\u8005\u7279\u5b9a\u7684\u91cd\u8f7d\u89e3\u6790\u573a\u666f\u4e2d\u89c1\u5230\u3002</li> <li>\u901a\u5e38\uff0c\u4f60\u60f3\u8981\u79fb\u52a8\u7684\u5bf9\u8c61\u4e0d\u5e94\u662f const \u7684\uff0c\u56e0\u4e3a\u79fb\u52a8\u6d89\u53ca\u5230\u6539\u53d8\u5bf9\u8c61\u7684\u72b6\u6001\u3002</li> </ul> </li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%2B%2B/%E8%AF%AD%E6%B3%95/C%2B%2B%E5%BA%93%E5%87%BD%E6%95%B0/","title":"C++ \u5e93\u51fd\u6570","text":"<p>\u5411\u4e0a\u53d6\u6574 <code>ceil()</code></p> <p>\u5411\u4e0b\u53d6\u6574 <code>floor()</code></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/","title":"C\u8bed\u8a00","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/#_1","title":"\u7ebf\u7a0b","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/#pthread_create","title":"pthread_create","text":"<p>\u5934\u6587\u4ef6: <code>pthread.h</code></p> <p><code>pthread_create</code>\u51fd\u6570\u7684\u4f5c\u7528\u662f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\uff0c\u5e76\u8ba9\u8fd9\u4e2a\u7ebf\u7a0b\u5f00\u59cb\u6267\u884c<code>start_routine</code>\u51fd\u6570\u3002\u65b0\u7ebf\u7a0b\u4e0e\u8c03\u7528<code>pthread_create</code>\u7684\u7ebf\u7a0b\uff08\u901a\u5e38\u79f0\u4e3a\u4e3b\u7ebf\u7a0b\uff09\u5e76\u884c\u6267\u884c\uff0c\u5b83\u4eec\u62e5\u6709\u76f8\u540c\u7684\u8fdb\u7a0b\u7a7a\u95f4\uff0c\u4f46\u6709\u5404\u81ea\u72ec\u7acb\u7684\u7ebf\u7a0b\u6808\u3002</p> <pre><code>int pthread_create(pthread_t *thread, const pthread_attr_t *attr,\n                   void *(*start_routine) (void *), void *arg);\n</code></pre> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li> <p><code>thread</code>\uff1a\u662f\u4e00\u4e2a\u6307\u5411<code>pthread_t</code>\u7c7b\u578b\u7684\u6307\u9488\uff0c\u7528\u4e8e\u5b58\u50a8\u65b0\u521b\u5efa\u7ebf\u7a0b\u7684\u6807\u8bc6\u7b26\u3002\u901a\u8fc7\u8fd9\u4e2a\u6807\u8bc6\u7b26\uff0c\u60a8\u53ef\u4ee5\u5728\u4ee5\u540e\u5bf9\u7ebf\u7a0b\u8fdb\u884c\u64cd\u4f5c\uff0c\u5982\u7b49\u5f85\u7ebf\u7a0b\u7684\u7ed3\u675f\u3001\u7ec8\u6b62\u7ebf\u7a0b\u7b49\u3002</p> </li> <li> <p><code>attr</code>\uff1a\u662f\u4e00\u4e2a\u6307\u5411<code>pthread_attr_t</code>\u7c7b\u578b\u7684\u6307\u9488\uff0c\u7528\u4e8e\u6307\u5b9a\u7ebf\u7a0b\u7684\u5c5e\u6027\u3002\u5982\u679c\u4f20\u9012NULL\uff0c\u5219\u4f7f\u7528\u9ed8\u8ba4\u7ebf\u7a0b\u5c5e\u6027\u3002</p> </li> <li> <p><code>start_routine</code>\uff1a\u662f\u4e00\u4e2a\u6307\u5411\u51fd\u6570\u7684\u6307\u9488\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c06\u4f5c\u4e3a\u65b0\u7ebf\u7a0b\u7684\u5165\u53e3\u70b9\u3002\u65b0\u7ebf\u7a0b\u5c06\u4ece\u8fd9\u4e2a\u51fd\u6570\u5f00\u59cb\u6267\u884c\uff0c\u5e76\u5728\u51fd\u6570\u8fd4\u56de\u65f6\u7ec8\u6b62\u3002</p> </li> <li> <p><code>arg</code>\uff1a\u662f\u4f20\u9012\u7ed9<code>start_routine</code>\u51fd\u6570\u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u6307\u9488\uff0c\u5b83\u5c06\u88ab\u4f20\u9012\u7ed9<code>start_routine</code>\u51fd\u6570\u3002</p> </li> </ul> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\uff0c\u6f14\u793a\u5982\u4f55\u4f7f\u7528<code>pthread_create</code>\u521b\u5efa\u4e00\u4e2a\u65b0\u7ebf\u7a0b\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n\nvoid* thread_function(void* arg) {\n    int thread_id = *(int*)arg;\n    printf(\"Hello from thread %d\\n\", thread_id);\n    pthread_exit(NULL);\n}\n\nint main() {\n    pthread_t thread_id;\n    int arg = 1;\n\n    // \u521b\u5efa\u7ebf\u7a0b\n    if (pthread_create(&amp;thread_id, NULL, thread_function, &amp;arg) != 0) {\n        fprintf(stderr, \"Error creating thread.\\n\");\n        return 1;\n    }\n\n    // \u7b49\u5f85\u7ebf\u7a0b\u7ed3\u675f\n    pthread_join(thread_id, NULL);\n\n    printf(\"Main thread exiting.\\n\");\n    return 0;\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>pthread_create</code>\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7ebf\u7a0b\uff0c\u5e76\u6267\u884c<code>thread_function</code>\u51fd\u6570\u3002\u4e3b\u7ebf\u7a0b\u4f7f\u7528<code>pthread_join</code>\u51fd\u6570\u7b49\u5f85\u65b0\u7ebf\u7a0b\u7684\u7ed3\u675f\uff0c\u4ee5\u786e\u4fdd\u65b0\u7ebf\u7a0b\u7684\u6267\u884c\u5b8c\u6210\u540e\u518d\u7ee7\u7eed\u6267\u884c\u4e3b\u7ebf\u7a0b\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/#pthread_join","title":"pthread_join","text":"<p><code>pthread_join</code>\u662fC\u8bed\u8a00\u4e2d<code>pthread</code>\u5e93\u4e2d\u7684\u4e00\u4e2a\u51fd\u6570\uff0c\u7528\u4e8e\u7b49\u5f85\u4e00\u4e2a\u7ebf\u7a0b\u7684\u7ed3\u675f\u5e76\u6536\u96c6\u5176\u8fd4\u56de\u503c\uff08\u5982\u679c\u6709\uff09\u3002\u5b83\u7684\u539f\u578b\u5982\u4e0b\uff1a</p> <pre><code>int pthread_join(pthread_t thread, void **retval);\n</code></pre> <ul> <li><code>thread</code>\uff1a\u662f\u8981\u7b49\u5f85\u7684\u7ebf\u7a0b\u7684\u6807\u8bc6\u7b26\u3002\u8fd9\u662f\u5728\u8c03\u7528<code>pthread_create</code>\u521b\u5efa\u7ebf\u7a0b\u65f6\u8fd4\u56de\u7684\u503c\u3002</li> <li><code>retval</code>\uff1a\u662f\u4e00\u4e2a\u6307\u5411\u6307\u9488\u7684\u6307\u9488\uff0c\u7528\u4e8e\u5b58\u50a8\u7ebf\u7a0b\u7684\u8fd4\u56de\u503c\u3002\u7ebf\u7a0b\u7684\u8fd4\u56de\u503c\u662f\u4e00\u4e2a<code>void*</code>\u7c7b\u578b\uff0c\u56e0\u6b64\u9700\u8981\u4f7f\u7528\u6307\u9488\u7684\u6307\u9488\u6765\u63a5\u6536\u5b83\u3002</li> </ul> <p><code>pthread_join</code>\u51fd\u6570\u7684\u4f5c\u7528\u662f\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\uff0c\u76f4\u5230\u6307\u5b9a\u7684\u7ebf\u7a0b\uff08\u901a\u8fc7<code>thread</code>\u53c2\u6570\u4f20\u9012\uff09\u6267\u884c\u7ed3\u675f\u3002\u4e00\u65e6\u7ebf\u7a0b\u6267\u884c\u7ed3\u675f\uff0c<code>pthread_join</code>\u4f1a\u8fd4\u56de\uff0c\u5e76\u5c06\u7ebf\u7a0b\u7684\u8fd4\u56de\u503c\u5b58\u50a8\u5728<code>retval</code>\u6307\u5411\u7684\u5185\u5b58\u4f4d\u7f6e\u3002</p> <pre><code>pthread_join(p1, NULL);\n</code></pre> <p>\u8bf7\u6ce8\u610f\uff0c\u5728\u4f7f\u7528<code>pthread_join</code>\u65f6\uff0c\u786e\u4fdd\u76ee\u6807\u7ebf\u7a0b\u786e\u5b9e\u662f\u53ef\u8fde\u63a5\u7684\u3002\u5982\u679c\u7ebf\u7a0b\u662f\u5206\u79bb\u72b6\u6001\uff08\u901a\u8fc7<code>pthread_detach</code>\u51fd\u6570\u8bbe\u7f6e\uff09\uff0c\u6216\u8005\u5df2\u7ecf\u88ab\u5176\u4ed6\u7ebf\u7a0b\u8fde\u63a5\uff0c\u90a3\u4e48<code>pthread_join</code>\u4f1a\u8fd4\u56de\u9519\u8bef\u3002\u56e0\u6b64\uff0c\u5728\u4f7f\u7528<code>pthread_join</code>\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u76ee\u6807\u7ebf\u7a0b\u5904\u4e8e\u9002\u5f53\u7684\u72b6\u6001\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/#_2","title":"\u9501","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/#_3","title":"\u81ea\u65cb\u9501","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/#_4","title":"\u4e92\u65a5\u9501","text":"<p>\u4f7f\u7528\u4e92\u65a5\u9501\u9700\u8981\u5305\u542b\u5934\u6587\u4ef6<code>&lt;pthread.h&gt;</code>\uff0c\u5e76\u4f7f\u7528\u4ee5\u4e0b\u51fd\u6570\u6765\u521d\u59cb\u5316\u3001\u52a0\u9501\u548c\u89e3\u9501\u4e92\u65a5\u9501\uff1a</p> <ol> <li><code>pthread_mutex_init</code>: \u7528\u4e8e\u521d\u59cb\u5316\u4e92\u65a5\u9501\u3002</li> <li><code>pthread_mutex_lock</code>: \u7528\u4e8e\u52a0\u9501\u4e92\u65a5\u9501\u3002\u5982\u679c\u9501\u5df2\u88ab\u5176\u4ed6\u7ebf\u7a0b\u5360\u7528\uff0c\u5219\u5f53\u524d\u7ebf\u7a0b\u4f1a\u963b\u585e\uff0c\u76f4\u5230\u9501\u53ef\u7528\u3002</li> <li><code>pthread_mutex_trylock</code>: \u5c1d\u8bd5\u52a0\u9501\u4e92\u65a5\u9501\uff0c\u5982\u679c\u9501\u5df2\u88ab\u5176\u4ed6\u7ebf\u7a0b\u5360\u7528\uff0c\u8be5\u51fd\u6570\u4f1a\u7acb\u5373\u8fd4\u56de\uff0c\u5e76\u4e0d\u4f1a\u963b\u585e\u7ebf\u7a0b\u3002</li> <li><code>pthread_mutex_unlock</code>: \u7528\u4e8e\u89e3\u9501\u4e92\u65a5\u9501\u3002</li> <li><code>pthread_mutex_destroy</code>: \u9500\u6bc1\u4e92\u65a5\u9501\u3002</li> </ol> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u4f7f\u7528\u4e92\u65a5\u9501\u7684\u7b80\u5355\u793a\u4f8b\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n\npthread_mutex_t my_mutex;\n\nvoid* thread_function(void* arg) {\n    int thread_id = *((int*)arg);\n\n    // \u52a0\u9501\n    pthread_mutex_lock(&amp;my_mutex);\n\n    // \u4e34\u754c\u533a\u4ee3\u7801\n    printf(\"Thread %d is in critical section.\\n\", thread_id);\n    // \u6267\u884c\u4e00\u4e9b\u9700\u8981\u4fdd\u62a4\u7684\u64cd\u4f5c\n\n    // \u89e3\u9501\n    pthread_mutex_unlock(&amp;my_mutex);\n\n    pthread_exit(NULL);\n}\n\nint main() {\n    pthread_t threads[2];\n    int thread_args[2] = {1, 2};\n\n    // \u521d\u59cb\u5316\u4e92\u65a5\u9501\n    pthread_mutex_init(&amp;my_mutex, NULL);\n\n    for (int i = 0; i &lt; 2; ++i) {\n        pthread_create(&amp;threads[i], NULL, thread_function, (void*)&amp;thread_args[i]);\n    }\n\n    for (int i = 0; i &lt; 2; ++i) {\n        pthread_join(threads[i], NULL);\n    }\n\n    // \u9500\u6bc1\u4e92\u65a5\u9501\n    pthread_mutex_destroy(&amp;my_mutex);\n\n    printf(\"All threads have finished.\\n\");\n    return 0;\n}\n</code></pre> <p>\u5728\u4e0a\u8ff0\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528<code>pthread_mutex_init</code>\u521d\u59cb\u5316\u4e92\u65a5\u9501\uff0c\u7136\u540e\u5728\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u4e34\u754c\u533a\u4f7f\u7528<code>pthread_mutex_lock</code>\u52a0\u9501\uff0c\u4e34\u754c\u533a\u7ed3\u675f\u540e\u4f7f\u7528<code>pthread_mutex_unlock</code>\u89e3\u9501\u3002</p> <p>\u4e92\u65a5\u9501\u9002\u7528\u4e8e\u4e34\u754c\u533a\u8f83\u957f\u6216\u8005\u7ebf\u7a0b\u7ade\u4e89\u8f83\u6fc0\u70c8\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u963b\u585e\u7b49\u5f85\u9501\u7684\u91ca\u653e\uff0c\u4ece\u800c\u907f\u514d\u4e86\u5fd9\u7b49\u5e26\u6765\u7684\u8d44\u6e90\u6d6a\u8d39\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/#_5","title":"\u6761\u4ef6\u53d8\u91cf","text":"<p>\u5728C\u8bed\u8a00\u4e2d\uff0c<code>pthread</code>\u5e93\u63d0\u4f9b\u4e86\u6761\u4ef6\u53d8\u91cf\uff08<code>pthread_cond_t</code>\uff09\u7528\u4e8e\u591a\u7ebf\u7a0b\u7f16\u7a0b\u4e2d\u7684\u7ebf\u7a0b\u540c\u6b65\u3002\u6761\u4ef6\u53d8\u91cf\u901a\u5e38\u7528\u4e8e\u5b9e\u73b0\u7ebf\u7a0b\u4e4b\u95f4\u7684\u7b49\u5f85/\u901a\u77e5\u673a\u5236\uff0c\u7528\u4e8e\u89e3\u51b3\u67d0\u4e9b\u7279\u5b9a\u95ee\u9898\uff0c\u5982\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u95ee\u9898\u3001\u8bfb\u5199\u9501\u7b49\u3002\u6761\u4ef6\u53d8\u91cf\u9700\u8981\u4e0e\u4e92\u65a5\u9501\uff08<code>pthread_mutex_t</code>\uff09\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u786e\u4fdd\u7ebf\u7a0b\u5b89\u5168\u3002</p> <p>\u6761\u4ef6\u53d8\u91cf\u6709\u4e09\u4e2a\u4e3b\u8981\u64cd\u4f5c\uff1a</p> <ol> <li><code>pthread_cond_init</code>\uff1a\u7528\u4e8e\u521d\u59cb\u5316\u6761\u4ef6\u53d8\u91cf\u3002</li> <li><code>pthread_cond_wait</code>\uff1a\u7ebf\u7a0b\u8c03\u7528\u8be5\u51fd\u6570\u8fdb\u5165\u7b49\u5f85\u72b6\u6001\uff0c\u7b49\u5f85\u6761\u4ef6\u53d8\u91cf\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u3002</li> <li><code>pthread_cond_signal</code>\uff1a\u7528\u4e8e\u901a\u77e5\u7b49\u5f85\u5728\u6761\u4ef6\u53d8\u91cf\u4e0a\u7684\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u4f7f\u5176\u4ece\u7b49\u5f85\u72b6\u6001\u8fd4\u56de\uff08\u5e76\u7ee7\u7eed\u6267\u884c\uff09\u3002</li> <li><code>pthread_cond_broadcast</code>\uff1a\u7528\u4e8e\u901a\u77e5\u6240\u6709\u7b49\u5f85\u5728\u6761\u4ef6\u53d8\u91cf\u4e0a\u7684\u7ebf\u7a0b\u3002</li> </ol> <p>\u4ee5\u4e0b\u662f\u6761\u4ef6\u53d8\u91cf\u7684\u57fa\u672c\u4f7f\u7528\u793a\u4f8b\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t cond = PTHREAD_COND_INITIALIZER;\n\nint shared_data = 0;\n\nvoid* thread_func(void* arg) {\n    pthread_mutex_lock(&amp;mutex);\n\n    // \u7b49\u5f85\u6761\u4ef6\u53d8\u91cf\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\n    while (shared_data &lt; 10) {\n        pthread_cond_wait(&amp;cond, &amp;mutex);\n    }\n\n    printf(\"Thread received the signal. Shared data: %d\\n\", shared_data);\n\n    pthread_mutex_unlock(&amp;mutex);\n\n    return NULL;\n}\n\nint main() {\n    pthread_t tid;\n    pthread_create(&amp;tid, NULL, thread_func, NULL);\n\n    pthread_mutex_lock(&amp;mutex);\n    // \u6a21\u62df\u4e00\u4e9b\u5904\u7406\uff0c\u6b64\u5904\u53ef\u4ee5\u662f\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u6a21\u5f0f\u4e2d\u7684\u751f\u4ea7\u6570\u636e\u8fc7\u7a0b\n    shared_data = 10;\n\n    // \u53d1\u9001\u4fe1\u53f7\u901a\u77e5\u7b49\u5f85\u7684\u7ebf\u7a0b\n    pthread_cond_signal(&amp;cond);\n    pthread_mutex_unlock(&amp;mutex);\n\n    pthread_join(tid, NULL);\n\n    pthread_cond_destroy(&amp;cond);\n    pthread_mutex_destroy(&amp;mutex);\n\n    return 0;\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u4e3b\u7ebf\u7a0b\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\uff0c\u65b0\u7ebf\u7a0b\u5728\u6761\u4ef6\u53d8\u91cf<code>cond</code>\u4e0a\u7b49\u5f85\u3002\u4e3b\u7ebf\u7a0b\u4fee\u6539\u4e86<code>shared_data</code>\u7684\u503c\uff0c\u5e76\u901a\u8fc7\u8c03\u7528<code>pthread_cond_signal</code>\u53d1\u9001\u4fe1\u53f7\u901a\u77e5\u7b49\u5f85\u7684\u7ebf\u7a0b\u3002\u7b49\u5f85\u7684\u7ebf\u7a0b\u5728\u63a5\u6536\u5230\u4fe1\u53f7\u540e\u7ee7\u7eed\u6267\u884c\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6761\u4ef6\u53d8\u91cf\u5e94\u8be5\u4e0e\u4e92\u65a5\u9501\u4e00\u8d77\u4f7f\u7528\u3002\u7b49\u5f85\u6761\u4ef6\u65f6\uff0c\u7ebf\u7a0b\u4f1a\u91ca\u653e\u4e92\u65a5\u9501\uff0c\u5f53\u6536\u5230\u4fe1\u53f7\u65f6\uff0c\u518d\u91cd\u65b0\u83b7\u5f97\u4e92\u65a5\u9501\u3002\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u9632\u6b62\u51fa\u73b0\u7ade\u6001\u6761\u4ef6\uff08race condition\uff09\u3002</p> <p>\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\u65f6\uff0c\u9700\u8981\u4ed4\u7ec6\u8bbe\u8ba1\u7b49\u5f85\u6761\u4ef6\u548c\u53d1\u9001\u4fe1\u53f7\u7684\u903b\u8f91\uff0c\u4ee5\u514d\u51fa\u73b0\u7ebf\u7a0b\u6b7b\u9501\u6216\u6761\u4ef6\u4e0d\u6ee1\u8db3\u7b49\u95ee\u9898\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/#_6","title":"\u4fe1\u53f7\u91cf","text":"<p>\u5728 C \u8bed\u8a00\u4e2d\uff0c\u4fe1\u53f7\u91cf\uff08Semaphore\uff09\u662f\u4e00\u79cd\u7528\u4e8e\u7ebf\u7a0b\u540c\u6b65\u548c\u4e92\u65a5\u7684\u540c\u6b65\u539f\u8bed\u3002\u5b83\u662f\u4e00\u4e2a\u8ba1\u6570\u5668\uff0c\u7528\u4e8e\u63a7\u5236\u591a\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee\u3002\u4fe1\u53f7\u91cf\u5141\u8bb8\u7ebf\u7a0b\u5728\u6267\u884c\u4e34\u754c\u533a\u4ee3\u7801\u4e4b\u524d\u5148\u83b7\u53d6\u4e00\u4e2a\u4fe1\u53f7\u91cf\u8d44\u6e90\uff0c\u5982\u679c\u4fe1\u53f7\u91cf\u8d44\u6e90\u4e0d\u53ef\u7528\uff0c\u5219\u7ebf\u7a0b\u53ef\u80fd\u4f1a\u88ab\u963b\u585e\u7b49\u5f85\u76f4\u5230\u8d44\u6e90\u53ef\u7528\u3002</p> <p>\u5e38\u89c1\u7684\u4fe1\u53f7\u91cf\u7c7b\u578b\u5305\u62ec\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\u548c\u8ba1\u6570\u4fe1\u53f7\u91cf\uff1a</p> <ol> <li> <p>\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\uff1a\u4e5f\u79f0\u4e3a\u4e92\u65a5\u9501\uff08Mutex\uff09\uff0c\u5b83\u53ea\u6709\u4e24\u4e2a\u72b6\u6001\uff1a0 \u548c 1\u3002\u7528\u4e8e\u5b9e\u73b0\u4e92\u65a5\uff0c\u786e\u4fdd\u5728\u4efb\u4f55\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u3002</p> </li> <li> <p>\u8ba1\u6570\u4fe1\u53f7\u91cf\uff1a\u5141\u8bb8\u4e00\u5b9a\u6570\u91cf\u7684\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u3002\u8ba1\u6570\u4fe1\u53f7\u91cf\u7684\u521d\u59cb\u503c\u8868\u793a\u53ef\u540c\u65f6\u8bbf\u95ee\u8be5\u8d44\u6e90\u7684\u7ebf\u7a0b\u6570\u76ee\u3002</p> </li> </ol> <p>C \u8bed\u8a00\u4e2d\uff0c\u4fe1\u53f7\u91cf\u7684\u64cd\u4f5c\u901a\u5e38\u7531\u6807\u51c6\u5e93\u6216\u7cfb\u7edf\u8c03\u7528\u63d0\u4f9b\u3002\u5728 POSIX \u73af\u5883\u4e0b\uff0c\u53ef\u4ee5\u4f7f\u7528 POSIX Threads (pthread) \u5e93\u4e2d\u7684\u4fe1\u53f7\u91cf\u76f8\u5173\u51fd\u6570\u3002</p> <p>\u5e38\u89c1\u7684\u4fe1\u53f7\u91cf\u76f8\u5173\u51fd\u6570\u5305\u62ec\uff1a</p> <ol> <li><code>sem_init</code>\uff1a\u7528\u4e8e\u521d\u59cb\u5316\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002</li> <li><code>sem_destroy</code>\uff1a\u7528\u4e8e\u9500\u6bc1\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002</li> <li><code>sem_wait</code>\u51fd\u6570\u7528\u4e8e\u5c1d\u8bd5\u83b7\u53d6\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u5e76\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\uff08\u6216\u8005\u5c06\u5f53\u524d\u7ebf\u7a0b\u7f6e\u4e8e\u7761\u7720\u72b6\u6001\uff09\uff0c\u76f4\u5230\u4fe1\u53f7\u91cf\u53ef\u7528\uff08\u975e\u96f6\uff09\u3002\u4e00\u822c\u7528\u4e8e\u7ebf\u7a0b\u5728\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u4e4b\u524d\u83b7\u53d6\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff08\u503c\u51cf\u5c111\uff09\uff0c\u4ee5\u786e\u4fdd\u8d44\u6e90\u7684\u72ec\u5360\u6027\u3002</li> <li><code>sem_post</code>\u51fd\u6570\u7528\u4e8e\u91ca\u653e\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u4f7f\u5f97\u5176\u503c\u589e\u52a01\u3002\u5f53\u6709\u5176\u4ed6\u7ebf\u7a0b\u5728\u8c03\u7528<code>sem_wait</code>\u7b49\u5f85\u8fd9\u4e2a\u4fe1\u53f7\u91cf\u65f6\uff0c\u8c03\u7528<code>sem_post</code>\u4f1a\u5524\u9192\u5176\u4e2d\u4e00\u4e2a\u7b49\u5f85\u7684\u7ebf\u7a0b\uff0c\u4f7f\u5176\u80fd\u591f\u7ee7\u7eed\u6267\u884c\u3002</li> <li><code>sem_trywait</code>\uff1a\u7c7b\u4f3c\u4e8e<code>sem_wait</code>\uff0c\u4f46\u662f\u5728\u8d44\u6e90\u4e0d\u53ef\u7528\u65f6\u7acb\u5373\u8fd4\u56de\uff0c\u800c\u4e0d\u662f\u963b\u585e\u7ebf\u7a0b\u3002</li> <li><code>sem_timedwait</code>\uff1a\u7c7b\u4f3c\u4e8e<code>sem_wait</code>\uff0c\u4f46\u662f\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e2a\u8d85\u65f6\u65f6\u95f4\uff0c\u5728\u8d85\u65f6\u540e\u8fd4\u56de\u3002</li> </ol> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u4ee3\u7801\uff0c\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528 POSIX Threads \u5e93\u4e2d\u7684\u4fe1\u53f7\u91cf\u6765\u5b9e\u73b0\u7ebf\u7a0b\u540c\u6b65\u548c\u4e92\u65a5\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n\n#define NUM_THREADS 5\n\nint shared_resource = 0;\nsem_t semaphore;\n\nvoid* thread_function(void* arg) {\n    int thread_id = *(int*)arg;\n\n    sem_wait(&amp;semaphore); // \u7b49\u5f85\u4fe1\u53f7\u91cf P\n    printf(\"\u7ebf\u7a0b %d \u6b63\u5728\u4e34\u754c\u533a\u5185\u3002\\n\", thread_id);\n\n    // \u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\n    shared_resource++;\n    printf(\"\u5171\u4eab\u8d44\u6e90\u503c\uff1a%d\\n\", shared_resource);\n\n    sem_post(&amp;semaphore); // \u91ca\u653e\u4fe1\u53f7\u91cf V\n\n    pthread_exit(NULL);\n}\n\nint main() {\n    pthread_t threads[NUM_THREADS];\n    int thread_ids[NUM_THREADS];\n    sem_init(&amp;semaphore, 0, 1); // \u521d\u59cb\u5316\u4fe1\u53f7\u91cf\uff0c\u521d\u59cb\u503c\u4e3a1\uff08\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\uff09\n\n    for (int i = 0; i &lt; NUM_THREADS; i++) {\n        thread_ids[i] = i;\n        pthread_create(&amp;threads[i], NULL, thread_function, &amp;thread_ids[i]);\n    }\n\n    for (int i = 0; i &lt; NUM_THREADS; i++) {\n        pthread_join(threads[i], NULL);\n    }\n\n    sem_destroy(&amp;semaphore); // \u9500\u6bc1\u4fe1\u53f7\u91cf\n\n    return 0;\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u521b\u5efa\u4e865\u4e2a\u7ebf\u7a0b\uff0c\u5b83\u4eec\u5171\u4eab\u4e00\u4e2a\u6574\u6570\u53d8\u91cf <code>shared_resource</code>\u3002\u901a\u8fc7\u4fe1\u53f7\u91cf <code>semaphore</code> \u6765\u5b9e\u73b0\u5bf9 <code>shared_resource</code> \u7684\u4e92\u65a5\u8bbf\u95ee\uff0c\u786e\u4fdd\u5728\u4efb\u610f\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u8fdb\u5165\u4e34\u754c\u533a\u6267\u884c\u4ee3\u7801\uff0c\u4ece\u800c\u907f\u514d\u4e86\u7ade\u6001\u6761\u4ef6\uff08Race Condition\uff09\u3002</p> <p>P\u5931\u8d25\u65f6\u7acb\u5373\u7761\u7720\u7b49\u5f85</p> <p>\u6267\u884cV\u65f6\uff0c\u5524\u9192\u4efb\u610f\u7b49\u5f85\u7684\u7ebf\u7a0b</p> <p>\u6240\u4ee5\u4fe1\u53f7\u91cf\u7684\u521d\u59cb\u5316\u503c\u4e3a1\u65f6\uff0c\u4fe1\u53f7\u91cf\u5b9e\u9645\u5c31\u6210\u4e3a\u4e86\u4e92\u65a5\u9501</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/","title":"C\u8bed\u8a00\u5e76\u53d1\u7f16\u7a0b","text":"<p>\u4ea4\u66ff\u8f93\u51faAB</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n\nint main() {\n\n  int ptc[2];\n  int ctp[2];\n\n  pipe(ptc);\n  pipe(ctp);\n  int pid = fork();\n  if (pid == 0) {\n    char buf;\n    for (int i = 1; i &lt;= 1000; i++) {\n      printf(\"A\");\n      fflush(stdout); // !!!\n      write(ctp[1], \"0\", 1);\n      read(ptc[0], &amp;buf, 1);\n    }\n\n  } else if (pid &gt; 0) {\n    char buf;\n    for (int i = 1; i &lt;= 1000; i++) {\n      read(ctp[0], &amp;buf, 1);\n      printf(\"B\");\n      fflush(stdout); // !!!\n      write(ptc[1], \"1\", 1);\n    }\n  } else {\n\n    printf(\"Error\\n\");\n    exit(1);\n  }\n  close(ptc[0]);\n  close(ctp[0]);\n  close(ctp[1]);\n  close(ptc[1]);\n\n  return 0;\n}\n</code></pre> <p>\u5728\u8fd9\u6bb5\u4ee3\u7801\u4e2d\u52a0\u5165<code>fflush(stdout)</code>\u51fd\u6570\u662f\u4e3a\u4e86\u53ca\u65f6\u5c06\u8f93\u51fa\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u5237\u65b0\u5e76\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\u3002\u5728C\u8bed\u8a00\u4e2d\uff0c\u5f53\u4f60\u4f7f\u7528<code>printf</code>\u51fd\u6570\u8f93\u51fa\u5185\u5bb9\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8f93\u51fa\u4f1a\u5148\u6682\u5b58\u5728\u8f93\u51fa\u7f13\u51b2\u533a\u4e2d\uff0c\u800c\u4e0d\u4f1a\u7acb\u5373\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\u3002\u8fd9\u662f\u4e3a\u4e86\u63d0\u9ad8\u8f93\u51fa\u6548\u7387\uff0c\u907f\u514d\u9891\u7e41\u5730\u5199\u5165\u5c4f\u5e55\u3002\u7f13\u51b2\u533a\u4f1a\u5728\u6ee1\u6216\u5728\u7a0b\u5e8f\u7ed3\u675f\u65f6\u81ea\u52a8\u5237\u65b0\uff0c\u6216\u8005\u5728\u9047\u5230\u6362\u884c\u7b26<code>\\n</code>\u65f6\u4f1a\u7acb\u5373\u5237\u65b0\u3002</p> <p>\u4f46\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u5e0c\u671b\u7acb\u5373\u5c06\u8f93\u51fa\u663e\u793a\u51fa\u6765\uff0c\u800c\u4e0d\u7b49\u5f85\u7f13\u51b2\u533a\u6ee1\u6216\u7a0b\u5e8f\u7ed3\u675f\u3002\u8fd9\u65f6\u5c31\u53ef\u4ee5\u4f7f\u7528<code>fflush(stdout)</code>\u51fd\u6570\u5f3a\u5236\u5237\u65b0\u8f93\u51fa\u7f13\u51b2\u533a\uff0c\u4f7f\u5f97\u5185\u5bb9\u7acb\u5373\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\u3002</p> <p>\u5728\u8fd9\u4e2a\u7279\u5b9a\u7684\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u5e0c\u671b\u5728\u4ea4\u66ff\u8f93\u51fa'A'\u548c'B'\u65f6\u80fd\u591f\u53ca\u65f6\u663e\u793a\u7ed3\u679c\uff0c\u800c\u4e0d\u662f\u7b49\u5f85\u7f13\u51b2\u533a\u6ee1\u6216\u7a0b\u5e8f\u7ed3\u675f\u624d\u8f93\u51fa\u3002\u56e0\u6b64\uff0c\u5728\u6bcf\u6b21\u8f93\u51fa'A'\u6216'B'\u540e\uff0c\u6211\u4eec\u4f7f\u7528<code>fflush(stdout)</code>\u786e\u4fdd\u7acb\u5373\u5c06\u5176\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\uff0c\u4ece\u800c\u5b9e\u73b0\u4ea4\u66ff\u8f93\u51fa\u7684\u6548\u679c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E7%9A%84%E7%BC%96%E8%AF%91/","title":"C\u7684\u7f16\u8bd1","text":"<pre><code>graph TD\n    A[C \u4ee3\u7801\u6587\u4ef6] --&gt; B[\u9884\u5904\u7406\u5668]\n    B --&gt; C[\u4e2d\u95f4\u6587\u4ef6]\n    C --&gt; D[\u7f16\u8bd1\u5668]\n    D --&gt; E[\u6c47\u7f16\u4ee3\u7801\u6587\u4ef6]\n    E --&gt; F[\u6c47\u7f16\u5668]\n    F --&gt; G[\u76ee\u6807\u6587\u4ef6]\n    G --&gt; H[\u94fe\u63a5\u5668]\n    H --&gt; I[\u53ef\u6267\u884c\u6587\u4ef6]\n</code></pre> <p>\u94fe\u63a5\u8fc7\u7a0b\u662f\u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u76ee\u6807\u6587\u4ef6\uff08\u5305\u542b\u673a\u5668\u4ee3\u7801\u548c\u6570\u636e\uff09\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u5f62\u6210\u53ef\u6267\u884c\u7a0b\u5e8f\u7684\u8fc7\u7a0b\u3002\u94fe\u63a5\u8fc7\u7a0b\u901a\u5e38\u5206\u4e3a\u4ee5\u4e0b\u51e0\u4e2a\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u9884\u5904\u7406\uff08Preprocessing\uff09\uff1a\u5728\u8fdb\u884c\u5b9e\u9645\u7684\u7f16\u8bd1\u548c\u94fe\u63a5\u4e4b\u524d\uff0c\u9884\u5904\u7406\u5668\u4f1a\u5bf9\u6e90\u4ee3\u7801\u6587\u4ef6\u8fdb\u884c\u5904\u7406\u3002\u8fd9\u5305\u62ec\u5c55\u5f00\u5b8f\u5b9a\u4e49\u3001\u5305\u542b\u5934\u6587\u4ef6\u7b49\u64cd\u4f5c\u3002\u9884\u5904\u7406\u5668\u751f\u6210\u7ecf\u8fc7\u5904\u7406\u7684\u6e90\u4ee3\u7801\u6587\u4ef6\u3002</p> </li> <li> <p>\u7f16\u8bd1\uff08Compilation\uff09\uff1a\u7f16\u8bd1\u5668\u5c06\u9884\u5904\u7406\u540e\u7684\u6e90\u4ee3\u7801\u6587\u4ef6\u7ffb\u8bd1\u6210\u6c47\u7f16\u8bed\u8a00\u6216\u673a\u5668\u8bed\u8a00\u7684\u76ee\u6807\u6587\u4ef6\u3002\u7f16\u8bd1\u5668\u5bf9\u6bcf\u4e2a\u6e90\u4ee3\u7801\u6587\u4ef6\u8fdb\u884c\u8bcd\u6cd5\u5206\u6790\u3001\u8bed\u6cd5\u5206\u6790\u3001\u8bed\u4e49\u5206\u6790\u548c\u4f18\u5316\u7b49\u6b65\u9aa4\uff0c\u6700\u7ec8\u751f\u6210\u76f8\u5e94\u7684\u76ee\u6807\u6587\u4ef6\u3002</p> </li> <li> <p>\u6c47\u7f16\uff08Assembly\uff09\uff1a\u6c47\u7f16\u5668\u5c06\u7f16\u8bd1\u751f\u6210\u7684\u76ee\u6807\u6587\u4ef6\u8f6c\u6362\u6210\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u4f7f\u7528\u7684\u673a\u5668\u6307\u4ee4\u3002\u6c47\u7f16\u5668\u5c06\u6bcf\u6761\u6c47\u7f16\u8bed\u53e5\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684\u673a\u5668\u8bed\u8a00\u6307\u4ee4\uff0c\u5e76\u751f\u6210\u4e0e\u76ee\u6807\u786c\u4ef6\u4f53\u7cfb\u7ed3\u6784\u517c\u5bb9\u7684\u673a\u5668\u4ee3\u7801\u6587\u4ef6\u3002</p> </li> <li> <p>\u94fe\u63a5\uff08Linking\uff09\uff1a\u94fe\u63a5\u5668\u5c06\u591a\u4e2a\u76ee\u6807\u6587\u4ef6\u4ee5\u53ca\u53ef\u80fd\u9700\u8981\u7684\u5e93\u6587\u4ef6\uff08\u4f8b\u5982\u52a8\u6001\u94fe\u63a5\u5e93\uff09\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u89e3\u51b3\u5404\u4e2a\u76ee\u6807\u6587\u4ef6\u4e4b\u95f4\u7684\u7b26\u53f7\u5f15\u7528\u5173\u7cfb\uff0c\u751f\u6210\u6700\u7ec8\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u6216\u5171\u4eab\u5e93\u3002\u94fe\u63a5\u5668\u7684\u4e3b\u8981\u4efb\u52a1\u5305\u62ec\u7b26\u53f7\u89e3\u6790\u3001\u7b26\u53f7\u91cd\u5b9a\u4f4d\u548c\u5730\u5740\u7a7a\u95f4\u5206\u914d\u7b49\u3002</p> </li> </ol> <p>\u5728\u94fe\u63a5\u8fc7\u7a0b\u4e2d\uff0c\u7b26\u53f7\u89e3\u6790\u662f\u4e00\u4e2a\u91cd\u8981\u7684\u6b65\u9aa4\u3002\u5f53\u4e00\u4e2a\u76ee\u6807\u6587\u4ef6\u5f15\u7528\u4e86\u5176\u4ed6\u76ee\u6807\u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u7b26\u53f7\uff08\u5982\u51fd\u6570\u6216\u5168\u5c40\u53d8\u91cf\uff09\u65f6\uff0c\u94fe\u63a5\u5668\u9700\u8981\u89e3\u6790\u8fd9\u4e9b\u7b26\u53f7\u7684\u5f15\u7528\uff0c\u627e\u5230\u5176\u5b9a\u4e49\u6240\u5728\u7684\u76ee\u6807\u6587\u4ef6\u6216\u5e93\u6587\u4ef6\uff0c\u5e76\u8fdb\u884c\u8fde\u63a5\u3002</p> <p>\u94fe\u63a5\u53ef\u4ee5\u5206\u4e3a\u9759\u6001\u94fe\u63a5\u548c\u52a8\u6001\u94fe\u63a5\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li> <p>\u9759\u6001\u94fe\u63a5\uff08Static Linking\uff09\uff1a\u5728\u9759\u6001\u94fe\u63a5\u4e2d\uff0c\u94fe\u63a5\u5668\u5c06\u6240\u6709\u88ab\u5f15\u7528\u7684\u76ee\u6807\u6587\u4ef6\u548c\u5e93\u6587\u4ef6\u7684\u4ee3\u7801\u548c\u6570\u636e\u590d\u5236\u5230\u6700\u7ec8\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u4e2d\u3002\u53ef\u6267\u884c\u7a0b\u5e8f\u72ec\u7acb\u4e8e\u7cfb\u7edf\u4e0a\u7684\u5e93\u6587\u4ef6\u8fd0\u884c\uff0c\u4f46\u4f1a\u589e\u52a0\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5927\u5c0f\u3002</p> </li> <li> <p>\u52a8\u6001\u94fe\u63a5\uff08Dynamic Linking\uff09\uff1a\u5728\u52a8\u6001\u94fe\u63a5\u4e2d\uff0c\u94fe\u63a5\u5668\u4ec5\u5c06\u5bf9\u5e93\u6587\u4ef6\u7684\u5f15\u7528\u4fe1\u606f\u8bb0\u5f55\u5728\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\uff0c\u800c\u4e0d\u5c06\u5b9e\u9645\u7684\u4ee3\u7801\u548c\u6570\u636e\u590d\u5236\u5230\u53ef\u6267\u884c\u6587\u4ef6\u4e2d\u3002\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u64cd\u4f5c\u7cfb\u7edf\u7684\u52a8\u6001\u94fe\u63a5\u5668\u5c06\u5728\u5185\u5b58\u4e2d\u52a0\u8f7d\u6240\u9700\u7684\u5e93\u6587\u4ef6\uff0c\u5e76\u5c06\u5176\u4e0e\u7a0b\u5e8f\u8fdb\u884c\u94fe\u63a5\u3002\u52a8\u6001\u94fe\u63a5\u53ef\u4ee5\u51cf\u5c0f\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u4f46\u4f9d\u8d56\u4e8e\u7cfb\u7edf\u4e2d\u5b58\u5728\u76f8\u5e94\u7684\u5171\u4eab\u5e93\u3002</p> </li> </ul> <p>\u603b\u4e4b\uff0c\u94fe\u63a5\u8fc7\u7a0b\u5c06\u7f16\u8bd1\u751f\u6210\u7684\u76ee\u6807\u6587\u4ef6\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u89e3\u51b3\u7b26\u53f7\u5f15\u7528\u5173\u7cfb\uff0c\u751f\u6210\u53ef\u6267\u884c\u7a0b\u5e8f\u6216\u5171\u4eab\u5e93\uff0c\u4f7f\u7a0b\u5e8f\u80fd\u591f\u5728\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80%E7%9A%84%E7%BC%96%E8%AF%91/#_1","title":"\u591a\u6587\u4ef6\u7f16\u8bd1","text":"<p>\u5047\u8bbe\u4f60\u6709\u4e24\u4e2a\u6e90\u6587\u4ef6\uff1a<code>main.c</code> \u548c <code>functions.c</code>\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5934\u6587\u4ef6 <code>functions.h</code>\u3002</p> <ol> <li><code>main.c</code>\u00a0\u662f\u7a0b\u5e8f\u7684\u5165\u53e3\u6587\u4ef6\uff0c\u5305\u542b\u00a0<code>main</code>\u00a0\u51fd\u6570\u3002</li> </ol> <pre><code>// main.c\n\n#include &lt;stdio.h&gt;\n#include \"functions.h\"\n\nint main() {\n    int a = 5;\n    int b = 10;\n    int result = add(a, b);\n    printf(\"The result is: %d\\n\", result);\n    return 0;\n}\n</code></pre> <ol> <li><code>functions.c</code>\u00a0\u5305\u542b\u4e86\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u5b9e\u73b0\u3002</li> </ol> <pre><code>// functions.c\n\nint add(int a, int b) {\n    return a + b;\n}\n</code></pre> <ol> <li><code>functions.h</code>\u00a0\u5b9a\u4e49\u4e86\u51fd\u6570\u7684\u58f0\u660e\u3002 <pre><code>// functions.h\n\nint add(int a, int b);\n</code></pre></li> </ol> <p>\u4f7f\u7528\u591a\u6587\u4ef6\u7f16\u8bd1\u7684\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ol> <li> <p>\u5c06\u4e0a\u8ff0\u4e09\u4e2a\u6587\u4ef6\u4fdd\u5b58\u5230\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u3002</p> </li> <li> <p>\u6253\u5f00\u547d\u4ee4\u884c\u7ec8\u7aef\uff0c\u5e76\u8fdb\u5165\u8be5\u76ee\u5f55\u3002</p> </li> <li> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u7f16\u8bd1 <code>main.c</code> \u548c <code>functions.c</code> \u6587\u4ef6\uff1a</p> </li> </ol> <pre><code>gcc -o program main.c functions.c\n</code></pre> <p>\u8fd9\u5c06\u751f\u6210\u4e00\u4e2a\u540d\u4e3a <code>program</code> \u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> <ol> <li>\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\uff1a <pre><code>./program\n</code></pre></li> </ol>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C%E8%AF%AD%E8%A8%80/ELF%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/","title":"ELF\u6587\u4ef6\u7ed3\u6784","text":"<p>ELF\uff08Executable and Linkable Format\uff09\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f\uff0c\u7528\u4e8e\u5b58\u50a8\u53ef\u6267\u884c\u7a0b\u5e8f\u3001\u5171\u4eab\u5e93\u548c\u76ee\u6807\u6587\u4ef6\u3002\u5b83\u5728\u8bb8\u591a\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u4f8b\u5982Linux\u548cUnix\u3002 </p> <p>ELF\u6587\u4ef6\u7531\u591a\u4e2a\u90e8\u5206\u7ec4\u6210\uff0c\u6bcf\u4e2a\u90e8\u5206\u5305\u542b\u4e0d\u540c\u7684\u4fe1\u606f\u3002\u4e0b\u9762\u662fELF\u6587\u4ef6\u7684\u57fa\u672c\u7ed3\u6784\uff1a</p> <ol> <li> <p>ELF\u5934\uff08ELF Header\uff09\uff1a\u4f4d\u4e8e\u6587\u4ef6\u7684\u5f00\u5934\uff0c\u5305\u542b\u4e86\u6587\u4ef6\u7684\u57fa\u672c\u5c5e\u6027\u548c\u63cf\u8ff0\u4fe1\u606f\uff0c\u5982\u6587\u4ef6\u7c7b\u578b\u3001\u4f53\u7cfb\u7ed3\u6784\u3001\u5165\u53e3\u70b9\u5730\u5740\u7b49\u3002</p> </li> <li> <p>\u7a0b\u5e8f\u5934\u8868\uff08Program Header Table\uff09\uff1a\u7d27\u968fELF\u5934\u4e4b\u540e\uff0c\u5b83\u662f\u4e00\u4e2a\u6bb5\uff08Segment\uff09\u7684\u6570\u7ec4\uff0c\u63cf\u8ff0\u4e86\u7a0b\u5e8f\u8fd0\u884c\u65f6\u6240\u9700\u7684\u5185\u5b58\u5e03\u5c40\u4fe1\u606f\uff0c\u5305\u62ec\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u5404\u4e2a\u6bb5\u7684\u4f4d\u7f6e\u3001\u5927\u5c0f\u548c\u8bbf\u95ee\u6743\u9650\u7b49\u3002</p> </li> <li> <p>\u8282\u5934\u8868\uff08Section Header Table\uff09\uff1a\u7d27\u968f\u7a0b\u5e8f\u5934\u8868\u4e4b\u540e\uff0c\u5b83\u662f\u4e00\u4e2a\u8282\uff08Section\uff09\u7684\u6570\u7ec4\uff0c\u63cf\u8ff0\u4e86\u6587\u4ef6\u4e2d\u5404\u4e2a\u8282\u7684\u4f4d\u7f6e\u3001\u5927\u5c0f\u3001\u5c5e\u6027\u548c\u5bf9\u5e94\u7684\u5b57\u7b26\u4e32\u8868\u7b49\u4fe1\u606f\u3002\u8282\u901a\u5e38\u7528\u4e8e\u5b58\u50a8\u53ef\u6267\u884c\u4ee3\u7801\u3001\u6570\u636e\u3001\u7b26\u53f7\u8868\u3001\u8c03\u8bd5\u4fe1\u606f\u7b49\u3002</p> </li> <li> <p>\u8282\u533a\uff08Sections\uff09\uff1a\u7d27\u968f\u8282\u5934\u8868\u4e4b\u540e\uff0c\u5305\u542b\u4e86\u5b9e\u9645\u7684\u6570\u636e\u548c\u4ee3\u7801\u3002\u4e0d\u540c\u7c7b\u578b\u7684\u8282\u5177\u6709\u4e0d\u540c\u7684\u4f5c\u7528\uff0c\u5982.text\u8282\u5b58\u50a8\u53ef\u6267\u884c\u4ee3\u7801\uff0c.data\u8282\u5b58\u50a8\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\u6570\u636e\uff0c.bss\u8282\u5b58\u50a8\u672a\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\u6570\u636e\u7b49\u3002</p> </li> <li> <p>\u7b26\u53f7\u8868\uff08Symbol Table\uff09\uff1a\u4f4d\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684\u8282\u4e2d\uff0c\u8bb0\u5f55\u4e86\u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u548c\u5f15\u7528\u7684\u7b26\u53f7\uff08\u5982\u53d8\u91cf\u3001\u51fd\u6570\uff09\u7684\u4fe1\u606f\uff0c\u5305\u62ec\u540d\u79f0\u3001\u5730\u5740\u3001\u5927\u5c0f\u7b49\u3002</p> </li> <li> <p>\u5b57\u7b26\u4e32\u8868\uff08String Table\uff09\uff1a\u4e5f\u662f\u4e00\u4e2a\u7279\u5b9a\u7684\u8282\uff0c\u5b58\u50a8\u4e86\u5176\u4ed6\u90e8\u5206\u4f7f\u7528\u7684\u5b57\u7b26\u4e32\uff0c\u5982\u7b26\u53f7\u8868\u4e2d\u7684\u7b26\u53f7\u540d\u79f0\u7b49\u3002</p> </li> </ol> <p>\u9664\u4e86\u4e0a\u8ff0\u57fa\u672c\u7ed3\u6784\uff0cELF\u6587\u4ef6\u53ef\u80fd\u8fd8\u5305\u542b\u5176\u4ed6\u90e8\u5206\uff0c\u5982\u91cd\u5b9a\u4f4d\u8868\uff08Relocation Table\uff09\u3001\u52a8\u6001\u94fe\u63a5\u4fe1\u606f\uff08Dynamic Linking Information\uff09\u3001\u8c03\u8bd5\u4fe1\u606f\uff08Debug Information\uff09\u7b49\uff0c\u8fd9\u4e9b\u90e8\u5206\u5728\u5f00\u53d1\u548c\u8c03\u8bd5\u8fc7\u7a0b\u4e2d\u8d77\u5230\u91cd\u8981\u4f5c\u7528\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go-tricks/","title":"Go-tricks","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go-tricks/#go-trick","title":"Go #trick","text":"<ul> <li>go\u7a0b\u5e8f \u7f51\u7edc\u4ee3\u7406</li> </ul> <pre><code>// \u8bbe\u7f6e\u4ee3\u7406\nvar (\n    proxyUrl, err = url.Parse(\"http://127.0.0.1:7890\")\n\n    client = http.Client{\n        Transport: &amp;http.Transport{\n            Proxy: http.ProxyURL(proxyUrl),\n        },\n    }\n)\n</code></pre> <p>\u547d\u4ee4\u884c\u52a0\u8f7d </p> <pre><code>go func() {\n    fmt.Print(\"\\033[?25l\") // \u9690\u85cf\u5149\u6807\n    c := [4]byte{'\\\\', '|', '/', '-'}\n    i := 0\n    for {\n        if i == 4 {\n            i = 0\n        }\n        fmt.Print(\"\\b\") // \u9000\u683c\n        fmt.Printf(\"%c\", c[i])\n        time.Sleep(time.Millisecond * 100)\n        i++\n    }\n}()\nfmt.Print(\"\\b\\n\\033[?25h\") // \u6062\u590d\u663e\u793a\u5149\u6807\n</code></pre> <p></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/","title":"Go\u57fa\u7840\u8bed\u6cd5","text":"<p>windo# Golang\u57fa\u7840\u8bed\u6cd5</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#go","title":"go #\u57fa\u7840","text":"<p>A Tour of Go \u4ee3\u7801\uff1agolang/tour: [mirror] A Tour of Go (github.com) \u901a\u8fc7\u4ee5\u4e0b\u6307\u4ee4\u67e5\u770bGo\u7684\u5de5\u4f5c\u76ee\u5f55</p> <pre><code>go env GOPATH\n</code></pre> <p>\u4ea4\u53c9\u7f16\u8bd1 <pre><code># Windows amd64\nCGO_ENABLED=0 GOOS=windows  GOARCH=amd64  go build .\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_1","title":"\u57fa\u7840","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#helloworld","title":"Hello,World!","text":"<pre><code>package main // \u5fc5\u987b\n\n// \u5bfc\u5165\u5176\u4ed6\u5305\u88f9\nimport (\n    \"fmt\"   // \u8f93\u5165\u8f93\u51fa\n)\n\n// \u4e3b\u51fd\u6570\nfun main() { \n    fmt.Println(\"Hello, Wolrd!\")\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_2","title":"\u5b9a\u4e49\u53d8\u91cf","text":"<p>\u5b9a\u4e49\u7684\u53d8\u91cf\u5fc5\u987b\u88ab\u4f7f\u7528\uff0c\u5426\u5219\u5c06\u4f1a\u62a5\u9519</p> <pre><code>var a int       // \u5b9a\u4e49\u6574\u578b\uff0c \u9ed8\u8ba4\u503c\u4e3a0\nvar b string    // \u5b9a\u4e49\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u5b57\u7b26\u4e32\n\n// \u5176\u4ed6\u5b9a\u4e49\u65b9\u6cd5\na := x\nb := \"hi\"\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_3","title":"\u903b\u8f91\u5224\u65ad","text":"<pre><code>if a &gt; 1  {\n    fmt.Println(\"bigger than 1\")\n} else if a &lt; 0 {\n    fmt.Println(\"less than 0\")\n} else {\n    fmt.Println(\"something else\")\n}\n\nif a &gt; 1 &amp;&amp; a &lt; 10 {\n    fmt.Println(\"Right\")\n}\n</code></pre> <p>switch\u7684\u4e00\u4e2acase\u4e2d\u53ef\u4ee5\u652f\u6301\u591a\u4e2a\u76f8\uff0c\u5e76\u4e14\u652f\u6301\u6bd4\u8f83\u7684\u903b\u8f91\u5224\u65ad \u4e0d\u9700\u8981\u5199break <pre><code>switch i {\n    case 0,2:\n        t.Log(\"Even\")\n    case 1,3:\n        t.Log(\"Odd\")\n    default:\n        t.Log(\"it is not 0-3\")\n}\n\nfor i:=0;i&lt;5;i++ {\n        switch {\n        case i%2 == 0:\n            t.Log(\"Even\")\n        case i%2 != 0:\n            t.Log(\"Odd\")\n        default:\n            t.Log(\"unknow\")\n        }\n    }\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_4","title":"\u6570\u7ec4","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_5","title":"\u5b9a\u4e49\u6570\u7ec4","text":"<p>\u6570\u7ec4\u957f\u5ea6\u4e0d\u53ef\u53d8</p> <pre><code>//\u5b9a\u4e49\u6570\u7ec4\nvar a [3] int\n\na := [3]int{1,2,3}\na := [...]int{1,2,3}\n\n// \u5b9a\u4e49\u5207\u7247\na := []int{1,2,3}\n\n// \u4fee\u6539\u6570\u7ec4\u7ec4\u4e2d\u5143\u7d20\u7684\u503c\na[1] = 9\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_6","title":"\u5207\u7247","text":"<p>\u5207\u7247\u7684\u957f\u5ea6\u53ef\u53d8  <pre><code>a := []int{1,2,3,4}\na = append(a,10) // \u7ed3\u5c3e\u6dfb\u52a0\u503c\u4e3a10\u7684\u53d8\u91cf\n//len\u6bcf\u6b21\u52a01\n//len&gt;\u539f\u6709cap\u65f6\uff0ccap=cap*2,\u521b\u5efa\u65b0\u7684\u8fde\u7eed\u5b58\u50a8\u7a7a\u95f4\uff08\u4e0d\u662f\u5728\u539f\u6709\u57fa\u7840\u4e0a\u589e\u52a0\uff09\n</code></pre></p> <p>\u539f\u7406\uff1a\u5207\u7247\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u957f\u5ea6\u7ffb\u500d\u7684\u6570\u7ec4\uff0c\u5c06\u65e7\u6570\u7ec4\u7684\u503c\u62f7\u8d1d\u5230\u65b0\u6570\u7ec4\u4e2d\uff0c\u5e76\u6dfb\u52a0\u65b0\u503c\uff0c\u91ca\u653e\u65e7\u6570\u7ec4\u6240\u5360\u5185\u5b58\u3002</p> <p>len - \u6570\u7ec4\u53ef\u8bbf\u95ee\u7684\u957f\u5ea6 cap - \u6570\u7ec4\u5b9e\u9645\u7684\u5bb9\u91cf cap &gt;= len</p> <p>\u6570\u7ec4\u4e4b\u95f4\u53ef\u4ee5\u6bd4\u8f83 \u5143\u7ec4\u4e4b\u95f4\u4e0d\u80fd\u6bd4\u8f83\uff0c\u53ea\u80fd\u548cnil\u6bd4\u8f83</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_7","title":"\u6620\u5c04","text":"<p>\u7c7b\u4f3c\u4e8e\u8bcd\u5178</p> <pre><code>//\u521d\u59cb\u5316\u6620\u5c04\nnumbers := make(map[string]int)\n\n//\u6620\u5c04\u4e0d\u56fa\u5b9a\u5927\u5c0f\nnumbers[\"one\"] = 1\nnumbers[\"two\"] = 2\n\n//\u5220\u9664\u5173\u952e\u8bcd\ndelete(numbers, \"one\")\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_8","title":"\u5b57\u7b26\u4e32","text":"<p>go\u4e2d\u7684\u5b57\u7b26\u4e32\u672c\u8d28\u662f\u4e0d\u53ef\u53d8\u7684byte\u5207\u7247</p> <p>string\u9ed8\u8ba4\u4e3a \"\"  </p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_9","title":"\u5faa\u73af\u5224\u65ad","text":"<p>go \u8bed\u8a00\u4e2d\u6ca1\u6709while\u5faa\u73af</p> <pre><code>for i := 0; i &lt; 5; i++ {\n    fmt.Println(i)\n} \n</code></pre> <p>\u4f46\u53ef\u4ee5\u901a\u8fc7for\u5faa\u73af\u95f4\u63a5\u5b9e\u73b0</p> <pre><code>i := 0\nfor ; i&lt;5; {\n    fmt.println(i)\n    i++\n}\n\n// \u65e0\u9650\u5faa\u73af\nfor {\n    fmt.println(i)\n    i++\n}\n</code></pre> <p>for\u5faa\u73af\u904d\u5386\u5143\u7ec4\u3001\u6620\u5c04</p> <pre><code>a := []int{1,2,3,4,5}\nfor k, v := range a {\n    fmt.Println(k, v)\n}\n\nfor k, v := range numbers {\n    fmt.Println(k, v)\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_10","title":"\u51fd\u6570","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_11","title":"\u5b9a\u4e49\u51fd\u6570","text":"<pre><code>func add(x int, y int) int {\n    return x + y\n}\n</code></pre> <p>\u53ef\u4ee5\u4e0d\u8fd4\u56de\u503c\uff0c\u4e5f\u53ef\u4ee5\u8fd4\u56de\u591a\u4e2a\u503c</p> <pre><code>func do_math(x int, y int) (int,int) {\n    return x+y, x*y\n}\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u51fd\u6570\uff08\u95ed\u5305\uff09</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_12","title":"\u51fd\u6570\u7684\u95ed\u5305","text":"<p>\u95ed\u5305\u662f\u4e00\u4e2a\u51fd\u6570\u503c\uff0c\u5b83\u5f15\u7528\u4e86\u5176\u51fd\u6570\u4f53\u4e4b\u5916\u7684\u53d8\u91cf\u3002\u8be5\u51fd\u6570\u53ef\u4ee5\u8bbf\u95ee\u5e76\u8d4b\u4e88\u5176\u5f15\u7528\u7684\u53d8\u91cf\u7684\u503c\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u8be5\u51fd\u6570\u88ab\u8fd9\u4e9b\u53d8\u91cf\u201c\u7ed1\u5b9a\u201d\u5728\u4e00\u8d77\u3002</p> <p>\u4f8b\u5982\uff0c\u51fd\u6570\u00a0<code>adder</code>\u00a0\u8fd4\u56de\u4e00\u4e2a\u95ed\u5305\u3002\u6bcf\u4e2a\u95ed\u5305\u90fd\u88ab\u7ed1\u5b9a\u5728\u5176\u5404\u81ea\u7684\u00a0<code>sum</code>\u00a0\u53d8\u91cf\u4e0a\u3002 <pre><code>func adder() func(int) int {\n    sum := 0\n    return func(x int) int {\n        sum += x\n        return sum\n    }\n}\n\nfunc main() {\n    pos, neg := adder(), adder()\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(\n            pos(i),\n            neg(-2*i),\n        )\n    }\n}\n</code></pre></p> <p>\u4f7f\u7528\u51fd\u6570\u7684\u95ed\u5305\u5b9e\u73b0\u6590\u6ce2\u90a3\u5951\u6570\u5217 <pre><code>// \u8fd4\u56de\u4e00\u4e2a\u201c\u8fd4\u56deint\u7684\u51fd\u6570\u201d\nfunc fibonacci() func() int {\n    v1,v2:=0,1\n    return func() int {\n        ans:=v1\n        v1,v2=v2,v1+v2\n        return ans\n    }\n}\n\nfunc main() {\n    f := fibonacci()\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(f())\n    }\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_13","title":"\u6307\u9488","text":"<pre><code>n := 0\nadd(&amp;n)\nfmt.Println(n)\n\nfunc add(n *int) {\n    *n = *n + 1\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_14","title":"\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b","text":"<p>go\u8bed\u8a00\u5e76\u975e\u5b8c\u5168\u7684\u9762\u5411\u5bf9\u8c61\u8bed\u8a00\uff0c\u6ca1\u6709\u7c7b</p> <pre><code>// \u5b9a\u4e49\u7ed3\u6784\u4f53\ntype cat struct {\n    name string\n    age int\n}\n\nfunc main() {\n    cat1 := cat{name: \"kitty\", age: 3}\n    cat1.age=4\n    fmt.Println(cat1)\n}\n</code></pre> <p>\u53ef\u4ee5\u7ed9\u81ea\u5b9a\u4e49\u7c7b\u578b\u521b\u5efa\u65b9\u6cd5</p> <pre><code>type MyFloat float64\n\nfunc (n MyFloat) show() {\n    fmt.Println(n)\n}\n\nfunc main() {\n    var a MyFloat = 1.5\n    a.show()\n}\n//\u540c\u6837\u53ef\u4ee5\u4f7f\u7528\u6307\u9488\n</code></pre> <p></p> <p>vscode \u9519\u8bef\uff1a\u65e0\u6cd5\u5b89\u88c5div \uff0c\u89e3\u51b3\u65b9\u6cd5\uff1a\u8bbe\u7f6eGOARCH=amd64</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#go_1","title":"Go\u7684\u6d4b\u8bd5\u65b9\u6cd5","text":"<p>\u6587\u4ef6\u540d\u4e3axxx_test.go \u6d4b\u8bd5\u51fd\u6570\u547d\u540d\u65b9\u5f0f\u4e3a Test+Xxx <pre><code>import \"testing\"\n\nfunc TestFirst(t *testing.T) {\n\u00a0 \u00a0 t.Log(\"My first try!\")\n}\n</code></pre></p> <p>go\u8bed\u8a00\u53d8\u91cf\u7c7b\u578b\u6ca1\u6709\u9690\u5f0f\u8f6c\u6362\u3002\u4f8b\u5982\uff0cint32\u7684\u53d8\u91cfa\u4e0d\u80fd\u76f4\u63a5\u8d4b\u503c\u7ed9int64\u7684\u53d8\u91cfb\uff0c\u5fc5\u987b\u5c06a\u5f3a\u5236\u8f6c\u6362\u4e3aint64</p> <p></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#defer","title":"defer","text":"<p><pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    defer fmt.Println(\"world\")\n\n    fmt.Println(\"hello\")\n}\n/*\noutput:\n\nhello\nworld\n\n*/\n</code></pre> </p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_15","title":"\u65b9\u6cd5\u548c\u63a5\u53e3","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_16","title":"\u65b9\u6cd5","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_17","title":"\u5b9a\u4e49\u65b9\u6cd5","text":"<p>\u65b9\u6cd5\u5c31\u662f\u4e00\u7c7b\u5e26\u7279\u6b8a\u7684\u00a0\u63a5\u6536\u8005\u00a0\u53c2\u6570\u7684\u51fd\u6570\u3002</p> <p>\u65b9\u6cd5\u63a5\u6536\u8005\u5728\u5b83\u81ea\u5df1\u7684\u53c2\u6570\u5217\u8868\u5185\uff0c\u4f4d\u4e8e\u00a0<code>func</code>\u00a0\u5173\u952e\u5b57\u548c\u65b9\u6cd5\u540d\u4e4b\u95f4\u3002</p> <p>\u5728\u6b64\u4f8b\u4e2d\uff0c<code>Abs</code>\u00a0\u65b9\u6cd5\u62e5\u6709\u4e00\u4e2a\u540d\u4e3a\u00a0<code>v</code>\uff0c\u7c7b\u578b\u4e3a\u00a0<code>Vertex</code>\u00a0\u7684\u63a5\u6536\u8005\u3002</p> <pre><code>type Vertex struct {\n    X, Y float64\n}\n\nfunc (v Vertex) Abs() float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\nfunc main() {\n    v := Vertex{3, 4}\n    fmt.Println(v.Abs())\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_18","title":"\u65b9\u6cd5\u5373\u51fd\u6570","text":"<p>\u8bb0\u4f4f\uff1a\u65b9\u6cd5\u53ea\u662f\u4e2a\u5e26\u63a5\u6536\u8005\u53c2\u6570\u7684\u51fd\u6570\u3002</p> <p>\u73b0\u5728\u8fd9\u4e2a\u00a0<code>Abs</code>\u00a0\u7684\u5199\u6cd5\u5c31\u662f\u4e2a\u6b63\u5e38\u7684\u51fd\u6570\uff0c\u529f\u80fd\u5e76\u6ca1\u6709\u4ec0\u4e48\u53d8\u5316\u3002</p> <pre><code>type Vertex struct {\n    X, Y float64\n}\n\nfunc Abs(v Vertex) float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\nfunc main() {\n    v := Vertex{3, 4}\n    fmt.Println(Abs(v))\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_19","title":"\u975e\u7ed3\u6784\u4f53\u65b9\u6cd5","text":"<p>\u4f60\u4e5f\u53ef\u4ee5\u4e3a\u975e\u7ed3\u6784\u4f53\u7c7b\u578b\u58f0\u660e\u65b9\u6cd5\u3002</p> <p>\u5728\u6b64\u4f8b\u4e2d\uff0c\u6211\u4eec\u770b\u5230\u4e86\u4e00\u4e2a\u5e26\u00a0<code>Abs</code>\u00a0\u65b9\u6cd5\u7684\u6570\u503c\u7c7b\u578b\u00a0<code>MyFloat</code>\u3002</p> <p>\u4f60\u53ea\u80fd\u4e3a\u5728\u540c\u4e00\u5305\u5185\u5b9a\u4e49\u7684\u7c7b\u578b\u7684\u63a5\u6536\u8005\u58f0\u660e\u65b9\u6cd5\uff0c\u800c\u4e0d\u80fd\u4e3a\u5176\u5b83\u5305\u5185\u5b9a\u4e49\u7684\u7c7b\u578b\uff08\u5305\u62ec\u00a0<code>int</code>\u00a0\u4e4b\u7c7b\u7684\u5185\u5efa\u7c7b\u578b\uff09\u7684\u63a5\u6536\u8005\u58f0\u660e\u65b9\u6cd5\u3002</p> <p>\uff08\u8bd1\u6ce8\uff1a\u5c31\u662f\u63a5\u6536\u8005\u7684\u7c7b\u578b\u5b9a\u4e49\u548c\u65b9\u6cd5\u58f0\u660e\u5fc5\u987b\u5728\u540c\u4e00\u5305\u5185\uff1b\u4e0d\u80fd\u4e3a\u5185\u5efa\u7c7b\u578b\u58f0\u660e\u65b9\u6cd5\u3002\uff09</p> <pre><code>type MyFloat float64\n\nfunc (f MyFloat) Abs() float64 {\n    if f &lt; 0 {\n        return float64(-f)\n    }\n    return float64(f)\n}\n\nfunc main() {\n    f := MyFloat(-math.Sqrt2)\n    fmt.Println(f.Abs())\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_20","title":"\u6307\u9488\u63a5\u6536\u8005\u58f0\u660e\u65b9\u6cd5","text":"<p>\u4f60\u53ef\u4ee5\u4e3a\u6307\u9488\u63a5\u6536\u8005\u58f0\u660e\u65b9\u6cd5\u3002</p> <p>\u8fd9\u610f\u5473\u7740\u5bf9\u4e8e\u67d0\u7c7b\u578b\u00a0<code>T</code>\uff0c\u63a5\u6536\u8005\u7684\u7c7b\u578b\u53ef\u4ee5\u7528\u00a0<code>*T</code>\u00a0\u7684\u6587\u6cd5\u3002\uff08\u6b64\u5916\uff0c<code>T</code>\u00a0\u4e0d\u80fd\u662f\u50cf\u00a0<code>*int</code>\u00a0\u8fd9\u6837\u7684\u6307\u9488\u3002\uff09</p> <p>\u4f8b\u5982\uff0c\u8fd9\u91cc\u4e3a\u00a0<code>*Vertex</code>\u00a0\u5b9a\u4e49\u4e86\u00a0<code>Scale</code>\u00a0\u65b9\u6cd5\u3002</p> <p>\u6307\u9488\u63a5\u6536\u8005\u7684\u65b9\u6cd5\u53ef\u4ee5\u4fee\u6539\u63a5\u6536\u8005\u6307\u5411\u7684\u503c\uff08\u5c31\u50cf\u00a0<code>Scale</code>\u00a0\u5728\u8fd9\u505a\u7684\uff09\u3002\u7531\u4e8e\u65b9\u6cd5\u7ecf\u5e38\u9700\u8981\u4fee\u6539\u5b83\u7684\u63a5\u6536\u8005\uff0c\u6307\u9488\u63a5\u6536\u8005\u6bd4\u503c\u63a5\u6536\u8005\u66f4\u5e38\u7528\u3002</p> <p>\u8bd5\u7740\u79fb\u9664\u7b2c 16 \u884c\u00a0<code>Scale</code>\u00a0\u51fd\u6570\u58f0\u660e\u4e2d\u7684\u00a0<code>*</code>\uff0c\u89c2\u5bdf\u6b64\u7a0b\u5e8f\u7684\u884c\u4e3a\u5982\u4f55\u53d8\u5316\u3002</p> <p>\u82e5\u4f7f\u7528\u503c\u63a5\u6536\u8005\uff0c\u90a3\u4e48\u00a0<code>Scale</code>\u00a0\u65b9\u6cd5\u4f1a\u5bf9\u539f\u59cb\u00a0<code>Vertex</code>\u00a0\u503c\u7684\u526f\u672c\u8fdb\u884c\u64cd\u4f5c\u3002\uff08\u5bf9\u4e8e\u51fd\u6570\u7684\u5176\u5b83\u53c2\u6570\u4e5f\u662f\u5982\u6b64\u3002\uff09<code>Scale</code>\u00a0\u65b9\u6cd5\u5fc5\u987b\u7528\u6307\u9488\u63a5\u53d7\u8005\u6765\u66f4\u6539\u00a0<code>main</code>\u00a0\u51fd\u6570\u4e2d\u58f0\u660e\u7684\u00a0<code>Vertex</code>\u00a0\u7684\u503c\u3002</p> <pre><code>type Vertex struct {\n    X, Y float64\n}\n\nfunc (v Vertex) Abs() float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\nfunc (v *Vertex) Scale(f float64) {\n    v.X = v.X * f\n    v.Y = v.Y * f\n}\n\nfunc main() {\n    v := Vertex{3, 4}\n    v.Scale(10)\n    fmt.Println(v.Abs())\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_21","title":"\u5c06\u65b9\u6cd5\u91cd\u5199\u4e3a\u51fd\u6570","text":"<pre><code>type Vertex struct {\n    X, Y float64\n}\n\nfunc Abs(v Vertex) float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\nfunc Scale(v *Vertex, f float64) {\n    v.X = v.X * f\n    v.Y = v.Y * f\n}\n\nfunc main() {\n    v := Vertex{3, 4}\n    Scale(&amp;v, 10)\n    fmt.Println(Abs(v))\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_22","title":"\u65b9\u6cd5\u4e0e\u6307\u9488\u91cd\u5b9a\u5411","text":"<p>\u4f60\u5927\u6982\u4f1a\u6ce8\u610f\u5230\u5e26\u6307\u9488\u53c2\u6570\u7684\u51fd\u6570\u5fc5\u987b\u63a5\u53d7\u4e00\u4e2a\u6307\u9488\uff1a <pre><code>var v Vertex\nScaleFunc(v, 5)  // \u7f16\u8bd1\u9519\u8bef\uff01\nScaleFunc(&amp;v, 5) // OK\n</code></pre></p> <p>\u800c\u4ee5\u6307\u9488\u4e3a\u63a5\u6536\u8005\u7684\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\uff0c\u63a5\u6536\u8005\u65e2\u80fd\u4e3a\u503c\u53c8\u80fd\u4e3a\u6307\u9488\uff1a</p> <p><pre><code>var v Vertex\nv.Scale(5)  // OK\np := &amp;v\np.Scale(10) // OK\n</code></pre> \u5bf9\u4e8e\u8bed\u53e5\u00a0<code>v.Scale(5)</code>\uff0c\u5373\u4fbf\u00a0<code>v</code>\u00a0\u662f\u4e2a\u503c\u800c\u975e\u6307\u9488\uff0c\u5e26\u6307\u9488\u63a5\u6536\u8005\u7684\u65b9\u6cd5\u4e5f\u80fd\u88ab\u76f4\u63a5\u8c03\u7528\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c\u7531\u4e8e\u00a0<code>Scale</code>\u00a0\u65b9\u6cd5\u6709\u4e00\u4e2a\u6307\u9488\u63a5\u6536\u8005\uff0c\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0cGo \u4f1a\u5c06\u8bed\u53e5\u00a0<code>v.Scale(5)</code>\u00a0\u89e3\u91ca\u4e3a\u00a0<code>(&amp;v).Scale(5)</code>\u3002</p> <pre><code>type Vertex struct {\n    X, Y float64\n}\n\nfunc (v *Vertex) Scale(f float64) {\n    v.X = v.X * f\n    v.Y = v.Y * f\n}\n\nfunc ScaleFunc(v *Vertex, f float64) {\n    v.X = v.X * f\n    v.Y = v.Y * f\n}\n\nfunc main() {\n    v := Vertex{3, 4}\n    v.Scale(2)\n    ScaleFunc(&amp;v, 10)\n\n    p := &amp;Vertex{4, 3}\n    p.Scale(3)\n    ScaleFunc(p, 8)\n\n    fmt.Println(v, p)\n}\n</code></pre> <p>\u540c\u6837\u7684\u4e8b\u60c5\u4e5f\u53d1\u751f\u5728\u76f8\u53cd\u7684\u65b9\u5411\u3002</p> <p>\u63a5\u53d7\u4e00\u4e2a\u503c\u4f5c\u4e3a\u53c2\u6570\u7684\u51fd\u6570\u5fc5\u987b\u63a5\u53d7\u4e00\u4e2a\u6307\u5b9a\u7c7b\u578b\u7684\u503c\uff1a</p> <pre><code>var v Vertex\nfmt.Println(AbsFunc(v))  // OK\nfmt.Println(AbsFunc(&amp;v)) // \u7f16\u8bd1\u9519\u8bef\uff01\n</code></pre> <p>\u800c\u4ee5\u503c\u4e3a\u63a5\u6536\u8005\u7684\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\uff0c\u63a5\u6536\u8005\u65e2\u80fd\u4e3a\u503c\u53c8\u80fd\u4e3a\u6307\u9488\uff1a</p> <pre><code>var v Vertex\nfmt.Println(v.Abs()) // OK\np := &amp;v\nfmt.Println(p.Abs()) // OK\n</code></pre> <p>\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u65b9\u6cd5\u8c03\u7528\u00a0<code>p.Abs()</code>\u00a0\u4f1a\u88ab\u89e3\u91ca\u4e3a\u00a0<code>(*p).Abs()</code>\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_23","title":"\u9009\u62e9\u503c\u6216\u6307\u9488\u4f5c\u4e3a\u63a5\u6536\u8005","text":"<p>\u4f7f\u7528\u6307\u9488\u63a5\u6536\u8005\u7684\u539f\u56e0\u6709\u4e8c\uff1a \u9996\u5148\uff0c\u65b9\u6cd5\u80fd\u591f\u4fee\u6539\u5176\u63a5\u6536\u8005\u6307\u5411\u7684\u503c\u3002 \u5176\u6b21\uff0c\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u5728\u6bcf\u6b21\u8c03\u7528\u65b9\u6cd5\u65f6\u590d\u5236\u8be5\u503c\u3002\u82e5\u503c\u7684\u7c7b\u578b\u4e3a\u5927\u578b\u7ed3\u6784\u4f53\u65f6\uff0c\u8fd9\u6837\u505a\u4f1a\u66f4\u52a0\u9ad8\u6548\u3002</p> <p>\u5728\u672c\u4f8b\u4e2d\uff0c<code>Scale</code>\u00a0\u548c\u00a0<code>Abs</code>\u00a0\u63a5\u6536\u8005\u7684\u7c7b\u578b\u4e3a\u00a0<code>*Vertex</code>\uff0c\u5373\u4fbf\u00a0<code>Abs</code>\u00a0\u5e76\u4e0d\u9700\u8981\u4fee\u6539\u5176\u63a5\u6536\u8005\u3002</p> <p>\u901a\u5e38\u6765\u8bf4\uff0c\u6240\u6709\u7ed9\u5b9a\u7c7b\u578b\u7684\u65b9\u6cd5\u90fd\u5e94\u8be5\u6709\u503c\u6216\u6307\u9488\u63a5\u6536\u8005\uff0c\u4f46\u5e76\u4e0d\u5e94\u8be5\u4e8c\u8005\u6df7\u7528\u3002\uff08\u6211\u4eec\u4f1a\u5728\u63a5\u4e0b\u6765\u660e\u767d\u4e3a\u4ec0\u4e48\u3002\uff09</p> <pre><code>type Vertex struct {\n    X, Y float64\n}\n\nfunc (v *Vertex) Scale(f float64) {\n    v.X = v.X * f\n    v.Y = v.Y * f\n}\n\nfunc (v *Vertex) Abs() float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n\nfunc main() {\n    v := &amp;Vertex{3, 4}\n    fmt.Printf(\"Before scaling: %+v, Abs: %v\\n\", v, v.Abs())\n    v.Scale(5)\n    fmt.Printf(\"After scaling: %+v, Abs: %v\\n\", v, v.Abs())\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_24","title":"\u63a5\u53e3","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_25","title":"\u5b9a\u4e49\u63a5\u53e3","text":"<p>\u63a5\u53e3\u7c7b\u578b\u00a0\u662f\u7531\u4e00\u7ec4\u65b9\u6cd5\u7b7e\u540d\u5b9a\u4e49\u7684\u96c6\u5408\u3002</p> <p>\u63a5\u53e3\u7c7b\u578b\u7684\u53d8\u91cf\u53ef\u4ee5\u4fdd\u5b58\u4efb\u4f55\u5b9e\u73b0\u4e86\u8fd9\u4e9b\u65b9\u6cd5\u7684\u503c\u3002</p> <p>\u6ce8\u610f:\u00a0\u793a\u4f8b\u4ee3\u7801\u7684 22 \u884c\u5b58\u5728\u4e00\u4e2a\u9519\u8bef\u3002\u7531\u4e8e\u00a0<code>Abs</code>\u00a0\u65b9\u6cd5\u53ea\u4e3a\u00a0<code>*Vertex</code>\u00a0\uff08\u6307\u9488\u7c7b\u578b\uff09\u5b9a\u4e49\uff0c\u56e0\u6b64\u00a0<code>Vertex</code>\uff08\u503c\u7c7b\u578b\uff09\u5e76\u672a\u5b9e\u73b0\u00a0<code>Abser</code>\u3002</p> <pre><code>type Abser interface {\n    Abs() float64\n}\n\nfunc main() {\n    var a Abser\n    f := MyFloat(-math.Sqrt2)\n    v := Vertex{3, 4}\n\n    a = f  // a MyFloat \u5b9e\u73b0\u4e86 Abser\n    a = &amp;v // a *Vertex \u5b9e\u73b0\u4e86 Abser\n\n    // \u4e0b\u9762\u4e00\u884c\uff0cv \u662f\u4e00\u4e2a Vertex\uff08\u800c\u4e0d\u662f *Vertex\uff09\n    // \u6240\u4ee5\u6ca1\u6709\u5b9e\u73b0 Abser\u3002\n    a = v\n\n    fmt.Println(a.Abs())\n}\n\ntype MyFloat float64\n\nfunc (f MyFloat) Abs() float64 {\n    if f &lt; 0 {\n        return float64(-f)\n    }\n    return float64(f)\n}\n\ntype Vertex struct {\n    X, Y float64\n}\n\nfunc (v *Vertex) Abs() float64 {\n    return math.Sqrt(v.X*v.X + v.Y*v.Y)\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_26","title":"\u63a5\u53e3\u4e0e\u9690\u5f0f\u5b9e\u73b0","text":"<p>\u7c7b\u578b\u901a\u8fc7\u5b9e\u73b0\u4e00\u4e2a\u63a5\u53e3\u7684\u6240\u6709\u65b9\u6cd5\u6765\u5b9e\u73b0\u8be5\u63a5\u53e3\u3002\u65e2\u7136\u65e0\u9700\u4e13\u95e8\u663e\u5f0f\u58f0\u660e\uff0c\u4e5f\u5c31\u6ca1\u6709\u201cimplements\u201d\u5173\u952e\u5b57\u3002 \u9690\u5f0f\u63a5\u53e3\u4ece\u63a5\u53e3\u7684\u5b9e\u73b0\u4e2d\u89e3\u8026\u4e86\u5b9a\u4e49\uff0c\u8fd9\u6837\u63a5\u53e3\u7684\u5b9e\u73b0\u53ef\u4ee5\u51fa\u73b0\u5728\u4efb\u4f55\u5305\u4e2d\uff0c\u65e0\u9700\u63d0\u524d\u51c6\u5907\u3002</p> <p>\u56e0\u6b64\uff0c\u4e5f\u5c31\u65e0\u9700\u5728\u6bcf\u4e00\u4e2a\u5b9e\u73b0\u4e0a\u589e\u52a0\u65b0\u7684\u63a5\u53e3\u540d\u79f0\uff0c\u8fd9\u6837\u540c\u65f6\u4e5f\u9f13\u52b1\u4e86\u660e\u786e\u7684\u63a5\u53e3\u5b9a\u4e49\u3002</p> <pre><code>type I interface {\n    M()\n}\n\ntype T struct {\n    S string\n}\n\n// \u6b64\u65b9\u6cd5\u8868\u793a\u7c7b\u578b T \u5b9e\u73b0\u4e86\u63a5\u53e3 I\uff0c\u4f46\u6211\u4eec\u65e0\u9700\u663e\u5f0f\u58f0\u660e\u6b64\u4e8b\u3002\nfunc (t T) M() {\n    fmt.Println(t.S)\n}\n\nfunc main() {\n    var i I = T{\"hello\"}\n    i.M()\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_27","title":"\u63a5\u53e3\u503c","text":"<p>\u63a5\u53e3\u4e5f\u662f\u503c\u3002\u5b83\u4eec\u53ef\u4ee5\u50cf\u5176\u5b83\u503c\u4e00\u6837\u4f20\u9012\u3002</p> <p>\u63a5\u53e3\u503c\u53ef\u4ee5\u7528\u4f5c\u51fd\u6570\u7684\u53c2\u6570\u6216\u8fd4\u56de\u503c\u3002</p> <p>\u5728\u5185\u90e8\uff0c\u63a5\u53e3\u503c\u53ef\u4ee5\u770b\u505a\u5305\u542b\u503c\u548c\u5177\u4f53\u7c7b\u578b\u7684\u5143\u7ec4\uff1a (value, type)</p> <p>\u63a5\u53e3\u503c\u4fdd\u5b58\u4e86\u4e00\u4e2a\u5177\u4f53\u5e95\u5c42\u7c7b\u578b\u7684\u5177\u4f53\u503c\u3002</p> <p>\u63a5\u53e3\u503c\u8c03\u7528\u65b9\u6cd5\u65f6\u4f1a\u6267\u884c\u5176\u5e95\u5c42\u7c7b\u578b\u7684\u540c\u540d\u65b9\u6cd5\u3002</p> <pre><code>type I interface {\n    M()\n}\n\ntype T struct {\n    S string\n}\n\nfunc (t *T) M() {\n    fmt.Println(t.S)\n}\n\ntype F float64\n\nfunc (f F) M() {\n    fmt.Println(f)\n}\n\nfunc main() {\n    var i I\n\n    i = &amp;T{\"Hello\"}\n    describe(i)    // (&amp;{Hello}, *main.T)\n    i.M()          // Hello\n\n    i = F(math.Pi)\n    describe(i)    // (3.141592653589793, main.F)\n    i.M()          // 3.141592653589793\n}\n\nfunc describe(i I) {\n    fmt.Printf(\"(%v, %T)\\n\", i, i)\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#nil","title":"\u5e95\u5c42\u503c\u4e3a nil \u7684\u63a5\u53e3\u503c","text":"<p>\u5373\u4fbf\u63a5\u53e3\u5185\u7684\u5177\u4f53\u503c\u4e3a nil\uff0c\u65b9\u6cd5\u4ecd\u7136\u4f1a\u88ab nil \u63a5\u6536\u8005\u8c03\u7528\u3002</p> <p>\u5728\u4e00\u4e9b\u8bed\u8a00\u4e2d\uff0c\u8fd9\u4f1a\u89e6\u53d1\u4e00\u4e2a\u7a7a\u6307\u9488\u5f02\u5e38\uff0c\u4f46\u5728 Go \u4e2d\u901a\u5e38\u4f1a\u5199\u4e00\u4e9b\u65b9\u6cd5\u6765\u4f18\u96c5\u5730\u5904\u7406\u5b83\uff08\u5982\u672c\u4f8b\u4e2d\u7684\u00a0<code>M</code>\u00a0\u65b9\u6cd5\uff09\u3002</p> <p>\u6ce8\u610f:\u00a0\u4fdd\u5b58\u4e86 nil \u5177\u4f53\u503c\u7684\u63a5\u53e3\u5176\u81ea\u8eab\u5e76\u4e0d\u4e3a nil\u3002 <pre><code>func (t *T) M() {\n    if t == nil {\n        fmt.Println(\"&lt;nil&gt;\")\n        return\n    }\n    fmt.Println(t.S)\n}\n\n// (&lt;nil&gt;, *main.T)\n// &lt;nil&gt;\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#nil_1","title":"nil \u63a5\u53e3\u503c","text":"<p>nil \u63a5\u53e3\u503c\u65e2\u4e0d\u4fdd\u5b58\u503c\u4e5f\u4e0d\u4fdd\u5b58\u5177\u4f53\u7c7b\u578b\u3002</p> <p>\u4e3a nil \u63a5\u53e3\u8c03\u7528\u65b9\u6cd5\u4f1a\u4ea7\u751f\u8fd0\u884c\u65f6\u9519\u8bef\uff0c\u56e0\u4e3a\u63a5\u53e3\u7684\u5143\u7ec4\u5185\u5e76\u672a\u5305\u542b\u80fd\u591f\u6307\u660e\u8be5\u8c03\u7528\u54ea\u4e2a\u00a0\u5177\u4f53\u00a0\u65b9\u6cd5\u7684\u7c7b\u578b\u3002</p> <pre><code>type I interface {\n    M()\n}\n\nfunc main() {\n    var i I\n    describe(i)\n    i.M()\n}\n\nfunc describe(i I) {\n    fmt.Printf(\"(%v, %T)\\n\", i, i)\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_28","title":"\u7a7a\u63a5\u53e3","text":"<p>\u6307\u5b9a\u4e86\u96f6\u4e2a\u65b9\u6cd5\u7684\u63a5\u53e3\u503c\u88ab\u79f0\u4e3a \u7a7a\u63a5\u53e3\uff1a</p> <p>interface{}</p> <p>\u7a7a\u63a5\u53e3\u53ef\u4fdd\u5b58\u4efb\u4f55\u7c7b\u578b\u7684\u503c\u3002\uff08\u56e0\u4e3a\u6bcf\u4e2a\u7c7b\u578b\u90fd\u81f3\u5c11\u5b9e\u73b0\u4e86\u96f6\u4e2a\u65b9\u6cd5\u3002\uff09</p> <p>\u7a7a\u63a5\u53e3\u88ab\u7528\u6765\u5904\u7406\u672a\u77e5\u7c7b\u578b\u7684\u503c\u3002\u4f8b\u5982\uff0c<code>fmt.Print</code>\u00a0\u53ef\u63a5\u53d7\u7c7b\u578b\u4e3a\u00a0<code>interface{}</code>\u00a0\u7684\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\u3002</p> <pre><code>func main() {\n    var i interface{}\n    describe(i)\n\n    i = 42\n    describe(i)\n\n    i = \"hello\"\n    describe(i)\n}\n\nfunc describe(i interface{}) {\n    fmt.Printf(\"(%v, %T)\\n\", i, i)\n}\n\n// (&lt;nil&gt;, &lt;nil&gt;)\n// (42, int)\n// (hello, string)\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_29","title":"\u7c7b\u578b","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_30","title":"\u7c7b\u578b\u65ad\u8a00","text":"<p>\u7c7b\u578b\u65ad\u8a00\u00a0\u63d0\u4f9b\u4e86\u8bbf\u95ee\u63a5\u53e3\u503c\u5e95\u5c42\u5177\u4f53\u503c\u7684\u65b9\u5f0f\u3002</p> <p>t := i.(T)</p> <p>\u8be5\u8bed\u53e5\u65ad\u8a00\u63a5\u53e3\u503c\u00a0<code>i</code>\u00a0\u4fdd\u5b58\u4e86\u5177\u4f53\u7c7b\u578b\u00a0<code>T</code>\uff0c\u5e76\u5c06\u5176\u5e95\u5c42\u7c7b\u578b\u4e3a\u00a0<code>T</code>\u00a0\u7684\u503c\u8d4b\u4e88\u53d8\u91cf\u00a0<code>t</code>\u3002</p> <p>\u82e5\u00a0<code>i</code>\u00a0\u5e76\u672a\u4fdd\u5b58\u00a0<code>T</code>\u00a0\u7c7b\u578b\u7684\u503c\uff0c\u8be5\u8bed\u53e5\u5c31\u4f1a\u89e6\u53d1\u4e00\u4e2apanic\u3002</p> <p>\u4e3a\u4e86\u00a0\u5224\u65ad\u00a0\u4e00\u4e2a\u63a5\u53e3\u503c\u662f\u5426\u4fdd\u5b58\u4e86\u4e00\u4e2a\u7279\u5b9a\u7684\u7c7b\u578b\uff0c\u7c7b\u578b\u65ad\u8a00\u53ef\u8fd4\u56de\u4e24\u4e2a\u503c\uff1a\u5176\u5e95\u5c42\u503c\u4ee5\u53ca\u4e00\u4e2a\u62a5\u544a\u65ad\u8a00\u662f\u5426\u6210\u529f\u7684\u5e03\u5c14\u503c\u3002</p> <p>t, ok := i.(T)</p> <p>\u82e5\u00a0<code>i</code>\u00a0\u4fdd\u5b58\u4e86\u4e00\u4e2a\u00a0<code>T</code>\uff0c\u90a3\u4e48\u00a0<code>t</code>\u00a0\u5c06\u4f1a\u662f\u5176\u5e95\u5c42\u503c\uff0c\u800c\u00a0<code>ok</code>\u00a0\u4e3a\u00a0<code>true</code>\u3002</p> <p>\u5426\u5219\uff0c<code>ok</code>\u00a0\u5c06\u4e3a\u00a0<code>false</code>\u00a0\u800c\u00a0<code>t</code>\u00a0\u5c06\u4e3a\u00a0<code>T</code>\u00a0\u7c7b\u578b\u7684\u96f6\u503c\uff0c\u7a0b\u5e8f\u5e76\u4e0d\u4f1a\u4ea7\u751fpanic\u3002</p> <p>\u8bf7\u6ce8\u610f\u8fd9\u79cd\u8bed\u6cd5\u548c\u8bfb\u53d6\u4e00\u4e2a\u6620\u5c04\u65f6\u7684\u76f8\u540c\u4e4b\u5904\u3002</p> <pre><code>func main() {\n    var i interface{} = \"hello\"\n\n    s := i.(string)\n    fmt.Println(s) //hello\n\n    s, ok := i.(string)\n    fmt.Println(s, ok) //hello true\n\n    f, ok := i.(float64)\n    fmt.Println(f, ok) //0 false\n\n    f = i.(float64) // \u62a5\u9519(panic)\n    fmt.Println(f)\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_31","title":"\u7c7b\u578b\u9009\u62e9","text":"<p>\u7c7b\u578b\u9009\u62e9\u00a0\u662f\u4e00\u79cd\u6309\u987a\u5e8f\u4ece\u51e0\u4e2a\u7c7b\u578b\u65ad\u8a00\u4e2d\u9009\u62e9\u5206\u652f\u7684\u7ed3\u6784\u3002</p> <p>\u7c7b\u578b\u9009\u62e9\u4e0e\u4e00\u822c\u7684 switch \u8bed\u53e5\u76f8\u4f3c\uff0c\u4e0d\u8fc7\u7c7b\u578b\u9009\u62e9\u4e2d\u7684 case \u4e3a\u7c7b\u578b\uff08\u800c\u975e\u503c\uff09\uff0c \u5b83\u4eec\u9488\u5bf9\u7ed9\u5b9a\u63a5\u53e3\u503c\u6240\u5b58\u50a8\u7684\u503c\u7684\u7c7b\u578b\u8fdb\u884c\u6bd4\u8f83\u3002</p> <pre><code>switch v := i.(type) {\ncase T:\n    // v \u7684\u7c7b\u578b\u4e3a T\ncase S:\n    // v \u7684\u7c7b\u578b\u4e3a S\ndefault:\n    // \u6ca1\u6709\u5339\u914d\uff0cv \u4e0e i \u7684\u7c7b\u578b\u76f8\u540c\n}\n</code></pre> <p>\u7c7b\u578b\u9009\u62e9\u4e2d\u7684\u58f0\u660e\u4e0e\u7c7b\u578b\u65ad\u8a00\u00a0<code>i.(T)</code>\u00a0\u7684\u8bed\u6cd5\u76f8\u540c\uff0c\u53ea\u662f\u5177\u4f53\u7c7b\u578b\u00a0<code>T</code>\u00a0\u88ab\u66ff\u6362\u6210\u4e86\u5173\u952e\u5b57\u00a0<code>type</code>\u3002</p> <p>\u6b64\u9009\u62e9\u8bed\u53e5\u5224\u65ad\u63a5\u53e3\u503c\u00a0<code>i</code>\u00a0\u4fdd\u5b58\u7684\u503c\u7c7b\u578b\u662f\u00a0<code>T</code>\u00a0\u8fd8\u662f\u00a0<code>S</code>\u3002\u5728\u00a0<code>T</code>\u00a0\u6216\u00a0<code>S</code>\u00a0\u7684\u60c5\u51b5\u4e0b\uff0c\u53d8\u91cf\u00a0<code>v</code>\u00a0\u4f1a\u5206\u522b\u6309\u00a0<code>T</code>\u00a0\u6216\u00a0<code>S</code>\u00a0\u7c7b\u578b\u4fdd\u5b58\u00a0<code>i</code>\u00a0\u62e5\u6709\u7684\u503c\u3002\u5728\u9ed8\u8ba4\uff08\u5373\u6ca1\u6709\u5339\u914d\uff09\u7684\u60c5\u51b5\u4e0b\uff0c\u53d8\u91cf\u00a0<code>v</code>\u00a0\u4e0e\u00a0<code>i</code>\u00a0\u7684\u63a5\u53e3\u7c7b\u578b\u548c\u503c\u76f8\u540c\u3002 <pre><code>func do(i interface{}) {\n    switch v := i.(type) {\n    case int:\n        fmt.Printf(\"Twice %v is %v\\n\", v, v*2)\n    case string:\n        fmt.Printf(\"%q is %v bytes long\\n\", v, len(v))\n    default:\n        fmt.Printf(\"I don't know about type %T!\\n\", v)\n    }\n}\n\nfunc main() {\n    do(21)\n    do(\"hello\")\n    do(true)\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#stringer","title":"Stringer","text":"<p><code>fmt</code>\u00a0\u5305\u4e2d\u5b9a\u4e49\u7684\u00a0<code>Stringer</code>\u00a0\u662f\u6700\u666e\u904d\u7684\u63a5\u53e3\u4e4b\u4e00\u3002</p> <pre><code>type Stringer interface {\n    String() string\n}\n</code></pre> <p><code>Stringer</code>\u00a0\u662f\u4e00\u4e2a\u53ef\u4ee5\u7528\u5b57\u7b26\u4e32\u63cf\u8ff0\u81ea\u5df1\u7684\u7c7b\u578b\u3002<code>fmt</code>\u00a0\u5305\uff08\u8fd8\u6709\u5f88\u591a\u5305\uff09\u90fd\u901a\u8fc7\u6b64\u63a5\u53e3\u6765\u6253\u5370\u503c\u3002</p> <pre><code>type Person struct {\n    Name string\n    Age  int\n}\n\nfunc (p Person) String() string {\n    return fmt.Sprintf(\"%v (%v years)\", p.Name, p.Age)\n}\n\nfunc main() {\n    a := Person{\"Arthur Dent\", 42}\n    z := Person{\"Zaphod Beeblebrox\", 9001}\n    fmt.Println(a, z)\n}\n\n// Arthur Dent (42 years) Zaphod Beeblebrox (9001 years)\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#stringer_1","title":"\u7ec3\u4e60\uff1aStringer","text":"<p>\u901a\u8fc7\u8ba9\u00a0<code>IPAddr</code>\u00a0\u7c7b\u578b\u5b9e\u73b0\u00a0<code>fmt.Stringer</code>\u00a0\u6765\u6253\u5370\u70b9\u53f7\u5206\u9694\u7684\u5730\u5740\u3002</p> <p>\u4f8b\u5982\uff0c<code>IPAddr{1, 2, 3, 4}</code>\u00a0\u5e94\u5f53\u6253\u5370\u4e3a\u00a0<code>\"1.2.3.4\"</code>\u3002</p> <pre><code>package main\n\nimport \"fmt\"\n\ntype IPAddr [4]byte\n/*\nfunc(I IPAddr) String() string {\n    return fmt.Sprintf(\"%v.%v.%v.%v\",I[0],I[1],I[2],I[3])\n}\n*/\nfunc main() {\n    hosts := map[string]IPAddr{\n        \"loopback\":  {127, 0, 0, 1},\n        \"googleDNS\": {8, 8, 8, 8},\n    }\n    for name, ip := range hosts {\n        fmt.Printf(\"%v: %v\\n\", name, ip)\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_32","title":"\u9519\u8bef","text":"<p>Go \u7a0b\u5e8f\u4f7f\u7528\u00a0<code>error</code>\u00a0\u503c\u6765\u8868\u793a\u9519\u8bef\u72b6\u6001\u3002</p> <p>\u4e0e\u00a0<code>fmt.Stringer</code>\u00a0\u7c7b\u4f3c\uff0c<code>error</code>\u00a0\u7c7b\u578b\u662f\u4e00\u4e2a\u5185\u5efa\u63a5\u53e3\uff1a</p> <pre><code>type error interface {\n    Error() string\n}\n</code></pre> <p>\uff08\u4e0e\u00a0<code>fmt.Stringer</code>\u00a0\u7c7b\u4f3c\uff0c<code>fmt</code>\u00a0\u5305\u5728\u6253\u5370\u503c\u65f6\u4e5f\u4f1a\u6ee1\u8db3\u00a0<code>error</code>\u3002\uff09</p> <p>\u901a\u5e38\u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a\u00a0<code>error</code>\u00a0\u503c\uff0c\u8c03\u7528\u7684\u5b83\u7684\u4ee3\u7801\u5e94\u5f53\u5224\u65ad\u8fd9\u4e2a\u9519\u8bef\u662f\u5426\u7b49\u4e8e\u00a0<code>nil</code>\u00a0\u6765\u8fdb\u884c\u9519\u8bef\u5904\u7406\u3002</p> <pre><code>i, err := strconv.Atoi(\"42\")\nif err != nil {\n    fmt.Printf(\"couldn't convert number: %v\\n\", err)\n    return\n}\nfmt.Println(\"Converted integer:\", i)\n</code></pre> <p><code>error</code>\u00a0\u4e3a nil \u65f6\u8868\u793a\u6210\u529f\uff1b\u975e nil \u7684\u00a0<code>error</code>\u00a0\u8868\u793a\u5931\u8d25\u3002</p> <pre><code>type MyError struct {\n    When time.Time\n    What string\n}\n\nfunc (e *MyError) Error() string {\n    return fmt.Sprintf(\"at %v, %s\",\n        e.When, e.What)\n}\n\nfunc run() error {\n    return &amp;MyError{\n        time.Now(),\n        \"it didn't work\",\n    }\n}\n\nfunc main() {\n    if err := run(); err != nil {\n        fmt.Println(err)\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_33","title":"\u7ec3\u4e60\uff1a\u9519\u8bef","text":"<p>\u7ec3\u4e60\uff1a\u9519\u8bef \u4ece\u4e4b\u524d\u7684\u7ec3\u4e60\u4e2d\u590d\u5236\u00a0<code>Sqrt</code>\u00a0\u51fd\u6570\uff0c\u4fee\u6539\u5b83\u4f7f\u5176\u8fd4\u56de\u00a0<code>error</code>\u00a0\u503c\u3002</p> <p><code>Sqrt</code>\u00a0\u63a5\u53d7\u5230\u4e00\u4e2a\u8d1f\u6570\u65f6\uff0c\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a\u975e nil \u7684\u9519\u8bef\u503c\u3002\u590d\u6570\u540c\u6837\u4e5f\u4e0d\u88ab\u652f\u6301\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7c7b\u578b</p> <p>type ErrNegativeSqrt float64</p> <p>\u5e76\u4e3a\u5176\u5b9e\u73b0</p> <p>func (e ErrNegativeSqrt) Error() string</p> <p>\u65b9\u6cd5\u4f7f\u5176\u62e5\u6709\u00a0<code>error</code>\u00a0\u503c\uff0c\u901a\u8fc7\u00a0<code>ErrNegativeSqrt(-2).Error()</code>\u00a0\u8c03\u7528\u8be5\u65b9\u6cd5\u5e94\u8fd4\u56de\u00a0<code>\"cannot Sqrt negative number: -2\"</code>\u3002</p> <p>\u6ce8\u610f:\u00a0\u5728\u00a0<code>Error</code>\u00a0\u65b9\u6cd5\u5185\u8c03\u7528\u00a0<code>fmt.Sprint(e)</code>\u00a0\u4f1a\u8ba9\u7a0b\u5e8f\u9677\u5165\u6b7b\u5faa\u73af\u3002\u53ef\u4ee5\u901a\u8fc7\u5148\u8f6c\u6362\u00a0<code>e</code>\u00a0\u6765\u907f\u514d\u8fd9\u4e2a\u95ee\u9898\uff1a<code>fmt.Sprint(float64(e))</code>\u3002\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f</p> <p>\u4fee\u6539\u00a0<code>Sqrt</code>\u00a0\u51fd\u6570\uff0c\u4f7f\u5176\u63a5\u53d7\u4e00\u4e2a\u8d1f\u6570\u65f6\uff0c\u8fd4\u56de\u00a0<code>ErrNegativeSqrt</code>\u00a0\u503c\u3002</p> <pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype ErrNegativeSqrt float64\n\nfunc Sqrt(x float64) (float64, error) {\n    z := x\n    if x &lt; 0 {\n        return 0, ErrNegativeSqrt(x)\n    } else {\n        for {\n            z -= (z*z - x) / (2 * z)\n            t := z*z - x\n            if t &lt; 0 {\n                t = -t\n            }\n            if t &lt; 1e-10 {\n                break\n            }\n        }\n        return z, nil\n    }\n}\n\nfunc (e ErrNegativeSqrt) Error() string {\n    return fmt.Sprintf(\"cannot Sqrt negative number: %v\\n\", float64(e))\n}\n\nfunc main() {\n    fmt.Println(Sqrt(2))\n    fmt.Println(Sqrt(-2))\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#reader","title":"Reader","text":"<p><code>io</code>\u00a0\u5305\u6307\u5b9a\u4e86\u00a0<code>io.Reader</code>\u00a0\u63a5\u53e3\uff0c\u5b83\u8868\u793a\u4ece\u6570\u636e\u6d41\u7684\u672b\u5c3e\u8fdb\u884c\u8bfb\u53d6\u3002</p> <p>Go \u6807\u51c6\u5e93\u5305\u542b\u4e86\u8be5\u63a5\u53e3\u7684\u8bb8\u591a\u5b9e\u73b0\uff0c\u5305\u62ec\u6587\u4ef6\u3001\u7f51\u7edc\u8fde\u63a5\u3001\u538b\u7f29\u548c\u52a0\u5bc6\u7b49\u7b49\u3002</p> <p><code>io.Reader</code>\u00a0\u63a5\u53e3\u6709\u4e00\u4e2a\u00a0<code>Read</code>\u00a0\u65b9\u6cd5\uff1a</p> <p>func (T) Read(b []byte) (n int, err error)</p> <p><code>Read</code>\u00a0\u7528\u6570\u636e\u586b\u5145\u7ed9\u5b9a\u7684\u5b57\u8282\u5207\u7247\u5e76\u8fd4\u56de\u586b\u5145\u7684\u5b57\u8282\u6570\u548c\u9519\u8bef\u503c\u3002\u5728\u9047\u5230\u6570\u636e\u6d41\u7684\u7ed3\u5c3e\u65f6\uff0c\u5b83\u4f1a\u8fd4\u56de\u4e00\u4e2a\u00a0<code>io.EOF</code>\u00a0\u9519\u8bef\u3002</p> <p>\u793a\u4f8b\u4ee3\u7801\u521b\u5efa\u4e86\u4e00\u4e2a\u00a0<code>strings.Reader</code>\u00a0\u5e76\u4ee5\u6bcf\u6b21 8 \u5b57\u8282\u7684\u901f\u5ea6\u8bfb\u53d6\u5b83\u7684\u8f93\u51fa\u3002 <pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"strings\"\n)\n\nfunc main() {\n    r := strings.NewReader(\"Hello, Reader!\")\n\n    b := make([]byte, 8)\n    for {\n        n, err := r.Read(b)\n        fmt.Printf(\"n = %v err = %v b = %v\\n\", n, err, b)\n        fmt.Printf(\"b[:n] = %q\\n\", b[:n])\n        if err == io.EOF {\n            break\n        }\n    }\n}\n/*\nn = 8 err = &lt;nil&gt; b = [72 101 108 108 111 44 32 82]\nb[:n] = \"Hello, R\"\nn = 6 err = &lt;nil&gt; b = [101 97 100 101 114 33 32 82]\nb[:n] = \"eader!\"\nn = 0 err = EOF b = [101 97 100 101 114 33 32 82]\nb[:n] = \"\"\n*/\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#reader_1","title":"\u7ec3\u4e60\uff1aReader","text":"<p>\u5b9e\u73b0\u4e00\u4e2a\u00a0<code>Reader</code>\u00a0\u7c7b\u578b\uff0c\u5b83\u4ea7\u751f\u4e00\u4e2a ASCII \u5b57\u7b26\u00a0<code>'A'</code>\u00a0\u7684\u65e0\u9650\u6d41\u3002 <pre><code>package main\nimport \"golang.org/x/tour/reader\"\ntype MyReader struct{}\n// TODO: \u7ed9 MyReader \u6dfb\u52a0\u4e00\u4e2a Read([]byte) (int, error) \u65b9\u6cd5\nfunc (r MyReader) Read(b []byte) (int,error) {\n    b[0] = 'A'\n    return 1,nil\n}\n\nfunc main() {\n    reader.Validate(MyReader{})\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#rot13reader","title":"\u7ec3\u4e60\uff1arot13Reader","text":"<p>\u6709\u79cd\u5e38\u89c1\u7684\u6a21\u5f0f\u662f\u4e00\u4e2a\u00a0<code>io.Reader</code>\u00a0\u5305\u88c5\u53e6\u4e00\u4e2a\u00a0<code>io.Reader</code>\uff0c\u7136\u540e\u901a\u8fc7\u67d0\u79cd\u65b9\u5f0f\u4fee\u6539\u5176\u6570\u636e\u6d41\u3002</p> <p>\u4f8b\u5982\uff0c<code>gzip.NewReader</code>\u00a0\u51fd\u6570\u63a5\u53d7\u4e00\u4e2a\u00a0<code>io.Reader</code>\uff08\u5df2\u538b\u7f29\u7684\u6570\u636e\u6d41\uff09\u5e76\u8fd4\u56de\u4e00\u4e2a\u540c\u6837\u5b9e\u73b0\u4e86\u00a0<code>io.Reader</code>\u00a0\u7684\u00a0<code>*gzip.Reader</code>\uff08\u89e3\u538b\u540e\u7684\u6570\u636e\u6d41\uff09\u3002</p> <p>\u7f16\u5199\u4e00\u4e2a\u5b9e\u73b0\u4e86\u00a0<code>io.Reader</code>\u00a0\u5e76\u4ece\u53e6\u4e00\u4e2a\u00a0<code>io.Reader</code>\u00a0\u4e2d\u8bfb\u53d6\u6570\u636e\u7684\u00a0<code>rot13Reader</code>\uff0c\u901a\u8fc7\u5e94\u7528\u00a0rot13\u00a0\u4ee3\u6362\u5bc6\u7801\u5bf9\u6570\u636e\u6d41\u8fdb\u884c\u4fee\u6539\u3002</p> <p><code>rot13Reader</code>\u00a0\u7c7b\u578b\u5df2\u7ecf\u63d0\u4f9b\u3002\u5b9e\u73b0\u00a0<code>Read</code>\u00a0\u65b9\u6cd5\u4ee5\u6ee1\u8db3\u00a0<code>io.Reader</code>\u3002</p> <pre><code>package main\n\nimport (\n    \"io\"\n    \"os\"\n    \"strings\"\n)\n\ntype rot13Reader struct {\n    r io.Reader\n}\n\nfunc trans(b byte) byte{\n    switch {\n        case b&gt;='A'&amp;&amp;b&lt;='M':\n        b+=13\n        case b&gt;'M'&amp;&amp;b&lt;='Z':\n        b-=13\n        case b&gt;='a'&amp;&amp;b&lt;='m':\n        b+=13\n        case b&gt;'m'&amp;&amp;b&lt;='z':\n        b-=13\n\n    }\n    return b\n}\n\nfunc (myr rot13Reader) Read(b []byte) (int,error) {\n    n,err:=myr.r.Read(b)\n    for i:=0;i&lt;n;i++ {\n        b[i]=trans(b[i])\n    }\n    return n,err\n}\n\nfunc main() {\n    s := strings.NewReader(\"Lbh penpxrq gur pbqr!\")\n    r := rot13Reader{s}\n    io.Copy(os.Stdout, &amp;r)\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_34","title":"\u56fe\u50cf","text":"<p><code>image</code>\u00a0\u5305\u5b9a\u4e49\u4e86\u00a0<code>Image</code>\u00a0\u63a5\u53e3\uff1a <pre><code>package image\n\ntype Image interface {\n    ColorModel() color.Model\n    Bounds() Rectangle\n    At(x, y int) color.Color\n}\n`````\n**\u6ce8\u610f:**\u00a0`Bounds`\u00a0\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u00a0`Rectangle`\u00a0\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u00a0[`image.Rectangle`](https://go-zh.org/pkg/image/#Rectangle)\uff0c\u5b83\u5728\u00a0`image`\u00a0\u5305\u4e2d\u58f0\u660e\u3002\n\n\uff08\u8bf7\u53c2\u9605[\u6587\u6863](https://go-zh.org/pkg/image/#Image)\u4e86\u89e3\u5168\u90e8\u4fe1\u606f\u3002\uff09\n\n`color.Color`\u00a0\u548c\u00a0`color.Model`\u00a0\u7c7b\u578b\u4e5f\u662f\u63a5\u53e3\uff0c\u4f46\u662f\u901a\u5e38\u56e0\u4e3a\u76f4\u63a5\u4f7f\u7528\u9884\u5b9a\u4e49\u7684\u5b9e\u73b0\u00a0`image.RGBA`\u00a0\u548c\u00a0`image.RGBAModel`\u00a0\u800c\u88ab\u5ffd\u89c6\u4e86\u3002\u8fd9\u4e9b\u63a5\u53e3\u548c\u7c7b\u578b\u7531\u00a0[`image/color`](https://go-zh.org/pkg/image/color/)\u00a0\u5305\u5b9a\u4e49\u3002\n\n```go\nimport (\n    \"fmt\"\n    \"image\"\n)\n\nfunc main() {\n    m := image.NewRGBA(image.Rect(0, 0, 100, 100))\n    fmt.Println(m.Bounds())\n    fmt.Println(m.At(0, 0).RGBA())\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_35","title":"\u7ec3\u4e60\uff1a\u56fe\u50cf","text":"<p>\u8fd8\u8bb0\u5f97\u4e4b\u524d\u7f16\u5199\u7684\u56fe\u7247\u751f\u6210\u5668\u00a0\u5417\uff1f\u6211\u4eec\u518d\u6765\u7f16\u5199\u53e6\u5916\u4e00\u4e2a\uff0c\u4e0d\u8fc7\u8fd9\u6b21\u5b83\u5c06\u4f1a\u8fd4\u56de\u4e00\u4e2a\u00a0<code>image.Image</code>\u00a0\u7684\u5b9e\u73b0\u800c\u975e\u4e00\u4e2a\u6570\u636e\u5207\u7247\u3002</p> <p>\u5b9a\u4e49\u4f60\u81ea\u5df1\u7684\u00a0<code>Image</code>\u00a0\u7c7b\u578b\uff0c\u5b9e\u73b0\u5fc5\u8981\u7684\u65b9\u6cd5\u5e76\u8c03\u7528\u00a0<code>pic.ShowImage</code>\u3002</p> <p><code>Bounds</code>\u00a0\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a\u00a0<code>image.Rectangle</code>\u00a0\uff0c\u4f8b\u5982\u00a0<code>image.Rect(0, 0, w, h)</code>\u3002</p> <p><code>ColorModel</code>\u00a0\u5e94\u5f53\u8fd4\u56de\u00a0<code>color.RGBAModel</code>\u3002</p> <p><code>At</code>\u00a0\u5e94\u5f53\u8fd4\u56de\u4e00\u4e2a\u989c\u8272\u3002\u4e0a\u4e00\u4e2a\u56fe\u7247\u751f\u6210\u5668\u7684\u503c\u00a0<code>v</code>\u00a0\u5bf9\u5e94\u4e8e\u6b64\u6b21\u7684\u00a0<code>color.RGBA{v, v, 255, 255}</code>\u3002</p> <pre><code>package main\n\nimport (\n    \"golang.org/x/tour/pic\"\n    \"image/color\"\n    \"image\"\n)\ntype Image struct{}\n\nfunc (i Image) ColorModel() color.Model {\n    return color.RGBAModel\n}\n\nfunc (i Image) Bounds() image.Rectangle {\n    return image.Rect(0, 0, 200, 200)\n}\n\nfunc (i Image) At(x,y int) color.Color {\n    return color.RGBA{uint8(x), uint8(y), uint8(255), uint8(255)}\n}\n\nfunc main() {\n    m := Image{}\n    pic.ShowImage(m)\n}\n</code></pre> <p>output: </p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_36","title":"\u5e76\u53d1","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#goroutine","title":"goroutine","text":"<p>Go \u7a0b\uff08goroutine\uff09\u662f\u7531 Go \u8fd0\u884c\u65f6\u7ba1\u7406\u7684\u8f7b\u91cf\u7ea7\u7ebf\u7a0b\u3002</p> <p>go f(x, y, z)</p> <p>\u4f1a\u542f\u52a8\u4e00\u4e2a\u65b0\u7684 Go \u7a0b\u5e76\u6267\u884c</p> <p>f(x, y, z)</p> <p><code>f</code>,\u00a0<code>x</code>,\u00a0<code>y</code>\u00a0\u548c\u00a0<code>z</code>\u00a0\u7684\u6c42\u503c\u53d1\u751f\u5728\u5f53\u524d\u7684 Go \u7a0b\u4e2d\uff0c\u800c\u00a0<code>f</code>\u00a0\u7684\u6267\u884c\u53d1\u751f\u5728\u65b0\u7684 Go \u7a0b\u4e2d\u3002</p> <p>Go \u7a0b\u5728\u76f8\u540c\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\u8fd0\u884c\uff0c\u56e0\u6b64\u5728\u8bbf\u95ee\u5171\u4eab\u7684\u5185\u5b58\u65f6\u5fc5\u987b\u8fdb\u884c\u540c\u6b65\u3002<code>sync</code>\u00a0\u5305\u63d0\u4f9b\u4e86\u8fd9\u79cd\u80fd\u529b\uff0c\u4e0d\u8fc7\u5728 Go \u4e2d\u5e76\u4e0d\u7ecf\u5e38\u7528\u5230\uff0c\u56e0\u4e3a\u8fd8\u6709\u5176\u5b83\u7684\u529e\u6cd5\uff08\u89c1\u4e0b\u4e00\u9875\uff09\u3002</p> <pre><code>func say(s string) {\n    for i := 0; i &lt; 5; i++ {\n        time.Sleep(100 * time.Millisecond)\n        fmt.Println(s)\n    }\n}\n\nfunc main() {\n    go say(\"world\")\n    say(\"hello\")\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_37","title":"\u4fe1\u9053","text":"<p>\u4fe1\u9053\u662f\u5e26\u6709\u7c7b\u578b\u7684\u7ba1\u9053\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5b83\u7528\u4fe1\u9053\u64cd\u4f5c\u7b26\u00a0<code>&lt;-</code>\u00a0\u6765\u53d1\u9001\u6216\u8005\u63a5\u6536\u503c\u3002</p> <pre><code>ch &lt;- v    // \u5c06 v \u53d1\u9001\u81f3\u4fe1\u9053 ch\u3002\nv := &lt;-ch  // \u4ece ch \u63a5\u6536\u503c\u5e76\u8d4b\u4e88 v\u3002\n</code></pre> <p>\uff08\u201c\u7bad\u5934\u201d\u5c31\u662f\u6570\u636e\u6d41\u7684\u65b9\u5411\u3002\uff09</p> <p>\u548c\u6620\u5c04\u4e0e\u5207\u7247\u4e00\u6837\uff0c\u4fe1\u9053\u5728\u4f7f\u7528\u524d\u5fc5\u987b\u521b\u5efa\uff1a</p> <pre><code>ch := make(chan int)\n</code></pre> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53d1\u9001\u548c\u63a5\u6536\u64cd\u4f5c\u5728\u53e6\u4e00\u7aef\u51c6\u5907\u597d\u4e4b\u524d\u90fd\u4f1a\u963b\u585e\u3002\u8fd9\u4f7f\u5f97 Go \u7a0b\u53ef\u4ee5\u5728\u6ca1\u6709\u663e\u5f0f\u7684\u9501\u6216\u7ade\u6001\u53d8\u91cf\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u540c\u6b65\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u5bf9\u5207\u7247\u4e2d\u7684\u6570\u8fdb\u884c\u6c42\u548c\uff0c\u5c06\u4efb\u52a1\u5206\u914d\u7ed9\u4e24\u4e2a Go \u7a0b\u3002\u4e00\u65e6\u4e24\u4e2a Go \u7a0b\u5b8c\u6210\u4e86\u5b83\u4eec\u7684\u8ba1\u7b97\uff0c\u5b83\u5c31\u80fd\u7b97\u51fa\u6700\u7ec8\u7684\u7ed3\u679c\u3002 <pre><code>func sum(s []int, c chan int) {\n    sum := 0\n    for _, v := range s {\n        sum += v\n    }\n    c &lt;- sum // \u5c06\u548c\u9001\u5165 c\n}\n\nfunc main() {\n    s := []int{7, 2, 8, -9, 4, 0}\n\n    c := make(chan int)\n    go sum(s[:len(s)/2], c)\n    go sum(s[len(s)/2:], c)\n    x, y := &lt;-c, &lt;-c // \u4ece c \u4e2d\u63a5\u6536\n\n    fmt.Println(x, y, x+y)\n}\n// -5 17 12\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_38","title":"\u5e26\u7f13\u51b2\u7684\u4fe1\u9053","text":"<p>\u4fe1\u9053\u53ef\u4ee5\u662f\u00a0\u5e26\u7f13\u51b2\u7684\u3002\u5c06\u7f13\u51b2\u957f\u5ea6\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u63d0\u4f9b\u7ed9\u00a0<code>make</code>\u00a0\u6765\u521d\u59cb\u5316\u4e00\u4e2a\u5e26\u7f13\u51b2\u7684\u4fe1\u9053\uff1a</p> <p>ch := make(chan int, 100)</p> <p>\u4ec5\u5f53\u4fe1\u9053\u7684\u7f13\u51b2\u533a\u586b\u6ee1\u540e\uff0c\u5411\u5176\u53d1\u9001\u6570\u636e\u65f6\u624d\u4f1a\u963b\u585e\u3002\u5f53\u7f13\u51b2\u533a\u4e3a\u7a7a\u65f6\uff0c\u63a5\u53d7\u65b9\u4f1a\u963b\u585e\u3002</p> <p>\u4fee\u6539\u793a\u4f8b\u586b\u6ee1\u7f13\u51b2\u533a\uff0c\u7136\u540e\u770b\u770b\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002 <pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    ch := make(chan int, 2) // 1\u65f6\u4f1a\u51fa\u73b0\u9519\u8bef\uff0c&gt;=2\u65f6\u6b63\u5e38\u8fd0\u884c\n    ch &lt;- 1\n    ch &lt;- 2\n    fmt.Println(&lt;-ch) // 1\n    fmt.Println(&lt;-ch) // 2\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#range-close","title":"range \u548c close","text":"<p>\u53d1\u9001\u8005\u53ef\u901a\u8fc7\u00a0<code>close</code>\u00a0\u5173\u95ed\u4e00\u4e2a\u4fe1\u9053\u6765\u8868\u793a\u6ca1\u6709\u9700\u8981\u53d1\u9001\u7684\u503c\u4e86\u3002\u63a5\u6536\u8005\u53ef\u4ee5\u901a\u8fc7\u4e3a\u63a5\u6536\u8868\u8fbe\u5f0f\u5206\u914d\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6765\u6d4b\u8bd5\u4fe1\u9053\u662f\u5426\u88ab\u5173\u95ed\uff1a\u82e5\u6ca1\u6709\u503c\u53ef\u4ee5\u63a5\u6536\u4e14\u4fe1\u9053\u5df2\u88ab\u5173\u95ed\uff0c\u90a3\u4e48\u5728\u6267\u884c\u5b8c</p> <p>v, ok := &lt;-ch</p> <p>\u4e4b\u540e\u00a0<code>ok</code>\u00a0\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u00a0<code>false</code>\u3002</p> <p>\u5faa\u73af\u00a0<code>for i := range c</code>\u00a0\u4f1a\u4e0d\u65ad\u4ece\u4fe1\u9053\u63a5\u6536\u503c\uff0c\u76f4\u5230\u5b83\u88ab\u5173\u95ed\u3002</p> <p>\u6ce8\u610f\uff1a \u53ea\u6709\u53d1\u9001\u8005\u624d\u80fd\u5173\u95ed\u4fe1\u9053\uff0c\u800c\u63a5\u6536\u8005\u4e0d\u80fd\u3002\u5411\u4e00\u4e2a\u5df2\u7ecf\u5173\u95ed\u7684\u4fe1\u9053\u53d1\u9001\u6570\u636e\u4f1a\u5f15\u53d1\u7a0b\u5e8f\u6050\u614c\uff08panic\uff09\u3002</p> <p>\u8fd8\u8981\u6ce8\u610f\uff1a \u4fe1\u9053\u4e0e\u6587\u4ef6\u4e0d\u540c\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u65e0\u9700\u5173\u95ed\u5b83\u4eec\u3002\u53ea\u6709\u5728\u5fc5\u987b\u544a\u8bc9\u63a5\u6536\u8005\u4e0d\u518d\u6709\u9700\u8981\u53d1\u9001\u7684\u503c\u65f6\u624d\u6709\u5fc5\u8981\u5173\u95ed\uff0c\u4f8b\u5982\u7ec8\u6b62\u4e00\u4e2a\u00a0<code>range</code>\u00a0\u5faa\u73af\u3002</p> <pre><code>func fibonacci(n int, c chan int) {\n    x, y := 0, 1\n    for i := 0; i &lt; n; i++ {\n        c &lt;- x\n        x, y = y, x+y\n    }\n    close(c)\n}\n\nfunc main() {\n    c := make(chan int, 10)\n    go fibonacci(cap(c), c)\n    for i := range c {\n        fmt.Println(i)\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#select","title":"select \u8bed\u53e5","text":"<p><code>select</code>\u00a0\u8bed\u53e5\u4f7f\u4e00\u4e2a Go \u7a0b\u53ef\u4ee5\u7b49\u5f85\u591a\u4e2a\u901a\u4fe1\u64cd\u4f5c\u3002</p> <p><code>select</code>\u00a0\u4f1a\u963b\u585e\u5230\u67d0\u4e2a\u5206\u652f\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u4e3a\u6b62\uff0c\u8fd9\u65f6\u5c31\u4f1a\u6267\u884c\u8be5\u5206\u652f\u3002\u5f53\u591a\u4e2a\u5206\u652f\u90fd\u51c6\u5907\u597d\u65f6\u4f1a\u968f\u673a\u9009\u62e9\u4e00\u4e2a\u6267\u884c\u3002 <pre><code>func fibonacci(c, quit chan int) {\n    x, y := 0, 1\n    for {\n        select {\n        case c &lt;- x:\n            x, y = y, x+y\n        case &lt;-quit:\n            fmt.Println(\"quit\")\n            return\n        }\n    }\n}\n\nfunc main() {\n    c := make(chan int)\n    quit := make(chan int)\n    go func() {\n        for i := 0; i &lt; 10; i++ {\n            fmt.Println(&lt;-c)\n        }\n        quit &lt;- 0\n    }()\n    fibonacci(c, quit)\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_39","title":"\u9ed8\u8ba4\u9009\u62e9","text":"<p>\u5f53\u00a0<code>select</code>\u00a0\u4e2d\u7684\u5176\u5b83\u5206\u652f\u90fd\u6ca1\u6709\u51c6\u5907\u597d\u65f6\uff0c<code>default</code>\u00a0\u5206\u652f\u5c31\u4f1a\u6267\u884c\u3002</p> <p>\u4e3a\u4e86\u5728\u5c1d\u8bd5\u53d1\u9001\u6216\u8005\u63a5\u6536\u65f6\u4e0d\u53d1\u751f\u963b\u585e\uff0c\u53ef\u4f7f\u7528\u00a0<code>default</code>\u00a0\u5206\u652f\uff1a</p> <pre><code>select {\ncase i := &lt;-c:\n    // \u4f7f\u7528 i\ndefault:\n    // \u4ece c \u4e2d\u63a5\u6536\u4f1a\u963b\u585e\u65f6\u6267\u884c\n}\n</code></pre> <pre><code>func main() {\n    tick := time.Tick(100 * time.Millisecond)\n    boom := time.After(500 * time.Millisecond)\n    for {\n        select {\n        case &lt;-tick:\n            fmt.Println(\"tick.\")\n        case &lt;-boom:\n            fmt.Println(\"BOOM!\")\n            return\n        default:\n            fmt.Println(\"    .\")\n            time.Sleep(50 * time.Millisecond)\n        }\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_40","title":"\u7ec3\u4e60\uff1a\u7b49\u4ef7\u4e8c\u53c9\u67e5\u627e\u6811","text":"<p>\u4e0d\u540c\u4e8c\u53c9\u6811\u7684\u53f6\u8282\u70b9\u4e0a\u53ef\u4ee5\u4fdd\u5b58\u76f8\u540c\u7684\u503c\u5e8f\u5217\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u4e24\u4e2a\u4e8c\u53c9\u6811\u90fd\u4fdd\u5b58\u4e86\u5e8f\u5217 <code>1\uff0c1\uff0c2\uff0c3\uff0c5\uff0c8\uff0c13</code>\u3002</p> <p></p> <p>\u5728\u5927\u591a\u6570\u8bed\u8a00\u4e2d\uff0c\u68c0\u67e5\u4e24\u4e2a\u4e8c\u53c9\u6811\u662f\u5426\u4fdd\u5b58\u4e86\u76f8\u540c\u5e8f\u5217\u7684\u51fd\u6570\u90fd\u76f8\u5f53\u590d\u6742\u3002 \u6211\u4eec\u5c06\u4f7f\u7528 Go \u7684\u5e76\u53d1\u548c\u4fe1\u9053\u6765\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u89e3\u6cd5\u3002</p> <p>\u672c\u4f8b\u4f7f\u7528\u4e86\u00a0<code>tree</code>\u00a0\u5305\uff0c\u5b83\u5b9a\u4e49\u4e86\u7c7b\u578b\uff1a</p> <p><pre><code>type Tree struct {\n    Left  *Tree\n    Value int\n    Right *Tree\n}\n</code></pre> 1.\u00a0\u5b9e\u73b0\u00a0<code>Walk</code>\u00a0\u51fd\u6570\u3002</p> <p>2.\u00a0\u6d4b\u8bd5\u00a0<code>Walk</code>\u00a0\u51fd\u6570\u3002</p> <p>\u51fd\u6570\u00a0<code>tree.New(k)</code>\u00a0\u7528\u4e8e\u6784\u9020\u4e00\u4e2a\u968f\u673a\u7ed3\u6784\u7684\u5df2\u6392\u5e8f\u4e8c\u53c9\u67e5\u627e\u6811\uff0c\u5b83\u4fdd\u5b58\u4e86\u503c\u00a0<code>k</code>,\u00a0<code>2k</code>,\u00a0<code>3k</code>, ...,\u00a0<code>10k</code>\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4fe1\u9053\u00a0<code>ch</code>\u00a0\u5e76\u4e14\u5bf9\u5176\u8fdb\u884c\u6b65\u8fdb\uff1a</p> <p>go Walk(tree.New(1), ch)</p> <p>\u7136\u540e\u4ece\u4fe1\u9053\u4e2d\u8bfb\u53d6\u5e76\u6253\u5370 10 \u4e2a\u503c\u3002\u5e94\u5f53\u662f\u6570\u5b57\u00a0<code>1, 2, 3, ..., 10</code>\u3002</p> <p>3.\u00a0\u7528\u00a0<code>Walk</code>\u00a0\u5b9e\u73b0\u00a0<code>Same</code>\u00a0\u51fd\u6570\u6765\u68c0\u6d4b\u00a0<code>t1</code>\u00a0\u548c\u00a0<code>t2</code>\u00a0\u662f\u5426\u5b58\u50a8\u4e86\u76f8\u540c\u7684\u503c\u3002</p> <p>4.\u00a0\u6d4b\u8bd5\u00a0<code>Same</code>\u00a0\u51fd\u6570\u3002</p> <p><code>Same(tree.New(1), tree.New(1))</code>\u00a0\u5e94\u5f53\u8fd4\u56de\u00a0<code>true</code>\uff0c\u800c\u00a0<code>Same(tree.New(1), tree.New(2))</code>\u00a0\u5e94\u5f53\u8fd4\u56de\u00a0<code>false</code>\u3002</p> <p><code>Tree</code>\u00a0\u7684\u6587\u6863\u53ef\u5728\u8fd9\u91cc\u627e\u5230\u3002</p> <pre><code>import (\n    \"fmt\"\n    \"golang.org/x/tour/tree\"\n)\n\n// Walk \u6b65\u8fdb tree t \u5c06\u6240\u6709\u7684\u503c\u4ece tree \u53d1\u9001\u5230 channel ch\u3002\nfunc Walk(t *tree.Tree, ch chan int) {\n    if t.Left != nil {\n        Walk(t.Left, ch)\n    }\n    ch &lt;- t.Value\n    if t.Right != nil {\n        Walk(t.Right, ch)\n    }\n    return\n}\n\n// Same \u68c0\u6d4b\u6811 t1 \u548c t2 \u662f\u5426\u542b\u6709\u76f8\u540c\u7684\u503c\u3002\nfunc Same(t1, t2 *tree.Tree) bool {\n    ch1, ch2 := make(chan int), make(chan int)\n    go Walk(t1, ch1)\n    go Walk(t2, ch2)\n    if &lt;-ch1 == &lt;-ch2 {\n        return true\n    } else {\n        return false\n    }\n}\n\nfunc main() {\n    ch := make(chan int)\n    t := tree.New(1)\n    go Walk(t, ch)\n\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(&lt;-ch)\n    }\n\n    fmt.Println(Same(tree.New(1), tree.New(1)))\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#syncmutex","title":"sync.Mutex","text":"<p>\u6211\u4eec\u5df2\u7ecf\u770b\u5230\u4fe1\u9053\u975e\u5e38\u9002\u5408\u5728\u5404\u4e2a Go \u7a0b\u95f4\u8fdb\u884c\u901a\u4fe1\u3002</p> <p>\u4f46\u662f\u5982\u679c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u901a\u4fe1\u5462\uff1f\u6bd4\u5982\u8bf4\uff0c\u82e5\u6211\u4eec\u53ea\u662f\u60f3\u4fdd\u8bc1\u6bcf\u6b21\u53ea\u6709\u4e00\u4e2a Go \u7a0b\u80fd\u591f\u8bbf\u95ee\u4e00\u4e2a\u5171\u4eab\u7684\u53d8\u91cf\uff0c\u4ece\u800c\u907f\u514d\u51b2\u7a81\uff1f</p> <p>\u8fd9\u91cc\u6d89\u53ca\u7684\u6982\u5ff5\u53eb\u505a \u4e92\u65a5\uff08mutualexclusion\uff09 \uff0c\u6211\u4eec\u901a\u5e38\u4f7f\u7528 \u4e92\u65a5\u9501\uff08Mutex\uff09* \u8fd9\u4e00\u6570\u636e\u7ed3\u6784\u6765\u63d0\u4f9b\u8fd9\u79cd\u673a\u5236\u3002</p> <p>Go \u6807\u51c6\u5e93\u4e2d\u63d0\u4f9b\u4e86\u00a0<code>sync.Mutex</code>\u00a0\u4e92\u65a5\u9501\u7c7b\u578b\u53ca\u5176\u4e24\u4e2a\u65b9\u6cd5\uff1a</p> <ul> <li><code>Lock</code></li> <li><code>Unlock</code></li> </ul> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5728\u4ee3\u7801\u524d\u8c03\u7528\u00a0<code>Lock</code>\u00a0\u65b9\u6cd5\uff0c\u5728\u4ee3\u7801\u540e\u8c03\u7528\u00a0<code>Unlock</code>\u00a0\u65b9\u6cd5\u6765\u4fdd\u8bc1\u4e00\u6bb5\u4ee3\u7801\u7684\u4e92\u65a5\u6267\u884c\u3002\u53c2\u89c1\u00a0<code>Inc</code>\u00a0\u65b9\u6cd5\u3002</p> <p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u00a0<code>defer</code>\u00a0\u8bed\u53e5\u6765\u4fdd\u8bc1\u4e92\u65a5\u9501\u4e00\u5b9a\u4f1a\u88ab\u89e3\u9501\u3002\u53c2\u89c1\u00a0<code>Value</code>\u00a0\u65b9\u6cd5\u3002 <pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\n// SafeCounter \u7684\u5e76\u53d1\u4f7f\u7528\u662f\u5b89\u5168\u7684\u3002\ntype SafeCounter struct {\n    v   map[string]int\n    mux sync.Mutex\n}\n\n// Inc \u589e\u52a0\u7ed9\u5b9a key \u7684\u8ba1\u6570\u5668\u7684\u503c\u3002\nfunc (c *SafeCounter) Inc(key string) {\n    c.mux.Lock()\n    // Lock \u4e4b\u540e\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a goroutine \u80fd\u8bbf\u95ee c.v\n    c.v[key]++\n    c.mux.Unlock()\n}\n\n// Value \u8fd4\u56de\u7ed9\u5b9a key \u7684\u8ba1\u6570\u5668\u7684\u5f53\u524d\u503c\u3002\nfunc (c *SafeCounter) Value(key string) int {\n    c.mux.Lock()\n    // Lock \u4e4b\u540e\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a goroutine \u80fd\u8bbf\u95ee c.v\n    defer c.mux.Unlock()\n    return c.v[key]\n}\n\nfunc main() {\n    c := SafeCounter{v: make(map[string]int)}\n    for i := 0; i &lt; 1000; i++ {\n        go c.Inc(\"somekey\")\n    }\n\n    time.Sleep(time.Second)\n    fmt.Println(c.Value(\"somekey\")) // 1000                                                                        \n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#web","title":"\u7ec3\u4e60\uff1aWeb \u722c\u866b","text":"<p>\u5728\u8fd9\u4e2a\u7ec3\u4e60\u4e2d\uff0c\u6211\u4eec\u5c06\u4f1a\u4f7f\u7528 Go \u7684\u5e76\u53d1\u7279\u6027\u6765\u5e76\u884c\u5316\u4e00\u4e2a Web \u722c\u866b\u3002</p> <p>\u4fee\u6539\u00a0<code>Crawl</code>\u00a0\u51fd\u6570\u6765\u5e76\u884c\u5730\u6293\u53d6 URL\uff0c\u5e76\u4e14\u4fdd\u8bc1\u4e0d\u91cd\u590d\u3002</p> <p>\u63d0\u793a\uff1a\u4f60\u53ef\u4ee5\u7528\u4e00\u4e2a map \u6765\u7f13\u5b58\u5df2\u7ecf\u83b7\u53d6\u7684 URL\uff0c\u4f46\u662f\u8981\u6ce8\u610f map \u672c\u8eab\u5e76\u4e0d\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff01 <pre><code>// Copyright 2012 The Go Authors.  All rights reserved.\n// Use of this source code is governed by a BSD-style\n// license that can be found in the LICENSE file.\n\n// +build ignore\n\npackage main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"sync\"\n)\n\ntype Fetcher interface {\n    // Fetch returns the body of URL and\n    // a slice of URLs found on that page.\n    Fetch(url string) (body string, urls []string, err error)\n}\n\n// fetched tracks URLs that have been (or are being) fetched.\n// The lock must be held while reading from or writing to the map.\n// See https://golang.org/ref/spec#Struct_types section on embedded types.\nvar fetched = struct {\n    m map[string]error\n    sync.Mutex\n}{m: make(map[string]error)}\n\nvar loading = errors.New(\"url load in progress\") // sentinel value\n\n// Crawl uses fetcher to recursively crawl\n// pages starting with url, to a maximum of depth.\nfunc Crawl(url string, depth int, fetcher Fetcher) {\n    if depth &lt;= 0 {\n        fmt.Printf(\"&lt;- Done with %v, depth 0.\\n\", url)\n        return\n    }\n\n    fetched.Lock()\n    if _, ok := fetched.m[url]; ok {\n        fetched.Unlock()\n        fmt.Printf(\"&lt;- Done with %v, already fetched.\\n\", url)\n        return\n    }\n    // We mark the url to be loading to avoid others reloading it at the same time.\n    fetched.m[url] = loading\n    fetched.Unlock()\n\n    // We load it concurrently.\n    body, urls, err := fetcher.Fetch(url)\n\n    // And update the status in a synced zone.\n    fetched.Lock()\n    fetched.m[url] = err\n    fetched.Unlock()\n\n    if err != nil {\n        fmt.Printf(\"&lt;- Error on %v: %v\\n\", url, err)\n        return\n    }\n    fmt.Printf(\"Found: %s %q\\n\", url, body)\n    done := make(chan bool)\n    for i, u := range urls {\n        fmt.Printf(\"-&gt; Crawling child %v/%v of %v : %v.\\n\", i, len(urls), url, u)\n        go func(url string) {\n            Crawl(url, depth-1, fetcher)\n            done &lt;- true\n        }(u)\n    }\n    for i, u := range urls {\n        fmt.Printf(\"&lt;- [%v] %v/%v Waiting for child %v.\\n\", url, i, len(urls), u)\n        &lt;-done\n    }\n    fmt.Printf(\"&lt;- Done with %v\\n\", url)\n}\n\nfunc main() {\n    Crawl(\"https://golang.org/\", 4, fetcher)\n\n    fmt.Println(\"Fetching stats\\n--------------\")\n    for url, err := range fetched.m {\n        if err != nil {\n            fmt.Printf(\"%v failed: %v\\n\", url, err)\n        } else {\n            fmt.Printf(\"%v was fetched\\n\", url)\n        }\n    }\n}\n\n// fakeFetcher is Fetcher that returns canned results.\ntype fakeFetcher map[string]*fakeResult\n\ntype fakeResult struct {\n    body string\n    urls []string\n}\n\nfunc (f *fakeFetcher) Fetch(url string) (string, []string, error) {\n    if res, ok := (*f)[url]; ok {\n        return res.body, res.urls, nil\n    }\n    return \"\", nil, fmt.Errorf(\"not found: %s\", url)\n}\n\n// fetcher is a populated fakeFetcher.\nvar fetcher = &amp;fakeFetcher{\n    \"https://golang.org/\": &amp;fakeResult{\n        \"The Go Programming Language\",\n        []string{\n            \"https://golang.org/pkg/\",\n            \"https://golang.org/cmd/\",\n        },\n    },\n    \"https://golang.org/pkg/\": &amp;fakeResult{\n        \"Packages\",\n        []string{\n            \"https://golang.org/\",\n            \"https://golang.org/cmd/\",\n            \"https://golang.org/pkg/fmt/\",\n            \"https://golang.org/pkg/os/\",\n        },\n    },\n    \"https://golang.org/pkg/fmt/\": &amp;fakeResult{\n        \"Package fmt\",\n        []string{\n            \"https://golang.org/\",\n            \"https://golang.org/pkg/\",\n        },\n    },\n    \"https://golang.org/pkg/os/\": &amp;fakeResult{\n        \"Package os\",\n        []string{\n            \"https://golang.org/\",\n            \"https://golang.org/pkg/\",\n        },\n    },\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_41","title":"\u6d4b\u8bd5","text":"<p>test   \u4ee5Test\u5f00\u5934 \u57fa\u51c6\u6d4b\u8bd5 \u4ee5Benchmark\u5f00\u5934  <pre><code>func Ben\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_42","title":"\u5176\u4ed6","text":"<p>\u53ef\u4ee5\u901a\u8fc7<code>go install</code>\u547d\u4ee4\u83b7\u53d6\u7f51\u7edc\u4e0a\u7684\u5305\u3001\u6216\u8005\u7b2c\u4e09\u65b9\u7684\u4f9d\u8d56\u7ba1\u7406\u5de5\u5177</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95/#_43","title":"\u547d\u540d\u89c4\u8303","text":"<ul> <li> <p>variable</p> <ul> <li>\u7b80\u6d01\u80dc\u4e8e\u5197\u957f</li> <li>\u7f29\u7565\u8bcd\u5168\u5927\u5199\uff0c\u4f46\u5f53\u5176\u4f4d\u4e8e\u53d8\u91cf\u5f00\u5934\u4e14\u4e0d\u9700\u8981\u5bfc\u51fa\u65f6\uff0c\u4f7f\u7528\u5168\u5c0f\u5199</li> <li>\u53d8\u91cf\u8ddd\u79bb\u5176\u88ab\u4f7f\u7528\u7684\u5730\u65b9\u8d8a\u8fdc\uff0c\u5219\u9700\u8981\u643a\u5e26\u8d8a\u591a\u7684\u4e0a\u4e0b\u6587\u4fe1\u606f</li> <li>\u5168\u5c40\u53d8\u91cf\u5728\u5176\u540d\u5b57\u4e2d\u9700\u8981\u66f4\u591a\u7684\u4e0a\u4e0b\u6587\u4fe1\u606f\uff0c\u4f7f\u5f97\u5728\u4e0d\u540c\u5730\u65b9\u53ef\u4ee5\u8f7b\u6613\u8fa8\u8ba4\u51fa\u5176\u542b\u4e49</li> </ul> </li> <li> <p>function</p> <ul> <li>\u51fd\u6570\u540d\u4e0d\u643a\u5e26\u5305\u540d\u7684\u4e0a\u4e0b\u6587\u4fe1\u606f\uff0c\u56e0\u4e3a\u5305\u540d\u548c\u51fd\u6570\u540d\u603b\u662f\u6210\u5bf9\u51fa\u73b0\u7684</li> <li>\u51fd\u6570\u540d\u5c3d\u91cf\u7b80\u77ed</li> <li>\u5f53\u540d\u4e3a foo \u7684\u5305\u67d0\u4e2a\u51fd\u6570\u8fd4\u56de\u7c7b\u578b Foo \u65f6\uff0c\u53ef\u4ee5\u7701\u7565\u7c7b\u578b\u4fe1\u606f\u800c\u4e0d\u5bfc\u81f4\u6b67\u4e49</li> <li>\u5f53\u540d\u4e3a foo \u7684\u5305\u67d0\u4e2a\u51fd\u6570\u8fd4\u56de\u7c7b\u578b T \u65f6\uff08T \u5e76\u4e0d\u662f Foo\uff09\uff0c\u53ef\u4ee5\u5728\u51fd\u6570\u540d\u4e2d\u52a0\u5165\u7c7b\u578b\u4fe1\u606f</li> </ul> </li> <li> <p>package</p> <ul> <li>\u53ea\u7531\u5c0f\u5199\u5b57\u6bcd\u7ec4\u6210\u3002\u4e0d\u5305\u542b\u5927\u5199\u5b57\u6bcd\u548c\u4e0b\u5212\u7ebf\u7b49\u5b57\u7b26</li> <li>\u7b80\u77ed\u5e76\u5305\u542b\u4e00\u5b9a\u7684\u4e0a\u4e0b\u6587\u4fe1\u606f\u3002\u4f8b\u5982 schema\u3001task \u7b49</li> <li>\u4e0d\u8981\u4e0e\u6807\u51c6\u5e93\u540c\u540d\u3002\u4f8b\u5982\u4e0d\u8981\u4f7f\u7528 sync \u6216\u8005 strings</li> </ul> </li> </ul> <p>\u4f5c\u8005\uff1a\u9752\u8bad\u8425\u5b98\u65b9\u8d26\u53f7 \u94fe\u63a5\uff1ahttps://juejin.cn/post/7188225875211452476 \u6765\u6e90\uff1a\u7a00\u571f\u6398\u91d1 \u8457\u4f5c\u6743\u5f52\u4f5c\u8005\u6240\u6709\u3002\u5546\u4e1a\u8f6c\u8f7d\u8bf7\u8054\u7cfb\u4f5c\u8005\u83b7\u5f97\u6388\u6743\uff0c\u975e\u5546\u4e1a\u8f6c\u8f7d\u8bf7\u6ce8\u660e\u51fa\u5904\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%B9%B6%E5%8F%91/","title":"\u5e76\u53d1","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%B9%B6%E5%8F%91/#go","title":"go #\u57fa\u7840","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%B9%B6%E5%8F%91/#go_1","title":"go\u5173\u952e\u8bcd","text":"<p>\u5728\u8c03\u7528\u7684\u51fd\u6570\u524d\u52a0<code>go</code>\u5173\u952e\u8bcd\uff0c\u5f53\u7a0b\u5e8f\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u7684\u65f6\u5019\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2agoroutine\u3002</p> <p>\"sync\"\u5305\u4e2d\u7684Mutex\u53ef\u4ee5\u5b9e\u73b0\u9501:sync.Mutex</p> <pre><code>func main() {\n    // \u6b64\u65f6\u521b\u5efa\u4e86\u4e00\u4e2agoroutine\n    go count(5, \"\ud83d\udc0f\");\n}\n\nfunc count(n int, animal string) {\n\u00a0 \u00a0 for i := 0; i &lt; n; i++ {\n\u00a0 \u00a0 \u00a0 \u00a0 fmt.Println(i+1, animal)\n\u00a0 \u00a0 \u00a0 \u00a0 time.Sleep(time.Millisecond * 500)\n\u00a0 \u00a0 }\n}\n</code></pre> <p>\u6ce8\u610f\uff1a\u5f53main\u51fd\u6570\u7ed3\u675f\u65f6\uff0cgo\u7a0b\u5e8f\u5c31\u4f1a\u7ed3\u675f\u3002      \u65e0\u8bba\u4f60\u521b\u5efa\u4e86\u591a\u5c11goroutine\uff0c\u65e0\u8bbagoroutine\u6709\u6ca1\u6709\u7ed3\u675f\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\"sync\"\u5305\u4e2d\u7684waitGroup\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u53ef\u4ee5\u7528\u5b83\u6765\u8ffd\u8e2a\u8fd8\u6709\u591a\u5c11\u4efb\u52a1\u6ca1\u6709\u5b8c\u6210\u3002</p> <pre><code>func main() {\n\u00a0 \u00a0 var wg sync.WaitGroup\n\u00a0 \u00a0 wg.Add(2)\n\u00a0 \u00a0 go func () \u00a0{\n\u00a0 \u00a0 \u00a0 \u00a0 count(5, \"\ud83d\udc0f\")\n\u00a0 \u00a0 \u00a0 \u00a0 wg.Done()\n\u00a0 \u00a0 }()\n\u00a0 \u00a0 go func () \u00a0{\n\u00a0 \u00a0 \u00a0 \u00a0 count(3,\"\ud83d\udc02\")\n\u00a0 \u00a0 \u00a0 \u00a0 wg.Done()\n\u00a0 \u00a0 }()\n\u00a0 \u00a0 wg.Wait()\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%B9%B6%E5%8F%91/#channel","title":"channel","text":"<p>\u5f53\u7ebf\u7a0b/\u534f\u7a0b\u5904\u7406\u76f8\u540c\u7684\u4e00\u5757\u5185\u5b58\u65f6\uff0c\u53ef\u80fd\u4f1a\u53d1\u751f\u51b2\u7a81\u3002</p> <p>\u4e00\u822c\u7684\u89e3\u51b3\u65b9\u6848\u662f\u7ed9\u8fd9\u5757\u5185\u5b58\u4e0a\u4e00\u4e2a\u9501\uff0c\u4f7f\u5f97\u540c\u4e00\u65f6\u95f4\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b/\u534f\u7a0b\u53ef\u4ee5\u64cd\u4f5c\u5b83\u3002\u64cd\u4f5c\u7ed3\u675f\u540e\u518d\u89e3\u9664\u9501\u3002</p> <p>\u4f46\u662fgo\u91c7\u7528\u4e86\u53e6\u5916\u4e00\u79cd\u65b9\u6cd5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u901a\u4fe1\u987a\u5e8f\u8fdb\u7a0b(Communicating sequential processes)\uff0c\u901a\u8fc7\u4ea4\u6d41\u6765\u5171\u4eab\u5185\u5b58\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u5171\u4eab\u5185\u5b58\u6765\u4ea4\u6d41\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7528<code>channel</code>\u6765\u5b9e\u73b0goroutine\u4e4b\u95f4\u7684\u4ea4\u6d41\u3002</p> <p>\u8bb0\u5f97\u8981\u5173\u95edchannel\uff0c\u5426\u5219\u63a5\u6536\u65b9\u4f1a\u4e00\u76f4\u7b49\u5f85channel\u53d1\u9001\u8fc7\u6765\u7684\u6d88\u606f</p> <p> <pre><code>func main() {\n    c := make(chan string)\n\n    go count(5, \"\ud83d\udc0f\", c)\n\n    for message := range c {\n        fmt.Println(message)\n    }\n\n    // for {\n    //  message, open := &lt;-c\n    //  if !open {\n    //      break\n    //  }\n    //  fmt.Println(message)\n    // }\n}\n\nfunc count(n int, animal string, c chan string) {\n    for i := 0; i &lt; n; i++ {\n        c &lt;- animal\n        time.Sleep(time.Millisecond * 500)\n    }\n    // \u5173\u95edchannel\n    close(c)\n}\n</code></pre></p> <pre><code>func main() {\n    c1 := make(chan string)\n    c2 := make(chan string)\n    go func() {\n        for {\n            c1 &lt;- \"\ud83d\udc0f\"\n            time.Sleep(time.Millisecond * 500)\n        }\n    }()\n\n    go func() {\n        for {\n            c2 &lt;- \"\ud83d\udc02\"\n            time.Sleep(time.Millisecond * 2000)\n        }\n    }()\n    for {\n        select {\n        case msg := &lt;-c1:\n            fmt.Println(msg)\n        case msg := &lt;-c2:\n            fmt.Println(msg)\n        }\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E5%B9%B6%E5%8F%91/#_2","title":"\u5b9e\u6218","text":"<p>\u4f7f\u7528go\u5b9e\u73b0\u904d\u5386\u6811\u5f62\u7ed3\u6784</p> <p>\u4e0d\u4f7f\u7528\u534f\u7a0b</p> <pre><code>package main\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\nvar matches int\n\nfunc main() {\n    start := time.Now()\n    search(\"E:/Blog/\")\n    fmt.Println(matches, \"marches\")\n    fmt.Println(time.Since(start))\n}\nfunc search(path string) {\n    files, err := os.ReadDir(path)\n    if err == nil {\n        for _, file := range files {\n            name := file.Name()\n            if file.IsDir() {\n                search(path + name + \"/\")\n            } else {\n                if len(name) &lt; 5 {\n                    matches++\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>\u4f7f\u7528\u534f\u7a0b</p> <pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nvar matches int\nvar workerCount = 0\nvar maxWorkerCount = 16\nvar searchRequest = make(chan string)\nvar workerDone = make(chan bool)\nvar findMatch = make(chan bool)\n\nfunc main() {\n    start := time.Now()\n    workerCount = 1\n    go search(\"E:/Blog/\", true)\n    waitForWorkers()\n    fmt.Println(matches, \"matches\")\n    fmt.Println(time.Since(start))\n}\n\nfunc waitForWorkers() {\n    for {\n        select {\n        case path := &lt;-searchRequest:\n            workerCount++\n            go search(path, true)\n        case &lt;-workerDone:\n            workerCount--\n            if workerCount == 0 {\n                return\n            }\n        case &lt;-findMatch:\n            matches++\n        }\n    }\n}\n\nfunc search(path string, master bool) {\n    files, err := os.ReadDir(path)\n    if err == nil {\n        for _, file := range files {\n            name := file.Name()\n            if file.IsDir() {\n                if workerCount &lt; maxWorkerCount {\n                    searchRequest &lt;- path + name + \"/\"\n                } else {\n                    search(path+name+\"/\", false)\n                }\n            } else {\n                if len(name)&lt;5 {\n                findMatch &lt;- true\n                }\n            }\n        }\n        if master {\n            workerDone &lt;- true\n        }\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/","title":"Standard Go Project Layout","text":"<p>\u7ffb\u8bd1:</p> <ul> <li>English</li> <li>\ud55c\uad6d\uc5b4 \ubb38\uc11c</li> <li>\u7b80\u4f53\u4e2d\u6587</li> <li>\u6b63\u9ad4\u4e2d\u6587</li> <li>\u7b80\u4f53\u4e2d\u6587 - ???</li> <li>Fran\u00e7ais</li> <li>\u65e5\u672c\u8a9e</li> <li>Portuguese</li> <li>Espa\u00f1ol</li> <li>Rom\u00e2n\u0103</li> <li>\u0420\u0443\u0441\u0441\u043a\u0438\u0439</li> <li>T\u00fcrk\u00e7e</li> <li>\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430</li> </ul> <p>\u8fd9\u662f Go \u5e94\u7528\u7a0b\u5e8f\u9879\u76ee\u7684\u57fa\u672c\u5e03\u5c40\u3002\u5b83\u4e0d\u662f\u6838\u5fc3 Go \u5f00\u53d1\u56e2\u961f\u5b9a\u4e49\u7684\u5b98\u65b9\u6807\u51c6\uff1b\u7136\u800c\uff0c\u5b83\u662f Go \u751f\u6001\u7cfb\u7edf\u4e2d\u4e00\u7ec4\u5e38\u89c1\u7684\u8001\u9879\u76ee\u548c\u65b0\u9879\u76ee\u7684\u5e03\u5c40\u6a21\u5f0f\u3002\u5176\u4e2d\u4e00\u4e9b\u6a21\u5f0f\u6bd4\u5176\u4ed6\u6a21\u5f0f\u66f4\u53d7\u6b22\u8fce\u3002\u5b83\u8fd8\u5177\u6709\u8bb8\u591a\u5c0f\u7684\u589e\u5f3a\uff0c\u4ee5\u53ca\u5bf9\u4efb\u4f55\u8db3\u591f\u5927\u7684\u5b9e\u9645\u5e94\u7528\u7a0b\u5e8f\u901a\u7528\u7684\u51e0\u4e2a\u652f\u6301\u76ee\u5f55\u3002</p> <p>\u5982\u679c\u4f60\u5c1d\u8bd5\u5b66\u4e60 Go\uff0c\u6216\u8005\u4f60\u6b63\u5728\u4e3a\u81ea\u5df1\u5efa\u7acb\u4e00\u4e2a PoC \u6216\u4e00\u4e2a\u73a9\u5177\u9879\u76ee\uff0c\u8fd9\u4e2a\u9879\u76ee\u5e03\u5c40\u662f\u6ca1\u5565\u5fc5\u8981\u7684\u3002\u4ece\u4e00\u4e9b\u975e\u5e38\u7b80\u5355\u7684\u4e8b\u60c5\u5f00\u59cb(\u4e00\u4e2a\u00a0<code>main.go</code>\u00a0\u6587\u4ef6\u7ef0\u7ef0\u6709\u4f59)\u3002\u968f\u7740\u9879\u76ee\u7684\u589e\u957f\uff0c\u8bf7\u8bb0\u4f4f\u4fdd\u6301\u4ee3\u7801\u7ed3\u6784\u826f\u597d\u975e\u5e38\u91cd\u8981\uff0c\u5426\u5219\u4f60\u6700\u7ec8\u4f1a\u5f97\u5230\u4e00\u4e2a\u51cc\u4e71\u7684\u4ee3\u7801\uff0c\u8fd9\u5176\u4e2d\u5c31\u5305\u542b\u5927\u91cf\u9690\u85cf\u7684\u4f9d\u8d56\u9879\u548c\u5168\u5c40\u72b6\u6001\u3002\u5f53\u6709\u66f4\u591a\u7684\u4eba\u53c2\u4e0e\u8fd9\u4e2a\u9879\u76ee\u65f6\uff0c\u4f60\u5c06\u9700\u8981\u66f4\u591a\u7684\u7ed3\u6784\u3002\u8fd9\u65f6\u5019\uff0c\u4ecb\u7ecd\u4e00\u79cd\u7ba1\u7406\u5305/\u5e93\u7684\u901a\u7528\u65b9\u6cd5\u662f\u5f88\u91cd\u8981\u7684\u3002\u5f53\u4f60\u6709\u4e00\u4e2a\u5f00\u6e90\u9879\u76ee\u65f6\uff0c\u6216\u8005\u5f53\u4f60\u77e5\u9053\u5176\u4ed6\u9879\u76ee\u4ece\u4f60\u7684\u9879\u76ee\u5b58\u50a8\u5e93\u4e2d\u5bfc\u5165\u4ee3\u7801\u65f6\uff0c\u8fd9\u65f6\u5019\u62e5\u6709\u79c1\u6709(\u53c8\u540d <code>internal</code>)\u5305\u548c\u4ee3\u7801\u5c31\u5f88\u91cd\u8981\u3002\u514b\u9686\u5b58\u50a8\u5e93\uff0c\u4fdd\u7559\u4f60\u9700\u8981\u7684\u5185\u5bb9\uff0c\u5220\u9664\u5176\u4ed6\u6240\u6709\u7684\u5185\u5bb9!\u4ec5\u4ec5\u56e0\u4e3a\u5b83\u5728\u90a3\u91cc\u5e76\u4e0d\u610f\u5473\u7740\u4f60\u5fc5\u987b\u5168\u90e8\u4f7f\u7528\u5b83\u3002\u8fd9\u4e9b\u6a21\u5f0f\u90fd\u6ca1\u6709\u5728\u6bcf\u4e2a\u9879\u76ee\u4e2d\u4f7f\u7528\u3002\u751a\u81f3\u00a0<code>vendor</code> \u6a21\u5f0f\u4e5f\u4e0d\u662f\u901a\u7528\u7684\u3002</p> <p>Go 1.14\u00a0<code>Go Modules</code> \u7ec8\u4e8e\u53ef\u4ee5\u6295\u5165\u751f\u4ea7\u4e86\u3002\u9664\u975e\u4f60\u6709\u7279\u5b9a\u7684\u7406\u7531\u4e0d\u4f7f\u7528\u5b83\u4eec\uff0c\u5426\u5219\u4f7f\u7528 <code>Go Modules</code> \u3002\u5982\u679c\u4f60\u4f7f\u7528\uff0c\u5c31\u65e0\u9700\u62c5\u5fc3 $GOPATH \u4ee5\u53ca\u9879\u76ee\u653e\u7f6e\u7684\u4f4d\u7f6e\u3002\u5b58\u50a8\u5e93\u4e2d\u7684\u00a0<code>go.mod</code> \u6587\u4ef6\u57fa\u672c\u5047\u5b9a\u4f60\u7684\u9879\u76ee\u6258\u7ba1\u5728 Github \u4e0a\uff0c\u4f46\u8fd9\u4e0d\u662f\u8981\u6c42\u3002\u6a21\u5757\u8def\u5f84\u53ef\u4ee5\u662f\u4efb\u4f55\u5730\u65b9\uff0c\u5c3d\u7ba1\u7b2c\u4e00\u4e2a\u6a21\u5757\u8def\u5f84\u7ec4\u4ef6\u7684\u540d\u79f0\u4e2d\u5e94\u8be5\u6709\u4e00\u4e2a\u70b9\uff08\u5f53\u524d\u7248\u672c\u7684 Go \u4e0d\u518d\u5f3a\u5236\u4f7f\u7528\u8be5\u6a21\u5757\uff0c\u4f46\u5982\u679c\u4f7f\u7528\u7a0d\u65e7\u7684\u7248\u672c\uff0c\u5982\u679c\u6ca1\u6709 <code>mod</code> \u6587\u4ef6\u6784\u5efa\u5931\u8d25\u7684\u8bdd \uff0c\u4e0d\u8981\u60ca\u8bb6\uff09\u3002\u5982\u679c\u4f60\u60f3\u77e5\u9053\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Issues\u00a0<code>37554</code>\u00a0\u548c\u00a0<code>32819</code> \u3002</p> <p>\u6b64\u9879\u76ee\u5e03\u5c40\u662f\u901a\u7528\u7684\uff0c\u5e76\u4e14\u4e0d\u4f1a\u5c1d\u8bd5\u5f3a\u52a0\u4e00\u4e2a\u7279\u5b9a\u7684 Go \u5305\u7ed3\u6784\u3002</p> <p>\u8fd9\u662f\u793e\u533a\u7684\u52aa\u529b\u3002 \u5982\u679c\u770b\u5230\u65b0\u7684\u6a21\u5f0f\uff0c\u6216\u8005\u8ba4\u4e3a\u4e00\u4e2a\u73b0\u6709\u7684\u6a21\u5f0f\u9700\u8981\u66f4\u65b0\uff0c\u8bf7\u63d0\u4e00\u4e2a issue\u3002</p> <p>\u5982\u679c\u9700\u8981\u547d\u540d\u3001\u683c\u5f0f\u548c\u6837\u5f0f\u65b9\u9762\u7684\u5e2e\u52a9\uff0c\u8bf7\u8fd0\u884c\u00a0<code>gofmt</code>\u00a0\u548c\u00a0<code>golint</code> \u3002\u8fd8\u8981\u786e\u4fdd\u9605\u8bfb\u8fd9\u4e9b Go \u4ee3\u7801\u98ce\u683c\u7684\u6307\u5bfc\u65b9\u9488\u548c\u5efa\u8bae: * https://talks.golang.org/2014/names.slide * https://golang.org/doc/effective_go.html#names * https://blog.golang.org/package-names * https://github.com/golang/go/wiki/CodeReviewComments * Style guideline for Go packages (rakyll/JBD)</p> <p>\u53c2\u89c1\u00a0<code>Go Project Layout</code>\u00a0\u4e86\u89e3\u66f4\u591a\u7684\u80cc\u666f\u4fe1\u606f\u3002</p> <p>\u66f4\u591a\u5173\u4e8e\u5305\u7684\u547d\u540d\u548c\u7ec4\u7ec7\u4ee5\u53ca\u5176\u4ed6\u4ee3\u7801\u7ed3\u6784\u7684\u5efa\u8bae: * GopherCon EU 2018: Peter Bourgon - Best Practices for Industrial Programming * GopherCon Russia 2018: Ashley McNamara + Brian Ketelsen - Go best practices. * GopherCon 2017: Edward Muller - Go Anti-Patterns * GopherCon 2018: Kat Zien - How Do You Structure Your Go Apps</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#go","title":"Go \u76ee\u5f55","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#cmd","title":"<code>/cmd</code>","text":"<p>\u672c\u9879\u76ee\u7684\u4e3b\u5e72\u3002</p> <p>\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u7684\u76ee\u5f55\u540d\u5e94\u8be5\u4e0e\u4f60\u60f3\u8981\u7684\u53ef\u6267\u884c\u6587\u4ef6\u7684\u540d\u79f0\u76f8\u5339\u914d(\u4f8b\u5982\uff0c<code>/cmd/myapp</code>)\u3002</p> <p>\u4e0d\u8981\u5728\u8fd9\u4e2a\u76ee\u5f55\u4e2d\u653e\u7f6e\u592a\u591a\u4ee3\u7801\u3002\u5982\u679c\u4f60\u8ba4\u4e3a\u4ee3\u7801\u53ef\u4ee5\u5bfc\u5165\u5e76\u5728\u5176\u4ed6\u9879\u76ee\u4e2d\u4f7f\u7528\uff0c\u90a3\u4e48\u5b83\u5e94\u8be5\u4f4d\u4e8e\u00a0<code>/pkg</code> \u76ee\u5f55\u4e2d\u3002\u5982\u679c\u4ee3\u7801\u4e0d\u662f\u53ef\u91cd\u7528\u7684\uff0c\u6216\u8005\u4f60\u4e0d\u5e0c\u671b\u5176\u4ed6\u4eba\u91cd\u7528\u5b83\uff0c\u8bf7\u5c06\u8be5\u4ee3\u7801\u653e\u5230\u00a0<code>/internal</code> \u76ee\u5f55\u4e2d\u3002\u4f60\u4f1a\u60ca\u8bb6\u4e8e\u522b\u4eba\u4f1a\u600e\u4e48\u505a\uff0c\u6240\u4ee5\u8981\u660e\u786e\u4f60\u7684\u610f\u56fe!</p> <p>\u901a\u5e38\u6709\u4e00\u4e2a\u5c0f\u7684 <code>main</code> \u51fd\u6570\uff0c\u4ece <code>/internal</code> \u548c\u00a0<code>/pkg</code> \u76ee\u5f55\u5bfc\u5165\u548c\u8c03\u7528\u4ee3\u7801\uff0c\u9664\u6b64\u4e4b\u5916\u6ca1\u6709\u522b\u7684\u4e1c\u897f\u3002</p> <p>\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u00a0<code>/cmd</code> \u76ee\u5f55\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#internal","title":"<code>/internal</code>","text":"<p>\u79c1\u6709\u5e94\u7528\u7a0b\u5e8f\u548c\u5e93\u4ee3\u7801\u3002\u8fd9\u662f\u4f60\u4e0d\u5e0c\u671b\u5176\u4ed6\u4eba\u5728\u5176\u5e94\u7528\u7a0b\u5e8f\u6216\u5e93\u4e2d\u5bfc\u5165\u4ee3\u7801\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e2a\u5e03\u5c40\u6a21\u5f0f\u662f\u7531 Go \u7f16\u8bd1\u5668\u672c\u8eab\u6267\u884c\u7684\u3002\u6709\u5173\u66f4\u591a\u7ec6\u8282\uff0c\u8bf7\u53c2\u9605Go 1.4 <code>release notes</code>\u00a0\u3002\u6ce8\u610f\uff0c\u4f60\u5e76\u4e0d\u5c40\u9650\u4e8e\u9876\u7ea7 <code>internal</code> \u76ee\u5f55\u3002\u5728\u9879\u76ee\u6811\u7684\u4efb\u4f55\u7ea7\u522b\u4e0a\u90fd\u53ef\u4ee5\u6709\u591a\u4e2a\u5185\u90e8\u76ee\u5f55\u3002</p> <p>\u4f60\u53ef\u4ee5\u9009\u62e9\u5411 internal \u5305\u4e2d\u6dfb\u52a0\u4e00\u4e9b\u989d\u5916\u7684\u7ed3\u6784\uff0c\u4ee5\u5206\u9694\u5171\u4eab\u548c\u975e\u5171\u4eab\u7684\u5185\u90e8\u4ee3\u7801\u3002\u8fd9\u4e0d\u662f\u5fc5\u9700\u7684(\u7279\u522b\u662f\u5bf9\u4e8e\u8f83\u5c0f\u7684\u9879\u76ee)\uff0c\u4f46\u662f\u6700\u597d\u6709\u6709\u53ef\u89c6\u5316\u7684\u7ebf\u7d22\u6765\u663e\u793a\u9884\u671f\u7684\u5305\u7684\u7528\u9014\u3002\u4f60\u7684\u5b9e\u9645\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u53ef\u4ee5\u653e\u5728\u00a0<code>/internal/app</code> \u76ee\u5f55\u4e0b(\u4f8b\u5982 <code>/internal/app/myapp</code>)\uff0c\u8fd9\u4e9b\u5e94\u7528\u7a0b\u5e8f\u5171\u4eab\u7684\u4ee3\u7801\u53ef\u4ee5\u653e\u5728 <code>/internal/pkg</code> \u76ee\u5f55\u4e0b(\u4f8b\u5982 <code>/internal/pkg/myprivlib</code>)\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#pkg","title":"<code>/pkg</code>","text":"<p>\u5916\u90e8\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u7684\u5e93\u4ee3\u7801(\u4f8b\u5982 <code>/pkg/mypubliclib</code>)\u3002\u5176\u4ed6\u9879\u76ee\u4f1a\u5bfc\u5165\u8fd9\u4e9b\u5e93\uff0c\u5e0c\u671b\u5b83\u4eec\u80fd\u6b63\u5e38\u5de5\u4f5c\uff0c\u6240\u4ee5\u5728\u8fd9\u91cc\u653e\u4e1c\u897f\u4e4b\u524d\u8981\u4e09\u601d:-)\u6ce8\u610f\uff0c<code>internal</code> \u76ee\u5f55\u662f\u786e\u4fdd\u79c1\u6709\u5305\u4e0d\u53ef\u5bfc\u5165\u7684\u66f4\u597d\u65b9\u6cd5\uff0c\u56e0\u4e3a\u5b83\u662f\u7531 Go \u5f3a\u5236\u6267\u884c\u7684\u3002<code>/pkg</code>\u00a0\u76ee\u5f55\u4ecd\u7136\u662f\u4e00\u79cd\u5f88\u597d\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u663e\u5f0f\u5730\u8868\u793a\u8be5\u76ee\u5f55\u4e2d\u7684\u4ee3\u7801\u5bf9\u4e8e\u5176\u4ed6\u4eba\u6765\u8bf4\u662f\u5b89\u5168\u4f7f\u7528\u7684\u597d\u65b9\u6cd5\u3002\u7531\u00a0Travis Jeffery\u00a0 \u64b0\u5199\u7684 <code>I'll take pkg over internal</code> \u535a\u5ba2\u6587\u7ae0\u63d0\u4f9b\u4e86 <code>pkg</code> \u548c <code>internal</code> \u76ee\u5f55\u7684\u4e00\u4e2a\u5f88\u597d\u7684\u6982\u8ff0\uff0c\u4ee5\u53ca\u4ec0\u4e48\u65f6\u5019\u4f7f\u7528\u5b83\u4eec\u662f\u6709\u610f\u4e49\u7684\u3002</p> <p>\u5f53\u6839\u76ee\u5f55\u5305\u542b\u5927\u91cf\u975e Go \u7ec4\u4ef6\u548c\u76ee\u5f55\u65f6\uff0c\u8fd9\u4e5f\u662f\u4e00\u79cd\u5c06 Go \u4ee3\u7801\u5206\u7ec4\u5230\u4e00\u4e2a\u4f4d\u7f6e\u7684\u65b9\u6cd5\uff0c\u8fd9\u4f7f\u5f97\u8fd0\u884c\u5404\u79cd Go \u5de5\u5177\u53d8\u5f97\u66f4\u52a0\u5bb9\u6613\uff08\u6b63\u5982\u5728\u8fd9\u4e9b\u6f14\u8bb2\u4e2d\u63d0\u5230\u7684\u90a3\u6837: \u6765\u81ea GopherCon EU 2018 \u7684 <code>Best Practices for Industrial Programming</code> , GopherCon 2018: Kat Zien - How Do You Structure Your Go Apps \u548c GoLab 2018 - Massimiliano Pippi - Project layout patterns in Go \uff09\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u67e5\u770b\u54ea\u4e2a\u6d41\u884c\u7684 Go \u5b58\u50a8\u5e93\u4f7f\u7528\u6b64\u9879\u76ee\u5e03\u5c40\u6a21\u5f0f\uff0c\u8bf7\u67e5\u770b\u00a0<code>/pkg</code>\u00a0\u76ee\u5f55\u3002\u8fd9\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u5e03\u5c40\u6a21\u5f0f\uff0c\u4f46\u5e76\u4e0d\u662f\u6240\u6709\u4eba\u90fd\u63a5\u53d7\u5b83\uff0c\u4e00\u4e9b Go \u793e\u533a\u7684\u4eba\u4e5f\u4e0d\u63a8\u8350\u5b83\u3002</p> <p>\u5982\u679c\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u9879\u76ee\u771f\u7684\u5f88\u5c0f\uff0c\u5e76\u4e14\u989d\u5916\u7684\u5d4c\u5957\u5e76\u4e0d\u80fd\u589e\u52a0\u591a\u5c11\u4ef7\u503c(\u9664\u975e\u4f60\u771f\u7684\u60f3\u8981:-)\uff0c\u90a3\u5c31\u4e0d\u8981\u4f7f\u7528\u5b83\u3002\u5f53\u5b83\u53d8\u5f97\u8db3\u591f\u5927\u65f6\uff0c\u4f60\u7684\u6839\u76ee\u5f55\u4f1a\u53d8\u5f97\u975e\u5e38\u7e41\u7410\u65f6(\u5c24\u5176\u662f\u5f53\u4f60\u6709\u5f88\u591a\u975e Go \u5e94\u7528\u7ec4\u4ef6\u65f6)\uff0c\u8bf7\u8003\u8651\u4e00\u4e0b\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#vendor","title":"<code>/vendor</code>","text":"<p>\u5e94\u7528\u7a0b\u5e8f\u4f9d\u8d56\u9879(\u624b\u52a8\u7ba1\u7406\u6216\u4f7f\u7528\u4f60\u559c\u6b22\u7684\u4f9d\u8d56\u9879\u7ba1\u7406\u5de5\u5177\uff0c\u5982\u65b0\u7684\u5185\u7f6e <code>Go Modules</code> \u529f\u80fd)\u3002<code>go mod vendor</code>\u00a0\u547d\u4ee4\u5c06\u4e3a\u4f60\u521b\u5efa <code>/vendor</code> \u76ee\u5f55\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u672a\u4f7f\u7528\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5904\u4e8e\u542f\u7528\u72b6\u6001\u7684 Go 1.14\uff0c\u5219\u53ef\u80fd\u9700\u8981\u5728 <code>go build</code> \u547d\u4ee4\u4e2d\u6dfb\u52a0 <code>-mod=vendor</code>\u00a0\u6807\u5fd7\u3002</p> <p>\u5982\u679c\u4f60\u6b63\u5728\u6784\u5efa\u4e00\u4e2a\u5e93\uff0c\u90a3\u4e48\u4e0d\u8981\u63d0\u4ea4\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u4f9d\u8d56\u9879\u3002</p> <p>\u6ce8\u610f\uff0c\u81ea\u4ece\u00a0<code>1.13</code> \u4ee5\u540e\uff0cGo \u8fd8\u542f\u7528\u4e86\u6a21\u5757\u4ee3\u7406\u529f\u80fd(\u9ed8\u8ba4\u4f7f\u7528 <code>https://proxy.golang.org</code> \u4f5c\u4e3a\u4ed6\u4eec\u7684\u6a21\u5757\u4ee3\u7406\u670d\u52a1\u5668)\u3002\u5728<code>here</code> \u9605\u8bfb\u66f4\u591a\u5173\u4e8e\u5b83\u7684\u4fe1\u606f\uff0c\u770b\u770b\u5b83\u662f\u5426\u7b26\u5408\u4f60\u7684\u6240\u6709\u9700\u6c42\u548c\u7ea6\u675f\u3002\u5982\u679c\u9700\u8981\uff0c\u90a3\u4e48\u4f60\u6839\u672c\u4e0d\u9700\u8981\u00a0<code>vendor</code> \u76ee\u5f55\u3002</p> <p>\u56fd\u5185\u6a21\u5757\u4ee3\u7406\u529f\u80fd\u9ed8\u8ba4\u662f\u88ab\u5899\u7684\uff0c\u4e03\u725b\u4e91\u6709\u7ef4\u62a4\u4e13\u95e8\u7684\u7684<code>\u6a21\u5757\u4ee3\u7406</code> \u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#_1","title":"\u670d\u52a1\u5e94\u7528\u7a0b\u5e8f\u76ee\u5f55","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#api","title":"<code>/api</code>","text":"<p>OpenAPI/Swagger \u89c4\u8303\uff0cJSON \u6a21\u5f0f\u6587\u4ef6\uff0c\u534f\u8bae\u5b9a\u4e49\u6587\u4ef6\u3002</p> <p>\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u89c1 <code>/api</code> \u76ee\u5f55\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#web","title":"Web \u5e94\u7528\u7a0b\u5e8f\u76ee\u5f55","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#web_1","title":"<code>/web</code>","text":"<p>\u7279\u5b9a\u4e8e Web \u5e94\u7528\u7a0b\u5e8f\u7684\u7ec4\u4ef6:\u9759\u6001 Web \u8d44\u4ea7\u3001\u670d\u52a1\u5668\u7aef\u6a21\u677f\u548c SPAs\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#_2","title":"\u901a\u7528\u5e94\u7528\u76ee\u5f55","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#configs","title":"<code>/configs</code>","text":"<p>\u914d\u7f6e\u6587\u4ef6\u6a21\u677f\u6216\u9ed8\u8ba4\u914d\u7f6e\u3002</p> <p>\u5c06\u4f60\u7684 <code>confd</code> \u6216 <code>consul-template</code> \u6a21\u677f\u6587\u4ef6\u653e\u5728\u8fd9\u91cc\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#init","title":"<code>/init</code>","text":"<p>System init\uff08systemd\uff0cupstart\uff0csysv\uff09\u548c process manager/supervisor\uff08runit\uff0csupervisor\uff09\u914d\u7f6e\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#scripts","title":"<code>/scripts</code>","text":"<p>\u6267\u884c\u5404\u79cd\u6784\u5efa\u3001\u5b89\u88c5\u3001\u5206\u6790\u7b49\u64cd\u4f5c\u7684\u811a\u672c\u3002</p> <p>\u8fd9\u4e9b\u811a\u672c\u4fdd\u6301\u4e86\u6839\u7ea7\u522b\u7684\u00a0Makefile \u53d8\u5f97\u5c0f\u800c\u7b80\u5355(\u4f8b\u5982\uff0c\u00a0<code>https://github.com/hashicorp/terraform/blob/master/Makefile</code> )\u3002</p> <p>\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u89c1 \u00a0<code>/scripts</code> \u76ee\u5f55\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#build","title":"<code>/build</code>","text":"<p>\u6253\u5305\u548c\u6301\u7eed\u96c6\u6210\u3002</p> <p>\u5c06\u4f60\u7684\u4e91( AMI )\u3001\u5bb9\u5668( Docker )\u3001\u64cd\u4f5c\u7cfb\u7edf( deb\u3001rpm\u3001pkg )\u5305\u914d\u7f6e\u548c\u811a\u672c\u653e\u5728\u00a0<code>/build/package</code> \u76ee\u5f55\u4e0b\u3002</p> <p>\u5c06\u4f60\u7684 CI (travis\u3001circle\u3001drone)\u914d\u7f6e\u548c\u811a\u672c\u653e\u5728\u00a0<code>/build/ci</code>\u00a0\u76ee\u5f55\u4e2d\u3002\u8bf7\u6ce8\u610f\uff0c\u6709\u4e9b CI \u5de5\u5177(\u4f8b\u5982 Travis CI)\u5bf9\u914d\u7f6e\u6587\u4ef6\u7684\u4f4d\u7f6e\u975e\u5e38\u6311\u5254\u3002\u5c1d\u8bd5\u5c06\u914d\u7f6e\u6587\u4ef6\u653e\u5728 <code>/build/ci</code> \u76ee\u5f55\u4e2d\uff0c\u5c06\u5b83\u4eec\u94fe\u63a5\u5230 CI \u5de5\u5177\u671f\u671b\u5b83\u4eec\u7684\u4f4d\u7f6e(\u5982\u679c\u53ef\u80fd\u7684\u8bdd)\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#deployments","title":"<code>/deployments</code>","text":"<p>IaaS\u3001PaaS\u3001\u7cfb\u7edf\u548c\u5bb9\u5668\u7f16\u6392\u90e8\u7f72\u914d\u7f6e\u548c\u6a21\u677f(docker-compose\u3001kubernetes/helm\u3001mesos\u3001terraform\u3001bosh)\u3002\u6ce8\u610f\uff0c\u5728\u4e00\u4e9b\u5b58\u50a8\u5e93\u4e2d(\u7279\u522b\u662f\u4f7f\u7528 kubernetes \u90e8\u7f72\u7684\u5e94\u7528\u7a0b\u5e8f)\uff0c\u8fd9\u4e2a\u76ee\u5f55\u88ab\u79f0\u4e3a <code>/deploy</code>\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#test","title":"<code>/test</code>","text":"<p>\u989d\u5916\u7684\u5916\u90e8\u6d4b\u8bd5\u5e94\u7528\u7a0b\u5e8f\u548c\u6d4b\u8bd5\u6570\u636e\u3002\u4f60\u53ef\u4ee5\u968f\u65f6\u6839\u636e\u9700\u6c42\u6784\u9020 <code>/test</code> \u76ee\u5f55\u3002\u5bf9\u4e8e\u8f83\u5927\u7684\u9879\u76ee\uff0c\u6709\u4e00\u4e2a\u6570\u636e\u5b50\u76ee\u5f55\u662f\u6709\u610f\u4e49\u7684\u3002\u4f8b\u5982\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>/test/data</code> \u6216 <code>/test/testdata</code> (\u5982\u679c\u4f60\u9700\u8981\u5ffd\u7565\u76ee\u5f55\u4e2d\u7684\u5185\u5bb9)\u3002\u8bf7\u6ce8\u610f\uff0cGo \u8fd8\u4f1a\u5ffd\u7565\u4ee5\u201c.\u201d\u6216\u201c_\u201d\u5f00\u5934\u7684\u76ee\u5f55\u6216\u6587\u4ef6\uff0c\u56e0\u6b64\u5728\u5982\u4f55\u547d\u540d\u6d4b\u8bd5\u6570\u636e\u76ee\u5f55\u65b9\u9762\u6709\u66f4\u5927\u7684\u7075\u6d3b\u6027\u3002</p> <p>\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u89c1\u00a0\u00a0<code>/test</code> \u76ee\u5f55\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#_3","title":"\u5176\u4ed6\u76ee\u5f55","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#docs","title":"<code>/docs</code>","text":"<p>\u8bbe\u8ba1\u548c\u7528\u6237\u6587\u6863(\u9664\u4e86 godoc \u751f\u6210\u7684\u6587\u6863\u4e4b\u5916)\u3002</p> <p>\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605 <code>/docs</code> \u76ee\u5f55\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#tools","title":"<code>/tools</code>","text":"<p>\u8fd9\u4e2a\u9879\u76ee\u7684\u652f\u6301\u5de5\u5177\u3002\u6ce8\u610f\uff0c\u8fd9\u4e9b\u5de5\u5177\u53ef\u4ee5\u4ece <code>/pkg</code> \u548c\u00a0<code>/internal</code> \u76ee\u5f55\u5bfc\u5165\u4ee3\u7801\u3002</p> <p>\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u89c1 <code>/tools</code> \u76ee\u5f55\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#examples","title":"<code>/examples</code>","text":"<p>\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u548c/\u6216\u516c\u5171\u5e93\u7684\u793a\u4f8b\u3002</p> <p>\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u89c1 <code>/examples</code> \u76ee\u5f55\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#third_party","title":"<code>/third_party</code>","text":"<p>\u5916\u90e8\u8f85\u52a9\u5de5\u5177\uff0c\u5206\u53c9\u4ee3\u7801\u548c\u5176\u4ed6\u7b2c\u4e09\u65b9\u5de5\u5177(\u4f8b\u5982 Swagger UI)\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#githooks","title":"<code>/githooks</code>","text":"<p>Git hooks\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#assets","title":"<code>/assets</code>","text":"<p>\u4e0e\u5b58\u50a8\u5e93\u4e00\u8d77\u4f7f\u7528\u7684\u5176\u4ed6\u8d44\u4ea7(\u56fe\u50cf\u3001\u5fbd\u6807\u7b49)\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#website","title":"<code>/website</code>","text":"<p>\u5982\u679c\u4f60\u4e0d\u4f7f\u7528 Github \u9875\u9762\uff0c\u5219\u5728\u8fd9\u91cc\u653e\u7f6e\u9879\u76ee\u7684\u7f51\u7ad9\u6570\u636e\u3002</p> <p>\u6709\u5173\u793a\u4f8b\uff0c\u8bf7\u53c2\u89c1\u00a0<code>/website</code> \u76ee\u5f55\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#_4","title":"\u4f60\u4e0d\u5e94\u8be5\u62e5\u6709\u7684\u76ee\u5f55","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#src","title":"<code>/src</code>","text":"<p>\u6709\u4e9b Go \u9879\u76ee\u786e\u5b9e\u6709\u4e00\u4e2a <code>src</code> \u6587\u4ef6\u5939\uff0c\u4f46\u8fd9\u901a\u5e38\u53d1\u751f\u5728\u5f00\u53d1\u4eba\u5458\u6709 Java \u80cc\u666f\uff0c\u5728\u90a3\u91cc\u5b83\u662f\u4e00\u79cd\u5e38\u89c1\u7684\u6a21\u5f0f\u3002\u5982\u679c\u53ef\u4ee5\u7684\u8bdd\uff0c\u5c3d\u91cf\u4e0d\u8981\u91c7\u7528\u8fd9\u79cd Java \u6a21\u5f0f\u3002\u4f60\u771f\u7684\u4e0d\u5e0c\u671b\u4f60\u7684 Go \u4ee3\u7801\u6216 Go \u9879\u76ee\u770b\u8d77\u6765\u50cf Java:-)</p> <p>\u4e0d\u8981\u5c06\u9879\u76ee\u7ea7\u522b\u00a0<code>src</code> \u76ee\u5f55\u4e0e Go \u7528\u4e8e\u5176\u5de5\u4f5c\u7a7a\u95f4\u7684 <code>src</code> \u76ee\u5f55(\u5982 <code>How to Write Go Code</code> \u4e2d\u6240\u8ff0)\u6df7\u6dc6\u3002<code>$GOPATH</code> \u73af\u5883\u53d8\u91cf\u6307\u5411\u4f60\u7684(\u5f53\u524d)\u5de5\u4f5c\u7a7a\u95f4(\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u6307\u5411\u975e windows \u7cfb\u7edf\u4e0a\u7684 <code>$HOME/go</code>)\u3002\u8fd9\u4e2a\u5de5\u4f5c\u7a7a\u95f4\u5305\u62ec\u9876\u5c42\u00a0<code>/pkg</code>,\u00a0<code>/bin</code>\u00a0\u548c\u00a0<code>/src</code> \u76ee\u5f55\u3002\u4f60\u7684\u5b9e\u9645\u9879\u76ee\u6700\u7ec8\u662f <code>/src</code> \u4e0b\u7684\u4e00\u4e2a\u5b50\u76ee\u5f55\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u7684\u9879\u76ee\u4e2d\u6709 <code>/src</code> \u76ee\u5f55\uff0c\u90a3\u4e48\u9879\u76ee\u8def\u5f84\u5c06\u662f\u8fd9\u6837\u7684: <code>/some/path/to/workspace/src/your_project/src/your_code.go</code>\u3002\u6ce8\u610f\uff0c\u5728 Go 1.11 \u4e2d\uff0c\u53ef\u4ee5\u5c06\u9879\u76ee\u653e\u5728\u00a0<code>GOPATH</code> \u4e4b\u5916\uff0c\u4f46\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u4f7f\u7528\u8fd9\u79cd\u5e03\u5c40\u6a21\u5f0f\u662f\u4e00\u4e2a\u597d\u4e3b\u610f\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#badges","title":"Badges","text":"<ul> <li> <p>Go Report Card - It will scan your code with <code>gofmt</code>, <code>go vet</code>, <code>gocyclo</code>, <code>golint</code>, <code>ineffassign</code>, <code>license</code> and <code>misspell</code>. Replace <code>github.com/golang-standards/project-layout</code> with your project reference.</p> </li> <li> <p>GoDoc - It will provide online version of your GoDoc generated documentation. Change the link to point to your project.</p> </li> <li> <p>Release - It will show the latest release number for your project. Change the github link to point to your project.</p> </li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/Go%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%84%E8%8C%83/#notes","title":"Notes","text":"<p>A more opinionated project template with sample/reusable configs, scripts and code is a WIP.</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/jwt-go/","title":"jwt-go","text":"<ol> <li>\u81ea\u5b9a\u4e49Claims\u7ed3\u6784\u4f53</li> </ol> <pre><code>type Claims struct {\n    Id       int64  `json:\"id\"`\n    Username string `json:\"username\"`\n    jwt.RegisteredClaims\n}\n</code></pre> <ol> <li> <p>\u8bbe\u7f6etoken\u7684\u8fc7\u671f\u65f6\u95f4 <pre><code>expireTime := time.Now().Add(24 * time.Hour)\n</code></pre></p> </li> <li> <p>\u5b9a\u4e49Secret <pre><code>var jwtKey = []byte(\"my_secret_key\")\n</code></pre></p> </li> </ol>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/jwt-go/#token","title":"\u751f\u6210token","text":"<pre><code>import (\n    \"errors\"\n    \"github.com/golang-jwt/jwt/v5\"\n    \"time\"\n)\n\nvar jwtKey = []byte(\"my_secret_key\")\n\ntype Claims struct {\n    Id       int64  `json:\"id\"`\n    Username string `json:\"username\"`\n    jwt.RegisteredClaims\n}\n\nfunc GenerateToken(id int64, username string) (string, error) {\n    expireTime := time.Now().Add(24 * time.Hour)\n\n    c := Claims{\n        Id:       id,\n        Username: username,\n        RegisteredClaims: jwt.RegisteredClaims{\n            ExpiresAt: jwt.NewNumericDate(expireTime), // \u8fc7\u671f\u65f6\u95f4\n            Issuer:    \"todo_list\",                    // \u7b7e\u53d1\u4eba\n        },\n    }\n\n    // \u4f7f\u7528\u6307\u5b9a\u7684\u7b7e\u540d\u65b9\u6cd5\u521b\u5efa\u7b7e\u540d\u5bf9\u8c61\n    tokenClaims := jwt.NewWithClaims(jwt.SigningMethodHS256, c)\n\n    // \u7b7e\u540d\u4ea7\u751ftoken\n    token, err := tokenClaims.SignedString(jwtKey)\n    return token, err\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/jwt-go/#token_1","title":"\u68c0\u9a8ctoken","text":"<pre><code>// ParseToken \u89e3\u6790JWT\nfunc ParseToken(token string) (*Claims, error) {\n\n    // \u89e3\u6790token\n    tokenClaims, err := jwt.ParseWithClaims(token, &amp;Claims{}, func(token *jwt.Token) (interface{}, error) {\n        return jwtKey, nil\n    })\n    if err != nil {\n        return nil, err\n    }\n\n    // \u6821\u9a8ctoken\n    if claims, ok := tokenClaims.Claims.(*Claims); ok &amp;&amp; tokenClaims.Valid {\n        return claims, nil\n    }\n\n    return nil, errors.New(\"invalid token\")\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/protobuf%E4%BD%BF%E7%94%A8/","title":"protobuf\u4f7f\u7528","text":"<p>Protocol Buffer Basics: Go | Protocol Buffers Documentation (protobuf.dev)</p> <p>Go Protobuf \u7b80\u660e\u6559\u7a0b | \u5feb\u901f\u5165\u95e8 | \u6781\u5ba2\u5154\u5154 (geektutu.com)</p> <p>proto\u6587\u4ef6\u5185\u5bb9 <pre><code>syntax = \"proto3\"; // \u6ce8\u660e\u4f7f\u7528proto3\npackage pratice;\noption go_package=\".\"; //\u6587\u4ef6\u8f93\u51fa\u7684\u76ee\u5f55\n\n// \u6570\u5b57\u4e3a\u6807\u8bc6\u53f7\nmessage Student {\n    string name = 1;\n    bool male = 2;\n    repeated int32 scores = 3;\n}\n</code></pre></p> <p>\u751f\u6210\u4ee3\u7801 <pre><code>protoc --go_out=. *.proto\n</code></pre></p> <p>\u7ed3\u679c </p> <ul> <li>protobuf \u67092\u4e2a\u7248\u672c\uff0c\u9ed8\u8ba4\u7248\u672c\u662f proto2\uff0c\u5982\u679c\u9700\u8981 proto3\uff0c\u5219\u9700\u8981\u5728\u975e\u7a7a\u975e\u6ce8\u91ca\u7b2c\u4e00\u884c\u4f7f\u7528\u00a0<code>syntax = \"proto3\"</code>\u00a0\u6807\u660e\u7248\u672c\u3002</li> <li><code>package</code>\uff0c\u5373\u5305\u540d\u58f0\u660e\u7b26\u662f\u53ef\u9009\u7684\uff0c\u7528\u6765\u9632\u6b62\u4e0d\u540c\u7684\u6d88\u606f\u7c7b\u578b\u6709\u547d\u540d\u51b2\u7a81\u3002</li> <li><code>option</code> \u6587\u4ef6\u8f93\u51fa\u7684\u76ee\u5f55</li> <li>\u6d88\u606f\u7c7b\u578b \u4f7f\u7528\u00a0<code>message</code>\u00a0\u5173\u952e\u5b57\u5b9a\u4e49\uff0cStudent \u662f\u7c7b\u578b\u540d\uff0cname, male, scores \u662f\u8be5\u7c7b\u578b\u7684 3 \u4e2a\u5b57\u6bb5\uff0c\u7c7b\u578b\u5206\u522b\u4e3a string, bool \u548c []int32\u3002\u5b57\u6bb5\u53ef\u4ee5\u662f\u6807\u91cf\u7c7b\u578b\uff0c\u4e5f\u53ef\u4ee5\u662f\u5408\u6210\u7c7b\u578b\u3002</li> <li>\u6bcf\u4e2a\u5b57\u6bb5\u7684\u4fee\u9970\u7b26\u9ed8\u8ba4\u662f singular\uff0c\u4e00\u822c\u7701\u7565\u4e0d\u5199\uff0c<code>repeated</code>\u00a0\u8868\u793a\u5b57\u6bb5\u53ef\u91cd\u590d\uff0c\u5373\u7528\u6765\u8868\u793a Go \u8bed\u8a00\u4e2d\u7684\u6570\u7ec4\u7c7b\u578b\u3002</li> <li>\u6bcf\u4e2a\u5b57\u7b26\u00a0<code>=</code> \u540e\u9762\u7684\u6570\u5b57\u79f0\u4e3a\u6807\u8bc6\u7b26\uff0c\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u552f\u4e00\u7684\u6807\u8bc6\u7b26\u3002\u6807\u8bc6\u7b26\u7528\u6765\u5728\u6d88\u606f\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f\u4e2d\u8bc6\u522b\u5404\u4e2a\u5b57\u6bb5\uff0c\u4e00\u65e6\u4f7f\u7528\u5c31\u4e0d\u80fd\u591f\u518d\u6539\u53d8\uff0c\u6807\u8bc6\u7b26\u7684\u53d6\u503c\u8303\u56f4\u4e3a [1, 2^29 - 1] \u3002</li> <li>.proto \u6587\u4ef6\u53ef\u4ee5\u5199\u6ce8\u91ca\uff0c\u5355\u884c\u6ce8\u91ca\u00a0<code>//</code>\uff0c\u591a\u884c\u6ce8\u91ca\u00a0<code>/* ... */</code></li> <li>\u4e00\u4e2a .proto \u6587\u4ef6\u4e2d\u53ef\u4ee5\u5199\u591a\u4e2a\u6d88\u606f\u7c7b\u578b\uff0c\u5373\u5bf9\u5e94\u591a\u4e2a\u7ed3\u6784\u4f53(struct)\u3002</li> </ul> <p>main.go \u6837\u4f8b \u8bc1\u660e\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u540e\u7684\u793a\u4f8b\uff0c\u5305\u542b\u76f8\u540c\u7684\u6570\u636e <pre><code>package pratice\n\nimport (\n    \"log\"\n\n    \"google.golang.org/protobuf/proto\"\n)\n\nfunc main() {\n    test := &amp;Student{\n        Name:   \"geektutu\",\n        Male:   true,\n        Scores: []int32{98, 85, 88},\n    }\n    data, err := proto.Marshal(test)\n    if err != nil {\n        log.Fatal(\"marshaling error: \", err)\n    }\n    newTest := &amp;Student{}\n    err = proto.Unmarshal(data, newTest)\n    if err != nil {\n        log.Fatal(\"unmarshaling error: \", err)\n    }\n    // Now test and newTest contain the same data.\n    if test.GetName() != newTest.GetName() {\n        log.Fatalf(\"data mismatch %q != %q\", test.GetName(), newTest.GetName())\n    }\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/protobuf%E4%BD%BF%E7%94%A8/#proto","title":"proto\u6587\u4ef6\u683c\u5f0f","text":"<p><code>proto</code> \u6587\u4ef6\u9075\u5faa\u4ee5\u4e0b\u57fa\u672c\u683c\u5f0f\uff1a</p> <ol> <li> <p>\u8bed\u6cd5\u6807\u8bc6\uff1a\u6307\u5b9a proto \u6587\u4ef6\u5e94\u4f7f\u7528\u7684\u8bed\u6cd5\u7248\u672c\uff0c\u4f8b\u5982 <code>syntax = \"proto3\";</code> \u8868\u793a\u4f7f\u7528 Protocol Buffers version 3 \u7684\u8bed\u6cd5\u89c4\u5219\u3002</p> </li> <li> <p>\u5305\u58f0\u660e\uff1a\uff08\u53ef\u9009\uff09\u5b9a\u4e49\u4e00\u4e2a\u5305\u7684\u540d\u79f0\uff0c\u7528\u4e8e\u9632\u6b62\u547d\u540d\u51b2\u7a81\u3002</p> </li> <li> <p>\u5bfc\u5165\u8bed\u53e5\uff1a\uff08\u53ef\u9009\uff09\u53ef\u4ee5\u5bfc\u5165\u5176\u4ed6 proto \u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u3002</p> </li> <li> <p>\u6d88\u606f\u5b9a\u4e49\uff1a\u63cf\u8ff0\u4e00\u4e2a\u6d88\u606f\u7684\u683c\u5f0f\uff0c\u5305\u62ec\u5b57\u6bb5\u540d\u3001\u6570\u636e\u7c7b\u578b\u4ee5\u53ca\u5b57\u6bb5\u6807\u7b7e\uff08\u7528\u4e8e\u5e8f\u5217\u5316\u7684\u552f\u4e00\u6570\u5b57\u6807\u8bc6\u7b26\uff09\u3002</p> </li> <li> <p>\u670d\u52a1\u5b9a\u4e49\uff1a\uff08\u9488\u5bf9 RPC \u7cfb\u7edf\uff09\u5b9a\u4e49 RPC \u670d\u52a1\u548c\u65b9\u6cd5\u3002</p> </li> </ol> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u663e\u793a\u4e86\u4e00\u4e2a\u57fa\u672c\u7684<code>proto</code>\u6587\u4ef6\u5185\u5bb9\uff1a</p> <pre><code>syntax = \"proto3\";\n\npackage example;\n\n// \u5b9a\u4e49\u4e00\u4e2a\u6d88\u606f\nmessage Person {\n  // \u5b57\u6bb5\u7f16\u53f7\u5fc5\u987b\u4e3a\u6b63\u6574\u6570\n  string name = 1;    // \u5b57\u6bb5\u6807\u7b7e\u4e3a1\u7684\u5b57\u7b26\u4e32\u7c7b\u578b\n  int32 id = 2;       // \u5b57\u6bb5\u6807\u7b7e\u4e3a2\u7684\u6574\u578b\n  string email = 3;   // \u5b57\u6bb5\u6807\u7b7e\u4e3a3\u7684\u5b57\u7b26\u4e32\n\n  // \u5b9a\u4e49\u4e00\u4e2a\u679a\u4e3e\u7c7b\u578b\n  enum PhoneType {\n    MOBILE = 0;\n    HOME = 1;\n    WORK = 2;\n  }\n\n  // \u5305\u542b\u5176\u4ed6\u6d88\u606f\u7684\u6d88\u606f\n  message PhoneNumber {\n    string number = 1;\n    PhoneType type = 2;\n  }\n\n  // \u91cd\u590d\u5b57\u6bb5\u8868\u793a\u53ef\u6709\u591a\u4e2a\u7535\u8bdd\u53f7\u7801\n  repeated PhoneNumber phones = 4;\n}\n\n// \u5b9a\u4e49\u4e00\u4e2a\u670d\u52a1\nservice MyService {\n  // \u5b9a\u4e49\u8c03\u7528\u65b9\u6cd5\u53ca\u5176\u8bf7\u6c42\u548c\u54cd\u5e94\u7c7b\u578b\n  rpc GetMyData (Person) returns (Person);\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u4eba\u5458\u4fe1\u606f\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8be5\u4eba\u5458\u5177\u6709\u59d3\u540d\u3001ID\u3001\u7535\u5b50\u90ae\u4ef6\u548c\u7535\u8bdd\u53f7\u7801\u5217\u8868\uff0c\u5e76\u63cf\u8ff0\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u5176\u5177\u6709\u4e00\u4e2a\u65b9\u6cd5\u6765\u83b7\u53d6\u4eba\u5458\u6570\u636e\u3002\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c<code>proto</code> \u6587\u4ef6\u7684\u7ed3\u6784\u53ef\u80fd\u4f1a\u66f4\u590d\u6742\uff0c\u5305\u542b\u591a\u79cd\u5d4c\u5957\u6d88\u606f\u548c\u590d\u6742\u7c7b\u578b\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Go/protobuf%E4%BD%BF%E7%94%A8/#grpc","title":"grpc\u4f7f\u7528\u6b65\u9aa4","text":"<p>\u7f16\u5199proto\u6587\u4ef6 <pre><code>syntax = \"proto3\";  \npackage  service;  \noption go_package=\"..;service\";  \n\nmessage HelloRequest {  \n  string name = 1;  \n}  \n\nmessage HelloReply {  \n  string message = 1;  \n}  \n\n\nservice Greeter {  \n  rpc SayHello(HelloRequest) returns (HelloReply) {}  \n}\n</code></pre></p> <p>\u4f7f\u7528\u6307\u4ee4<code>protoc --go_out=. *.proto</code> \u548c <code>protoc --go-grpc_out=. *.proto</code> \u751f\u6210\u4e24\u4e2a\u6587\u4ef6</p> <ul> <li><code>xxx.pb.go</code> - \u5305\u542bxxx.pb\u5305\uff0c\u5176\u4e2d\u5305\u542b\u6211\u4eec\u5b9a\u4e49\u7684HelloRequest\u3001HelloReply\u548cGreeter\u670d\u52a1\u7684\u4ee3\u7801\u3002</li> <li><code>xxx_grpc.pb.go</code> - \u5305\u542bxxx.pb.go\u4e2d\u5b9a\u4e49\u7684\u670d\u52a1\u7684gRPC\u4ee3\u7801\u3002</li> </ul> <p>\u7f16\u5199\u670d\u52a1\u7aef\u4ee3\u7801</p> <p>\"pb\" \u4e3a proto\u751f\u6210\u540e\u7684\u6587\u4ef6\u4f4d\u7f6e</p> <pre><code>package main  \n\nimport (  \n   \"context\"  \n   \"google.golang.org/grpc\"   \n   \"log\"   \n   \"net\"   \n   pb \"server/service\"  \n)  \n\nconst (  \n   port = \":50051\"  \n)  \n\n// \u5b9e\u73b0server\ntype server struct {  \n   pb.UnimplementedGreeterServer  \n}  \n\n// \u5b9e\u73b0\u65b9\u6cd5\nfunc (s *server) SayHello(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) {  \n   log.Printf(\"Received: %v\", in.Name)  \n   return &amp;pb.HelloReply{Message: \"Hello \" + in.Name}, nil  \n}  \n\nfunc main() {  \n    // \u5f00\u542f\u7aef\u53e3\n   lis, _ := net.Listen(\"tcp\", port)  \n\n   // \u521b\u5efagrpc\u670d\u52a1\n   s := grpc.NewServer()  \n   // \u5728grpc\u670d\u52a1\u7aef\u4e2d\u6ce8\u518c\u81ea\u5df1\u7f16\u5199\u7684\u670d\u52a1\n   pb.RegisterGreeterServer(s, &amp;server{})\n\n    // \u542f\u52a8\u670d\u52a1\n   if err := s.Serve(lis); err != nil {  \n      log.Fatalf(\"failed to serve: %v\", err)  \n   }\n}\n</code></pre> <ol> <li>\u5bfc\u5165\u6240\u9700\u7684\u5305\u548c.proto\u6587\u4ef6\u4e2d\u751f\u6210\u7684\u76f8\u5173\u5305\u3002</li> <li>\u5b9a\u4e49\u5e38\u91cfport\uff0c\u6307\u5b9a\u8981\u76d1\u542c\u7684TCP\u7aef\u53e3\u3002</li> <li>\u5b9e\u73b0server\u7ed3\u6784\u4f53\uff0c\u5176\u4e2d\u5b9e\u73b0\u4e86SayHello\u670d\u52a1\u7684\u5177\u4f53\u5b9e\u73b0\u3002</li> <li>\u6ce8\u518c\u6b64\u5b9e\u73b0\u7684\u670d\u52a1\u3002</li> <li> <p>\u521b\u5efagRPC\u670d\u52a1\u5668\uff0c\u5e76\u8c03\u7528Serve\u65b9\u6cd5\u76d1\u542c\u7aef\u53e3\u3002</p> </li> <li> <p>\u7f16\u5199\u5ba2\u6237\u7aef\u4ee3\u7801 <pre><code>package main  \n\nimport (  \n   \"context\"  \n   \"google.golang.org/grpc/credentials/insecure\"   \n   \"log\"   \n   \"os\"   \n   \"time\"  \n   \"google.golang.org/grpc\"   \n   pb \"server/service\"  \n)  \n\nconst (  \n   address     = \"localhost:50051\"  \n   defaultName = \"world\"  \n)  \n\nfunc main() {  \n   // Set up a connection to the server.\n   conn, err := grpc.Dial(address, grpc.WithTransportCredentials(insecure.NewCredentials()))  \n   // \u66f4\u63a8\u8350 grpc.DialContext(context.Background(), address, grpc.WithBlock(), grpc.WithTransportCredentials(insecure.NewCredentials())\n\n   if err != nil {  \n      log.Fatal(err)  \n   }   \n   defer conn.Close()  \n\n   c := pb.NewGreeterClient(conn)  \n\n   // Contact the server and print out its response.  \n   name := defaultName  \n   if len(os.Args) &gt; 1 {  \n      name = os.Args[1]  \n   }   \n   ctx, cancel := context.WithTimeout(context.Background(), time.Second)  \n\n   defer cancel()  \n\n   r, err := c.SayHello(ctx, &amp;pb.HelloRequest{Name: name})  \n\n   if err != nil {  \n      log.Fatalf(\"could not greet: %v\", err)  \n   }   \n   log.Printf(\"Greeting: %s\", r.Message)  \n}\n</code></pre></p> </li> <li> <p>\u521b\u5efa\u4e0e\u7ed9\u5b9a\u76ee\u6807\uff08\u670d\u52a1\u5668\uff09 \u7684\u8fde\u63a5\u4ea4\u4e92</p> </li> <li>\u521b\u5efaserver\u7684\u5ba2\u6237\u7aef\u5bf9\u8c61</li> <li>\u53d1\u9001RPC\u8bf7\u6c42\uff0c\u7b49\u5f85\u540c\u6b65\u54cd\u5e94\uff0c\u5f97\u5230\u56de\u8c03\u540e\u8fd4\u56de\u54cd\u5e94\u7ed3\u679c\u3001</li> <li>\u8f93\u51fa\u54cd\u5e94\u7ed3\u679c</li> </ol>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/Java-OI%E6%B5%81/","title":"JavaOI\u6d41","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/Java-OI%E6%B5%81/#fileinputstream","title":"FileInputStream","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/Java-OI%E6%B5%81/#bufferedoutputstream","title":"BufferedOutputStream","text":"<pre><code>import java.io.*;\nimport java.util.Scanner;\n\npublic class Bu {\n    public static void main(String[] args) throws IOException {\n        BufferedOutputStream bufferedOutputStream=new BufferedOutputStream(new FileOutputStream(\"1.txt\"));\n        Scanner in=new Scanner(System.in);\n        String s=in.nextLine();\n        bufferedOutputStream.write(s.getBytes());//\u5c06String\u8f6c\u5316\u4e3abyte\u8f93\u51fa\u5230\u6587\u4ef6\u4e2d\n        bufferedOutputStream.close();\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/Java-OI%E6%B5%81/#bufferedinputstream","title":"BufferedInputStream","text":"<pre><code>import java.io.*;\n\npublic class Bu {\n    public static void main(String[] args) throws IOException {\n        BufferedInputStream inputStream=new BufferedInputStream(new FileInputStream(\"1.txt\"));\n        byte[] bytes=new byte[1024];\n        int tmp;\n        while((tmp=inputStream.read(bytes))!=-1){\n            System.out.println(new String(bytes,0,tmp));//\u5c06\u6587\u4ef6\u4e2d\u7684byte\u8f6c\u5316\u4e3aString\u8f93\u5165\u5230\u7a0b\u5e8f\u4e2d\n        }\n        intputStream.close();\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/Java-OI%E6%B5%81/#buffered","title":"Buffered\u6d41\u590d\u5236\u89c6\u9891","text":"<pre><code>import java.io.*;\n\npublic class Bu{\n    public static void main(String[] args) throws IOException {\n        BufferedOutputStream outputStream=new BufferedOutputStream(new FileOutputStream(\"2.mp4\"));\n        BufferedInputStream inputStream=new BufferedInputStream(new FileInputStream(\"1.mp4\"));\n        byte[] bytes=new byte[1024];\n        int tmp;\n        while((tmp=inputStream.read(bytes))!=-1){\n            outputStream.write(bytes,0,tmp);\n        }\n        outputStream.close();\n        inputStream.close();\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/Java-OI%E6%B5%81/#javaweb","title":"JavaWeb","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/Java-OI%E6%B5%81/#socket","title":"\u4f7f\u7528Socket\u4f20\u8f93\u6587\u4ef6","text":"<p>\u5ba2\u6237\u7aef</p> <pre><code>import java.io.FileInputStream;\nimport java.io.OutputStream;\nimport java.net.Socket;\n\npublic class Main {\n    public static void main(String[] args){\n        try(Socket socket =new Socket(\"localhost\",8080)) {\n            FileInputStream fileInputStream=new FileInputStream(\"1.mp4\");\n            OutputStream stream=socket.getOutputStream();\n            byte[] bytes=new byte[1024];\n\n            int tmp;\n            while((tmp=fileInputStream.read(bytes))!=-1) {\n                stream.write(bytes,0,tmp);\n            }\n            stream.flush();\n        }catch (Exception e){\n            System.out.println(\"\u8fde\u63a5\u5931\u8d25!!!\");\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre> <p>\u670d\u52a1\u7aef</p> <pre><code>import java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.net.ServerSocket;\nimport java.net.Socket;\n\npublic class Server {\n    public static void main(String[] args){\n        try(ServerSocket server=new ServerSocket(8080)){\n            Socket socket=server.accept();\n            FileOutputStream fileOutputStream=new FileOutputStream(\"net/2.mp4\");\n            InputStream stream=socket.getInputStream();\n            int tmp;\n            byte[] bytes=new byte[1024];\n            while((tmp=stream.read(bytes))!=-1) {\n                fileOutputStream.write(bytes,0,tmp);\n            }\n            fileOutputStream.flush();;\n            fileOutputStream.close();\n        }catch (IOException e){\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/Java-OI%E6%B5%81/#socket_1","title":"\u6d4f\u89c8\u5668\u8bbf\u95eeSocket\u670d\u52a1\u5668","text":"<pre><code>public static void main(String[] args) {\n    try(ServerSocket server = new ServerSocket(8080)){    //\u5c06\u670d\u52a1\u7aef\u521b\u5efa\u5728\u7aef\u53e38080\u4e0a\n        System.out.println(\"\u6b63\u5728\u7b49\u5f85\u5ba2\u6237\u7aef\u8fde\u63a5...\");\n        Socket socket = server.accept();\n        System.out.println(\"\u5ba2\u6237\u7aef\u5df2\u8fde\u63a5\uff0cIP\u5730\u5740\u4e3a\uff1a\"+socket.getInetAddress().getHostAddress());\n        BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));  //\u901a\u8fc7\n        System.out.println(\"\u63a5\u6536\u5230\u5ba2\u6237\u7aef\u6570\u636e\uff1a\");\n        while (reader.ready()) System.out.println(reader.readLine());   //ready\u662f\u5224\u65ad\u5f53\u524d\u6d41\u4e2d\u662f\u5426\u8fd8\u6709\u53ef\u8bfb\u5185\u5bb9\n        OutputStreamWriter writer = new OutputStreamWriter(socket.getOutputStream());\n        writer.write(\"HTTP/1.1 200 Accepted\\r\\n\");   //200\u662f\u54cd\u5e94\u7801\uff0cHttp\u534f\u8bae\u89c4\u5b9a200\u4e3a\u63a5\u53d7\u8bf7\u6c42\uff0c400\u4e3a\u9519\u8bef\u7684\u8bf7\u6c42\uff0c404\u4e3a\u627e\u4e0d\u5230\u6b64\u8d44\u6e90\uff08\u4e0d\u6b62\u8fd9\u4e9b\uff0c\u8fd8\u6709\u5f88\u591a\uff09\n        writer.write(\"\\r\\n\");   //\u5728\u8bf7\u6c42\u5934\u5199\u5b8c\u4e4b\u540e\u8fd8\u8981\u8fdb\u884c\u4e00\u6b21\u6362\u884c\uff0c\u7136\u540e\u5199\u5165\u6211\u4eec\u7684\u54cd\u5e94\u5b9e\u4f53\uff08\u4f1a\u5728\u6d4f\u89c8\u5668\u4e0a\u5c55\u793a\u7684\u5185\u5bb9\uff09\n        writer.write(\"lbwnb!\");\n        writer.flush();\n    }catch (Exception e){\n        e.printStackTrace();\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/linux%E5%AE%89%E8%A3%85mysql/","title":"Linux\u5b89\u88c5mysql","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/linux%E5%AE%89%E8%A3%85mysql/#mysql","title":"mysql\u5b89\u88c5\u5230\u670d\u52a1\u5668","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/linux%E5%AE%89%E8%A3%85mysql/#mysql_1","title":"\u670d\u52a1\u5668\u4e0b\u8f7dmysql","text":"<pre><code># \u901a\u8fc7Ubuntu\u6e90\u4ed3\u5e93\u6765\u5b89\u88c5mysql\nsudo apt update\nsudo apt install mysql-server\n\n# \u5b89\u88c5mysql\u5b8c\u6210\uff0cmysql\u670d\u52a1\u5c06\u4f1a\u81ea\u52a8\u542f\u52a8\uff0c\u9a8c\u8bc1mysql\u670d\u52a1\u5668\u6b63\u5728\u8fd0\u884c\uff0c\nsudo systemctl status mysql\n\n# mysql\u7684\u542f\u52a8\nsystemctl start mysql \n\n#mysql\u7684\u505c\u6b62\nsystemctl stop mysql\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/linux%E5%AE%89%E8%A3%85mysql/#mysql_2","title":"\u4e3amysql\u6dfb\u52a0\u548c\u914d\u7f6e\u7528\u6237\u6743\u9650","text":"<pre><code># \u5f53\u5b89\u88c5\u597dmysql\u540e\uff0c\u76f4\u63a5mysql\u4f1a\u767b\u5f55\u4e0d\u4e0a\uff0c\u4e0d\u77e5\u9053\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u5176\u5b9e\u5b89\u88c5mysql\u6570\u636e\u5e93\u65f6\u81ea\u52a8\u4e3a\u4f60\u8bbe\u7f6e\u81ea\u52a8\u8bbe\u7f6e\u8d26\u53f7\u5bc6\u7801\uff0c\u653e\u5728/etc/mysql/debian.cnf\u6587\u4ef6\u4e2d\n\nsudo cat /etc/mysql/debian.cnf\n\u5176\u4e2d\u7684user\u548cpassword\u5b57\u6bb5\u5c31\u662f\u8bbe\u7f6emysql\u7684\u8d26\u53f7\u548c\u5bc6\u7801\n\n# \u4f7f\u7528mysql -u \u7528\u6237\u540d -p \u56de\u8f66 \u8f93\u5165\u5bc6\u7801\u8bbf\u95ee\u8fdb\u5165\u6570\u636e\nmysql -u \u7528\u6237\u540d -p  \u56de\u8f66\n\u5bc6\u7801\n\n# \u4e3amysql\u521b\u5efa\u7528\u6237\u5e76\u8bbe\u7f6e\u5bc6\u7801\u5e76\u6388\u4e88\u6743\u9650\ncreate USER 'root'@'%' IDENTIFIED BY '\u65b0\u7684\u5bc6\u7801' #\u521b\u5efa\u7528\u6237\nGRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;\nFLUSH PRIVILEGES;\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/linux%E5%AE%89%E8%A3%85mysql/#mysql_3","title":"mysql\u914d\u7f6e\u8fdc\u7a0b\u94fe\u63a5","text":"<pre><code># \u8bbe\u7f6e\u5f53\u524d\u6570\u636e\u5e93\u53ef\u4ee5\u8fdc\u7a0b\u8bbf\u95ee\u5e76\u5f00\u53d1\u76f8\u5e94\u6743\u9650\n\n#\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cmysql\u8d26\u53f7\u4e0d\u5141\u8bb8\u8fdc\u7a0b\u767b\u5f55\uff0c\u53ea\u80fd\u5728localhost\u767b\u5f55\n\n# mysql\u7684\u914d\u7f6e\u6587\u4ef6\u901a\u5e38\u5728\uff1a /etc/mysql/my.cnf \u6216\u5728/etc/mysql/mysql.conf.d/mysqld.cnf\n\n# \u5728mysql\u7684\u7528\u6237\u8868user\u4e2d\u5c06host\u5b57\u6bb5\u7684\u503c\u6539\u4e3a%,%\u8868\u793a\u4efb\u4f55\u5ba2\u6237\u7aef\u673a\u5668\u4e0a\u90fd\u80fd\u4ee5\u8be5\u7528\u6237\u767b\u5f55\u5230mysql\u670d\u52a1\u5668\uff0c\u5e76\u6388\u4e88\u8be5\u7528\u6237\u6240\u6709\u6743\u9650\nupdate user set host = '%' where user = 'root' \n\nGRANT ALL  PRIVILEGES ON *.* TO '\u7528\u6237\u540d'@'%'IDENTIFIED BY '\u5bc6\u7801' WITH GRANT OPTION;    \n# \u67e5\u770b\u9632\u706b\u5899\u72b6\u6001\n# \u670d\u52a1\u5668\u8bbe\u7f6e\u5b89\u5168\u7ec4\u4e4b\u540e\uff0c\u670d\u52a1\u5668\u7aef\u53e3\u65e0\u6cd5\u8bbf\u95ee\uff0c\u8981\u8fdc\u7a0b\u94fe\u63a5\u9700\u8981\u5728\u670d\u52a1\u5668\u4e0a\u5f00\u53d1\u76f8\u5e94\u7684\u7aef\u53e3\uff0c\u5141\u8bb8\u6570\u636e\u5e93\u670d\u52a1\u7684\u7aef\u53e3\u53ef\u4ee5\u901a\u8fc7\n\nfirewall-cmd --list-ports #\u67e5\u770b\u5f00\u653e\u7684\u7aef\u53e3\u5217\u8868\n\n# \u5f00\u653e \u81ea\u5df1\u7684\u7aef\u53e3\nfirewall-cmd --zone=public --add-port=\u81ea\u5df1\u60f3\u5f00\u653e\u7684\u7aef\u53e3/tcp --permanent\n\n# \u5173\u95ed\u81ea\u5df1\u7684\u7aef\u53e3\nfirewall-cmd --zone=public --remove-port=\u81ea\u5df1\u60f3\u5f00\u653e\u7684\u7aef\u53e3/tcp --permanent\n\n# \u91cd\u542f\u9632\u706b\u5899\nsystemctl restart firewalld.service\n\n# \u518d\u6b21\u786e\u8ba4 \u81ea\u5df1\u7684\u7aef\u53e3 \u662f\u5426\u5f00\u653e\nfirewall-cmd --list-ports\n\n\n# \u67e5\u770b3306\u7aef\u53e3\u72b6\u6001\nnetstat -an | grep 3306\n--\u5982\u679c\u53d1\u73b0\u88ab\u7ed1\u5b9aip\u5730\u5740\u914d\u7f6e\u6587\u4ef6\u5219\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u5e76\u91cd\u542f\u542f\u52a8\u6570\u636e\u5e93\n\n#\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff0c\u5728/etc/mysql/mysql.conf.d\u6587\u4ef6\u4e0b\u7684mysqld.cnf\u4e2d\u627e\u5230bind-address\u90a3\u4e00\u884c\u6ce8\u91ca\u6389\n\n#\u91cd\u542fmysql\nsudo systemctl restart mysql\n\n\n# \u76f4\u63a5\u4f7f\u7528dataGrip\u6d4b\u8bd5\u94fe\u63a5\n</code></pre> <pre><code>## \u670d\u52a1\u5668\u5b89\u88c5redis\n</code></pre> <pre><code>1.\u5b89\u88c5redis\napt-get install redis-server\n2.\u67e5\u770b\u5b89\u88c5\u72b6\u6001\nservice redis-server status\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/linux%E5%AE%89%E8%A3%85mysql/#redis","title":"redis\u8fdc\u7a0b\u94fe\u63a5","text":"<pre><code># redis \u7684\u914d\u7f6e\u6587\u4ef6\u4e00\u822c\u5728/etc/redis/redis.conf\n\n#\u6253\u5f00redis\u914d\u7f6e\u6587\u4ef6\nvi /etc/redis/redis.conf\n\n#\u5c06bind 127.0.0.1\u6ce8\u91ca\n\n#\u5c06protected-mode\u6539\u4e3ano\nprotected-mode no\n\n#\u6dfb\u52a0\u5bc6\u7801\nrequirepass 123456\n\n#\u91cd\u542fredis\u670d\u52a1\u5668\nsystemctl restart redis-server\n\n#\u8bbe\u7f6eredis\u5f00\u673a\u81ea\u542f\u52a8\nsystemctl enable redis-server.service\n\n# \u91cd\u542fredis\nsudo systemctl restart redis-server\n\n\n# \u5173\u95ed\u81ea\u5df1\u7684\u7aef\u53e3\nfirewall-cmd --zone=public --add-port=\u81ea\u5df1\u60f3\u5f00\u653e\u7684\u7aef\u53e3/tcp --permanent\n\n# \u91cd\u542f\u9632\u706b\u5899\nsystemctl restart firewalld.service\n\n# \u518d\u6b21\u786e\u8ba4 \u81ea\u5df1\u7684\u7aef\u53e3 \u662f\u5426\u5f00\u653e\nfirewall-cmd --list-ports\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/Cargo/","title":"Cargo","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/Cargo/#rust","title":"rust","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/Cargo/#command","title":"Command","text":"<pre><code>cargo new\n</code></pre> <pre><code>cargo run\n</code></pre> <p>\u6d4b\u8bd5(\u9ed8\u8ba4<code>tests</code>\u76ee\u5f55)</p> <pre><code>cargo test\n</code></pre> <p>\u6d4b\u8bd5\u7684\u7ec4\u7ec7\u7ed3\u6784 - Rust \u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00 \u7b80\u4f53\u4e2d\u6587\u7248</p> <pre><code>cargo test --lib # \u53ea\u6d4b\u8bd5lib\n</code></pre> <p>build \u4e8c\u8fdb\u5236\u6587\u4ef6</p> <pre><code>cargo build\n</code></pre> <pre><code>cargo search # \u67e5\u627epackage\n</code></pre> <pre><code>cargo doc    # \u751f\u6210\u9879\u76ee\u6587\u6863\n</code></pre> <p>[!note] \u5728\u9879\u76ee\u5f00\u5934(\u5982lib.rs), \u6dfb\u52a0<code>#![deny(missing_docs)]</code>, \u5f3a\u5236\u6240\u6709\u516c\u5171\u9879\u76ee\u90fd\u6709\u6587\u6863\u6ce8\u91ca ref: Documentation - Rust API Guidelines</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/Cargo/#package-layout","title":"Package Layout","text":"<p>Package Layout - The Cargo Book</p> <pre><code>.\n\u251c\u2500\u2500 Cargo.lock\n\u251c\u2500\u2500 Cargo.toml\n\u251c\u2500\u2500 src/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 lib.rs\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 main.rs\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 bin/\n\u2502       \u251c\u2500\u2500 named-executable.rs\n\u2502\u00a0\u00a0  \u00a0\u00a0 \u251c\u2500\u2500 another-executable.rs\n\u2502\u00a0\u00a0  \u00a0\u00a0 \u2514\u2500\u2500 multi-file-executable/\n\u2502\u00a0\u00a0  \u00a0\u00a0     \u251c\u2500\u2500 main.rs\n\u2502\u00a0\u00a0  \u00a0\u00a0     \u2514\u2500\u2500 some_module.rs\n\u251c\u2500\u2500 benches/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 large-input.rs\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 multi-file-bench/\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 main.rs\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 bench_module.rs\n\u251c\u2500\u2500 examples/\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 simple.rs\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 multi-file-example/\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 main.rs\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 ex_module.rs\n\u2514\u2500\u2500 tests/\n    \u251c\u2500\u2500 some-integration-tests.rs\n    \u2514\u2500\u2500 multi-file-test/\n        \u251c\u2500\u2500 main.rs\n        \u2514\u2500\u2500 test_module.rs\n</code></pre> <p>\u9ed8\u8ba4\u53ef\u6267\u884c\u6587\u4ef6\u4e3a <code>main.rs</code> \uff0c\u5176\u4ed6\u5728 <code>src/bin/</code> \u76ee\u5f55\u4e0b</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/Cargo/#files","title":"Files","text":"<p><code>cargo.toml</code></p> <pre><code>[package]\nname = \"kvs\"                            # \u9879\u76ee\u540d\u79f0\nversion = \"0.1.0\"                       # \u9879\u76ee\u7248\u672c\nedition = \"2021\"                        # rust\u7248\u672c\nauthors = [\"Piako &lt;1163312641@qq.com&gt;\"] # \u4f5c\u8005\n# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\n\n[dev-dependencies]\nassert_cmd = \"0.11.0\"\npredicates = \"1.0.0\"\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/Cargo/#third-party-tools","title":"Third Party Tools","text":"<ul> <li>cargo-edit: A utility for managing cargo dependencies from the command line.</li> </ul> <p>\u5141\u8bb8\u901a\u8fc7\u4ece\u6587\u4ef6\u4e2d\u4fee\u6539 <code>Cargo.toml</code> \u6587\u4ef6\u6765\u6dfb\u52a0\u3002\u5220\u9664\u548c\u5347\u7ea7\u4f9d\u8d56\u9879</p> <pre><code>cargo add\ncargo rm\ncargo upgrade\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/Rust-Code/","title":"Rust Code","text":"<p>Count the num of files.</p> <pre><code>use std::{\n    fs,\n    sync::{Arc, Mutex},\n    time::Instant,\n};\n\nconst PATH: &amp;str = \"./\";\n\nfn main() -&gt; Result&lt;(), std::io::Error&gt; {\n    // \u8ba1\u65f6\n    let now = Instant::now();\n\n    // \u603b\u6570 Arc::new(i32) \u4e3a\u53ea\u8bfb\uff0c\u6240\u4ee5\u4f7f\u7528Arc::new(Mutex::new(0))\n    // \n    let sum = Arc::new(Mutex::new(0));\n\n    // \u641c\u7d22\n    search(PATH, Arc::clone(&amp;sum))?;\n\n    let elapsed_time = now.elapsed();\n    println!(\"{:#?}\", elapsed_time);\n    println!(\"count: {}\", *sum.lock().unwrap());\n    Ok(())\n}\n\nfn search(path: &amp;str, sum: Arc&lt;Mutex&lt;i32&gt;&gt;) -&gt; Result&lt;(), std::io::Error&gt; {\n    let files = fs::read_dir(path)?;\n    for file in files {\n        match file {\n            Ok(file) =&gt; {\n                let name = file.file_name();\n                println!(\"file: {}\", name.clone().into_string().unwrap());\n                if file.file_type().unwrap().is_dir() {\n                    search(\n                        &amp;(path.to_string() + &amp;name.into_string().unwrap() + \"/\"),\n                        sum.clone(),// .clone() \u5f15\u7528\u8ba1\u6570 + 1\n                    )?;\n                } else {\n                    *sum.lock().unwrap() += 1; // value + 1\n                }\n            }\n            Err(e) =&gt; return Err(e),\n        }\n    }\n    Ok(())\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/rust%E8%AE%B0%E5%BD%95/","title":"Rust\u8bb0\u5f55","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/rust%E8%AE%B0%E5%BD%95/#iterinto_iter","title":"iter\u548cinto_iter","text":"<p>\u5728 Rust \u4e2d\uff0c<code>iter()</code> \u548c <code>into_iter()</code> \u662f\u7528\u4e8e\u8fed\u4ee3\u96c6\u5408\u7684\u4e24\u79cd\u4e0d\u540c\u65b9\u6cd5\uff0c\u5b83\u4eec\u4e4b\u95f4\u6709\u4e00\u4e9b\u91cd\u8981\u7684\u533a\u522b\uff1a</p> <ol> <li> <p><code>iter()</code>\uff1a         <code>iter()</code> \u65b9\u6cd5\u662f\u5bf9\u96c6\u5408\u8fdb\u884c\u4e0d\u53ef\u53d8\u5f15\u7528\u7684\u8fed\u4ee3\uff0c\u56e0\u6b64\uff0c\u5b83\u5141\u8bb8\u4f60\u5728\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u8bbf\u95ee\u96c6\u5408\u4e2d\u7684\u5143\u7d20\uff0c\u4f46\u4e0d\u4f1a\u6d88\u8017\u96c6\u5408\u81ea\u8eab\uff0c\u56e0\u4e3a\u5b83\u53ea\u501f\u7528\u4e86\u96c6\u5408\u7684\u5f15\u7528\u3002         \u9002\u7528\u4e8e\u5bf9\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u8fdb\u884c\u53ea\u8bfb\u8bbf\u95ee\uff0c\u6216\u8005\u5728\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u4e0d\u9700\u8981\u62e5\u6709\u96c6\u5408\u6240\u6709\u6743\u7684\u60c5\u51b5\u3002</p> </li> <li> <p><code>into_iter()</code>\uff1a         <code>into_iter()</code> \u65b9\u6cd5\u662f\u5bf9\u96c6\u5408\u8fdb\u884c\u6240\u6709\u6743\u7684\u8fed\u4ee3\uff0c\u56e0\u6b64\uff0c\u5b83\u4f1a\u6d88\u8017\u96c6\u5408\u81ea\u8eab\uff0c\u5c06\u5176\u8f6c\u79fb\u7ed9\u8fed\u4ee3\u5668\u3002\u8fd9\u610f\u5473\u7740\u5728\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\uff0c\u96c6\u5408\u672c\u8eab\u4e0d\u80fd\u518d\u88ab\u8bbf\u95ee\u6216\u4f7f\u7528\u3002         \u9002\u7528\u4e8e\u5728\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u9700\u8981\u4fee\u6539\u96c6\u5408\u6216\u8005\u9700\u8981\u5c06\u96c6\u5408\u8f6c\u79fb\u7ed9\u8fed\u4ee3\u5668\u7684\u60c5\u51b5\u3002</p> </li> </ol> <p>\u56e0\u6b64\uff0c\u5982\u679c\u4f60\u9700\u8981\u5728\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u4fdd\u6301\u5bf9\u96c6\u5408\u7684\u8bbf\u95ee\u6743\uff0c\u5e76\u4e14\u4e0d\u5e0c\u671b\u5c06\u96c6\u5408\u8f6c\u79fb\u7ed9\u8fed\u4ee3\u5668\uff0c\u4f60\u5e94\u8be5\u4f7f\u7528 <code>iter()</code> \u65b9\u6cd5\u3002\u800c\u5982\u679c\u4f60\u9700\u8981\u5728\u8fed\u4ee3\u8fc7\u7a0b\u4e2d\u5bf9\u96c6\u5408\u8fdb\u884c\u4fee\u6539\u6216\u8005\u5c06\u5176\u8f6c\u79fb\u7ed9\u8fed\u4ee3\u5668\uff0c\u4f60\u5e94\u8be5\u4f7f\u7528 <code>into_iter()</code> \u65b9\u6cd5\u3002</p> <p>\u5c3d\u91cf\u4f7f\u7528iter</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/simple%20but%20useful%20code/","title":"\u4ee3\u7801","text":"<p>\u8f93\u5165 <pre><code>fn input() -&gt; String {\n    let mut str = String::new();\n    io::stdin().read_line(&amp;mut str).expect(\"Failed to read\");\n    str\n}\n</code></pre></p> <p>Loding in command line <pre><code>use std::{thread, time, io::{self, Write}};\n\nfn main() {\n    print!(\"\\n\");\n    let fn_thread = thread::spawn(|| loop {\n        for i in 0..4 {\n            match i {\n                0 =&gt; print!(\"\\\\\"),\n                1 =&gt; print!(\"|\"),\n                2 =&gt; print!(\"/\"),\n                3 =&gt; print!(\"-\"),\n                _ =&gt; unreachable!(\"what?\"),\n            }\n            thread::sleep(time::Duration::from_millis(100));\n            io::stdout().flush();\n            print!(\"\\u{8}\");\n            io::stdout().flush();\n        }\n    });\n\n    fn_thread.join().unwrap();\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/0.%E5%AE%89%E8%A3%85Rust%E5%92%8CHello%2CWorld/","title":"\u5b89\u88c5Rust\u548cHello,World","text":"<p>\u8fdb\u5165\u5b98\u7f51 Rust Programming Language (rust-lang.org)</p> <p>\u67e5\u770brust\u7248\u672c <pre><code>rustc  -V\n</code></pre></p> <p>\u7f16\u8bd1\u6587\u4ef6-\u7c7b\u4f3c\u4e8egcc <pre><code>rustc [file.rs]\n</code></pre></p> <p>\u66f4\u65b0rust\u3001cargo <pre><code>rustup update\n</code></pre></p> <p>[!tip] \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf RUSTUP_DIST_SERVER \uff08\u7528\u4e8e\u66f4\u65b0 toolchain\uff09\uff1a <code>export RUSTUP_DIST_SERVER=https://mirrors.ustc.edu.cn/rust-static</code></p> <p>RUSTUP_UPDATE_ROOT \uff08\u7528\u4e8e\u66f4\u65b0 rustup\uff09\uff1a <code>export RUSTUP_UPDATE_ROOT=https://mirrors.ustc.edu.cn/rust-static/rustup</code></p> <p>\u4f7f\u7528cargo\u65b0\u5efa\u9879\u76ee</p> <pre><code>cargo new hello_world\n</code></pre> <p>rust \u4f7f\u7528\u86c7\u5f62\u547d\u540d\u6cd5</p> <p>\u9879\u76ee\u7ed3\u6784 <pre><code>.\n\u251c\u2500\u2500 Cargo.toml\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 main.rs\n</code></pre></p> <p>\u68c0\u67e5\u4ee3\u7801\u80fd\u5426\u6b63\u5e38\u7f16\u8bd1(\u4e0d\u4f1a\u4ea7\u751f\u53ef\u6267\u884c\u6587\u4ef6) <pre><code>cargo check\n</code></pre></p> <p>\u6784\u5efa\u9879\u76ee</p> <p><pre><code>cargo build\n</code></pre> \u6784\u5efa\u540e\u7684\u53ef\u6267\u884c\u6587\u4ef6\u8def\u5f84<code>./target/debug/[project_name]</code></p> <p>\u7f16\u8bd1\u5e76\u8fd0\u884c\u9879\u76ee</p> <pre><code>cargo run\n</code></pre> <p>Hello,World</p> <pre><code>fn main() {\n    println!(\"Hello, world!\");\n}\n</code></pre> <p>[!info] rustup\u5305 \u5728 Arch Linux \u8f6f\u4ef6\u4ed3\u5e93\u4e2d\u53ef\u7528\u3002\u6ce8\u610f\uff0c\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u5b89\u88c5\u65f6\uff0crustup self update \u5c06\u4e0d\u8d77\u4f5c\u7528\uff0c\u53ea\u80fd\u4f7f\u7528 pacman \u66f4\u65b0 rustup\u3002</p> <p>\u4f7f\u7528\u6b64\u8f6f\u4ef6\u5305\u7684\u4f18\u70b9\u662f Rust \u53ef\u6267\u884c\u6587\u4ef6\u90fd\u5728 /usr/bin \u76ee\u5f55\u5185\uff0c\u800c\u4e0d\u662f ~/.cargo/bin\uff0c\u56e0\u6b64\u907f\u514d\u4e86\u5728 PATH \u4e2d\u6dfb\u52a0\u5176\u4ed6\u76ee\u5f55\u7684\u9ebb\u70e6\u3002</p> <p>Reference: Rust - Arch Linux \u4e2d\u6587\u7ef4\u57fa</p> <p>\u540e\uff1a1.Rust\u57fa\u672c\u8bed\u6cd5</p> <p>\u53ef\u4ee5\u53c2\u8003\u7684</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/1.Rust%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/","title":"Rust\u57fa\u672c\u8bed\u6cd5","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/1.Rust%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/#rust_1","title":"rust #\u57fa\u7840","text":"<p>\u5728 Rust \u4e2d\uff0c\u53d8\u91cf\u9ed8\u8ba4\u662f\u4e0d\u53ef\u53d8\u7684\u3002\u5728\u53d8\u91cf\u524d\u52a0 <code>mut</code> \u4f7f\u5176\u53ef\u53d8\u3002</p> <pre><code>let apples = 5; // \u4e0d\u53ef\u53d8\nlet mut bananas = 5; // \u53ef\u53d8\n</code></pre> <p>\u731c\u6570\u5b57\u6e38\u620f</p> <pre><code>use std::io;\n\nfn main() {\n    println!(\"Guess the number!\");\n\n    println!(\"Please input your guess.\");\n\n    let mut guess = String::new();\n\n    io::stdin()\n        .read_line(&amp;mut guess)\n        .expect(\"Failed to read line\");\n\n    println!(\"You guessed: {guess}\");\n}\n</code></pre> <pre><code>use rand::Rng;\nuse std::cmp::Ordering;\nuse std::io;\n\nfn main() {\n    println!(\"Guess the number!\");\n\n    let secret_number = rand::thread_rng().gen_range(1..=100);\n\n    loop {\n        println!(\"Please input your guess.\");\n\n        let mut guess = String::new();\n\n        io::stdin()\n            .read_line(&amp;mut guess)\n            .expect(\"Failed to read line\");\n\n        let guess: u32 = match guess.trim().parse() {\n            Ok(num) =&gt; num,\n            Err(_) =&gt; continue,\n        };\n\n        println!(\"You guessed: {guess}\");\n\n        match guess.cmp(&amp;secret_number) {\n            Ordering::Less =&gt; println!(\"Too small!\"),\n            Ordering::Greater =&gt; println!(\"Too big!\"),\n            Ordering::Equal =&gt; {\n                println!(\"You win!\");\n                break;\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/1.Rust%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/#_1","title":"\u57fa\u672c\u6570\u636e\u7c7b\u578b","text":"\u6574\u578b \u65e0\u7b26\u53f7\u6574\u578b \u6d6e\u70b9\u578b i8 u8 i16 u16 i32 u32 f32 i64 u64 f64 i128 u128 <p>char: \u4e3autf8\u7f16\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528\u6c49\u5b57\u3001emoji</p> <p>bool: \u4e0d\u80fd\u7528<code>0</code>\u6216<code>1</code>\u66ff\u4ee3\u8868\u793a</p> <p>\u5143\u7ec4(tuple) <pre><code>let tup: (i32, f64, u8) = (500, 6.4, 1);\nlet (x,y,z) = tup;\nprintln!(\"The value of y is: {}\",y);\n\nlet five_hundred = tup.0;\nlet one = tup.2;\n</code></pre></p> <p>[!note] \u5143\u7ec4\u7684\u904d\u5386(\u53ef\u80fd\u6709\u8bef) <code>rust for value in tuple.0..=tuple.2 {    println!(\"value is: {}\",value) }</code></p> <p>\u6570\u7ec4(array) <pre><code>let a = [1, 2, 3, 4, 5];\nlet a:[i32;5] = [1, 2, 3, 4, 5];\nlet a = [3;5] // let a = [3, 3, 3, 3, 3];\n\nlet first = a[0];\n</code></pre></p> <p>\u6d6e\u70b9\u6570\u8f6c\u6574\u6570 <pre><code>let a = 3.14;\nlet b = a as i32;\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/1.Rust%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/#_2","title":"\u51fd\u6570","text":"<p>\u8868\u8fbe\u5f0f\u62e5\u6709\u8fd4\u56de\u503c\uff0c\u800c\u8bed\u53e5\u6ca1\u6709</p> <pre><code>fn print() {\n    println!(\"Hello\");\n}\n\nfn print_c_value(c: char, value: i32) {\n    println!(\"c:{c} value:{value}\");\n}\n\nfn return_value() -&gt; i32 {\n    5\n}\n\nfn return_value_2(x: i32) -&gt; i32 {\n    x+1 // \u4e0d\u80fd\u52a0\u5206\u53f7\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/1.Rust%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/#_3","title":"\u903b\u8f91\u7ed3\u6784","text":"<p>if-else <pre><code>// condition \u5fc5\u987b\u4e3abool\u503c\uff0c\u4e0d\u80fd\u4e3a0\u62161\nif x == 3 {\n\n} else if x &gt; 3 {\n\n} else if x &lt; 3 {\n\n}\n</code></pre></p> <p>loop <pre><code>let mut counter = 0;\nloop {\n    counter += 1;\n    if counter == 10 {\n        println!(\"counter is {}\", counter)\n    }\n}\n</code></pre></p> <p>\u4ece\u5faa\u73af\u8fd4\u56de\u503c <pre><code>fn main() {\n    let mut counter = 0;\n\n    let result = loop {\n        counter += 1;\n\n        if counter == 10 {\n            break counter * 2;\n        }\n    };\n\n    println!(\"The result is {result}\");\n}\n</code></pre></p> <pre><code>The result is 20\n</code></pre> <p>loop-lable \u6807\u7b7e: ' + name <pre><code>fn main() {\n    let mut count = 0;\n    'counting_up: loop {\n        println!(\"count = {count}\");\n        let mut remaining = 10;\n        loop {\n            println!(\"remaining = {remaining}\");\n            if remaining == 9 {\n                break;\n            }\n            if count == 2 {\n                break 'counting_up;\n            }\n            remaining -= 1;\n        }\n        count += 1;\n    }\n    println!(\"End count = {count}\");\n}\n</code></pre></p> <p>while <pre><code>while x != 0 {\n    x -= 1;\n}\n</code></pre></p> <p>for <pre><code>let a = [10, 20, 30, 40, 50];\nfor element in a {\n    println!(\"the value is: {element}\");\n}\n</code></pre></p> <p>for in range <pre><code>for number in (1..4).rev() { // \u8fd9\u4e2anumber\u9ed8\u8ba4\u662fmut\u7684\n    println!(\"{number}!\");\n}\nprintln!(\"LIFTOFF!!!\");\n</code></pre></p> <p>\u540e\uff1a2.\u6240\u6709\u6743</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/10.%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/","title":"\u751f\u547d\u5468\u671f","text":"<pre><code>fn longest(x: &amp;str, y:&amp;str) -&gt; &amp;str {\n    if x.len() &gt; y.len() {\n        x\n    } else {\n        y\n    }\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d\uff0c\u7f16\u8bd1\u5668\u4e0d\u80fd\u786e\u5b9ax\u3001y\u7684\u751f\u547d\u5468\u671f</p> <pre><code> --&gt; src/main.rs:1:32\n  |\n1 | fn longest(x: &amp;str, y:&amp;str) -&gt; &amp;str {\n  |               ----    ----     ^ expected named lifetime parameter\n  |\n  = help: this function's return type contains a borrowed value, but the signature does not say whether it is borrowed from `x` or `y`\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/10.%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/#_2","title":"\u751f\u547d\u5468\u671f\u6ce8\u89e3\u8bed\u6cd5","text":"<pre><code>&amp;i32        // \u5f15\u7528\n&amp;'a i32     // \u5e26\u6709\u663e\u5f0f\u751f\u547d\u5468\u671f\u7684\u5f15\u7528\n&amp;'a mut i32 // \u5e26\u6709\u663e\u5f0f\u751f\u547d\u5468\u671f\u7684\u53ef\u53d8\u5f15\u7528\n</code></pre> <p>\u4f8b\u5982\u5982\u679c\u51fd\u6570\u6709\u4e00\u4e2a\u751f\u547d\u5468\u671f <code>'a</code> \u7684 <code>i32</code> \u7684\u5f15\u7528\u7684\u53c2\u6570 <code>first</code>\u3002\u8fd8\u6709\u53e6\u4e00\u4e2a\u540c\u6837\u662f\u751f\u547d\u5468\u671f <code>'a</code> \u7684 <code>i32</code> \u7684\u5f15\u7528\u7684\u53c2\u6570 <code>second</code>\u3002\u8fd9\u4e24\u4e2a\u751f\u547d\u5468\u671f\u6ce8\u89e3\u610f\u5473\u7740\u5f15\u7528 <code>first</code> \u548c <code>second</code> \u5fc5\u987b\u4e0e\u8fd9\u6cdb\u578b\u751f\u547d\u5468\u671f\u5b58\u5728\u5f97\u4e00\u6837\u4e45\u3002</p> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u51fd\u6570\u53ef\u4ee5\u786e\u4fdd\u8fd4\u56de\u7684\u5f15\u7528\u7684\u751f\u547d\u5468\u671f\u4e0e\u8f93\u5165\u7684\u5f15\u7528\u4e00\u81f4\uff0c\u907f\u514d\u4e86\u60ac\u5782\u5f15\u7528\u7684\u95ee\u9898\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/10.%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/#_3","title":"\u51fd\u6570\u7b7e\u540d\u4e2d\u7684\u751f\u547d\u5468\u671f\u6ce8\u89e3","text":"<pre><code>fn longest&lt;'a&gt;(x: &amp;'a str, y: &amp;'a str) -&gt; &amp;'a str {\n    if x.len() &gt; y.len() {\n        x\n    } else {\n        y\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/10.%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/#_4","title":"\u7ed3\u6784\u4f53\u5b9a\u4e49\u4e2d\u7684\u751f\u547d\u5468\u671f\u6ce8\u89e3","text":"<pre><code>struct ImportantExcerpt&lt;'a&gt; {\n    part: &amp;'a str,\n}\n\nfn main() {\n    let novel = String::from(\"Call me Ishmael. Some years ago...\");\n    let first_sentence = novel.split('.').next().expect(\"Could not find a '.'\");\n    let i = ImportantExcerpt {\n        part: first_sentence,\n    };\n}\n</code></pre> <p>\u8fd9\u4e2a\u7ed3\u6784\u4f53\u6709\u552f\u4e00\u4e00\u4e2a\u5b57\u6bb5 <code>part</code>\uff0c\u5b83\u5b58\u653e\u4e86\u4e00\u4e2a\u5b57\u7b26\u4e32 slice\uff0c\u8fd9\u662f\u4e00\u4e2a\u5f15\u7528\u3002\u7c7b\u4f3c\u4e8e\u6cdb\u578b\u53c2\u6570\u7c7b\u578b\uff0c\u5fc5\u987b\u5728\u7ed3\u6784\u4f53\u540d\u79f0\u540e\u9762\u7684\u5c16\u62ec\u53f7\u4e2d\u58f0\u660e\u6cdb\u578b\u751f\u547d\u5468\u671f\u53c2\u6570\uff0c\u4ee5\u4fbf\u5728\u7ed3\u6784\u4f53\u5b9a\u4e49\u4e2d\u4f7f\u7528\u751f\u547d\u5468\u671f\u53c2\u6570\u3002\u8fd9\u4e2a\u6ce8\u89e3\u610f\u5473\u7740 <code>ImportantExcerpt</code> \u7684\u5b9e\u4f8b\u4e0d\u80fd\u6bd4\u5176 <code>part</code> \u5b57\u6bb5\u4e2d\u7684\u5f15\u7528\u5b58\u5728\u7684\u66f4\u4e45\u3002</p> <p>\u8fd9\u91cc\u7684 <code>main</code> \u51fd\u6570\u521b\u5efa\u4e86\u4e00\u4e2a <code>ImportantExcerpt</code> \u7684\u5b9e\u4f8b\uff0c\u5b83\u5b58\u653e\u4e86\u53d8\u91cf <code>novel</code> \u6240\u62e5\u6709\u7684 <code>String</code> \u7684\u7b2c\u4e00\u4e2a\u53e5\u5b50\u7684\u5f15\u7528\u3002<code>novel</code> \u7684\u6570\u636e\u5728 <code>ImportantExcerpt</code> \u5b9e\u4f8b\u521b\u5efa\u4e4b\u524d\u5c31\u5b58\u5728\u3002\u53e6\u5916\uff0c\u76f4\u5230 <code>ImportantExcerpt</code> \u79bb\u5f00\u4f5c\u7528\u57df\u4e4b\u540e <code>novel</code> \u90fd\u4e0d\u4f1a\u79bb\u5f00\u4f5c\u7528\u57df\uff0c\u6240\u4ee5 <code>ImportantExcerpt</code> \u5b9e\u4f8b\u4e2d\u7684\u5f15\u7528\u662f\u6709\u6548\u7684\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/10.%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/#_5","title":"\u751f\u547d\u5468\u671f\u7701\u7565\u89c4\u5219","text":"<pre><code>fn first_word(s: &amp;str) -&gt; &amp;str {\n    let bytes = s.as_bytes();\n\n    for (i, &amp;item) in bytes.iter().enumerate() {\n        if item == b' ' {\n            return &amp;s[0..i];\n        }\n    }\n\n    &amp;s[..]\n}\n</code></pre> <p>\u7f16\u8bd1\u5668\u91c7\u7528\u4e09\u6761\u89c4\u5219\u6765\u5224\u65ad\u5f15\u7528\u4f55\u65f6\u4e0d\u9700\u8981\u660e\u786e\u7684\u6ce8\u89e3\u3002\u7b2c\u4e00\u6761\u89c4\u5219\u9002\u7528\u4e8e\u8f93\u5165\u751f\u547d\u5468\u671f\uff0c\u540e\u4e24\u6761\u89c4\u5219\u9002\u7528\u4e8e\u8f93\u51fa\u751f\u547d\u5468\u671f\u3002\u5982\u679c\u7f16\u8bd1\u5668\u68c0\u67e5\u5b8c\u8fd9\u4e09\u6761\u89c4\u5219\u540e\u4ecd\u7136\u5b58\u5728\u6ca1\u6709\u8ba1\u7b97\u51fa\u751f\u547d\u5468\u671f\u7684\u5f15\u7528\uff0c\u7f16\u8bd1\u5668\u5c06\u4f1a\u505c\u6b62\u5e76\u751f\u6210\u9519\u8bef\u3002\u8fd9\u4e9b\u89c4\u5219\u9002\u7528\u4e8e <code>fn</code> \u5b9a\u4e49\uff0c\u4ee5\u53ca <code>impl</code> \u5757\u3002</p> <p>[!note] \u7b2c\u4e00\u6761\u89c4\u5219\u662f\u7f16\u8bd1\u5668\u4e3a\u6bcf\u4e00\u4e2a\u5f15\u7528\u53c2\u6570\u90fd\u5206\u914d\u4e00\u4e2a\u751f\u547d\u5468\u671f\u53c2\u6570\u3002\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\uff0c\u51fd\u6570\u6709\u4e00\u4e2a\u5f15\u7528\u53c2\u6570\u7684\u5c31\u6709\u4e00\u4e2a\u751f\u547d\u5468\u671f\u53c2\u6570\uff1a<code>fn foo&lt;'a&gt;(x: &amp;'a i32)</code>\uff0c\u6709\u4e24\u4e2a\u5f15\u7528\u53c2\u6570\u7684\u51fd\u6570\u5c31\u6709\u4e24\u4e2a\u4e0d\u540c\u7684\u751f\u547d\u5468\u671f\u53c2\u6570\uff0c<code>fn foo&lt;'a, 'b&gt;(x: &amp;'a i32, y: &amp;'b i32)</code>\uff0c\u4f9d\u6b64\u7c7b\u63a8\u3002</p> <p>\u7b2c\u4e8c\u6761\u89c4\u5219\u662f\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u8f93\u5165\u751f\u547d\u5468\u671f\u53c2\u6570\uff0c\u90a3\u4e48\u5b83\u88ab\u8d4b\u4e88\u6240\u6709\u8f93\u51fa\u751f\u547d\u5468\u671f\u53c2\u6570\uff1a<code>fn foo&lt;'a&gt;(x: &amp;'a i32) -&gt; &amp;'a i32</code>\u3002</p> <p>\u7b2c\u4e09\u6761\u89c4\u5219\u662f\u5982\u679c\u65b9\u6cd5\u6709\u591a\u4e2a\u8f93\u5165\u751f\u547d\u5468\u671f\u53c2\u6570\u5e76\u4e14\u5176\u4e2d\u4e00\u4e2a\u53c2\u6570\u662f <code>&amp;self</code> \u6216 <code>&amp;mut self</code>\uff0c\u8bf4\u660e\u662f\u4e2a\u5bf9\u8c61\u7684\u65b9\u6cd5 (method)(\u8bd1\u8005\u6ce8\uff1a\u8fd9\u91cc\u6d89\u53ca rust \u7684\u9762\u5411\u5bf9\u8c61\u53c2\u89c1 17 \u7ae0)\uff0c\u90a3\u4e48\u6240\u6709\u8f93\u51fa\u751f\u547d\u5468\u671f\u53c2\u6570\u88ab\u8d4b\u4e88 <code>self</code> \u7684\u751f\u547d\u5468\u671f\u3002\u7b2c\u4e09\u6761\u89c4\u5219\u4f7f\u5f97\u65b9\u6cd5\u66f4\u5bb9\u6613\u8bfb\u5199\uff0c\u56e0\u4e3a\u53ea\u9700\u66f4\u5c11\u7684\u7b26\u53f7\u3002</p> <p>\u6839\u636e\u4e0a\u9762\u4e09\u6761\u89c4\u5219</p> <p>\u53ef\u5c06 <pre><code>fn first_word(s: &amp;str) -&gt; &amp;str {\n</code></pre> \u8f6c\u5316\u4e3a <pre><code>fn first_word&lt;'a&gt;(s: &amp;'a str) -&gt; &amp;'a str {\n</code></pre></p> <p>\u5c06 <pre><code>fn longest(x: &amp;str, y: &amp;str) -&gt; &amp;str {\n</code></pre> \u8f6c\u5316\u4e3a <pre><code>fn longest&lt;'a, 'b&gt;(x: &amp;'a str, y: &amp;'b str) -&gt; &amp;str {\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/10.%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/#_6","title":"\u65b9\u6cd5\u5b9a\u4e49\u7684\u751f\u547d\u5468\u671f\u6ce8\u89e3","text":"<p>\u9996\u5148\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u65b9\u6cd5 <code>level</code>\u3002\u5176\u552f\u4e00\u7684\u53c2\u6570\u662f <code>self</code> \u7684\u5f15\u7528\uff0c\u800c\u4e14\u8fd4\u56de\u503c\u53ea\u662f\u4e00\u4e2a <code>i32</code>\uff0c\u5e76\u4e0d\u5f15\u7528\u4efb\u4f55\u503c\uff1a</p> <pre><code>impl&lt;'a&gt; ImportantExcerpt&lt;'a&gt; {\n    fn level(&amp;self) -&gt; i32 {\n        3\n    }\n}\n</code></pre> <p><code>impl</code> \u4e4b\u540e\u548c\u7c7b\u578b\u540d\u79f0\u4e4b\u540e\u7684\u751f\u547d\u5468\u671f\u53c2\u6570\u662f\u5fc5\u8981\u7684\uff0c\u4e0d\u8fc7\u56e0\u4e3a\u7b2c\u4e00\u6761\u751f\u547d\u5468\u671f\u89c4\u5219\u6211\u4eec\u5e76\u4e0d\u5fc5\u987b\u6807\u6ce8 <code>self</code> \u5f15\u7528\u7684\u751f\u547d\u5468\u671f\u3002</p> <p>\u8fd9\u91cc\u662f\u4e00\u4e2a\u9002\u7528\u4e8e\u7b2c\u4e09\u6761\u751f\u547d\u5468\u671f\u7701\u7565\u89c4\u5219\u7684\u4f8b\u5b50\uff1a</p> <pre><code>impl&lt;'a&gt; ImportantExcerpt&lt;'a&gt; {\n    fn announce_and_return_part(&amp;self, announcement: &amp;str) -&gt; &amp;str {\n        println!(\"Attention please: {}\", announcement);\n        self.part\n    }\n}\n</code></pre> <p>\u8fd9\u91cc\u6709\u4e24\u4e2a\u8f93\u5165\u751f\u547d\u5468\u671f\uff0c\u6240\u4ee5 Rust \u5e94\u7528\u7b2c\u4e00\u6761\u751f\u547d\u5468\u671f\u7701\u7565\u89c4\u5219\u5e76\u7ed9\u4e88 <code>&amp;self</code> \u548c <code>announcement</code> \u4ed6\u4eec\u5404\u81ea\u7684\u751f\u547d\u5468\u671f\u3002\u63a5\u7740\uff0c\u56e0\u4e3a\u5176\u4e2d\u4e00\u4e2a\u53c2\u6570\u662f <code>&amp;self</code>\uff0c\u8fd4\u56de\u503c\u7c7b\u578b\u88ab\u8d4b\u4e88\u4e86 <code>&amp;self</code> \u7684\u751f\u547d\u5468\u671f\uff0c\u8fd9\u6837\u6240\u6709\u7684\u751f\u547d\u5468\u671f\u90fd\u88ab\u8ba1\u7b97\u51fa\u6765\u4e86\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/10.%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/#_7","title":"\u9759\u6001\u751f\u547d\u5468\u671f","text":"<p>\u6211\u4eec\u5728\u54ea\u91cc\u58f0\u660e\u548c\u4f7f\u7528\u751f\u547d\u5468\u671f\u53c2\u6570\uff0c\u53d6\u51b3\u4e8e\u5b83\u4eec\u662f\u4e0e\u7ed3\u6784\u4f53\u5b57\u6bb5\u76f8\u5173\u8fd8\u662f\u4e0e\u65b9\u6cd5\u53c2\u6570\u548c\u8fd4\u56de\u503c\u76f8\u5173\u3002</p> <p>\u8fd9\u91cc\u6709\u4e00\u79cd\u7279\u6b8a\u7684\u751f\u547d\u5468\u671f\u503c\u5f97\u8ba8\u8bba\uff1a<code>'static</code>\uff0c\u5176\u751f\u547d\u5468\u671f\u80fd\u591f\u5b58\u6d3b\u4e8e\u6574\u4e2a\u7a0b\u5e8f\u671f\u95f4\u3002\u6240\u6709\u7684\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u90fd\u62e5\u6709 <code>'static</code> \u751f\u547d\u5468\u671f\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u9009\u62e9\u50cf\u4e0b\u9762\u8fd9\u6837\u6807\u6ce8\u51fa\u6765\uff1a</p> <pre><code>let s: &amp;'static str = \"I have a static lifetime.\";\n</code></pre> <p>\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684\u6587\u672c\u88ab\u76f4\u63a5\u50a8\u5b58\u5728\u7a0b\u5e8f\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u800c\u8fd9\u4e2a\u6587\u4ef6\u603b\u662f\u53ef\u7528\u7684\u3002\u56e0\u6b64\u6240\u6709\u7684\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u90fd\u662f <code>'static</code> \u7684\u3002</p> <p>\u5927\u90e8\u5206\u60c5\u51b5\u4e2d\uff0c\u63a8\u8350 <code>'static</code> \u751f\u547d\u5468\u671f\u7684\u9519\u8bef\u4fe1\u606f\u90fd\u662f\u5c1d\u8bd5\u521b\u5efa\u4e00\u4e2a\u60ac\u5782\u5f15\u7528\u6216\u8005\u53ef\u7528\u7684\u751f\u547d\u5468\u671f\u4e0d\u5339\u914d\u7684\u7ed3\u679c\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u89e3\u51b3\u65b9\u6848\u662f\u4fee\u590d\u8fd9\u4e9b\u95ee\u9898\u800c\u4e0d\u662f\u6307\u5b9a\u4e00\u4e2a <code>'static</code> \u7684\u751f\u547d\u5468\u671f\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/10.%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/#trait-bounds","title":"\u7ed3\u5408\u6cdb\u578b\u7c7b\u578b\u53c2\u6570\u3001trait bounds \u548c\u751f\u547d\u5468\u671f","text":"<pre><code>use std::fmt::Display;\n\nfn longest_with_an_announcement&lt;'a, T&gt;(\n    x: &amp;'a str,\n    y: &amp;'a str,\n    ann: T,\n) -&gt; &amp;'a str\nwhere\n    T: Display,\n{\n    println!(\"Announcement! {}\", ann);\n    if x.len() &gt; y.len() {\n        x\n    } else {\n        y\n    }\n}\n</code></pre> <p>\u8fd9\u4e2a\u662f\u793a\u4f8b 10-21 \u4e2d\u90a3\u4e2a\u8fd4\u56de\u4e24\u4e2a\u5b57\u7b26\u4e32 slice \u4e2d\u8f83\u957f\u8005\u7684 <code>longest</code> \u51fd\u6570\uff0c\u4e0d\u8fc7\u5e26\u6709\u4e00\u4e2a\u989d\u5916\u7684\u53c2\u6570 <code>ann</code>\u3002<code>ann</code> \u7684\u7c7b\u578b\u662f\u6cdb\u578b <code>T</code>\uff0c\u5b83\u53ef\u4ee5\u88ab\u653e\u5165\u4efb\u4f55\u5b9e\u73b0\u4e86 <code>where</code> \u4ece\u53e5\u4e2d\u6307\u5b9a\u7684 <code>Display</code> trait \u7684\u7c7b\u578b\u3002\u8fd9\u4e2a\u989d\u5916\u7684\u53c2\u6570\u4f1a\u4f7f\u7528 <code>{}</code> \u6253\u5370\uff0c\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48 <code>Display</code> trait bound \u662f\u5fc5\u987b\u7684\u3002\u56e0\u4e3a\u751f\u547d\u5468\u671f\u4e5f\u662f\u6cdb\u578b\uff0c\u6240\u4ee5\u751f\u547d\u5468\u671f\u53c2\u6570 <code>'a</code> \u548c\u6cdb\u578b\u7c7b\u578b\u53c2\u6570 <code>T</code> \u90fd\u4f4d\u4e8e\u51fd\u6570\u540d\u540e\u7684\u540c\u4e00\u5c16\u62ec\u53f7\u5217\u8868\u4e2d\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/11.%E9%97%AD%E5%8C%85%E5%92%8C%E8%BF%AD%E4%BB%A3%E5%99%A8/","title":"\u95ed\u5305\u548c\u8fed\u4ee3\u5668","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/11.%E9%97%AD%E5%8C%85%E5%92%8C%E8%BF%AD%E4%BB%A3%E5%99%A8/#_2","title":"\u95ed\u5305","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/11.%E9%97%AD%E5%8C%85%E5%92%8C%E8%BF%AD%E4%BB%A3%E5%99%A8/#_3","title":"\u4f7f\u7528\u95ed\u5305","text":"<p>\u95ed\u5305\u662fRust\u4e2d\u7684\u4e00\u79cd\u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u6355\u83b7\u5176\u5468\u56f4\u4f5c\u7528\u57df\u4e2d\u7684\u53d8\u91cf\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u4e3a\u72b6\u6001\u3002\u8fd9\u8868\u793a\u95ed\u5305\u53ef\u4ee5\u5728\u5176\u5b9a\u4e49\u65f6\u4f7f\u7528\u5916\u90e8\u7684\u53d8\u91cf\u503c\uff0c\u5e76\u4e14\u5728\u7a0d\u540e\u8c03\u7528\u65f6\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u503c\u3002</p> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4ee3\u7801\u5c55\u793a\u4e86\u5728Rust\u4e2d\u5b9a\u4e49\u548c\u4f7f\u7528\u95ed\u5305\u7684\u793a\u4f8b\uff1a</p> <pre><code>fn main() {\n    let x = 5;\n\n    // \u5b9a\u4e49\u4e00\u4e2a\u95ed\u5305\uff0c\u5b83\u53ef\u4ee5\u8bbf\u95eex\u53d8\u91cf\n    let closure = |y| x + y;\n\n    // \u8c03\u7528\u95ed\u5305\n    let result = closure(10);\n    println!(\"The result is {}\", result); // \u8f93\u51fa \"The result is 15\"\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u95ed\u5305<code>closure</code>\uff0c\u5b83\u4f7f\u7528\u5916\u90e8\u53d8\u91cf<code>x</code>\u548c\u53c2\u6570<code>y</code>\u6765\u8ba1\u7b97\u7ed3\u679c\u3002\u7136\u540e\u6211\u4eec\u901a\u8fc7\u5c06\u53c2\u6570\u503c\u4f20\u9012\u7ed9\u95ed\u5305\u6765\u8c03\u7528\u5b83\uff0c\u5e76\u6253\u5370\u51fa\u8fd4\u56de\u7684\u7ed3\u679c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/11.%E9%97%AD%E5%8C%85%E5%92%8C%E8%BF%AD%E4%BB%A3%E5%99%A8/#_4","title":"\u95ed\u5305\u6355\u83b7\u4e0a\u4e0b\u6587","text":"<p>\u5728Rust\u4e2d\uff0c\u95ed\u5305\u53ef\u4ee5\u6355\u83b7\u5176\u5b9a\u4e49\u65f6\u6240\u5728\u7684\u4e0a\u4e0b\u6587\uff0c\u8fd9\u610f\u5473\u7740\u95ed\u5305\u53ef\u4ee5\u8bbf\u95ee\u5b83\u6240\u5b9a\u4e49\u7684\u51fd\u6570\u6216\u4f5c\u7528\u57df\u4e2d\u7684\u53d8\u91cf\u3002</p> <p>\u6355\u83b7\u4e0a\u4e0b\u6587\u53ef\u4ee5\u901a\u8fc7\u4e09\u79cd\u65b9\u5f0f\u5b9e\u73b0\uff1a\u901a\u8fc7\u503c\u6355\u83b7\uff08move\u95ed\u5305\uff09\u3001\u901a\u8fc7\u53ef\u53d8\u5f15\u7528\u6355\u83b7\u548c\u901a\u8fc7\u4e0d\u53ef\u53d8\u5f15\u7528\u6355\u83b7\u3002</p> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u4ee3\u7801\u5b9a\u4e49\u4e86\u4e00\u4e2a\u95ed\u5305\uff0c\u6355\u83b7\u4e86\u4e00\u4e2ai32\u7c7b\u578b\u7684\u503c\uff1a</p> <pre><code>fn main() {\n    let x = 10;\n    let add_x = |y| y + x;\n    println!(\"{}\", add_x(5)); // 15\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u95ed\u5305<code>add_x</code>\u6355\u83b7\u4e86\u53d8\u91cf<code>x</code>\uff0c\u5e76\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a\u4e0d\u53ef\u53d8\u5f15\u7528\u5d4c\u5165\u5230\u4e86\u95ed\u5305\u7684\u5b9a\u4e49\u4e2d\u3002</p> <p>\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7<code>move</code>\u5173\u952e\u5b57\u4f7f\u95ed\u5305\u901a\u8fc7\u503c\u6355\u83b7\u53d8\u91cf\uff1a</p> <pre><code>fn main() {\n    let x = vec![1, 2, 3];\n    let print_x = move || println!(\"{:?}\", x);\n    print_x(); // [1, 2, 3]\n    //println!(\"{:?}\", x); // ERROR: borrow of moved value: `x`\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u95ed\u5305<code>print_x</code>\u901a\u8fc7\u503c\u6355\u83b7\u4e86\u53d8\u91cf<code>x</code>\uff0c\u610f\u5473\u7740\u5b83\u62e5\u6709<code>x</code>\u7684\u6240\u6709\u6743\u3002\u5728\u95ed\u5305\u6267\u884c\u5b8c\u6bd5\u540e\uff0c<code>x</code>\u7684\u6240\u6709\u6743\u4e5f\u4f1a\u88ab\u91ca\u653e\u3002</p> <p>\u6700\u540e\uff0c\u4f60\u8fd8\u53ef\u4ee5\u901a\u8fc7\u53ef\u53d8\u5f15\u7528\u6355\u83b7\u53d8\u91cf\uff1a</p> <pre><code>fn main() {\n    let mut x = 10;\n    {\n        let add_to_x = |y| x += y;\n        add_to_x(5);\n    }\n    println!(\"{}\", x); // 15\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u95ed\u5305<code>add_to_x</code>\u901a\u8fc7\u53ef\u53d8\u5f15\u7528\u6355\u83b7\u4e86\u53d8\u91cf<code>x</code>\uff0c\u5e76\u4fee\u6539\u4e86\u5b83\u7684\u503c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/11.%E9%97%AD%E5%8C%85%E5%92%8C%E8%BF%AD%E4%BB%A3%E5%99%A8/#_5","title":"\u7c7b\u578b\u63a8\u65ad","text":"<p>\u663e\u5f0f\u7c7b\u578b\u6807\u6ce8\u5141\u8bb8\u7a0b\u5e8f\u5458\u660e\u786e\u5730\u6307\u5b9a\u95ed\u5305\u53c2\u6570\u548c\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u3002\u4f8b\u5982\uff1a</p> <pre><code>fn main() {\n    let add_one = |x: i32| -&gt; i32 {x + 1};\n    let result = add_one(1);\n    println!(\"{}\", result);\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528<code>fn(i32) -&gt; i32</code>\u6765\u663e\u5f0f\u6807\u6ce8\u95ed\u5305\u7684\u7c7b\u578b\uff0c\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u63a5\u53d7\u4e00\u4e2ai32\u7c7b\u578b\u53c2\u6570\u5e76\u8fd4\u56de\u4e00\u4e2ai32\u7c7b\u578b\u503c\u7684\u95ed\u5305\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/11.%E9%97%AD%E5%8C%85%E5%92%8C%E8%BF%AD%E4%BB%A3%E5%99%A8/#_6","title":"\u8fed\u4ee3\u5668","text":"<p>iterators5.rs</p> <p>Rust\u63d0\u4f9b\u4e86\u8fed\u4ee3\u5668\uff08Iterator\uff09\u7c7b\u578b\uff0c\u5b83\u662f\u4e00\u79cd\u7528\u4e8e\u904d\u5386\u96c6\u5408\uff08\u5982\u6570\u7ec4\u3001\u5411\u91cf\u3001\u54c8\u5e0c\u8868\u7b49\uff09\u5143\u7d20\u7684\u673a\u5236\u3002\u8fed\u4ee3\u5668\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5bf9\u96c6\u5408\u8fdb\u884c\u5404\u79cd\u64cd\u4f5c\uff0c\u5982\u8fc7\u6ee4\u3001\u6620\u5c04\u3001\u641c\u7d22\u7b49\u3002</p> <p>\u8981\u4f7f\u7528\u8fed\u4ee3\u5668\uff0c\u9996\u5148\u9700\u8981\u901a\u8fc7\u8c03\u7528\u96c6\u5408\u5bf9\u8c61\u7684<code>iter</code>\u65b9\u6cd5\u6765\u521b\u5efa\u4e00\u4e2a\u8fed\u4ee3\u5668\u5bf9\u8c61\u3002\u7136\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fed\u4ee3\u5668\u5bf9\u8c61\u4e0a\u7684\u5404\u79cd\u65b9\u6cd5\u8fdb\u884c\u904d\u5386\u548c\u64cd\u4f5c\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u5e38\u7528\u7684\u8fed\u4ee3\u5668\u65b9\u6cd5\uff1a</p> <ol> <li><code>iter()</code>\uff1a\u521b\u5efa\u4e00\u4e2a\u4e0d\u53ef\u53d8\u8fed\u4ee3\u5668\uff0c\u7528\u4e8e\u904d\u5386\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u3002</li> <li><code>iter_mut()</code>\uff1a\u521b\u5efa\u4e00\u4e2a\u53ef\u53d8\u8fed\u4ee3\u5668\uff0c\u7528\u4e8e\u904d\u5386\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u5e76\u8fdb\u884c\u4fee\u6539\u3002</li> <li><code>enumerate()</code>\uff1a\u8fd4\u56de\u4e00\u4e2a\u5143\u7d20\u548c\u5176\u7d22\u5f15\u7684\u5143\u7ec4\u7684\u8fed\u4ee3\u5668\uff0c\u53ef\u4ee5\u7528\u4e8e\u540c\u65f6\u904d\u5386\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u548c\u5b83\u4eec\u7684\u7d22\u5f15\u3002</li> <li><code>filter()</code>\uff1a\u6839\u636e\u6307\u5b9a\u7684\u6761\u4ef6\u8fc7\u6ee4\u96c6\u5408\u4e2d\u7684\u5143\u7d20\uff0c\u8fd4\u56de\u6ee1\u8db3\u6761\u4ef6\u7684\u5143\u7d20\u7684\u8fed\u4ee3\u5668\u3002</li> <li><code>map()</code>\uff1a\u5bf9\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u5e94\u7528\u4e00\u4e2a\u51fd\u6570\u5e76\u8fd4\u56de\u7ed3\u679c\u7684\u8fed\u4ee3\u5668\u3002</li> <li><code>collect()</code>\uff1a\u5c06\u8fed\u4ee3\u5668\u4e2d\u7684\u5143\u7d20\u6536\u96c6\u5230\u4e00\u4e2a\u96c6\u5408\u4e2d\uff0c\u5e76\u8fd4\u56de\u8be5\u96c6\u5408\u3002</li> <li><code>take()</code>\uff1a\u53ea\u83b7\u53d6\u8fed\u4ee3\u5668\u4e2d\u7684\u524d\u51e0\u4e2a\u5143\u7d20\u3002</li> <li><code>skip()</code>\uff1a\u8df3\u8fc7\u8fed\u4ee3\u5668\u4e2d\u7684\u524d\u51e0\u4e2a\u5143\u7d20\u3002</li> </ol> <p>\u9664\u4e86\u4e0a\u8ff0\u65b9\u6cd5\uff0c\u8fd8\u6709\u5f88\u591a\u5176\u4ed6\u7684\u8fed\u4ee3\u5668\u65b9\u6cd5\u53ef\u4ee5\u5728Rust\u7684\u6807\u51c6\u5e93\u6587\u6863\u4e2d\u627e\u5230\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u8fed\u4ee3\u5668\u5bf9\u4e00\u4e2a\u6570\u7ec4\u8fdb\u884c\u904d\u5386\u548c\u64cd\u4f5c\uff1a</p> <pre><code>fn main() {\n    let numbers = [1, 2, 3, 4, 5];\n\n    // \u904d\u5386\u5e76\u6253\u5370\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\n    for num in numbers.iter() {\n        println!(\"{}\", num);\n    }\n\n    // \u5bf9\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u8fdb\u884c\u5e73\u65b9\u64cd\u4f5c\uff0c\u5e76\u6536\u96c6\u5230\u4e00\u4e2a\u5411\u91cf\u4e2d\n    let squares: Vec&lt;i32&gt; = numbers.iter().map(|&amp;num| num * num).collect();\n\n    // \u6253\u5370\u65b0\u751f\u6210\u7684\u5411\u91cf\n    println!(\"{:?}\", squares);\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u4f7f\u7528<code>iter</code>\u65b9\u6cd5\u521b\u5efa\u4e86\u4e00\u4e2a\u6570\u7ec4\u7684\u4e0d\u53ef\u53d8\u8fed\u4ee3\u5668\uff0c\u7136\u540e\u4f7f\u7528<code>for</code>\u5faa\u73af\u904d\u5386\u4e86\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u5e76\u6253\u5370\u51fa\u6765\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u4f7f\u7528<code>map</code>\u65b9\u6cd5\u5bf9\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u8fdb\u884c\u5e73\u65b9\u64cd\u4f5c\uff0c\u7136\u540e\u4f7f\u7528<code>collect</code>\u65b9\u6cd5\u5c06\u7ed3\u679c\u6536\u96c6\u5230\u4e00\u4e2a\u5411\u91cf\u4e2d\uff0c\u5e76\u6700\u540e\u6253\u5370\u51fa\u65b0\u751f\u6210\u7684\u5411\u91cf\u3002</p> <p>\u8981\u4f7f\u7528HashMap\u7684\u8fed\u4ee3\u5668\uff0c\u9996\u5148\u9700\u8981\u5bfc\u5165HashMap\u7684\u6a21\u5757\uff1a</p> <pre><code>use std::collections::HashMap;\n</code></pre> <p>\u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aHashMap\uff0c\u5e76\u4f7f\u7528<code>iter</code>\u65b9\u6cd5\u83b7\u53d6\u5b83\u7684\u8fed\u4ee3\u5668\uff1a</p> <pre><code>let mut map = HashMap::new();\nmap.insert(\"key1\", \"value1\");\nmap.insert(\"key2\", \"value2\");\nmap.insert(\"key3\", \"value3\");\n\nfor (key, value) in map.iter() {\n    println!(\"Key: {}, Value: {}\", key, value);\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528<code>iter</code>\u65b9\u6cd5\u83b7\u53d6HashMap\u7684\u4e0d\u53ef\u53d8\u5f15\u7528\uff0c\u7136\u540e\u4f7f\u7528\u4e00\u4e2a<code>for</code>\u5faa\u73af\u6765\u904d\u5386\u8fed\u4ee3\u5668\u4e2d\u7684\u952e\u503c\u5bf9\u3002\u6bcf\u4e2a\u952e\u503c\u5bf9\u90fd\u88ab\u89e3\u6784\u4e3a\u4e00\u4e2a<code>key</code>\u548c\u4e00\u4e2a<code>value</code>\u53d8\u91cf\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u9700\u8981\u5bf9\u5b83\u4eec\u8fdb\u884c\u64cd\u4f5c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/11.%E9%97%AD%E5%8C%85%E5%92%8C%E8%BF%AD%E4%BB%A3%E5%99%A8/#hashmap","title":"HashMap\u7684\u8fed\u4ee3\u5668","text":"<p>\u5982\u679c\u4f60\u9700\u8981\u5bf9HashMap\u7684\u53ef\u53d8\u5f15\u7528\u8fdb\u884c\u8fed\u4ee3\uff0c\u53ef\u4ee5\u4f7f\u7528<code>iter_mut</code>\u65b9\u6cd5\uff1a</p> <pre><code>for (key, value) in map.iter_mut() {\n    *value = \"new value\";\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528<code>iter_mut</code>\u65b9\u6cd5\u83b7\u53d6HashMap\u7684\u53ef\u53d8\u5f15\u7528\uff0c\u5e76\u4f7f\u7528<code>*</code>\u64cd\u4f5c\u7b26\u6765\u4fee\u6539\u8fed\u4ee3\u5668\u4e2d\u7684\u503c\u3002</p> <p>\u9664\u4e86<code>iter</code>\u548c<code>iter_mut</code>\u65b9\u6cd5\u5916\uff0cHashMap\u8fd8\u63d0\u4f9b\u4e86\u5176\u4ed6\u4e00\u4e9b\u6709\u7528\u7684\u65b9\u6cd5\u6765\u5904\u7406\u952e\u503c\u5bf9\uff0c\u5305\u62ec<code>into_iter</code>\u3001<code>keys</code>\u548c<code>values</code>\u3002\u4f60\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u6c42\u9009\u62e9\u5408\u9002\u7684\u65b9\u6cd5\u6765\u8fed\u4ee3HashMap\u7684\u5185\u5bb9\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/12.%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/","title":"\u667a\u80fd\u6307\u9488","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/12.%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#boxt","title":"BOX\\&lt;T&gt;","text":"<p>\u80fd\u591f\u5728\u5806\u4e0a\u5b58\u50a8\u6570\u636e</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/12.%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#box","title":"Box\u4f7f\u7528","text":"<pre><code>fn main() {\n    let b = Box::new(5);\n    println!(\"b = {}\",b)\n}\n</code></pre> <p>Rust\u9700\u8981\u5728\u7f16\u8bd1\u65f6\u786e\u5b9a\u7c7b\u578b\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4\uff0c \u901a\u5e38\u7684\u7c7b\u578b\u4e0d\u80fd\u5904\u7406\u9012\u5f52\u7c7b\u578b\uff08\u65e0\u6cd5\u786e\u5b9a\u5c06\u8981\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4\uff09\u3002 \u800c\u7531\u4e8eBox\u662f\u6307\u9488\uff0c\u6240\u4ee5\u5b83\u80fd\u5904\u7406\u9012\u5f52\u7c7b\u578b</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/12.%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#_2","title":"\u5904\u7406\u9012\u5f52\u7c7b\u578b","text":"<pre><code>use crate::List::{Cons, Nil};\n\nfn main() {\n    let list = Cons(1,Cons(2,Cons(3,Nil)));\n}\n\n\nenum List { // \u62a5\u9519\n    Cons(i32,List),\n    Nil,\n}\n</code></pre> <pre><code>error[E0072]: recursive type `List` has infinite size\n --&gt; src/main.rs:8:1\n  |\n8 | enum List {\n  | ^^^^^^^^^\n9 |     Cons(i32,List),\n  |              ---- recursive without indirection\n  |\nhelp: insert some indirection (e.g., a `Box`, `Rc`, or `&amp;`) to break the cycle\n  |\n9 |     Cons(i32,Box&lt;List&gt;),\n  |              ++++    +\n</code></pre> <p>\u4fee\u6539\u540e\uff1a <pre><code>use crate::List::{Cons, Nil};\n\nfn main() {\n    let list = Cons(1,\n        Box::new(Cons(2,\n            Box::new(Cons(3,\n                Box::new(Nil))))));\n}\n\n\nenum List {\n    Cons(i32,Box&lt;List&gt;),\n    Nil,\n}\n</code></pre></p> <p>\u89e3\u5f15\u7528 <pre><code>fn main() {\n    let x = 5;\n    let y = Box::new(x);\n    assert_eq!(5, x);\n    assert_eq!(5, *y);\n}\n</code></pre></p> <p>\u5b9e\u73b0\u81ea\u5df1\u7684Box\u7c7b\u578b</p> <pre><code>use std::ops::Deref;\n\nstruct MyBox&lt;T&gt;(T);\n\nimpl&lt;T&gt; MyBox&lt;T&gt; {\n    fn new(x:T) -&gt; MyBox&lt;T&gt; {\n        MyBox(x)\n    }\n}\n\nimpl&lt;T&gt; Deref for MyBox&lt;T&gt; { // \u5b9e\u73b0deref\n    type Target = T;\n\n    fn deref(&amp;self) -&gt; &amp;T {\n        &amp;self.0\n    }\n}\n\nfn main() {\n    let x = 5;\n    let y = Box::new(x);\n    assert_eq!(5, x);\n    assert_eq!(5, *y);\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/12.%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#drop-trait","title":"Drop Trait","text":"<pre><code>struct CustomSmartPointer {\n    data: String,\n}\n\nimpl Drop for CustomSmartPointer {\n    fn drop(&amp;mut self) {\n        println!(\"{}\" , self.data)\n    }\n}\n\nfn main() {\n    let c = CustomSmartPointer { data: String::from(\"test\") };\n    // c.drop(); // not allowed\n    let d = CustomSmartPointer { data: String::from(\"test2\") };\n    drop(d);\n}\n</code></pre> <pre><code>test2\ntest\n</code></pre> <p>\u7c7b\u4f3c\u4e8eC++\u4e2d\u7684\u6790\u6784\u51fd\u6570</p> <p>Rust\u4e0d\u5141\u8bb8\u624b\u52a8\u8c03\u7528drop\u65b9\u6cd5 \u4f46\u53ef\u4ee5\u8c03\u7528std::mem::drop</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/12.%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#rc","title":"Rc","text":"<p>\u5f15\u7528\u8ba1\u6570\u7684\u667a\u80fd\u6307\u9488\uff08\u53ea\u80fd\u7528\u4e8e\u5355\u7ebf\u7a0b\u73af\u5883\uff09</p> <p>Rc&lt;\\T&gt; </p> <p>\u5171\u4eab\u53ea\u8bfb\u6570\u636e</p> <pre><code>use std::rc::Rc;\nuse crate::List::{Cons,Nil};\n\nenum List {\n    Cons(i32,Rc&lt;List&gt;),\n    Nil\n}\n\n\nfn main() {\n    let a = Rc::new(Cons(5,Rc::new(Cons(10,Rc::new(Nil)))));\n    println!(\"count = {}\", Rc::strong_count(&amp;a));\n\n    a.clone(); // \u7c7b\u578bclone \u6df1\u62f7\u8d1d  \u800cRc::clone\u662f\u6d45\u62f7\u8d1d \u53ea\u589e\u52a0\u5f15\u7528\u8ba1\u6570\n    println!(\"count = {}\", Rc::strong_count(&amp;a));\n\n    let b = Cons(3, Rc::clone(&amp;a)); // a\u7684\u5f15\u7528\u8ba1\u6570 + 1\n    println!(\"count = {}\", Rc::strong_count(&amp;a));\n\n    {\n        let c = Cons(4, Rc::clone(&amp;a));\n        println!(\"count = {}\", Rc::strong_count(&amp;a));\n    }\n    println!(\"count = {}\", Rc::strong_count(&amp;a));\n\n}\n</code></pre> <pre><code>count = 1\ncount = 1\ncount = 2\ncount = 3\ncount = 2\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/12.%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88/#refcell","title":"RefCell \u548c \u5185\u90e8\u53ef\u53d8\u6027","text":"<p>Rust\u4e2d\u7684<code>RefCell&lt;T&gt;</code>\u662f\u4e00\u4e2a\u667a\u80fd\u6307\u9488\uff0c\u5b83\u5141\u8bb8\u60a8\u5728\u8fd0\u884c\u65f6\u501f\u7528\u53ef\u53d8\u6216\u4e0d\u53ef\u53d8\u7684\u6570\u636e\u3002<code>RefCell&lt;T&gt;</code>\u88ab\u8bbe\u8ba1\u4e3a\u5728\u8fd0\u884c\u65f6\u68c0\u67e5\u501f\u7528\u89c4\u5219\uff0c\u800c\u4e0d\u662f\u5728\u7f16\u8bd1\u65f6\u3002</p> <p><code>RefCell&lt;T&gt;</code>\u7684\u4f7f\u7528\u901a\u5e38\u6d89\u53ca\u5230\u4e24\u79cd\u65b9\u6cd5\uff1a<code>.borrow()</code>\u548c<code>.borrow_mut()</code>\u3002<code>.borrow()</code>\u7528\u4e8e\u83b7\u53d6\u4e00\u4e2a\u4e0d\u53ef\u53d8\u5f15\u7528\uff0c\u800c<code>.borrow_mut()</code>\u7528\u4e8e\u83b7\u53d6\u4e00\u4e2a\u53ef\u53d8\u5f15\u7528\u3002\u5728\u8fd0\u884c\u65f6\uff0c<code>RefCell&lt;T&gt;</code>\u4f1a\u8ddf\u8e2a\u5f53\u524d\u7684\u501f\u7528\u60c5\u51b5\uff0c\u5e76\u5728\u8fdd\u53cd\u89c4\u5219\u65f6\u5f15\u53d1\u8fd0\u884c\u65f6\u9519\u8bef\u3002</p> <p>\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\uff0c\u5c55\u793a\u4e86\u5982\u4f55\u5728<code>RefCell&lt;T&gt;</code>\u4e2d\u5b58\u50a8\u4e00\u4e2a\u53ef\u53d8\u7684\u5b57\u7b26\u4e32\uff0c\u5e76\u8fdb\u884c\u8bfb\u53d6\u548c\u4fee\u6539\uff1a</p> <pre><code>use std::cell::RefCell;\n\nfn main() {\n    let my_string = RefCell::new(String::from(\"hello\"));\n\n    let borrowed_string = my_string.borrow();\n    println!(\"{}\", borrowed_string);\n\n    let mut mutable_string = my_string.borrow_mut();\n    mutable_string.push_str(\", world!\");\n    println!(\"{}\", mutable_string);\n}\n</code></pre> <p>\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u9996\u5148\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3a<code>my_string</code>\u7684<code>RefCell&lt;T&gt;</code>\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u4e00\u4e2a\u53ef\u53d8\u7684\u5b57\u7b26\u4e32\u3002\u7136\u540e\uff0c\u6211\u4eec\u4f7f\u7528<code>.borrow()</code>\u65b9\u6cd5\u83b7\u53d6\u4e86\u4e00\u4e2a\u4e0d\u53ef\u53d8\u7684\u5f15\u7528\uff0c\u5e76\u6253\u5370\u4e86\u5b57\u7b26\u4e32\u3002\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u4f7f\u7528<code>.borrow_mut()</code>\u65b9\u6cd5\u83b7\u53d6\u4e86\u4e00\u4e2a\u53ef\u53d8\u7684\u5f15\u7528\uff0c\u5e76\u5c06\u5176\u4fee\u6539\u4e3a\u5e26\u6709\u65b0\u503c\u7684\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u518d\u6b21\u6253\u5370\u51fa\u6765\u3002</p> <p>\u53e6\u4e00\u4e2a\u793a\u4f8b\u662f\u5728\u5faa\u73af\u4e2d\u4f7f\u7528<code>RefCell&lt;T&gt;</code>\u6765\u6784\u5efa\u4e00\u4e2a\u6811\u5f62\u7ed3\u6784\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528<code>RefCell&lt;T&gt;</code>\u6765\u5728\u8282\u70b9\u4e4b\u95f4\u4f20\u9012\u53ef\u53d8\u5f15\u7528\uff1a</p> <pre><code>use std::cell::RefCell;\n\n#[derive(Debug)]\nstruct Node {\n    value: i32,\n    left: Option&lt;Box&lt;Node&gt;&gt;,\n    right: Option&lt;Box&lt;Node&gt;&gt;,\n}\n\nfn main() {\n    let leaf1 = Node {\n        value: 1,\n        left: None,\n        right: None,\n    };\n    let leaf2 = Node {\n        value: 2,\n        left: None,\n        right: None,\n    };\n    let node1 = Node {\n        value: 3,\n        left: Some(Box::new(leaf1)),\n        right: Some(Box::new(leaf2)),\n    };\n    let leaf3 = Node {\n        value: 4,\n        left: None,\n        right: None,\n    };\n    let leaf4 = Node {\n        value: 5,\n        left: None,\n        right: None,\n    };\n    let node2 = Node {\n        value: 6,\n        left: Some(Box::new(leaf3)),\n        right: Some(Box::new(leaf4)),\n    };\n    let root = Node {\n        value: 7,\n        left: Some(Box::new(node1)),\n        right: Some(Box::new(node2)),\n    };\n    let tree = RefCell::new(root);\n\n    inorder_traversal(&amp;tree.borrow());\n}\n\nfn inorder_traversal(node: &amp;Node) {\n    if let Some(left) = &amp;node.left {\n        inorder_traversal(left);\n    }\n    println!(\"{}\", node.value);\n    if let Some(right) = &amp;node.right {\n        inorder_traversal(right);\n    }\n}\n</code></pre> <p>\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u6784\u5efa\u4e86\u4e00\u4e2a\u4e8c\u53c9\u6811\uff0c\u5e76\u4f7f\u7528<code>RefCell&lt;T&gt;</code>\u6765\u5728\u8282\u70b9\u4e4b\u95f4\u4f20\u9012\u53ef\u53d8\u5f15\u7528\u3002\u6211\u4eec\u8fd8\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u4e3a<code>inorder_traversal()</code>\u7684\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u4f7f\u7528\u9012\u5f52\u65b9\u5f0f\u904d\u5386\u4e8c\u53c9\u6811\uff0c\u5e76\u6309\u987a\u5e8f\u6253\u5370\u51fa\u6bcf\u4e2a\u8282\u70b9\u7684\u503c\u3002</p> <pre><code>use std::{rc::Rc, cell::{RefCell, Ref}};\nuse crate::List::{Cons,Nil};\n\n#[derive(Debug)]\nenum List {\n    Cons(Rc&lt;RefCell&lt;i32&gt;&gt;,Rc&lt;List&gt;),\n    Nil\n}\n\n\nfn main() {\n    let value = Rc::new(RefCell::new(5));\n    let a = Rc::new(Cons(Rc::clone(&amp;value), Rc::new(Nil)));\n    let b = Cons(Rc::new(RefCell::new(6)), Rc::clone(&amp;a));\n    let c =Cons(Rc::new(RefCell::new(6)), Rc::clone(&amp;a));\n\n    *value.borrow_mut() += 10;\n    println!(\"a after = {:?}\",a);\n    println!(\"b after = {:?}\",b);\n    println!(\"c after = {:?}\",c);\n\n}\n</code></pre> <p>output <pre><code>a after = Cons(RefCell { value: 15 }, Nil)\nb after = Cons(RefCell { value: 6 }, Cons(RefCell { value: 15 }, Nil))\nc after = Cons(RefCell { value: 6 }, Cons(RefCell { value: 15 }, Nil))\n</code></pre></p> <p>\u9632\u6b62\u5faa\u73af\u5f15\u7528\u628aRc&lt;\\T&gt;\u6362\u4e3aWeak&lt;\\T&gt;</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/13.%E5%B9%B6%E5%8F%91/","title":"\u5e76\u53d1","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/13.%E5%B9%B6%E5%8F%91/#_2","title":"\u591a\u7ebf\u7a0b","text":"<pre><code>fn main() {\n    print!(\"\\n\");\n    let fn_thread = thread::spawn(|| loop {\n        println!(\"\u4f60\u597d\uff01\");\n        thread::sleep(time::Duration::from_millis(100)); // sleep 0.1\u79d2\n    });\n\n    fn_thread.join().unwrap(); // \u963b\u585e\u4e3b\u7ebf\u7a0b\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/13.%E5%B9%B6%E5%8F%91/#_3","title":"\u6d88\u606f\u4f20\u9012","text":"<pre><code>use std::{sync::mpsc, thread};\n\nfn main() {\n    let (tx, rx) = mpsc::channel();\n\n    thread::spawn(move || {\n        let val = String::from(\"hi\");\n        tx.send(val).unwrap();\n    });\n\n    let received = rx.recv().unwrap(); // \u6536\u5230\u503c\u524d\u963b\u585e\n    // try_recv() // \u4e0d\u4f1a\u963b\u585e\n    println!(\"Got: {}\",received);\n}\n</code></pre> <pre><code>Got: hi\n</code></pre> <pre><code>use std::{sync::mpsc, thread, time::Duration, vec};\n\nfn main() {\n    let (tx, rx) = mpsc::channel();\n\n    thread::spawn(move || {\n        let vals = vec![\n            String::from(\"Hi\"),\n            String::from(\"from\"),\n            String::from(\"the\"),\n            String::from(\"thread\"),\n        ];\n        for val in vals {\n            tx.send(val).unwrap();\n            thread::sleep(Duration::from_millis(1));\n        }\n    });\n\n    for received in rx {\n        println!(\"Got: {}\", received);\n    }\n}\n</code></pre> <p>output <pre><code>Got: Hi\nGot: from\nGot: the\nGot: thread\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/13.%E5%B9%B6%E5%8F%91/#_4","title":"\u5171\u4eab\u5185\u5b58","text":"<pre><code>use std::sync::Mutex;\n\nfn main() {\n    let m = Mutex::new(5);\n\n    {\n        let mut num = m.lock().unwrap();\n        *num = 6;\n    }\n\n    println!(\"m = {:?}\", m);\n}\n</code></pre> <pre><code>m = Mutex { data: 6, poisoned: false, .. }\n</code></pre> <p>Mutex\u53ef\u80fd\u4ea7\u751f\u6b7b\u9501</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/13.%E5%B9%B6%E5%8F%91/#_5","title":"\u5176\u4ed6","text":"<p>\u53ef\u4ee5\u4f7f\u7528Arc&lt;\\T&gt;\uff0c \u7528\u6cd5\u4e0eRc&lt;\\T&gt;\u7c7b\u4f3c</p> <p>\u4f7f\u7528Send \u548c Sync trait\u62d3\u5c55\u5e76\u53d1\uff0c\u4f46\u662f\u624b\u52a8\u5b9e\u73b0Send \u548c Sync\u662f\u4e0d\u5b89\u5168\u7684</p> <p>Arc&lt;\\T&gt; </p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/","title":"\u8fdb\u9636","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#unsafe-rust","title":"Unsafe Rust","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_2","title":"\u89e3\u5f15\u7528\u539f\u59cb\u6307\u9488","text":"<p>\u9519\u8bef <pre><code>fn main() {\n    let mut num = 5;\n    let r1 = &amp;num as *const i32;\n    let r2 = &amp;mut num as *mut i32;\n\n\n    println!(\"r1: {}\",*r1); // dereference of raw pointer is unsafe and requires unsafe function or block\n    println!(\"r2: {}\",*r2);\n\n    let address = 0x012345usize;\n    let r = address as *const i32;\n}\n</code></pre></p> <p>\u6b63\u786e <pre><code>fn main() {\n    let mut num = 5;\n    let r1 = &amp;num as *const i32;\n    let r2 = &amp;mut num as *mut i32;\n\n    unsafe {\n        println!(\"r1: {}\",*r1);\n        println!(\"r2: {}\",*r2);\n    }\n\n    let address = 0x012345usize;\n    let r = address as *const i32;\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#unsafe","title":"Unsafe\u5173\u952e\u5b57","text":"<pre><code>unsafe fn dangerous() {}\n\n\nfn main() {\n    dangerous(); // \u62a5\u9519\n\n    unsafe {\n        dangerous(); // \u4e0d\u62a5\u9519\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#extern","title":"\u4f7f\u7528 extern \u51fd\u6570\u8c03\u7528\u5916\u90e8\u4ee3\u7801","text":"<p>\u4efb\u4f55extern\u5757\u4e2d\u7684\u51fd\u6570\u58f0\u660e\u90fd\u662f\u4e0d\u5b89\u5168\u7684\uff0c\u56e0\u4e3a\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u662f\u4e0d\u5b89\u5168\u7684</p> <p>\u5e94\u7528ABI\uff0c\u5b9a\u4e49\u51fd\u6570\u5728\u6c47\u7f16\u5c42\u9762\u7684\u8c03\u7528\u65b9\u5f0f</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#rust","title":"\u4eceRust\u51fd\u6570\u8c03\u7528\u5176\u4ed6\u8bed\u8a00","text":"<p>\u5728 Rust \u4e2d\uff0cextern \u53ef\u4ee5\u7528\u6765\u58f0\u660e\u5916\u90e8\u51fd\u6570\u3001\u53d8\u91cf\u548c\u7c7b\u578b\uff0c\u8fd9\u4e9b\u51fd\u6570\u3001\u53d8\u91cf\u548c\u7c7b\u578b\u90fd\u662f\u5728\u5176\u4ed6\u8bed\u8a00\u4e2d\u5b9a\u4e49\u7684\u3002\u5f53 Rust \u7a0b\u5e8f\u9700\u8981\u4f7f\u7528\u8fd9\u4e9b\u5916\u90e8\u51fd\u6570\u3001\u53d8\u91cf\u548c\u7c7b\u578b\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 extern \u5173\u952e\u5b57\u5c06\u5176\u5bfc\u5165\u3002</p> <p>\u4f8b\u5982\uff0c\u4e0b\u9762\u662f\u5bfc\u5165\u4e00\u4e2a\u5916\u90e8 C \u8bed\u8a00\u5e93\u7684\u793a\u4f8b\uff1a</p> <pre><code>// \u4f7f\u7528 extern \u5bfc\u5165\u5916\u90e8 C \u8bed\u8a00\u5e93\nextern \"C\" {\n    fn printf(format: *const u8, ...) -&gt; i32; // \u51fd\u6570\u58f0\u660e\n}\n\nfn main() {\n    // \u8c03\u7528 printf \u51fd\u6570\n    let msg = b\"Hello, world!\\0\";\n    unsafe {\n        printf(b\"%s\\0\".as_ptr(), msg.as_ptr());\n    }\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528 extern \u5173\u952e\u5b57\u5c06 printf \u51fd\u6570\u5bfc\u5165\u5230 Rust \u7a0b\u5e8f\u4e2d\uff0c\u5e76\u5728 main \u51fd\u6570\u4e2d\u8c03\u7528\u4e86\u5b83\u3002\u6ce8\u610f\uff0c\u5728\u8c03\u7528 printf \u51fd\u6570\u65f6\uff0c\u9700\u8981\u5728 unsafe \u5757\u4e2d\u6267\u884c\uff0c\u56e0\u4e3a printf \u662f\u4e00\u4e2a\u5916\u90e8\u51fd\u6570\uff0c\u5b83\u7684\u5b9e\u73b0\u53ef\u80fd\u4e0d\u7b26\u5408 Rust \u7684\u5b89\u5168\u8981\u6c42\u3002</p> <p>\u9664\u4e86\u4f7f\u7528 extern \u5bfc\u5165 C \u8bed\u8a00\u5e93\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528 extern Rust \u8bed\u8a00\u5e93\u6216\u8005\u5176\u4ed6\u8bed\u8a00\u5e93\u3002\u5728\u5bfc\u5165 Rust \u8bed\u8a00\u5e93\u65f6\uff0c\u9700\u8981\u6307\u5b9a\u5e93\u7684\u540d\u79f0\u548c\u7248\u672c\u53f7\uff1b\u5728\u5bfc\u5165\u5176\u4ed6\u8bed\u8a00\u5e93\u65f6\uff0c\u5219\u9700\u8981\u6307\u5b9a\u5e93\u7684\u8def\u5f84\u548c\u540d\u79f0\u3002</p> <p>\u5176\u4ed6\u8bed\u8a00\u8c03\u7528rust</p> <pre><code>#[no_mangle]\npub extern \"C\" fn call_from_c() {\n    println!(\"Just called a Rust function from C!\")\n}\n\nfn main() {}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_3","title":"\u8bbf\u95ee\u6216\u4fee\u6539\u4e00\u4e2a\u9759\u6001\u53d8\u91cf","text":"<pre><code>static mut COUNTER: u32 = 0;\n\nfn add_to_count(inc: u32) {\n    unsafe {\n        COUNTER += inc;\n    }\n}\n\nfn main() {\n    add_to_count(3);\n\n    unsafe {\n        println!(\"COUNTER: {}\", COUNTER);\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#unsafe-trait","title":"Unsafe trait","text":"<pre><code>unsafe trait MyTrait {\n    fn my_func(&amp;self) -&gt; i32;\n}\n\nstruct MyStruct {\n    value: i32,\n}\n\nunsafe impl MyTrait for MyStruct {\n    fn my_func(&amp;self) -&gt; i32 {\n        self.value * 2\n    }\n}\n\nfn main() {\n    let my_struct = MyStruct { value: 5 };\n    let my_trait: &amp;dyn MyTrait = &amp;my_struct;\n\n    unsafe {\n        println!(\"{}\", my_trait.my_func());\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#trait","title":"\u9ad8\u7ea7Trait","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_4","title":"\u5173\u8054\u7c7b\u578b","text":"<pre><code>pub trait Iterator {\n    type Item;\n\n    fn next(&amp;mut self) -&gt; Option&lt;Self::Item&gt;;\n}\n\nfn main() {\n    println!(\"Hello, world!\");\n}\n</code></pre> <p>\u53ef\u4ee5\u4e3a\u7c7b\u578b\u5b9e\u73b0\u591a\u4e2a\u4e0d\u540c\u7684trait</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_5","title":"\u9ad8\u7ea7\u7c7b\u578b","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_6","title":"\u7c7b\u578b\u522b\u540d","text":"<pre><code>type i3 = i32;\n\nfn main() {\n    let a:i3 = 0;\n\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#never","title":"never\u7c7b\u578b","text":"<p>!</p> <pre><code>print!() // \u8fd4\u56de\u503c\u4e3a\u300cempty type\u300d\npanic!()\n</code></pre> <p>\u7528\u4e8e\u5728\u4e0d\u8fd4\u56de\u7684\u51fd\u6570\u4e2d\u5145\u5f53\u8fd4\u56de\u7c7b\u578b</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_7","title":"\u52a8\u6001\u5927\u5c0f","text":"<p>\u9ad8\u7ea7\u7c7b\u578b - Rust \u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00 \u7b80\u4f53\u4e2d\u6587\u7248</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_8","title":"\u9ad8\u7ea7\u51fd\u6570\u548c\u95ed\u5305","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_9","title":"\u51fd\u6570\u6307\u9488","text":"<pre><code>fn add_one(x: i32) -&gt; i32 {\n    x + 1\n}\n\nfn do_twice(f: fn(i32) -&gt; i32, arg: i32) -&gt; i32 {\n    f(arg) + f(arg)\n}\n\nfn main() {\n    let answer = do_twice(add_one, 5);\n\n    println!(\"The answer is: {}\", answer);\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_10","title":"\u8fd4\u56de\u95ed\u5305","text":"<p>\u9519\u8bef <pre><code>fn returns_closure() -&gt; dyn Fn(i32) -&gt; i32 { // Rust \u5e76\u4e0d\u77e5\u9053\u9700\u8981\u591a\u5c11\u7a7a\u95f4\u6765\u50a8\u5b58\u95ed\u5305\n    |x| x + 1\n}\n</code></pre></p> <pre><code>fn returns_closure() -&gt; Box&lt;dyn Fn(i32) -&gt; i32&gt; {\n    Box::new(|x| x + 1)\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_11","title":"\u5b8f","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_12","title":"\u58f0\u660e\u5b8f","text":"<pre><code>#![allow(unused)]\nfn main() {\nlet v: Vec&lt;u32&gt; = vec![1, 2, 3];\n}\n</code></pre> <p>vec!\u5b8f\u7684\u5b9a\u4e49 <pre><code>#[macro_export]\nmacro_rules! vec {\n    ( $( $x:expr ),* ) =&gt; {\n        {\n            let mut temp_vec = Vec::new();\n            $(\n                temp_vec.push($x);\n            )*\n            temp_vec\n        }\n    };\n}\n</code></pre></p> <p><code>#[macro_export]</code>\u00a0\u6ce8\u89e3\u8868\u660e\u53ea\u8981\u5bfc\u5165\u4e86\u5b9a\u4e49\u8fd9\u4e2a\u5b8f\u7684 crate\uff0c\u8be5\u5b8f\u5c31\u5e94\u8be5\u662f\u53ef\u7528\u7684\u3002\u5982\u679c\u6ca1\u6709\u8be5\u6ce8\u89e3\uff0c\u8fd9\u4e2a\u5b8f\u4e0d\u80fd\u88ab\u5f15\u5165\u4f5c\u7528\u57df\u3002</p> <pre><code>macro_rules! my_macro {\n    () =&gt; {\n        println!(\"Check out my macro!\");\n    };\n}\n\nfn main() {\n    my_macro!();\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#_13","title":"\u7c7b\u51fd\u6570\u5b8f","text":"<pre><code>use proc_macro;\n\n#[some_attribute]\npub fn some_name(input: TokenStream) -&gt; TokenStream {\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/14.%20%E8%BF%9B%E9%98%B6/#derive","title":"\u81ea\u5b9a\u4e49derive\u5b8f","text":"<p>\u5b8f - Rust \u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00 \u7b80\u4f53\u4e2d\u6587\u7248</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/","title":"\u6240\u6709\u6743","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#rust","title":"rust","text":"<p>[!important] \u6240\u6709\u6743\u7684\u89c4\u5219\uff1a 1. Rust \u4e2d\u7684\u6bcf\u4e00\u4e2a\u503c\u90fd\u6709\u4e00\u4e2a\u00a0\u6240\u6709\u8005\uff08owner\uff09\u3002 2. \u503c\u5728\u4efb\u4e00\u65f6\u523b\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u6240\u6709\u8005\u3002 3. \u5f53\u6240\u6709\u8005\uff08\u53d8\u91cf\uff09\u79bb\u5f00\u4f5c\u7528\u57df\uff0c\u8fd9\u4e2a\u503c\u5c06\u88ab\u4e22\u5f03\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_2","title":"\u53d8\u91cf\u4f5c\u7528\u57df","text":"<pre><code>{                      // s \u5728\u8fd9\u91cc\u65e0\u6548\uff0c\u5b83\u5c1a\u672a\u58f0\u660e\n    let s = \"hello\";   // \u4ece\u6b64\u5904\u8d77\uff0cs \u662f\u6709\u6548\u7684\n\n    // \u4f7f\u7528 s\n}                      // \u6b64\u4f5c\u7528\u57df\u5df2\u7ed3\u675f\uff0cs \u4e0d\u518d\u6709\u6548\n</code></pre> <ul> <li>\u5f53\u00a0<code>s</code> \u8fdb\u5165\u4f5c\u7528\u57df\u00a0\u65f6\uff0c\u5b83\u5c31\u662f\u6709\u6548\u7684\u3002</li> <li>\u8fd9\u4e00\u76f4\u6301\u7eed\u5230\u5b83\u00a0\u79bb\u5f00\u4f5c\u7528\u57df\u00a0\u4e3a\u6b62\u3002</li> </ul> <p>rust\u7684\u53d8\u91cf\u4f5c\u7528\u57df\u4e0e\u5176\u4ed6\u8bed\u8a00\u7c7b\u4f3c</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#string","title":"String\u7c7b\u578b","text":"<p>\u4f7f\u7528\u00a0<code>from</code>\u00a0\u51fd\u6570\u57fa\u4e8e\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u6765\u521b\u5efa\u00a0<code>String</code></p> <pre><code>let s = String::from(\"hello\");\n</code></pre> <p>\u4e24\u4e2a\u5192\u53f7\u00a0<code>::</code>\u00a0\u662f\u8fd0\u7b97\u7b26\uff0c\u5141\u8bb8\u5c06\u7279\u5b9a\u7684\u00a0<code>from</code>\u00a0\u51fd\u6570\u7f6e\u4e8e\u00a0<code>String</code>\u00a0\u7c7b\u578b\u7684\u547d\u540d\u7a7a\u95f4\uff08namespace\uff09\u4e0b</p> <p>\u4fee\u6539\u6b64\u7c7b\u5b57\u7b26\u4e32</p> <pre><code>let mut s = String::from(\"hello\");\n\ns.push_str(\", world!\"); // push_str() \u5728\u5b57\u7b26\u4e32\u540e\u8ffd\u52a0\u5b57\u9762\u503c\n\nprintln!(\"{}\", s); // \u5c06\u6253\u5370 `hello, world!`\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_3","title":"\u5185\u5b58\u4e0e\u5206\u914d","text":"<p>\u5bf9\u4e8e\u00a0<code>String</code>\u00a0\u7c7b\u578b\uff0c\u4e3a\u4e86\u652f\u6301\u4e00\u4e2a\u53ef\u53d8\uff0c\u53ef\u589e\u957f\u7684\u6587\u672c\u7247\u6bb5\uff0c\u9700\u8981\u5728\u5806\u4e0a\u5206\u914d\u4e00\u5757\u5728\u7f16\u8bd1\u65f6\u672a\u77e5\u5927\u5c0f\u7684\u5185\u5b58\u6765\u5b58\u653e\u5185\u5bb9\u3002\u8fd9\u610f\u5473\u7740\uff1a</p> <ul> <li>\u5fc5\u987b\u5728\u8fd0\u884c\u65f6\u5411\u5185\u5b58\u5206\u914d\u5668\uff08memory allocator\uff09\u8bf7\u6c42\u5185\u5b58\u3002</li> <li>\u9700\u8981\u4e00\u4e2a\u5f53\u6211\u4eec\u5904\u7406\u5b8c\u00a0<code>String</code>\u00a0\u65f6\u5c06\u5185\u5b58\u8fd4\u56de\u7ed9\u5206\u914d\u5668\u7684\u65b9\u6cd5</li> </ul> <pre><code>{\n    let s = String::from(\"hello\"); // \u4ece\u6b64\u5904\u8d77\uff0cs \u662f\u6709\u6548\u7684\n\n    // \u4f7f\u7528 s\n}                                  // \u6b64\u4f5c\u7528\u57df\u5df2\u7ed3\u675f\uff0c\n                                   // s \u4e0d\u518d\u6709\u6548 \u8c03\u7528drop\n</code></pre> <p>\u5f53\u00a0<code>s</code>\u00a0\u79bb\u5f00\u4f5c\u7528\u57df\u7684\u65f6\u5019\u3002\u5f53\u53d8\u91cf\u79bb\u5f00\u4f5c\u7528\u57df\uff0cRust \u4e3a\u6211\u4eec\u8c03\u7528\u4e00\u4e2a\u7279\u6b8a\u7684\u51fd\u6570\u3002\u8fd9\u4e2a\u51fd\u6570\u53eb\u505a\u00a0<code>drop</code>\uff0c\u5728\u8fd9\u91cc\u00a0<code>String</code>\u00a0\u7684\u4f5c\u8005\u53ef\u4ee5\u653e\u7f6e\u91ca\u653e\u5185\u5b58\u7684\u4ee3\u7801\u3002Rust \u5728\u7ed3\u5c3e\u7684\u00a0<code>}</code>\u00a0\u5904\u81ea\u52a8\u8c03\u7528\u00a0<code>drop</code>\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_4","title":"\u53d8\u91cf\u4e0e\u6570\u636e\u4ea4\u4e92\u7684\u65b9\u5f0f\uff08\u4e00\uff09\uff1a\u79fb\u52a8","text":"<pre><code>let x = 5;\nlet y = x;\n</code></pre> <p>\u5c06\u00a0<code>5</code>\u00a0\u7ed1\u5b9a\u5230\u00a0<code>x</code>\uff1b\u63a5\u7740\u751f\u6210\u4e00\u4e2a\u503c\u00a0<code>x</code>\u00a0\u7684\u62f7\u8d1d\u5e76\u7ed1\u5b9a\u5230\u00a0<code>y</code></p> <p>\u800c\u5bf9\u4e8e<code>String</code>\u6765\u8bf4 <pre><code>let s1 = String::from(\"hello\");\nlet s2 = s1;\n</code></pre></p> <p> \"hello\" \u88ab\u7ed1\u5b9a\u7ed9 <code>s1</code></p> <p></p> <p>\u53d8\u91cf\u00a0<code>s2</code>\u00a0\u7684\u5185\u5b58\u8868\u73b0\uff0c\u5b83\u6709\u4e00\u4efd\u00a0<code>s1</code>\u00a0\u6307\u9488\u3001\u957f\u5ea6\u548c\u5bb9\u91cf\u7684\u62f7\u8d1d</p> <p>\u7531\u4e8e<code>drop</code>\u7684\u7f18\u6545\uff0c\u8fd9\u6bb5\u4ee3\u7801\u4e0d\u80fd\u591f\u8fd0\u884c\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u4e8c\u6b21\u91ca\u653e</p> <pre><code>fn main() {\n    let s1 = String::from(\"hello\");\n    let s2 = s1;\n\n    println!(\"{}, world!\", s1);\n}\n</code></pre> <p>\u4e3a\u4e86\u786e\u4fdd\u5185\u5b58\u5b89\u5168\uff0c\u5728\u00a0<code>let s2 = s1;</code>\u00a0\u4e4b\u540e\uff0cRust \u8ba4\u4e3a\u00a0<code>s1</code>\u00a0\u4e0d\u518d\u6709\u6548\uff0c\u56e0\u6b64 Rust \u4e0d\u9700\u8981\u5728\u00a0<code>s1</code>\u00a0\u79bb\u5f00\u4f5c\u7528\u57df\u540e\u6e05\u7406\u4efb\u4f55\u4e1c\u897f\u3002\u770b\u770b\u5728\u00a0<code>s2</code>\u00a0\u88ab\u521b\u5efa\u4e4b\u540e\u5c1d\u8bd5\u4f7f\u7528\u00a0<code>s1</code>\u00a0\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1b\u8fd9\u6bb5\u4ee3\u7801\u4e0d\u80fd\u8fd0\u884c\uff1a</p> <p>Rust\u7f16\u8bd1\u65f6\u4f1a\u4ea7\u751f\u9519\u8bef\uff0c\u7981\u6b62\u4f60\u4f7f\u7528\u65e0\u6548\u7684\u5f15\u7528\u3002</p> <p>\u5982\u679c\u4f60\u5728\u5176\u4ed6\u8bed\u8a00\u4e2d\u542c\u8bf4\u8fc7\u672f\u8bed\u00a0\u6d45\u62f7\u8d1d\uff08shallow copy\uff09\u548c\u00a0\u6df1\u62f7\u8d1d\uff08deep copy\uff09\uff0c\u90a3\u4e48\u62f7\u8d1d\u6307\u9488\u3001\u957f\u5ea6\u548c\u5bb9\u91cf\u800c\u4e0d\u62f7\u8d1d\u6570\u636e\u53ef\u80fd\u542c\u8d77\u6765\u50cf\u6d45\u62f7\u8d1d\u3002\u4e0d\u8fc7\u56e0\u4e3a Rust \u540c\u65f6\u4f7f\u7b2c\u4e00\u4e2a\u53d8\u91cf\u65e0\u6548\u4e86\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u88ab\u79f0\u4e3a\u00a0\u79fb\u52a8\uff08move\uff09\uff0c\u800c\u4e0d\u662f\u53eb\u505a\u6d45\u62f7\u8d1d\u3002\u4e0a\u9762\u7684\u4f8b\u5b50\u53ef\u4ee5\u89e3\u8bfb\u4e3a\u00a0<code>s1</code>\u00a0\u88ab\u00a0\u79fb\u52a8\u00a0\u5230\u4e86\u00a0<code>s2</code>\u00a0\u4e2d\u3002</p> <p>\u800cRust\u6c38\u8fdc\u4e0d\u4f1a\u81ea\u52a8\u521b\u5efa\u6570\u636e\u7684\u201c\u6df1\u62f7\u8d1d\u201d</p> <p>\u56e0\u6b64<code>s2</code>\u662f\u5b9e\u9645\u6709\u6548\u7684\uff0c\u53ef\u4ee5\u5c06<code>println!(\"{}, world!\", s1);</code>\u4e2d\u7684<code>s1</code>\u6539\u4e3a<code>s2</code>\uff0c\u4f7f\u5176\u6b63\u5e38\u8fd0\u884c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_5","title":"\u53d8\u91cf\u4e0e\u6570\u636e\u4ea4\u4e92\u7684\u65b9\u5f0f\uff08\u4e8c\uff09\uff1a\u514b\u9686","text":"<p>\u5982\u679c\u6211\u4eec\u00a0\u786e\u5b9e\u00a0\u9700\u8981\u6df1\u5ea6\u590d\u5236\u00a0<code>String</code>\u00a0\u4e2d\u5806\u4e0a\u7684\u6570\u636e\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u6808\u4e0a\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u53eb\u505a\u00a0<code>clone</code>\u00a0\u7684\u901a\u7528\u51fd\u6570\u3002</p> <p>\u8fd9\u662f\u4e00\u4e2a\u5b9e\u9645\u4f7f\u7528\u00a0<code>clone</code>\u00a0\u65b9\u6cd5\u7684\u4f8b\u5b50\uff1a</p> <pre><code>let s1 = String::from(\"hello\");\nlet s2 = s1.clone();\n\nprintln!(\"s1 = {}, s2 = {}\", s1, s2);\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_6","title":"\u53ea\u5728\u6808\u4e0a\u7684\u6570\u636e\uff1a\u62f7\u8d1d","text":"<p><pre><code>fn main() {\n    let x = 5;\n    let y = x;\n\n    println!(\"x = {}, y = {}\", x, y);\n}\n</code></pre> \u8fd9\u6bb5\u4ee3\u7801\u6ca1\u6709\u8c03\u7528<code>clone</code>\uff0c\u4f46\u6570\u636e\u7684\u590d\u5236\u786e\u5b9e\u7684\u53d1\u751f\u4e86\uff0c\u8fd9\u662f\u56e0\u4e3a\u50cfi32\u8fd9\u6837\u7684\u57fa\u672c\u6570\u636e\u7c7b\u578b\u90fd\u662f\u5b58\u50a8\u5728\u6808\u4e0a\uff0c\u62f7\u8d1d\u5176\u5b9e\u9645\u7684\u503c\u662f\u5feb\u901f\u7684\u3002</p> <p>Rust \u6709\u4e00\u4e2a\u53eb\u505a\u00a0<code>Copy</code>\u00a0trait \u7684\u7279\u6b8a\u6ce8\u89e3\uff0c\u53ef\u4ee5\u7528\u5728\u7c7b\u4f3c\u6574\u578b\u8fd9\u6837\u7684\u5b58\u50a8\u5728\u6808\u4e0a\u7684\u7c7b\u578b\u4e0a(todo reference)\u3002\u5982\u679c\u4e00\u4e2a\u7c7b\u578b\u5b9e\u73b0\u4e86\u00a0<code>Copy</code>\u00a0trait\uff0c\u90a3\u4e48\u4e00\u4e2a\u65e7\u7684\u53d8\u91cf\u5728\u5c06\u5176\u8d4b\u503c\u7ed9\u5176\u4ed6\u53d8\u91cf\u540e\u4ecd\u7136\u53ef\u7528\u3002</p> <p>Rust \u4e0d\u5141\u8bb8\u81ea\u8eab\u6216\u5176\u4efb\u4f55\u90e8\u5206\u5b9e\u73b0\u4e86\u00a0<code>Drop</code>\u00a0trait \u7684\u7c7b\u578b\u4f7f\u7528\u00a0<code>Copy</code>\u00a0trait\u3002\u5982\u679c\u6211\u4eec\u5bf9\u5176\u503c\u79bb\u5f00\u4f5c\u7528\u57df\u65f6\u9700\u8981\u7279\u6b8a\u5904\u7406\u7684\u7c7b\u578b\u4f7f\u7528\u00a0<code>Copy</code>\u00a0\u6ce8\u89e3\uff0c\u5c06\u4f1a\u51fa\u73b0\u4e00\u4e2a\u7f16\u8bd1\u65f6\u9519\u8bef\u3002</p> <p>\u90a3\u4e48\u54ea\u4e9b\u7c7b\u578b\u5b9e\u73b0\u4e86\u00a0<code>Copy</code>\u00a0trait \u5462\uff1f\u4f60\u53ef\u4ee5\u67e5\u770b\u7ed9\u5b9a\u7c7b\u578b\u7684\u6587\u6863\u6765\u786e\u8ba4\uff0c\u4e0d\u8fc7\u4f5c\u4e3a\u4e00\u4e2a\u901a\u7528\u7684\u89c4\u5219\uff0c\u4efb\u4f55\u4e00\u7ec4\u7b80\u5355\u6807\u91cf\u503c\u7684\u7ec4\u5408\u90fd\u53ef\u4ee5\u5b9e\u73b0\u00a0<code>Copy</code>\uff0c\u4efb\u4f55\u4e0d\u9700\u8981\u5206\u914d\u5185\u5b58\u6216\u67d0\u79cd\u5f62\u5f0f\u8d44\u6e90\u7684\u7c7b\u578b\u90fd\u53ef\u4ee5\u5b9e\u73b0\u00a0<code>Copy</code>\u00a0\u3002\u5982\u4e0b\u662f\u4e00\u4e9b\u00a0<code>Copy</code>\u00a0\u7684\u7c7b\u578b\uff1a</p> <ul> <li>\u6240\u6709\u6574\u6570\u7c7b\u578b\uff0c\u6bd4\u5982\u00a0<code>u32</code>\u3002</li> <li>\u5e03\u5c14\u7c7b\u578b\uff0c<code>bool</code>\uff0c\u5b83\u7684\u503c\u662f\u00a0<code>true</code>\u00a0\u548c\u00a0<code>false</code>\u3002</li> <li>\u6240\u6709\u6d6e\u70b9\u6570\u7c7b\u578b\uff0c\u6bd4\u5982\u00a0<code>f64</code>\u3002</li> <li>\u5b57\u7b26\u7c7b\u578b\uff0c<code>char</code>\u3002</li> <li>\u5143\u7ec4\uff0c\u5f53\u4e14\u4ec5\u5f53\u5176\u5305\u542b\u7684\u7c7b\u578b\u4e5f\u90fd\u5b9e\u73b0\u00a0<code>Copy</code>\u00a0\u7684\u65f6\u5019\u3002\u6bd4\u5982\uff0c<code>(i32, i32)</code>\u00a0\u5b9e\u73b0\u4e86\u00a0<code>Copy</code>\uff0c\u4f46\u00a0<code>(i32, String)</code>\u00a0\u5c31\u6ca1\u6709\u3002</li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_7","title":"\u6240\u6709\u6743\u4e0e\u51fd\u6570","text":"<p>\u5411\u51fd\u6570\u4f20\u9012\u503c\u53ef\u80fd\u4f1a\u79fb\u52a8\u6216\u8005\u590d\u5236</p> <pre><code>fn main() {\n    let s = String::from(\"hello\");  // s \u8fdb\u5165\u4f5c\u7528\u57df\n\n    takes_ownership(s);             // s \u7684\u503c\u79fb\u52a8\u5230\u51fd\u6570\u91cc ...\n                                    // ... \u6240\u4ee5\u5230\u8fd9\u91cc\u4e0d\u518d\u6709\u6548\n\n    let x = 5;                      // x \u8fdb\u5165\u4f5c\u7528\u57df\n\n    makes_copy(x);                  // x \u5e94\u8be5\u79fb\u52a8\u51fd\u6570\u91cc\uff0c\n                                    // \u4f46 i32 \u662f Copy \u7684\uff0c\n                                    // \u6240\u4ee5\u5728\u540e\u9762\u53ef\u7ee7\u7eed\u4f7f\u7528 x\n\n} // \u8fd9\u91cc\uff0cx \u5148\u79fb\u51fa\u4e86\u4f5c\u7528\u57df\uff0c\u7136\u540e\u662f s\u3002\u4f46\u56e0\u4e3a s \u7684\u503c\u5df2\u88ab\u79fb\u8d70\uff0c\n  // \u6ca1\u6709\u7279\u6b8a\u4e4b\u5904\n\nfn takes_ownership(some_string: String) { // some_string \u8fdb\u5165\u4f5c\u7528\u57df\n    println!(\"{}\", some_string);\n} // \u8fd9\u91cc\uff0csome_string \u79fb\u51fa\u4f5c\u7528\u57df\u5e76\u8c03\u7528 `drop` \u65b9\u6cd5\u3002\n  // \u5360\u7528\u7684\u5185\u5b58\u88ab\u91ca\u653e\n\nfn makes_copy(some_integer: i32) { // some_integer \u8fdb\u5165\u4f5c\u7528\u57df\n    println!(\"{}\", some_integer);\n} // \u8fd9\u91cc\uff0csome_integer \u79fb\u51fa\u4f5c\u7528\u57df\u3002\u6ca1\u6709\u7279\u6b8a\u4e4b\u5904\n</code></pre> <p>\u5f53\u5728\u8c03\u7528\u51fd\u6570\u540e\u4f7f\u7528<code>s</code>\u65f6\uff0crust\u4f1a\u629b\u51fa\u4e00\u4e2a\u7f16\u8bd1\u65f6\u9519\u8bef\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_8","title":"\u8fd4\u56de\u503c\u4e0e\u4f5c\u7528\u57df","text":"<p>\u6240\u6709\u6743\u53ef\u4ee5\u901a\u8fc7\u8fd4\u56de\u503c\u8fdb\u884c\u8f6c\u79fb</p> <p>\u4e0b\u5217\u4ee3\u7801\u5c55\u793a\u4e86\u4e00\u4e2a\u793a\u4f8b</p> <pre><code>fn main() {\n    let s1 = gives_ownership();         // gives_ownership \u5c06\u8fd4\u56de\u503c\n                                        // \u8f6c\u79fb\u7ed9 s1\n\n    let s2 = String::from(\"hello\");     // s2 \u8fdb\u5165\u4f5c\u7528\u57df\n\n    let s3 = takes_and_gives_back(s2);  // s2 \u88ab\u79fb\u52a8\u5230\n                                        // takes_and_gives_back \u4e2d\uff0c\n                                        // \u5b83\u4e5f\u5c06\u8fd4\u56de\u503c\u79fb\u7ed9 s3\n} // \u8fd9\u91cc\uff0cs3 \u79fb\u51fa\u4f5c\u7528\u57df\u5e76\u88ab\u4e22\u5f03\u3002s2 \u4e5f\u79fb\u51fa\u4f5c\u7528\u57df\uff0c\u4f46\u5df2\u88ab\u79fb\u8d70\uff0c\n  // \u6240\u4ee5\u4ec0\u4e48\u4e5f\u4e0d\u4f1a\u53d1\u751f\u3002s1 \u79bb\u5f00\u4f5c\u7528\u57df\u5e76\u88ab\u4e22\u5f03\n\nfn gives_ownership() -&gt; String {             // gives_ownership \u4f1a\u5c06\n                                             // \u8fd4\u56de\u503c\u79fb\u52a8\u7ed9\n                                             // \u8c03\u7528\u5b83\u7684\u51fd\u6570\n\n    let some_string = String::from(\"yours\"); // some_string \u8fdb\u5165\u4f5c\u7528\u57df\u3002\n\n    some_string                              // \u8fd4\u56de some_string \n                                             // \u5e76\u79fb\u51fa\u7ed9\u8c03\u7528\u7684\u51fd\u6570\n                                             // \n}\n\n// takes_and_gives_back \u5c06\u4f20\u5165\u5b57\u7b26\u4e32\u5e76\u8fd4\u56de\u8be5\u503c\nfn takes_and_gives_back(a_string: String) -&gt; String { // a_string \u8fdb\u5165\u4f5c\u7528\u57df\n                                                      // \n\n    a_string  // \u8fd4\u56de a_string \u5e76\u79fb\u51fa\u7ed9\u8c03\u7528\u7684\u51fd\u6570\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u51fa\u5f53\u6211\u4eec\u76f4\u63a5\u628a\u4e00\u4e2a\u53d8\u91cf\u4f20\u5165\u51fd\u6570\u65f6\uff0c\u5fc5\u987b\u8981\u6709\u53d8\u91cf\u63a5\u53d7\u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u5426\u5219\u5176\u503c\u5c06\u88abdrop\u6389</p> <p>\u53d8\u91cf\u7684\u6240\u6709\u6743\u603b\u662f\u9075\u5faa\u76f8\u540c\u7684\u6a21\u5f0f\uff1a\u5c06\u503c\u8d4b\u7ed9\u53e6\u4e00\u4e2a\u53d8\u91cf\u65f6\u79fb\u52a8\u5b83\u3002\u5f53\u6301\u6709\u5806\u4e2d\u6570\u636e\u503c\u7684\u53d8\u91cf\u79bb\u5f00\u4f5c\u7528\u57df\u65f6\uff0c\u5176\u503c\u5c06\u901a\u8fc7 <code>drop</code> \u88ab\u6e05\u7406\u6389\uff0c\u9664\u975e\u6570\u636e\u88ab\u79fb\u52a8\u4e3a\u53e6\u4e00\u4e2a\u53d8\u91cf\u6240\u6709\u3002</p> <p>\u867d\u7136\u8fd9\u6837\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u5728\u6bcf\u4e00\u4e2a\u51fd\u6570\u4e2d\u90fd\u83b7\u53d6\u6240\u6709\u6743\u5e76\u63a5\u7740\u8fd4\u56de\u6240\u6709\u6743\u6709\u4e9b\u5570\u55e6\u3002\u5982\u679c\u6211\u4eec\u60f3\u8981\u51fd\u6570\u4f7f\u7528\u4e00\u4e2a\u503c\u4f46\u4e0d\u83b7\u53d6\u6240\u6709\u6743\u8be5\u600e\u4e48\u529e\u5462\uff1f\u5982\u679c\u6211\u4eec\u8fd8\u8981\u63a5\u7740\u4f7f\u7528\u5b83\u7684\u8bdd\uff0c\u6bcf\u6b21\u90fd\u4f20\u8fdb\u53bb\u518d\u8fd4\u56de\u6765\u5c31\u6709\u70b9\u70e6\u4eba\u4e86\uff0c\u9664\u6b64\u4e4b\u5916\uff0c\u6211\u4eec\u4e5f\u53ef\u80fd\u60f3\u8fd4\u56de\u51fd\u6570\u4f53\u4e2d\u4ea7\u751f\u7684\u4e00\u4e9b\u6570\u636e\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5143\u7ec4\u6765\u8fd4\u56de\u591a\u4e2a\u503c</p> <pre><code>fn main() {\n    let s1 = String::from(\"hello\");\n\n    let (s2, len) = calculate_length(s1);\n\n    println!(\"The length of '{}' is {}.\", s2, len);\n}\n\nfn calculate_length(s: String) -&gt; (String, usize) {\n    let length = s.len(); // len() \u8fd4\u56de\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\n\n    (s, length)\n}\n</code></pre> <p>\u4f46\u662f\u51fd\u6570\u4e34\u65f6\u4f7f\u7528\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u662f\u4e00\u4e2a\u975e\u5e38\u5e38\u89c1\u7684\u60c5\u51b5\uff0c\u8fd9\u6837\u505a\u672a\u514d\u663e\u5f97\u5f88\u9ebb\u70e6\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_9","title":"\u5f15\u7528\u4e0e\u501f\u7528","text":"<p>\u4e0a\u9762\u7684\u4ee3\u7801\u6709\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a</p> <p>\u6211\u4eec\u5fc5\u987b\u5c06 <code>String</code> \u8fd4\u56de\u7ed9\u8c03\u7528\u51fd\u6570\uff0c\u4ee5\u4fbf\u5728\u8c03\u7528 <code>calculate_length</code> \u540e\u4ecd\u80fd\u4f7f\u7528 <code>String</code>\uff0c\u56e0\u4e3a <code>String</code> \u88ab\u79fb\u52a8\u5230\u4e86 <code>calculate_length</code> \u5185\u3002</p> <p>Rust \u5bf9\u6b64\u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e0d\u7528\u83b7\u53d6\u6240\u6709\u6743\u5c31\u53ef\u4ee5\u4f7f\u7528\u503c\u7684\u529f\u80fd\uff0c\u53eb\u505a \u5f15\u7528\uff08references\uff09\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_10","title":"\u5f15\u7528","text":"<p>\u6211\u4eec\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a <code>String</code> \u503c\u7684\u5f15\u7528\uff08reference\uff09\u3002\u5f15\u7528\uff08reference\uff09\u50cf\u4e00\u4e2a\u6307\u9488\uff0c\u56e0\u4e3a\u5b83\u662f\u4e00\u4e2a\u5730\u5740\uff0c\u6211\u4eec\u53ef\u4ee5\u7531\u6b64\u8bbf\u95ee\u50a8\u5b58\u4e8e\u8be5\u5730\u5740\u7684\u5c5e\u4e8e\u5176\u4ed6\u53d8\u91cf\u7684\u6570\u636e\u3002 \u4e0e\u6307\u9488\u4e0d\u540c\uff0c\u5f15\u7528\u786e\u4fdd\u6307\u5411\u67d0\u4e2a\u7279\u5b9a\u7c7b\u578b\u7684\u6709\u6548\u503c\u3002</p> <pre><code>fn main() {\n    let s1 = String::from(\"hello\");\n\n    let len = calculate_length(&amp;s1);\n\n    println!(\"The length of '{}' is {}.\", s1, len);\n}\n\nfn calculate_lbiength(s: &amp;String) -&gt; usize {\n    s.len()\n} // \u8fd9\u91cc\uff0cs \u79bb\u5f00\u4e86\u4f5c\u7528\u57df\u3002\u4f46\u56e0\u4e3a\u5b83\u5e76\u4e0d\u62e5\u6709\u5f15\u7528\u503c\u7684\u6240\u6709\u6743\uff0c\n  // \u6240\u4ee5\u4ec0\u4e48\u4e5f\u4e0d\u4f1a\u53d1\u751f\n</code></pre> <p>\u8fd9\u4e9b &amp; \u7b26\u53f7\u5c31\u662f \u5f15\u7528\uff0c\u5b83\u4eec\u5141\u8bb8\u4f60\u4f7f\u7528\u503c\u4f46\u4e0d\u83b7\u53d6\u5176\u6240\u6709\u6743\u3002</p> <p></p> <p>\u6ce8\u610f\uff1a\u4e0e\u4f7f\u7528 <code>&amp;</code> \u5f15\u7528\u76f8\u53cd\u7684\u64cd\u4f5c\u662f \u89e3\u5f15\u7528\uff08dereferencing\uff09\uff0c\u5b83\u4f7f\u7528\u89e3\u5f15\u7528\u8fd0\u7b97\u7b26\uff0c<code>*</code></p> <p>\u53d8\u91cf <code>s</code> \u6709\u6548\u7684\u4f5c\u7528\u57df\u4e0e\u51fd\u6570\u53c2\u6570\u7684\u4f5c\u7528\u57df\u4e00\u6837\uff0c\u4e0d\u8fc7\u5f53 <code>s</code> \u505c\u6b62\u4f7f\u7528\u65f6\u5e76\u4e0d\u4e22\u5f03\u5f15\u7528\u6307\u5411\u7684\u6570\u636e\uff0c\u56e0\u4e3a <code>s</code> \u5e76\u6ca1\u6709\u6240\u6709\u6743\u3002\u5f53\u51fd\u6570\u4f7f\u7528\u5f15\u7528\u800c\u4e0d\u662f\u5b9e\u9645\u503c\u4f5c\u4e3a\u53c2\u6570\uff0c\u65e0\u9700\u8fd4\u56de\u503c\u6765\u4ea4\u8fd8\u6240\u6709\u6743\uff0c\u56e0\u4e3a\u5c31\u4e0d\u66fe\u62e5\u6709\u6240\u6709\u6743\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a\u5f15\u7528\u7684\u884c\u4e3a\u79f0\u4e3a \u501f\u7528\uff08borrowing\uff09\u3002\u5f53\u4f60\u4f7f\u7528\u5b8c\u6bd5\uff0c\u5fc5\u987b\u8fd8\u56de\u53bb\u3002\u6211\u4eec\u5e76\u4e0d\u62e5\u6709\u5b83\u3002</p> <pre><code>fn main() {\n    let s = String::from(\"hello\");\n\n    change(&amp;s);\n}\n\nfn change(some_string: &amp;String) {\n    some_string.push_str(\", world\");\n}\n</code></pre> <pre><code>$ cargo run\n   Compiling ownership v0.1.0 (file:///projects/ownership)\nerror[E0596]: cannot borrow `*some_string` as mutable, as it is behind a `&amp;` reference\n --&gt; src/main.rs:8:5\n  |\n7 | fn change(some_string: &amp;String) {\n  |                        ------- help: consider changing this to be a mutable reference: `&amp;mut String`\n8 |     some_string.push_str(\", world\");\n  |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `some_string` is a `&amp;` reference, so the data it refers to cannot be borrowed as mutable\n\nFor more information about this error, try `rustc --explain E0596`.\nerror: could not compile `ownership` due to previous error\n</code></pre> <p>\u6b63\u5982\u53d8\u91cf\u9ed8\u8ba4\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u5f15\u7528\u4e5f\u4e00\u6837\u3002\uff08\u9ed8\u8ba4\uff09\u4e0d\u5141\u8bb8\u4fee\u6539\u5f15\u7528\u7684\u503c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_11","title":"\u53ef\u53d8\u5f15\u7528","text":"<p>\u53ef\u53d8\u5f15\u7528\uff08mutable reference\uff09\uff1a</p> <pre><code>fn main() {\n    let mut s = String::from(\"hello\");\n\n    change(&amp;mut s);\n}\n\nfn change(some_string: &amp;mut String) {\n    some_string.push_str(\", world\");\n}\n</code></pre> <p>\u9996\u5148\uff0c\u6211\u4eec\u5fc5\u987b\u5c06 <code>s</code> \u6539\u4e3a <code>mut</code>\u3002\u7136\u540e\u5728\u8c03\u7528 <code>change</code> \u51fd\u6570\u7684\u5730\u65b9\u521b\u5efa\u4e00\u4e2a\u53ef\u53d8\u5f15\u7528 <code>&amp;mut s</code>\uff0c\u5e76\u66f4\u65b0\u51fd\u6570\u7b7e\u540d\u4ee5\u63a5\u53d7\u4e00\u4e2a\u53ef\u53d8\u5f15\u7528 <code>some_string: &amp;mut String</code>\u3002\u8fd9\u5c31\u975e\u5e38\u6e05\u695a\u5730\u8868\u660e\uff0c<code>change</code> \u51fd\u6570\u5c06\u6539\u53d8\u5b83\u6240\u501f\u7528\u7684\u503c\u3002</p> <p>\u53ef\u53d8\u5f15\u7528\u6709\u4e00\u4e2a\u5f88\u5927\u7684\u9650\u5236\uff1a\u5982\u679c\u4f60\u6709\u4e00\u4e2a\u5bf9\u8be5\u53d8\u91cf\u7684\u53ef\u53d8\u5f15\u7528\uff0c\u4f60\u5c31\u4e0d\u80fd\u518d\u521b\u5efa\u5bf9\u8be5\u53d8\u91cf\u7684\u5f15\u7528\u3002\u8fd9\u4e9b\u5c1d\u8bd5\u521b\u5efa\u4e24\u4e2a <code>s</code> \u7684\u53ef\u53d8\u5f15\u7528\u7684\u4ee3\u7801\u4f1a\u5931\u8d25\uff1a</p> <pre><code>fn main() {\n    let mut s = String::from(\"hello\");\n\n    let r1 = &amp;mut s;\n    let r2 = &amp;mut s;\n\n    println!(\"{}, {}\", r1, r2);\n}\n</code></pre> <p>\u4e00\u5982\u65e2\u5f80\uff0c\u53ef\u4ee5\u4f7f\u7528\u5927\u62ec\u53f7\u6765\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4f5c\u7528\u57df\uff0c\u4ee5\u5141\u8bb8\u62e5\u6709\u591a\u4e2a\u53ef\u53d8\u5f15\u7528\uff0c\u53ea\u662f\u4e0d\u80fd \u540c\u65f6 \u62e5\u6709\uff1a</p> <pre><code>fn main() {\n    let mut s = String::from(\"hello\");\n\n    {\n        let r1 = &amp;mut s;\n    } // r1 \u5728\u8fd9\u91cc\u79bb\u5f00\u4e86\u4f5c\u7528\u57df\uff0c\u6240\u4ee5\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5f15\u7528\n\n    let r2 = &amp;mut s;\n}\n</code></pre> <p>Rust \u5728\u540c\u65f6\u4f7f\u7528\u53ef\u53d8\u4e0e\u4e0d\u53ef\u53d8\u5f15\u7528\u65f6\u4e5f\u91c7\u7528\u7684\u7c7b\u4f3c\u7684\u89c4\u5219\u3002\u8fd9\u4e9b\u4ee3\u7801\u4f1a\u5bfc\u81f4\u4e00\u4e2a\u9519\u8bef\uff1a</p> <pre><code>fn main() {\n    let mut s = String::from(\"hello\");\n\n    let r1 = &amp;s; // \u6ca1\u95ee\u9898\n    let r2 = &amp;s; // \u6ca1\u95ee\u9898\n    let r3 = &amp;mut s; // \u5927\u95ee\u9898\n\n    println!(\"{}, {}, and {}\", r1, r2, r3);\n}\n</code></pre> <p>\u6211\u4eec \u4e5f \u4e0d\u80fd\u5728\u62e5\u6709\u4e0d\u53ef\u53d8\u5f15\u7528\u7684\u540c\u65f6\u62e5\u6709\u53ef\u53d8\u5f15\u7528\u3002</p> <pre><code>fn main() {\n    let mut s = String::from(\"hello\");\n\n    let r1 = &amp;s; // \u6ca1\u95ee\u9898\n    let r2 = &amp;s; // \u6ca1\u95ee\u9898\n    println!(\"{} and {}\", r1, r2);\n    // \u6b64\u4f4d\u7f6e\u4e4b\u540e r1 \u548c r2 \u4e0d\u518d\u4f7f\u7528\n\n    let r3 = &amp;mut s; // \u6ca1\u95ee\u9898\n    println!(\"{}\", r3);\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_12","title":"\u5782\u60ac\u5f15\u7528","text":"<p>\u9519\u8bef\uff1a <pre><code>fn main() {\n    let reference_to_nothing = dangle();\n}\n\nfn dangle() -&gt; &amp;String { // dangle \u8fd4\u56de\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u5f15\u7528\n\n    let s = String::from(\"hello\"); // s \u662f\u4e00\u4e2a\u65b0\u5b57\u7b26\u4e32\n\n    &amp;s // \u8fd4\u56de\u5b57\u7b26\u4e32 s \u7684\u5f15\u7528\n} // \u8fd9\u91cc s \u79bb\u5f00\u4f5c\u7528\u57df\u5e76\u88ab\u4e22\u5f03\u3002\u5176\u5185\u5b58\u88ab\u91ca\u653e\u3002\n  // \u5371\u9669\uff01\n</code></pre></p> <p>\u6b63\u786e\uff1a <pre><code>fn main() {\n    let string = no_dangle();\n}\n\nfn no_dangle() -&gt; String {\n    let s = String::from(\"hello\");\n\n    s\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#_13","title":"\u5f15\u7528\u7684\u89c4\u5219","text":"<p>\u8ba9\u6211\u4eec\u6982\u62ec\u4e00\u4e0b\u4e4b\u524d\u5bf9\u5f15\u7528\u7684\u8ba8\u8bba\uff1a</p> <ul> <li>\u5728\u4efb\u610f\u7ed9\u5b9a\u65f6\u95f4\uff0c\u8981\u4e48 \u53ea\u80fd\u6709\u4e00\u4e2a\u53ef\u53d8\u5f15\u7528\uff0c\u8981\u4e48 \u53ea\u80fd\u6709\u591a\u4e2a\u4e0d\u53ef\u53d8\u5f15\u7528\u3002</li> <li>\u5f15\u7528\u5fc5\u987b\u603b\u662f\u6709\u6548\u7684\u3002</li> </ul>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#slice","title":"slice","text":"<p>slice \u5141\u8bb8\u4f60\u5f15\u7528\u96c6\u5408\u4e2d\u4e00\u6bb5\u8fde\u7eed\u7684\u5143\u7d20\u5e8f\u5217\uff0c\u800c\u4e0d\u7528\u5f15\u7528\u6574\u4e2a\u96c6\u5408\u3002slice \u662f\u4e00\u7c7b\u5f15\u7528\uff0c\u6240\u4ee5\u5b83\u6ca1\u6709\u6240\u6709\u6743\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#slice_1","title":"\u5b57\u7b26\u4e32slice","text":"<p>\u5b57\u7b26\u4e32 slice\uff08string slice\uff09\u662f <code>String</code> \u4e2d\u4e00\u90e8\u5206\u503c\u7684\u5f15\u7528\uff0c\u5b83\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a</p> <pre><code>    let s = String::from(\"hello world\");\n\n    let hello = &amp;s[0..5];\n    let world = &amp;s[6..11];\n</code></pre> <p>\u4e0d\u540c\u4e8e\u6574\u4e2a <code>String</code> \u7684\u5f15\u7528\uff0c<code>hello</code> \u662f\u4e00\u4e2a\u90e8\u5206 <code>String</code> \u7684\u5f15\u7528\uff0c\u7531\u4e00\u4e2a\u989d\u5916\u7684 <code>[0..5]</code> \u90e8\u5206\u6307\u5b9a\u3002\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u7531\u4e2d\u62ec\u53f7\u4e2d\u7684 <code>[starting_index..ending_index]</code> \u6307\u5b9a\u7684 range \u521b\u5efa\u4e00\u4e2a slice\uff0c\u5176\u4e2d <code>starting_index</code> \u662f slice \u7684\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\uff0c<code>ending_index</code> \u5219\u662f slice \u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\u7684\u540e\u4e00\u4e2a\u503c\u3002\u5728\u5176\u5185\u90e8\uff0cslice \u7684\u6570\u636e\u7ed3\u6784\u5b58\u50a8\u4e86 slice \u7684\u5f00\u59cb\u4f4d\u7f6e\u548c\u957f\u5ea6\uff0c\u957f\u5ea6\u5bf9\u5e94\u4e8e <code>ending_index</code> \u51cf\u53bb <code>starting_index</code> \u7684\u503c\u3002\u6240\u4ee5\u5bf9\u4e8e <code>let world = &amp;s[6..11];</code> \u7684\u60c5\u51b5\uff0c<code>world</code> \u5c06\u662f\u4e00\u4e2a\u5305\u542b\u6307\u5411 <code>s</code> \u7d22\u5f15 6 \u7684\u6307\u9488\u548c\u957f\u5ea6\u503c 5 \u7684 slice\u3002</p> <p> \u5bf9\u4e8e Rust \u7684 <code>..</code> range \u8bed\u6cd5\uff0c\u5982\u679c\u60f3\u8981\u4ece\u7d22\u5f15 0 \u5f00\u59cb\uff0c\u53ef\u4ee5\u4e0d\u5199\u4e24\u4e2a\u70b9\u53f7\u4e4b\u524d\u7684\u503c\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5982\u4e0b\u4e24\u4e2a\u8bed\u53e5\u662f\u76f8\u540c\u7684\uff1a</p> <pre><code>let s = String::from(\"hello\");\n\nlet slice = &amp;s[0..2];\nlet slice = &amp;s[..2];\n</code></pre> <p>\u4f9d\u6b64\u7c7b\u63a8\uff0c\u5982\u679c slice \u5305\u542b <code>String</code> \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff0c\u4e5f\u53ef\u4ee5\u820d\u5f03\u5c3e\u90e8\u7684\u6570\u5b57\u3002\u8fd9\u610f\u5473\u7740\u5982\u4e0b\u4e5f\u662f\u76f8\u540c\u7684\uff1a</p> <pre><code>let s = String::from(\"hello\");\n\nlet len = s.len();\n\nlet slice = &amp;s[3..len];\nlet slice = &amp;s[3..];\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u540c\u65f6\u820d\u5f03\u8fd9\u4e24\u4e2a\u503c\u6765\u83b7\u53d6\u6574\u4e2a\u5b57\u7b26\u4e32\u7684 slice\u3002\u6240\u4ee5\u5982\u4e0b\u4ea6\u662f\u76f8\u540c\u7684\uff1a</p> <pre><code>let s = String::from(\"hello\");\n\nlet len = s.len();\n\nlet slice = &amp;s[0..len];\nlet slice = &amp;s[..];\n</code></pre> <p>\u6ce8\u610f\uff1a\u5b57\u7b26\u4e32 slice range \u7684\u7d22\u5f15\u5fc5\u987b\u4f4d\u4e8e\u6709\u6548\u7684 UTF-8 \u5b57\u7b26\u8fb9\u754c\u5185\uff0c\u5982\u679c\u5c1d\u8bd5\u4ece\u4e00\u4e2a\u591a\u5b57\u8282\u5b57\u7b26\u7684\u4e2d\u95f4\u4f4d\u7f6e\u521b\u5efa\u5b57\u7b26\u4e32 slice\uff0c\u5219\u7a0b\u5e8f\u5c06\u4f1a\u56e0\u9519\u8bef\u800c\u9000\u51fa\u3002\u51fa\u4e8e\u4ecb\u7ecd\u5b57\u7b26\u4e32 slice \u7684\u76ee\u7684\uff0c\u672c\u90e8\u5206\u5047\u8bbe\u53ea\u4f7f\u7528 ASCII \u5b57\u7b26\u96c6\uff1b\u7b2c\u516b\u7ae0\u7684 \u201c\u4f7f\u7528\u5b57\u7b26\u4e32\u5b58\u50a8 UTF-8 \u7f16\u7801\u7684\u6587\u672c\u201d \u90e8\u5206\u4f1a\u66f4\u52a0\u5168\u9762\u7684\u8ba8\u8bba UTF-8 \u5904\u7406\u95ee\u9898\u3002</p> <pre><code>fn first_word(s: &amp;String) -&gt; &amp;str {\n    let bytes = s.as_bytes();\n\n    for (i, &amp;item) in bytes.iter().enumerate() {\n        if item == b' ' {\n            return &amp;s[0..i];\n        }\n    }\n\n    &amp;s[..]\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#slice_2","title":"\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u5c31\u662fslice","text":"<pre><code>let s = \"Hello, world!\";\n</code></pre> <p>\u8fd9\u91cc <code>s</code> \u7684\u7c7b\u578b\u662f <code>&amp;str</code>\uff1a\u5b83\u662f\u4e00\u4e2a\u6307\u5411\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7279\u5b9a\u4f4d\u7f6e\u7684 slice\u3002\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u662f\u4e0d\u53ef\u53d8\u7684\uff1b<code>&amp;str</code> \u662f\u4e00\u4e2a\u4e0d\u53ef\u53d8\u5f15\u7528\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#slice_3","title":"\u5b57\u7b26\u4e32slice\u4f5c\u4e3a\u53c2\u6570","text":"<p>\u5728\u77e5\u9053\u4e86\u80fd\u591f\u83b7\u53d6\u5b57\u9762\u503c\u548c <code>String</code> \u7684 slice \u540e\uff0c\u6211\u4eec\u5bf9 <code>first_word</code> \u505a\u4e86\u6539\u8fdb\uff0c\u8fd9\u662f\u5b83\u7684\u7b7e\u540d\uff1a</p> <pre><code>fn first_word(s: &amp;String) -&gt; &amp;str {\n</code></pre> <p>\u800c\u66f4\u6709\u7ecf\u9a8c\u7684 Rustacean \u4f1a\u7f16\u5199\u51fa\u793a\u4f8b 4-9 \u4e2d\u7684\u7b7e\u540d\uff0c\u56e0\u4e3a\u5b83\u4f7f\u5f97\u53ef\u4ee5\u5bf9 <code>&amp;String</code> \u503c\u548c <code>&amp;str</code> \u503c\u4f7f\u7528\u76f8\u540c\u7684\u51fd\u6570\uff1a</p> <pre><code>fn first_word(s: &amp;str) -&gt; &amp;str {\n</code></pre> <p>\u5b9a\u4e49\u4e00\u4e2a\u83b7\u53d6\u5b57\u7b26\u4e32 slice \u800c\u4e0d\u662f <code>String</code> \u5f15\u7528\u7684\u51fd\u6570\u4f7f\u5f97\u6211\u4eec\u7684 API \u66f4\u52a0\u901a\u7528\u5e76\u4e14\u4e0d\u4f1a\u4e22\u5931\u4efb\u4f55\u529f\u80fd</p> <pre><code>fn first_word(s: &amp;str) -&gt; &amp;str {\n    let bytes = s.as_bytes();\n\n    for (i, &amp;item) in bytes.iter().enumerate() {\n        if item == b' ' {\n            return &amp;s[0..i];\n        }\n    }\n\n    &amp;s[..]\n}\n\nfn main() {\n    let my_string = String::from(\"hello world\");\n\n    // `first_word` \u9002\u7528\u4e8e `String`\uff08\u7684 slice\uff09\uff0c\u90e8\u5206\u6216\u5168\u90e8\n    let word = first_word(&amp;my_string[0..6]);\n    let word = first_word(&amp;my_string[..]);\n    // `first_word` \u4e5f\u9002\u7528\u4e8e `String` \u7684\u5f15\u7528\uff0c\n    // \u8fd9\u7b49\u4ef7\u4e8e\u6574\u4e2a `String` \u7684 slice\n    let word = first_word(&amp;my_string);\n\n    let my_string_literal = \"hello world\";\n\n    // `first_word` \u9002\u7528\u4e8e\u5b57\u7b26\u4e32\u5b57\u9762\u503c\uff0c\u90e8\u5206\u6216\u5168\u90e8\n    let word = first_word(&amp;my_string_literal[0..6]);\n    let word = first_word(&amp;my_string_literal[..]);\n\n    // \u56e0\u4e3a\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u5df2\u7ecf **\u662f** \u5b57\u7b26\u4e32 slice \u4e86\uff0c\n    // \u8fd9\u4e5f\u662f\u9002\u7528\u7684\uff0c\u65e0\u9700 slice \u8bed\u6cd5\uff01\n    let word = first_word(my_string_literal);\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/2.%E6%89%80%E6%9C%89%E6%9D%83/#slice_4","title":"\u5176\u4ed6\u7c7b\u578b\u7684slice","text":"<pre><code>let a = [1, 2, 3, 4, 5];\n</code></pre> <p>\u5c31\u8ddf\u6211\u4eec\u60f3\u8981\u83b7\u53d6\u5b57\u7b26\u4e32\u7684\u4e00\u90e8\u5206\u90a3\u6837\uff0c\u6211\u4eec\u4e5f\u4f1a\u60f3\u8981\u5f15\u7528\u6570\u7ec4\u7684\u4e00\u90e8\u5206\u3002\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u505a\uff1a</p> <pre><code>let a = [1, 2, 3, 4, 5];\n\nlet slice = &amp;a[1..3];\n\nassert_eq!(slice, &amp;[2, 3]);\n</code></pre> <p>\u8fd9\u4e2a slice \u7684\u7c7b\u578b\u662f <code>&amp;[i32]</code>\u3002\u5b83\u8ddf\u5b57\u7b26\u4e32 slice \u7684\u5de5\u4f5c\u65b9\u5f0f\u4e00\u6837\uff0c\u901a\u8fc7\u5b58\u50a8\u7b2c\u4e00\u4e2a\u96c6\u5408\u5143\u7d20\u7684\u5f15\u7528\u548c\u4e00\u4e2a\u96c6\u5408\u603b\u957f\u5ea6\u3002\u4f60\u53ef\u4ee5\u5bf9\u5176\u4ed6\u6240\u6709\u96c6\u5408\u4f7f\u7528\u8fd9\u7c7b slice\u3002</p> <p>\u6240\u6709\u6743\u3001\u501f\u7528\u548c slice \u8fd9\u4e9b\u6982\u5ff5\u8ba9 Rust \u7a0b\u5e8f\u5728\u7f16\u8bd1\u65f6\u786e\u4fdd\u5185\u5b58\u5b89\u5168\u3002Rust \u8bed\u8a00\u63d0\u4f9b\u4e86\u8ddf\u5176\u4ed6\u7cfb\u7edf\u7f16\u7a0b\u8bed\u8a00\u76f8\u540c\u7684\u65b9\u5f0f\u6765\u63a7\u5236\u4f60\u4f7f\u7528\u7684\u5185\u5b58\uff0c\u4f46\u62e5\u6709\u6570\u636e\u6240\u6709\u8005\u5728\u79bb\u5f00\u4f5c\u7528\u57df\u540e\u81ea\u52a8\u6e05\u9664\u5176\u6570\u636e\u7684\u529f\u80fd\u610f\u5473\u7740\u4f60\u65e0\u987b\u989d\u5916\u7f16\u5199\u548c\u8c03\u8bd5\u76f8\u5173\u7684\u63a7\u5236\u4ee3\u7801\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/","title":"\u7ed3\u6784\u4f53","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_2","title":"\u7ed3\u6784\u4f53\u7684\u5b9a\u4e49\u4e0e\u5b9e\u4f8b\u5316","text":"<pre><code>struct User {\n    active: bool, // \u7528\u9017\u53f7\u5206\u9694\n    username: String,\n    email: String,\n    sign_in_count: u64,\n}\n</code></pre> <p>\u4e00\u65e6\u5b9a\u4e49\u4e86\u7ed3\u6784\u4f53\u540e\uff0c\u4e3a\u4e86\u4f7f\u7528\u5b83\uff0c\u901a\u8fc7\u4e3a\u6bcf\u4e2a\u5b57\u6bb5\u6307\u5b9a\u5177\u4f53\u503c\u6765\u521b\u5efa\u8fd9\u4e2a\u7ed3\u6784\u4f53\u7684 \u5b9e\u4f8b\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\u9700\u8981\u4ee5\u7ed3\u6784\u4f53\u7684\u540d\u5b57\u5f00\u5934\uff0c\u63a5\u7740\u5728\u5927\u62ec\u53f7\u4e2d\u4f7f\u7528 <code>key: value</code> \u952e - \u503c\u5bf9\u7684\u5f62\u5f0f\u63d0\u4f9b\u5b57\u6bb5\uff0c\u5176\u4e2d key \u662f\u5b57\u6bb5\u7684\u540d\u5b57\uff0cvalue \u662f\u9700\u8981\u5b58\u50a8\u5728\u5b57\u6bb5\u4e2d\u7684\u6570\u636e\u503c\u3002\u5b9e\u4f8b\u4e2d\u5b57\u6bb5\u7684\u987a\u5e8f\u4e0d\u9700\u8981\u548c\u5b83\u4eec\u5728\u7ed3\u6784\u4f53\u4e2d\u58f0\u660e\u7684\u987a\u5e8f\u4e00\u81f4\u3002</p> <p>\u7ed3\u6784\u4f53\u7684\u521b\u5efa</p> <pre><code>struct User {\n    active: bool,\n    username: String,\n    email: String,\n    sign_in_count: u64,\n} // \u65e0\u9700\u52a0\u5206\u53f7\n\nfn main() {\n    let user1 = User {\n        active: true,\n        username: String::from(\"someusername123\"),\n        email: String::from(\"someone@example.com\"),\n        sign_in_count: 1,\n    }; // \u7ed3\u5c3e\u8bb0\u5f97\u52a0\u5206\u53f7\n}\n</code></pre> <p>\u5982\u679c\u7ed3\u6784\u4f53\u662f\u53ef\u53d8\u7684\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u70b9\u53f7\u4e3a\u5bf9\u5e94\u7684\u5b57\u6bb5\u8d4b\u503c\u3002 <pre><code>fn main() {\n    let mut user1 = User {\n        active: true,\n        username: String::from(\"someusername123\"),\n        email: String::from(\"someone@example.com\"),\n        sign_in_count: 1,\n    };\n\n    user1.email = String::from(\"anotheremail@example.com\");\n}\n</code></pre></p> <p>\u6ce8\u610f\u6574\u4e2a\u5b9e\u4f8b\u5fc5\u987b\u662f\u53ef\u53d8\u7684\uff1bRust \u5e76\u4e0d\u5141\u8bb8\u53ea\u5c06\u67d0\u4e2a\u5b57\u6bb5\u6807\u8bb0\u4e3a\u53ef\u53d8\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_3","title":"\u4f7f\u7528\u5b57\u6bb5\u521d\u59cb\u5316\u7b80\u5199\u8bed\u6cd5","text":"<p>\u7b80\u5316\u524d\uff1a <pre><code>fn build_user(email: String, username: String) -&gt; User {\n    User {\n        active: true,\n        username: username,\n        email: email,\n        sign_in_count: 1,\n    }\n}\n</code></pre></p> <p>\u7b80\u5316\u540e\uff1a <pre><code>fn build_user(email: String, username: String) -&gt; User {\n    User {\n        active: true,\n        username,\n        email,\n        sign_in_count: 1,\n    }\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_4","title":"\u4f7f\u7528\u7ed3\u6784\u4f53\u66f4\u65b0\u8bed\u6cd5\u4ece\u5176\u4ed6\u5b9e\u4f8b\u521b\u5efa\u5b9e\u4f8b","text":"<p>\u975e\u7b80\u5316\u7684\u5199\u6cd5\uff1a <pre><code>fn main() {\n    // --snip--\n\n    let user2 = User {\n        active: user1.active,\n        username: user1.username,\n        email: String::from(\"another@example.com\"),\n        sign_in_count: user1.sign_in_count,\n    };\n}\n</code></pre></p> <p>\u7ed3\u6784\u4f53\u66f4\u65b0\u8bed\u6cd5\uff1a <pre><code>fn main() {\n    // --snip--\n\n    let user2 = User {\n        email: String::from(\"another@example.com\"),\n        ..user1\n    };\n}\n</code></pre></p> <p><code>..</code> \u8bed\u6cd5\u6307\u5b9a\u4e86\u5269\u4f59\u672a\u663e\u5f0f\u8bbe\u7f6e\u503c\u7684\u5b57\u6bb5\u5e94\u6709\u4e0e\u7ed9\u5b9a\u5b9e\u4f8b\u5bf9\u5e94\u5b57\u6bb5\u76f8\u540c\u7684\u503c\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0c\u7ed3\u6784\u66f4\u65b0\u8bed\u6cd5\u5c31\u50cf\u5e26\u6709 = \u7684\u8d4b\u503c\uff0c\u56e0\u4e3a\u5b83\u79fb\u52a8\u4e86\u6570\u636e\uff0c\u5c31\u50cf\u6211\u4eec\u5728\u201c\u53d8\u91cf\u4e0e\u6570\u636e\u4ea4\u4e92\u7684\u65b9\u5f0f\uff08\u4e00\uff09\uff1a\u79fb\u52a8\u201d\u90e8\u5206\u8bb2\u5230\u7684\u4e00\u6837\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u603b\u4f53\u4e0a\u8bf4\u6211\u4eec\u5728\u521b\u5efa <code>user2</code> \u540e\u4e0d\u80fd\u5c31\u518d\u4f7f\u7528 <code>user1</code> \u4e86\uff0c\u56e0\u4e3a <code>user1</code> \u7684 <code>username</code> \u5b57\u6bb5\u4e2d\u7684 <code>String</code> \u88ab\u79fb\u5230 <code>user2</code> \u4e2d\u3002\u5982\u679c\u6211\u4eec\u7ed9 <code>user2</code> \u7684 <code>email</code> \u548c <code>username</code> \u90fd\u8d4b\u4e88\u65b0\u7684 <code>String</code> \u503c\uff0c\u4ece\u800c\u53ea\u4f7f\u7528 <code>user1</code> \u7684 <code>active</code> \u548c <code>sign_in_count</code> \u503c\uff0c\u90a3\u4e48 <code>user1</code> \u5728\u521b\u5efa <code>user2</code> \u540e\u4ecd\u7136\u6709\u6548\u3002<code>active</code> \u548c <code>sign_in_count</code> \u7684\u7c7b\u578b\u662f\u5b9e\u73b0 <code>Copy</code> trait \u7684\u7c7b\u578b\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u201c\u53d8\u91cf\u4e0e\u6570\u636e\u4ea4\u4e92\u7684\u65b9\u5f0f\uff08\u4e8c\uff09\uff1a\u514b\u9686\u201d \u90e8\u5206\u8ba8\u8bba\u7684\u884c\u4e3a\u540c\u6837\u9002\u7528\u3002</p> <pre><code>    println!(\"{}\",user2.active);\n\n    println!(\"{}\",user1.email);\n</code></pre> <p>\u7f16\u8bd1\u5668\u62a5\u9519: <pre><code>  --&gt; src/main.rs:22:19\n   |\n15 |       let user2 = User {\n   |  _________________-\n16 | |         active :false,\n17 | |         ..user1\n18 | |     };\n   | |_____- value moved here\n...\n22 |       println!(\"{}\",user1.email);\n   |                     ^^^^^^^^^^^ value borrowed here after move\n   |\n   = note: move occurs because `user1.email` has type `String`, which does not implement the `Copy` trait\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_5","title":"\u4f7f\u7528\u6ca1\u6709\u547d\u540d\u5b57\u6bb5\u7684\u5143\u7ec4\u7ed3\u6784\u6765\u521b\u5efa\u4e0d\u540c\u7684\u7c7b\u578b","text":"<p>\u4e5f\u53ef\u4ee5\u5b9a\u4e49\u4e0e\u5143\u7ec4\uff08\u5728\u7b2c\u4e09\u7ae0\u8ba8\u8bba\u8fc7\uff09\u7c7b\u4f3c\u7684\u7ed3\u6784\u4f53\uff0c\u79f0\u4e3a \u5143\u7ec4\u7ed3\u6784\u4f53\uff08tuple structs\uff09\u3002\u5143\u7ec4\u7ed3\u6784\u4f53\u6709\u7740\u7ed3\u6784\u4f53\u540d\u79f0\u63d0\u4f9b\u7684\u542b\u4e49\uff0c\u4f46\u6ca1\u6709\u5177\u4f53\u7684\u5b57\u6bb5\u540d\uff0c\u53ea\u6709\u5b57\u6bb5\u7684\u7c7b\u578b\u3002\u5f53\u4f60\u60f3\u7ed9\u6574\u4e2a\u5143\u7ec4\u53d6\u4e00\u4e2a\u540d\u5b57\uff0c\u5e76\u4f7f\u5143\u7ec4\u6210\u4e3a\u4e0e\u5176\u4ed6\u5143\u7ec4\u4e0d\u540c\u7684\u7c7b\u578b\u65f6\uff0c\u5143\u7ec4\u7ed3\u6784\u4f53\u662f\u5f88\u6709\u7528\u7684\uff0c\u8fd9\u65f6\u50cf\u5e38\u89c4\u7ed3\u6784\u4f53\u90a3\u6837\u4e3a\u6bcf\u4e2a\u5b57\u6bb5\u547d\u540d\u5c31\u663e\u5f97\u591a\u4f59\u548c\u5f62\u5f0f\u5316\u4e86\u3002</p> <p>\u8981\u5b9a\u4e49\u5143\u7ec4\u7ed3\u6784\u4f53\uff0c\u4ee5 <code>struct</code> \u5173\u952e\u5b57\u548c\u7ed3\u6784\u4f53\u540d\u5f00\u5934\u5e76\u540e\u8ddf\u5143\u7ec4\u4e2d\u7684\u7c7b\u578b\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u662f\u4e24\u4e2a\u5206\u522b\u53eb\u505a <code>Color</code> \u548c <code>Point</code> \u5143\u7ec4\u7ed3\u6784\u4f53\u7684\u5b9a\u4e49\u548c\u7528\u6cd5\uff1a</p> <pre><code>struct Color(i32, i32, i32);\nstruct Point(i32, i32, i32);\n\nfn main() {\n    let black = Color(0, 0, 0);\n    let origin = Point(0, 0, 0);\n}\n</code></pre> <p>\u6ce8\u610f <code>black</code> \u548c <code>origin</code> \u503c\u7684\u7c7b\u578b\u4e0d\u540c\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u4e0d\u540c\u7684\u5143\u7ec4\u7ed3\u6784\u4f53\u7684\u5b9e\u4f8b\u3002\u4f60\u5b9a\u4e49\u7684\u6bcf\u4e00\u4e2a\u7ed3\u6784\u4f53\u6709\u5176\u81ea\u5df1\u7684\u7c7b\u578b\uff0c\u5373\u4f7f\u7ed3\u6784\u4f53\u4e2d\u7684\u5b57\u6bb5\u53ef\u80fd\u6709\u7740\u76f8\u540c\u7684\u7c7b\u578b\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u83b7\u53d6 <code>Color</code> \u7c7b\u578b\u53c2\u6570\u7684\u51fd\u6570\u4e0d\u80fd\u63a5\u53d7 <code>Point</code> \u4f5c\u4e3a\u53c2\u6570\uff0c\u5373\u4fbf\u8fd9\u4e24\u4e2a\u7c7b\u578b\u90fd\u7531\u4e09\u4e2a <code>i32</code> \u503c\u7ec4\u6210\u3002\u5728\u5176\u4ed6\u65b9\u9762\uff0c\u5143\u7ec4\u7ed3\u6784\u4f53\u5b9e\u4f8b\u7c7b\u4f3c\u4e8e\u5143\u7ec4\uff0c\u4f60\u53ef\u4ee5\u5c06\u5b83\u4eec\u89e3\u6784\u4e3a\u5355\u72ec\u7684\u90e8\u5206\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>.</code> \u540e\u8ddf\u7d22\u5f15\u6765\u8bbf\u95ee\u5355\u72ec\u7684\u503c\uff0c\u7b49\u7b49\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_6","title":"\u6ca1\u6709\u4efb\u4f55\u5b57\u6bb5\u7684\u7c7b\u5355\u5143\u7ed3\u6784\u4f53","text":"<p>\u6211\u4eec\u4e5f\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u6ca1\u6709\u4efb\u4f55\u5b57\u6bb5\u7684\u7ed3\u6784\u4f53\uff01\u5b83\u4eec\u88ab\u79f0\u4e3a \u7c7b\u5355\u5143\u7ed3\u6784\u4f53\uff08unit-like structs\uff09\u56e0\u4e3a\u5b83\u4eec\u7c7b\u4f3c\u4e8e <code>()</code>\uff0c\u5373\u201c\u5143\u7ec4\u7c7b\u578b\u201d\u4e00\u8282\u4e2d\u63d0\u5230\u7684 unit \u7c7b\u578b\u3002\u7c7b\u5355\u5143\u7ed3\u6784\u4f53\u5e38\u5e38\u5728\u4f60\u60f3\u8981\u5728\u67d0\u4e2a\u7c7b\u578b\u4e0a\u5b9e\u73b0 trait \u4f46\u4e0d\u9700\u8981\u5728\u7c7b\u578b\u4e2d\u5b58\u50a8\u6570\u636e\u7684\u65f6\u5019\u53d1\u6325\u4f5c\u7528\u3002\u6211\u4eec\u5c06\u5728\u7b2c\u5341\u7ae0\u4ecb\u7ecd trait\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u58f0\u660e\u548c\u5b9e\u4f8b\u5316\u4e00\u4e2a\u540d\u4e3a <code>AlwaysEqual</code> \u7684 unit \u7ed3\u6784\u7684\u4f8b\u5b50\u3002</p> <pre><code>struct AlwaysEqual;\n\nfn main() {\n    let subject = AlwaysEqual;\n}\n</code></pre> <p>\u8981\u5b9a\u4e49 <code>AlwaysEqual</code>\uff0c\u6211\u4eec\u4f7f\u7528 <code>struct</code> \u5173\u952e\u5b57\uff0c\u6211\u4eec\u60f3\u8981\u7684\u540d\u79f0\uff0c\u7136\u540e\u662f\u4e00\u4e2a\u5206\u53f7\u3002\u4e0d\u9700\u8981\u82b1\u62ec\u53f7\u6216\u5706\u62ec\u53f7\uff01\u7136\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u5728 <code>subject</code> \u53d8\u91cf\u4e2d\u83b7\u5f97 <code>AlwaysEqual</code> \u7684\u5b9e\u4f8b\uff1a\u4f7f\u7528\u6211\u4eec\u5b9a\u4e49\u7684\u540d\u79f0\uff0c\u4e0d\u9700\u8981\u4efb\u4f55\u82b1\u62ec\u53f7\u6216\u5706\u62ec\u53f7\u3002\u60f3\u8c61\u4e00\u4e0b\uff0c\u6211\u4eec\u5c06\u5b9e\u73b0\u8fd9\u4e2a\u7c7b\u578b\u7684\u884c\u4e3a\uff0c\u5373\u6bcf\u4e2a\u5b9e\u4f8b\u59cb\u7ec8\u7b49\u4e8e\u6bcf\u4e00\u4e2a\u5176\u4ed6\u7c7b\u578b\u7684\u5b9e\u4f8b\uff0c\u4e5f\u8bb8\u662f\u4e3a\u4e86\u83b7\u5f97\u4e00\u4e2a\u5df2\u77e5\u7684\u7ed3\u679c\u4ee5\u4fbf\u8fdb\u884c\u6d4b\u8bd5\u3002\u6211\u4eec\u4e0d\u9700\u8981\u4efb\u4f55\u6570\u636e\u6765\u5b9e\u73b0\u8fd9\u79cd\u884c\u4e3a\uff0c\u4f60\u5c06\u5728\u7b2c\u5341\u7ae0\u4e2d\uff0c\u770b\u5230\u5982\u4f55\u5b9a\u4e49\u7279\u6027\u5e76\u5728\u4efb\u4f55\u7c7b\u578b\u4e0a\u5b9e\u73b0\u5b83\u4eec\uff0c\u5305\u62ec\u7c7b\u5355\u5143\u7ed3\u6784\u4f53\u3002</p> <p>[!info] \u7ed3\u6784\u4f53\u6570\u636e\u7684\u6240\u6709\u6743 <code>User</code>\u00a0\u7ed3\u6784\u4f53\u7684\u5b9a\u4e49\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e86\u81ea\u8eab\u62e5\u6709\u6240\u6709\u6743\u7684\u00a0<code>String</code>\u00a0\u7c7b\u578b\u800c\u4e0d\u662f\u00a0<code>&amp;str</code>\u00a0\u5b57\u7b26\u4e32 slice \u7c7b\u578b\u3002\u8fd9\u662f\u4e00\u4e2a\u6709\u610f\u800c\u4e3a\u4e4b\u7684\u9009\u62e9\uff0c\u56e0\u4e3a\u6211\u4eec\u60f3\u8981\u8fd9\u4e2a\u7ed3\u6784\u4f53\u62e5\u6709\u5b83\u6240\u6709\u7684\u6570\u636e\uff0c\u4e3a\u6b64\u53ea\u8981\u6574\u4e2a\u7ed3\u6784\u4f53\u662f\u6709\u6548\u7684\u8bdd\u5176\u6570\u636e\u4e5f\u662f\u6709\u6548\u7684\u3002</p> <p>\u53ef\u4ee5\u4f7f\u7ed3\u6784\u4f53\u5b58\u50a8\u88ab\u5176\u4ed6\u5bf9\u8c61\u62e5\u6709\u7684\u6570\u636e\u7684\u5f15\u7528\uff0c\u4e0d\u8fc7\u8fd9\u4e48\u505a\u7684\u8bdd\u9700\u8981\u7528\u4e0a\u00a0\u751f\u547d\u5468\u671f\uff08lifetimes\uff09\uff0c\u8fd9\u662f\u4e00\u4e2a\u7b2c\u5341\u7ae0\u4f1a\u8ba8\u8bba\u7684 Rust \u529f\u80fd\u3002\u751f\u547d\u5468\u671f\u786e\u4fdd\u7ed3\u6784\u4f53\u5f15\u7528\u7684\u6570\u636e\u6709\u6548\u6027\u8ddf\u7ed3\u6784\u4f53\u672c\u8eab\u4fdd\u6301\u4e00\u81f4\u3002\u5982\u679c\u4f60\u5c1d\u8bd5\u5728\u7ed3\u6784\u4f53\u4e2d\u5b58\u50a8\u4e00\u4e2a\u5f15\u7528\u800c\u4e0d\u6307\u5b9a\u751f\u547d\u5468\u671f\u5c06\u662f\u65e0\u6548\u7684</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_7","title":"\u7ed3\u6784\u4f53\u793a\u4f8b\u7a0b\u5e8f","text":"<p>\u539f\u7a0b\u5e8f\uff1a <pre><code>fn main() {\n    let width1 = 30;\n    let height1 = 50;\n\n    println!(\n        \"The area of the rectangle is {} square pixels.\",\n        area(width1, height1)\n    );\n}\n\nfn area(width: u32, height: u32) -&gt; u32 {\n    width * height\n}\n</code></pre></p> <p>\u4f7f\u7528\u5143\u7ec4\u91cd\u6784\uff1a <pre><code>fn main() {\n    let rect1 = (30, 50);\n\n    println!(\n        \"The area of the rectangle is {} square pixels.\",\n        area(rect1)\n    );\n}\n\nfn area(dimensions: (u32, u32)) -&gt; u32 {\n    dimensions.0 * dimensions.1\n}\n</code></pre></p> <p>\u4f7f\u7528\u7ed3\u6784\u4f53\u91cd\u6784\uff1a <pre><code>struct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nfn main() {\n    let rect1 = Rectangle {\n        width: 30,\n        height: 50,\n    };\n\n    println!(\n        \"The area of the rectangle is {} square pixels.\",\n        area(&amp;rect1)\n    );\n}\n\nfn area(rectangle: &amp;Rectangle) -&gt; u32 {\n    rectangle.width * rectangle.height\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#trait","title":"\u901a\u8fc7\u6d3e\u751ftrait\u589e\u52a0\u5b9e\u7528\u529f\u80fd","text":"<pre><code>struct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nfn main() {\n    let rect1 = Rectangle {\n        width: 30,\n        height: 50,\n    };\n\n    println!(\"rect1 is {}\", rect1);\n}\n</code></pre> <p>\u5f53\u6211\u4eec\u8fd0\u884c\u8fd9\u4e2a\u4ee3\u7801\u65f6\uff0c\u4f1a\u51fa\u73b0\u5e26\u6709\u5982\u4e0b\u6838\u5fc3\u4fe1\u606f\u7684\u9519\u8bef\uff1a <pre><code>error[E0277]: `Rectangle` doesn't implement `std::fmt::Display`\n</code></pre></p> <p><code>println!</code> \u5b8f\u80fd\u5904\u7406\u5f88\u591a\u7c7b\u578b\u7684\u683c\u5f0f\uff0c\u4e0d\u8fc7\uff0c<code>{}</code> \u9ed8\u8ba4\u544a\u8bc9 <code>println!</code> \u4f7f\u7528\u88ab\u79f0\u4e3a <code>Display</code> \u7684\u683c\u5f0f\uff1a\u610f\u5728\u63d0\u4f9b\u7ed9\u76f4\u63a5\u7ec8\u7aef\u7528\u6237\u67e5\u770b\u7684\u8f93\u51fa\u3002\u76ee\u524d\u4e3a\u6b62\u89c1\u8fc7\u7684\u57fa\u672c\u7c7b\u578b\u90fd\u9ed8\u8ba4\u5b9e\u73b0\u4e86 <code>Display</code>\uff0c\u56e0\u4e3a\u5b83\u5c31\u662f\u5411\u7528\u6237\u5c55\u793a <code>1</code> \u6216\u5176\u4ed6\u4efb\u4f55\u57fa\u672c\u7c7b\u578b\u7684\u552f\u4e00\u65b9\u5f0f\u3002</p> <p>\u6839\u636e\u63d0\u793a\uff1a <pre><code>= note: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead\n</code></pre></p> <p>\u73b0\u5728 <code>println!</code> \u5b8f\u8c03\u7528\u770b\u8d77\u6765\u50cf <code>println!(\"rect1 is {:?}\", rect1);</code> \u8fd9\u6837\u3002\u5728 <code>{}</code> \u4e2d\u52a0\u5165 <code>:?</code> \u6307\u793a\u7b26\u544a\u8bc9 <code>println!</code> \u6211\u4eec\u60f3\u8981\u4f7f\u7528\u53eb\u505a <code>Debug</code> \u7684\u8f93\u51fa\u683c\u5f0f\u3002<code>Debug</code> \u662f\u4e00\u4e2a trait\uff0c\u5b83\u5141\u8bb8\u6211\u4eec\u4ee5\u4e00\u79cd\u5bf9\u5f00\u53d1\u8005\u6709\u5e2e\u52a9\u7684\u65b9\u5f0f\u6253\u5370\u7ed3\u6784\u4f53\uff0c\u4ee5\u4fbf\u5f53\u6211\u4eec\u8c03\u8bd5\u4ee3\u7801\u65f6\u80fd\u770b\u5230\u5b83\u7684\u503c\u3002</p> <p>\u6b64\u5916\uff0c\u6211\u4eec\u5fc5\u987b\u4e3a\u7ed3\u6784\u4f53\u663e\u5f0f\u9009\u62e9\u6253\u5370\u51fa\u8c03\u8bd5\u4fe1\u606f\u7684\u529f\u80fd\u3002\u4e3a\u6b64\uff0c\u5728\u7ed3\u6784\u4f53\u5b9a\u4e49\u4e4b\u524d\u52a0\u4e0a\u5916\u90e8\u5c5e\u6027 <code>#[derive(Debug)]</code></p> <pre><code>#[derive(Debug)]\nstruct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nfn main() {\n    let rect1 = Rectangle {\n        width: 30,\n        height: 50,\n    };\n\n    println!(\"rect1 is {:?}\", rect1);\n}\n</code></pre> <p>\u8f93\u5165 <pre><code>rect1 is Rectangle { width: 30, height: 50 }\n</code></pre></p> <p>\u4f7f\u7528<code>{:#?}</code>\u540e <pre><code>rect1 is Rectangle {\n    width: 30,\n    height: 50,\n}\n</code></pre></p> <p>\u53e6\u4e00\u79cd\u4f7f\u7528 <code>Debug</code> \u683c\u5f0f\u6253\u5370\u6570\u503c\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 <code>dbg!</code> \u5b8f\u3002<code>dbg!</code> \u5b8f\u63a5\u6536\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u6240\u6709\u6743\uff08\u4e0e <code>println!</code> \u5b8f\u76f8\u53cd\uff0c\u540e\u8005\u63a5\u6536\u7684\u662f\u5f15\u7528\uff09\uff0c\u6253\u5370\u51fa\u4ee3\u7801\u4e2d\u8c03\u7528 dbg! \u5b8f\u65f6\u6240\u5728\u7684\u6587\u4ef6\u548c\u884c\u53f7\uff0c\u4ee5\u53ca\u8be5\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\uff0c\u5e76\u8fd4\u56de\u8be5\u503c\u7684\u6240\u6709\u6743\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u5bf9\u5206\u914d\u7ed9 <code>width</code> \u5b57\u6bb5\u7684\u503c\u4ee5\u53ca <code>rect1</code> \u4e2d\u6574\u4e2a\u7ed3\u6784\u7684\u503c\u611f\u5174\u8da3\u3002</p> <pre><code>#[derive(Debug)]\nstruct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nfn main() {\n    let scale = 2;\n    let rect1 = Rectangle {\n        width: dbg!(30 * scale),\n        height: 50,\n    };\n\n    dbg!(&amp;rect1);\n}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u628a <code>dbg!</code> \u653e\u5728\u8868\u8fbe\u5f0f <code>30 * scale</code> \u5468\u56f4\uff0c\u56e0\u4e3a <code>dbg!</code> \u8fd4\u56de\u8868\u8fbe\u5f0f\u7684\u503c\u7684\u6240\u6709\u6743\uff0c\u6240\u4ee5 <code>width</code> \u5b57\u6bb5\u5c06\u83b7\u5f97\u76f8\u540c\u7684\u503c\uff0c\u5c31\u50cf\u6211\u4eec\u5728\u90a3\u91cc\u6ca1\u6709 <code>dbg!</code> \u8c03\u7528\u4e00\u6837\u3002\u6211\u4eec\u4e0d\u5e0c\u671b <code>dbg!</code> \u62e5\u6709 <code>rect1</code> \u7684\u6240\u6709\u6743\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u4e0b\u4e00\u6b21\u8c03\u7528 <code>dbg!</code> \u65f6\u4f20\u9012\u4e00\u4e2a\u5f15\u7528\u3002\u4e0b\u9762\u662f\u8fd9\u4e2a\u4f8b\u5b50\u7684\u8f93\u51fa\u7ed3\u679c\uff1a</p> <pre><code>$ cargo run\n   Compiling rectangles v0.1.0 (file:///projects/rectangles)\n    Finished dev [unoptimized + debuginfo] target(s) in 0.61s\n     Running `target/debug/rectangles`\n[src/main.rs:10] 30 * scale = 60\n[src/main.rs:14] &amp;rect1 = Rectangle {\n    width: 60,\n    height: 50,\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_8","title":"\u65b9\u6cd5\u8bed\u6cd5","text":"<p>\u65b9\u6cd5\uff08method\uff09\u4e0e\u51fd\u6570\u7c7b\u4f3c\uff1a\u5b83\u4eec\u4f7f\u7528 <code>fn</code> \u5173\u952e\u5b57\u548c\u540d\u79f0\u58f0\u660e\uff0c\u53ef\u4ee5\u62e5\u6709\u53c2\u6570\u548c\u8fd4\u56de\u503c\uff0c\u540c\u65f6\u5305\u542b\u5728\u67d0\u5904\u8c03\u7528\u8be5\u65b9\u6cd5\u65f6\u4f1a\u6267\u884c\u7684\u4ee3\u7801\u3002\u4e0d\u8fc7\u65b9\u6cd5\u4e0e\u51fd\u6570\u662f\u4e0d\u540c\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u5728\u7ed3\u6784\u4f53\u7684\u4e0a\u4e0b\u6587\u4e2d\u88ab\u5b9a\u4e49\uff08\u6216\u8005\u662f\u679a\u4e3e\u6216 trait \u5bf9\u8c61\u7684\u4e0a\u4e0b\u6587\uff09\u5e76\u4e14\u5b83\u4eec\u7b2c\u4e00\u4e2a\u53c2\u6570\u603b\u662f <code>self</code>\uff0c\u5b83\u4ee3\u8868\u8c03\u7528\u8be5\u65b9\u6cd5\u7684\u7ed3\u6784\u4f53\u5b9e\u4f8b\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_9","title":"\u5b9a\u4e49\u65b9\u6cd5","text":"<p>\u8ba9\u6211\u4eec\u628a\u524d\u9762\u5b9e\u73b0\u7684\u83b7\u53d6\u4e00\u4e2a <code>Rectangle</code> \u5b9e\u4f8b\u4f5c\u4e3a\u53c2\u6570\u7684 <code>area</code> \u51fd\u6570\uff0c\u6539\u5199\u6210\u4e00\u4e2a\u5b9a\u4e49\u4e8e <code>Rectangle</code> \u7ed3\u6784\u4f53\u4e0a\u7684 <code>area</code> \u65b9\u6cd5\uff1a</p> <pre><code>struct Rectangle {\n    width: u32,\n    height: u32,\n}\n\n// \u5b9a\u4e49\u65b9\u6cd5\nimpl Rectangle {\n    fn area(&amp;self) -&gt; u32 {\n        self.width * self.height\n    }\n}\n\nfn main() {\n    let rect1 = Rectangle {\n        width: 30,\n        height: 50,\n    };\n\n    println!(\n        \"The area of the rectangle is {} square pixels.\",\n        rect1.area()\n    );\n}\n</code></pre> <p>\u4e3a\u4e86\u4f7f\u51fd\u6570\u5b9a\u4e49\u4e8e <code>Rectangle</code> \u7684\u4e0a\u4e0b\u6587\u4e2d\uff0c\u6211\u4eec\u5f00\u59cb\u4e86\u4e00\u4e2a <code>impl</code> \u5757\uff08<code>impl</code> \u662f implementation \u7684\u7f29\u5199\uff09\uff0c\u8fd9\u4e2a <code>impl</code> \u5757\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u90fd\u5c06\u4e0e <code>Rectangle</code> \u7c7b\u578b\u76f8\u5173\u8054\u3002\u63a5\u7740\u5c06 <code>area</code> \u51fd\u6570\u79fb\u52a8\u5230 <code>impl</code> \u5927\u62ec\u53f7\u4e2d\uff0c\u5e76\u5c06\u7b7e\u540d\u4e2d\u7684\u7b2c\u4e00\u4e2a\uff08\u5728\u8fd9\u91cc\u4e5f\u662f\u552f\u4e00\u4e00\u4e2a\uff09\u53c2\u6570\u548c\u51fd\u6570\u4f53\u4e2d\u5176\u4ed6\u5730\u65b9\u7684\u5bf9\u5e94\u53c2\u6570\u6539\u6210 <code>self</code>\u3002\u7136\u540e\u5728 <code>main</code> \u4e2d\u5c06\u6211\u4eec\u5148\u524d\u8c03\u7528 <code>area</code> \u65b9\u6cd5\u5e76\u4f20\u9012 <code>rect1</code> \u4f5c\u4e3a\u53c2\u6570\u7684\u5730\u65b9\uff0c\u6539\u6210\u4f7f\u7528 \u65b9\u6cd5\u8bed\u6cd5\uff08method syntax\uff09\u5728 <code>Rectangle</code> \u5b9e\u4f8b\u4e0a\u8c03\u7528 <code>area</code> \u65b9\u6cd5\u3002\u65b9\u6cd5\u8bed\u6cd5\u83b7\u53d6\u4e00\u4e2a\u5b9e\u4f8b\u5e76\u52a0\u4e0a\u4e00\u4e2a\u70b9\u53f7\uff0c\u540e\u8ddf\u65b9\u6cd5\u540d\u3001\u5706\u62ec\u53f7\u4ee5\u53ca\u4efb\u4f55\u53c2\u6570\u3002</p> <p>\u5728 <code>area</code> \u7684\u7b7e\u540d\u4e2d\uff0c\u4f7f\u7528 <code>&amp;self</code> \u6765\u66ff\u4ee3 <code>rectangle: &amp;Rectangle</code>\uff0c<code>&amp;self</code> \u5b9e\u9645\u4e0a\u662f <code>self: &amp;Self</code> \u7684\u7f29\u5199\u3002\u5728\u4e00\u4e2a <code>impl</code> \u5757\u4e2d\uff0c<code>Self</code> \u7c7b\u578b\u662f <code>impl</code> \u5757\u7684\u7c7b\u578b\u7684\u522b\u540d\u3002\u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u6709\u4e00\u4e2a\u540d\u4e3a <code>self</code> \u7684<code>Self</code> \u7c7b\u578b\u7684\u53c2\u6570\uff0c\u6240\u4ee5 Rust \u8ba9\u4f60\u5728\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f4d\u7f6e\u4e0a\u53ea\u7528 <code>self</code> \u8fd9\u4e2a\u540d\u5b57\u6765\u7f29\u5199\u3002\u6ce8\u610f\uff0c\u6211\u4eec\u4ecd\u7136\u9700\u8981\u5728 <code>self</code> \u524d\u9762\u4f7f\u7528 <code>&amp;</code> \u6765\u8868\u793a\u8fd9\u4e2a\u65b9\u6cd5\u501f\u7528\u4e86 <code>Self</code> \u5b9e\u4f8b\uff0c\u5c31\u50cf\u6211\u4eec\u5728 <code>rectangle: &amp;Rectangle</code> \u4e2d\u505a\u7684\u90a3\u6837\u3002\u65b9\u6cd5\u53ef\u4ee5\u9009\u62e9\u83b7\u5f97 <code>self</code> \u7684\u6240\u6709\u6743\uff0c\u6216\u8005\u50cf\u6211\u4eec\u8fd9\u91cc\u4e00\u6837\u4e0d\u53ef\u53d8\u5730\u501f\u7528 <code>self</code>\uff0c\u6216\u8005\u53ef\u53d8\u5730\u501f\u7528 <code>self</code>\uff0c\u5c31\u8ddf\u5176\u4ed6\u53c2\u6570\u4e00\u6837\u3002</p> <p>\u5982\u679c\u60f3\u8981\u5728\u65b9\u6cd5\u4e2d\u6539\u53d8\u8c03\u7528\u65b9\u6cd5\u7684\u5b9e\u4f8b\uff0c\u9700\u8981\u5c06\u7b2c\u4e00\u4e2a\u53c2\u6570\u6539\u4e3a <code>&amp;mut self</code>\u3002\u901a\u8fc7\u4ec5\u4ec5\u4f7f\u7528 <code>self</code> \u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u53c2\u6570\u6765\u4f7f\u65b9\u6cd5\u83b7\u53d6\u5b9e\u4f8b\u7684\u6240\u6709\u6743\u662f\u5f88\u5c11\u89c1\u7684\uff1b\u8fd9\u79cd\u6280\u672f\u901a\u5e38\u7528\u5728\u5f53\u65b9\u6cd5\u5c06 <code>self</code> \u8f6c\u6362\u6210\u522b\u7684\u5b9e\u4f8b\u7684\u65f6\u5019\uff0c\u8fd9\u65f6\u6211\u4eec\u60f3\u8981\u9632\u6b62\u8c03\u7528\u8005\u5728\u8f6c\u6362\u4e4b\u540e\u4f7f\u7528\u539f\u59cb\u7684\u5b9e\u4f8b\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u5c06\u65b9\u6cd5\u7684\u540d\u79f0\u4e0e\u7ed3\u6784\u4e2d\u7684\u4e00\u4e2a\u5b57\u6bb5\u76f8\u540c\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 <code>Rectangle</code> \u4e0a\u5b9a\u4e49\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5e76\u547d\u540d\u4e3a <code>width</code>\uff1a</p> <pre><code>impl Rectangle {\n    fn width(&amp;self) -&gt; bool {\n        self.width &gt; 0\n    }\n}\n\nfn main() {\n    let rect1 = Rectangle {\n        width: 30,\n        height: 50,\n    };\n\n    if rect1.width() {\n        println!(\"The rectangle has a nonzero width; it is {}\", rect1.width);\n    }\n}\n</code></pre> <p><code>-&gt;</code> \u8fd0\u7b97\u7b26\u5230\u54ea\u53bb\u4e86\uff1f</p> <p>Rust \u5e76\u6ca1\u6709\u4e00\u4e2a\u4e0e <code>-&gt;</code> \u7b49\u6548\u7684\u8fd0\u7b97\u7b26\uff1b\u76f8\u53cd\uff0cRust \u6709\u4e00\u4e2a\u53eb \u81ea\u52a8\u5f15\u7528\u548c\u89e3\u5f15\u7528\uff08automatic referencing and dereferencing\uff09\u7684\u529f\u80fd\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_10","title":"\u5e26\u6709\u66f4\u591a\u53c2\u6570\u7684\u65b9\u6cd5","text":"<p>\u8ba9\u6211\u4eec\u901a\u8fc7\u5b9e\u73b0 <code>Rectangle</code> \u7ed3\u6784\u4f53\u4e0a\u7684\u53e6\u4e00\u65b9\u6cd5\u6765\u7ec3\u4e60\u4f7f\u7528\u65b9\u6cd5\u3002\u8fd9\u56de\uff0c\u6211\u4eec\u8ba9\u4e00\u4e2a <code>Rectangle</code> \u7684\u5b9e\u4f8b\u83b7\u53d6\u53e6\u4e00\u4e2a <code>Rectangle</code> \u5b9e\u4f8b\uff0c\u5982\u679c <code>self</code> \uff08\u7b2c\u4e00\u4e2a <code>Rectangle</code>\uff09\u80fd\u5b8c\u5168\u5305\u542b\u7b2c\u4e8c\u4e2a\u957f\u65b9\u5f62\u5219\u8fd4\u56de <code>true</code>\uff1b\u5426\u5219\u8fd4\u56de <code>false</code>\u3002\u4e00\u65e6\u6211\u4eec\u5b9a\u4e49\u4e86 <code>can_hold</code> \u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u7f16\u5199\u793a\u4f8b\u4e2d\u7684\u4ee3\u7801\u3002</p> <pre><code>fn main() {\n    let rect1 = Rectangle {\n        width: 30,\n        height: 50,\n    };\n    let rect2 = Rectangle {\n        width: 10,\n        height: 40,\n    };\n    let rect3 = Rectangle {\n        width: 60,\n        height: 45,\n    };\n\n    println!(\"Can rect1 hold rect2? {}\", rect1.can_hold(&amp;rect2));\n    println!(\"Can rect1 hold rect3? {}\", rect1.can_hold(&amp;rect3));\n}\n</code></pre> <p>\u540c\u65f6\u6211\u4eec\u5e0c\u671b\u770b\u5230\u5982\u4e0b\u8f93\u51fa\uff0c\u56e0\u4e3a <code>rect2</code> \u7684\u4e24\u4e2a\u7ef4\u5ea6\u90fd\u5c0f\u4e8e <code>rect1</code>\uff0c\u800c <code>rect3</code> \u6bd4 <code>rect1</code> \u8981\u5bbd\uff1a</p> <pre><code>Can rect1 hold rect2? true\nCan rect1 hold rect3? false\n</code></pre> <p>\u56e0\u4e3a\u6211\u4eec\u60f3\u5b9a\u4e49\u4e00\u4e2a\u65b9\u6cd5\uff0c\u6240\u4ee5\u5b83\u5e94\u8be5\u4f4d\u4e8e <code>impl Rectangle</code> \u5757\u4e2d\u3002\u65b9\u6cd5\u540d\u662f <code>can_hold</code>\uff0c\u5e76\u4e14\u5b83\u4f1a\u83b7\u53d6\u53e6\u4e00\u4e2a <code>Rectangle</code> \u7684\u4e0d\u53ef\u53d8\u501f\u7528\u4f5c\u4e3a\u53c2\u6570\u3002\u901a\u8fc7\u89c2\u5bdf\u8c03\u7528\u65b9\u6cd5\u7684\u4ee3\u7801\u53ef\u4ee5\u770b\u51fa\u53c2\u6570\u662f\u4ec0\u4e48\u7c7b\u578b\u7684\uff1a<code>rect1.can_hold(&amp;rect2)</code> \u4f20\u5165\u4e86 <code>&amp;rect2</code>\uff0c\u5b83\u662f\u4e00\u4e2a <code>Rectangle</code> \u7684\u5b9e\u4f8b <code>rect2</code> \u7684\u4e0d\u53ef\u53d8\u501f\u7528\u3002\u8fd9\u662f\u53ef\u4ee5\u7406\u89e3\u7684\uff0c\u56e0\u4e3a\u6211\u4eec\u53ea\u9700\u8981\u8bfb\u53d6 <code>rect2</code>\uff08\u800c\u4e0d\u662f\u5199\u5165\uff0c\u8fd9\u610f\u5473\u7740\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u4e0d\u53ef\u53d8\u501f\u7528\uff09\uff0c\u800c\u4e14\u5e0c\u671b <code>main</code> \u4fdd\u6301 <code>rect2</code> \u7684\u6240\u6709\u6743\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u8c03\u7528\u8fd9\u4e2a\u65b9\u6cd5\u540e\u7ee7\u7eed\u4f7f\u7528\u5b83\u3002<code>can_hold</code> \u7684\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u5e03\u5c14\u503c\uff0c\u5176\u5b9e\u73b0\u4f1a\u5206\u522b\u68c0\u67e5 <code>self</code> \u7684\u5bbd\u9ad8\u662f\u5426\u90fd\u5927\u4e8e\u53e6\u4e00\u4e2a <code>Rectangle</code>\u3002</p> <pre><code>impl Rectangle {\n    fn area(&amp;self) -&gt; u32 {\n        self.width * self.height\n    }\n\n    fn can_hold(&amp;self, other: &amp;Rectangle) -&gt; bool {\n        self.width &gt; other.width &amp;&amp; self.height &gt; other.height\n    }\n}\n</code></pre> <p>\u5728\u65b9\u6cd5\u7b7e\u540d\u4e2d\uff0c\u53ef\u4ee5\u5728 <code>self</code> \u540e\u589e\u52a0\u591a\u4e2a\u53c2\u6570\uff0c\u800c\u4e14\u8fd9\u4e9b\u53c2\u6570\u5c31\u50cf\u51fd\u6570\u4e2d\u7684\u53c2\u6570\u4e00\u6837\u5de5\u4f5c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#_11","title":"\u5173\u8054\u51fd\u6570","text":"<p>\u6240\u6709\u5728 <code>impl</code> \u5757\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570\u88ab\u79f0\u4e3a \u5173\u8054\u51fd\u6570\uff08associated functions\uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0e <code>impl</code> \u540e\u9762\u547d\u540d\u7684\u7c7b\u578b\u76f8\u5173\u3002\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e0d\u4ee5 <code>self</code> \u4e3a\u7b2c\u4e00\u53c2\u6570\u7684\u5173\u8054\u51fd\u6570\uff08\u56e0\u6b64\u4e0d\u662f\u65b9\u6cd5\uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u5e76\u4e0d\u4f5c\u7528\u4e8e\u4e00\u4e2a\u7ed3\u6784\u4f53\u7684\u5b9e\u4f8b\u3002\u6211\u4eec\u5df2\u7ecf\u4f7f\u7528\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u51fd\u6570\uff1a\u5728 <code>String</code> \u7c7b\u578b\u4e0a\u5b9a\u4e49\u7684 <code>String::from</code> \u51fd\u6570\u3002</p> <p>\u4e0d\u662f\u65b9\u6cd5\u7684\u5173\u8054\u51fd\u6570\u7ecf\u5e38\u88ab\u7528\u4f5c\u8fd4\u56de\u4e00\u4e2a\u7ed3\u6784\u4f53\u65b0\u5b9e\u4f8b\u7684\u6784\u9020\u51fd\u6570\u3002\u8fd9\u4e9b\u51fd\u6570\u7684\u540d\u79f0\u901a\u5e38\u4e3a <code>new</code> \uff0c\u4f46 <code>new</code> \u5e76\u4e0d\u662f\u4e00\u4e2a\u5173\u952e\u5b57\u3002\u4f8b\u5982\u6211\u4eec\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u53eb\u505a <code>square</code> \u5173\u8054\u51fd\u6570\uff0c\u5b83\u63a5\u53d7\u4e00\u4e2a\u7ef4\u5ea6\u53c2\u6570\u5e76\u4e14\u540c\u65f6\u4f5c\u4e3a\u5bbd\u548c\u9ad8\uff0c\u8fd9\u6837\u53ef\u4ee5\u66f4\u8f7b\u677e\u7684\u521b\u5efa\u4e00\u4e2a\u6b63\u65b9\u5f62 <code>Rectangle</code> \u800c\u4e0d\u5fc5\u6307\u5b9a\u4e24\u6b21\u540c\u6837\u7684\u503c\uff1a</p> <pre><code>impl Rectangle {\n    fn square(size: u32) -&gt; Self {\n        Self {\n            width: size,\n            height: size,\n        }\n    }\n}\n\nfn main() {\n    let sq = Rectangle::square(3);\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/3.%E7%BB%93%E6%9E%84%E4%BD%93/#impl","title":"\u591a\u4e2a impl \u5757","text":"<p>\u6bcf\u4e2a\u7ed3\u6784\u4f53\u90fd\u5141\u8bb8\u62e5\u6709\u591a\u4e2a <code>impl</code> \u5757\u3002\u4f8b\u5982\uff0c\u793a\u4f8b 5-16 \u4e2d\u7684\u4ee3\u7801\u7b49\u540c\u4e8e\u793a\u4f8b 5-15\uff0c\u4f46\u6bcf\u4e2a\u65b9\u6cd5\u6709\u5176\u81ea\u5df1\u7684 <code>impl</code> \u5757\u3002</p> <pre><code>impl Rectangle {\n    fn area(&amp;self) -&gt; u32 {\n        self.width * self.height\n    }\n}\n\nimpl Rectangle {\n    fn can_hold(&amp;self, other: &amp;Rectangle) -&gt; bool {\n        self.width &gt; other.width &amp;&amp; self.height &gt; other.height\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/","title":"\u679a\u4e3e\u548c\u6a21\u5f0f\u5339\u914d","text":"<p>FIXME</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#_2","title":"\u679a\u4e3e\u7684\u5b9a\u4e49","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#enum","title":"\u679a\u4e3eenum","text":"<p>\u679a\u4e3e\u7684\u5b9a\u4e49 - Rust \u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00 \u7b80\u4f53\u4e2d\u6587\u7248</p> <p>\u679a\u4e3e\uff08Enumerations\uff09\u662f\u4e00\u79cd\u7528\u4e8e\u5b9a\u4e49\u4e00\u4e2a\u7c7b\u578b\u7684\u503c\u7684\u6709\u9650\u96c6\u5408\u7684\u6570\u636e\u7ed3\u6784\u3002\u679a\u4e3e\u7c7b\u578b\u5728Rust\u4e2d\u975e\u5e38\u5f3a\u5927\uff0c\u5b83\u80fd\u591f\u5e2e\u52a9\u5f00\u53d1\u8005\u66f4\u597d\u5730\u8868\u8fbe\u4ee3\u7801\u4e2d\u7684\u6982\u5ff5\u3002\u56e0\u4e3a\u679a\u4e3e\u503c\u53ea\u53ef\u80fd\u662f\u5176\u4e2d\u4e00\u4e2a\u6210\u5458\u3002</p> <p>\u5728Rust\u4e2d\uff0c\u4f7f\u7528<code>enum</code>\u5173\u952e\u5b57\u6765\u5b9a\u4e49\u679a\u4e3e\u7c7b\u578b\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u8868\u793a\u4e0d\u540c\u989c\u8272\u7684\u679a\u4e3e\u7c7b\u578b\u7684\u793a\u4f8b\uff1a</p> <pre><code>enum Color {\n    Red,\n    Blue,\n    Green,\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c<code>Color</code>\u662f\u4e00\u4e2a\u679a\u4e3e\u7c7b\u578b\uff0c\u5b83\u5305\u542b\u4e86\u4e09\u4e2a\u53ef\u80fd\u7684\u503c\uff1a<code>Red</code>\u3001<code>Blue</code>\u548c<code>Green</code>\u3002\u8fd9\u4e9b\u503c\u88ab\u79f0\u4e3a\u679a\u4e3e\u7684\u201c\u6210\u5458\u201d\uff08variants\uff09\u3002</p> <p>\u679a\u4e3e\u7c7b\u578b\u7684\u6210\u5458\u53ef\u4ee5\u5e26\u6709\u5173\u8054\u7684\u6570\u636e\u3002\u8fd9\u4f7f\u5f97\u679a\u4e3e\u7c7b\u578b\u66f4\u52a0\u7075\u6d3b\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539\u4e0a\u9762\u7684\u793a\u4f8b\uff0c\u4f7f<code>Color</code>\u679a\u4e3e\u7684\u6210\u5458\u5177\u6709\u5173\u8054\u7684RGB\u503c\uff1a</p> <pre><code>enum Color {\n    RGB(u8, u8, u8),\n    Red,\n    Blue,\n    Green,\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c<code>RGB</code>\u6210\u5458\u5e26\u6709\u4e09\u4e2a<code>u8</code>\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5206\u522b\u8868\u793a\u7ea2\u3001\u7eff\u3001\u84dd\u7684\u503c\u3002</p> <p>\u679a\u4e3e\u7c7b\u578b\u53ef\u4ee5\u50cf\u7ed3\u6784\u4f53\u4e00\u6837\u4f7f\u7528\u6a21\u5f0f\u5339\u914d\uff08pattern matching\uff09\u8fdb\u884c\u89e3\u6784\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u4f7f\u7528<code>match</code>\u8bed\u53e5\u5bf9<code>Color</code>\u679a\u4e3e\u7684\u6210\u5458\u8fdb\u884c\u5339\u914d\u7684\u793a\u4f8b\uff1a</p> <pre><code>fn print_color(color: Color) {\n    match color {\n        Color::Red =&gt; println!(\"The color is red!\"),\n        Color::Blue =&gt; println!(\"The color is blue!\"),\n        Color::Green =&gt; println!(\"The color is green!\"),\n        Color::RGB(r, g, b) =&gt; println!(\"The color is RGB({},{},{})!\", r, g, b),\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u901a\u8fc7<code>match</code>\u8bed\u53e5\u6839\u636e\u4e0d\u540c\u7684\u679a\u4e3e\u6210\u5458\u6267\u884c\u76f8\u5e94\u7684\u4ee3\u7801\u5757\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#option","title":"\u679a\u4e3eOption","text":"<p>Rust\u4e2d\u5e76\u6ca1\u6709\u7a7a\u503c\uff0c\u4e0d\u8fc7\u5b83\u786e\u5b9e\u62e5\u6709\u4e00\u4e2a\u53ef\u4ee5\u7f16\u7801\u5b58\u5728\u6216\u4e0d\u5b58\u5728\u6982\u5ff5\u7684\u679a\u4e3e\u3002\u8fd9\u4e2a\u679a\u4e3e\u662f <code>Option&lt;T&gt;</code>\uff0c\u800c\u4e14\u5b83\u5b9a\u4e49\u4e8e\u6807\u51c6\u5e93\u4e2d\uff0c\u5982\u4e0b:</p> <pre><code>enum Option&lt;T&gt; {\n    None,\n    Some(T),\n}\n</code></pre> <p><code>&lt;T&gt;</code> \u8bed\u6cd5\u662f\u4e00\u4e2a\u6211\u4eec\u8fd8\u672a\u8bb2\u5230\u7684 Rust \u529f\u80fd\u3002\u5b83\u662f\u4e00\u4e2a\u6cdb\u578b\u7c7b\u578b\u53c2\u6570\uff0c<code>&lt;T&gt;</code> \u610f\u5473\u7740 <code>Option</code> \u679a\u4e3e\u7684 <code>Some</code> \u6210\u5458\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u7c7b\u578b\u7684\u6570\u636e\uff0c\u540c\u65f6\u6bcf\u4e00\u4e2a\u7528\u4e8e <code>T</code> \u4f4d\u7f6e\u7684\u5177\u4f53\u7c7b\u578b\u4f7f\u5f97 <code>Option&lt;T&gt;</code> \u6574\u4f53\u4f5c\u4e3a\u4e0d\u540c\u7684\u7c7b\u578b\u3002\u8fd9\u91cc\u662f\u4e00\u4e9b\u5305\u542b\u6570\u5b57\u7c7b\u578b\u548c\u5b57\u7b26\u4e32\u7c7b\u578b <code>Option</code> \u503c\u7684\u4f8b\u5b50\uff1a</p> <pre><code>    let some_number = Some(5);\n    let some_char = Some('e');\n\n    let absent_number: Option&lt;i32&gt; = None;\n</code></pre> <p><code>some_number</code> \u7684\u7c7b\u578b\u662f <code>Option&lt;i32&gt;</code>\u3002<code>some_char</code> \u7684\u7c7b\u578b\u662f <code>Option&lt;char&gt;</code>\uff0c\u8fd9\uff08\u4e0e <code>some_number</code>\uff09\u662f\u4e00\u4e2a\u4e0d\u540c\u7684\u7c7b\u578b\u3002\u56e0\u4e3a\u6211\u4eec\u5728 <code>Some</code> \u6210\u5458\u4e2d\u6307\u5b9a\u4e86\u503c\uff0cRust \u53ef\u4ee5\u63a8\u65ad\u5176\u7c7b\u578b\u3002\u5bf9\u4e8e <code>absent_number</code>\uff0cRust \u9700\u8981\u6211\u4eec\u6307\u5b9a <code>Option</code> \u6574\u4f53\u7684\u7c7b\u578b\uff0c\u56e0\u4e3a\u7f16\u8bd1\u5668\u53ea\u901a\u8fc7 <code>None</code> \u503c\u65e0\u6cd5\u63a8\u65ad\u51fa <code>Some</code> \u6210\u5458\u4fdd\u5b58\u7684\u503c\u7684\u7c7b\u578b\u3002\u8fd9\u91cc\u6211\u4eec\u544a\u8bc9 Rust \u5e0c\u671b <code>absent_number</code> \u662f <code>Option&lt;i32&gt;</code> \u7c7b\u578b\u7684\u3002</p> <pre><code>    let x: i8 = 5;\n    let y: Option&lt;i8&gt; = Some(5);\n\n    let sum = x + y;\n</code></pre> <p>\u5982\u679c\u8fd0\u884c\u8fd9\u4e9b\u4ee3\u7801\uff0c\u5c06\u5f97\u5230\u7c7b\u4f3c\u8fd9\u6837\u7684\u9519\u8bef\u4fe1\u606f\uff1a</p> <pre><code>$ cargo run\n   Compiling enums v0.1.0 (file:///projects/enums)\nerror[E0277]: cannot add `Option&lt;i8&gt;` to `i8`\n --&gt; src/main.rs:5:17\n  |\n5 |     let sum = x + y;\n  |                 ^ no implementation for `i8 + Option&lt;i8&gt;`\n  |\n  = help: the trait `Add&lt;Option&lt;i8&gt;&gt;` is not implemented for `i8`\n  = help: the following other types implement trait `Add&lt;Rhs&gt;`:\n            &lt;&amp;'a f32 as Add&lt;f32&gt;&gt;\n            &lt;&amp;'a f64 as Add&lt;f64&gt;&gt;\n            &lt;&amp;'a i128 as Add&lt;i128&gt;&gt;\n            &lt;&amp;'a i16 as Add&lt;i16&gt;&gt;\n            &lt;&amp;'a i32 as Add&lt;i32&gt;&gt;\n            &lt;&amp;'a i64 as Add&lt;i64&gt;&gt;\n            &lt;&amp;'a i8 as Add&lt;i8&gt;&gt;\n            &lt;&amp;'a isize as Add&lt;isize&gt;&gt;\n          and 48 others\n\nFor more information about this error, try `rustc --explain E0277`.\nerror: could not compile `enums` due to previous error\n</code></pre> <p>\u5728\u5bf9 <code>Option&lt;T&gt;</code> \u8fdb\u884c\u8fd0\u7b97\u4e4b\u524d\u5fc5\u987b\u5c06\u5176\u8f6c\u6362\u4e3a <code>T</code>\u3002\u901a\u5e38\u8fd9\u80fd\u5e2e\u52a9\u6211\u4eec\u6355\u83b7\u5230\u7a7a\u503c\u6700\u5e38\u89c1\u7684\u95ee\u9898\u4e4b\u4e00\uff1a\u5047\u8bbe\u67d0\u503c\u4e0d\u4e3a\u7a7a\u4f46\u5b9e\u9645\u4e0a\u4e3a\u7a7a\u7684\u60c5\u51b5\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#match","title":"match\u63a7\u5236\u6d41\u7ed3\u6784","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#match_1","title":"match","text":"<p>Rust \u6709\u4e00\u4e2a\u53eb\u505a <code>match</code> \u7684\u6781\u4e3a\u5f3a\u5927\u7684\u63a7\u5236\u6d41\u8fd0\u7b97\u7b26\uff0c\u5b83\u5141\u8bb8\u6211\u4eec\u5c06\u4e00\u4e2a\u503c\u4e0e\u4e00\u7cfb\u5217\u7684\u6a21\u5f0f\u76f8\u6bd4\u8f83\uff0c\u5e76\u6839\u636e\u76f8\u5339\u914d\u7684\u6a21\u5f0f\u6267\u884c\u76f8\u5e94\u4ee3\u7801\u3002</p> <pre><code>enum Coin {\n    Penny,\n    Nickel,\n    Dime,\n    Quarter,\n}\n\nfn value_in_cents(coin: Coin) -&gt; u8 {\n    match coin {\n        Coin::Penny =&gt; 1,\n        Coin::Nickel =&gt; 5,\n        Coin::Dime =&gt; 10,\n        Coin::Quarter =&gt; 25,\n    }\n}\n</code></pre> <p>\u5f53 <code>match</code> \u8868\u8fbe\u5f0f\u6267\u884c\u65f6\uff0c\u5b83\u5c06\u7ed3\u679c\u503c\u6309\u987a\u5e8f\u4e0e\u6bcf\u4e00\u4e2a\u5206\u652f\u7684\u6a21\u5f0f\u76f8\u6bd4\u8f83\u3002\u5982\u679c\u6a21\u5f0f\u5339\u914d\u4e86\u8fd9\u4e2a\u503c\uff0c\u8fd9\u4e2a\u6a21\u5f0f\u76f8\u5173\u8054\u7684\u4ee3\u7801\u5c06\u88ab\u6267\u884c\u3002\u5982\u679c\u6a21\u5f0f\u5e76\u4e0d\u5339\u914d\u8fd9\u4e2a\u503c\uff0c\u5c06\u7ee7\u7eed\u6267\u884c\u4e0b\u4e00\u4e2a\u5206\u652f\uff0c\u975e\u5e38\u7c7b\u4f3c\u4e00\u4e2a\u786c\u5e01\u5206\u7c7b\u5668\u3002\u53ef\u4ee5\u62e5\u6709\u4efb\u610f\u591a\u7684\u5206\u652f\u3002</p> <p>\u6bcf\u4e2a\u5206\u652f\u76f8\u5173\u8054\u7684\u4ee3\u7801\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u800c\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u5c06\u4f5c\u4e3a\u6574\u4e2a <code>match</code> \u8868\u8fbe\u5f0f\u7684\u8fd4\u56de\u503c\u3002</p> <pre><code>fn value_in_cents(coin: Coin) -&gt; u8 {\n    match coin {\n        Coin::Penny =&gt; {\n            println!(\"Lucky penny!\");\n            1\n        }\n        Coin::Nickel =&gt; 5,\n        Coin::Dime =&gt; 10,\n        Coin::Quarter =&gt; 25,\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#_3","title":"\u7ed1\u5b9a\u503c\u7684\u6a21\u5f0f","text":"<p>\u5339\u914d\u5206\u652f\u7684\u53e6\u4e00\u4e2a\u6709\u7528\u7684\u529f\u80fd\u662f\u53ef\u4ee5\u7ed1\u5b9a\u5339\u914d\u7684\u6a21\u5f0f\u7684\u90e8\u5206\u503c\u3002\u8fd9\u4e5f\u5c31\u662f\u5982\u4f55\u4ece\u679a\u4e3e\u6210\u5458\u4e2d\u63d0\u53d6\u503c\u7684\u3002</p> <p>\u4f5c\u4e3a\u4e00\u4e2a\u4f8b\u5b50\uff0c\u8ba9\u6211\u4eec\u4fee\u6539\u679a\u4e3e\u7684\u4e00\u4e2a\u6210\u5458\u6765\u5b58\u653e\u6570\u636e\u30021999 \u5e74\u5230 2008 \u5e74\u95f4\uff0c\u7f8e\u56fd\u5728 25 \u7f8e\u5206\u7684\u786c\u5e01\u7684\u4e00\u4fa7\u4e3a 50 \u4e2a\u5dde\u7684\u6bcf\u4e00\u4e2a\u90fd\u5370\u5237\u4e86\u4e0d\u540c\u7684\u8bbe\u8ba1\u3002\u5176\u4ed6\u7684\u786c\u5e01\u90fd\u6ca1\u6709\u8fd9\u79cd\u533a\u5206\u5dde\u7684\u8bbe\u8ba1\uff0c\u6240\u4ee5\u53ea\u6709\u8fd9\u4e9b 25 \u7f8e\u5206\u786c\u5e01\u6709\u7279\u6b8a\u7684\u4ef7\u503c\u3002\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u4fe1\u606f\u52a0\u5165\u6211\u4eec\u7684 <code>enum</code>\uff0c\u901a\u8fc7\u6539\u53d8 <code>Quarter</code> \u6210\u5458\u6765\u5305\u542b\u4e00\u4e2a <code>State</code> \u503c\uff0c\u793a\u4f8b 6-4 \u4e2d\u5b8c\u6210\u4e86\u8fd9\u4e9b\u4fee\u6539\uff1a</p> <pre><code>#[derive(Debug)] // \u8fd9\u6837\u53ef\u4ee5\u7acb\u523b\u770b\u5230\u5dde\u7684\u540d\u79f0\nenum UsState {\n    Alabama,\n    Alaska,\n    // --snip--\n}\n\nenum Coin {\n    Penny,\n    Nickel,\n    Dime,\n    Quarter(UsState),\n}\n</code></pre> <p>\u60f3\u8c61\u4e00\u4e0b\u6211\u4eec\u7684\u4e00\u4e2a\u670b\u53cb\u5c1d\u8bd5\u6536\u96c6\u6240\u6709 50 \u4e2a\u5dde\u7684 25 \u7f8e\u5206\u786c\u5e01\u3002\u5728\u6839\u636e\u786c\u5e01\u7c7b\u578b\u5206\u7c7b\u96f6\u94b1\u7684\u540c\u65f6\uff0c\u4e5f\u53ef\u4ee5\u62a5\u544a\u51fa\u6bcf\u4e2a 25 \u7f8e\u5206\u786c\u5e01\u6240\u5bf9\u5e94\u7684\u5dde\u540d\u79f0\uff0c\u8fd9\u6837\u5982\u679c\u6211\u4eec\u7684\u670b\u53cb\u6ca1\u6709\u7684\u8bdd\uff0c\u4ed6\u53ef\u4ee5\u5c06\u5176\u52a0\u5165\u6536\u85cf\u3002</p> <p>\u5728\u8fd9\u4e9b\u4ee3\u7801\u7684\u5339\u914d\u8868\u8fbe\u5f0f\u4e2d\uff0c\u6211\u4eec\u5728\u5339\u914d <code>Coin::Quarter</code> \u6210\u5458\u7684\u5206\u652f\u7684\u6a21\u5f0f\u4e2d\u589e\u52a0\u4e86\u4e00\u4e2a\u53eb\u505a <code>state</code> \u7684\u53d8\u91cf\u3002\u5f53\u5339\u914d\u5230 <code>Coin::Quarter</code> \u65f6\uff0c\u53d8\u91cf <code>state</code> \u5c06\u4f1a\u7ed1\u5b9a 25 \u7f8e\u5206\u786c\u5e01\u6240\u5bf9\u5e94\u5dde\u7684\u503c\u3002\u63a5\u7740\u5728\u90a3\u4e2a\u5206\u652f\u7684\u4ee3\u7801\u4e2d\u4f7f\u7528 <code>state</code>\uff0c\u5982\u4e0b\uff1a</p> <pre><code>fn value_in_cents(coin: Coin) -&gt; u8 {\n    match coin {\n        Coin::Penny =&gt; 1,\n        Coin::Nickel =&gt; 5,\n        Coin::Dime =&gt; 10,\n        Coin::Quarter(state) =&gt; {\n            println!(\"State quarter from {:?}!\", state);\n            25\n        }\n    }\n}\n</code></pre> <p>\u5982\u679c\u8c03\u7528 <code>value_in_cents(Coin::Quarter(UsState::Alaska))</code>\uff0c<code>coin</code> \u5c06\u662f <code>Coin::Quarter(UsState::Alaska)</code>\u3002\u5f53\u5c06\u503c\u4e0e\u6bcf\u4e2a\u5206\u652f\u76f8\u6bd4\u8f83\u65f6\uff0c\u6ca1\u6709\u5206\u652f\u4f1a\u5339\u914d\uff0c\u76f4\u5230\u9047\u5230 <code>Coin::Quarter(state)</code>\u3002\u8fd9\u65f6\uff0c<code>state</code> \u7ed1\u5b9a\u7684\u5c06\u4f1a\u662f\u503c <code>UsState::Alaska</code>\u3002\u63a5\u7740\u5c31\u53ef\u4ee5\u5728 <code>println!</code> \u8868\u8fbe\u5f0f\u4e2d\u4f7f\u7528\u8fd9\u4e2a\u7ed1\u5b9a\u4e86\uff0c\u50cf\u8fd9\u6837\u5c31\u53ef\u4ee5\u83b7\u53d6 <code>Coin</code> \u679a\u4e3e\u7684 <code>Quarter</code> \u6210\u5458\u4e2d\u5185\u90e8\u7684\u5dde\u7684\u503c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#option-t","title":"\u5339\u914dOption&lt; T &gt;","text":"<p>\u6bd4\u5982\u6211\u4eec\u60f3\u8981\u7f16\u5199\u4e00\u4e2a\u51fd\u6570\uff0c\u5b83\u83b7\u53d6\u4e00\u4e2a <code>Option&lt;i32&gt;</code> \uff0c\u5982\u679c\u5176\u4e2d\u542b\u6709\u4e00\u4e2a\u503c\uff0c\u5c06\u5176\u52a0\u4e00\u3002\u5982\u679c\u5176\u4e2d\u6ca1\u6709\u503c\uff0c\u51fd\u6570\u5e94\u8be5\u8fd4\u56de <code>None</code> \u503c\uff0c\u800c\u4e0d\u5c1d\u8bd5\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u3002</p> <p>\u5f97\u76ca\u4e8e <code>match</code>\uff0c\u7f16\u5199\u8fd9\u4e2a\u51fd\u6570\u975e\u5e38\u7b80\u5355\uff0c\u5b83\u5c06\u770b\u8d77\u6765\u50cf\u793a\u4f8b 6-5 \u4e2d\u8fd9\u6837\uff1a</p> <pre><code>    fn plus_one(x: Option&lt;i32&gt;) -&gt; Option&lt;i32&gt; {\n        match x {\n            None =&gt; None,\n            Some(i) =&gt; Some(i + 1),\n        }\n    }\n\n    let five = Some(5);\n    let six = plus_one(five);\n    let none = plus_one(None);\n</code></pre> <p>Option\u7c7b\u578b\u662f\u4e00\u79cd\u7528\u4e8e\u8868\u793a\u53ef\u80fd\u5b58\u5728\u7684\u503c\u7684\u679a\u4e3e\u7c7b\u578b\u3002Option\u6709\u4e24\u4e2a\u53ef\u80fd\u7684\u503c\uff1aSome\u548cNone\u3002Some\u5305\u88c5\u4e86\u4e00\u4e2a\u5177\u4f53\u7684\u503c\uff0c\u8868\u793a\u5b58\u5728\u67d0\u4e2a\u503c\uff0c\u800cNone\u8868\u793a\u4e0d\u5b58\u5728\u503c\u3002</p> <p>\u4f7f\u7528Option\u7c7b\u578b\u7684\u4e00\u4e9b\u5e38\u89c1\u64cd\u4f5c\uff1a</p> <ol> <li> <p>\u521b\u5efaOption\u503c\uff1a <pre><code>let some_value: Option&lt;i32&gt; = Some(5);  // \u4f7f\u7528Some\u5305\u88c5\u5177\u4f53\u7684\u503c\nlet none_value: Option&lt;i32&gt; = None;     // \u4f7f\u7528None\u8868\u793a\u4e0d\u5b58\u5728\u503c\n</code></pre></p> </li> <li> <p>\u89e3\u5305Option\u503c\uff1a <pre><code>let some_value: Option&lt;i32&gt; = Some(5);\nlet unwrapped_value: i32 = some_value.unwrap();  // \u89e3\u5305Some\u503c\uff0c\u5982\u679c\u662fNone\u4f1a\u5bfc\u81f4panic\n\nlet none_value: Option&lt;i32&gt; = None;\nlet unwrapped_value: i32 = none_value.unwrap();  // \u89e3\u5305None\u503c\u4f1a\u5bfc\u81f4panic\n</code></pre> \u5982\u679c\u4f60\u786e\u5b9aOption\u503c\u4e00\u5b9a\u5305\u542b\u5177\u4f53\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528unwrap\u65b9\u6cd5\u89e3\u5305\u3002\u4f46\u662f\u5982\u679cOption\u503c\u662fNone\uff0c\u89e3\u5305\u4f1a\u5bfc\u81f4panic\u3002\u56e0\u6b64\uff0c\u5728\u89e3\u5305\u4e4b\u524d\u6700\u597d\u4f7f\u7528match\u6216\u8005if let\u8fdb\u884c\u5224\u65ad\u3002</p> </li> <li> <p>\u4f7f\u7528match\u5339\u914dOption\u503c\uff1a <pre><code>let some_value: Option&lt;i32&gt; = Some(5);\nmatch some_value {\n    Some(value) =&gt; println!(\"Value is {}\", value),\n    None =&gt; println!(\"No value\"),\n}\n\nlet none_value: Option&lt;i32&gt; = None;\nmatch none_value {\n    Some(value) =&gt; println!(\"Value is {}\", value),\n    None =&gt; println!(\"No value\"),\n}\n</code></pre></p> </li> <li> <p>\u4f7f\u7528if let\u5224\u65adOption\u503c\uff1a <pre><code>let some_value: Option&lt;i32&gt; = Some(5);\nif let Some(value) = some_value {\n    println!(\"Value is {}\", value);\n} else {\n    println!(\"No value\");\n}\n\nlet none_value: Option&lt;i32&gt; = None;\nif let Some(value) = none_value {\n    println!(\"Value is {}\", value);\n} else {\n    println!(\"No value\");\n}\n</code></pre></p> </li> </ol>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#some-t","title":"\u5339\u914dSome&lt; T &gt;","text":"<p><code>Some</code>\u662f\u4e00\u79cd<code>Option</code>\u679a\u4e3e\u7684\u53d8\u4f53\uff0c\u5b83\u8868\u793a\u4e00\u4e2a\u975e\u7a7a\u7684\u503c\u3002<code>Option</code>\u7c7b\u578b\u7528\u4e8e\u5904\u7406\u53ef\u80fd\u4e0d\u5b58\u5728\u7684\u503c\uff0c\u5b83\u6709\u4e24\u4e2a\u53d8\u4f53\uff1a<code>Some</code>\u548c<code>None</code>\u3002</p> <p>\u5728\u4f7f\u7528<code>Option</code>\u7c7b\u578b\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528<code>Some</code>\u5c06\u4e00\u4e2a\u503c\u5305\u88c5\u5230<code>Option</code>\u4e2d\uff0c\u8868\u793a\u8be5\u503c\u5b58\u5728\u3002\u4f8b\u5982\uff1a</p> <pre><code>let some_value: Option&lt;i32&gt; = Some(5);\n</code></pre> <p><code>some_value</code>\u662f\u4e00\u4e2a<code>Option&lt;i32&gt;</code>\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u901a\u8fc7<code>Some(5)</code>\u5c06\u503c<code>5</code>\u5305\u88c5\u5230<code>Option</code>\u4e2d\u3002\u8fd9\u8868\u793a<code>some_value</code>\u662f\u4e00\u4e2a\u975e\u7a7a\u7684\u503c\u3002</p> <p>\u7136\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528\u6a21\u5f0f\u5339\u914d\u6216<code>unwrap</code>\u65b9\u6cd5\u6765\u83b7\u53d6<code>Some</code>\u4e2d\u7684\u503c\u3002\u4f8b\u5982\uff1a</p> <pre><code>match some_value {\n    Some(value) =&gt; println!(\"Value is {}\", value),\n    None =&gt; println!(\"Value is None\"),\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u4f7f\u7528\u6a21\u5f0f\u5339\u914d\u6765\u68c0\u67e5<code>some_value</code>\u7684\u53d8\u4f53\u3002\u5982\u679c\u662f<code>Some</code>\uff0c\u5219\u5c06<code>value</code>\u7ed1\u5b9a\u5230\u5176\u4e2d\u7684\u503c\uff0c\u5e76\u6253\u5370\u51fa\u6765\u3002\u5982\u679c\u662f<code>None</code>\uff0c\u5219\u6253\u5370\u51fa<code>Value is None</code>\u3002</p> <p>\u8ba9\u6211\u4eec\u66f4\u4ed4\u7ec6\u5730\u68c0\u67e5 <code>plus_one</code> \u7684\u7b2c\u4e00\u884c\u64cd\u4f5c\u3002\u5f53\u8c03\u7528 <code>plus_one(five)</code> \u65f6\uff0c<code>plus_one</code> \u51fd\u6570\u4f53\u4e2d\u7684 <code>x</code> \u5c06\u4f1a\u662f\u503c <code>Some(5)</code>\u3002\u63a5\u7740\u5c06\u5176\u4e0e\u6bcf\u4e2a\u5206\u652f\u6bd4\u8f83\u3002</p> <pre><code>            None =&gt; None,\n</code></pre> <p>\u503c <code>Some(5)</code> \u5e76\u4e0d\u5339\u914d\u6a21\u5f0f <code>None</code>\uff0c\u6240\u4ee5\u7ee7\u7eed\u8fdb\u884c\u4e0b\u4e00\u4e2a\u5206\u652f\u3002</p> <pre><code>            Some(i) =&gt; Some(i + 1),\n</code></pre> <p><code>Some(5)</code> \u4e0e <code>Some(i)</code> \u5339\u914d\u5417\uff1f\u5f53\u7136\u5339\u914d\uff01\u5b83\u4eec\u662f\u76f8\u540c\u7684\u6210\u5458\u3002<code>i</code> \u7ed1\u5b9a\u4e86 <code>Some</code> \u4e2d\u5305\u542b\u7684\u503c\uff0c\u6240\u4ee5 <code>i</code> \u7684\u503c\u662f <code>5</code>\u3002\u63a5\u7740\u5339\u914d\u5206\u652f\u7684\u4ee3\u7801\u88ab\u6267\u884c\uff0c\u6240\u4ee5\u6211\u4eec\u5c06 <code>i</code> \u7684\u503c\u52a0\u4e00\u5e76\u8fd4\u56de\u4e00\u4e2a\u542b\u6709\u503c <code>6</code> \u7684\u65b0 <code>Some</code>\u3002</p> <p>\u63a5\u7740\u8003\u8651\u4e0b\u793a\u4f8b 6-5 \u4e2d <code>plus_one</code> \u7684\u7b2c\u4e8c\u4e2a\u8c03\u7528\uff0c\u8fd9\u91cc <code>x</code> \u662f <code>None</code>\u3002\u6211\u4eec\u8fdb\u5165 <code>match</code> \u5e76\u4e0e\u7b2c\u4e00\u4e2a\u5206\u652f\u76f8\u6bd4\u8f83\u3002</p> <pre><code>            None =&gt; None,\n</code></pre> <p>\u5339\u914d\u4e0a\u4e86\uff01\u8fd9\u91cc\u6ca1\u6709\u503c\u6765\u52a0\u4e00\uff0c\u6240\u4ee5\u7a0b\u5e8f\u7ed3\u675f\u5e76\u8fd4\u56de =&gt; \u53f3\u4fa7\u7684\u503c <code>None</code>\uff0c\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u5206\u652f\u5c31\u5339\u914d\u5230\u4e86\uff0c\u5176\u4ed6\u7684\u5206\u652f\u5c06\u4e0d\u518d\u6bd4\u8f83\u3002</p> <p>\u5c06 <code>match</code> \u4e0e\u679a\u4e3e\u76f8\u7ed3\u5408\u5728\u5f88\u591a\u573a\u666f\u4e2d\u90fd\u662f\u6709\u7528\u7684\u3002\u4f60\u4f1a\u5728 Rust \u4ee3\u7801\u4e2d\u770b\u5230\u5f88\u591a\u8fd9\u6837\u7684\u6a21\u5f0f\uff1a<code>match</code> \u4e00\u4e2a\u679a\u4e3e\uff0c\u7ed1\u5b9a\u5176\u4e2d\u7684\u503c\u5230\u4e00\u4e2a\u53d8\u91cf\uff0c\u63a5\u7740\u6839\u636e\u5176\u503c\u6267\u884c\u4ee3\u7801\u3002</p> <p>ref</p> <p><code>Some(ref xx)</code>\u662f\u4e00\u79cd\u6784\u9020\u65b9\u5f0f\uff0c\u7528\u4e8e\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5f15\u7528\u7684<code>Option</code>\u679a\u4e3e\u7684<code>Some</code>\u53d8\u4f53\u3002<code>Option</code>\u662fRust\u4e2d\u7684\u4e00\u4e2a\u679a\u4e3e\u7c7b\u578b\uff0c\u7528\u4e8e\u8868\u793a\u4e00\u4e2a\u53ef\u80fd\u5b58\u5728\u6216\u53ef\u80fd\u4e0d\u5b58\u5728\u7684\u503c\u3002</p> <p><code>Some(ref xx)</code>\u8868\u793a\u4e00\u4e2a\u5b58\u5728\u7684\u503c\uff0c\u5e76\u4e14\u5b83\u662f\u901a\u8fc7\u5f15\u7528\u65b9\u5f0f\u4f20\u9012\u7684\u3002\u8fd9\u610f\u5473\u7740\u5b83\u4e0d\u4f1a\u62e5\u6709\u6240\u5f15\u7528\u7684\u503c\uff0c\u53ea\u662f\u6301\u6709\u4e86\u4e00\u4e2a\u5bf9\u8be5\u503c\u7684\u5f15\u7528\u3002\u8fd9\u901a\u5e38\u7528\u4e8e\u907f\u514d\u6240\u6709\u6743\u8f6c\u79fb\u7684\u60c5\u51b5\uff0c\u540c\u65f6\u5141\u8bb8\u4f60\u5728\u4ee3\u7801\u7684\u4e0d\u540c\u90e8\u5206\u5171\u4eab\u5bf9\u540c\u4e00\u503c\u7684\u5f15\u7528\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\uff0c\u5c55\u793a\u5982\u4f55\u4f7f\u7528<code>Some(ref xx)</code>\u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5f15\u7528\u7684<code>Option</code>\uff1a</p> <pre><code>fn main() {\n    let value = 42;\n    let option_value = Some(&amp;value); // \u521b\u5efa\u4e00\u4e2a\u5305\u542b\u5bf9value\u7684\u5f15\u7528\u7684Some\n\n    match option_value {\n        Some(ref x) =&gt; println!(\"Value: {}\", x), // \u901a\u8fc7\u5f15\u7528\u83b7\u53d6\u503c\n        None =&gt; println!(\"No value\"),\n    }\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u793a\u4f8b\u4e2d\uff0c<code>option_value</code>\u7531<code>Some(ref x)</code>\u521b\u5efa\uff0c\u5176\u4e2d<code>x</code>\u662f\u5bf9<code>value</code>\u7684\u5f15\u7528\u3002\u5728<code>match</code>\u8868\u8fbe\u5f0f\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>ref x</code>\u6765\u83b7\u53d6\u5bf9<code>value</code>\u7684\u5f15\u7528\uff0c\u5e76\u6253\u5370\u51fa\u5b83\u7684\u503c\u3002</p> <p>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c<code>Some(ref xx)</code>\u53ea\u9002\u7528\u4e8e\u5f15\u7528\u7c7b\u578b\uff0c\u5bf9\u4e8e\u62e5\u6709\u6240\u6709\u6743\u7684\u7c7b\u578b\uff0c\u5e94\u8be5\u4f7f\u7528<code>Some(xx)</code>\uff0c\u5176\u4e2d<code>xx</code>\u662f\u503c\u672c\u8eab\uff0c\u800c\u4e0d\u662f\u5f15\u7528\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#_4","title":"\u5339\u914d\u662f\u7a77\u5c3d\u7684","text":"<p><code>match</code> \u8fd8\u6709\u53e6\u4e00\u65b9\u9762\u9700\u8981\u8ba8\u8bba\uff1a\u8fd9\u4e9b\u5206\u652f\u5fc5\u987b\u8986\u76d6\u4e86\u6240\u6709\u7684\u53ef\u80fd\u6027\u3002\u8003\u8651\u4e00\u4e0b <code>plus_one</code> \u51fd\u6570\u7684\u8fd9\u4e2a\u7248\u672c\uff0c\u5b83\u6709\u4e00\u4e2a bug \u5e76\u4e0d\u80fd\u7f16\u8bd1\uff1a</p> <pre><code>    fn plus_one(x: Option&lt;i32&gt;) -&gt; Option&lt;i32&gt; {\n        match x {\n            Some(i) =&gt; Some(i + 1),\n        }\n    }\n\n    let five = Some(5);\n    let six = plus_one(five);\n    let none = plus_one(None);\n</code></pre> <p>Rust \u4e2d\u7684\u5339\u914d\u662f \u7a77\u5c3d\u7684\uff08exhaustive\uff09\uff1a\u5fc5\u987b\u7a77\u4e3e\u5230\u6700\u540e\u7684\u53ef\u80fd\u6027\u6765\u4f7f\u4ee3\u7801\u6709\u6548\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#_","title":"\u901a\u914d\u6a21\u5f0f\u548c _ \u5360\u4f4d\u7b26","text":"<p>\u6211\u4eec\u5e0c\u671b\u5bf9\u4e00\u4e9b\u7279\u5b9a\u7684\u503c\u91c7\u53d6\u7279\u6b8a\u64cd\u4f5c\uff0c\u800c\u5bf9\u5176\u4ed6\u7684\u503c\u91c7\u53d6\u9ed8\u8ba4\u64cd\u4f5c\u3002\u60f3\u8c61\u6211\u4eec\u6b63\u5728\u73a9\u4e00\u4e2a\u6e38\u620f\uff0c\u5982\u679c\u4f60\u63b7\u51fa\u9ab0\u5b50\u7684\u503c\u4e3a 3\uff0c\u89d2\u8272\u4e0d\u4f1a\u79fb\u52a8\uff0c\u800c\u662f\u4f1a\u5f97\u5230\u4e00\u9876\u65b0\u5947\u7684\u5e3d\u5b50\u3002\u5982\u679c\u4f60\u63b7\u51fa\u4e86 7\uff0c\u4f60\u7684\u89d2\u8272\u5c06\u5931\u53bb\u65b0\u5947\u7684\u5e3d\u5b50\u3002\u5bf9\u4e8e\u5176\u4ed6\u7684\u6570\u503c\uff0c\u4f60\u7684\u89d2\u8272\u4f1a\u5728\u68cb\u76d8\u4e0a\u79fb\u52a8\u76f8\u5e94\u7684\u683c\u5b50\u3002\u8fd9\u662f\u4e00\u4e2a\u5b9e\u73b0\u4e86\u4e0a\u8ff0\u903b\u8f91\u7684 <code>match</code>\uff0c\u9ab0\u5b50\u7684\u7ed3\u679c\u662f\u786c\u7f16\u7801\u800c\u4e0d\u662f\u4e00\u4e2a\u968f\u673a\u503c\uff0c\u5176\u4ed6\u7684\u903b\u8f91\u90e8\u5206\u4f7f\u7528\u4e86\u6ca1\u6709\u51fd\u6570\u4f53\u7684\u51fd\u6570\u6765\u8868\u793a\uff0c\u5b9e\u73b0\u5b83\u4eec\u8d85\u51fa\u4e86\u672c\u4f8b\u7684\u8303\u56f4\uff1a</p> <pre><code>    let dice_roll = 9;\n    match dice_roll {\n        3 =&gt; add_fancy_hat(),\n        7 =&gt; remove_fancy_hat(),\n        other =&gt; move_player(other),\n    }\n\n    fn add_fancy_hat() {}\n    fn remove_fancy_hat() {}\n    fn move_player(num_spaces: u8) {}\n</code></pre> <p>\u6211\u4eec\u5fc5\u987b\u5c06\u901a\u914d\u5206\u652f\u653e\u5728\u6700\u540e\uff0c\u56e0\u4e3a\u6a21\u5f0f\u662f\u6309\u987a\u5e8f\u5339\u914d\u7684\u3002</p> <p>Rust \u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6a21\u5f0f\uff0c\u5f53\u6211\u4eec\u4e0d\u60f3\u4f7f\u7528\u901a\u914d\u6a21\u5f0f\u83b7\u53d6\u7684\u503c\u65f6\uff0c\u8bf7\u4f7f\u7528 <code>_</code> \uff0c\u8fd9\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u6a21\u5f0f\uff0c\u53ef\u4ee5\u5339\u914d\u4efb\u610f\u503c\u800c\u4e0d\u7ed1\u5b9a\u5230\u8be5\u503c\u3002\u8fd9\u544a\u8bc9 Rust \u6211\u4eec\u4e0d\u4f1a\u4f7f\u7528\u8fd9\u4e2a\u503c\uff0c\u6240\u4ee5 Rust \u4e5f\u4e0d\u4f1a\u8b66\u544a\u6211\u4eec\u5b58\u5728\u672a\u4f7f\u7528\u7684\u53d8\u91cf\u3002</p> <pre><code>    let dice_roll = 9;\n    match dice_roll {\n        3 =&gt; add_fancy_hat(),\n        7 =&gt; remove_fancy_hat(),\n        _ =&gt; reroll(),\n    }\n\n    fn add_fancy_hat() {}\n    fn remove_fancy_hat() {}\n    fn reroll() {}\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5355\u5143\u503c\uff08\u5728\u201c\u5143\u7ec4\u7c7b\u578b\u201d\u4e00\u8282\u4e2d\u63d0\u5230\u7684\u7a7a\u5143\u7ec4\uff09\u4f5c\u4e3a <code>_</code> \u5206\u652f\u7684\u4ee3\u7801\uff1a</p> <pre><code>    let dice_roll = 9;\n    match dice_roll {\n        3 =&gt; add_fancy_hat(),\n        7 =&gt; remove_fancy_hat(),\n        _ =&gt; (),\n    }\n\n    fn add_fancy_hat() {}\n    fn remove_fancy_hat() {}\n</code></pre> <p>\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u660e\u786e\u544a\u8bc9 Rust \u6211\u4eec\u4e0d\u4f1a\u4f7f\u7528\u4e0e\u524d\u9762\u6a21\u5f0f\u4e0d\u5339\u914d\u7684\u503c\uff0c\u5e76\u4e14\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6211\u4eec\u4e0d\u60f3\u8fd0\u884c\u4efb\u4f55\u4ee3\u7801\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/4.%E6%9E%9A%E4%B8%BE%E5%92%8C%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D/#if-let","title":"if let \u7b80\u6d01\u63a7\u5236\u6d41","text":"<p><code>if let</code>\u662f\u4e00\u79cd\u7b80\u6d01\u7684\u8bed\u6cd5\uff0c\u7528\u4e8e\u5728\u5339\u914d\u67d0\u4e2a\u6a21\u5f0f\u65f6\u6267\u884c\u4ee3\u7801\u3002\u5b83\u53ef\u4ee5\u7528\u4f5c\u66ff\u4ee3<code>match</code>\u8868\u8fbe\u5f0f\u7684\u4e00\u79cd\u65b9\u5f0f\uff0c\u5c24\u5176\u9002\u7528\u4e8e\u53ea\u5173\u5fc3\u4e00\u79cd\u6a21\u5f0f\u7684\u60c5\u51b5\u3002</p> <p>\u4e0b\u9762\u662f<code>if let</code>\u7684\u57fa\u672c\u8bed\u6cd5\uff1a</p> <pre><code>if let &lt;pattern&gt; = &lt;expression&gt; {\n    // \u5339\u914d\u6210\u529f\u65f6\u6267\u884c\u7684\u4ee3\u7801\n} else {\n    // \u5339\u914d\u5931\u8d25\u65f6\u6267\u884c\u7684\u4ee3\u7801\n}\n</code></pre> <p><code>&lt;pattern&gt;</code>\u662f\u8981\u5339\u914d\u7684\u6a21\u5f0f\uff0c\u4f8b\u5982\u53d8\u91cf\u3001\u5143\u7ec4\u3001\u7ed3\u6784\u4f53\u7b49\u3002<code>&lt;expression&gt;</code>\u662f\u8981\u5339\u914d\u7684\u8868\u8fbe\u5f0f\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u6f14\u793a\u4e86\u5982\u4f55\u4f7f\u7528<code>if let</code>\u6765\u5904\u7406<code>Option</code>\u7c7b\u578b\uff1a</p> <pre><code>fn main() {\n    let some_value: Option&lt;i32&gt; = Some(5);\n\n    if let Some(x) = some_value {\n        println!(\"Got value: {}\", x);\n    } else {\n        println!(\"No value\");\n    }\n}\n</code></pre> <p>\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c<code>if let</code>\u7528\u4e8e\u5339\u914d<code>some_value</code>\u662f\u5426\u662f<code>Some</code>\uff0c\u5982\u679c\u662f\uff0c\u5c31\u5c06<code>x</code>\u7ed1\u5b9a\u4e3a<code>some_value</code>\u4e2d\u7684\u503c\uff0c\u5e76\u6267\u884c<code>println!</code>\u8bed\u53e5\u3002\u5982\u679c<code>some_value</code>\u662f<code>None</code>\uff0c\u5219\u6267\u884c<code>else</code>\u5757\u4e2d\u7684\u4ee3\u7801\u3002</p> <p>\u4f7f\u7528<code>if let</code>\u53ef\u4ee5\u4f7f\u4ee3\u7801\u66f4\u7b80\u6d01\u548c\u6613\u8bfb\uff0c\u7279\u522b\u662f\u5f53\u53ea\u5173\u5fc3\u67d0\u4e2a\u6a21\u5f0f\u7684\u60c5\u51b5\u4e0b\u3002</p> <pre><code>    let v = Some(4);\n    match v {\n        Some(3) =&gt; println!(\"three\"),\n        _ =&gt; ()\n    }\n\n\n    if let Some(3) = v {\n        println!(\"three\");\n    }\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u6548\u679c\u4e0e\u4e0b\u9762\u4ee3\u7801\u6548\u679c\u76f8\u540c</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/","title":"\u5e38\u89c1\u96c6\u5408","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#vec","title":"Vec","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#vector","title":"\u65b0\u5efa vector","text":"<pre><code>    let v: Vec&lt;i32&gt; = Vec::new();\n</code></pre> <pre><code>    let v = vec![1, 2, 3];\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#vector_1","title":"\u66f4\u65b0 vector","text":"<pre><code>    let mut v = Vec::new();\n\n    v.push(5);\n    v.push(6);\n    v.push(7);\n    v.push(8);\n</code></pre> <p>\u5982\u679c\u60f3\u8981\u80fd\u591f\u6539\u53d8\u5b83\u7684\u503c\uff0c\u5fc5\u987b\u4f7f\u7528 <code>mut</code> \u5173\u952e\u5b57\u4f7f\u5176\u53ef\u53d8\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#vector_2","title":"\u8bfb\u53d6 vector \u7684\u5143\u7d20","text":"<p><pre><code>    let v = vec![1, 2, 3, 4, 5];\n\n    let third: &amp;i32 = &amp;v[2]; // \u4f7f\u7528\u7d22\u5f15\n    println!(\"The third element is {third}\"); // \u4f7f\u7528get\u65b9\u6cd5\n\n    let third: Option&lt;&amp;i32&gt; = v.get(2);\n    match third {\n        Some(third) =&gt; println!(\"The third element is {third}\"),\n        None =&gt; println!(\"There is no third element.\"),\n    }\n</code></pre> \u4f7f\u7528 <code>&amp;</code> \u548c <code>[]</code> \u4f1a\u5f97\u5230\u4e00\u4e2a\u7d22\u5f15\u4f4d\u7f6e\u5143\u7d20\u7684\u5f15\u7528\u3002\u5f53\u4f7f\u7528\u7d22\u5f15\u4f5c\u4e3a\u53c2\u6570\u8c03\u7528 <code>get</code> \u65b9\u6cd5\u65f6\uff0c\u4f1a\u5f97\u5230\u4e00\u4e2a\u53ef\u4ee5\u7528\u4e8e <code>match</code> \u7684 <code>Option&lt;&amp;T&gt;</code>\u3002</p> <p><pre><code>    let mut v = vec![1, 2, 3, 4, 5];\n\n    let first = &amp;v[0]; // \u5f15\u7528\n\n    v.push(6); // \u9519\u8bef\uff01\n\n    println!(\"The first element is: {first}\");\n</code></pre> \u5728 vector \u7684\u7ed3\u5c3e\u589e\u52a0\u65b0\u5143\u7d20\u65f6\uff0c\u5728\u6ca1\u6709\u8db3\u591f\u7a7a\u95f4\u5c06\u6240\u6709\u5143\u7d20\u4f9d\u6b21\u76f8\u90bb\u5b58\u653e\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u80fd\u4f1a\u8981\u6c42\u5206\u914d\u65b0\u5185\u5b58\u5e76\u5c06\u8001\u7684\u5143\u7d20\u62f7\u8d1d\u5230\u65b0\u7684\u7a7a\u95f4\u4e2d\u3002\u8fd9\u65f6\uff0c\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u5f15\u7528\u5c31\u6307\u5411\u4e86\u88ab\u91ca\u653e\u7684\u5185\u5b58\u3002\u501f\u7528\u89c4\u5219\u963b\u6b62\u7a0b\u5e8f\u9677\u5165\u8fd9\u79cd\u72b6\u51b5\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#vector_3","title":"\u904d\u5386 vector","text":"<pre><code>    let v = vec![100, 32, 57];\n    for i in &amp;v {\n        println!(\"{i}\");\n    }\n</code></pre> <p><pre><code>    let mut v = vec![100, 32, 57];\n    for i in &amp;mut v {\n        *i += 50;\n    }\n</code></pre> \u4e3a\u4e86\u4fee\u6539\u53ef\u53d8\u5f15\u7528\u6240\u6307\u5411\u7684\u503c\uff0c\u5728\u4f7f\u7528 <code>+=</code> \u8fd0\u7b97\u7b26\u4e4b\u524d\u5fc5\u987b\u4f7f\u7528\u89e3\u5f15\u7528\u8fd0\u7b97\u7b26\uff08<code>*</code>\uff09\u83b7\u53d6 <code>i</code> \u4e2d\u7684\u503c\u3002</p> <p>\u56e0\u4e3a\u501f\u7528\u68c0\u67e5\u5668\u7684\u89c4\u5219\uff0c\u65e0\u8bba\u53ef\u53d8\u8fd8\u662f\u4e0d\u53ef\u53d8\u5730\u904d\u5386\u4e00\u4e2a vector \u90fd\u662f\u5b89\u5168\u7684\u3002 \u4f46\u662f\u5982\u679c\u60f3\u5728<code>for</code>\u5faa\u73af\u65f6\u63d2\u5165\u5143\u7d20\uff0c\u5219\u4f1a\u4ea7\u751f\u9519\u8bef</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#_2","title":"\u4f7f\u7528\u679a\u4e3e\u6765\u5b58\u50a8\u591a\u79cd\u7c7b\u578b","text":"<pre><code>    enum SpreadsheetCell {\n        Int(i32),\n        Float(f64),\n        Text(String),\n    }\n\n    let row = vec![\n        SpreadsheetCell::Int(3),\n        SpreadsheetCell::Text(String::from(\"blue\")),\n        SpreadsheetCell::Float(10.12),\n    ];\n</code></pre> <p>\u5982\u679c\u5728\u7f16\u5199\u7a0b\u5e8f\u65f6\u4e0d\u80fd\u786e\u5207\u65e0\u9057\u5730\u77e5\u9053\u8fd0\u884c\u65f6\u4f1a\u50a8\u5b58\u8fdb vector \u7684\u6240\u6709\u7c7b\u578b\uff0c\u679a\u4e3e\u6280\u672f\u5c31\u884c\u4e0d\u901a\u4e86\u3002</p> <p>\u4e22\u5f03 vector \u65f6\u4e5f\u4f1a\u4e22\u5f03\u5176\u6240\u6709\u5143\u7d20</p> <pre><code>    {\n        let v = vec![1, 2, 3, 4];\n\n        // do stuff with v\n    } // &lt;- v goes out of scope and is freed here\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#string","title":"String","text":"<p>Rust \u7684\u6838\u5fc3\u8bed\u8a00\u4e2d\u53ea\u6709\u4e00\u79cd\u5b57\u7b26\u4e32\u7c7b\u578b\uff1a\u5b57\u7b26\u4e32 slice <code>str</code>\uff0c\u5b83\u901a\u5e38\u4ee5\u88ab\u501f\u7528\u7684\u5f62\u5f0f\u51fa\u73b0\uff0c<code>&amp;str</code>\u3002\u7531\u4e8e\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u88ab\u50a8\u5b58\u5728\u7a0b\u5e8f\u7684\u4e8c\u8fdb\u5236\u8f93\u51fa\u4e2d\uff0c\u56e0\u6b64\u5b57\u7b26\u4e32\u5b57\u9762\u503c\u4e5f\u662f\u5b57\u7b26\u4e32 slices\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#_3","title":"\u65b0\u5efa\u5b57\u7b26\u4e32","text":"<p>\u5f88\u591a <code>Vec</code> \u53ef\u7528\u7684\u64cd\u4f5c\u5728 <code>String</code> \u4e2d\u540c\u6837\u53ef\u7528\uff0c\u4e8b\u5b9e\u4e0a <code>String</code> \u88ab\u5b9e\u73b0\u4e3a\u4e00\u4e2a\u5e26\u6709\u4e00\u4e9b\u989d\u5916\u4fdd\u8bc1\u3001\u9650\u5236\u548c\u529f\u80fd\u7684\u5b57\u8282 vector \u7684\u5c01\u88c5\u3002\u5176\u4e2d\u4e00\u4e2a\u540c\u6837\u4f5c\u7528\u4e8e <code>Vec&lt;T&gt;</code> \u548c <code>String</code> \u51fd\u6570\u7684\u4f8b\u5b50\u662f\u7528\u6765\u65b0\u5efa\u4e00\u4e2a\u5b9e\u4f8b\u7684 <code>new</code> \u51fd\u6570</p> <pre><code>    let mut s = String::new();\n</code></pre> <pre><code>    let data = \"initial contents\";\n\n    let s = data.to_string();\n\n    // \u8be5\u65b9\u6cd5\u4e5f\u53ef\u76f4\u63a5\u7528\u4e8e\u5b57\u7b26\u4e32\u5b57\u9762\u503c\uff1a\n    let s = \"initial contents\".to_string();\n</code></pre> <pre><code>    let s = String::from(\"initial contents\"); // \u7b49\u540c\u4e8eto_string\n</code></pre> <p>\u5b57\u7b26\u4e32\u662f UTF-8 \u7f16\u7801\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u53ef\u4ee5\u6b63\u786e\u7f16\u7801\u7684\u6570\u636e</p> <pre><code>    let hello = String::from(\"\u0627\u0644\u0633\u0644\u0627\u0645 \u0639\u0644\u064a\u0643\u0645\");\n    let hello = String::from(\"Dobr\u00fd den\");\n    let hello = String::from(\"Hello\");\n    let hello = String::from(\"\u05e9\u05b8\u05c1\u05dc\u05d5\u05b9\u05dd\");\n    let hello = String::from(\"\u0928\u092e\u0938\u094d\u0924\u0947\");\n    let hello = String::from(\"\u3053\u3093\u306b\u3061\u306f\");\n    let hello = String::from(\"\uc548\ub155\ud558\uc138\uc694\");\n    let hello = String::from(\"\u4f60\u597d\");\n    let hello = String::from(\"Ol\u00e1\");\n    let hello = String::from(\"\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435\");\n    let hello = String::from(\"Hola\");\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#_4","title":"\u66f4\u65b0\u5b57\u7b26\u4e32","text":"<p>\u4f7f\u7528<code>push_str</code>\u548c<code>push</code>\u9644\u52a0\u5b57\u7b26\u4e32</p> <p>\u53ef\u4ee5\u901a\u8fc7 <code>push_str</code> \u65b9\u6cd5\u6765\u9644\u52a0\u5b57\u7b26\u4e32 slice\uff0c\u4ece\u800c\u4f7f <code>String</code> \u53d8\u957f\uff0c\u5982\u793a\u4f8b\u6240\u793a\u3002</p> <pre><code>    let mut s = String::from(\"foo\");\n    s.push_str(\"bar\");\n</code></pre> <p>\u6267\u884c\u8fd9\u4e24\u884c\u4ee3\u7801\u4e4b\u540e\uff0c<code>s</code> \u5c06\u4f1a\u5305\u542b <code>foobar</code>\u3002<code>push_str</code> \u65b9\u6cd5\u91c7\u7528\u5b57\u7b26\u4e32 slice\uff0c\u56e0\u4e3a\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u83b7\u53d6\u53c2\u6570\u7684\u6240\u6709\u6743\u3002\u4f8b\u5982\uff0c\u793a\u4f8b\u4e2d\u6211\u4eec\u5e0c\u671b\u5728\u5c06 <code>s2</code> \u7684\u5185\u5bb9\u9644\u52a0\u5230 <code>s1</code> \u4e4b\u540e\u8fd8\u80fd\u4f7f\u7528\u5b83\u3002</p> <pre><code>    let mut s1 = String::from(\"foo\");\n    let s2 = \"bar\";\n    s1.push_str(s2);\n    println!(\"s2 is {s2}\");\n</code></pre> <p>\u5982\u679c <code>push_str</code> \u65b9\u6cd5\u83b7\u53d6\u4e86 <code>s2</code> \u7684\u6240\u6709\u6743\uff0c\u5c31\u4e0d\u80fd\u5728\u6700\u540e\u4e00\u884c\u6253\u5370\u51fa\u5176\u503c\u4e86\u3002\u597d\u5728\u4ee3\u7801\u5982\u6211\u4eec\u671f\u671b\u90a3\u6837\u5de5\u4f5c\uff01</p> <p><code>push</code> \u65b9\u6cd5\u88ab\u5b9a\u4e49\u4e3a\u83b7\u53d6\u4e00\u4e2a\u5355\u72ec\u7684\u5b57\u7b26\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u9644\u52a0\u5230 <code>String</code> \u4e2d\u3002\u793a\u4f8b\u5c55\u793a\u4e86\u4f7f\u7528 <code>push</code> \u65b9\u6cd5\u5c06\u5b57\u6bcd \"l\" \u52a0\u5165 <code>String</code> \u7684\u4ee3\u7801\u3002</p> <pre><code>    let mut s = String::from(\"lo\");\n    s.push('l');\n</code></pre> <p>\u6267\u884c\u8fd9\u4e9b\u4ee3\u7801\u4e4b\u540e\uff0c<code>s</code> \u5c06\u4f1a\u5305\u542b \u201clol\u201d\u3002</p> <p>\u4f7f\u7528 + \u8fd0\u7b97\u7b26\u6216 format! \u5b8f\u62fc\u63a5\u5b57\u7b26\u4e32</p> <pre><code>    let s1 = String::from(\"Hello, \");\n    let s2 = String::from(\"world!\");\n    let s3 = s1 + &amp;s2; // \u6ce8\u610f s1 \u88ab\u79fb\u52a8\u4e86\uff0c\u4e0d\u80fd\u7ee7\u7eed\u4f7f\u7528\n</code></pre> <p>\u5b57\u7b26\u4e32 <code>s3</code> \u5c06\u4f1a\u5305\u542b <code>Hello, world!</code>\u3002</p> <p><code>s1</code> \u5728\u76f8\u52a0\u540e\u4e0d\u518d\u6709\u6548\u7684\u539f\u56e0\uff0c\u548c\u4f7f\u7528 <code>s2</code> \u7684\u5f15\u7528\u7684\u539f\u56e0\uff0c\u4e0e\u4f7f\u7528 <code>+</code> \u8fd0\u7b97\u7b26\u65f6\u8c03\u7528\u7684\u51fd\u6570\u7b7e\u540d\u6709\u5173\u3002<code>+</code> \u8fd0\u7b97\u7b26\u4f7f\u7528\u4e86 <code>add</code> \u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u7b7e\u540d\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a <pre><code>fn add(self, s: &amp;str) -&gt; String {\n</code></pre> \u8fd9\u4e2a\u8bed\u53e5\u4f1a\u83b7\u53d6 <code>s1</code> \u7684\u6240\u6709\u6743\uff0c\u9644\u52a0\u4e0a\u4ece <code>s2</code> \u4e2d\u62f7\u8d1d\u7684\u5185\u5bb9\uff0c\u5e76\u8fd4\u56de\u7ed3\u679c\u7684\u6240\u6709\u6743\u3002</p> <pre><code>    let s1 = String::from(\"tic\");\n    let s2 = String::from(\"tac\");\n    let s3 = String::from(\"toe\");\n\n    let s = format!(\"{s1}-{s2}-{s3}\");\n</code></pre> <p>\u8fd9\u4e9b\u4ee3\u7801\u4e5f\u4f1a\u5c06 <code>s</code> \u8bbe\u7f6e\u4e3a \u201ctic-tac-toe\u201d\u3002<code>format!</code> \u4e0e <code>println!</code> \u7684\u5de5\u4f5c\u539f\u7406\u76f8\u540c\uff0c\u4e0d\u8fc7\u4e0d\u540c\u4e8e\u5c06\u8f93\u51fa\u6253\u5370\u5230\u5c4f\u5e55\u4e0a\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u7ed3\u679c\u5185\u5bb9\u7684 <code>String</code>\u3002\u8fd9\u4e2a\u7248\u672c\u5c31\u597d\u7406\u89e3\u7684\u591a\uff0c\u5b8f <code>format!</code> \u751f\u6210\u7684\u4ee3\u7801\u4f7f\u7528\u5f15\u7528\u6240\u4ee5\u4e0d\u4f1a\u83b7\u53d6\u4efb\u4f55\u53c2\u6570\u7684\u6240\u6709\u6743\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#_5","title":"\u7d22\u5f15\u5b57\u7b26\u4e32\uff08\u5e76\u4e0d\u652f\u6301\uff09","text":"<p>\u4e00\u4e2a\u5b57\u7b26\u4e32\u5b57\u8282\u503c\u7684\u7d22\u5f15\u5e76\u4e0d\u603b\u662f\u5bf9\u5e94\u4e00\u4e2a\u6709\u6548\u7684 Unicode \u6807\u91cf\u503c\u3002</p> <p><pre><code>    let s1 = String::from(\"hello\");\n    let h = s1[0];\n</code></pre> \u9519\u8bef <pre><code>3 |     let h = s1[0];\n  |             ^^^^^ `String` cannot be indexed by `{integer}`\n</code></pre></p> <p>Rust \u7684\u5b57\u7b26\u4e32\u4e0d\u652f\u6301\u7d22\u5f15\u3002\u56e0\u4e3arust\u7684\u5b57\u7b26\u4e32\u662f\u7531utf8\u7f16\u7801\u7684</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#slice","title":"\u5b57\u7b26\u4e32 slice","text":"<pre><code>let hello = \"\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435\";\n\nlet s = &amp;hello[0..4];\n</code></pre> <p>\u5f53\u4f7f\u7528<code>&amp;hello[0..1]</code>\u65f6\uff0c\u4f1a\u5728\u8fd0\u884c\u65f6panic</p> <p>\u56e0\u4e3a\u6709\u6548\u7684 Unicode \u6807\u91cf\u503c\u53ef\u80fd\u4f1a\u7531\u4e0d\u6b62\u4e00\u4e2a\u5b57\u8282\u7ec4\u6210\u3002</p> <p>\u4e2d\u65873\u4e2a\uff0c\u82f1\u65871\u4e2a</p> <p>\u6240\u4ee5\u5c3d\u91cf\u907f\u514d\u4f7f\u7528</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#_6","title":"\u904d\u5386\u5b57\u7b26\u4e32","text":"<pre><code>for c in \"\u0417\u0434\".chars() {\n    println!(\"{c}\");\n}\n</code></pre> <p>output <pre><code>\u0417\n\u0434\n</code></pre></p> <pre><code>for b in \"\u0417\u0434\".bytes() {\n    println!(\"{b}\");\n}\n</code></pre> <p>output <pre><code>208\n151\n208\n180\n</code></pre></p> <p>`</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#hash-map","title":"Hash Map","text":"<p>\u6700\u540e\u4ecb\u7ecd\u7684\u5e38\u7528\u96c6\u5408\u7c7b\u578b\u662f \u54c8\u5e0c map\uff08hash map\uff09\u3002<code>HashMap&lt;K, V&gt;</code> \u7c7b\u578b\u50a8\u5b58\u4e86\u4e00\u4e2a\u952e\u7c7b\u578b <code>K</code> \u5bf9\u5e94\u4e00\u4e2a\u503c\u7c7b\u578b <code>V</code> \u7684\u6620\u5c04\u3002\u5b83\u901a\u8fc7\u4e00\u4e2a \u54c8\u5e0c\u51fd\u6570\uff08hashing function\uff09\u6765\u5b9e\u73b0\u6620\u5c04\uff0c\u51b3\u5b9a\u5982\u4f55\u5c06\u952e\u548c\u503c\u653e\u5165\u5185\u5b58\u4e2d\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#map","title":"\u54c8\u5e0c map","text":"<pre><code>    use std::collections::HashMap; // \u5bfc\u5165\u5e93\n\n    let mut scores = HashMap::new();\n\n    scores.insert(String::from(\"Blue\"), 10);\n    scores.insert(String::from(\"Yellow\"), 50);\n</code></pre> <p>\u6ce8\u610f\u5fc5\u987b\u9996\u5148 <code>use</code> \u6807\u51c6\u5e93\u4e2d\u96c6\u5408\u90e8\u5206\u7684 <code>HashMap</code>\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#map_1","title":"\u8bbf\u95ee\u54c8\u5e0c map\u4e2d\u7684\u503c","text":"<p>\u53ef\u4ee5\u901a\u8fc7 <code>get</code> \u65b9\u6cd5\u5e76\u63d0\u4f9b\u5bf9\u5e94\u7684\u952e\u6765\u4ece\u54c8\u5e0c map \u4e2d\u83b7\u53d6\u503c\uff0c\u5982\u793a\u4f8b\u6240\u793a\uff1a</p> <pre><code>    use std::collections::HashMap;\n\n    let mut scores = HashMap::new();\n\n    scores.insert(String::from(\"Blue\"), 10);\n    scores.insert(String::from(\"Yellow\"), 50);\n\n    let team_name = String::from(\"Blue\");\n    let score = scores.get(&amp;team_name).copied().unwrap_or(0);\n</code></pre> <p><code>get</code> \u65b9\u6cd5\u8fd4\u56de <code>Option&lt;&amp;V&gt;</code>\uff0c\u5982\u679c\u67d0\u4e2a\u952e\u5728\u54c8\u5e0c map \u4e2d\u6ca1\u6709\u5bf9\u5e94\u7684\u503c\uff0c<code>get</code> \u4f1a\u8fd4\u56de <code>None</code>\u3002\u7a0b\u5e8f\u4e2d\u901a\u8fc7\u8c03\u7528 <code>copied</code> \u65b9\u6cd5\u6765\u83b7\u53d6\u4e00\u4e2a <code>Option&lt;i32&gt;</code> \u800c\u4e0d\u662f <code>Option&lt;&amp;i32&gt;</code>\uff0c\u63a5\u7740\u8c03\u7528 <code>unwrap_or</code> \u5728 <code>score</code> \u4e2d\u6ca1\u6709\u8be5\u952e\u6240\u5bf9\u5e94\u7684\u9879\u65f6\u5c06\u5176\u8bbe\u7f6e\u4e3a\u96f6\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#map_2","title":"\u904d\u5386\u54c8\u5e0c map","text":"<pre><code>    use std::collections::HashMap;\n\n    let mut scores = HashMap::new();\n\n    scores.insert(String::from(\"Blue\"), 10);\n    scores.insert(String::from(\"Yellow\"), 50);\n\n    for (key, value) in &amp;scores {\n        println!(\"{key}: {value}\");\n    }\n</code></pre> <p>\u8fd9\u4f1a\u4ee5\u4efb\u610f\u987a\u5e8f\u6253\u5370\u51fa\u6bcf\u4e00\u4e2a\u952e\u503c\u5bf9\uff1a</p> <pre><code>Yellow: 50\nBlue: 10\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#map_3","title":"\u54c8\u5e0c map \u548c\u6240\u6709\u6743","text":"<p>\u5bf9\u4e8e\u50cf <code>i32</code> \u8fd9\u6837\u7684\u5b9e\u73b0\u4e86 <code>Copy</code> trait \u7684\u7c7b\u578b\uff0c\u5176\u503c\u53ef\u4ee5\u62f7\u8d1d\u8fdb\u54c8\u5e0c map\u3002\u5bf9\u4e8e\u50cf <code>String</code> \u8fd9\u6837\u62e5\u6709\u6240\u6709\u6743\u7684\u503c\uff0c\u5176\u503c\u5c06\u88ab\u79fb\u52a8\u800c\u54c8\u5e0c map \u4f1a\u6210\u4e3a\u8fd9\u4e9b\u503c\u7684\u6240\u6709\u8005\uff0c\u5982\u793a\u4f8b\u6240\u793a\uff1a</p> <pre><code>    use std::collections::HashMap;\n\n    let field_name = String::from(\"Favorite color\");\n    let field_value = String::from(\"Blue\");\n\n    let mut map = HashMap::new();\n    map.insert(field_name, field_value);\n    // \u8fd9\u91cc field_name \u548c field_value \u4e0d\u518d\u6709\u6548\uff0c\n</code></pre> <p>\u5f53 <code>insert</code> \u8c03\u7528\u5c06 <code>field_name</code> \u548c <code>field_value</code> \u79fb\u52a8\u5230\u54c8\u5e0c map \u4e2d\u540e\uff0c\u5c06\u4e0d\u80fd\u4f7f\u7528\u8fd9\u4e24\u4e2a\u7ed1\u5b9a\u3002</p> <p>\u5982\u679c\u5c06\u503c\u7684\u5f15\u7528\u63d2\u5165\u54c8\u5e0c map\uff0c\u8fd9\u4e9b\u503c\u672c\u8eab\u5c06\u4e0d\u4f1a\u88ab\u79fb\u52a8\u8fdb\u54c8\u5e0c map\u3002\u4f46\u662f\u8fd9\u4e9b\u5f15\u7528\u6307\u5411\u7684\u503c\u5fc5\u987b\u81f3\u5c11\u5728\u54c8\u5e0c map \u6709\u6548\u65f6\u4e5f\u662f\u6709\u6548\u7684\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#map_4","title":"\u66f4\u65b0\u54c8\u5e0c map","text":"<p>\u8986\u76d6\u4e00\u4e2a\u503c</p> <p>\u5982\u679c\u6211\u4eec\u63d2\u5165\u4e86\u4e00\u4e2a\u952e\u503c\u5bf9\uff0c\u63a5\u7740\u7528\u76f8\u540c\u7684\u952e\u63d2\u5165\u4e00\u4e2a\u4e0d\u540c\u7684\u503c\uff0c\u4e0e\u8fd9\u4e2a\u952e\u76f8\u5173\u8054\u7684\u65e7\u503c\u5c06\u88ab\u66ff\u6362\u3002</p> <pre><code>    use std::collections::HashMap;\n\n    let mut scores = HashMap::new();\n\n    scores.insert(String::from(\"Blue\"), 10);\n    scores.insert(String::from(\"Blue\"), 25);\n\n    println!(\"{:?}\", scores);\n</code></pre> <p>\u53ea\u5728\u952e\u6ca1\u6709\u5bf9\u5e94\u503c\u65f6\u63d2\u5165\u952e\u503c\u5bf9</p> <pre><code>   use std::collections::HashMap;\n\n    let mut scores = HashMap::new();\n    scores.insert(String::from(\"Blue\"), 10);\n\n    scores.entry(String::from(\"Yellow\")).or_insert(50);\n    scores.entry(String::from(\"Blue\")).or_insert(50);\n\n    println!(\"{:?}\", scores);\n</code></pre> <p><code>entry</code>\uff0c\u5b83\u83b7\u53d6\u6211\u4eec\u60f3\u8981\u68c0\u67e5\u7684\u952e\u4f5c\u4e3a\u53c2\u6570\u3002<code>entry</code> \u51fd\u6570\u7684\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u679a\u4e3e\uff0c<code>Entry</code>\uff0c\u5b83\u4ee3\u8868\u4e86\u53ef\u80fd\u5b58\u5728\u4e5f\u53ef\u80fd\u4e0d\u5b58\u5728\u7684\u503c\u3002<code>Entry</code> \u7684 <code>or_insert</code> \u65b9\u6cd5\u5728\u952e\u5bf9\u5e94\u7684\u503c\u5b58\u5728\u65f6\u5c31\u8fd4\u56de\u8fd9\u4e2a\u503c\u7684\u53ef\u53d8\u5f15\u7528\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u5c06\u53c2\u6570\u4f5c\u4e3a\u65b0\u503c\u63d2\u5165\u5e76\u8fd4\u56de\u65b0\u503c\u7684\u53ef\u53d8\u5f15\u7528\u3002</p> <p>\u6839\u636e\u65e7\u503c\u66f4\u65b0\u4e00\u4e2a\u503c</p> <pre><code>    use std::collections::HashMap;\n\n    let text = \"hello world wonderful world\";\n\n    let mut map = HashMap::new();\n\n    for word in text.split_whitespace() {\n        let count = map.entry(word).or_insert(0);\n        *count += 1;\n    }\n\n    println!(\"{:?}\", map);\n</code></pre> <p><code>split_whitespace</code> \u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u7531\u7a7a\u683c\u5206\u9694 <code>text</code> \u503c\u5b50 slice \u7684\u8fed\u4ee3\u5668\u3002<code>or_insert</code> \u65b9\u6cd5\u8fd4\u56de\u8fd9\u4e2a\u952e\u7684\u503c\u7684\u4e00\u4e2a\u53ef\u53d8\u5f15\u7528\uff08<code>&amp;mut V</code>\uff09\u3002\u8fd9\u91cc\u6211\u4eec\u5c06\u8fd9\u4e2a\u53ef\u53d8\u5f15\u7528\u50a8\u5b58\u5728 <code>count</code> \u53d8\u91cf\u4e2d\uff0c\u6240\u4ee5\u4e3a\u4e86\u8d4b\u503c\u5fc5\u987b\u9996\u5148\u4f7f\u7528\u661f\u53f7\uff08<code>*</code>\uff09\u89e3\u5f15\u7528 <code>count</code>\u3002\u8fd9\u4e2a\u53ef\u53d8\u5f15\u7528\u5728 <code>for</code> \u5faa\u73af\u7684\u7ed3\u5c3e\u79bb\u5f00\u4f5c\u7528\u57df\uff0c\u8fd9\u6837\u6240\u6709\u8fd9\u4e9b\u6539\u53d8\u90fd\u662f\u5b89\u5168\u7684\u5e76\u7b26\u5408\u501f\u7528\u89c4\u5219\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/5.%E5%B8%B8%E8%A7%81%E9%9B%86%E5%90%88%28Vec%E3%80%81string%E3%80%81map%29/#_7","title":"\u54c8\u5e0c\u51fd\u6570","text":"<p><code>HashMap</code> \u9ed8\u8ba4\u4f7f\u7528\u4e00\u79cd\u53eb\u505a SipHash \u7684\u54c8\u5e0c\u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u62b5\u5fa1\u6d89\u53ca\u54c8\u5e0c\u8868\uff08hash table\uff091 \u7684\u62d2\u7edd\u670d\u52a1\uff08Denial of Service, DoS\uff09\u653b\u51fb\u3002\u7136\u800c\u8fd9\u5e76\u4e0d\u662f\u53ef\u7528\u7684\u6700\u5feb\u7684\u7b97\u6cd5\uff0c\u4e0d\u8fc7\u4e3a\u4e86\u66f4\u9ad8\u7684\u5b89\u5168\u6027\u503c\u5f97\u4ed8\u51fa\u4e00\u4e9b\u6027\u80fd\u7684\u4ee3\u4ef7\u3002</p> <p>\u4f60\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u4e0d\u540c\u7684 hasher \u6765\u5207\u6362\u4e3a\u5176\u5b83\u51fd\u6570\u3002hasher \u662f\u4e00\u4e2a\u5b9e\u73b0\u4e86 <code>BuildHasher</code> trait \u7684\u7c7b\u578b\u3002</p> <p>SipHash - Wikipedia</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/6.%E6%A8%A1%E5%9D%97/","title":"\u6a21\u5757 Crate","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/6.%E6%A8%A1%E5%9D%97/#_1","title":"\u6a21\u5757","text":"<p>Rust \u4e2d\u7684\u6a21\u5757\uff08modules\uff09\u662f\u7528\u6765\u7ec4\u7ec7\u548c\u7ba1\u7406\u4ee3\u7801\u7684\u673a\u5236\u3002\u4e00\u4e2a\u6a21\u5757\u53ef\u4ee5\u5305\u542b\u51fd\u6570\u3001\u7ed3\u6784\u4f53\u3001\u679a\u4e3e\u3001traits \u7b49\u3002</p> <p>\u5728 Rust \u4e2d\uff0c\u6a21\u5757\u4f7f\u7528 <code>mod</code> \u5173\u952e\u5b57\u6765\u5b9a\u4e49\uff0c\u5e76\u4e14\u53ef\u4ee5\u5d4c\u5957\u3002\u4e00\u4e2a\u6a21\u5757\u53ef\u4ee5\u5728\u4e00\u4e2a\u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u6216\u8005\u5206\u5e03\u5728\u591a\u4e2a\u6587\u4ef6\u4e2d\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u6765\u8bf4\u660e\u6a21\u5757\u7684\u4f7f\u7528\uff1a</p> <pre><code>mod my_module {\n    fn private_function() {\n        println!(\"This is a private function\");\n    }\n\n    pub fn public_function() {\n        println!(\"This is a public function\");\n    }\n\n    pub mod nested_module {\n        pub fn nested_function() {\n            println!(\"This is a nested function\");\n        }\n    }\n}\n\nfn main() {\n    my_module::public_function();\n\n    // \u65e0\u6cd5\u76f4\u63a5\u8c03\u7528 private_function\uff0c\u56e0\u4e3a\u5b83\u662f\u79c1\u6709\u7684\n    // my_module::private_function();\n\n    my_module::nested_module::nested_function();\n}\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c<code>my_module</code> \u662f\u4e00\u4e2a\u6a21\u5757\uff0c\u5b83\u5305\u542b\u4e86\u4e00\u4e2a\u79c1\u6709\u51fd\u6570 <code>private_function</code> \u548c\u4e00\u4e2a\u516c\u5171\u51fd\u6570 <code>public_function</code>\u3002<code>my_module</code> \u6a21\u5757\u4e2d\u8fd8\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5d4c\u5957\u6a21\u5757 <code>nested_module</code>\uff0c\u5b83\u5305\u542b\u4e86\u4e00\u4e2a\u516c\u5171\u51fd\u6570 <code>nested_function</code>\u3002</p> <p>\u5728 <code>main</code> \u51fd\u6570\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>my_module::public_function()</code> \u76f4\u63a5\u8c03\u7528 <code>public_function</code>\u3002\u4f46\u662f\uff0c\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u8c03\u7528 <code>private_function</code>\uff0c\u56e0\u4e3a\u5b83\u662f\u79c1\u6709\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 <code>my_module::nested_module::nested_function()</code> \u8c03\u7528 <code>nested_function</code>\u3002</p> <pre><code>use crate::my_mod::{publ,message};\n\nmod my_mod {\n    fn pri(a:i32,b:i32) -&gt; i32 {\n       return a + b; \n    }\n\n    pub fn publ(a:i32,b:i32) -&gt;i32 {\n        let temp = a * pri(a, b);\n        return temp;\n    }\n\n    pub struct message {\n        pub mess:String,\n    }\n\n    impl message {\n        pub fn say(&amp;self) {\n            println!(\"{}\",self.mess);\n        }\n    }\n}\n\nfn main() {\n    println!(\"ans is {}\",publ(3, 4));\n    let m = message {\n        mess:\"Hello\".to_string(),\n    };\n    m.say();\n}\n</code></pre> <p><code>use xxxx as yyyy ;</code> \u7c7b\u4f3c\u4e8ePython\u4e2d\u7684<code>import xxxx as yyyy</code></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/6.%E6%A8%A1%E5%9D%97/#usepub","title":"\u6a21\u5757\u3001\u8def\u5f84\u3001<code>use</code>\u5173\u952e\u8bcd\u548c<code>pub</code>\u5173\u952e\u8bcd\u5982\u4f55\u5728\u7f16\u8bd1\u5668\u4e2d\u5de5\u4f5c","text":"<ul> <li>\u4ece crate \u6839\u8282\u70b9\u5f00\u59cb: \u5f53\u7f16\u8bd1\u4e00\u4e2a crate, \u7f16\u8bd1\u5668\u9996\u5148\u5728 crate \u6839\u6587\u4ef6\uff08\u901a\u5e38\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5e93 crate \u800c\u8a00\u662f_src/lib.rs_\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u8fdb\u5236 crate \u800c\u8a00\u662f_src/main.rs_\uff09\u4e2d\u5bfb\u627e\u9700\u8981\u88ab\u7f16\u8bd1\u7684\u4ee3\u7801\u3002</li> <li>\u58f0\u660e\u6a21\u5757: \u5728 crate \u6839\u6587\u4ef6\u4e2d\uff0c\u4f60\u53ef\u4ee5\u58f0\u660e\u4e00\u4e2a\u65b0\u6a21\u5757\uff1b\u6bd4\u5982\uff0c\u4f60\u7528<code>mod garden</code>\u58f0\u660e\u4e86\u4e00\u4e2a\u53eb\u505a<code>garden</code>\u7684\u6a21\u5757\u3002\u7f16\u8bd1\u5668\u4f1a\u5728\u4e0b\u5217\u8def\u5f84\u4e2d\u5bfb\u627e\u6a21\u5757\u4ee3\u7801\uff1a<ul> <li>\u5185\u8054\uff0c\u5728\u5927\u62ec\u53f7\u4e2d\uff0c\u5f53<code>mod garden</code>\u540e\u65b9\u4e0d\u662f\u4e00\u4e2a\u5206\u53f7\u800c\u662f\u4e00\u4e2a\u5927\u62ec\u53f7</li> <li>\u5728\u6587\u4ef6 src/garden.rs</li> <li>\u5728\u6587\u4ef6 src/garden/mod.rs</li> </ul> </li> <li>\u58f0\u660e\u5b50\u6a21\u5757: \u5728\u9664\u4e86 crate \u6839\u8282\u70b9\u4ee5\u5916\u7684\u5176\u4ed6\u6587\u4ef6\u4e2d\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u5b50\u6a21\u5757\u3002\u6bd4\u5982\uff0c\u4f60\u53ef\u80fd\u5728_src/garden.rs_\u4e2d\u5b9a\u4e49\u4e86<code>mod vegetables;</code>\u3002\u7f16\u8bd1\u5668\u4f1a\u5728\u4ee5\u7236\u6a21\u5757\u547d\u540d\u7684\u76ee\u5f55\u4e2d\u5bfb\u627e\u5b50\u6a21\u5757\u4ee3\u7801\uff1a<ul> <li>\u5185\u8054\uff0c\u5728\u5927\u62ec\u53f7\u4e2d\uff0c\u5f53<code>mod vegetables</code>\u540e\u65b9\u4e0d\u662f\u4e00\u4e2a\u5206\u53f7\u800c\u662f\u4e00\u4e2a\u5927\u62ec\u53f7</li> <li>\u5728\u6587\u4ef6 src/garden/vegetables.rs</li> <li>\u5728\u6587\u4ef6 src/garden/vegetables/mod.rs</li> </ul> </li> <li>\u6a21\u5757\u4e2d\u7684\u4ee3\u7801\u8def\u5f84: \u4e00\u65e6\u4e00\u4e2a\u6a21\u5757\u662f\u4f60 crate \u7684\u4e00\u90e8\u5206\uff0c\u4f60\u53ef\u4ee5\u5728\u9690\u79c1\u89c4\u5219\u5141\u8bb8\u7684\u524d\u63d0\u4e0b\uff0c\u4ece\u540c\u4e00\u4e2a crate \u5185\u7684\u4efb\u610f\u5730\u65b9\uff0c\u901a\u8fc7\u4ee3\u7801\u8def\u5f84\u5f15\u7528\u8be5\u6a21\u5757\u7684\u4ee3\u7801\u3002\u4e3e\u4f8b\u800c\u8a00\uff0c\u4e00\u4e2a garden vegetables \u6a21\u5757\u4e0b\u7684<code>Asparagus</code>\u7c7b\u578b\u53ef\u4ee5\u5728<code>crate::garden::vegetables::Asparagus</code>\u88ab\u627e\u5230\u3002</li> <li>\u79c1\u6709 vs \u516c\u7528: \u4e00\u4e2a\u6a21\u5757\u91cc\u7684\u4ee3\u7801\u9ed8\u8ba4\u5bf9\u5176\u7236\u6a21\u5757\u79c1\u6709\u3002\u4e3a\u4e86\u4f7f\u4e00\u4e2a\u6a21\u5757\u516c\u7528\uff0c\u5e94\u5f53\u5728\u58f0\u660e\u65f6\u4f7f\u7528<code>pub mod</code>\u66ff\u4ee3<code>mod</code>\u3002\u4e3a\u4e86\u4f7f\u4e00\u4e2a\u516c\u7528\u6a21\u5757\u5185\u90e8\u7684\u6210\u5458\u516c\u7528\uff0c\u5e94\u5f53\u5728\u58f0\u660e\u524d\u4f7f\u7528<code>pub</code>\u3002</li> <li><code>use</code> \u5173\u952e\u5b57: \u5728\u4e00\u4e2a\u4f5c\u7528\u57df\u5185\uff0c<code>use</code>\u5173\u952e\u5b57\u521b\u5efa\u4e86\u4e00\u4e2a\u6210\u5458\u7684\u5feb\u6377\u65b9\u5f0f\uff0c\u7528\u6765\u51cf\u5c11\u957f\u8def\u5f84\u7684\u91cd\u590d\u3002\u5728\u4efb\u4f55\u53ef\u4ee5\u5f15\u7528<code>crate::garden::vegetables::Asparagus</code>\u7684\u4f5c\u7528\u57df\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7 <code>use crate::garden::vegetables::Asparagus;</code>\u521b\u5efa\u4e00\u4e2a\u5feb\u6377\u65b9\u5f0f\uff0c\u7136\u540e\u4f60\u5c31\u53ef\u4ee5\u5728\u4f5c\u7528\u57df\u4e2d\u53ea\u5199<code>Asparagus</code>\u6765\u4f7f\u7528\u8be5\u7c7b\u578b\u3002</li> </ul> <p>\u6587\u4ef6\u7ed3\u6784\uff1a <pre><code>$ tree .\n.\n\u251c\u2500\u2500 my\n\u2502   \u251c\u2500\u2500 inaccessible.rs\n\u2502   \u2514\u2500\u2500 nested.rs\n\u251c\u2500\u2500 my.rs\n\u2514\u2500\u2500 split.rs\n</code></pre></p> <p>In split.rs: <pre><code>// This declaration will look for a file named `my.rs` and will\n// insert its contents inside a module named `my` under this scope\nmod my;\n\nfn function() {\n    println!(\"called `function()`\");\n}\n</code></pre></p> <pre><code>fn main() {\n    my::function();\n\n    function();\n\n    my::indirect_access();\n\n    my::nested::function();\n}\n</code></pre> <p>In my.rs: <pre><code>// Similarly `mod inaccessible` and `mod nested` will locate the `nested.rs`\n// and `inaccessible.rs` files and insert them here under their respective\n// modules\nmod inaccessible;\npub mod nested;\n\npub fn function() {\n    println!(\"called `my::function()`\");\n}\n\nfn private_function() {\n    println!(\"called `my::private_function()`\");\n}\n\npub fn indirect_access() {\n    print!(\"called `my::indirect_access()`, that\\n&gt; \");\n\n    private_function();\n}\n</code></pre></p> <p>In my/nested.rs: <pre><code>pub fn function() {\n    println!(\"called `my::nested::function()`\");\n}\n\n#[allow(dead_code)]\nfn private_function() {\n    println!(\"called `my::nested::private_function()`\");\n}\n</code></pre></p> <p>In my/inaccessible.rs:</p> <pre><code>#[allow(dead_code)]\npub fn public_function() {\n    println!(\"called `my::inaccessible::public_function()`\");\n}\n</code></pre> <p>Let's check that things still work as before:</p> <pre><code>$ rustc split.rs &amp;&amp; ./split\ncalled `my::function()`\ncalled `function()`\ncalled `my::indirect_access()`, that\n&gt; called `my::private_function()`\ncalled `my::nested::function()`\n</code></pre> <p>File hierarchy - Rust By Example</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5728\u8def\u5f84\u7684\u5f00\u5934\u4f7f\u7528 <code>super</code> \uff0c\u4ece\u7236\u6a21\u5757\u5f00\u59cb\u6784\u5efa\u76f8\u5bf9\u8def\u5f84\uff0c\u800c\u4e0d\u662f\u4ece\u5f53\u524d\u6a21\u5757\u6216\u8005 crate \u6839\u5f00\u59cb\u3002\u8fd9\u7c7b\u4f3c\u4ee5 <code>..</code> \u8bed\u6cd5\u5f00\u59cb\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u8def\u5f84\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/7.%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/","title":"\u9519\u8bef\u5904\u7406","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/7.%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/#panic","title":"panic!","text":"<pre><code>fn drink(beverage: &amp;str) {\n    // You shouldn't drink too much sugary beverages.\n    if beverage == \"lemonade\" { panic!(\"AAAaaaaa!!!!\"); }\n\n    println!(\"Some refreshing {} is all I need.\", beverage);\n}\n\nfn main() {\n    drink(\"water\");\n    drink(\"lemonade\");\n}\n</code></pre> <p>[!tips] \u5f53\u51fa\u73b0 panic \u65f6\uff0c\u7a0b\u5e8f\u9ed8\u8ba4\u4f1a\u5f00\u59cb \u5c55\u5f00\uff08unwinding\uff09\uff0c\u8fd9\u610f\u5473\u7740 Rust \u4f1a\u56de\u6eaf\u6808\u5e76\u6e05\u7406\u5b83\u9047\u5230\u7684\u6bcf\u4e00\u4e2a\u51fd\u6570\u7684\u6570\u636e\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u56de\u6eaf\u5e76\u6e05\u7406\u7684\u8fc7\u7a0b\u6709\u5f88\u591a\u5de5\u4f5c\u3002\u53e6\u4e00\u79cd\u9009\u62e9\u662f\u76f4\u63a5 \u7ec8\u6b62\uff08abort\uff09\uff0c\u8fd9\u4f1a\u4e0d\u6e05\u7406\u6570\u636e\u5c31\u9000\u51fa\u7a0b\u5e8f\u3002 \u90a3\u4e48\u7a0b\u5e8f\u6240\u4f7f\u7528\u7684\u5185\u5b58\u9700\u8981\u7531\u64cd\u4f5c\u7cfb\u7edf\u6765\u6e05\u7406\u3002\u5982\u679c\u4f60\u9700\u8981\u9879\u76ee\u7684\u6700\u7ec8\u4e8c\u8fdb\u5236\u6587\u4ef6\u8d8a\u5c0f\u8d8a\u597d\uff0cpanic \u65f6\u901a\u8fc7\u5728 Cargo.toml \u7684 <code>[profile]</code> \u90e8\u5206\u589e\u52a0 <code>panic = 'abort'</code>\uff0c\u53ef\u4ee5\u7531\u5c55\u5f00\u5207\u6362\u4e3a\u7ec8\u6b62\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4f60\u60f3\u8981\u5728 release \u6a21\u5f0f\u4e2d panic \u65f6\u76f4\u63a5\u7ec8\u6b62\uff1a</p> <pre><code>[profile.release]\npanic = 'abort'\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/7.%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/#result","title":"Result","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/7.%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/#result_1","title":"Result \u7684\u5b9a\u4e49","text":"<p>\u5b83\u5b9a\u4e49\u6709\u5982\u4e0b\u4e24\u4e2a\u6210\u5458\uff0c<code>Ok</code> \u548c <code>Err</code>\uff1a</p> <pre><code>enum Result&lt;T, E&gt; {\n    Ok(T),\n    Err(E),\n}\n</code></pre> <p><code>T</code> \u548c <code>E</code> \u662f\u6cdb\u578b\u7c7b\u578b\u53c2\u6570\u3002By convention, the expected outcome is <code>Ok</code> while the unexpected outcome is <code>Err</code>.</p> <pre><code>use std::fs::File;\n\nfn main() {\n    let greeting_file_result = File::open(\"hello.txt\");\n\n    let greeting_file = match greeting_file_result {\n        Ok(file) =&gt; file,\n        Err(error) =&gt; panic!(\"Problem opening the file: {:?}\", error),\n    };\n}\n</code></pre> <p><code>File::open</code> \u7684\u8fd4\u56de\u503c\u662f <code>Result&lt;T, E&gt;</code>\u3002\u6cdb\u578b\u53c2\u6570 <code>T</code> \u4f1a\u88ab <code>File::open</code> \u7684\u5b9e\u73b0\u653e\u5165\u6210\u529f\u8fd4\u56de\u503c\u7684\u7c7b\u578b <code>std::fs::File</code>\uff0c\u8fd9\u662f\u4e00\u4e2a\u6587\u4ef6\u53e5\u67c4\u3002\u9519\u8bef\u8fd4\u56de\u503c\u4f7f\u7528\u7684 <code>E</code> \u7684\u7c7b\u578b\u662f <code>std::io::Error</code>\u3002\u8fd9\u4e9b\u8fd4\u56de\u7c7b\u578b\u610f\u5473\u7740 <code>File::open</code> \u8c03\u7528\u53ef\u80fd\u6210\u529f\u5e76\u8fd4\u56de\u4e00\u4e2a\u53ef\u4ee5\u8bfb\u5199\u7684\u6587\u4ef6\u53e5\u67c4\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/7.%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/#_2","title":"\u5339\u914d\u4e0d\u540c\u7684\u9519\u8bef","text":"<pre><code>use std::fs::File;\nuse std::io::ErrorKind;\n\nfn main() {\n    let greeting_file_result = File::open(\"hello.txt\");\n\n    let greeting_file = match greeting_file_result {\n        Ok(file) =&gt; file,\n        Err(error) =&gt; match error.kind() {\n            ErrorKind::NotFound =&gt; match File::create(\"hello.txt\") {\n                Ok(fc) =&gt; fc,\n                Err(e) =&gt; panic!(\"Problem creating the file: {:?}\", e),\n            },\n            other_error =&gt; {\n                panic!(\"Problem opening the file: {:?}\", other_error);\n            }\n        },\n    };\n}\n</code></pre> <p>\u903b\u8f91\u76f8\u540c\u4f46\u662f\u4f7f\u7528\u95ed\u5305\u548c <code>unwrap_or_else</code> \u65b9\u6cd5\u7684\u4f8b\u5b50\uff1a</p> <pre><code>use std::fs::File;\nuse std::io::ErrorKind;\n\nfn main() {\n    let greeting_file = File::open(\"hello.txt\").unwrap_or_else(|error| {\n        if error.kind() == ErrorKind::NotFound {\n            File::create(\"hello.txt\").unwrap_or_else(|error| {\n                panic!(\"Problem creating the file: {:?}\", error);\n            })\n        } else {\n            panic!(\"Problem opening the file: {:?}\", error);\n        }\n    });\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/7.%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/#unwrap-expect","title":"unwrap \u548c expect","text":"<p><pre><code>use std::fs::File;\n\nfn main() {\n    let greeting_file = File::open(\"hello.txt\").unwrap(); \n}\n</code></pre> \u8f93\u51fa\u9ed8\u8ba4\u7684panic\u6d88\u606f</p> <p><pre><code>use std::fs::File;\n\nfn main() {\n    let greeting_file = File::open(\"hello.txt\")\n        .expect(\"hello.txt should be included in this project\"); \n}\n</code></pre> \u8f93\u51fa\u6307\u5b9a\u7684panic\u4fe1\u606f</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/7.%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/#_3","title":"\u4f20\u64ad\u9519\u8bef","text":"<pre><code>use std::fs::File;\nuse std::io::{self, Read};\n\nfn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; {\n    let username_file_result = File::open(\"hello.txt\");\n\n    let mut username_file = match username_file_result {\n        Ok(file) =&gt; file,\n        Err(e) =&gt; return Err(e),\n    };\n\n    let mut username = String::new();\n\n    match username_file.read_to_string(&amp;mut username) {\n        Ok(_) =&gt; Ok(username),\n        Err(e) =&gt; Err(e),\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/7.%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/#_4","title":"\u4f20\u64ad\u9519\u8bef\u7684\u7b80\u5199\uff1a? \u8fd0\u7b97\u7b26","text":"<pre><code>use std::fs::File;\nuse std::io::{self, Read};\n\nfn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; {\n    let mut username_file = File::open(\"hello.txt\")?; // return Error\n    let mut username = String::new();\n    username_file.read_to_string(&amp;mut username)?;\n    Ok(username) // return Ok\n}\n</code></pre> <p><code>Result</code> \u503c\u4e4b\u540e\u7684 <code>?</code> \u88ab\u5b9a\u4e49\u4e3a\u4e0e\u793a\u4f8b 9-6 \u4e2d\u5b9a\u4e49\u7684\u5904\u7406 <code>Result</code> \u503c\u7684 <code>match</code> \u8868\u8fbe\u5f0f\u6709\u7740\u5b8c\u5168\u76f8\u540c\u7684\u5de5\u4f5c\u65b9\u5f0f\u3002\u5982\u679c <code>Result</code> \u7684\u503c\u662f <code>Ok</code>\uff0c\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u5c06\u4f1a\u8fd4\u56de <code>Ok</code> \u4e2d\u7684\u503c\u800c\u7a0b\u5e8f\u5c06\u7ee7\u7eed\u6267\u884c\u3002\u5982\u679c\u503c\u662f <code>Err</code>\uff0c<code>Err</code> \u4e2d\u7684\u503c\u5c06\u4f5c\u4e3a\u6574\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u5c31\u597d\u50cf\u4f7f\u7528\u4e86 <code>return</code> \u5173\u952e\u5b57\u4e00\u6837\uff0c\u8fd9\u6837\u9519\u8bef\u503c\u5c31\u88ab\u4f20\u64ad\u7ed9\u4e86\u8c03\u7528\u8005\u3002</p> <p><code>match</code> \u8868\u8fbe\u5f0f\u4e0e <code>?</code> \u8fd0\u7b97\u7b26\u6240\u505a\u7684\u6709\u4e00\u70b9\u4e0d\u540c\uff1a<code>?</code> \u8fd0\u7b97\u7b26\u6240\u4f7f\u7528\u7684\u9519\u8bef\u503c\u88ab\u4f20\u9012\u7ed9\u4e86 <code>from</code> \u51fd\u6570\uff0c\u5b83\u5b9a\u4e49\u4e8e\u6807\u51c6\u5e93\u7684 <code>From</code> trait \u4e2d\uff0c\u5176\u7528\u6765\u5c06\u9519\u8bef\u4ece\u4e00\u79cd\u7c7b\u578b\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u7c7b\u578b\u3002\u5f53 <code>?</code> \u8fd0\u7b97\u7b26\u8c03\u7528 <code>from</code> \u51fd\u6570\u65f6\uff0c\u6536\u5230\u7684\u9519\u8bef\u7c7b\u578b\u88ab\u8f6c\u6362\u4e3a\u7531\u5f53\u524d\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u6240\u6307\u5b9a\u7684\u9519\u8bef\u7c7b\u578b\u3002\u8fd9\u5728\u5f53\u51fd\u6570\u8fd4\u56de\u5355\u4e2a\u9519\u8bef\u7c7b\u578b\u6765\u4ee3\u8868\u6240\u6709\u53ef\u80fd\u5931\u8d25\u7684\u65b9\u5f0f\u65f6\u5f88\u6709\u7528\uff0c\u5373\u4f7f\u5176\u53ef\u80fd\u4f1a\u56e0\u5f88\u591a\u79cd\u539f\u56e0\u5931\u8d25\u3002</p> <p>[!tips] '?'\u8fd0\u7b97\u7b26\u53ef\u4ee5\u7528\u5728\u5b9e\u73b0\u4e86<code>std::ops::Try</code> trait\u7684\u7c7b\u578b\u4e0a\u3002\u8fd9\u4e2a\u8fd0\u7b97\u7b26\u53ef\u4ee5\u7528\u4e8e\u5728\u53d1\u751f\u9519\u8bef\u65f6\u63d0\u524d\u8fd4\u56de<code>Result</code>\u7c7b\u578b\u7684\u503c\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0c'?'\u8fd0\u7b97\u7b26\u53ef\u4ee5\u7528\u5728\u4ee5\u4e0b\u60c5\u51b5\u4e0b\uff1a</p> <ol> <li> <p>\u51fd\u6570\u8fd4\u56de\u7c7b\u578b\u4e3a<code>Result&lt;T, E&gt;</code>\u7684\u51fd\u6570\u4e2d\uff0c\u4f7f\u7528'?'\u53ef\u4ee5\u65b9\u4fbf\u5730\u5c06\u53d1\u751f\u9519\u8bef\u65f6\u7684<code>Err</code>\u503c\u8fd4\u56de\u7ed9\u8c03\u7528\u8005\u3002</p> </li> <li> <p>\u5728\u5b9e\u73b0\u4e86<code>std::ops::Try</code> trait\u7684\u7c7b\u578b\u7684\u65b9\u6cd5\u4e2d\uff0c\u4f7f\u7528'?'\u53ef\u4ee5\u5c06\u53ef\u80fd\u53d1\u751f\u7684\u9519\u8bef\u4f20\u64ad\u7ed9\u8c03\u7528\u8005\u3002</p> </li> </ol> <p>\u4e0d\u8fc7\uff0c'?'\u8fd0\u7b97\u7b26\u4e0d\u80fd\u7528\u5728\u4ee5\u4e0b\u60c5\u51b5\u4e0b\uff1a</p> <ol> <li> <p>\u5728\u6ca1\u6709\u8fd4\u56de<code>Result</code>\u7c7b\u578b\u7684\u51fd\u6570\u4e2d\uff0c\u4f7f\u7528'?'\u5c06\u4f1a\u5bfc\u81f4\u7f16\u8bd1\u9519\u8bef\u3002</p> </li> <li> <p>\u5728\u6ca1\u6709\u5b9e\u73b0<code>std::ops::Try</code> trait\u7684\u7c7b\u578b\u4e2d\uff0c\u4f7f\u7528'?'\u4e5f\u4f1a\u5bfc\u81f4\u7f16\u8bd1\u9519\u8bef\u3002</p> </li> </ol> <p>main\u51fd\u6570\u8fd4\u56de\u9519\u8bef</p> <pre><code>use std::error::Error;\nuse std::fs::File;\n\nfn main() -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {\n    let greeting_file = File::open(\"hello.txt\")?;\n\n    Ok(())\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/8.%E6%B3%9B%E5%9E%8B/","title":"\u6cdb\u578b","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/8.%E6%B3%9B%E5%9E%8B/#_2","title":"\u5728\u51fd\u6570\u5b9a\u4e49\u4e2d\u4f7f\u7528\u6cdb\u578b","text":"<p>\u4e3a\u4e86\u5b9a\u4e49\u6cdb\u578b\u7248\u672c\u7684 <code>largest</code> \u51fd\u6570\uff0c\u7c7b\u578b\u53c2\u6570\u58f0\u660e\u4f4d\u4e8e\u51fd\u6570\u540d\u79f0\u4e0e\u53c2\u6570\u5217\u8868\u4e2d\u95f4\u7684\u5c16\u62ec\u53f7 <code>&lt;&gt;</code> \u4e2d\uff0c\u50cf\u8fd9\u6837\uff1a</p> <pre><code>fn largest&lt;T&gt;(list: &amp;[T]) -&gt; &amp;T {\n</code></pre> <p>\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\u8fd9\u4e2a\u5b9a\u4e49\uff1a\u51fd\u6570 <code>largest</code> \u6709\u6cdb\u578b\u7c7b\u578b <code>T</code>\u3002\u5b83\u6709\u4e2a\u53c2\u6570 <code>list</code>\uff0c\u5176\u7c7b\u578b\u662f\u5143\u7d20\u4e3a <code>T</code> \u7684 slice\u3002<code>largest</code> \u51fd\u6570\u4f1a\u8fd4\u56de\u4e00\u4e2a\u4e0e <code>T</code> \u76f8\u540c\u7c7b\u578b\u7684\u5f15\u7528\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/8.%E6%B3%9B%E5%9E%8B/#_3","title":"\u7ed3\u6784\u4f53\u5b9a\u4e49\u4e2d\u7684\u6cdb\u578b","text":"<p><pre><code>struct Point&lt;T&gt; {\n    x: T,\n    y: T,\n}\n\nfn main() {\n    let integer = Point { x: 5, y: 10 };\n    let float = Point { x: 1.0, y: 4.0 };\n}\n</code></pre> x\u548cy\u8981\u6c42\u662f\u76f8\u540c\u7c7b\u578b\u7684</p> <p><pre><code>struct Point&lt;T, U&gt; {\n    x: T,\n    y: U,\n}\n\nfn main() {\n    let both_integer = Point { x: 5, y: 10 }; \n    let both_float = Point { x: 1.0, y: 4.0 };\n    let integer_and_float = Point { x: 5, y: 4.0 };\n}\n</code></pre> x\u548cy\u53ef\u80fd\u662f\u4e0d\u540c\u7c7b\u578b\u7684</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/8.%E6%B3%9B%E5%9E%8B/#_4","title":"\u679a\u4e3e\u5b9a\u4e49\u4e2d\u7684\u6cdb\u578b","text":"<pre><code>enum Option&lt;T&gt; {\n    Some(T),\n    None,\n}\n</code></pre> <pre><code>enum Result&lt;T, E&gt; {\n    Ok(T),\n    Err(E),\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/8.%E6%B3%9B%E5%9E%8B/#_5","title":"\u65b9\u6cd5\u5b9a\u4e49\u4e2d\u7684\u6cdb\u578b","text":"<pre><code>struct Point&lt;T&gt; {\n    x: T,\n    y: T,\n}\n\nimpl&lt;T&gt; Point&lt;T&gt; {\n    fn x(&amp;self) -&gt; &amp;T {\n        &amp;self.x\n    }\n}\n\nfn main() {\n    let p = Point { x: 5, y: 10 };\n\n    println!(\"p.x = {}\", p.x());\n}\n</code></pre> <p><pre><code>struct Point&lt;X1, Y1&gt; {\n    x: X1,\n    y: Y1,\n}\n\nimpl&lt;X1, Y1&gt; Point&lt;X1, Y1&gt; {\n    fn mixup&lt;X2, Y2&gt;(self, other: Point&lt;X2, Y2&gt;) -&gt; Point&lt;X1, Y2&gt; {\n        Point {\n            x: self.x,\n            y: other.y,\n        }\n    }\n}\n\nfn main() {\n    let p1 = Point { x: 5, y: 10.4 };\n    let p2 = Point { x: \"Hello\", y: 'c' };\n\n    let p3 = p1.mixup(p2);\n\n    println!(\"p3.x = {}, p3.y = {}\", p3.x, p3.y);\n}\n</code></pre> \u65b9\u6cd5\u4f7f\u7528\u4e86\u4e0e\u7ed3\u6784\u4f53\u5b9a\u4e49\u4e2d\u4e0d\u540c\u7c7b\u578b\u7684\u6cdb\u578b</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/","title":"Trait","text":"<p>trait \u5b9a\u4e49\u4e86\u67d0\u4e2a\u7279\u5b9a\u7c7b\u578b\u62e5\u6709\u53ef\u80fd\u4e0e\u5176\u4ed6\u7c7b\u578b\u5171\u4eab\u7684\u529f\u80fd\u3002\u53ef\u4ee5\u901a\u8fc7 trait \u4ee5\u4e00\u79cd\u62bd\u8c61\u7684\u65b9\u5f0f\u5b9a\u4e49\u5171\u4eab\u7684\u884c\u4e3a\u3002\u53ef\u4ee5\u4f7f\u7528 trait bounds \u6307\u5b9a\u6cdb\u578b\u662f\u4efb\u4f55\u62e5\u6709\u7279\u5b9a\u884c\u4e3a\u7684\u7c7b\u578b\u3002</p> <p>trait \u7c7b\u4f3c\u4e8e\u5176\u4ed6\u8bed\u8a00\u4e2d\u7684\u5e38\u88ab\u79f0\u4e3a \u63a5\u53e3\uff08interfaces\uff09\u7684\u529f\u80fd\uff0c\u867d\u7136\u6709\u4e00\u4e9b\u4e0d\u540c\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/#trait_1","title":"\u5b9a\u4e49trait","text":"<p><pre><code>pub trait trait_name {\n    fn func_name(&amp;self) -&gt; String;\n}\n</code></pre> trait \u4f53\u4e2d\u53ef\u4ee5\u6709\u591a\u4e2a\u65b9\u6cd5\uff1a\u4e00\u884c\u4e00\u4e2a\u65b9\u6cd5\u7b7e\u540d\u4e14\u90fd\u4ee5\u5206\u53f7\u7ed3\u5c3e\u3002</p> <pre><code>pub trait Summary {\n    fn summarize(&amp;self) -&gt; String;\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/#trait_2","title":"\u4e3a\u7c7b\u578b\u5b9e\u73b0trait","text":"<pre><code>pub struct NewsArticle {\n    pub headline: String,\n    pub location: String,\n    pub author: String,\n    pub content: String,\n}\n\nimpl Summary for NewsArticle {\n    fn summarize(&amp;self) -&gt; String {\n        format!(\"{}, by {} ({})\", self.headline, self.author, self.location)\n    }\n}\n\npub struct Tweet {\n    pub username: String,\n    pub content: String,\n    pub reply: bool,\n    pub retweet: bool,\n}\n\nimpl Summary for Tweet {\n    fn summarize(&amp;self) -&gt; String {\n        format!(\"{}: {}\", self.username, self.content)\n    }\n}\n</code></pre> <p>\u4f46\u662f\u4e0d\u80fd\u4e3a\u5916\u90e8\u7c7b\u578b\u5b9e\u73b0\u5916\u90e8 trait\u3002\u4f8b\u5982\uff0c\u4e0d\u80fd\u5728 <code>aggregator</code> crate \u4e2d\u4e3a <code>Vec&lt;T&gt;</code> \u5b9e\u73b0 <code>Display</code> trait\u3002\u8fd9\u662f\u56e0\u4e3a <code>Display</code> \u548c <code>Vec&lt;T&gt;</code> \u90fd\u5b9a\u4e49\u4e8e\u6807\u51c6\u5e93\u4e2d\uff0c\u5b83\u4eec\u5e76\u4e0d\u4f4d\u4e8e <code>aggregator</code> crate \u672c\u5730\u4f5c\u7528\u57df\u4e2d\u3002\u8fd9\u4e2a\u9650\u5236\u662f\u88ab\u79f0\u4e3a \u76f8\u5e72\u6027\uff08coherence\uff09\u7684\u7a0b\u5e8f\u5c5e\u6027\u7684\u4e00\u90e8\u5206\uff0c\u6216\u8005\u66f4\u5177\u4f53\u7684\u8bf4\u662f \u5b64\u513f\u89c4\u5219\uff08orphan rule\uff09\uff0c\u5176\u5f97\u540d\u4e8e\u4e0d\u5b58\u5728\u7236\u7c7b\u578b\u3002\u8fd9\u6761\u89c4\u5219\u786e\u4fdd\u4e86\u5176\u4ed6\u4eba\u7f16\u5199\u7684\u4ee3\u7801\u4e0d\u4f1a\u7834\u574f\u4f60\u4ee3\u7801\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\u6ca1\u6709\u8fd9\u6761\u89c4\u5219\u7684\u8bdd\uff0c\u4e24\u4e2a crate \u53ef\u4ee5\u5206\u522b\u5bf9\u76f8\u540c\u7c7b\u578b\u5b9e\u73b0\u76f8\u540c\u7684 trait\uff0c\u800c Rust \u5c06\u65e0\u4ece\u5f97\u77e5\u5e94\u8be5\u4f7f\u7528\u54ea\u4e00\u4e2a\u5b9e\u73b0\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/#_1","title":"\u9ed8\u8ba4\u5b9e\u73b0","text":"<pre><code>pub trait Summary {\n    fn summarize(&amp;self) -&gt; String {\n        String::from(\"(Read more...)\")\n    }\n}\n</code></pre> <p>\u5982\u679c\u60f3\u8981\u5bf9 <code>NewsArticle</code> \u5b9e\u4f8b\u4f7f\u7528\u8fd9\u4e2a\u9ed8\u8ba4\u5b9e\u73b0\uff0c\u53ef\u4ee5\u901a\u8fc7 <code>impl Summary for NewsArticle {}</code> \u6307\u5b9a\u4e00\u4e2a\u7a7a\u7684 <code>impl</code> \u5757\u3002</p> <pre><code>struct simple {\n    x:i32,\n}\n\npub trait content {\n    fn get_string(&amp;self) {\n        println!(\"Hello\")\n    }\n}\n\nimpl content for simple {\n\n}\n\nfn main() {\n    let s = simple{x:3};\n    s.get_string()\n}\n</code></pre> <p>\u9ed8\u8ba4\u5b9e\u73b0\u5141\u8bb8\u8c03\u7528\u76f8\u540c trait \u4e2d\u7684\u5176\u4ed6\u65b9\u6cd5\uff0c\u54ea\u6015\u8fd9\u4e9b\u65b9\u6cd5\u6ca1\u6709\u9ed8\u8ba4\u5b9e\u73b0\u3002</p> <pre><code>pub trait Summary {\n    fn summarize_author(&amp;self) -&gt; String;\n\n    fn summarize(&amp;self) -&gt; String {\n        format!(\"(Read more from {}...)\", self.summarize_author())\n    }\n}\n</code></pre> <p>\u4e3a\u4e86\u4f7f\u7528\u8fd9\u4e2a\u7248\u672c\u7684 <code>Summary</code>\uff0c\u53ea\u9700\u5728\u5b9e\u73b0 trait \u65f6\u5b9a\u4e49 <code>summarize_author</code> \u5373\u53ef\uff1a</p> <pre><code>impl Summary for Tweet {\n    fn summarize_author(&amp;self) -&gt; String {\n        format!(\"@{}\", self.username)\n    }\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/#trait_3","title":"trait \u4f5c\u4e3a\u53c2\u6570","text":"<p>\u6211\u4eec\u53ef\u4ee5\u63a2\u7d22\u4e00\u4e0b\u5982\u4f55\u4f7f\u7528 trait \u6765\u63a5\u53d7\u591a\u79cd\u4e0d\u540c\u7c7b\u578b\u7684\u53c2\u6570\u3002\u793a\u4f8b 10-13 \u4e2d\u4e3a <code>NewsArticle</code> \u548c <code>Tweet</code> \u7c7b\u578b\u5b9e\u73b0\u4e86 <code>Summary</code> trait\uff0c\u7528\u5176\u6765\u5b9a\u4e49\u4e86\u4e00\u4e2a\u51fd\u6570 <code>notify</code> \u6765\u8c03\u7528\u5176\u53c2\u6570 <code>item</code> \u4e0a\u7684 <code>summarize</code> \u65b9\u6cd5\uff0c\u8be5\u53c2\u6570\u662f\u5b9e\u73b0\u4e86 <code>Summary</code> trait \u7684\u67d0\u79cd\u7c7b\u578b\u3002\u4e3a\u6b64\u53ef\u4ee5\u4f7f\u7528 <code>impl Trait</code> \u8bed\u6cd5\uff0c\u50cf\u8fd9\u6837\uff1a</p> <pre><code>pub fn notify(item: &amp;impl Summary) {\n    println!(\"Breaking news! {}\", item.summarize());\n}\n</code></pre> <p>\u5bf9\u4e8e <code>item</code> \u53c2\u6570\uff0c\u6211\u4eec\u6307\u5b9a\u4e86 <code>impl</code> \u5173\u952e\u5b57\u548c trait \u540d\u79f0\uff0c\u800c\u4e0d\u662f\u5177\u4f53\u7684\u7c7b\u578b\u3002\u8be5\u53c2\u6570\u652f\u6301\u4efb\u4f55\u5b9e\u73b0\u4e86\u6307\u5b9a trait \u7684\u7c7b\u578b\u3002\u5728 <code>notify</code> \u51fd\u6570\u4f53\u4e2d\uff0c\u53ef\u4ee5\u8c03\u7528\u4efb\u4f55\u6765\u81ea <code>Summary</code> trait \u7684\u65b9\u6cd5\uff0c\u6bd4\u5982 <code>summarize</code>\u3002\u6211\u4eec\u53ef\u4ee5\u4f20\u9012\u4efb\u4f55 <code>NewsArticle</code> \u6216 <code>Tweet</code> \u7684\u5b9e\u4f8b\u6765\u8c03\u7528 <code>notify</code>\u3002\u4efb\u4f55\u7528\u5176\u5b83\u5982 <code>String</code> \u6216 <code>i32</code> \u7684\u7c7b\u578b\u8c03\u7528\u8be5\u51fd\u6570\u7684\u4ee3\u7801\u90fd\u4e0d\u80fd\u7f16\u8bd1\uff0c\u56e0\u4e3a\u5b83\u4eec\u6ca1\u6709\u5b9e\u73b0 <code>Summary</code>\u3002</p> <p>\u793a\u4f8b</p> <pre><code>struct Simple {\n    x:i32,\n}\n\npub trait Content {\n    fn get_string(&amp;self);\n}\n\nimpl Content for Simple {\n    fn get_string(&amp;self){\n        println!(\"Hello\")\n    }\n}\n\npub fn notify(item: &amp;impl Content) {\n    item.get_string();\n}\n\n\nfn main() {\n    let s = Simple{x:3};\n    notify(&amp;s); // \u53ea\u80fd\u4f7f\u7528\u5df2\u7ecf\u5b9e\u73b0trait\u7684\u7c7b\u578b\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/#trait-bound","title":"Trait Bound \u8bed\u6cd5","text":"<p><code>impl Trait</code> \u8bed\u6cd5\u9002\u7528\u4e8e\u76f4\u89c2\u7684\u4f8b\u5b50\uff0c\u5b83\u5b9e\u9645\u4e0a\u662f\u4e00\u79cd\u8f83\u957f\u5f62\u5f0f\u8bed\u6cd5\u7684\u8bed\u6cd5\u7cd6\u3002\u6211\u4eec\u79f0\u4e3a trait bound\uff0c\u5b83\u770b\u8d77\u6765\u50cf\uff1a</p> <pre><code>pub fn notify&lt;T: Summary&gt;(item: &amp;T) {\n    println!(\"Breaking news! {}\", item.summarize());\n}\n</code></pre> <p>\u4f7f\u7528 <code>impl Trait</code> \u7684\u8bed\u6cd5\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a</p> <pre><code>pub fn notify(item1: &amp;impl Summary, item2: &amp;impl Summary) {\n</code></pre> <p>\u8fd9\u9002\u7528\u4e8e <code>item1</code> \u548c <code>item2</code> \u5141\u8bb8\u662f\u4e0d\u540c\u7c7b\u578b\u7684\u60c5\u51b5\uff08\u53ea\u8981\u5b83\u4eec\u90fd\u5b9e\u73b0\u4e86 <code>Summary</code>\uff09\u3002\u4e0d\u8fc7\u5982\u679c\u4f60\u5e0c\u671b\u5f3a\u5236\u5b83\u4eec\u90fd\u662f\u76f8\u540c\u7c7b\u578b\u5462\uff1f\u8fd9\u53ea\u6709\u5728\u4f7f\u7528 trait bound \u65f6\u624d\u6709\u53ef\u80fd\uff1a</p> <pre><code>pub fn notify&lt;T: Summary&gt;(item1: &amp;T, item2: &amp;T) {\n</code></pre> <p>\u6cdb\u578b <code>T</code> \u88ab\u6307\u5b9a\u4e3a <code>item1</code> \u548c <code>item2</code> \u7684\u53c2\u6570\u9650\u5236\uff0c\u5982\u6b64\u4f20\u9012\u7ed9\u53c2\u6570 <code>item1</code> \u548c <code>item2</code> \u503c\u7684\u5177\u4f53\u7c7b\u578b\u5fc5\u987b\u4e00\u81f4\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/#trait-bound_1","title":"\u901a\u8fc7 + \u6307\u5b9a\u591a\u4e2a trait bound","text":"<p>\u5982\u679c notify \u9700\u8981\u663e\u793a item \u7684\u683c\u5f0f\u5316\u5f62\u5f0f\uff0c\u540c\u65f6\u4e5f\u8981\u4f7f\u7528 summarize \u65b9\u6cd5\uff0c\u90a3\u4e48 item \u5c31\u9700\u8981\u540c\u65f6\u5b9e\u73b0\u4e24\u4e2a\u4e0d\u540c\u7684 trait\uff1aDisplay \u548c Summary\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7 + \u8bed\u6cd5\u5b9e\u73b0\uff1a</p> <pre><code>pub fn notify(item: &amp;(impl Summary + Display)) {\n</code></pre> <ul> <li>\u8bed\u6cd5\u4e5f\u9002\u7528\u4e8e\u6cdb\u578b\u7684 trait bound\uff1a</li> </ul> <pre><code>pub fn notify&lt;T: Summary + Display&gt;(item: &amp;T) {\n</code></pre> <p>\u901a\u8fc7\u6307\u5b9a\u8fd9\u4e24\u4e2a trait bound\uff0cnotify \u7684\u51fd\u6570\u4f53\u53ef\u4ee5\u8c03\u7528 summarize \u5e76\u4f7f\u7528 {} \u6765\u683c\u5f0f\u5316 item\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/#where-trait-bound","title":"\u901a\u8fc7 where \u7b80\u5316 trait bound","text":"<p>\u7136\u800c\uff0c\u4f7f\u7528\u8fc7\u591a\u7684 trait bound \u4e5f\u6709\u7f3a\u70b9\u3002\u6bcf\u4e2a\u6cdb\u578b\u6709\u5176\u81ea\u5df1\u7684 trait bound\uff0c\u6240\u4ee5\u6709\u591a\u4e2a\u6cdb\u578b\u53c2\u6570\u7684\u51fd\u6570\u5728\u540d\u79f0\u548c\u53c2\u6570\u5217\u8868\u4e4b\u95f4\u4f1a\u6709\u5f88\u957f\u7684 trait bound \u4fe1\u606f\uff0c\u8fd9\u4f7f\u5f97\u51fd\u6570\u7b7e\u540d\u96be\u4ee5\u9605\u8bfb\u3002\u4e3a\u6b64\uff0cRust \u6709\u53e6\u4e00\u4e2a\u5728\u51fd\u6570\u7b7e\u540d\u4e4b\u540e\u7684 <code>where</code> \u4ece\u53e5\u4e2d\u6307\u5b9a trait bound \u7684\u8bed\u6cd5\u3002\u6240\u4ee5\u9664\u4e86\u8fd9\u4e48\u5199\uff1a</p> <pre><code>fn some_function&lt;T: Display + Clone, U: Clone + Debug&gt;(t: &amp;T, u: &amp;U) -&gt; i32 {\n</code></pre> <p>\u8fd8\u53ef\u4ee5\u50cf\u8fd9\u6837\u4f7f\u7528 <code>where</code> \u4ece\u53e5\uff1a</p> <pre><code>fn some_function&lt;T, U&gt;(t: &amp;T, u: &amp;U) -&gt; i32\nwhere\n    T: Display + Clone,\n    U: Clone + Debug,\n{\n</code></pre> <p>\u8fd9\u4e2a\u51fd\u6570\u7b7e\u540d\u5c31\u663e\u5f97\u4e0d\u90a3\u4e48\u6742\u4e71\uff0c\u51fd\u6570\u540d\u3001\u53c2\u6570\u5217\u8868\u548c\u8fd4\u56de\u503c\u7c7b\u578b\u90fd\u79bb\u5f97\u5f88\u8fd1\uff0c\u770b\u8d77\u6765\u8ddf\u6ca1\u6709\u90a3\u4e48\u591a trait bounds \u7684\u51fd\u6570\u5f88\u50cf\u3002</p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/#trait_4","title":"\u8fd4\u56de\u5b9e\u73b0\u4e86 trait \u7684\u7c7b\u578b","text":"<pre><code>struct Simple {\n    x:i32,\n}\n\npub trait Content {\n    fn get_string(&amp;self);\n}\n\nimpl Content for Simple {\n    fn get_string(&amp;self){\n        println!(\"Hello\")\n    }\n}\n\npub fn notify(item: &amp;impl Content) {\n    item.get_string();\n}\n\nfn return_fn() -&gt; impl Content {\n    if flag {\n        Simple { //\u53ea\u80fd\u8fd4\u56de\u4e00\u79cd\u7c7b\u578b\uff0c\u4e0d\u80fd\u8fd4\u56de\u4e0d\u540c\u7684\u7c7b\u578b\n        x:42\n        }\n    } \n    // else {\n    // xxx {\n    //    y:\n    //    z:\n    //}\n    // }\n}\n\nfn main() {\n    let s = Simple{x:3};\n    notify(&amp;s);\n    let simple = return_fn();\n    simple.get_string();\n}\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/9.Trait/#trait-bound_2","title":"\u4f7f\u7528 trait bound \u6709\u6761\u4ef6\u7684\u5b9e\u73b0\u65b9\u6cd5","text":"<pre><code>use std::fmt::Display;\n\nstruct Pair&lt;T&gt; {\n    x: T,\n    y: T,\n}\n\nimpl&lt;T&gt; Pair&lt;T&gt; {\n    fn new(x: T, y: T) -&gt; Self {\n        Self { x, y }\n    }\n}\n\nimpl&lt;T: Display + PartialOrd&gt; Pair&lt;T&gt; {\n    fn cmp_display(&amp;self) {\n        if self.x &gt;= self.y {\n            println!(\"The largest member is x = {}\", self.x);\n        } else {\n            println!(\"The largest member is y = {}\", self.y);\n        }\n    }\n}\n</code></pre> <p>\u4e5f\u53ef\u4ee5\u5bf9\u4efb\u4f55\u5b9e\u73b0\u4e86\u7279\u5b9a trait \u7684\u7c7b\u578b\u6709\u6761\u4ef6\u5730\u5b9e\u73b0 trait\u3002\u5bf9\u4efb\u4f55\u6ee1\u8db3\u7279\u5b9a trait bound \u7684\u7c7b\u578b\u5b9e\u73b0 trait \u88ab\u79f0\u4e3a blanket implementations\uff0c\u4ed6\u4eec\u88ab\u5e7f\u6cdb\u7684\u7528\u4e8e Rust \u6807\u51c6\u5e93\u4e2d\u3002\u4f8b\u5982\uff0c\u6807\u51c6\u5e93\u4e3a\u4efb\u4f55\u5b9e\u73b0\u4e86 <code>Display</code> trait \u7684\u7c7b\u578b\u5b9e\u73b0\u4e86 <code>ToString</code> trait\u3002\u8fd9\u4e2a <code>impl</code> \u5757\u770b\u8d77\u6765\u50cf\u8fd9\u6837\uff1a</p> <pre><code>impl&lt;T: Display&gt; ToString for T {\n    // --snip--\n}\n</code></pre> <p>\u56e0\u4e3a\u6807\u51c6\u5e93\u6709\u4e86\u8fd9\u4e9b blanket implementation\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u4efb\u4f55\u5b9e\u73b0\u4e86 <code>Display</code> trait \u7684\u7c7b\u578b\u8c03\u7528\u7531 <code>ToString</code> \u5b9a\u4e49\u7684 <code>to_string</code> \u65b9\u6cd5\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u5c06\u6574\u578b\u8f6c\u6362\u4e3a\u5bf9\u5e94\u7684 <code>String</code> \u503c\uff0c\u56e0\u4e3a\u6574\u578b\u5b9e\u73b0\u4e86 <code>Display</code>\uff1a</p> <pre><code>let s = 3.to_string();\n</code></pre>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/%E6%9E%84%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8Bweb%E6%9C%8D%E5%8A%A1%E5%99%A8/","title":"\u6784\u5efa\u591a\u7ebf\u7a0bweb\u670d\u52a1\u5668","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/%E6%9E%84%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8Bweb%E6%9C%8D%E5%8A%A1%E5%99%A8/#rust","title":"rust","text":""},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/%E6%9E%84%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8Bweb%E6%9C%8D%E5%8A%A1%E5%99%A8/#server","title":"\u5355\u7ebf\u7a0bserver","text":"<pre><code>use std::{\n    fs,\n    io::{BufRead, BufReader, Write},\n    net::{TcpListener, TcpStream},\n};\n\nfn main() {\n    let listener = TcpListener::bind(\"127.0.0.1:7878\").unwrap();\n\n    for stream in listener.incoming() {\n        let stream = stream.unwrap();\n\n        handle_connection(stream);\n\n        println!(\"Connection established!\");\n    }\n}\n\nfn handle_connection(mut stream: TcpStream) {\n    // \u4eceTCP\u6d41\u4e2d\u8bfb\u53d6\u6570\u636e\n    let buf_reader = BufReader::new(&amp;mut stream);\n    let request_line = buf_reader.lines().next().unwrap().unwrap();\n\n    let (status_line, filename) = if request_line == \"GET / HTTP/1.1\" {\n        (\"HTTP/1.1 200 OK\", \"hello.html\")\n    } else {\n        (\"HTTP/1.1 404 NOT FOUND\", \"404.html\")\n    };\n\n    let contents = fs::read_to_string(filename).unwrap();\n    let length = contents.len();\n    let response = format!(\"{status_line}\\r\\nContent-Length: {length}\\r\\n\\r\\n{contents}\");\n\n    stream.write_all(response.as_bytes()).unwrap();\n    stream.flush().unwrap()\n}\n</code></pre> <p>web\u8bf7\u6c42\u683c\u5f0f <pre><code>Method Request-URI HTTP-Version CRLF\nheaders CRLF\nmessage-body\n</code></pre></p> <p>web\u54cd\u5e94\u683c\u5f0f <pre><code>HTTP-Version Status-Code Reason-Phrase CRLF\nheader CRLF\nmessage-body\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/%E6%9E%84%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8Bweb%E6%9C%8D%E5%8A%A1%E5%99%A8/#server_1","title":"\u591a\u7ebf\u7a0bserver","text":"<p>main.rs <pre><code>use basic_web_server::ThreadPool;\nuse std::{\n    fs,\n    io::{BufRead, BufReader, Write},\n    net::{TcpListener, TcpStream},\n    thread,\n    time::Duration,\n};\n\nfn main() {\n    let listener = TcpListener::bind(\"127.0.0.1:7878\").unwrap();\n    let pool = ThreadPool::new(4);\n\n    for stream in listener.incoming() {\n        let stream = stream.unwrap();\n\n        pool.execute(|| {\n            handle_connection(stream);\n        });\n    }\n}\n\nfn handle_connection(mut stream: TcpStream) {\n    // \u4eceTCP\u6d41\u4e2d\u8bfb\u53d6\u6570\u636e\n    let buf_reader = BufReader::new(&amp;mut stream);\n    let request_line = buf_reader.lines().next().unwrap().unwrap();\n\n    let (status_line, filename) = match &amp;request_line[..] {\n        \"GET / HTTP/1.1\" =&gt; (\"HTTP/1.1 200 OK\", \"hello.html\"),\n        \"GET /sleep HTTP/1.1\" =&gt; {\n            thread::sleep(Duration::from_secs(5));\n            (\"HTTP/1.1 200 OK\", \"hello.html\")\n        } // \u6a21\u62df\u6162\u8bf7\u6c42\n        _ =&gt; (\"HTTP/1.1 404 NOT FOUND\", \"404.html\"),\n    };\n\n    let contents = fs::read_to_string(filename).unwrap();\n    let length = contents.len();\n    let response = format!(\"{status_line}\\r\\nContent-Length: {length}\\r\\n\\r\\n{contents}\");\n\n    stream.write_all(response.as_bytes()).unwrap();\n}\n</code></pre></p> <p>lib.rs <pre><code>use std::{\n    sync::{mpsc, Arc, Mutex},\n    thread,\n};\n\npub struct ThreadPool {\n    workers: Vec&lt;Worker&gt;,\n    sender: mpsc::Sender&lt;Job&gt;,\n}\n\ntype Job = Box&lt;dyn FnOnce() + Send + 'static&gt;;\n\nimpl ThreadPool {\n    pub fn new(size: usize) -&gt; ThreadPool {\n        assert!(size &gt; 0);\n\n        let (sender, receiver) = mpsc::channel();\n\n        let receiver = Arc::new(Mutex::new(receiver));\n\n        let mut workers = Vec::with_capacity(size);\n\n        for id in 0..size {\n            workers.push(Worker::new(id, Arc::clone(&amp;receiver)));\n        }\n\n        ThreadPool { workers, sender }\n    }\n\n    pub fn execute&lt;F&gt;(&amp;self, f: F)\n    where\n        F: FnOnce() + Send + 'static,\n    {\n        let job = Box::new(f);\n\n        self.sender.send(job).unwrap();\n    }\n}\n\nstruct Worker {\n    id: usize,\n    thread: thread::JoinHandle&lt;()&gt;,\n}\n\nimpl Worker {\n    fn new(id: usize, receiver: Arc&lt;Mutex&lt;mpsc::Receiver&lt;Job&gt;&gt;&gt;) -&gt; Worker {\n        let thread = thread::spawn(move || loop {\n            let job = receiver.lock().unwrap().recv().unwrap();\n\n            println!(\"Worker {id} got a job; executing.\");\n            job();\n        });\n\n        Worker { id, thread }\n    }\n}\n</code></pre></p>"},{"location":"%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Rust/%E8%AF%AD%E6%B3%95/%E6%9E%84%E5%BB%BA%E5%A4%9A%E7%BA%BF%E7%A8%8Bweb%E6%9C%8D%E5%8A%A1%E5%99%A8/#_1","title":"\u505c\u673a\u548c\u6e05\u7406","text":"<p>\u4f18\u96c5\u505c\u673a\u4e0e\u6e05\u7406 - Rust \u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00 \u7b80\u4f53\u4e2d\u6587\u7248</p>"}]}